<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10687269</article-id>
    <article-id pub-id-type="pmid">38030641</article-id>
    <article-id pub-id-type="publisher-id">43597</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-43597-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ZeroBind: a protein-specific zero-shot predictor with subgraph matching for drug-target interactions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0009-0007-5350-7269</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Yuxuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8437-0604</contrib-id>
        <name>
          <surname>Xia</surname>
          <given-names>Ying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9639-7679</contrib-id>
        <name>
          <surname>Yan</surname>
          <given-names>Junchi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4270-8002</contrib-id>
        <name>
          <surname>Yuan</surname>
          <given-names>Ye</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4029-3325</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Hong-Bin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5010-464X</contrib-id>
        <name>
          <surname>Pan</surname>
          <given-names>Xiaoyong</given-names>
        </name>
        <address>
          <email>2008xypan@sjtu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0220qvk04</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Institute of Image Processing and Pattern Recognition, </institution><institution>Shanghai Jiao Tong University, and Key Laboratory of System Control and Information Processing, Ministry of Education of China, </institution></institution-wrap>Shanghai, 200240 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0220qvk04</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Department of Computer Science and Engineering, and MoE Key Lab of Artificial Intelligence, AI Institute, </institution><institution>Shanghai Jiao Tong University, </institution></institution-wrap>Shanghai, 200240 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>7861</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Existing drug-target interaction (DTI) prediction methods generally fail to generalize well to novel (unseen) proteins and drugs. In this study, we propose a protein-specific meta-learning framework ZeroBind with subgraph matching for predicting protein-drug interactions from their structures. During the meta-training process, ZeroBind formulates training a protein-specific model, which is also considered a learning task, and each task uses graph neural networks (GNNs) to learn the protein graph embedding and the molecular graph embedding. Inspired by the fact that molecules bind to a binding pocket in proteins instead of the whole protein, ZeroBind introduces a weakly supervised subgraph information bottleneck (SIB) module to recognize the maximally informative and compressive subgraphs in protein graphs as potential binding pockets. In addition, ZeroBind trains the models of individual proteins as multiple tasks, whose importance is automatically learned with a task adaptive self-attention module to make final predictions. The results show that ZeroBind achieves superior performance on DTI prediction over existing methods, especially for those unseen proteins and drugs, and performs well after fine-tuning for those proteins or drugs with a few known binding partners.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Existing drug-target interaction (DTI) prediction methods generally fail to generalize well unseen proteins and drugs. Here the authors report a protein-specific meta-learning framework, ZeroBind, with subgraph matching for predicting protein-drug interactions from their structures.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Machine learning</kwd>
      <kwd>Virtual drug screening</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China (National Science Foundation of China)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61903248</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pan</surname>
            <given-names>Xiaoyong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Identifying the interactions between drugs and targets (proteins) plays a crucial role in the process of drug discovery<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. However, the traditional experimental methods for resolving the crystal structures of drug-protein complexes to identify the drug-target interactions are costly and time-consuming<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. In order to reduce costs, in silico approaches are gaining more attention. Instead of taking massive candidates into an in vitro search, it is more efficient and less costly to use computational approaches to virtually screen out most candidates prior to an in vitro search. Generally, there are two major groups of in silico approaches, docking simulations and data-driven learning-based methods. Docking simulations utilize the 3D structure of drug molecules and target proteins to identify their potential binding sites, which are also time-consuming<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. In contrast, due to the rapid development of machine learning, utilizing the features derived from proteins and drugs to identify their interactions achieves both high accuracy and low cost.</p>
    <p id="Par4">Data-driven learning methods generally formulate drug-target interaction (DTI) prediction as binary classification or regression tasks<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>, where interacting pairs of proteins and drugs are extracted from existing databases like BindingDB<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, CHEMBL<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, PDBbind<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>, and DrugBank<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Since the nature of potency values is logarithmic, a decrease in kinetic constants from micromolar to nanomolar levels results in an exponential change. Thus, the output values of regression tasks are normally defined as the negative log of kinetic constants, i.e., <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq4.gif"/></alternatives></inline-formula>. For classification tasks, a threshold is set to define binding or nonbinding according to <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq5.gif"/></alternatives></inline-formula>, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq8.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. Machine learning-based methods from molecules and proteins features mainly focus on learning a good representation of molecules and proteins, which are then fed into a classification/regression model to perform the prediction task<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
    <p id="Par5">Recently, deep learning has achieved exciting results in DTI prediction by learning from known drug-target interactions. However, these methods cannot generalize well to those unseen proteins and drugs<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. Similarity/distance-based<sup><xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup> and network-based<sup><xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup> methods, which utilize protein-protein similarity, drug-drug similarity and known DTIs, achieve overestimated performance on the transductive test<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, where both proteins and ligands in the test set are present in the training set. In addition, there are often few known binding drugs with a newly discovered target protein, making it difficult to work on the inductive test, where both proteins and ligands in the test set are absent in the training set. Currently, most existing methods focus on how to effectively learn representations of molecules and proteins, and then feed the representations into classification or regression models<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. The representation learning methods, like DeepPurpose<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, take molecular fingerprints and SMILES<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> strings as the molecular features and amino acid sequences as protein features. Then they apply a convolutional neural network (CNN)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, recurrent neural network (RNN)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> or Transformer<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> model to embed the input features. To take spatial information into consideration, some methods apply CNNs to 3D images derived from structures of proteins and molecule<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. GNN<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> has gained much attention in recent years due to its capability of handling graphs as non-Euclidean structured data<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Other methods utilize GNNs to embed graphs of proteins and molecules to perform DTI prediction<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. DTI prediction also benefits from the rapid development of GNNs since both drug and target protein are naturally graph-structured data. GEFA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> combines pre-trained protein embeddings and a graph-in-graph neural network with an attention mechanism to capture the interactions between drugs and protein residues. Thus, it is reasonable to use GNNs for the representation learning of proteins and drugs.</p>
    <p id="Par6">However, classical pair-input approaches often take drug-protein pairs as training samples by concatenating and feeding their representations into a dense layer to identify the interactions. However, these approaches may fail at inductive tests for unseen proteins and drugs not seen during the model training, which is due to their potential shortcuts<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> that remember the degree ratio of binding annotations in the training set rather than learning the molecular features of interactions<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. To generalize to unseen proteins and drugs, AI-Bind leverages network-derived negatives and pre-training to resolve the shortcut learning issue<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Furthermore, proteins may have diverse binding patterns with drugs, which can be captured by training a protein-specific model for individual proteins. Recently, a ligand-based method MetaDTA<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> is developed as a few-shot predictor for proteins with a few known binding drugs under the meta-learning framework. However, MetaDTA does not support zero-shot prediction for unseen proteins without known binding drugs in the training set.</p>
    <p id="Par7">To address these challenges, we propose a protein-specific zero-shot predictor ZeroBind for drug-target interaction prediction under the meta-learning framework. ZeroBind adopts the meta-learning framework MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> as the training strategy and each base model makes binding drug predictions of a specific protein, which mainly consists of four modules: (1) a Graph Convolutional Network (GCN) encoder learning the embeddings of the molecule graph and protein graph, (2) a Subgraph Information Bottleneck (SIB) module generating the essential IB-subgraph of the protein graph as a potential binding pocket, (3) a Multilayer Perceptron (MLP) module concatenating the protein IB-subgraph embedding and molecular embedding to perform DTI prediction, and (4) a task adaptive self-attention module to measure the importance of different tasks, where different DTI tasks contribute differently to the meta-learner. The generated task weight is used for weighted average loss and further incorporated into the meta-learning procedure.</p>
    <p id="Par8">In summary, our contributions are as follows: (1) We formulate the drug-target interaction prediction for unseen drugs and proteins as a zero-shot learning problem. The general knowledge of DTI prediction learned from existing proteins, drugs, and their interactions with meta-learning strategy have a greater ability for generalization to unseen proteins and drugs than existing methods. (2) We train one DTI task model per protein, where task adaptive self-attention is designed to calculate the contributions of multiple DTI tasks to the protein-specific meta-learner. Thus, each protein-specific model captures individual binding patterns to drugs. (3) We propose model-agnostic IB-subgraph learning to automatically discover compressed subgraphs as potential binding pockets in proteins instead of redundant graph information derived from the whole protein. (4) We conduct extensive experiments on three independent zero-shot test sets and one few-shot test set. Results show that ZeroBind consistently outperforms existing methods. Further validation of real-world SARS-COV-2 drug-target binding prediction demonstrates the reliability of ZeroBind predictions and the subgraphs detected by IB-subgraph learning align well with the known binding pockets in proteins.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of ZeroBind</title>
      <p id="Par9">In this study, ZeroBind formulates the DTI prediction as a meta-learning task and proposes a meta-learning framework to solve the generalization problem of unseen proteins and drugs in DTI prediction. Specifically, a meta-learning task is defined as binding drug predictions of a specific protein, where IB-subgraph learning is leveraged to automatically discover compressed subgraphs as potential binding pockets in proteins and a self-attention mechanism is designed to learn weights for each task of a protein. The flowchart of ZeroBind is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><title>The framework of ZeroBind.</title><p><bold>a</bold> Network-based negative sampling strategy. The bipartite network consisting of drugs and protein targets: The square nodes represent the protein nodes and the circle nodes represent the molecule nodes, and there are only edges between different types of nodes, representing the corresponding drug-target interaction. Solid lines represent existing drug-target interactions (DTIs) and dotted lines represent the generated negative interactions with the shortest path distance ≥ 7. <bold>b</bold> The positive ratio of the training set before the network-based negative sampling strategy. <bold>c</bold> The positive ratio of the training set after the network-based negative sampling strategy. <bold>d</bold> Given the support set and query set, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{support}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq9.gif"/></alternatives></inline-formula> is first calculated and utilized to update the base model with parameter <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\theta }}}}}}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq10.gif"/></alternatives></inline-formula> to a task-specific model with parameter <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}^{{{{\prime}}}}$$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq11.gif"/></alternatives></inline-formula> using the support set of each task, and then the task-specific model calculates the <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{query}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq12.gif"/></alternatives></inline-formula> using the query set of the task. After repeating N inner steps, all losses are weighted average by <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\boldsymbol{\omega }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ω</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq13.gif"/></alternatives></inline-formula>, and gradient descent is further performed to optimize the meta model. <bold>e</bold> The architecture of the base model in ZeroBind. For each task, the protein graph and the molecule graph are fed into a backbone graph convolutional network (GCN) with parameters <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{M}}}}}}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq15.gif"/></alternatives></inline-formula>, respectively, to obtain their embeddings. Subsequently, a SIB module is proposed to generate the IB-subgraph of a protein as potential binding pockets in a weakly supervised way. The protein subgraph embedding is concatenated with the molecular embedding and they are fed into a Multilayer Perceptron (MLP) module to identify the interactions. <bold>f</bold> Task adaptive attention module. It takes the concatenation of the protein embedding <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{p}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{k}}}}}}}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq16.gif"/></alternatives></inline-formula> and the average of all molecule embeddings <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{k}}}}}}}^{{{{{{\bf{i}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq17.gif"/></alternatives></inline-formula> in the query set as the task embedding. After using the self-attention layer to compute the weight of each task, denoted as <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq18.gif"/></alternatives></inline-formula>, the overall loss is averaged and incorporated into the meta-training process for updating the model parameters. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig1_HTML" id="d32e716"/></fig></p>
      <p id="Par10">In detail, ZeroBind uses network-based negative sampling<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> as data augmentation to alleviate the annotation imbalance (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, Methods section). Figure <xref rid="Fig1" ref-type="fig">1</xref>b, <xref rid="Fig1" ref-type="fig">c</xref> illustrates the ratio of positive samples before and after network-based negative sampling on the training set, indicating that network-based negative sampling alleviates the annotation imbalance to a certain extent. Then, it samples the DTIs into the support and query set (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>), where the support set is used to train the meta-learner and the query set is used to train the task-specific models. After repeating N inner steps, all losses are weighted to optimize the meta-learner with gradient descent. For each protein, ZeroBind trains a DTI prediction task. Figure <xref rid="Fig1" ref-type="fig">1e</xref> gives the architecture of the base model in ZeroBind, where the protein graph and molecule graph are fed into a backbone GCN to learn embeddings for drugs and proteins. Furthermore, a weakly supervised Subgraph Information Bottleneck (SIB) module is designed to model and discover potential binding pockets in proteins. The SIB module not only reduces redundant information to boost the performance, but also brings interpretable insights into ZeroBind by identifying the critical residues in the protein. Figure <xref rid="Fig1" ref-type="fig">1f</xref> introduces an adaptive self-attention module to measure the contribution of each task of a protein, where different DTI tasks contribute differently to the meta-learner. ZeroBind support predicting DTIs in zero-shot and few-shot scenarios. The former uses the meta-learner to make predictions directly without fine-tuning using the samples of proteins in meta-testing, and the latter uses the protein-specific model to make predictions with fine-tuning using the samples of the protein in meta-testing.</p>
    </sec>
    <sec id="Sec4">
      <title>ZeroBind outperforms existing methods in both zero-shot and few-shot settings for DTI prediction</title>
      <p id="Par11">To demonstrate the advantages of ZeroBind, we compare it with multiple baseline methods and calculate the area under the receiver operating characteristic (AUROC) and the area under the precision-recall curve (AUPRC) on three independent test sets and one few-shot test set. To ensure the effectiveness of performance comparison, we conduct five independent experiments with five random seeds for datasets partitioning and model training, and report the average results along with standard deviation.</p>
      <p id="Par12">The overall performances of all methods in three independent test sets are reported in Fig. <xref rid="Fig2" ref-type="fig">2a</xref> (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). ZeroBind achieves an AUROC of 0.9521(±0.0034), 0.8681(±0.0052), 0.8139(±0.0035) in the Transductive, Semi-inductive, and Inductive test sets, respectively. We can see that ZeroBind outperforms all baseline methods in the Transductive, Semi-inductive, and Inductive test sets. Compared to the best baseline method, ZeroBind achieves relative improvements in AUROC with 2.86% on the Transductive test set, 10.29% on the Semi-inductive test set, and 3.38% on the Inductive test set, the corresponding t-test p-value is 1.02 × 10<sup>−6</sup>, 8.02 × 10<sup>−11</sup>, 3.06 × 10<sup>−7</sup>, respectively. Moreover, the relative improvements of AUPRC are 1.00% on the Transductive test set, 0.96% on the Semi-inductive test set, and 1.21% on the Inductive test set compared to the best baseline method, the corresponding <italic>t</italic>-test <italic>p</italic>-value is 8.93 × 10<sup>−8</sup>, 5.15 × 10<sup>−3</sup>, 1.56 × 10<sup>−5</sup>, respectively. In addition, on the three test sets, we observe that the performance of all methods decreases, indicating that a certain external shortcut learning exists for the Transductive test set.<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance comparison of ZeroBind with baseline methods in zero-shot and few-shot scenarios.</title><p><bold>a</bold> Zero-shot performance evaluation with ZeroBind and baseline methods on three independent test sets. <bold>b</bold> Area Under the Receiver Operating Characteristic Curve (AUROC) comparison of the protein-specific ZeroBind and the baseline methods for 775 proteins in the combined inductive and semi-inductive test set. The color of points stands for the number of training proteins. <bold>c</bold> The number of proteins that the method performs the best among the compared methods for the combined inductive and semi-inductive test sets. <bold>d</bold> Few-shot performance comparison of ZeroBind with baseline methods on the few-shot test sets. Supplementary Tables <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM1" ref-type="media">2</xref> provide the data statistics for zero-shot and few-shot prediction with two-sided <italic>t</italic>-test without adjustment. Source data are provided as a Source Data file. AUPRC refers to Area Under the Precision-recall Curve.</p></caption><graphic xlink:href="41467_2023_43597_Fig2_HTML" id="d32e802"/></fig></p>
      <p id="Par13">Figure <xref rid="Fig2" ref-type="fig">2a</xref> shows that AI-bind and our proposed ZeroBind outperform other baseline methods on the Inductive test set due to the incorporation of network-based negative sampling and unsupervised pre-trained embeddings to avoid the potential shortcut learning. ZeroBind achieves stable and better performance at Transductive and semi-inductive test sets than baseline methods, indicating that ZeroBind can effectively learn useful embeddings of proteins and drugs. Furthermore, ZeroBind achieves better performance in the inductive test set than AI-Bind. The potential reason is that ZeroBind uses a meta-learning framework to obtain a general knowledge of DTI prediction across multiple proteins, which can generalize well to the DTI prediction of unseen proteins and drugs.</p>
      <p id="Par14">We also evaluate the protein-specific DTI prediction performance of ZeroBind with other baseline methods on the inductive test set and semi-inductive test set (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). After excluding proteins without binding or nonbinding labels, we obtain 775 proteins with binding drugs and one task model is trained per protein, here ZeroBind is evaluated on the combined inductive and semi-inductive test sets. ZeroBind achieves an average AUROC of 0.78, which is higher than the AUROC 0.66 of DeepConv-DTI, 0.68 of GraphDTA, 0.69 of Deeppurpose, 0.75 of AI-bind and 0.73 of DrugBAN across the 775 proteins. Of the 775 proteins, ZeroBind outperforms DeepConv-DTI, GraphDTA, Deeppurpose, AI-bind, and DrugBAN for 525, 491, 305, 180 and 346 proteins, respectively. For each method, we present the number of proteins that this method outperforms other methods (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>) according to the number of binding molecules. We observe that ZeroBind outperforms other baseline methods for the most proteins in the three ranges, especially for the proteins with only 1–10 known binding molecules, followed by AI-Bind.</p>
      <p id="Par15">We further evaluate ZeroBind against the baseline methods on the few-shot test set. ZeroBind and other baseline methods are first trained with the training set as the pre-training model, and further fine-tuned on each few-shot fine-tuning set and evaluated on the corresponding few-shot test set. The performance of ZeroBind model and other baselines on the few-shot test set is shown in Fig. <xref rid="Fig2" ref-type="fig">2d</xref> (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>). In the few-shot test, ZeroBind outperforms the best baseline methods with relative improvements of AUROC 1.55% and AUPRC 1.62%. The potential reason is that the meta-learning framework has the strong generalization ability to quickly adapt to additional protein tasks with a few training samples. We can see that fine-tuning improves the zero-shot prediction performance by a large margin, which is very useful for the real-world application scenario that a protein has only a few known binding drugs.</p>
    </sec>
    <sec id="Sec5">
      <title>ZeroBind detects the subgraphs that align well with known binding pockets of proteins in a weakly supervised way</title>
      <p id="Par16">ZeroBind does not use binding pocket information as ground truth labels for model training, instead, it uses the global DTI labels as a weakly supervised labels. To demonstrate that the IB-subgraph module in ZeroBind is able to detect the binding pocket in the protein, we use the Jaccard similarity coefficient<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> to compare the predicted binding pocket against the true binding pocket on PDBbind dataset<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. The true binding pocket information containing pocket residues and 3D coordinate locations are downloaded from PDBbind, which contains 14,000 binding residues for 535 proteins. The Jaccard similarity coefficient is used to calculate the degree of intersection between two sets of individual DTIs, and the formula is defined as <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Jaccard\; similarity\; coefficient}(\hat{P},P)=\frac{\hat{P}\cap P}{\hat{P}\cup P}$$\end{document}</tex-math><mml:math id="M38"><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.16em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∩</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∪</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{P}$$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq20.gif"/></alternatives></inline-formula> represents the set of predicted binding pocket residues by ZeroBind for a DTI, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M42"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq21.gif"/></alternatives></inline-formula> represents the set of true binding residues in the pocket for this DTI.</p>
      <p id="Par17">In addition, we calculate the Jaccard similarity coefficient of predicted binding pockets nodes and the first-order neighbors of the true binding pocket nodes as <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Jaccard\; similarity\; coefficient}(\hat{P},{P}_{{neighbor}})=\frac{\hat{P}\cap {P}_{{neighbor}}}{\hat{P}\cup {P}_{{neighbor}}}$$\end{document}</tex-math><mml:math id="M44"><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.16em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq22.gif"/></alternatives></inline-formula>, <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{{neighbor}}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq23.gif"/></alternatives></inline-formula> represents the set of first-order neighbor pockets of the real binding pocket.</p>
      <p id="Par18">Figure <xref rid="Fig3" ref-type="fig">3</xref>a, <xref rid="Fig3" ref-type="fig">b</xref> shows the distribution of Jaccard similarity coefficients of predicted binding pockets with true binding pockets and the first-order neighbors of true binding pockets, respectively. ZeroBind yields average Jaccard similarity coefficients of 0.358 and 0.605, respectively. For the neighboring pockets, Jaccard similarity coefficients are above 0.5 for most pockets. The results show that despite some discrepancy between the predicted binding pockets and true binding pockets, the predicted binding pockets are mostly around the true binding pockets, indicating the effectiveness of the generated IB-subgraph in ZeroBind as the potential binding pocket with some biological interpretability. We further conduct an experiment of randomly sampled residues as potential protein pockets, here denoted as ZeroBind<sup>random</sup>. The results are shown in the ablation studies and here we also calculate the Jaccard similarity coefficients of randomly sampled binding residues with true binding pockets and the first-order neighbors of true binding pockets, respectively. The ZeroBind<sup>random</sup> yields an average Jaccard similarity coefficients of 0.013 and 0.072 (all the values are below 0.2), which is much smaller than that of ZeroBind, respectively. As shown in Fig. <xref rid="Fig3" ref-type="fig">3a, b</xref>, we can see that the randomly selected binding residues have little overlap with the true binding pockets or their neighbors in proteins. The results indicate that the SIB module in ZeroBind learns the potential binding pockets instead of other unrelated factors, since the DTI binding information is to a certain extent able to guide the IB-subgraph module to locate potential binding pockets.<fig id="Fig3"><label>Fig. 3</label><caption><title>ZeroBind is able to detect binding pockets of proteins in a weakly supervised way.</title><p><bold>a</bold> The distribution of Jaccard similarity coefficients of the predicted binding pockets with the true binding pockets and randomly selected binding residues as binding pockets with the true binding pockets of individual DTIs. <bold>b</bold> The distribution of Jaccard similarity coefficients of the predicted binding pockets with the first-order neighbors of true binding pockets and randomly selected binding residues as binding pockets with the first-order neighbors of true binding pockets of individual DTIs. <bold>c</bold> The Serine/threonine-protein kinase N1 protein. Experimentally validated DTI binding pocket queried by BioLiP. The blue part represents the experimentally validated binding pocket along with the residue name and number. <bold>d</bold> The potential binding pocket predicted by IB-subgraph in ZeroBind. The red part represents the helix structure of protein, the yellow part represents the loop structure of protein and the green part represents the sheet structure of protein. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig3_HTML" id="d32e1089"/></fig></p>
      <p id="Par19">To further demonstrate the effectiveness of the IB-subgraph module, we train a variant ZeroBind for those proteins with known binding pockets using true binding pocket as the node assignment matrix <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M48"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq24.gif"/></alternatives></inline-formula> for the inductive test set. This variant ZeroBind achieves an average AUROC of 0.8278, which is higher than the AUROC 0.8032 of the ZeroBind that uses learned node assignment matrix <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M50"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq25.gif"/></alternatives></inline-formula> by a narrow margin. The experimental results further validate the effectiveness of the IB-subgraph module in ZeroBind.</p>
      <p id="Par20">We further visualize the generated IB-subgraph as the potential binding pocket for Serine/threonine-protein kinase N1 protein in Fig. <xref rid="Fig3" ref-type="fig">3c, d</xref>. We can see that although the IB-subgraph introduces some false positive binding residues due to no known binding pocket information for IB-subgraph module training, the potential binding residues included in the IB-subgraph contain most of the true binding residues deposited in BioLip<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
    </sec>
    <sec id="Sec6">
      <title>ZeroBind is able to predict potential drugs against SARS-COV-2 Proteins</title>
      <p id="Par21">To better demonstrate the effectiveness of ZeroBind, we use Auto-Docking simulations to validate its predicted potential drugs targeting the SARS-COV-2 proteins. Auto-Docking simulation is a time-consuming but reliable tool to simulate the drug-target binding process. To respond quickly to public health emergencies, we need to validate ZeroBind on proteins that don’t have many binding molecules. Thus, we apply ZeroBind to predict the interactions between the structures of 10 SARS-CoV-2 viral proteins not in the training set and 10,000 drugs in PubChem<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, where the PDB IDs for SARS-COV-2 protein structures are given in Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>. Then, we choose top-10 binding confidence pairs based on the predicted scores by ZeroBind and further perform Auto-Docking simulations to validate the effectiveness of ZeroBind predictions with AutoDock Vina<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>.</p>
      <p id="Par22">The average binding affinity of the top-10 predicted pairs by ZeroBind is −7.42 kcal/mole (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>), which are promising drug-target pairs and also validate the reliability of ZeroBind predictions<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. As demonstrated in<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, the average binding affinities are close to −7.5 kcal/mole for three binding pairs of SARS-COV-2 proteins and drugs. Furthermore, we simulate the drug-target binding complex between ORF8 accessory protein and VZBSCWDKCMOJCR-UHFFFAOYSA-N drug in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, it yields a relative good binding affinity score of −8.4 kcal/mole. And we also simulate the drug-target binding complex between ORF3a protein and OLTVRSUIOUTBRQ-UHFFFAOYSA-N drug in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, which yields a binding affinity score of −5.8 kcal/mole. As shown in Fig. <xref rid="Fig4" ref-type="fig">4b, c</xref>, we can see that the predicted drugs bind well to the pockets in SARS-COV-2 proteins. In future work, we expect ZeroBind to validate the potential drugs against the target proteins, especially those proteins with no verified drugs.<fig id="Fig4"><label>Fig. 4</label><caption><title>ZeroBind predicts binding drugs for SARS-COV-2 proteins.</title><p><bold>a</bold> Top 10 drug-target binding pairs of SARS-COV-2 proteins. <bold>b</bold> The drug-target binding complex between the drug InChI Key VZBSCWDKCMOJCR-UHFFFAOYSA-N and SARS-CoV-2 ORF8 protein. The green part represents the main part of the protein, the blue part represents the binding drug and the red part represent potential binding sites consisting of the residue name and number. <bold>c</bold> The drug-target binding complex between the drug InChI Key OLTVRSUIOUTBRQ-UHFFFAOYSA-N and SARS-CoV-2 ORF3a protein. The purple part and blue part represents the two main chains of ORF3a protein, the green part represents the binding drug and the red part represent potential binding sites consisting of the residue name and number. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig4_HTML" id="d32e1175"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Ablation studies on ZeroBind</title>
      <p id="Par23">To demonstrate the added value of individual modules in ZeroBind, we also conducted an ablation study to evaluate the effectiveness. The details of ZeroBind with different modules are illustrated as follows:<list list-type="order"><list-item><p id="Par24">ZeroBind<sup>MAML-</sup>: Train the base model of ZeroBind directly without the meta-learning strategy.</p></list-item><list-item><p id="Par25">ZeroBind<sup>SIB-</sup>: Using all node embeddings of the protein to identify the interaction instead of applying a SIB module to find the IB-graph on the protein graph.</p></list-item><list-item><p id="Par26">ZeroBind<sup>attention-</sup>: ZeroBind without task adapted attention module to balance the importance of different tasks.</p></list-item><list-item><p id="Par27">ZeroBind<sup>GIN</sup>: ZeroBind uses GIN instead of GCN as the backbone GNN.</p></list-item><list-item><p id="Par28">ZeroBind<sup>random</sup>: ZeroBind sets the node assignment matrix <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M52"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq26.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) randomly.</p></list-item></list></p>
      <p id="Par29">The results are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. For ZeroBind<sup>MAML-</sup>, we observe a significant decrease in the semi-inductive and inductive test sets, demonstrating that the meta-learning training strategy provides the powerful generalization ability to unseen proteins and drugs. We can see that ZeroBind<sup>SIB-</sup> yields a lower performance without the SIB module to find the IB-subgraph, indicating the embedding of the whole protein is less effective than the subgraph embedding. The potential reason is that redundant graph information exists in the whole protein graph, further indicating that the molecule binds to a binding pocket instead of the whole protein. ZeroBind<sup>attention-</sup> performs slightly worse than ZeroBind, indicating the necessity of task adaptive self-attention module to balance different DTI tasks for different proteins. We also see a performance decline for ZeroBind<sup>sampling-</sup>, due to the lack of the value-generated nonbinding annotations by network-based negative samplings that is able to alleviate the potential short-cut learning. For ZeroBind<sup>GIN</sup>, there is no significant difference in the performance compared with ZeroBind, which indicates that the backbone GNN has a smaller impact on the performance than other modules in ZeroBind. Compared to randomly selected binding pockets, ZeroBind<sup>random</sup> performs worse than ZeroBind, further validating the effectiveness of the SIB module for detecting potential binding pockets. Moreover, we can see that ZeroBind<sup>random</sup> with randomly selected pockets performs worse than ZeroBind<sup>SIB-</sup> without the IB-subgraph module, indicating that initially inaccurate binding pockets guides the model to not locate true binding pockets, resulting in a wrong DTI prediction.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance evaluation of ablation studies on ZeroBind</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Metric</th><th>Model</th><th>Transductive test</th><th>Semi-inductive test</th><th>Inductive test</th></tr></thead><tbody><tr><td rowspan="7">AUROC</td><td>ZeroBind<sup>MAML-</sup></td><td>0.8632 ± 0.0071</td><td>0.7835 ± 0.0063</td><td>0.6153 ± 0.0031</td></tr><tr><td>ZeroBind<sup>SIB-</sup></td><td>0.8556 ± 0.0056</td><td>0.8018 ± 0.0121</td><td>0.7122 ± 0.0042</td></tr><tr><td>ZeroBind<sup>attention-</sup></td><td>0.9057 ± 0.0078</td><td>0.8352 ± 0.0020</td><td>0.7585 ± 0.0026</td></tr><tr><td>ZeroBind<sup>sampling-</sup></td><td>0.9066 ± 0.0018</td><td>0.8280 ± 0.0031</td><td>0.7852 ± 0.0043</td></tr><tr><td>ZeroBind<sup>GIN</sup></td><td>0.9412 ± 0.0050</td><td>0.8652 ± 0.0046</td><td>0.8025 ± 0.0027</td></tr><tr><td>ZeroBind<sup>random</sup></td><td>0.8865 ± 0.0017</td><td>0.8254 ± 0.0082</td><td>0.7562 ± 0.0031</td></tr><tr><td><bold>ZeroBind</bold></td><td><bold>0.9521</bold> ± 0.0038</td><td><bold>0.8681</bold> ± 0.0065</td><td><bold>0.8139</bold> ± 0.0045</td></tr><tr><td rowspan="7">AUPRC</td><td>ZeroBind<sup>MAML-</sup></td><td>0.9540 ± 0.0044</td><td>0.9115±0.0010</td><td>0.8547 ± 0.0027</td></tr><tr><td>ZeroBind<sup>SIB-</sup></td><td>0.9385 ± 0.0117</td><td>0.9375 ± 0.0028</td><td>0.9242 ± 0.0058</td></tr><tr><td>ZeroBind<sup>attention-</sup></td><td>0.9789 ± 0.0050</td><td>0.9742 ± 0.0065</td><td>0.9408 ± 0.0061</td></tr><tr><td>ZeroBind<sup>sampling-</sup></td><td>0.9782 ± 0.0027</td><td>0.9645 ± 0.0063</td><td>0.9655 ± 0.0057</td></tr><tr><td>ZeroBind<sup>GIN</sup></td><td>0.9831 ± 0.0043</td><td>0.9850 ± 0.0058</td><td>0.9817 ± 0.0062</td></tr><tr><td>ZeroBind<sup>random</sup></td><td>0.9635 ± 0.0056</td><td>0.9375 ± 0.0151</td><td>0.9288 ± 0.0071</td></tr><tr><td><bold>ZeroBind</bold></td><td><bold>0.9896</bold> ± 0.0013</td><td><bold>0.9880</bold> ± 0.0062</td><td><bold>0.9872</bold> ± 0.0020</td></tr></tbody></table><table-wrap-foot><p>The average is reported after performing each experiment five times, along with the standard deviation. The bold face indicates the method is the best across the compared methods.</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par30">The interaction of proteins with drug molecules is an important research topic, especially in the face of proteins and drug molecules not seen in the training set. Considering the information of proteins and molecules simultaneously is an under-explored idea to solve this problem. In this study, we formulate the drug-target interaction (DTI) prediction as a meta-learning task and propose a meta-learning framework called ZeroBind to solve the generalization problem of unseen proteins and drugs in DTI. Specifically, a meta-learning task is defined as binding drug predictions of a specific protein. The results demonstrate that ZeroBind outperforms existing methods in zero-shot and few-shot scenarios. In addition, the subgraphs learned by SIB align well with binding pockets in the protein, where randomly selected residues as binding pockets almost do not overlap with true binding pockets. Furthermore, we validate ZeroBind’s performance in a real-world scenario, where it predicts drug-target bindings for SARS-COV-2.</p>
    <p id="Par31">Due to the rapid development of the research on GNNs, proteins and molecules can be encoded in a more natural form than sequences in previous studies. In addition, the meta-learning strategy also provides a more precise way of delineating the protein-specific DTI task space, which is also consistent with the experimental workflow for proteins in real drug experiments. However, ZeroBind also has some limitations, such as the difficulty of meta-learning training, where the training procedure is complex and prone to instability.</p>
    <p id="Par32">The IB-subgraph method offers an interpretable ability of the model for understanding representation learning. In ZeroBind, the potential binding pockets are automatically detected with the weakly supervised IB-subgraph method that does not use binding pocket annotations as labels. To the best of our knowledge, still no published methods use IB-subgraph or other subgraph-based methods to identify potential binding pockets in the proteins, existing subgraph-based methods are focused on drug molecules. In the current study, we do not incorporate real binding pocket information into model training, since the binding pocket data is far less than the DTI data, and the protein structures predicted by AlphaFold2 still have no known binding pocket annotations. Of the proteins in the benchmark dataset, only 535 proteins have a part of known binding pockets. Thus, it is difficult to train the SIB module in ZeroBind for all proteins to detect binding pockets using the local binding pocket labels. Instead, we train the SIB module of ZeroBind using the global DTI binding labels, which potentially guides the SIB module to locate the potential binding pockets in proteins. As shown in our experiment, ZeroBind with true binding pockets yields better performance. A future update of ZeroBind is expected to take true binding pocket information into the training process to make a more accurate fitting to the DTI problem, if we can collect more true binding pocket data.</p>
    <p id="Par33">Furthermore, the base model in ZeroBind is GCN and there have been more advanced neural architectures for protein-molecule binding, such as SE(3)-equivariant GNN used in EquiBind<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. In future work, we expect to investigate more advanced GNNs in ZeroBind.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Dataset generation and augmentation</title>
      <p id="Par34">BindingDB<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> is a public database of DTI interactions, which deposits binding affinity data between drugs (drug-like molecules) and target proteins. It currently contains over 2,600,000 experimentally determined binding affinities of protein-drug complexes between over 8000 protein targets and over 1,100,000 small molecules.</p>
      <p id="Par35">To create the training and test datasets for ZeroBind, we apply several filtering and preprocessing steps to create a high-quality benchmark dataset. First, data points are filtered with “single protein” for the “target type” attribute, and kinetic constants <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq28.gif"/></alternatives></inline-formula>, <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq30.gif"/></alternatives></inline-formula> for the “standard type” attribute. In addition, all target proteins should be human or human-like proteins, so they are filtered using “Homo sapiens” for “Target Source Organism” attribute. After excluding proteins that don’t have SwissProt name and molecules that cannot be handled by RDKit<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, 1,500,000 protein-drug pairs were collected. We use the threshold in AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, which treats kinetic constants <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq32.gif"/></alternatives></inline-formula>, <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50} &lt; $$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq34.gif"/></alternatives></inline-formula>1000 nM as positive samples and <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ &gt; {10}^{6}$$\end{document}</tex-math><mml:math id="M70"><mml:mo>&gt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq35.gif"/></alternatives></inline-formula> nM as negative samples.</p>
      <p id="Par36">To demonstrate the effectiveness of ZeroBind, we construct three independent test sets for model evaluation through protein sequence similarity clustering by cd-hit and molecule scaffold split: (1) Transductive test set, where molecules with the same scaffold and proteins with the same cluster are in the training set, but their interactions do not exist in the training set; (2) Semi-inductive test set, where the proteins in the same cluster are in the training set, but the molecules with the same scaffold are not; (3) Inductive test set, where molecules with the same scaffolds and proteins in the same clusters are not in the training set.</p>
      <p id="Par37">We first use cd-hit, a widely used program for clustering protein sequences, to cluster 1603 proteins into 1101 clusters with a similarity threshold 0.4. Through comparing molecule scaffolds, we split the molecules into the training molecule set and test molecule set with a training ratio of 0.95, and ensure that these two sets do not have overlapping scaffolds. As the meta-learning-based framework requires sufficient data, we first divide the clusters that have any protein with the number of associated molecules &lt;20 into the test clusters, and the remaining clusters as the training clusters. Then, we construct the training set using 95% of the proteins in the training clusters and SMILES in the training molecules set. The remaining 5% of the proteins in the training clusters and smiles in the training molecules set are used as the Transductive test set. Finally, the proteins and smiles both in the test clusters and molecule set are further used as the Inductive test set, and the rest data are used as the Semi-inductive test set. During the model training, the cross-validation approach is applied for model optimization.</p>
      <p id="Par38">In addition, we construct another few-shot test set with combining the Semi-inductive test set and the Inductive test set to evaluate the few-shot learning power of ZeroBind. Then, we randomly select 5 positive and 5 negative DTIs of each protein as the few-shot fine-tuning set, and the rest DTIs of each protein as the few-shot test set. Proteins that don’t have enough positive or negative DTIs are excluded from the few-shot fine-tuning set and the few-shot test set. The details of the training set and four test sets are given in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The details of the training set and four test sets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Number of proteins</th><th>Number of drugs</th><th>Number of interactions</th></tr></thead><tbody><tr><td>Training set</td><td>426</td><td>248,997</td><td>392,032</td></tr><tr><td>Transductive test set</td><td>392</td><td>16,946</td><td>17,314</td></tr><tr><td>Semi-inductive test set</td><td>1575</td><td>159,182</td><td>228,320</td></tr><tr><td>Inductive test set</td><td>688</td><td>7261</td><td>10,165</td></tr><tr><td>Few-shot test set</td><td>1253</td><td>127,665</td><td>160,948</td></tr></tbody></table></table-wrap></p>
      <p id="Par39">We observe there exists data imbalance in the training set, and most proteins have a high positive ratio. AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> demonstrates that the annotation imbalance causes the network to learn topological shortcuts instead of the binding patterns of drug-target interactions. Similar to AI-Bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, we use the network-based negative sampling of training datasets as data augmentation to alleviate the annotation imbalance. Specifically, we construct a bipartite drug-target network. The bipartite network is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. Dijkstra’s Algorithm is used to find the shortest path distances between any pairs of nodes in the network, and we consider the node pairs with the shortest path distance ≥ 7 in the network as non-binding pairs. After this processing, the annotation imbalance was slightly relieved as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, <xref rid="Fig1" ref-type="fig">c</xref>.</p>
      <p id="Par40">The 3D structures of 996 proteins in this study are downloaded in PDB format from the RCSB Protein Data Bank (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org">https://www.rcsb.org</ext-link>)<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, and the rest 3D structures of 635 proteins are predicted by AlphaFold2<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. In addition, we download the true binding pocket information containing pocket residuals and pocket 3D coordinate locations from the PDBbind database, which contains binding pockets for 14,336 DTIs.</p>
    </sec>
    <sec id="Sec11">
      <title>Graph construction for proteins and drugs</title>
      <p id="Par41">In this section, we first introduce the construction of drug graphs and protein graphs, and then give formal definitions of the DTI task and its derivatives, zero-shot DTI predicting task and few-shot DTI predicting task.</p>
      <p id="Par42">After using RDkit<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> to construct a molecule from a SMILES<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> string, we apply the encoding format used in Open Graph Benchmark (OGB) datasets<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> to obtain molecular representation. Specifically, atom chemical features consist of atomic number, chirality, atomic formal charge, number of hydrogen atoms attached, radical electrons number, hybridization type, and aromatic. Geometric features consist of atom degree, and a binary value that whether in the ring is used for encoding node representation. Edge features consist of bond type, bond stereo and a binary value that whether bond is conjugated.</p>
      <p id="Par43">Definition 1: We define a drug as a graph denoted as <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{m}=\left\{{V}_{m},{E}_{m}\right\}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq36.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{m}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq37.gif"/></alternatives></inline-formula> is the node set representing the atoms of a molecule and <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{m}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq38.gif"/></alternatives></inline-formula> is the edge set indicating which pair of nodes are connected.</p>
      <p id="Par44">Definition 2: We define a protein graph as <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{p}=\left\{{V}_{p},{E}_{p}\right\}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq39.gif"/></alternatives></inline-formula> from the protein 3D structure, where <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{p}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq40.gif"/></alternatives></inline-formula> is the node set of the residues, <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{p}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq41.gif"/></alternatives></inline-formula> is the edge set indicating which pair of residue nodes are connected. In this study, if the Euclidean distance between two residues in 3D structure space is less than 8 angstroms (Å)<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>, the two residue nodes are connected with one edge in the protein graph.</p>
      <p id="Par45">For proteins without known 3D structures, we use AlphaFold2<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to predict their structures as complementary. The node features of the protein graph are initialized with pre-trained ESM-2<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> emebddings, a general-purpose protein language model, of the residues to incorporate prior knowledge. The edge features of the protein graph are the Euclidean distance between the pairs of nodes. The whole process of constructing a protein graph is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><title>The data processing of ZeroBind.</title><p><bold>a</bold> The process of constructing a protein graph from the protein 3D structure. Instead of using peptide bonds as edges, we connect two residues with the cutoff distance &lt; 8 angstroms (Å), where edges and node features are extracted using ESM-2 pretrained model. <bold>b</bold> An example of the protein graph construction from the protein 3D structure. <bold>c</bold> The few-shot DTI prediction process and zero-shot DTI prediction process.</p></caption><graphic xlink:href="41467_2023_43597_Fig5_HTML" id="d32e1880"/></fig></p>
      <p id="Par46">In this work, we train a DTI task per protein.</p>
      <p id="Par47">Definition 3: We define a DTI task <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{p}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq42.gif"/></alternatives></inline-formula> from a task set <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathscr{T}}}}}}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq43.gif"/></alternatives></inline-formula> for meta learning as <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{p}=\left\{p,{M}_{p}\right\}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq44.gif"/></alternatives></inline-formula>, where <italic>p</italic> is a protein in the protein set <italic>P</italic> and <italic>M</italic><sub><italic>p</italic></sub> is the drug set of its corresponding binding molecules and non-binding molecules.</p>
      <p id="Par48">Definition 4: We define the zero-shot DTI predicting task inherited from DTI task, which represents that the meta-model is directly used for prediction without fine-tuning with samples of the protein in meta-learning test set.</p>
      <p id="Par49">Definition 5: We define the few-shot DTI predicting task inherited from DTI task, which uses the protein-specific model for prediction after fine-tuning with samples of the protein in meta-testing.</p>
      <p id="Par50">The few-shot DTI prediction schedule and zero-shot DTI prediction schedule are shown in Fig. <xref rid="Fig5" ref-type="fig">5c</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>Meta-learning setup in ZeroBind</title>
      <p id="Par51">The meta-learning framework was originally proposed to learn general knowledge across multiple related tasks within a distribution and used this general experience to quickly adapt to additional tasks and improve prediction performance<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. There are two main types of meta-learning framework: (1) Gradient-based methods: The classic gradient-based method MAML<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> uses a meta-learner to learn a good initialization by summing up multiple task losses and updating the parameters across tasks. Therefore, MAML could achieve both high accuracy and speed for generalization; (2) Metric-based methods: The prototypical network<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> is a classic metric-based meta-learning algorithm that directly trains the vector representation (i.e., prototypes) of each category. Once a good feature extractor is trained, the category of a new sample is determined by its closest prototype in the vector space. In our study, we apply gradient-based methods MAML as the training strategy. Besides, we follow MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> to make some improvements to stabilize the training process of MAML.</p>
      <p id="Par52">In the details of ZeroBind, several techniques including multi-step loss optimization (MSL), learning per-layer per-step learning rates and gradient directions (LSLR), subgraph information bottleneck (SIB), and task adaptive self-attention are applied to improve the performance of ZeroBind. We build the zero-shot learning framework based on MAML. First, we randomly initialize the network parameter <bold><italic>θ</italic></bold>. Given training tasks (proteins) sampled from the task distribution <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{\boldsymbol{{{{{\mathscr{T}}}}}}}}}}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="bold-script">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq45.gif"/></alternatives></inline-formula>, MAML aims to learn good initial parameters that can quickly adapt to additional tasks. For a pair of a protein and drug, we sample a 2-way, k-shot, m-query training task. Of these three hyperparameters, 2-way is set up since there are only two types of labels of binding and nonbinding in the classification task. In the original MAML framework, the model first trains <italic>k</italic> data samples of each label for several inner steps to learn a task-specific model and then tests on <italic>m</italic> data samples. After obtaining the loss for each task, MAML applies the gradient descent with the sum or average of the loss across all tasks. Here we refer the training task and test task as the support set and query set, respectively. However, MAML suffers from instability during training and is sensitive to neural network architectures and a large number of hyperparameters. Therefore, we follow MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> training procedure, which leverages multi-step loss optimization (MSL) and learning per-layer per-step learning rates and gradient directions (LSLR) in MAML.</p>
      <p id="Par53">Specifically, the multi-step loss optimization calculates the loss of the query set after each inner step, and optimizes the base network with the support set after all inner step optimization is completed. More formally, we optimize the model parameters as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta=\theta -\alpha {\nabla }_{\theta }\mathop{\sum }\limits_{b=1}^{B}\mathop{\sum }\limits_{i=0}^{N}{\upsilon }_{i}{{{{{{\mathscr{L}}}}}}}_{{T}_{b}}\left({f}_{{\theta }_{i}^{b}}\right)$$\end{document}</tex-math><mml:math id="M92"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M94"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq46.gif"/></alternatives></inline-formula> is the learning rate, <inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{T}_{b}}\left({f}_{{\theta }_{i}^{b}}\right)$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq47.gif"/></alternatives></inline-formula> denotes the loss of the query set after every inner step optimization with the support step and <inline-formula id="IEq48"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\upsilon }}}}}}}_{{{{{{\bf{i}}}}}}}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">υ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq48.gif"/></alternatives></inline-formula> denotes the importance of step <inline-formula id="IEq49"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M100"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq49.gif"/></alternatives></inline-formula> generated by the number of inner steps.</p>
      <p id="Par54">The LSLR module sets the learning rate to be learnable parameters for each layer at each inner step. Without adding much computation, different learning rates are automatically learned for each layer at each step, which may help alleviate overfitting.</p>
      <p id="Par55">To summarize the meta-learning procedure in ZeroBind (Boxes <xref rid="Sec13" ref-type="sec">1</xref> and <xref rid="Sec14" ref-type="sec">2</xref>), the model is first updated to task-specific models using the support set of each task, and then calculates the loss of the query set of the task. After repeating N inner steps, the losses of all query sets are weighted average by <inline-formula id="IEq50"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{{{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq50.gif"/></alternatives></inline-formula>, and are used to optimize the meta-model by gradient descent. After training with a sufficient number of samples, the learned model has a good capability of predicting DTI for unseen molecules and proteins or quickly adapting to additional protein tasks with a few training samples. The meta-learning procedure of ZeroBind is shown in Fig. <xref rid="Fig1" ref-type="fig">1d</xref>.</p>
    </sec>
    <sec id="Sec13">
      <boxed-text>
        <label>Box 1 ZeroBind training process</label>
        <p id="Par56">Require: <inline-formula id="IEq51"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right\}:$$\end{document}</tex-math><mml:math id="M104"><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>:</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq51.gif"/></alternatives></inline-formula> training data;</p>
        <p id="Par57">While not done do:</p>
        <p id="Par58">Sample batch of tasks <inline-formula id="IEq52"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }\sim p\left(\tau \right)$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq52.gif"/></alternatives></inline-formula></p>
        <p id="Par59">For all <inline-formula id="IEq53"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq53.gif"/></alternatives></inline-formula> do</p>
        <p id="Par60"> Sample k examples as support sets of <inline-formula id="IEq54"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq54.gif"/></alternatives></inline-formula>
<inline-formula id="IEq55"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{G}_{{mn}}^{\tau },{G}_{{pn}}^{\tau },{Y}_{n}^{\tau }\right\}}_{n=1}^{k}\in \left({G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right)$$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq55.gif"/></alternatives></inline-formula></p>
        <p id="Par61"> Sample m examples as query sets of <inline-formula id="IEq56"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq56.gif"/></alternatives></inline-formula>
<inline-formula id="IEq57"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{G}_{{mn}}^{\tau },{G}_{{pn}}^{\tau },{Y}_{n}^{\tau }\right\}}_{n=1}^{m}\in \left({G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right)$$\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq57.gif"/></alternatives></inline-formula></p>
        <p id="Par62"> <inline-formula id="IEq58"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{{base}}\leftarrow \theta$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq58.gif"/></alternatives></inline-formula></p>
        <p id="Par63"> For i=1 to inner steps do:</p>
        <p id="Par64">  Calculate the inner step loss weight <inline-formula id="IEq59"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\omega }_{i}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq59.gif"/></alternatives></inline-formula></p>
        <p id="Par65">  <inline-formula id="IEq60"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}={BaseModel}\left({\left\{{G}_{{Pn}}^{\tau }\right\}}_{n=1}^{k},{\left\{{G}_{{Mn}}^{\tau }\right\}}_{n=1}^{k}{{{{{\rm{;}}}}}}{\theta }_{{base}}\right)$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq60.gif"/></alternatives></inline-formula></p>
        <p id="Par66">  <inline-formula id="IEq61"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\leftarrow {Eq}.\left(11\right){with}{\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>←</mml:mo><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfenced><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq61.gif"/></alternatives></inline-formula></p>
        <p id="Par67">  <inline-formula id="IEq62"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{{base}}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq62.gif"/></alternatives></inline-formula> optimize with <inline-formula id="IEq63"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq63.gif"/></alternatives></inline-formula></p>
        <p id="Par68">  <inline-formula id="IEq64"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{m}={BaseModel}\left({\left\{{G}_{{Pn}}^{\tau }\right\}}_{n=1}^{m},{\left\{{G}_{{Mn}}^{\tau }\right\}}_{n=1}^{m}{{{{{\rm{;}}}}}}{\theta }_{{base}}\right)$$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq64.gif"/></alternatives></inline-formula></p>
        <p id="Par69">  <inline-formula id="IEq65"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\leftarrow {Eq}.\left(11\right){with}{\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{m}$$\end{document}</tex-math><mml:math id="M132"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>←</mml:mo><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfenced><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq65.gif"/></alternatives></inline-formula></p>
        <p id="Par70"> End for</p>
        <p id="Par71">
          <inline-formula id="IEq66">
            <alternatives>
              <tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}^{\tau }={\left\{{\omega }_{i}\right\}}_{i=1}^{N}\cdot {\left\{{{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\right\}}_{i=1}^{N}$$\end{document}</tex-math>
              <mml:math id="M134">
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ω</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>⋅</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="script">L</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq66.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par72">End for</p>
        <p id="Par73">
          <inline-formula id="IEq67">
            <alternatives>
              <tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\eta }_{i}\right\}}_{i=1}^{N}\leftarrow {Eq}.\left(14\right)$$\end{document}</tex-math>
              <mml:math id="M136">
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>η</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>14</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq67.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par74">
          <inline-formula id="IEq68">
            <alternatives>
              <tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \leftarrow \theta -\alpha {\nabla }_{\theta }{\sum }_{{T}_{\tau }\sim p\left(\tau \right)}{\eta }_{i}\cdot {{{{{{\mathscr{L}}}}}}}^{\tau }$$\end{document}</tex-math>
              <mml:math id="M138">
                <mml:mi>θ</mml:mi>
                <mml:mo>←</mml:mo>
                <mml:mi>θ</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mi>α</mml:mi>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>∇</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>τ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>~</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mi>τ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>η</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>⋅</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq68.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par75">End while</p>
      </boxed-text>
    </sec>
    <sec id="Sec14">
      <boxed-text>
        <label>Box 2 BaseModel forward process</label>
        <p id="Par76">Require: <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{G}_{P},{G}_{M}\right\}:$$\end{document}</tex-math><mml:math id="M140"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>:</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq69.gif"/></alternatives></inline-formula> training data;</p>
        <p id="Par77">
          <inline-formula id="IEq70">
            <alternatives>
              <tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{P}={{GNN}}_{P}\left({G}_{P};{\theta }_{P}\right)$$\end{document}</tex-math>
              <mml:math id="M142">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                    <mml:mi>N</mml:mi>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq70.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par78">
          <inline-formula id="IEq71">
            <alternatives>
              <tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{M}={{GNN}}_{M}\left({G}_{M};{\theta }_{M}\right)$$\end{document}</tex-math>
              <mml:math id="M144">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                    <mml:mi>N</mml:mi>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq71.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par79">
          <inline-formula id="IEq72">
            <alternatives>
              <tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z\leftarrow {Eq}.\left(4\right){with}\left({G}_{P},{G}_{M}\right)$$\end{document}</tex-math>
              <mml:math id="M146">
                <mml:mi>Z</mml:mi>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>4</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq72.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par80">
          <inline-formula id="IEq73">
            <alternatives>
              <tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{G}_{P}}_{{sub}}\leftarrow {Eq}.\left(5\right){with}\left(Z,{G}_{P}\right)$$\end{document}</tex-math>
              <mml:math id="M148">
                <mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                    <mml:mi>u</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>5</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq73.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par81">For i=1 to num steps do</p>
        <p id="Par82">
          <inline-formula id="IEq74">
            <alternatives>
              <tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\leftarrow {Eq}.\left(8\right){with}\left({G}_{P},{{G}_{P}}_{{sub}};{\varphi }_{2}\right)$$\end{document}</tex-math>
              <mml:math id="M150">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>I</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>o</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>8</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>φ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq74.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par83">
          <inline-formula id="IEq75">
            <alternatives>
              <tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}\leftarrow {Eq}.\left(6\right){with\; Z}$$\end{document}</tex-math>
              <mml:math id="M152">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>S</mml:mi>
                    <mml:mi>E</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>6</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mspace width="0.16em"/>
                <mml:mi>Z</mml:mi>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq75.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par84">
          <inline-formula id="IEq76">
            <alternatives>
              <tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}\leftarrow {Eq}.\left(10\right){with}\left({G}_{m},{{G}_{P}}_{{sub}}{;Y}\right)$$\end{document}</tex-math>
              <mml:math id="M154">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq76.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par85">
          <inline-formula id="IEq77">
            <alternatives>
              <tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{Base}}\leftarrow {Eq}.\left(11\right){with}\left({{{{{{\mathscr{L}}}}}}}_{{cls}},{{{{{{\mathscr{L}}}}}}}_{{MSE}},{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\right)$$\end{document}</tex-math>
              <mml:math id="M156">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>11</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>E</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>I</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq77.gif"/>
            </alternatives>
          </inline-formula>
        </p>
      </boxed-text>
    </sec>
    <sec id="Sec15">
      <title>Architecture of base model in ZeroBind</title>
      <p id="Par86">Figure <xref rid="Fig1" ref-type="fig">1e</xref> shows the architecture of the base model in ZeroBind, which mainly consists of three modules: a GNN module to obtain the embedding of molecules and proteins, a SIB module to find the most predictive subgraph as the binding pocket in the protein, and a dense module with concatenating protein subgraph representation and molecular representation to score the interactions.</p>
      <p id="Par87">Graph neural network-based representation learning for proteins and drugs. After constructing drug and protein graphs for a given protein-drug pair, we first embed the molecule atom features to vector space with randomly initialized parameters. We denote the node embedding of the molecule as <inline-formula id="IEq78"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{X}}}}}}}_{{{{{{\bf{m}}}}}}}{{{{{\boldsymbol{\in }}}}}}{{\mathbb{R}}}^{{N}_{m}*{D}_{m}}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">∈</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq78.gif"/></alternatives></inline-formula>, and also as the initial node embedding of GNN, denoted as <inline-formula id="IEq79"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{0}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq79.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq80"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{m}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq80.gif"/></alternatives></inline-formula> is the number of nodes and <inline-formula id="IEq81"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{m}$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq81.gif"/></alternatives></inline-formula> is the dimension of the node embeddings. Here, we denote the graph convolutional network (GCN) based molecule backbone as <inline-formula id="IEq82"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq82.gif"/></alternatives></inline-formula>, which is used to learn the graph embedding from the molecule graph. Then, the <inline-formula id="IEq83"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M168"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq83.gif"/></alternatives></inline-formula>-th layer output of <inline-formula id="IEq84"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq84.gif"/></alternatives></inline-formula> can be formulated as:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{m}^{\left(l\right)}={RELU}\left({\hat{A}}_{m}{G}_{m}^{\left(l-1\right)}{W}_{m}^{\left(l-1\right)}+{b}^{\left(l-1\right)}\right)$$\end{document}</tex-math><mml:math id="M172"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq85"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{{{{{\bf{A}}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq85.gif"/></alternatives></inline-formula> represents the adjacent matrix of a graph, <inline-formula id="IEq86"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{l}}}}}}{{{{{\boldsymbol{-}}}}}}{{{{{\bf{1}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold-italic">-</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq86.gif"/></alternatives></inline-formula> denotes the node embedding of <inline-formula id="IEq87"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(l-1\right)$$\end{document}</tex-math><mml:math id="M178"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq87.gif"/></alternatives></inline-formula>-th layer and <inline-formula id="IEq88"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{l}}}}}}{{{{{\boldsymbol{-}}}}}}{{{{{\bf{1}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M180"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold-italic">-</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq88.gif"/></alternatives></inline-formula> is the learnable weight matrix.</p>
      <p id="Par88">For protein graphs, we initialize the node embedding <inline-formula id="IEq89"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{p}}}}}}}^{\left({{{{{\bf{0}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M182"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq89.gif"/></alternatives></inline-formula> of a protein graph with ESM-2, a pre-trained general-purpose protein embedding. Similarly to the molecule graph, a GCN-based backbone <inline-formula id="IEq90"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{p}}}}}}}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq90.gif"/></alternatives></inline-formula> is used to learn the graph embedding from the protein graphs. Then, the <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M186"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq91.gif"/></alternatives></inline-formula>-th layer output of <inline-formula id="IEq92"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{p}}}}}}}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq92.gif"/></alternatives></inline-formula> can be formulated as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{p}^{\left(l\right)}={RELU}\left({\hat{A}}_{p}{G}_{p}^{\left(l-1\right)}{W}_{p}^{\left(l-1\right)}+{b}^{\left(l-1\right)}\right)$$\end{document}</tex-math><mml:math id="M190"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par89">Subgraph learning in ZeroBind for potential binding pockets in proteins. Considering that a molecule binds to a binding pocket in the protein instead of the whole protein, after the protein backbone GCN, we apply a model-agnostic SIB module<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> to identify the most interpretable subgraph with the most crucial information associated with the DTI task, where the learned subgraph corresponds to the binding pocket on the protein graph. The SIB module is proposed to recognize a compressed subgraph named IB-subgraph under the information bottleneck (IB) principle. The IB-subgraph could also eliminate the noisy and redundant graph information. In our DTI task, the DTI score is largely determined by the protein pocket features, which are the subgraph information bottleneck of the protein graph or the potential drug binding sites in the protein.</p>
      <p id="Par90">The SIB module contains a subgraph generator for node assignment and a dense layer to guarantee that the generated subgraph matches the IB-subgraph. The subgraph generator is a Multi-layer Perceptron (MLP), which takes the protein node embedding and the molecule embedding as the input and outputs the node assignment matrix <inline-formula id="IEq93"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M192"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq93.gif"/></alternatives></inline-formula>, which is formulated as follows:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z={Softmax}\left({MLP}\left({concatenate}\left({G}_{p}^{\left(l\right)},{G}_{m}^{\left(l\right)}\right){{{{{\rm{;}}}}}}{\varphi }_{1}\right)\right)$$\end{document}</tex-math><mml:math id="M194"><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{{sub}}={Z}^{T}{G}_{p}^{\left(l\right)}\left[0\right]$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where the output of the MLP is a <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times 2$$\end{document}</tex-math><mml:math id="M198"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq94.gif"/></alternatives></inline-formula> matrix with the number of nodes n. After applying <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Softmax}$$\end{document}</tex-math><mml:math id="M200"><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq95.gif"/></alternatives></inline-formula> on the output of MLP layer, each row of <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M202"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq96.gif"/></alternatives></inline-formula> is the probability of the corresponding node belonging to the <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{{{{{{\bf{G}}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq98.gif"/></alternatives></inline-formula>, denoted as <inline-formula id="IEq99"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right),p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)\right]$$\end{document}</tex-math><mml:math id="M208"><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq99.gif"/></alternatives></inline-formula>,where <inline-formula id="IEq100"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq100.gif"/></alternatives></inline-formula> represents the generated subgraph of protein graph <inline-formula id="IEq101"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{{{{{{\bf{G}}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq102.gif"/></alternatives></inline-formula> represents the leftover subgraph of protein graph. After training with a sufficient number of training samples, the learned node assignment matrix <inline-formula id="IEq103"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M216"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq103.gif"/></alternatives></inline-formula> is supposed to approach to 0 or 1. Thus, the generated IB-subgraph embedding can be obtained by taking the first row of the product between <inline-formula id="IEq104"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{Z}}}}}}}^{{{{{{\bf{T}}}}}}}$$\end{document}</tex-math><mml:math id="M218"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq104.gif"/></alternatives></inline-formula> and node embedding.</p>
      <p id="Par91">To stabilize the training process of the subgraph generation and separate <inline-formula id="IEq105"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right)$$\end{document}</tex-math><mml:math id="M220"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq105.gif"/></alternatives></inline-formula> from <inline-formula id="IEq106"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)$$\end{document}</tex-math><mml:math id="M222"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq106.gif"/></alternatives></inline-formula>, we apply a connectivity loss as follows:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}={MSE}\left({diag}\left({Norm}\left({Z}^{T}{AZ}\right)\right)-{diag}\left({I}_{2}\right)\right)$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq107"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Norm}\left(\cdot \right)$$\end{document}</tex-math><mml:math id="M226"><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>⋅</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq107.gif"/></alternatives></inline-formula> is the row normalization, <inline-formula id="IEq108"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{A}}}}}}$$\end{document}</tex-math><mml:math id="M228"><mml:mi mathvariant="bold">A</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq108.gif"/></alternatives></inline-formula> is the adjacency matrix of protein graph <inline-formula id="IEq109"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{I}}}}}}}_{{{{{{\bf{2}}}}}}}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">2</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq110.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq111"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2{\times} 2$$\end{document}</tex-math><mml:math id="M234"><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq111.gif"/></alternatives></inline-formula> identity matrix. Minimizing <inline-formula id="IEq112"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq112.gif"/></alternatives></inline-formula> could encourages <inline-formula id="IEq113"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right),p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)\right]\to \left[{{{{\mathrm{0,1}}}}}\right]/\left[{{{{\mathrm{1,0}}}}}\right]$$\end{document}</tex-math><mml:math id="M238"><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>→</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">0, 1</mml:mi></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">1, 0</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq113.gif"/></alternatives></inline-formula>, which results in a distinctive <inline-formula id="IEq114"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M240"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq114.gif"/></alternatives></inline-formula> to stabilize the training process and a compact topology in the subgraph.</p>
      <p id="Par92">Formally, the subgraph information bottleneck seeks the IB-subgraph by optimizing the following objective function:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\max }\limits_{{G}_{{sub}}}I\left(Y,{G}_{{sub}}\right)-\beta I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M242"><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq115"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M244"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq115.gif"/></alternatives></inline-formula> is a weight, <inline-formula id="IEq116"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y$$\end{document}</tex-math><mml:math id="M246"><mml:mi>Y</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq116.gif"/></alternatives></inline-formula> represents the label associated with <inline-formula id="IEq117"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M248"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq117.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq118"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M250"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq118.gif"/></alternatives></inline-formula> represents the original graph. <inline-formula id="IEq119"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M252"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq119.gif"/></alternatives></inline-formula> and <inline-formula id="IEq120"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M254"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq120.gif"/></alternatives></inline-formula> respectively represents the mutual information between <inline-formula id="IEq121"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M256"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq121.gif"/></alternatives></inline-formula> and <inline-formula id="IEq122"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M258"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq122.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq123"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq123.gif"/></alternatives></inline-formula> represents the IB-subgraph embedding.</p>
      <p id="Par93">To optimize the objective function, the lower bound of the first term is formulated as the opposite number of classification loss between the ground truth label and predicted label with subgraph embedding. By minimizing the classification loss, the lower bound of <inline-formula id="IEq124"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M262"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq124.gif"/></alternatives></inline-formula> achieves the maximum value. For the second term, the DONSKER-VARADHAN representation<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> of the KL-divergence is applied to approximate the upper bound of <inline-formula id="IEq125"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M264"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq125.gif"/></alternatives></inline-formula>. The approximation of <inline-formula id="IEq126"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M266"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq126.gif"/></alternatives></inline-formula> can be formulate as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\max }\limits_{{\varphi }_{2}}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\left({\varphi }_{2},{G}_{{sub}}\right)=	 \frac{1}{N}\mathop{\sum }\limits_{i=1}^{N}{Dense}\left({G}_{i},{G}_{{{sub}}_{i}}{{{{{\rm{;}}}}}}{\varphi }_{2}\right)\\ 	 -\log \frac{1}{N}\mathop{\sum }\limits_{i=1,j\ne i}^{N}{e}^{{Dense}\left({G}_{i},{G}_{{{sub}}_{j}}{{{{{\rm{;}}}}}}{\varphi }_{2}\right)}$$\end{document}</tex-math><mml:math id="M268"><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq127"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Dense}\left(\bullet \right)$$\end{document}</tex-math><mml:math id="M270"><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>∙</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq127.gif"/></alternatives></inline-formula> is the dense network of several MLP layers with the concatenation of the embedding of <inline-formula id="IEq128"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M272"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq128.gif"/></alternatives></inline-formula> and <inline-formula id="IEq129"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq129.gif"/></alternatives></inline-formula> as the input.</p>
      <p id="Par94">To minimize <inline-formula id="IEq130"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M276"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq130.gif"/></alternatives></inline-formula>, several inner steps of the maximum optimization of <inline-formula id="IEq131"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq131.gif"/></alternatives></inline-formula> are applied to minimize the upper bound of <inline-formula id="IEq132"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M280"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq132.gif"/></alternatives></inline-formula>.</p>
      <p id="Par95">After obtaining the embedding of the generated protein IB-subgraph, we concatenate the molecular embedding and protein IB-subgraph embedding as the input to the MLP classification layer. The DTI classification loss could be formulated as:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y}={MLP}\left({concatenate}\left({G}_{m},{G}_{{sub}}\right){{{{{\rm{;}}}}}}{\theta }_{{cls}}\right)$$\end{document}</tex-math><mml:math id="M282"><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}=-y\log \hat{y}-\left(1-y\right)\log \left(1-\hat{y}\right)$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mi>log</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mi>log</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par96">The overall loss can be formulated as:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\min }\limits_{{\theta }_{M},{\theta }_{P},{\varphi }_{1},{\varphi }_{2},{\theta }_{{cls}}}{{{{{{\mathscr{L}}}}}}}_{{base}}={{{{{{\mathscr{L}}}}}}}_{{cls}}+{\lambda }_{1}{{{{{{\mathscr{L}}}}}}}_{{MSE}}+{\lambda }_{2}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M286"><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equa"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s.t.{\varphi }_{2}^{*}={\arg }\mathop{\max }\limits_{{\varphi }_{2}}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq133"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{1}$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{2}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq134.gif"/></alternatives></inline-formula> are weights to balance the importance of different losses, <inline-formula id="IEq135"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{M}}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">,</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq135.gif"/></alternatives></inline-formula> are the parameters of <inline-formula id="IEq136"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{GCN}}}}}}}_{{{{{{\rm{m}}}}}}}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq136.gif"/></alternatives></inline-formula> and <inline-formula id="IEq137"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{GCN}}}}}}}_{{{{{{\rm{p}}}}}}}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq137.gif"/></alternatives></inline-formula>, <inline-formula id="IEq138"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\varphi }}}}}}}_{{{{{{\bf{1}}}}}}}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq138.gif"/></alternatives></inline-formula> is the parameters of IB-subgraph generator, <inline-formula id="IEq139"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\varphi }}}}}}}_{{{{{{\bf{2}}}}}}}$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">2</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq139.gif"/></alternatives></inline-formula> is the parameters of the dense network, and <inline-formula id="IEq140"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{cls}}}}}}}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq140.gif"/></alternatives></inline-formula> is the parameters of the MLP layer.</p>
      <p id="Par97">Here, we summarize the training process, the <inline-formula id="IEq141"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq141.gif"/></alternatives></inline-formula> measures the discrepancy between the estimated distribution and the original data distribution by utilizing the cross-entropy between the predicted values and the ground truth (the DTI labels instead of binding pocket labels). The <inline-formula id="IEq142"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq142.gif"/></alternatives></inline-formula>, as indicated by Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>), encourages the node assignment matrix <inline-formula id="IEq143"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M310"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq143.gif"/></alternatives></inline-formula> to approach close to either 1 or 0. The <inline-formula id="IEq144"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq144.gif"/></alternatives></inline-formula>, as indicated by Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>), represents an approximation of <inline-formula id="IEq145"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M314"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq145.gif"/></alternatives></inline-formula> introduced in Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>). To maximize Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) and achieve subgraph information bottleneck, the lower bound of <inline-formula id="IEq146"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M316"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq146.gif"/></alternatives></inline-formula> needs to increase as much as possible and the upper bound of <inline-formula id="IEq147"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M318"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq147.gif"/></alternatives></inline-formula> needs to decrease. Therefore, we begin by performing gradient descent on the negative of <inline-formula id="IEq148"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq148.gif"/></alternatives></inline-formula> within the dense network. The goal is to maximize <inline-formula id="IEq149"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq149.gif"/></alternatives></inline-formula> and achieve the upper bound of <inline-formula id="IEq150"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M324"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq150.gif"/></alternatives></inline-formula>, thus satisfying the constraints of Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>). After that, we utilize gradient descent to optimize Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>). By optimizing <inline-formula id="IEq151"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq151.gif"/></alternatives></inline-formula>, we increase the lower bound of <inline-formula id="IEq152"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M328"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq152.gif"/></alternatives></inline-formula>, and decrease the upper bound of <inline-formula id="IEq153"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M330"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq153.gif"/></alternatives></inline-formula> by optimizing <inline-formula id="IEq154"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq154.gif"/></alternatives></inline-formula>. This approach aims to maximize Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) and seek the subgraph information bottleneck for detecting potential binding pockets in proteins.</p>
      <p id="Par98">In our task, we aim to find the protein binding pocket under the weakly supervised training process, since the amount of protein binding pockets data is much smaller than the amount of binding data. So we design the IB-subgraph to find the protein binding pockets optimized on the DTI binding labels instead of binding pocket labels in proteins. Considering the protein pockets are determined by both proteins and molecules, we take the concatenation of molecule embedding and protein embedding as input when we generate the node assignment matrix <inline-formula id="IEq155"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M334"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq155.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>).</p>
    </sec>
    <sec id="Sec16">
      <title>Task adaptive self-attention</title>
      <p id="Par99">In a traditional meta-learning schedule, <inline-formula id="IEq156"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${batch\_size}$$\end{document}</tex-math><mml:math id="M336"><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mo>_</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq156.gif"/></alternatives></inline-formula> tasks are sampled and treated with the same weight when applying mini-batch gradient descent. However, the same weight of multiple tasks can’t reflect the importance of different tasks contributing to the meta-model optimization. We further design a task adaptive self-attention module (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>) to learn the importance of different tasks automatically. Since each task is a DTI prediction of a specific protein, we take the concatenation of protein subgraph embedding and the average of the embeddings of all molecules in the query set as the task embedding. The self-attention module is:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${h}_{{T}_{b}}={concatenate}\left({G}_{p},{Mean}\left({\left\{{G}_{m}^{i}\right\}}_{i=1}^{m}\right)\right)$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}Q={W}_{Q}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\\ K={W}_{K}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\\ V={W}_{V}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\end{array}$$\end{document}</tex-math><mml:math id="M340"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\eta }_{{T}_{b}}\right\}}_{b=1}^{B}={Attention}\left(Q,K,V\right)={softmax}\left(\frac{Q{K}^{T}}{\sqrt{{d}_{k}}}\right)V$$\end{document}</tex-math><mml:math id="M342"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>16</label><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{all}}=\mathop{\sum }\limits_{b=1}^{B}{\eta }_{{T}_{b}}{{{{{{\mathscr{L}}}}}}}_{{query},b}$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq157"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{b}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq157.gif"/></alternatives></inline-formula> is one of the DTI tasks, <inline-formula id="IEq158"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{h}}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{b}}}}}}}}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq158.gif"/></alternatives></inline-formula> represents the task embedding, <inline-formula id="IEq159"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{Q}}}}}}}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq159.gif"/></alternatives></inline-formula>, <inline-formula id="IEq160"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{K}}}}}}}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq160.gif"/></alternatives></inline-formula> and <inline-formula id="IEq161"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{V}}}}}}}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq161.gif"/></alternatives></inline-formula> are learnable parameter matrices, <inline-formula id="IEq162"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Q}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{K}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{V}}}}}}$$\end{document}</tex-math><mml:math id="M356"><mml:mi mathvariant="bold">Q</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">K</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">V</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq162.gif"/></alternatives></inline-formula> are the generated attention matrices, <inline-formula id="IEq163"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{k}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq163.gif"/></alternatives></inline-formula> is the dimension of task embedding to normalize the variance of <inline-formula id="IEq164"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Q}}}}}}{{{{{{\bf{K}}}}}}}^{{{{{{\bf{T}}}}}}}$$\end{document}</tex-math><mml:math id="M360"><mml:mi mathvariant="bold">Q</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq164.gif"/></alternatives></inline-formula> and stabilize gradient values during training, and <inline-formula id="IEq165"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{b}}}}}}}}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq165.gif"/></alternatives></inline-formula> is the generated weight to balance the importance of different task.</p>
      <p id="Par100">MetaDTA<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> uses multi-head cross-attention network to capture the relationships between the support and the query ligands instead of different proteins, where it does not use any protein information. In contrast, ZeroBind utilizes a task adaptive self-attention module to learn the importance for different tasks of proteins, and it focuses on the shared binding patterns among different proteins.</p>
    </sec>
    <sec id="Sec17">
      <title>Experimental settings</title>
      <p id="Par101">We take graph convolutional networks as base graph neural network. In our experiment, the GCN layer number of <inline-formula id="IEq166"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq166.gif"/></alternatives></inline-formula> is set as 4 and we set the embedding dimensions as 1280,512,256,256,256, and the GCN layer number of <inline-formula id="IEq167"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{M}}}}}}}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq167.gif"/></alternatives></inline-formula> is set as 3, the embedding dimensions we set are 256,256,256. We set the update step in inner loops as 5. 20 inner steps of the maximum optimization of <inline-formula id="IEq168"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq168.gif"/></alternatives></inline-formula> are applied. We set the <inline-formula id="IEq169"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{1}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq169.gif"/></alternatives></inline-formula> and <inline-formula id="IEq170"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{2}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq170.gif"/></alternatives></inline-formula> as 0.05. The learning rate of optimization of <inline-formula id="IEq171"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq171.gif"/></alternatives></inline-formula> is set at 0.01. The meta learning rate is using simulated annealing algorithm. We use Pytorch to implement the model and run it on a GPU.</p>
    </sec>
    <sec id="Sec18">
      <title>Baseline methods</title>
      <p id="Par102">We compare ZeroBind with multiple baselines to evaluate its advantages, and calculate the area under the receiver operating characteristic (AUROC) and the area under the precision-recall curve (AUPRC) on three independent test sets and one few-shot test set.<list list-type="order"><list-item><p id="Par103">DeepConv-DTI<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>: DeepConv-DTI trains a CNN to learn the embedding of the neighboring residues and an MLP to learn the molecular fingerprint, which is concatenated to make DTI prediction.</p></list-item><list-item><p id="Par104">GraphDTA<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>: GraphDTA leverages multiple types of GNN models to embed molecular embeddings and a CNN model to embed protein residue features.</p></list-item><list-item><p id="Par105">Deeppurpose<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>: Deeppurpose is a state-of-art deep learning library for DTI prediction with multiple backbone networks. Here we use CNN as the backbone network for learning embeddings of both drugs and proteins.</p></list-item><list-item><p id="Par106">AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>: AI-bind uses pre-trained mol2vec and protvec models to initialize the molecule embedding and protein embedding, and makes the DTI predictions by concatenating the molecule embedding and protein embedding.</p></list-item><list-item><p id="Par107">DrugBAN<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>: DrugBAN uses a deep bilinear attention network (BAN) framework with domain adaptation to explicitly learn local pairwise interactions between drugs and targets.</p></list-item></list></p>
    </sec>
    <sec id="Sec19">
      <title>Reporting summary</title>
      <p id="Par108">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_43597_MOESM1_ESM.pdf">
            <caption>
              <p>SupplementaryInformation</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_43597_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_43597_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec21">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_43597_MOESM4_ESM.xlsx">
            <caption>
              <p>Source data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-43597-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the National Key Research and Development Program of China (No. 2020AAA0107600 to X.P.), the National Natural Science Foundation of China (No. 61725302 and 62073219 to H.B.S., 61903248 to X.P.), and the Science and Technology Commission of Shanghai Municipality (20S11902100 to X.P., 22511104100 to H.B.S.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Y.W. contributed to writing the manuscript, data curation, and preparation, implemented the prediction model and performing the experiments, running docking simulation, and writing the manuscript. Y.X. contributed to data preparation and writing the manuscript. J.Y., Y.Y., and H.B.S. provided the guidance on designing the model and experiments and writing the manuscript. X.P. conceived the project, designed the experiments, contributed to data analysis and writing the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par109"><italic>Nature Communications</italic> thanks Thin Nguyen, and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The online webserver is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/">http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/</ext-link>. The benchmark dataset is collected from the original database BindingDB (<ext-link ext-link-type="uri" xlink:href="https://www.bindingdb.org/bind/downloads/BindingDB_All_2D_202311_sdf.zip">https://www.bindingdb.org/bind/downloads/BindingDB_All_2D_202311_sdf.zip</ext-link>) and it is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/datasets.html">http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/datasets.html</ext-link> along with the SARS-COV-2 test dataset, and the experimental protein structure data used in this study are downloaded from the RCSB PDB database (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/downloads/">https://www.rcsb.org/downloads/</ext-link>) and the predicted structures by AlphaFold are downloaded from AlphaFold Protein Structure Database (<ext-link ext-link-type="uri" xlink:href="https://www.alphafold.ebi.ac.uk/">https://www.alphafold.ebi.ac.uk/</ext-link>). All PDB and AlphaFold codes can be found on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/myprecioushh/ZeroBind">https://github.com/myprecioushh/ZeroBind</ext-link>). <xref ref-type="sec" rid="Sec21">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source codes of ZeroBind are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/myprecioushh/ZeroBind">https://github.com/myprecioushh/ZeroBind</ext-link>), together with a usage documentation and setup environment.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par110">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peska</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Buza</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Drug-target interaction prediction: a Bayesian ranking approach</article-title>
        <source>Comput. Methods Prog. Biomed.</source>
        <year>2017</year>
        <volume>152</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmpb.2017.09.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagherian</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Machine learning approaches and databases for prediction of drug–target interaction: a survey paper</article-title>
        <source>Brief. Bioinforma.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>247</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbasi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Razzaghi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Poso</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ghanbari-Ara</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Masoudi-Nejad</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Deep learning in drug target interaction prediction: current and future perspectives</article-title>
        <source>Curr. Med. Chem.</source>
        <year>2021</year>
        <volume>28</volume>
        <fpage>2100</fpage>
        <lpage>2113</lpage>
        <pub-id pub-id-type="doi">10.2174/0929867327666200907141016</pub-id>
        <?supplied-pmid 32895036?>
        <pub-id pub-id-type="pmid">32895036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Deng, J., Yang, Z., Ojima, I., Samaras, D. &amp; Wang, F. Artificial intelligence in drug discovery: applications and techniques. <italic>Briefings Bioinformatics</italic><bold>23</bold>, bbab430 (2022).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thafar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Raies</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Albaradei</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Essack</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bajic</surname>
            <given-names>VB</given-names>
          </name>
        </person-group>
        <article-title>Comparison study of computational prediction tools for drug-target binding affinities</article-title>
        <source>Front. Chem.</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>782</fpage>
        <pub-id pub-id-type="doi">10.3389/fchem.2019.00782</pub-id>
        <?supplied-pmid 31824921?>
        <pub-id pub-id-type="pmid">31824921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure-based maximal affinity model predicts small-molecule druggability</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2007</year>
        <volume>25</volume>
        <fpage>71</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1273</pub-id>
        <?supplied-pmid 17211405?>
        <pub-id pub-id-type="pmid">17211405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alonso</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bliznyuk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Gready</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Combining docking and molecular dynamic simulations in drug design</article-title>
        <source>Med. Res. Rev.</source>
        <year>2006</year>
        <volume>26</volume>
        <fpage>531</fpage>
        <lpage>568</lpage>
        <pub-id pub-id-type="doi">10.1002/med.20067</pub-id>
        <?supplied-pmid 16758486?>
        <pub-id pub-id-type="pmid">16758486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepPurpose: a deep learning library for drug–target interaction prediction</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>5545</fpage>
        <lpage>5547</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa1005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving the generalizability of protein-ligand binding predictions with AI-Bind</article-title>
        <source>Nat. Commun.</source>
        <year>2023</year>
        <volume>14</volume>
        <fpage>1989</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-023-37572-z</pub-id>
        <?supplied-pmid 37031187?>
        <pub-id pub-id-type="pmid">37031187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GraphDTA: predicting drug–target binding affinity with graph neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>1140</fpage>
        <lpage>1147</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa921</pub-id>
        <?supplied-pmid 33119053?>
        <pub-id pub-id-type="pmid">33119053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Keum</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>DeepConv-DTI: Prediction of drug-target interactions via deep learning with convolution on protein sequences</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1007129</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007129</pub-id>
        <?supplied-pmid 31199797?>
        <pub-id pub-id-type="pmid">31199797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilson</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BindingDB in 2015: a public database for medicinal chemistry, computational chemistry and systems pharmacology</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D1045</fpage>
        <lpage>D1053</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1072</pub-id>
        <?supplied-pmid 26481362?>
        <pub-id pub-id-type="pmid">26481362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChEMBL web services: streamlining access to drug discovery data and utilities</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>W612</fpage>
        <lpage>W620</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv352</pub-id>
        <?supplied-pmid 25883136?>
        <pub-id pub-id-type="pmid">25883136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The PDBbind database: Collection of binding affinities for protein− ligand complexes with known three-dimensional structures</article-title>
        <source>J. Med. Chem.</source>
        <year>2004</year>
        <volume>47</volume>
        <fpage>2977</fpage>
        <lpage>2980</lpage>
        <pub-id pub-id-type="doi">10.1021/jm030580l</pub-id>
        <?supplied-pmid 15163179?>
        <pub-id pub-id-type="pmid">15163179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The PDBbind database: methodologies and updates</article-title>
        <source>J. Med. Chem.</source>
        <year>2005</year>
        <volume>48</volume>
        <fpage>4111</fpage>
        <lpage>4119</lpage>
        <pub-id pub-id-type="doi">10.1021/jm048957q</pub-id>
        <?supplied-pmid 15943484?>
        <pub-id pub-id-type="pmid">15943484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DrugBank 5.0: a major update to the DrugBank database for 2018</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D1074</fpage>
        <lpage>D1082</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1037</pub-id>
        <?supplied-pmid 29126136?>
        <pub-id pub-id-type="pmid">29126136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sachdev</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive review of feature based methods for drug target interaction prediction</article-title>
        <source>J. Biomed. Inform.</source>
        <year>2019</year>
        <volume>93</volume>
        <fpage>103159</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2019.103159</pub-id>
        <?supplied-pmid 30926470?>
        <pub-id pub-id-type="pmid">30926470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Network-based methods for prediction of drug-target interactions</article-title>
        <source>Front. Pharmacol.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1134</fpage>
        <pub-id pub-id-type="doi">10.3389/fphar.2018.01134</pub-id>
        <?supplied-pmid 30356768?>
        <pub-id pub-id-type="pmid">30356768</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Wang, H., Zhou, G., Liu, S., Jiang, J.-Y. &amp; Wang, W. Drug-target interaction prediction with graph attention networks. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2107.06099">https://arxiv.org/abs/2107.06099</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Öztürk</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ozkirimli</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Özgür</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A comparative study of SMILES-based compound similarity functions for drug-target interaction prediction</article-title>
        <source>BMC Bioinforma.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0977-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perlman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gottlieb</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Atias</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ruppin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sharan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Combining drug and gene similarity measures for drug-target elucidation</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0213</pub-id>
        <?supplied-pmid 21314453?>
        <pub-id pub-id-type="pmid">21314453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mei</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Kwoh</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X-L</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Drug–target interaction prediction by learning from local information and neighbors</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>238</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts670</pub-id>
        <?supplied-pmid 23162055?>
        <pub-id pub-id-type="pmid">23162055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thafar</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DTiGEMS+: drug–target interaction prediction using graph embedding, graph mining, and similarity-based techniques</article-title>
        <source>J. Cheminformatics</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00447-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of drug-target interactions and drug repositioning via network-based inference</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002503</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002503</pub-id>
        <?supplied-pmid 22589709?>
        <pub-id pub-id-type="pmid">22589709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A network integration approach for drug-target interaction prediction and computational drug repositioning from heterogeneous information</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00680-8</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>A semi-supervised method for drug-target interaction prediction with consistency in networks</article-title>
        <source>PlOS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e62975</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0062975</pub-id>
        <?supplied-pmid 23667553?>
        <pub-id pub-id-type="pmid">23667553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SMILES, a chemical language and information system. 1. Introduction to methodology and encoding rules</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>1988</year>
        <volume>28</volume>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00057a005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Backpropagation applied to handwritten zip code recognition</article-title>
        <source>Neural Comput.</source>
        <year>1989</year>
        <volume>1</volume>
        <fpage>541</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="doi">10.1162/neco.1989.1.4.541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elman</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Finding structure in time</article-title>
        <source>Cogn. Sci.</source>
        <year>1990</year>
        <volume>14</volume>
        <fpage>179</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1207/s15516709cog1402_1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Vaswani, A. et al. Attention is all you need. <italic>Adv. Neural Inf. Process. Syst.</italic><bold>30</bold>, 6000–6010 (2017).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiménez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Skalic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martinez-Rosell</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>De Fabritiis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>K deep: protein–ligand absolute binding affinity prediction via 3d-convolutional neural networks</article-title>
        <source>J. Chem. Inf. Modeling</source>
        <year>2018</year>
        <volume>58</volume>
        <fpage>287</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scarselli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gori</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsoi</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Hagenbuchner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Monfardini</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The graph neural network model</article-title>
        <source>IEEE Trans. Neural Netw.</source>
        <year>2008</year>
        <volume>20</volume>
        <fpage>61</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1109/TNN.2008.2005605</pub-id>
        <?supplied-pmid 19068426?>
        <pub-id pub-id-type="pmid">19068426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamilton</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leskovec</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Inductive representation learning on large graphs</article-title>
        <source>31th Conf. Neural Inf. Process. Syst.</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>1025</fpage>
        <lpage>1035</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>GEFA: early fusion approach in drug-target affinity prediction</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>718</fpage>
        <lpage>728</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2021.3094217</pub-id>
        <?supplied-pmid 34197324?>
        <pub-id pub-id-type="pmid">34197324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geirhos</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shortcut learning in deep neural networks</article-title>
        <source>Nat. Mach. Intell.</source>
        <year>2020</year>
        <volume>2</volume>
        <fpage>665</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="doi">10.1038/s42256-020-00257-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Lee, E., Yoo, J., Lee, H. &amp; Hong, S. MetaDTA: meta-learning-based drug-target binding affinity prediction. <italic>ICLR2022 Machine Learning for Drug Discovery</italic> (2022).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Antoniou, A., Edwards, H. &amp; Storkey, A. How to train your MAML. Proc. ICLR 2019 (2019).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>AH</given-names>
          </name>
        </person-group>
        <article-title>The Finley affair: a signal event in the history of forecast verification</article-title>
        <source>Weather Forecast.</source>
        <year>1996</year>
        <volume>11</volume>
        <fpage>3</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1175/1520-0434(1996)011&lt;0003:TFAASE&gt;2.0.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>BioLiP: a semi-manually curated database for biologically relevant ligand–protein interactions</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>41</volume>
        <fpage>D1096</fpage>
        <lpage>D1103</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks966</pub-id>
        <?supplied-pmid 23087378?>
        <pub-id pub-id-type="pmid">23087378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PubChem 2019 update: improved access to chemical data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D1102</fpage>
        <lpage>D1109</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
        <?supplied-pmid 30371825?>
        <pub-id pub-id-type="pmid">30371825</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trott</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
        <source>J. Comput. Chem.</source>
        <year>2010</year>
        <volume>31</volume>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
        <?supplied-pmid 19499576?>
        <pub-id pub-id-type="pmid">19499576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurung</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bhattacharjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Exploring the physicochemical profile and the binding patterns of selected novel anticancer Himalayan plant derived active compounds with macromolecular targets</article-title>
        <source>Inform. Med. Unlocked</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.imu.2016.09.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ganea</surname>
            <given-names>OE</given-names>
          </name>
          <name>
            <surname>Pattanaik</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barzilay</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>EquiBind: geometric deep learning for drug binding structure prediction</article-title>
        <source>Int. Conf. Mach. Learn.</source>
        <year>2022</year>
        <volume>2022</volume>
        <fpage>20503</fpage>
        <lpage>20521</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Landrum, G. RDKit: A software suite for cheminformatics, computational chemistry, and predictive modeling. <italic>Greg Landrum</italic> (2013).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sussman</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein Data Bank (PDB): database of three-dimensional structural information of biological macromolecules</article-title>
        <source>Acta Crystallogr. Sect. D: Biol. Crystallogr.</source>
        <year>1998</year>
        <volume>54</volume>
        <fpage>1078</fpage>
        <lpage>1084</lpage>
        <pub-id pub-id-type="doi">10.1107/S0907444998009378</pub-id>
        <pub-id pub-id-type="pmid">10089483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Hu, W. et al. OGB-LSC A large-scale challenge for machine learning on graphs. <italic>35th Conference on Neural Information Processing Systems (NeurIPS 2021)</italic> Track on Datasets and Benchmarks (2021).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Deep graph learning of inter-protein contacts</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>947</fpage>
        <lpage>953</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab761</pub-id>
        <?supplied-pmid 34755837?>
        <pub-id pub-id-type="pmid">34755837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>
        <source>Science</source>
        <year>2023</year>
        <volume>379</volume>
        <fpage>1123</fpage>
        <lpage>1130</lpage>
        <pub-id pub-id-type="doi">10.1126/science.ade2574</pub-id>
        <?supplied-pmid 36927031?>
        <pub-id pub-id-type="pmid">36927031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hospedales</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Antoniou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Micaelli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Storkey</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Meta-learning in neural networks: a survey</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2021</year>
        <volume>44</volume>
        <fpage>5149</fpage>
        <lpage>5169</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Finn, C., Abbeel, P. &amp; Levine, S. Model-agnostic meta-learning for fast adaptation of deep networks. <italic>Pr. Mach. Learn. Res.</italic><bold>70</bold>, 1126–1135 (2017).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Snell, J., Swersky, K. &amp; Zemel, R. Prototypical networks for few-shot learning. <italic>Adv. Neural Inf. Process. Syst.</italic><bold>30</bold> (2017).</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Yu, J. et al. Recognizing predictive substructures with subgraph information bottleneck. <italic>IEEE Trans. Pattern Anal. Mach. Intell.</italic>10.1109/TPAMI.2021.3112205 (2021).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donsker</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Varadhan</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic evaluation of certain Markov process expectations for large time, I</article-title>
        <source>Commun. Pure Appl. Math.</source>
        <year>1975</year>
        <volume>28</volume>
        <fpage>1</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1002/cpa.3160280102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bai</surname>
            <given-names>PZ</given-names>
          </name>
          <name>
            <surname>Miljkovic</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>John</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>Interpretable bilinear attention network with domain adaptation improves drug-target prediction</article-title>
        <source>Nat. Mach. Intell.</source>
        <year>2023</year>
        <volume>5</volume>
        <fpage>126</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="doi">10.1038/s42256-022-00605-1</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10687269</article-id>
    <article-id pub-id-type="pmid">38030641</article-id>
    <article-id pub-id-type="publisher-id">43597</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-43597-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ZeroBind: a protein-specific zero-shot predictor with subgraph matching for drug-target interactions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0009-0007-5350-7269</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Yuxuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8437-0604</contrib-id>
        <name>
          <surname>Xia</surname>
          <given-names>Ying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9639-7679</contrib-id>
        <name>
          <surname>Yan</surname>
          <given-names>Junchi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4270-8002</contrib-id>
        <name>
          <surname>Yuan</surname>
          <given-names>Ye</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4029-3325</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Hong-Bin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5010-464X</contrib-id>
        <name>
          <surname>Pan</surname>
          <given-names>Xiaoyong</given-names>
        </name>
        <address>
          <email>2008xypan@sjtu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0220qvk04</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Institute of Image Processing and Pattern Recognition, </institution><institution>Shanghai Jiao Tong University, and Key Laboratory of System Control and Information Processing, Ministry of Education of China, </institution></institution-wrap>Shanghai, 200240 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0220qvk04</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Department of Computer Science and Engineering, and MoE Key Lab of Artificial Intelligence, AI Institute, </institution><institution>Shanghai Jiao Tong University, </institution></institution-wrap>Shanghai, 200240 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>7861</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Existing drug-target interaction (DTI) prediction methods generally fail to generalize well to novel (unseen) proteins and drugs. In this study, we propose a protein-specific meta-learning framework ZeroBind with subgraph matching for predicting protein-drug interactions from their structures. During the meta-training process, ZeroBind formulates training a protein-specific model, which is also considered a learning task, and each task uses graph neural networks (GNNs) to learn the protein graph embedding and the molecular graph embedding. Inspired by the fact that molecules bind to a binding pocket in proteins instead of the whole protein, ZeroBind introduces a weakly supervised subgraph information bottleneck (SIB) module to recognize the maximally informative and compressive subgraphs in protein graphs as potential binding pockets. In addition, ZeroBind trains the models of individual proteins as multiple tasks, whose importance is automatically learned with a task adaptive self-attention module to make final predictions. The results show that ZeroBind achieves superior performance on DTI prediction over existing methods, especially for those unseen proteins and drugs, and performs well after fine-tuning for those proteins or drugs with a few known binding partners.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Existing drug-target interaction (DTI) prediction methods generally fail to generalize well unseen proteins and drugs. Here the authors report a protein-specific meta-learning framework, ZeroBind, with subgraph matching for predicting protein-drug interactions from their structures.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Machine learning</kwd>
      <kwd>Virtual drug screening</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China (National Science Foundation of China)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61903248</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pan</surname>
            <given-names>Xiaoyong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Identifying the interactions between drugs and targets (proteins) plays a crucial role in the process of drug discovery<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. However, the traditional experimental methods for resolving the crystal structures of drug-protein complexes to identify the drug-target interactions are costly and time-consuming<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. In order to reduce costs, in silico approaches are gaining more attention. Instead of taking massive candidates into an in vitro search, it is more efficient and less costly to use computational approaches to virtually screen out most candidates prior to an in vitro search. Generally, there are two major groups of in silico approaches, docking simulations and data-driven learning-based methods. Docking simulations utilize the 3D structure of drug molecules and target proteins to identify their potential binding sites, which are also time-consuming<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. In contrast, due to the rapid development of machine learning, utilizing the features derived from proteins and drugs to identify their interactions achieves both high accuracy and low cost.</p>
    <p id="Par4">Data-driven learning methods generally formulate drug-target interaction (DTI) prediction as binary classification or regression tasks<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>, where interacting pairs of proteins and drugs are extracted from existing databases like BindingDB<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, CHEMBL<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, PDBbind<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>, and DrugBank<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Since the nature of potency values is logarithmic, a decrease in kinetic constants from micromolar to nanomolar levels results in an exponential change. Thus, the output values of regression tasks are normally defined as the negative log of kinetic constants, i.e., <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq4.gif"/></alternatives></inline-formula>. For classification tasks, a threshold is set to define binding or nonbinding according to <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq5.gif"/></alternatives></inline-formula>, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq8.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. Machine learning-based methods from molecules and proteins features mainly focus on learning a good representation of molecules and proteins, which are then fed into a classification/regression model to perform the prediction task<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
    <p id="Par5">Recently, deep learning has achieved exciting results in DTI prediction by learning from known drug-target interactions. However, these methods cannot generalize well to those unseen proteins and drugs<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. Similarity/distance-based<sup><xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup> and network-based<sup><xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup> methods, which utilize protein-protein similarity, drug-drug similarity and known DTIs, achieve overestimated performance on the transductive test<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, where both proteins and ligands in the test set are present in the training set. In addition, there are often few known binding drugs with a newly discovered target protein, making it difficult to work on the inductive test, where both proteins and ligands in the test set are absent in the training set. Currently, most existing methods focus on how to effectively learn representations of molecules and proteins, and then feed the representations into classification or regression models<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. The representation learning methods, like DeepPurpose<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, take molecular fingerprints and SMILES<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> strings as the molecular features and amino acid sequences as protein features. Then they apply a convolutional neural network (CNN)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, recurrent neural network (RNN)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> or Transformer<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> model to embed the input features. To take spatial information into consideration, some methods apply CNNs to 3D images derived from structures of proteins and molecule<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. GNN<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> has gained much attention in recent years due to its capability of handling graphs as non-Euclidean structured data<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Other methods utilize GNNs to embed graphs of proteins and molecules to perform DTI prediction<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. DTI prediction also benefits from the rapid development of GNNs since both drug and target protein are naturally graph-structured data. GEFA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> combines pre-trained protein embeddings and a graph-in-graph neural network with an attention mechanism to capture the interactions between drugs and protein residues. Thus, it is reasonable to use GNNs for the representation learning of proteins and drugs.</p>
    <p id="Par6">However, classical pair-input approaches often take drug-protein pairs as training samples by concatenating and feeding their representations into a dense layer to identify the interactions. However, these approaches may fail at inductive tests for unseen proteins and drugs not seen during the model training, which is due to their potential shortcuts<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> that remember the degree ratio of binding annotations in the training set rather than learning the molecular features of interactions<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. To generalize to unseen proteins and drugs, AI-Bind leverages network-derived negatives and pre-training to resolve the shortcut learning issue<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Furthermore, proteins may have diverse binding patterns with drugs, which can be captured by training a protein-specific model for individual proteins. Recently, a ligand-based method MetaDTA<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> is developed as a few-shot predictor for proteins with a few known binding drugs under the meta-learning framework. However, MetaDTA does not support zero-shot prediction for unseen proteins without known binding drugs in the training set.</p>
    <p id="Par7">To address these challenges, we propose a protein-specific zero-shot predictor ZeroBind for drug-target interaction prediction under the meta-learning framework. ZeroBind adopts the meta-learning framework MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> as the training strategy and each base model makes binding drug predictions of a specific protein, which mainly consists of four modules: (1) a Graph Convolutional Network (GCN) encoder learning the embeddings of the molecule graph and protein graph, (2) a Subgraph Information Bottleneck (SIB) module generating the essential IB-subgraph of the protein graph as a potential binding pocket, (3) a Multilayer Perceptron (MLP) module concatenating the protein IB-subgraph embedding and molecular embedding to perform DTI prediction, and (4) a task adaptive self-attention module to measure the importance of different tasks, where different DTI tasks contribute differently to the meta-learner. The generated task weight is used for weighted average loss and further incorporated into the meta-learning procedure.</p>
    <p id="Par8">In summary, our contributions are as follows: (1) We formulate the drug-target interaction prediction for unseen drugs and proteins as a zero-shot learning problem. The general knowledge of DTI prediction learned from existing proteins, drugs, and their interactions with meta-learning strategy have a greater ability for generalization to unseen proteins and drugs than existing methods. (2) We train one DTI task model per protein, where task adaptive self-attention is designed to calculate the contributions of multiple DTI tasks to the protein-specific meta-learner. Thus, each protein-specific model captures individual binding patterns to drugs. (3) We propose model-agnostic IB-subgraph learning to automatically discover compressed subgraphs as potential binding pockets in proteins instead of redundant graph information derived from the whole protein. (4) We conduct extensive experiments on three independent zero-shot test sets and one few-shot test set. Results show that ZeroBind consistently outperforms existing methods. Further validation of real-world SARS-COV-2 drug-target binding prediction demonstrates the reliability of ZeroBind predictions and the subgraphs detected by IB-subgraph learning align well with the known binding pockets in proteins.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of ZeroBind</title>
      <p id="Par9">In this study, ZeroBind formulates the DTI prediction as a meta-learning task and proposes a meta-learning framework to solve the generalization problem of unseen proteins and drugs in DTI prediction. Specifically, a meta-learning task is defined as binding drug predictions of a specific protein, where IB-subgraph learning is leveraged to automatically discover compressed subgraphs as potential binding pockets in proteins and a self-attention mechanism is designed to learn weights for each task of a protein. The flowchart of ZeroBind is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><title>The framework of ZeroBind.</title><p><bold>a</bold> Network-based negative sampling strategy. The bipartite network consisting of drugs and protein targets: The square nodes represent the protein nodes and the circle nodes represent the molecule nodes, and there are only edges between different types of nodes, representing the corresponding drug-target interaction. Solid lines represent existing drug-target interactions (DTIs) and dotted lines represent the generated negative interactions with the shortest path distance ≥ 7. <bold>b</bold> The positive ratio of the training set before the network-based negative sampling strategy. <bold>c</bold> The positive ratio of the training set after the network-based negative sampling strategy. <bold>d</bold> Given the support set and query set, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{support}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq9.gif"/></alternatives></inline-formula> is first calculated and utilized to update the base model with parameter <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\theta }}}}}}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq10.gif"/></alternatives></inline-formula> to a task-specific model with parameter <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}^{{{{\prime}}}}$$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq11.gif"/></alternatives></inline-formula> using the support set of each task, and then the task-specific model calculates the <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{query}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq12.gif"/></alternatives></inline-formula> using the query set of the task. After repeating N inner steps, all losses are weighted average by <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\boldsymbol{\omega }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ω</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq13.gif"/></alternatives></inline-formula>, and gradient descent is further performed to optimize the meta model. <bold>e</bold> The architecture of the base model in ZeroBind. For each task, the protein graph and the molecule graph are fed into a backbone graph convolutional network (GCN) with parameters <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{M}}}}}}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq15.gif"/></alternatives></inline-formula>, respectively, to obtain their embeddings. Subsequently, a SIB module is proposed to generate the IB-subgraph of a protein as potential binding pockets in a weakly supervised way. The protein subgraph embedding is concatenated with the molecular embedding and they are fed into a Multilayer Perceptron (MLP) module to identify the interactions. <bold>f</bold> Task adaptive attention module. It takes the concatenation of the protein embedding <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{p}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{k}}}}}}}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq16.gif"/></alternatives></inline-formula> and the average of all molecule embeddings <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{k}}}}}}}^{{{{{{\bf{i}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq17.gif"/></alternatives></inline-formula> in the query set as the task embedding. After using the self-attention layer to compute the weight of each task, denoted as <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq18.gif"/></alternatives></inline-formula>, the overall loss is averaged and incorporated into the meta-training process for updating the model parameters. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig1_HTML" id="d32e716"/></fig></p>
      <p id="Par10">In detail, ZeroBind uses network-based negative sampling<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> as data augmentation to alleviate the annotation imbalance (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, Methods section). Figure <xref rid="Fig1" ref-type="fig">1</xref>b, <xref rid="Fig1" ref-type="fig">c</xref> illustrates the ratio of positive samples before and after network-based negative sampling on the training set, indicating that network-based negative sampling alleviates the annotation imbalance to a certain extent. Then, it samples the DTIs into the support and query set (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>), where the support set is used to train the meta-learner and the query set is used to train the task-specific models. After repeating N inner steps, all losses are weighted to optimize the meta-learner with gradient descent. For each protein, ZeroBind trains a DTI prediction task. Figure <xref rid="Fig1" ref-type="fig">1e</xref> gives the architecture of the base model in ZeroBind, where the protein graph and molecule graph are fed into a backbone GCN to learn embeddings for drugs and proteins. Furthermore, a weakly supervised Subgraph Information Bottleneck (SIB) module is designed to model and discover potential binding pockets in proteins. The SIB module not only reduces redundant information to boost the performance, but also brings interpretable insights into ZeroBind by identifying the critical residues in the protein. Figure <xref rid="Fig1" ref-type="fig">1f</xref> introduces an adaptive self-attention module to measure the contribution of each task of a protein, where different DTI tasks contribute differently to the meta-learner. ZeroBind support predicting DTIs in zero-shot and few-shot scenarios. The former uses the meta-learner to make predictions directly without fine-tuning using the samples of proteins in meta-testing, and the latter uses the protein-specific model to make predictions with fine-tuning using the samples of the protein in meta-testing.</p>
    </sec>
    <sec id="Sec4">
      <title>ZeroBind outperforms existing methods in both zero-shot and few-shot settings for DTI prediction</title>
      <p id="Par11">To demonstrate the advantages of ZeroBind, we compare it with multiple baseline methods and calculate the area under the receiver operating characteristic (AUROC) and the area under the precision-recall curve (AUPRC) on three independent test sets and one few-shot test set. To ensure the effectiveness of performance comparison, we conduct five independent experiments with five random seeds for datasets partitioning and model training, and report the average results along with standard deviation.</p>
      <p id="Par12">The overall performances of all methods in three independent test sets are reported in Fig. <xref rid="Fig2" ref-type="fig">2a</xref> (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). ZeroBind achieves an AUROC of 0.9521(±0.0034), 0.8681(±0.0052), 0.8139(±0.0035) in the Transductive, Semi-inductive, and Inductive test sets, respectively. We can see that ZeroBind outperforms all baseline methods in the Transductive, Semi-inductive, and Inductive test sets. Compared to the best baseline method, ZeroBind achieves relative improvements in AUROC with 2.86% on the Transductive test set, 10.29% on the Semi-inductive test set, and 3.38% on the Inductive test set, the corresponding t-test p-value is 1.02 × 10<sup>−6</sup>, 8.02 × 10<sup>−11</sup>, 3.06 × 10<sup>−7</sup>, respectively. Moreover, the relative improvements of AUPRC are 1.00% on the Transductive test set, 0.96% on the Semi-inductive test set, and 1.21% on the Inductive test set compared to the best baseline method, the corresponding <italic>t</italic>-test <italic>p</italic>-value is 8.93 × 10<sup>−8</sup>, 5.15 × 10<sup>−3</sup>, 1.56 × 10<sup>−5</sup>, respectively. In addition, on the three test sets, we observe that the performance of all methods decreases, indicating that a certain external shortcut learning exists for the Transductive test set.<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance comparison of ZeroBind with baseline methods in zero-shot and few-shot scenarios.</title><p><bold>a</bold> Zero-shot performance evaluation with ZeroBind and baseline methods on three independent test sets. <bold>b</bold> Area Under the Receiver Operating Characteristic Curve (AUROC) comparison of the protein-specific ZeroBind and the baseline methods for 775 proteins in the combined inductive and semi-inductive test set. The color of points stands for the number of training proteins. <bold>c</bold> The number of proteins that the method performs the best among the compared methods for the combined inductive and semi-inductive test sets. <bold>d</bold> Few-shot performance comparison of ZeroBind with baseline methods on the few-shot test sets. Supplementary Tables <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM1" ref-type="media">2</xref> provide the data statistics for zero-shot and few-shot prediction with two-sided <italic>t</italic>-test without adjustment. Source data are provided as a Source Data file. AUPRC refers to Area Under the Precision-recall Curve.</p></caption><graphic xlink:href="41467_2023_43597_Fig2_HTML" id="d32e802"/></fig></p>
      <p id="Par13">Figure <xref rid="Fig2" ref-type="fig">2a</xref> shows that AI-bind and our proposed ZeroBind outperform other baseline methods on the Inductive test set due to the incorporation of network-based negative sampling and unsupervised pre-trained embeddings to avoid the potential shortcut learning. ZeroBind achieves stable and better performance at Transductive and semi-inductive test sets than baseline methods, indicating that ZeroBind can effectively learn useful embeddings of proteins and drugs. Furthermore, ZeroBind achieves better performance in the inductive test set than AI-Bind. The potential reason is that ZeroBind uses a meta-learning framework to obtain a general knowledge of DTI prediction across multiple proteins, which can generalize well to the DTI prediction of unseen proteins and drugs.</p>
      <p id="Par14">We also evaluate the protein-specific DTI prediction performance of ZeroBind with other baseline methods on the inductive test set and semi-inductive test set (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). After excluding proteins without binding or nonbinding labels, we obtain 775 proteins with binding drugs and one task model is trained per protein, here ZeroBind is evaluated on the combined inductive and semi-inductive test sets. ZeroBind achieves an average AUROC of 0.78, which is higher than the AUROC 0.66 of DeepConv-DTI, 0.68 of GraphDTA, 0.69 of Deeppurpose, 0.75 of AI-bind and 0.73 of DrugBAN across the 775 proteins. Of the 775 proteins, ZeroBind outperforms DeepConv-DTI, GraphDTA, Deeppurpose, AI-bind, and DrugBAN for 525, 491, 305, 180 and 346 proteins, respectively. For each method, we present the number of proteins that this method outperforms other methods (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>) according to the number of binding molecules. We observe that ZeroBind outperforms other baseline methods for the most proteins in the three ranges, especially for the proteins with only 1–10 known binding molecules, followed by AI-Bind.</p>
      <p id="Par15">We further evaluate ZeroBind against the baseline methods on the few-shot test set. ZeroBind and other baseline methods are first trained with the training set as the pre-training model, and further fine-tuned on each few-shot fine-tuning set and evaluated on the corresponding few-shot test set. The performance of ZeroBind model and other baselines on the few-shot test set is shown in Fig. <xref rid="Fig2" ref-type="fig">2d</xref> (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>). In the few-shot test, ZeroBind outperforms the best baseline methods with relative improvements of AUROC 1.55% and AUPRC 1.62%. The potential reason is that the meta-learning framework has the strong generalization ability to quickly adapt to additional protein tasks with a few training samples. We can see that fine-tuning improves the zero-shot prediction performance by a large margin, which is very useful for the real-world application scenario that a protein has only a few known binding drugs.</p>
    </sec>
    <sec id="Sec5">
      <title>ZeroBind detects the subgraphs that align well with known binding pockets of proteins in a weakly supervised way</title>
      <p id="Par16">ZeroBind does not use binding pocket information as ground truth labels for model training, instead, it uses the global DTI labels as a weakly supervised labels. To demonstrate that the IB-subgraph module in ZeroBind is able to detect the binding pocket in the protein, we use the Jaccard similarity coefficient<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> to compare the predicted binding pocket against the true binding pocket on PDBbind dataset<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. The true binding pocket information containing pocket residues and 3D coordinate locations are downloaded from PDBbind, which contains 14,000 binding residues for 535 proteins. The Jaccard similarity coefficient is used to calculate the degree of intersection between two sets of individual DTIs, and the formula is defined as <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Jaccard\; similarity\; coefficient}(\hat{P},P)=\frac{\hat{P}\cap P}{\hat{P}\cup P}$$\end{document}</tex-math><mml:math id="M38"><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.16em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∩</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∪</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{P}$$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq20.gif"/></alternatives></inline-formula> represents the set of predicted binding pocket residues by ZeroBind for a DTI, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M42"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq21.gif"/></alternatives></inline-formula> represents the set of true binding residues in the pocket for this DTI.</p>
      <p id="Par17">In addition, we calculate the Jaccard similarity coefficient of predicted binding pockets nodes and the first-order neighbors of the true binding pocket nodes as <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Jaccard\; similarity\; coefficient}(\hat{P},{P}_{{neighbor}})=\frac{\hat{P}\cap {P}_{{neighbor}}}{\hat{P}\cup {P}_{{neighbor}}}$$\end{document}</tex-math><mml:math id="M44"><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.16em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq22.gif"/></alternatives></inline-formula>, <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{{neighbor}}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq23.gif"/></alternatives></inline-formula> represents the set of first-order neighbor pockets of the real binding pocket.</p>
      <p id="Par18">Figure <xref rid="Fig3" ref-type="fig">3</xref>a, <xref rid="Fig3" ref-type="fig">b</xref> shows the distribution of Jaccard similarity coefficients of predicted binding pockets with true binding pockets and the first-order neighbors of true binding pockets, respectively. ZeroBind yields average Jaccard similarity coefficients of 0.358 and 0.605, respectively. For the neighboring pockets, Jaccard similarity coefficients are above 0.5 for most pockets. The results show that despite some discrepancy between the predicted binding pockets and true binding pockets, the predicted binding pockets are mostly around the true binding pockets, indicating the effectiveness of the generated IB-subgraph in ZeroBind as the potential binding pocket with some biological interpretability. We further conduct an experiment of randomly sampled residues as potential protein pockets, here denoted as ZeroBind<sup>random</sup>. The results are shown in the ablation studies and here we also calculate the Jaccard similarity coefficients of randomly sampled binding residues with true binding pockets and the first-order neighbors of true binding pockets, respectively. The ZeroBind<sup>random</sup> yields an average Jaccard similarity coefficients of 0.013 and 0.072 (all the values are below 0.2), which is much smaller than that of ZeroBind, respectively. As shown in Fig. <xref rid="Fig3" ref-type="fig">3a, b</xref>, we can see that the randomly selected binding residues have little overlap with the true binding pockets or their neighbors in proteins. The results indicate that the SIB module in ZeroBind learns the potential binding pockets instead of other unrelated factors, since the DTI binding information is to a certain extent able to guide the IB-subgraph module to locate potential binding pockets.<fig id="Fig3"><label>Fig. 3</label><caption><title>ZeroBind is able to detect binding pockets of proteins in a weakly supervised way.</title><p><bold>a</bold> The distribution of Jaccard similarity coefficients of the predicted binding pockets with the true binding pockets and randomly selected binding residues as binding pockets with the true binding pockets of individual DTIs. <bold>b</bold> The distribution of Jaccard similarity coefficients of the predicted binding pockets with the first-order neighbors of true binding pockets and randomly selected binding residues as binding pockets with the first-order neighbors of true binding pockets of individual DTIs. <bold>c</bold> The Serine/threonine-protein kinase N1 protein. Experimentally validated DTI binding pocket queried by BioLiP. The blue part represents the experimentally validated binding pocket along with the residue name and number. <bold>d</bold> The potential binding pocket predicted by IB-subgraph in ZeroBind. The red part represents the helix structure of protein, the yellow part represents the loop structure of protein and the green part represents the sheet structure of protein. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig3_HTML" id="d32e1089"/></fig></p>
      <p id="Par19">To further demonstrate the effectiveness of the IB-subgraph module, we train a variant ZeroBind for those proteins with known binding pockets using true binding pocket as the node assignment matrix <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M48"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq24.gif"/></alternatives></inline-formula> for the inductive test set. This variant ZeroBind achieves an average AUROC of 0.8278, which is higher than the AUROC 0.8032 of the ZeroBind that uses learned node assignment matrix <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M50"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq25.gif"/></alternatives></inline-formula> by a narrow margin. The experimental results further validate the effectiveness of the IB-subgraph module in ZeroBind.</p>
      <p id="Par20">We further visualize the generated IB-subgraph as the potential binding pocket for Serine/threonine-protein kinase N1 protein in Fig. <xref rid="Fig3" ref-type="fig">3c, d</xref>. We can see that although the IB-subgraph introduces some false positive binding residues due to no known binding pocket information for IB-subgraph module training, the potential binding residues included in the IB-subgraph contain most of the true binding residues deposited in BioLip<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
    </sec>
    <sec id="Sec6">
      <title>ZeroBind is able to predict potential drugs against SARS-COV-2 Proteins</title>
      <p id="Par21">To better demonstrate the effectiveness of ZeroBind, we use Auto-Docking simulations to validate its predicted potential drugs targeting the SARS-COV-2 proteins. Auto-Docking simulation is a time-consuming but reliable tool to simulate the drug-target binding process. To respond quickly to public health emergencies, we need to validate ZeroBind on proteins that don’t have many binding molecules. Thus, we apply ZeroBind to predict the interactions between the structures of 10 SARS-CoV-2 viral proteins not in the training set and 10,000 drugs in PubChem<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, where the PDB IDs for SARS-COV-2 protein structures are given in Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>. Then, we choose top-10 binding confidence pairs based on the predicted scores by ZeroBind and further perform Auto-Docking simulations to validate the effectiveness of ZeroBind predictions with AutoDock Vina<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>.</p>
      <p id="Par22">The average binding affinity of the top-10 predicted pairs by ZeroBind is −7.42 kcal/mole (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>), which are promising drug-target pairs and also validate the reliability of ZeroBind predictions<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. As demonstrated in<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, the average binding affinities are close to −7.5 kcal/mole for three binding pairs of SARS-COV-2 proteins and drugs. Furthermore, we simulate the drug-target binding complex between ORF8 accessory protein and VZBSCWDKCMOJCR-UHFFFAOYSA-N drug in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, it yields a relative good binding affinity score of −8.4 kcal/mole. And we also simulate the drug-target binding complex between ORF3a protein and OLTVRSUIOUTBRQ-UHFFFAOYSA-N drug in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, which yields a binding affinity score of −5.8 kcal/mole. As shown in Fig. <xref rid="Fig4" ref-type="fig">4b, c</xref>, we can see that the predicted drugs bind well to the pockets in SARS-COV-2 proteins. In future work, we expect ZeroBind to validate the potential drugs against the target proteins, especially those proteins with no verified drugs.<fig id="Fig4"><label>Fig. 4</label><caption><title>ZeroBind predicts binding drugs for SARS-COV-2 proteins.</title><p><bold>a</bold> Top 10 drug-target binding pairs of SARS-COV-2 proteins. <bold>b</bold> The drug-target binding complex between the drug InChI Key VZBSCWDKCMOJCR-UHFFFAOYSA-N and SARS-CoV-2 ORF8 protein. The green part represents the main part of the protein, the blue part represents the binding drug and the red part represent potential binding sites consisting of the residue name and number. <bold>c</bold> The drug-target binding complex between the drug InChI Key OLTVRSUIOUTBRQ-UHFFFAOYSA-N and SARS-CoV-2 ORF3a protein. The purple part and blue part represents the two main chains of ORF3a protein, the green part represents the binding drug and the red part represent potential binding sites consisting of the residue name and number. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig4_HTML" id="d32e1175"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Ablation studies on ZeroBind</title>
      <p id="Par23">To demonstrate the added value of individual modules in ZeroBind, we also conducted an ablation study to evaluate the effectiveness. The details of ZeroBind with different modules are illustrated as follows:<list list-type="order"><list-item><p id="Par24">ZeroBind<sup>MAML-</sup>: Train the base model of ZeroBind directly without the meta-learning strategy.</p></list-item><list-item><p id="Par25">ZeroBind<sup>SIB-</sup>: Using all node embeddings of the protein to identify the interaction instead of applying a SIB module to find the IB-graph on the protein graph.</p></list-item><list-item><p id="Par26">ZeroBind<sup>attention-</sup>: ZeroBind without task adapted attention module to balance the importance of different tasks.</p></list-item><list-item><p id="Par27">ZeroBind<sup>GIN</sup>: ZeroBind uses GIN instead of GCN as the backbone GNN.</p></list-item><list-item><p id="Par28">ZeroBind<sup>random</sup>: ZeroBind sets the node assignment matrix <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M52"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq26.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) randomly.</p></list-item></list></p>
      <p id="Par29">The results are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. For ZeroBind<sup>MAML-</sup>, we observe a significant decrease in the semi-inductive and inductive test sets, demonstrating that the meta-learning training strategy provides the powerful generalization ability to unseen proteins and drugs. We can see that ZeroBind<sup>SIB-</sup> yields a lower performance without the SIB module to find the IB-subgraph, indicating the embedding of the whole protein is less effective than the subgraph embedding. The potential reason is that redundant graph information exists in the whole protein graph, further indicating that the molecule binds to a binding pocket instead of the whole protein. ZeroBind<sup>attention-</sup> performs slightly worse than ZeroBind, indicating the necessity of task adaptive self-attention module to balance different DTI tasks for different proteins. We also see a performance decline for ZeroBind<sup>sampling-</sup>, due to the lack of the value-generated nonbinding annotations by network-based negative samplings that is able to alleviate the potential short-cut learning. For ZeroBind<sup>GIN</sup>, there is no significant difference in the performance compared with ZeroBind, which indicates that the backbone GNN has a smaller impact on the performance than other modules in ZeroBind. Compared to randomly selected binding pockets, ZeroBind<sup>random</sup> performs worse than ZeroBind, further validating the effectiveness of the SIB module for detecting potential binding pockets. Moreover, we can see that ZeroBind<sup>random</sup> with randomly selected pockets performs worse than ZeroBind<sup>SIB-</sup> without the IB-subgraph module, indicating that initially inaccurate binding pockets guides the model to not locate true binding pockets, resulting in a wrong DTI prediction.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance evaluation of ablation studies on ZeroBind</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Metric</th><th>Model</th><th>Transductive test</th><th>Semi-inductive test</th><th>Inductive test</th></tr></thead><tbody><tr><td rowspan="7">AUROC</td><td>ZeroBind<sup>MAML-</sup></td><td>0.8632 ± 0.0071</td><td>0.7835 ± 0.0063</td><td>0.6153 ± 0.0031</td></tr><tr><td>ZeroBind<sup>SIB-</sup></td><td>0.8556 ± 0.0056</td><td>0.8018 ± 0.0121</td><td>0.7122 ± 0.0042</td></tr><tr><td>ZeroBind<sup>attention-</sup></td><td>0.9057 ± 0.0078</td><td>0.8352 ± 0.0020</td><td>0.7585 ± 0.0026</td></tr><tr><td>ZeroBind<sup>sampling-</sup></td><td>0.9066 ± 0.0018</td><td>0.8280 ± 0.0031</td><td>0.7852 ± 0.0043</td></tr><tr><td>ZeroBind<sup>GIN</sup></td><td>0.9412 ± 0.0050</td><td>0.8652 ± 0.0046</td><td>0.8025 ± 0.0027</td></tr><tr><td>ZeroBind<sup>random</sup></td><td>0.8865 ± 0.0017</td><td>0.8254 ± 0.0082</td><td>0.7562 ± 0.0031</td></tr><tr><td><bold>ZeroBind</bold></td><td><bold>0.9521</bold> ± 0.0038</td><td><bold>0.8681</bold> ± 0.0065</td><td><bold>0.8139</bold> ± 0.0045</td></tr><tr><td rowspan="7">AUPRC</td><td>ZeroBind<sup>MAML-</sup></td><td>0.9540 ± 0.0044</td><td>0.9115±0.0010</td><td>0.8547 ± 0.0027</td></tr><tr><td>ZeroBind<sup>SIB-</sup></td><td>0.9385 ± 0.0117</td><td>0.9375 ± 0.0028</td><td>0.9242 ± 0.0058</td></tr><tr><td>ZeroBind<sup>attention-</sup></td><td>0.9789 ± 0.0050</td><td>0.9742 ± 0.0065</td><td>0.9408 ± 0.0061</td></tr><tr><td>ZeroBind<sup>sampling-</sup></td><td>0.9782 ± 0.0027</td><td>0.9645 ± 0.0063</td><td>0.9655 ± 0.0057</td></tr><tr><td>ZeroBind<sup>GIN</sup></td><td>0.9831 ± 0.0043</td><td>0.9850 ± 0.0058</td><td>0.9817 ± 0.0062</td></tr><tr><td>ZeroBind<sup>random</sup></td><td>0.9635 ± 0.0056</td><td>0.9375 ± 0.0151</td><td>0.9288 ± 0.0071</td></tr><tr><td><bold>ZeroBind</bold></td><td><bold>0.9896</bold> ± 0.0013</td><td><bold>0.9880</bold> ± 0.0062</td><td><bold>0.9872</bold> ± 0.0020</td></tr></tbody></table><table-wrap-foot><p>The average is reported after performing each experiment five times, along with the standard deviation. The bold face indicates the method is the best across the compared methods.</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par30">The interaction of proteins with drug molecules is an important research topic, especially in the face of proteins and drug molecules not seen in the training set. Considering the information of proteins and molecules simultaneously is an under-explored idea to solve this problem. In this study, we formulate the drug-target interaction (DTI) prediction as a meta-learning task and propose a meta-learning framework called ZeroBind to solve the generalization problem of unseen proteins and drugs in DTI. Specifically, a meta-learning task is defined as binding drug predictions of a specific protein. The results demonstrate that ZeroBind outperforms existing methods in zero-shot and few-shot scenarios. In addition, the subgraphs learned by SIB align well with binding pockets in the protein, where randomly selected residues as binding pockets almost do not overlap with true binding pockets. Furthermore, we validate ZeroBind’s performance in a real-world scenario, where it predicts drug-target bindings for SARS-COV-2.</p>
    <p id="Par31">Due to the rapid development of the research on GNNs, proteins and molecules can be encoded in a more natural form than sequences in previous studies. In addition, the meta-learning strategy also provides a more precise way of delineating the protein-specific DTI task space, which is also consistent with the experimental workflow for proteins in real drug experiments. However, ZeroBind also has some limitations, such as the difficulty of meta-learning training, where the training procedure is complex and prone to instability.</p>
    <p id="Par32">The IB-subgraph method offers an interpretable ability of the model for understanding representation learning. In ZeroBind, the potential binding pockets are automatically detected with the weakly supervised IB-subgraph method that does not use binding pocket annotations as labels. To the best of our knowledge, still no published methods use IB-subgraph or other subgraph-based methods to identify potential binding pockets in the proteins, existing subgraph-based methods are focused on drug molecules. In the current study, we do not incorporate real binding pocket information into model training, since the binding pocket data is far less than the DTI data, and the protein structures predicted by AlphaFold2 still have no known binding pocket annotations. Of the proteins in the benchmark dataset, only 535 proteins have a part of known binding pockets. Thus, it is difficult to train the SIB module in ZeroBind for all proteins to detect binding pockets using the local binding pocket labels. Instead, we train the SIB module of ZeroBind using the global DTI binding labels, which potentially guides the SIB module to locate the potential binding pockets in proteins. As shown in our experiment, ZeroBind with true binding pockets yields better performance. A future update of ZeroBind is expected to take true binding pocket information into the training process to make a more accurate fitting to the DTI problem, if we can collect more true binding pocket data.</p>
    <p id="Par33">Furthermore, the base model in ZeroBind is GCN and there have been more advanced neural architectures for protein-molecule binding, such as SE(3)-equivariant GNN used in EquiBind<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. In future work, we expect to investigate more advanced GNNs in ZeroBind.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Dataset generation and augmentation</title>
      <p id="Par34">BindingDB<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> is a public database of DTI interactions, which deposits binding affinity data between drugs (drug-like molecules) and target proteins. It currently contains over 2,600,000 experimentally determined binding affinities of protein-drug complexes between over 8000 protein targets and over 1,100,000 small molecules.</p>
      <p id="Par35">To create the training and test datasets for ZeroBind, we apply several filtering and preprocessing steps to create a high-quality benchmark dataset. First, data points are filtered with “single protein” for the “target type” attribute, and kinetic constants <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq28.gif"/></alternatives></inline-formula>, <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq30.gif"/></alternatives></inline-formula> for the “standard type” attribute. In addition, all target proteins should be human or human-like proteins, so they are filtered using “Homo sapiens” for “Target Source Organism” attribute. After excluding proteins that don’t have SwissProt name and molecules that cannot be handled by RDKit<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, 1,500,000 protein-drug pairs were collected. We use the threshold in AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, which treats kinetic constants <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq32.gif"/></alternatives></inline-formula>, <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50} &lt; $$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq34.gif"/></alternatives></inline-formula>1000 nM as positive samples and <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ &gt; {10}^{6}$$\end{document}</tex-math><mml:math id="M70"><mml:mo>&gt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq35.gif"/></alternatives></inline-formula> nM as negative samples.</p>
      <p id="Par36">To demonstrate the effectiveness of ZeroBind, we construct three independent test sets for model evaluation through protein sequence similarity clustering by cd-hit and molecule scaffold split: (1) Transductive test set, where molecules with the same scaffold and proteins with the same cluster are in the training set, but their interactions do not exist in the training set; (2) Semi-inductive test set, where the proteins in the same cluster are in the training set, but the molecules with the same scaffold are not; (3) Inductive test set, where molecules with the same scaffolds and proteins in the same clusters are not in the training set.</p>
      <p id="Par37">We first use cd-hit, a widely used program for clustering protein sequences, to cluster 1603 proteins into 1101 clusters with a similarity threshold 0.4. Through comparing molecule scaffolds, we split the molecules into the training molecule set and test molecule set with a training ratio of 0.95, and ensure that these two sets do not have overlapping scaffolds. As the meta-learning-based framework requires sufficient data, we first divide the clusters that have any protein with the number of associated molecules &lt;20 into the test clusters, and the remaining clusters as the training clusters. Then, we construct the training set using 95% of the proteins in the training clusters and SMILES in the training molecules set. The remaining 5% of the proteins in the training clusters and smiles in the training molecules set are used as the Transductive test set. Finally, the proteins and smiles both in the test clusters and molecule set are further used as the Inductive test set, and the rest data are used as the Semi-inductive test set. During the model training, the cross-validation approach is applied for model optimization.</p>
      <p id="Par38">In addition, we construct another few-shot test set with combining the Semi-inductive test set and the Inductive test set to evaluate the few-shot learning power of ZeroBind. Then, we randomly select 5 positive and 5 negative DTIs of each protein as the few-shot fine-tuning set, and the rest DTIs of each protein as the few-shot test set. Proteins that don’t have enough positive or negative DTIs are excluded from the few-shot fine-tuning set and the few-shot test set. The details of the training set and four test sets are given in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The details of the training set and four test sets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Number of proteins</th><th>Number of drugs</th><th>Number of interactions</th></tr></thead><tbody><tr><td>Training set</td><td>426</td><td>248,997</td><td>392,032</td></tr><tr><td>Transductive test set</td><td>392</td><td>16,946</td><td>17,314</td></tr><tr><td>Semi-inductive test set</td><td>1575</td><td>159,182</td><td>228,320</td></tr><tr><td>Inductive test set</td><td>688</td><td>7261</td><td>10,165</td></tr><tr><td>Few-shot test set</td><td>1253</td><td>127,665</td><td>160,948</td></tr></tbody></table></table-wrap></p>
      <p id="Par39">We observe there exists data imbalance in the training set, and most proteins have a high positive ratio. AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> demonstrates that the annotation imbalance causes the network to learn topological shortcuts instead of the binding patterns of drug-target interactions. Similar to AI-Bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, we use the network-based negative sampling of training datasets as data augmentation to alleviate the annotation imbalance. Specifically, we construct a bipartite drug-target network. The bipartite network is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. Dijkstra’s Algorithm is used to find the shortest path distances between any pairs of nodes in the network, and we consider the node pairs with the shortest path distance ≥ 7 in the network as non-binding pairs. After this processing, the annotation imbalance was slightly relieved as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, <xref rid="Fig1" ref-type="fig">c</xref>.</p>
      <p id="Par40">The 3D structures of 996 proteins in this study are downloaded in PDB format from the RCSB Protein Data Bank (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org">https://www.rcsb.org</ext-link>)<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, and the rest 3D structures of 635 proteins are predicted by AlphaFold2<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. In addition, we download the true binding pocket information containing pocket residuals and pocket 3D coordinate locations from the PDBbind database, which contains binding pockets for 14,336 DTIs.</p>
    </sec>
    <sec id="Sec11">
      <title>Graph construction for proteins and drugs</title>
      <p id="Par41">In this section, we first introduce the construction of drug graphs and protein graphs, and then give formal definitions of the DTI task and its derivatives, zero-shot DTI predicting task and few-shot DTI predicting task.</p>
      <p id="Par42">After using RDkit<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> to construct a molecule from a SMILES<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> string, we apply the encoding format used in Open Graph Benchmark (OGB) datasets<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> to obtain molecular representation. Specifically, atom chemical features consist of atomic number, chirality, atomic formal charge, number of hydrogen atoms attached, radical electrons number, hybridization type, and aromatic. Geometric features consist of atom degree, and a binary value that whether in the ring is used for encoding node representation. Edge features consist of bond type, bond stereo and a binary value that whether bond is conjugated.</p>
      <p id="Par43">Definition 1: We define a drug as a graph denoted as <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{m}=\left\{{V}_{m},{E}_{m}\right\}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq36.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{m}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq37.gif"/></alternatives></inline-formula> is the node set representing the atoms of a molecule and <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{m}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq38.gif"/></alternatives></inline-formula> is the edge set indicating which pair of nodes are connected.</p>
      <p id="Par44">Definition 2: We define a protein graph as <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{p}=\left\{{V}_{p},{E}_{p}\right\}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq39.gif"/></alternatives></inline-formula> from the protein 3D structure, where <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{p}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq40.gif"/></alternatives></inline-formula> is the node set of the residues, <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{p}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq41.gif"/></alternatives></inline-formula> is the edge set indicating which pair of residue nodes are connected. In this study, if the Euclidean distance between two residues in 3D structure space is less than 8 angstroms (Å)<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>, the two residue nodes are connected with one edge in the protein graph.</p>
      <p id="Par45">For proteins without known 3D structures, we use AlphaFold2<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to predict their structures as complementary. The node features of the protein graph are initialized with pre-trained ESM-2<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> emebddings, a general-purpose protein language model, of the residues to incorporate prior knowledge. The edge features of the protein graph are the Euclidean distance between the pairs of nodes. The whole process of constructing a protein graph is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><title>The data processing of ZeroBind.</title><p><bold>a</bold> The process of constructing a protein graph from the protein 3D structure. Instead of using peptide bonds as edges, we connect two residues with the cutoff distance &lt; 8 angstroms (Å), where edges and node features are extracted using ESM-2 pretrained model. <bold>b</bold> An example of the protein graph construction from the protein 3D structure. <bold>c</bold> The few-shot DTI prediction process and zero-shot DTI prediction process.</p></caption><graphic xlink:href="41467_2023_43597_Fig5_HTML" id="d32e1880"/></fig></p>
      <p id="Par46">In this work, we train a DTI task per protein.</p>
      <p id="Par47">Definition 3: We define a DTI task <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{p}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq42.gif"/></alternatives></inline-formula> from a task set <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathscr{T}}}}}}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq43.gif"/></alternatives></inline-formula> for meta learning as <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{p}=\left\{p,{M}_{p}\right\}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq44.gif"/></alternatives></inline-formula>, where <italic>p</italic> is a protein in the protein set <italic>P</italic> and <italic>M</italic><sub><italic>p</italic></sub> is the drug set of its corresponding binding molecules and non-binding molecules.</p>
      <p id="Par48">Definition 4: We define the zero-shot DTI predicting task inherited from DTI task, which represents that the meta-model is directly used for prediction without fine-tuning with samples of the protein in meta-learning test set.</p>
      <p id="Par49">Definition 5: We define the few-shot DTI predicting task inherited from DTI task, which uses the protein-specific model for prediction after fine-tuning with samples of the protein in meta-testing.</p>
      <p id="Par50">The few-shot DTI prediction schedule and zero-shot DTI prediction schedule are shown in Fig. <xref rid="Fig5" ref-type="fig">5c</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>Meta-learning setup in ZeroBind</title>
      <p id="Par51">The meta-learning framework was originally proposed to learn general knowledge across multiple related tasks within a distribution and used this general experience to quickly adapt to additional tasks and improve prediction performance<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. There are two main types of meta-learning framework: (1) Gradient-based methods: The classic gradient-based method MAML<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> uses a meta-learner to learn a good initialization by summing up multiple task losses and updating the parameters across tasks. Therefore, MAML could achieve both high accuracy and speed for generalization; (2) Metric-based methods: The prototypical network<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> is a classic metric-based meta-learning algorithm that directly trains the vector representation (i.e., prototypes) of each category. Once a good feature extractor is trained, the category of a new sample is determined by its closest prototype in the vector space. In our study, we apply gradient-based methods MAML as the training strategy. Besides, we follow MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> to make some improvements to stabilize the training process of MAML.</p>
      <p id="Par52">In the details of ZeroBind, several techniques including multi-step loss optimization (MSL), learning per-layer per-step learning rates and gradient directions (LSLR), subgraph information bottleneck (SIB), and task adaptive self-attention are applied to improve the performance of ZeroBind. We build the zero-shot learning framework based on MAML. First, we randomly initialize the network parameter <bold><italic>θ</italic></bold>. Given training tasks (proteins) sampled from the task distribution <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{\boldsymbol{{{{{\mathscr{T}}}}}}}}}}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="bold-script">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq45.gif"/></alternatives></inline-formula>, MAML aims to learn good initial parameters that can quickly adapt to additional tasks. For a pair of a protein and drug, we sample a 2-way, k-shot, m-query training task. Of these three hyperparameters, 2-way is set up since there are only two types of labels of binding and nonbinding in the classification task. In the original MAML framework, the model first trains <italic>k</italic> data samples of each label for several inner steps to learn a task-specific model and then tests on <italic>m</italic> data samples. After obtaining the loss for each task, MAML applies the gradient descent with the sum or average of the loss across all tasks. Here we refer the training task and test task as the support set and query set, respectively. However, MAML suffers from instability during training and is sensitive to neural network architectures and a large number of hyperparameters. Therefore, we follow MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> training procedure, which leverages multi-step loss optimization (MSL) and learning per-layer per-step learning rates and gradient directions (LSLR) in MAML.</p>
      <p id="Par53">Specifically, the multi-step loss optimization calculates the loss of the query set after each inner step, and optimizes the base network with the support set after all inner step optimization is completed. More formally, we optimize the model parameters as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta=\theta -\alpha {\nabla }_{\theta }\mathop{\sum }\limits_{b=1}^{B}\mathop{\sum }\limits_{i=0}^{N}{\upsilon }_{i}{{{{{{\mathscr{L}}}}}}}_{{T}_{b}}\left({f}_{{\theta }_{i}^{b}}\right)$$\end{document}</tex-math><mml:math id="M92"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M94"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq46.gif"/></alternatives></inline-formula> is the learning rate, <inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{T}_{b}}\left({f}_{{\theta }_{i}^{b}}\right)$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq47.gif"/></alternatives></inline-formula> denotes the loss of the query set after every inner step optimization with the support step and <inline-formula id="IEq48"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\upsilon }}}}}}}_{{{{{{\bf{i}}}}}}}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">υ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq48.gif"/></alternatives></inline-formula> denotes the importance of step <inline-formula id="IEq49"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M100"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq49.gif"/></alternatives></inline-formula> generated by the number of inner steps.</p>
      <p id="Par54">The LSLR module sets the learning rate to be learnable parameters for each layer at each inner step. Without adding much computation, different learning rates are automatically learned for each layer at each step, which may help alleviate overfitting.</p>
      <p id="Par55">To summarize the meta-learning procedure in ZeroBind (Boxes <xref rid="Sec13" ref-type="sec">1</xref> and <xref rid="Sec14" ref-type="sec">2</xref>), the model is first updated to task-specific models using the support set of each task, and then calculates the loss of the query set of the task. After repeating N inner steps, the losses of all query sets are weighted average by <inline-formula id="IEq50"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{{{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq50.gif"/></alternatives></inline-formula>, and are used to optimize the meta-model by gradient descent. After training with a sufficient number of samples, the learned model has a good capability of predicting DTI for unseen molecules and proteins or quickly adapting to additional protein tasks with a few training samples. The meta-learning procedure of ZeroBind is shown in Fig. <xref rid="Fig1" ref-type="fig">1d</xref>.</p>
    </sec>
    <sec id="Sec13">
      <boxed-text>
        <label>Box 1 ZeroBind training process</label>
        <p id="Par56">Require: <inline-formula id="IEq51"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right\}:$$\end{document}</tex-math><mml:math id="M104"><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>:</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq51.gif"/></alternatives></inline-formula> training data;</p>
        <p id="Par57">While not done do:</p>
        <p id="Par58">Sample batch of tasks <inline-formula id="IEq52"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }\sim p\left(\tau \right)$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq52.gif"/></alternatives></inline-formula></p>
        <p id="Par59">For all <inline-formula id="IEq53"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq53.gif"/></alternatives></inline-formula> do</p>
        <p id="Par60"> Sample k examples as support sets of <inline-formula id="IEq54"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq54.gif"/></alternatives></inline-formula>
<inline-formula id="IEq55"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{G}_{{mn}}^{\tau },{G}_{{pn}}^{\tau },{Y}_{n}^{\tau }\right\}}_{n=1}^{k}\in \left({G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right)$$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq55.gif"/></alternatives></inline-formula></p>
        <p id="Par61"> Sample m examples as query sets of <inline-formula id="IEq56"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq56.gif"/></alternatives></inline-formula>
<inline-formula id="IEq57"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{G}_{{mn}}^{\tau },{G}_{{pn}}^{\tau },{Y}_{n}^{\tau }\right\}}_{n=1}^{m}\in \left({G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right)$$\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq57.gif"/></alternatives></inline-formula></p>
        <p id="Par62"> <inline-formula id="IEq58"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{{base}}\leftarrow \theta$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq58.gif"/></alternatives></inline-formula></p>
        <p id="Par63"> For i=1 to inner steps do:</p>
        <p id="Par64">  Calculate the inner step loss weight <inline-formula id="IEq59"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\omega }_{i}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq59.gif"/></alternatives></inline-formula></p>
        <p id="Par65">  <inline-formula id="IEq60"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}={BaseModel}\left({\left\{{G}_{{Pn}}^{\tau }\right\}}_{n=1}^{k},{\left\{{G}_{{Mn}}^{\tau }\right\}}_{n=1}^{k}{{{{{\rm{;}}}}}}{\theta }_{{base}}\right)$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq60.gif"/></alternatives></inline-formula></p>
        <p id="Par66">  <inline-formula id="IEq61"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\leftarrow {Eq}.\left(11\right){with}{\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>←</mml:mo><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfenced><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq61.gif"/></alternatives></inline-formula></p>
        <p id="Par67">  <inline-formula id="IEq62"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{{base}}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq62.gif"/></alternatives></inline-formula> optimize with <inline-formula id="IEq63"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq63.gif"/></alternatives></inline-formula></p>
        <p id="Par68">  <inline-formula id="IEq64"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{m}={BaseModel}\left({\left\{{G}_{{Pn}}^{\tau }\right\}}_{n=1}^{m},{\left\{{G}_{{Mn}}^{\tau }\right\}}_{n=1}^{m}{{{{{\rm{;}}}}}}{\theta }_{{base}}\right)$$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq64.gif"/></alternatives></inline-formula></p>
        <p id="Par69">  <inline-formula id="IEq65"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\leftarrow {Eq}.\left(11\right){with}{\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{m}$$\end{document}</tex-math><mml:math id="M132"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>←</mml:mo><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfenced><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq65.gif"/></alternatives></inline-formula></p>
        <p id="Par70"> End for</p>
        <p id="Par71">
          <inline-formula id="IEq66">
            <alternatives>
              <tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}^{\tau }={\left\{{\omega }_{i}\right\}}_{i=1}^{N}\cdot {\left\{{{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\right\}}_{i=1}^{N}$$\end{document}</tex-math>
              <mml:math id="M134">
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ω</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>⋅</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="script">L</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq66.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par72">End for</p>
        <p id="Par73">
          <inline-formula id="IEq67">
            <alternatives>
              <tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\eta }_{i}\right\}}_{i=1}^{N}\leftarrow {Eq}.\left(14\right)$$\end{document}</tex-math>
              <mml:math id="M136">
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>η</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>14</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq67.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par74">
          <inline-formula id="IEq68">
            <alternatives>
              <tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \leftarrow \theta -\alpha {\nabla }_{\theta }{\sum }_{{T}_{\tau }\sim p\left(\tau \right)}{\eta }_{i}\cdot {{{{{{\mathscr{L}}}}}}}^{\tau }$$\end{document}</tex-math>
              <mml:math id="M138">
                <mml:mi>θ</mml:mi>
                <mml:mo>←</mml:mo>
                <mml:mi>θ</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mi>α</mml:mi>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>∇</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>τ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>~</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mi>τ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>η</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>⋅</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq68.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par75">End while</p>
      </boxed-text>
    </sec>
    <sec id="Sec14">
      <boxed-text>
        <label>Box 2 BaseModel forward process</label>
        <p id="Par76">Require: <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{G}_{P},{G}_{M}\right\}:$$\end{document}</tex-math><mml:math id="M140"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>:</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq69.gif"/></alternatives></inline-formula> training data;</p>
        <p id="Par77">
          <inline-formula id="IEq70">
            <alternatives>
              <tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{P}={{GNN}}_{P}\left({G}_{P};{\theta }_{P}\right)$$\end{document}</tex-math>
              <mml:math id="M142">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                    <mml:mi>N</mml:mi>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq70.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par78">
          <inline-formula id="IEq71">
            <alternatives>
              <tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{M}={{GNN}}_{M}\left({G}_{M};{\theta }_{M}\right)$$\end{document}</tex-math>
              <mml:math id="M144">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                    <mml:mi>N</mml:mi>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq71.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par79">
          <inline-formula id="IEq72">
            <alternatives>
              <tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z\leftarrow {Eq}.\left(4\right){with}\left({G}_{P},{G}_{M}\right)$$\end{document}</tex-math>
              <mml:math id="M146">
                <mml:mi>Z</mml:mi>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>4</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq72.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par80">
          <inline-formula id="IEq73">
            <alternatives>
              <tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{G}_{P}}_{{sub}}\leftarrow {Eq}.\left(5\right){with}\left(Z,{G}_{P}\right)$$\end{document}</tex-math>
              <mml:math id="M148">
                <mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                    <mml:mi>u</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>5</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq73.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par81">For i=1 to num steps do</p>
        <p id="Par82">
          <inline-formula id="IEq74">
            <alternatives>
              <tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\leftarrow {Eq}.\left(8\right){with}\left({G}_{P},{{G}_{P}}_{{sub}};{\varphi }_{2}\right)$$\end{document}</tex-math>
              <mml:math id="M150">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>I</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>o</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>8</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>φ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq74.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par83">
          <inline-formula id="IEq75">
            <alternatives>
              <tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}\leftarrow {Eq}.\left(6\right){with\; Z}$$\end{document}</tex-math>
              <mml:math id="M152">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>S</mml:mi>
                    <mml:mi>E</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>6</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mspace width="0.16em"/>
                <mml:mi>Z</mml:mi>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq75.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par84">
          <inline-formula id="IEq76">
            <alternatives>
              <tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}\leftarrow {Eq}.\left(10\right){with}\left({G}_{m},{{G}_{P}}_{{sub}}{;Y}\right)$$\end{document}</tex-math>
              <mml:math id="M154">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq76.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par85">
          <inline-formula id="IEq77">
            <alternatives>
              <tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{Base}}\leftarrow {Eq}.\left(11\right){with}\left({{{{{{\mathscr{L}}}}}}}_{{cls}},{{{{{{\mathscr{L}}}}}}}_{{MSE}},{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\right)$$\end{document}</tex-math>
              <mml:math id="M156">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>11</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>E</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>I</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq77.gif"/>
            </alternatives>
          </inline-formula>
        </p>
      </boxed-text>
    </sec>
    <sec id="Sec15">
      <title>Architecture of base model in ZeroBind</title>
      <p id="Par86">Figure <xref rid="Fig1" ref-type="fig">1e</xref> shows the architecture of the base model in ZeroBind, which mainly consists of three modules: a GNN module to obtain the embedding of molecules and proteins, a SIB module to find the most predictive subgraph as the binding pocket in the protein, and a dense module with concatenating protein subgraph representation and molecular representation to score the interactions.</p>
      <p id="Par87">Graph neural network-based representation learning for proteins and drugs. After constructing drug and protein graphs for a given protein-drug pair, we first embed the molecule atom features to vector space with randomly initialized parameters. We denote the node embedding of the molecule as <inline-formula id="IEq78"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{X}}}}}}}_{{{{{{\bf{m}}}}}}}{{{{{\boldsymbol{\in }}}}}}{{\mathbb{R}}}^{{N}_{m}*{D}_{m}}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">∈</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq78.gif"/></alternatives></inline-formula>, and also as the initial node embedding of GNN, denoted as <inline-formula id="IEq79"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{0}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq79.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq80"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{m}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq80.gif"/></alternatives></inline-formula> is the number of nodes and <inline-formula id="IEq81"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{m}$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq81.gif"/></alternatives></inline-formula> is the dimension of the node embeddings. Here, we denote the graph convolutional network (GCN) based molecule backbone as <inline-formula id="IEq82"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq82.gif"/></alternatives></inline-formula>, which is used to learn the graph embedding from the molecule graph. Then, the <inline-formula id="IEq83"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M168"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq83.gif"/></alternatives></inline-formula>-th layer output of <inline-formula id="IEq84"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq84.gif"/></alternatives></inline-formula> can be formulated as:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{m}^{\left(l\right)}={RELU}\left({\hat{A}}_{m}{G}_{m}^{\left(l-1\right)}{W}_{m}^{\left(l-1\right)}+{b}^{\left(l-1\right)}\right)$$\end{document}</tex-math><mml:math id="M172"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq85"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{{{{{\bf{A}}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq85.gif"/></alternatives></inline-formula> represents the adjacent matrix of a graph, <inline-formula id="IEq86"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{l}}}}}}{{{{{\boldsymbol{-}}}}}}{{{{{\bf{1}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold-italic">-</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq86.gif"/></alternatives></inline-formula> denotes the node embedding of <inline-formula id="IEq87"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(l-1\right)$$\end{document}</tex-math><mml:math id="M178"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq87.gif"/></alternatives></inline-formula>-th layer and <inline-formula id="IEq88"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{l}}}}}}{{{{{\boldsymbol{-}}}}}}{{{{{\bf{1}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M180"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold-italic">-</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq88.gif"/></alternatives></inline-formula> is the learnable weight matrix.</p>
      <p id="Par88">For protein graphs, we initialize the node embedding <inline-formula id="IEq89"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{p}}}}}}}^{\left({{{{{\bf{0}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M182"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq89.gif"/></alternatives></inline-formula> of a protein graph with ESM-2, a pre-trained general-purpose protein embedding. Similarly to the molecule graph, a GCN-based backbone <inline-formula id="IEq90"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{p}}}}}}}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq90.gif"/></alternatives></inline-formula> is used to learn the graph embedding from the protein graphs. Then, the <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M186"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq91.gif"/></alternatives></inline-formula>-th layer output of <inline-formula id="IEq92"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{p}}}}}}}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq92.gif"/></alternatives></inline-formula> can be formulated as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{p}^{\left(l\right)}={RELU}\left({\hat{A}}_{p}{G}_{p}^{\left(l-1\right)}{W}_{p}^{\left(l-1\right)}+{b}^{\left(l-1\right)}\right)$$\end{document}</tex-math><mml:math id="M190"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par89">Subgraph learning in ZeroBind for potential binding pockets in proteins. Considering that a molecule binds to a binding pocket in the protein instead of the whole protein, after the protein backbone GCN, we apply a model-agnostic SIB module<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> to identify the most interpretable subgraph with the most crucial information associated with the DTI task, where the learned subgraph corresponds to the binding pocket on the protein graph. The SIB module is proposed to recognize a compressed subgraph named IB-subgraph under the information bottleneck (IB) principle. The IB-subgraph could also eliminate the noisy and redundant graph information. In our DTI task, the DTI score is largely determined by the protein pocket features, which are the subgraph information bottleneck of the protein graph or the potential drug binding sites in the protein.</p>
      <p id="Par90">The SIB module contains a subgraph generator for node assignment and a dense layer to guarantee that the generated subgraph matches the IB-subgraph. The subgraph generator is a Multi-layer Perceptron (MLP), which takes the protein node embedding and the molecule embedding as the input and outputs the node assignment matrix <inline-formula id="IEq93"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M192"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq93.gif"/></alternatives></inline-formula>, which is formulated as follows:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z={Softmax}\left({MLP}\left({concatenate}\left({G}_{p}^{\left(l\right)},{G}_{m}^{\left(l\right)}\right){{{{{\rm{;}}}}}}{\varphi }_{1}\right)\right)$$\end{document}</tex-math><mml:math id="M194"><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{{sub}}={Z}^{T}{G}_{p}^{\left(l\right)}\left[0\right]$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where the output of the MLP is a <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times 2$$\end{document}</tex-math><mml:math id="M198"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq94.gif"/></alternatives></inline-formula> matrix with the number of nodes n. After applying <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Softmax}$$\end{document}</tex-math><mml:math id="M200"><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq95.gif"/></alternatives></inline-formula> on the output of MLP layer, each row of <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M202"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq96.gif"/></alternatives></inline-formula> is the probability of the corresponding node belonging to the <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{{{{{{\bf{G}}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq98.gif"/></alternatives></inline-formula>, denoted as <inline-formula id="IEq99"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right),p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)\right]$$\end{document}</tex-math><mml:math id="M208"><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq99.gif"/></alternatives></inline-formula>,where <inline-formula id="IEq100"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq100.gif"/></alternatives></inline-formula> represents the generated subgraph of protein graph <inline-formula id="IEq101"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{{{{{{\bf{G}}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq102.gif"/></alternatives></inline-formula> represents the leftover subgraph of protein graph. After training with a sufficient number of training samples, the learned node assignment matrix <inline-formula id="IEq103"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M216"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq103.gif"/></alternatives></inline-formula> is supposed to approach to 0 or 1. Thus, the generated IB-subgraph embedding can be obtained by taking the first row of the product between <inline-formula id="IEq104"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{Z}}}}}}}^{{{{{{\bf{T}}}}}}}$$\end{document}</tex-math><mml:math id="M218"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq104.gif"/></alternatives></inline-formula> and node embedding.</p>
      <p id="Par91">To stabilize the training process of the subgraph generation and separate <inline-formula id="IEq105"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right)$$\end{document}</tex-math><mml:math id="M220"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq105.gif"/></alternatives></inline-formula> from <inline-formula id="IEq106"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)$$\end{document}</tex-math><mml:math id="M222"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq106.gif"/></alternatives></inline-formula>, we apply a connectivity loss as follows:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}={MSE}\left({diag}\left({Norm}\left({Z}^{T}{AZ}\right)\right)-{diag}\left({I}_{2}\right)\right)$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq107"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Norm}\left(\cdot \right)$$\end{document}</tex-math><mml:math id="M226"><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>⋅</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq107.gif"/></alternatives></inline-formula> is the row normalization, <inline-formula id="IEq108"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{A}}}}}}$$\end{document}</tex-math><mml:math id="M228"><mml:mi mathvariant="bold">A</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq108.gif"/></alternatives></inline-formula> is the adjacency matrix of protein graph <inline-formula id="IEq109"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{I}}}}}}}_{{{{{{\bf{2}}}}}}}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">2</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq110.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq111"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2{\times} 2$$\end{document}</tex-math><mml:math id="M234"><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq111.gif"/></alternatives></inline-formula> identity matrix. Minimizing <inline-formula id="IEq112"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq112.gif"/></alternatives></inline-formula> could encourages <inline-formula id="IEq113"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right),p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)\right]\to \left[{{{{\mathrm{0,1}}}}}\right]/\left[{{{{\mathrm{1,0}}}}}\right]$$\end{document}</tex-math><mml:math id="M238"><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>→</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">0, 1</mml:mi></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">1, 0</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq113.gif"/></alternatives></inline-formula>, which results in a distinctive <inline-formula id="IEq114"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M240"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq114.gif"/></alternatives></inline-formula> to stabilize the training process and a compact topology in the subgraph.</p>
      <p id="Par92">Formally, the subgraph information bottleneck seeks the IB-subgraph by optimizing the following objective function:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\max }\limits_{{G}_{{sub}}}I\left(Y,{G}_{{sub}}\right)-\beta I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M242"><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq115"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M244"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq115.gif"/></alternatives></inline-formula> is a weight, <inline-formula id="IEq116"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y$$\end{document}</tex-math><mml:math id="M246"><mml:mi>Y</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq116.gif"/></alternatives></inline-formula> represents the label associated with <inline-formula id="IEq117"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M248"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq117.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq118"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M250"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq118.gif"/></alternatives></inline-formula> represents the original graph. <inline-formula id="IEq119"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M252"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq119.gif"/></alternatives></inline-formula> and <inline-formula id="IEq120"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M254"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq120.gif"/></alternatives></inline-formula> respectively represents the mutual information between <inline-formula id="IEq121"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M256"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq121.gif"/></alternatives></inline-formula> and <inline-formula id="IEq122"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M258"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq122.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq123"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq123.gif"/></alternatives></inline-formula> represents the IB-subgraph embedding.</p>
      <p id="Par93">To optimize the objective function, the lower bound of the first term is formulated as the opposite number of classification loss between the ground truth label and predicted label with subgraph embedding. By minimizing the classification loss, the lower bound of <inline-formula id="IEq124"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M262"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq124.gif"/></alternatives></inline-formula> achieves the maximum value. For the second term, the DONSKER-VARADHAN representation<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> of the KL-divergence is applied to approximate the upper bound of <inline-formula id="IEq125"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M264"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq125.gif"/></alternatives></inline-formula>. The approximation of <inline-formula id="IEq126"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M266"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq126.gif"/></alternatives></inline-formula> can be formulate as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\max }\limits_{{\varphi }_{2}}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\left({\varphi }_{2},{G}_{{sub}}\right)=	 \frac{1}{N}\mathop{\sum }\limits_{i=1}^{N}{Dense}\left({G}_{i},{G}_{{{sub}}_{i}}{{{{{\rm{;}}}}}}{\varphi }_{2}\right)\\ 	 -\log \frac{1}{N}\mathop{\sum }\limits_{i=1,j\ne i}^{N}{e}^{{Dense}\left({G}_{i},{G}_{{{sub}}_{j}}{{{{{\rm{;}}}}}}{\varphi }_{2}\right)}$$\end{document}</tex-math><mml:math id="M268"><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq127"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Dense}\left(\bullet \right)$$\end{document}</tex-math><mml:math id="M270"><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>∙</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq127.gif"/></alternatives></inline-formula> is the dense network of several MLP layers with the concatenation of the embedding of <inline-formula id="IEq128"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M272"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq128.gif"/></alternatives></inline-formula> and <inline-formula id="IEq129"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq129.gif"/></alternatives></inline-formula> as the input.</p>
      <p id="Par94">To minimize <inline-formula id="IEq130"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M276"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq130.gif"/></alternatives></inline-formula>, several inner steps of the maximum optimization of <inline-formula id="IEq131"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq131.gif"/></alternatives></inline-formula> are applied to minimize the upper bound of <inline-formula id="IEq132"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M280"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq132.gif"/></alternatives></inline-formula>.</p>
      <p id="Par95">After obtaining the embedding of the generated protein IB-subgraph, we concatenate the molecular embedding and protein IB-subgraph embedding as the input to the MLP classification layer. The DTI classification loss could be formulated as:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y}={MLP}\left({concatenate}\left({G}_{m},{G}_{{sub}}\right){{{{{\rm{;}}}}}}{\theta }_{{cls}}\right)$$\end{document}</tex-math><mml:math id="M282"><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}=-y\log \hat{y}-\left(1-y\right)\log \left(1-\hat{y}\right)$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mi>log</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mi>log</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par96">The overall loss can be formulated as:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\min }\limits_{{\theta }_{M},{\theta }_{P},{\varphi }_{1},{\varphi }_{2},{\theta }_{{cls}}}{{{{{{\mathscr{L}}}}}}}_{{base}}={{{{{{\mathscr{L}}}}}}}_{{cls}}+{\lambda }_{1}{{{{{{\mathscr{L}}}}}}}_{{MSE}}+{\lambda }_{2}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M286"><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equa"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s.t.{\varphi }_{2}^{*}={\arg }\mathop{\max }\limits_{{\varphi }_{2}}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq133"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{1}$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{2}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq134.gif"/></alternatives></inline-formula> are weights to balance the importance of different losses, <inline-formula id="IEq135"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{M}}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">,</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq135.gif"/></alternatives></inline-formula> are the parameters of <inline-formula id="IEq136"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{GCN}}}}}}}_{{{{{{\rm{m}}}}}}}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq136.gif"/></alternatives></inline-formula> and <inline-formula id="IEq137"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{GCN}}}}}}}_{{{{{{\rm{p}}}}}}}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq137.gif"/></alternatives></inline-formula>, <inline-formula id="IEq138"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\varphi }}}}}}}_{{{{{{\bf{1}}}}}}}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq138.gif"/></alternatives></inline-formula> is the parameters of IB-subgraph generator, <inline-formula id="IEq139"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\varphi }}}}}}}_{{{{{{\bf{2}}}}}}}$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">2</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq139.gif"/></alternatives></inline-formula> is the parameters of the dense network, and <inline-formula id="IEq140"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{cls}}}}}}}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq140.gif"/></alternatives></inline-formula> is the parameters of the MLP layer.</p>
      <p id="Par97">Here, we summarize the training process, the <inline-formula id="IEq141"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq141.gif"/></alternatives></inline-formula> measures the discrepancy between the estimated distribution and the original data distribution by utilizing the cross-entropy between the predicted values and the ground truth (the DTI labels instead of binding pocket labels). The <inline-formula id="IEq142"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq142.gif"/></alternatives></inline-formula>, as indicated by Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>), encourages the node assignment matrix <inline-formula id="IEq143"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M310"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq143.gif"/></alternatives></inline-formula> to approach close to either 1 or 0. The <inline-formula id="IEq144"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq144.gif"/></alternatives></inline-formula>, as indicated by Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>), represents an approximation of <inline-formula id="IEq145"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M314"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq145.gif"/></alternatives></inline-formula> introduced in Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>). To maximize Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) and achieve subgraph information bottleneck, the lower bound of <inline-formula id="IEq146"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M316"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq146.gif"/></alternatives></inline-formula> needs to increase as much as possible and the upper bound of <inline-formula id="IEq147"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M318"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq147.gif"/></alternatives></inline-formula> needs to decrease. Therefore, we begin by performing gradient descent on the negative of <inline-formula id="IEq148"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq148.gif"/></alternatives></inline-formula> within the dense network. The goal is to maximize <inline-formula id="IEq149"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq149.gif"/></alternatives></inline-formula> and achieve the upper bound of <inline-formula id="IEq150"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M324"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq150.gif"/></alternatives></inline-formula>, thus satisfying the constraints of Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>). After that, we utilize gradient descent to optimize Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>). By optimizing <inline-formula id="IEq151"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq151.gif"/></alternatives></inline-formula>, we increase the lower bound of <inline-formula id="IEq152"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M328"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq152.gif"/></alternatives></inline-formula>, and decrease the upper bound of <inline-formula id="IEq153"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M330"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq153.gif"/></alternatives></inline-formula> by optimizing <inline-formula id="IEq154"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq154.gif"/></alternatives></inline-formula>. This approach aims to maximize Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) and seek the subgraph information bottleneck for detecting potential binding pockets in proteins.</p>
      <p id="Par98">In our task, we aim to find the protein binding pocket under the weakly supervised training process, since the amount of protein binding pockets data is much smaller than the amount of binding data. So we design the IB-subgraph to find the protein binding pockets optimized on the DTI binding labels instead of binding pocket labels in proteins. Considering the protein pockets are determined by both proteins and molecules, we take the concatenation of molecule embedding and protein embedding as input when we generate the node assignment matrix <inline-formula id="IEq155"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M334"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq155.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>).</p>
    </sec>
    <sec id="Sec16">
      <title>Task adaptive self-attention</title>
      <p id="Par99">In a traditional meta-learning schedule, <inline-formula id="IEq156"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${batch\_size}$$\end{document}</tex-math><mml:math id="M336"><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mo>_</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq156.gif"/></alternatives></inline-formula> tasks are sampled and treated with the same weight when applying mini-batch gradient descent. However, the same weight of multiple tasks can’t reflect the importance of different tasks contributing to the meta-model optimization. We further design a task adaptive self-attention module (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>) to learn the importance of different tasks automatically. Since each task is a DTI prediction of a specific protein, we take the concatenation of protein subgraph embedding and the average of the embeddings of all molecules in the query set as the task embedding. The self-attention module is:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${h}_{{T}_{b}}={concatenate}\left({G}_{p},{Mean}\left({\left\{{G}_{m}^{i}\right\}}_{i=1}^{m}\right)\right)$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}Q={W}_{Q}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\\ K={W}_{K}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\\ V={W}_{V}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\end{array}$$\end{document}</tex-math><mml:math id="M340"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\eta }_{{T}_{b}}\right\}}_{b=1}^{B}={Attention}\left(Q,K,V\right)={softmax}\left(\frac{Q{K}^{T}}{\sqrt{{d}_{k}}}\right)V$$\end{document}</tex-math><mml:math id="M342"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>16</label><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{all}}=\mathop{\sum }\limits_{b=1}^{B}{\eta }_{{T}_{b}}{{{{{{\mathscr{L}}}}}}}_{{query},b}$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq157"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{b}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq157.gif"/></alternatives></inline-formula> is one of the DTI tasks, <inline-formula id="IEq158"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{h}}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{b}}}}}}}}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq158.gif"/></alternatives></inline-formula> represents the task embedding, <inline-formula id="IEq159"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{Q}}}}}}}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq159.gif"/></alternatives></inline-formula>, <inline-formula id="IEq160"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{K}}}}}}}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq160.gif"/></alternatives></inline-formula> and <inline-formula id="IEq161"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{V}}}}}}}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq161.gif"/></alternatives></inline-formula> are learnable parameter matrices, <inline-formula id="IEq162"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Q}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{K}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{V}}}}}}$$\end{document}</tex-math><mml:math id="M356"><mml:mi mathvariant="bold">Q</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">K</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">V</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq162.gif"/></alternatives></inline-formula> are the generated attention matrices, <inline-formula id="IEq163"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{k}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq163.gif"/></alternatives></inline-formula> is the dimension of task embedding to normalize the variance of <inline-formula id="IEq164"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Q}}}}}}{{{{{{\bf{K}}}}}}}^{{{{{{\bf{T}}}}}}}$$\end{document}</tex-math><mml:math id="M360"><mml:mi mathvariant="bold">Q</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq164.gif"/></alternatives></inline-formula> and stabilize gradient values during training, and <inline-formula id="IEq165"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{b}}}}}}}}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq165.gif"/></alternatives></inline-formula> is the generated weight to balance the importance of different task.</p>
      <p id="Par100">MetaDTA<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> uses multi-head cross-attention network to capture the relationships between the support and the query ligands instead of different proteins, where it does not use any protein information. In contrast, ZeroBind utilizes a task adaptive self-attention module to learn the importance for different tasks of proteins, and it focuses on the shared binding patterns among different proteins.</p>
    </sec>
    <sec id="Sec17">
      <title>Experimental settings</title>
      <p id="Par101">We take graph convolutional networks as base graph neural network. In our experiment, the GCN layer number of <inline-formula id="IEq166"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq166.gif"/></alternatives></inline-formula> is set as 4 and we set the embedding dimensions as 1280,512,256,256,256, and the GCN layer number of <inline-formula id="IEq167"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{M}}}}}}}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq167.gif"/></alternatives></inline-formula> is set as 3, the embedding dimensions we set are 256,256,256. We set the update step in inner loops as 5. 20 inner steps of the maximum optimization of <inline-formula id="IEq168"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq168.gif"/></alternatives></inline-formula> are applied. We set the <inline-formula id="IEq169"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{1}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq169.gif"/></alternatives></inline-formula> and <inline-formula id="IEq170"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{2}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq170.gif"/></alternatives></inline-formula> as 0.05. The learning rate of optimization of <inline-formula id="IEq171"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq171.gif"/></alternatives></inline-formula> is set at 0.01. The meta learning rate is using simulated annealing algorithm. We use Pytorch to implement the model and run it on a GPU.</p>
    </sec>
    <sec id="Sec18">
      <title>Baseline methods</title>
      <p id="Par102">We compare ZeroBind with multiple baselines to evaluate its advantages, and calculate the area under the receiver operating characteristic (AUROC) and the area under the precision-recall curve (AUPRC) on three independent test sets and one few-shot test set.<list list-type="order"><list-item><p id="Par103">DeepConv-DTI<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>: DeepConv-DTI trains a CNN to learn the embedding of the neighboring residues and an MLP to learn the molecular fingerprint, which is concatenated to make DTI prediction.</p></list-item><list-item><p id="Par104">GraphDTA<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>: GraphDTA leverages multiple types of GNN models to embed molecular embeddings and a CNN model to embed protein residue features.</p></list-item><list-item><p id="Par105">Deeppurpose<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>: Deeppurpose is a state-of-art deep learning library for DTI prediction with multiple backbone networks. Here we use CNN as the backbone network for learning embeddings of both drugs and proteins.</p></list-item><list-item><p id="Par106">AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>: AI-bind uses pre-trained mol2vec and protvec models to initialize the molecule embedding and protein embedding, and makes the DTI predictions by concatenating the molecule embedding and protein embedding.</p></list-item><list-item><p id="Par107">DrugBAN<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>: DrugBAN uses a deep bilinear attention network (BAN) framework with domain adaptation to explicitly learn local pairwise interactions between drugs and targets.</p></list-item></list></p>
    </sec>
    <sec id="Sec19">
      <title>Reporting summary</title>
      <p id="Par108">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_43597_MOESM1_ESM.pdf">
            <caption>
              <p>SupplementaryInformation</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_43597_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_43597_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec21">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_43597_MOESM4_ESM.xlsx">
            <caption>
              <p>Source data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-43597-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the National Key Research and Development Program of China (No. 2020AAA0107600 to X.P.), the National Natural Science Foundation of China (No. 61725302 and 62073219 to H.B.S., 61903248 to X.P.), and the Science and Technology Commission of Shanghai Municipality (20S11902100 to X.P., 22511104100 to H.B.S.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Y.W. contributed to writing the manuscript, data curation, and preparation, implemented the prediction model and performing the experiments, running docking simulation, and writing the manuscript. Y.X. contributed to data preparation and writing the manuscript. J.Y., Y.Y., and H.B.S. provided the guidance on designing the model and experiments and writing the manuscript. X.P. conceived the project, designed the experiments, contributed to data analysis and writing the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par109"><italic>Nature Communications</italic> thanks Thin Nguyen, and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The online webserver is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/">http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/</ext-link>. The benchmark dataset is collected from the original database BindingDB (<ext-link ext-link-type="uri" xlink:href="https://www.bindingdb.org/bind/downloads/BindingDB_All_2D_202311_sdf.zip">https://www.bindingdb.org/bind/downloads/BindingDB_All_2D_202311_sdf.zip</ext-link>) and it is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/datasets.html">http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/datasets.html</ext-link> along with the SARS-COV-2 test dataset, and the experimental protein structure data used in this study are downloaded from the RCSB PDB database (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/downloads/">https://www.rcsb.org/downloads/</ext-link>) and the predicted structures by AlphaFold are downloaded from AlphaFold Protein Structure Database (<ext-link ext-link-type="uri" xlink:href="https://www.alphafold.ebi.ac.uk/">https://www.alphafold.ebi.ac.uk/</ext-link>). All PDB and AlphaFold codes can be found on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/myprecioushh/ZeroBind">https://github.com/myprecioushh/ZeroBind</ext-link>). <xref ref-type="sec" rid="Sec21">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source codes of ZeroBind are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/myprecioushh/ZeroBind">https://github.com/myprecioushh/ZeroBind</ext-link>), together with a usage documentation and setup environment.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par110">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peska</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Buza</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Drug-target interaction prediction: a Bayesian ranking approach</article-title>
        <source>Comput. Methods Prog. Biomed.</source>
        <year>2017</year>
        <volume>152</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmpb.2017.09.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagherian</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Machine learning approaches and databases for prediction of drug–target interaction: a survey paper</article-title>
        <source>Brief. Bioinforma.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>247</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbasi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Razzaghi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Poso</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ghanbari-Ara</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Masoudi-Nejad</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Deep learning in drug target interaction prediction: current and future perspectives</article-title>
        <source>Curr. Med. Chem.</source>
        <year>2021</year>
        <volume>28</volume>
        <fpage>2100</fpage>
        <lpage>2113</lpage>
        <pub-id pub-id-type="doi">10.2174/0929867327666200907141016</pub-id>
        <?supplied-pmid 32895036?>
        <pub-id pub-id-type="pmid">32895036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Deng, J., Yang, Z., Ojima, I., Samaras, D. &amp; Wang, F. Artificial intelligence in drug discovery: applications and techniques. <italic>Briefings Bioinformatics</italic><bold>23</bold>, bbab430 (2022).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thafar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Raies</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Albaradei</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Essack</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bajic</surname>
            <given-names>VB</given-names>
          </name>
        </person-group>
        <article-title>Comparison study of computational prediction tools for drug-target binding affinities</article-title>
        <source>Front. Chem.</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>782</fpage>
        <pub-id pub-id-type="doi">10.3389/fchem.2019.00782</pub-id>
        <?supplied-pmid 31824921?>
        <pub-id pub-id-type="pmid">31824921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure-based maximal affinity model predicts small-molecule druggability</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2007</year>
        <volume>25</volume>
        <fpage>71</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1273</pub-id>
        <?supplied-pmid 17211405?>
        <pub-id pub-id-type="pmid">17211405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alonso</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bliznyuk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Gready</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Combining docking and molecular dynamic simulations in drug design</article-title>
        <source>Med. Res. Rev.</source>
        <year>2006</year>
        <volume>26</volume>
        <fpage>531</fpage>
        <lpage>568</lpage>
        <pub-id pub-id-type="doi">10.1002/med.20067</pub-id>
        <?supplied-pmid 16758486?>
        <pub-id pub-id-type="pmid">16758486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepPurpose: a deep learning library for drug–target interaction prediction</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>5545</fpage>
        <lpage>5547</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa1005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving the generalizability of protein-ligand binding predictions with AI-Bind</article-title>
        <source>Nat. Commun.</source>
        <year>2023</year>
        <volume>14</volume>
        <fpage>1989</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-023-37572-z</pub-id>
        <?supplied-pmid 37031187?>
        <pub-id pub-id-type="pmid">37031187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GraphDTA: predicting drug–target binding affinity with graph neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>1140</fpage>
        <lpage>1147</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa921</pub-id>
        <?supplied-pmid 33119053?>
        <pub-id pub-id-type="pmid">33119053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Keum</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>DeepConv-DTI: Prediction of drug-target interactions via deep learning with convolution on protein sequences</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1007129</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007129</pub-id>
        <?supplied-pmid 31199797?>
        <pub-id pub-id-type="pmid">31199797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilson</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BindingDB in 2015: a public database for medicinal chemistry, computational chemistry and systems pharmacology</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D1045</fpage>
        <lpage>D1053</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1072</pub-id>
        <?supplied-pmid 26481362?>
        <pub-id pub-id-type="pmid">26481362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChEMBL web services: streamlining access to drug discovery data and utilities</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>W612</fpage>
        <lpage>W620</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv352</pub-id>
        <?supplied-pmid 25883136?>
        <pub-id pub-id-type="pmid">25883136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The PDBbind database: Collection of binding affinities for protein− ligand complexes with known three-dimensional structures</article-title>
        <source>J. Med. Chem.</source>
        <year>2004</year>
        <volume>47</volume>
        <fpage>2977</fpage>
        <lpage>2980</lpage>
        <pub-id pub-id-type="doi">10.1021/jm030580l</pub-id>
        <?supplied-pmid 15163179?>
        <pub-id pub-id-type="pmid">15163179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The PDBbind database: methodologies and updates</article-title>
        <source>J. Med. Chem.</source>
        <year>2005</year>
        <volume>48</volume>
        <fpage>4111</fpage>
        <lpage>4119</lpage>
        <pub-id pub-id-type="doi">10.1021/jm048957q</pub-id>
        <?supplied-pmid 15943484?>
        <pub-id pub-id-type="pmid">15943484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DrugBank 5.0: a major update to the DrugBank database for 2018</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D1074</fpage>
        <lpage>D1082</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1037</pub-id>
        <?supplied-pmid 29126136?>
        <pub-id pub-id-type="pmid">29126136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sachdev</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive review of feature based methods for drug target interaction prediction</article-title>
        <source>J. Biomed. Inform.</source>
        <year>2019</year>
        <volume>93</volume>
        <fpage>103159</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2019.103159</pub-id>
        <?supplied-pmid 30926470?>
        <pub-id pub-id-type="pmid">30926470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Network-based methods for prediction of drug-target interactions</article-title>
        <source>Front. Pharmacol.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1134</fpage>
        <pub-id pub-id-type="doi">10.3389/fphar.2018.01134</pub-id>
        <?supplied-pmid 30356768?>
        <pub-id pub-id-type="pmid">30356768</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Wang, H., Zhou, G., Liu, S., Jiang, J.-Y. &amp; Wang, W. Drug-target interaction prediction with graph attention networks. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2107.06099">https://arxiv.org/abs/2107.06099</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Öztürk</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ozkirimli</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Özgür</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A comparative study of SMILES-based compound similarity functions for drug-target interaction prediction</article-title>
        <source>BMC Bioinforma.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0977-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perlman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gottlieb</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Atias</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ruppin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sharan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Combining drug and gene similarity measures for drug-target elucidation</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0213</pub-id>
        <?supplied-pmid 21314453?>
        <pub-id pub-id-type="pmid">21314453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mei</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Kwoh</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X-L</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Drug–target interaction prediction by learning from local information and neighbors</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>238</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts670</pub-id>
        <?supplied-pmid 23162055?>
        <pub-id pub-id-type="pmid">23162055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thafar</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DTiGEMS+: drug–target interaction prediction using graph embedding, graph mining, and similarity-based techniques</article-title>
        <source>J. Cheminformatics</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00447-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of drug-target interactions and drug repositioning via network-based inference</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002503</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002503</pub-id>
        <?supplied-pmid 22589709?>
        <pub-id pub-id-type="pmid">22589709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A network integration approach for drug-target interaction prediction and computational drug repositioning from heterogeneous information</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00680-8</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>A semi-supervised method for drug-target interaction prediction with consistency in networks</article-title>
        <source>PlOS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e62975</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0062975</pub-id>
        <?supplied-pmid 23667553?>
        <pub-id pub-id-type="pmid">23667553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SMILES, a chemical language and information system. 1. Introduction to methodology and encoding rules</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>1988</year>
        <volume>28</volume>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00057a005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Backpropagation applied to handwritten zip code recognition</article-title>
        <source>Neural Comput.</source>
        <year>1989</year>
        <volume>1</volume>
        <fpage>541</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="doi">10.1162/neco.1989.1.4.541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elman</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Finding structure in time</article-title>
        <source>Cogn. Sci.</source>
        <year>1990</year>
        <volume>14</volume>
        <fpage>179</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1207/s15516709cog1402_1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Vaswani, A. et al. Attention is all you need. <italic>Adv. Neural Inf. Process. Syst.</italic><bold>30</bold>, 6000–6010 (2017).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiménez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Skalic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martinez-Rosell</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>De Fabritiis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>K deep: protein–ligand absolute binding affinity prediction via 3d-convolutional neural networks</article-title>
        <source>J. Chem. Inf. Modeling</source>
        <year>2018</year>
        <volume>58</volume>
        <fpage>287</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scarselli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gori</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsoi</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Hagenbuchner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Monfardini</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The graph neural network model</article-title>
        <source>IEEE Trans. Neural Netw.</source>
        <year>2008</year>
        <volume>20</volume>
        <fpage>61</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1109/TNN.2008.2005605</pub-id>
        <?supplied-pmid 19068426?>
        <pub-id pub-id-type="pmid">19068426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamilton</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leskovec</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Inductive representation learning on large graphs</article-title>
        <source>31th Conf. Neural Inf. Process. Syst.</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>1025</fpage>
        <lpage>1035</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>GEFA: early fusion approach in drug-target affinity prediction</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>718</fpage>
        <lpage>728</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2021.3094217</pub-id>
        <?supplied-pmid 34197324?>
        <pub-id pub-id-type="pmid">34197324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geirhos</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shortcut learning in deep neural networks</article-title>
        <source>Nat. Mach. Intell.</source>
        <year>2020</year>
        <volume>2</volume>
        <fpage>665</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="doi">10.1038/s42256-020-00257-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Lee, E., Yoo, J., Lee, H. &amp; Hong, S. MetaDTA: meta-learning-based drug-target binding affinity prediction. <italic>ICLR2022 Machine Learning for Drug Discovery</italic> (2022).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Antoniou, A., Edwards, H. &amp; Storkey, A. How to train your MAML. Proc. ICLR 2019 (2019).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>AH</given-names>
          </name>
        </person-group>
        <article-title>The Finley affair: a signal event in the history of forecast verification</article-title>
        <source>Weather Forecast.</source>
        <year>1996</year>
        <volume>11</volume>
        <fpage>3</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1175/1520-0434(1996)011&lt;0003:TFAASE&gt;2.0.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>BioLiP: a semi-manually curated database for biologically relevant ligand–protein interactions</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>41</volume>
        <fpage>D1096</fpage>
        <lpage>D1103</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks966</pub-id>
        <?supplied-pmid 23087378?>
        <pub-id pub-id-type="pmid">23087378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PubChem 2019 update: improved access to chemical data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D1102</fpage>
        <lpage>D1109</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
        <?supplied-pmid 30371825?>
        <pub-id pub-id-type="pmid">30371825</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trott</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
        <source>J. Comput. Chem.</source>
        <year>2010</year>
        <volume>31</volume>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
        <?supplied-pmid 19499576?>
        <pub-id pub-id-type="pmid">19499576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurung</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bhattacharjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Exploring the physicochemical profile and the binding patterns of selected novel anticancer Himalayan plant derived active compounds with macromolecular targets</article-title>
        <source>Inform. Med. Unlocked</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.imu.2016.09.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ganea</surname>
            <given-names>OE</given-names>
          </name>
          <name>
            <surname>Pattanaik</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barzilay</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>EquiBind: geometric deep learning for drug binding structure prediction</article-title>
        <source>Int. Conf. Mach. Learn.</source>
        <year>2022</year>
        <volume>2022</volume>
        <fpage>20503</fpage>
        <lpage>20521</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Landrum, G. RDKit: A software suite for cheminformatics, computational chemistry, and predictive modeling. <italic>Greg Landrum</italic> (2013).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sussman</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein Data Bank (PDB): database of three-dimensional structural information of biological macromolecules</article-title>
        <source>Acta Crystallogr. Sect. D: Biol. Crystallogr.</source>
        <year>1998</year>
        <volume>54</volume>
        <fpage>1078</fpage>
        <lpage>1084</lpage>
        <pub-id pub-id-type="doi">10.1107/S0907444998009378</pub-id>
        <pub-id pub-id-type="pmid">10089483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Hu, W. et al. OGB-LSC A large-scale challenge for machine learning on graphs. <italic>35th Conference on Neural Information Processing Systems (NeurIPS 2021)</italic> Track on Datasets and Benchmarks (2021).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Deep graph learning of inter-protein contacts</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>947</fpage>
        <lpage>953</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab761</pub-id>
        <?supplied-pmid 34755837?>
        <pub-id pub-id-type="pmid">34755837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>
        <source>Science</source>
        <year>2023</year>
        <volume>379</volume>
        <fpage>1123</fpage>
        <lpage>1130</lpage>
        <pub-id pub-id-type="doi">10.1126/science.ade2574</pub-id>
        <?supplied-pmid 36927031?>
        <pub-id pub-id-type="pmid">36927031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hospedales</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Antoniou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Micaelli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Storkey</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Meta-learning in neural networks: a survey</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2021</year>
        <volume>44</volume>
        <fpage>5149</fpage>
        <lpage>5169</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Finn, C., Abbeel, P. &amp; Levine, S. Model-agnostic meta-learning for fast adaptation of deep networks. <italic>Pr. Mach. Learn. Res.</italic><bold>70</bold>, 1126–1135 (2017).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Snell, J., Swersky, K. &amp; Zemel, R. Prototypical networks for few-shot learning. <italic>Adv. Neural Inf. Process. Syst.</italic><bold>30</bold> (2017).</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Yu, J. et al. Recognizing predictive substructures with subgraph information bottleneck. <italic>IEEE Trans. Pattern Anal. Mach. Intell.</italic>10.1109/TPAMI.2021.3112205 (2021).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donsker</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Varadhan</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic evaluation of certain Markov process expectations for large time, I</article-title>
        <source>Commun. Pure Appl. Math.</source>
        <year>1975</year>
        <volume>28</volume>
        <fpage>1</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1002/cpa.3160280102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bai</surname>
            <given-names>PZ</given-names>
          </name>
          <name>
            <surname>Miljkovic</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>John</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>Interpretable bilinear attention network with domain adaptation improves drug-target prediction</article-title>
        <source>Nat. Mach. Intell.</source>
        <year>2023</year>
        <volume>5</volume>
        <fpage>126</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="doi">10.1038/s42256-022-00605-1</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10687269</article-id>
    <article-id pub-id-type="pmid">38030641</article-id>
    <article-id pub-id-type="publisher-id">43597</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-43597-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ZeroBind: a protein-specific zero-shot predictor with subgraph matching for drug-target interactions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0009-0007-5350-7269</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Yuxuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8437-0604</contrib-id>
        <name>
          <surname>Xia</surname>
          <given-names>Ying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9639-7679</contrib-id>
        <name>
          <surname>Yan</surname>
          <given-names>Junchi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4270-8002</contrib-id>
        <name>
          <surname>Yuan</surname>
          <given-names>Ye</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4029-3325</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Hong-Bin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5010-464X</contrib-id>
        <name>
          <surname>Pan</surname>
          <given-names>Xiaoyong</given-names>
        </name>
        <address>
          <email>2008xypan@sjtu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0220qvk04</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Institute of Image Processing and Pattern Recognition, </institution><institution>Shanghai Jiao Tong University, and Key Laboratory of System Control and Information Processing, Ministry of Education of China, </institution></institution-wrap>Shanghai, 200240 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0220qvk04</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Department of Computer Science and Engineering, and MoE Key Lab of Artificial Intelligence, AI Institute, </institution><institution>Shanghai Jiao Tong University, </institution></institution-wrap>Shanghai, 200240 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>7861</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Existing drug-target interaction (DTI) prediction methods generally fail to generalize well to novel (unseen) proteins and drugs. In this study, we propose a protein-specific meta-learning framework ZeroBind with subgraph matching for predicting protein-drug interactions from their structures. During the meta-training process, ZeroBind formulates training a protein-specific model, which is also considered a learning task, and each task uses graph neural networks (GNNs) to learn the protein graph embedding and the molecular graph embedding. Inspired by the fact that molecules bind to a binding pocket in proteins instead of the whole protein, ZeroBind introduces a weakly supervised subgraph information bottleneck (SIB) module to recognize the maximally informative and compressive subgraphs in protein graphs as potential binding pockets. In addition, ZeroBind trains the models of individual proteins as multiple tasks, whose importance is automatically learned with a task adaptive self-attention module to make final predictions. The results show that ZeroBind achieves superior performance on DTI prediction over existing methods, especially for those unseen proteins and drugs, and performs well after fine-tuning for those proteins or drugs with a few known binding partners.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Existing drug-target interaction (DTI) prediction methods generally fail to generalize well unseen proteins and drugs. Here the authors report a protein-specific meta-learning framework, ZeroBind, with subgraph matching for predicting protein-drug interactions from their structures.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Machine learning</kwd>
      <kwd>Virtual drug screening</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China (National Science Foundation of China)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61903248</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pan</surname>
            <given-names>Xiaoyong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Identifying the interactions between drugs and targets (proteins) plays a crucial role in the process of drug discovery<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. However, the traditional experimental methods for resolving the crystal structures of drug-protein complexes to identify the drug-target interactions are costly and time-consuming<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. In order to reduce costs, in silico approaches are gaining more attention. Instead of taking massive candidates into an in vitro search, it is more efficient and less costly to use computational approaches to virtually screen out most candidates prior to an in vitro search. Generally, there are two major groups of in silico approaches, docking simulations and data-driven learning-based methods. Docking simulations utilize the 3D structure of drug molecules and target proteins to identify their potential binding sites, which are also time-consuming<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. In contrast, due to the rapid development of machine learning, utilizing the features derived from proteins and drugs to identify their interactions achieves both high accuracy and low cost.</p>
    <p id="Par4">Data-driven learning methods generally formulate drug-target interaction (DTI) prediction as binary classification or regression tasks<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>, where interacting pairs of proteins and drugs are extracted from existing databases like BindingDB<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, CHEMBL<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, PDBbind<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>, and DrugBank<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Since the nature of potency values is logarithmic, a decrease in kinetic constants from micromolar to nanomolar levels results in an exponential change. Thus, the output values of regression tasks are normally defined as the negative log of kinetic constants, i.e., <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq4.gif"/></alternatives></inline-formula>. For classification tasks, a threshold is set to define binding or nonbinding according to <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq5.gif"/></alternatives></inline-formula>, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq8.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. Machine learning-based methods from molecules and proteins features mainly focus on learning a good representation of molecules and proteins, which are then fed into a classification/regression model to perform the prediction task<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
    <p id="Par5">Recently, deep learning has achieved exciting results in DTI prediction by learning from known drug-target interactions. However, these methods cannot generalize well to those unseen proteins and drugs<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. Similarity/distance-based<sup><xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup> and network-based<sup><xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup> methods, which utilize protein-protein similarity, drug-drug similarity and known DTIs, achieve overestimated performance on the transductive test<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, where both proteins and ligands in the test set are present in the training set. In addition, there are often few known binding drugs with a newly discovered target protein, making it difficult to work on the inductive test, where both proteins and ligands in the test set are absent in the training set. Currently, most existing methods focus on how to effectively learn representations of molecules and proteins, and then feed the representations into classification or regression models<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. The representation learning methods, like DeepPurpose<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, take molecular fingerprints and SMILES<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> strings as the molecular features and amino acid sequences as protein features. Then they apply a convolutional neural network (CNN)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, recurrent neural network (RNN)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> or Transformer<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> model to embed the input features. To take spatial information into consideration, some methods apply CNNs to 3D images derived from structures of proteins and molecule<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. GNN<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> has gained much attention in recent years due to its capability of handling graphs as non-Euclidean structured data<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Other methods utilize GNNs to embed graphs of proteins and molecules to perform DTI prediction<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. DTI prediction also benefits from the rapid development of GNNs since both drug and target protein are naturally graph-structured data. GEFA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> combines pre-trained protein embeddings and a graph-in-graph neural network with an attention mechanism to capture the interactions between drugs and protein residues. Thus, it is reasonable to use GNNs for the representation learning of proteins and drugs.</p>
    <p id="Par6">However, classical pair-input approaches often take drug-protein pairs as training samples by concatenating and feeding their representations into a dense layer to identify the interactions. However, these approaches may fail at inductive tests for unseen proteins and drugs not seen during the model training, which is due to their potential shortcuts<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> that remember the degree ratio of binding annotations in the training set rather than learning the molecular features of interactions<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. To generalize to unseen proteins and drugs, AI-Bind leverages network-derived negatives and pre-training to resolve the shortcut learning issue<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Furthermore, proteins may have diverse binding patterns with drugs, which can be captured by training a protein-specific model for individual proteins. Recently, a ligand-based method MetaDTA<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> is developed as a few-shot predictor for proteins with a few known binding drugs under the meta-learning framework. However, MetaDTA does not support zero-shot prediction for unseen proteins without known binding drugs in the training set.</p>
    <p id="Par7">To address these challenges, we propose a protein-specific zero-shot predictor ZeroBind for drug-target interaction prediction under the meta-learning framework. ZeroBind adopts the meta-learning framework MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> as the training strategy and each base model makes binding drug predictions of a specific protein, which mainly consists of four modules: (1) a Graph Convolutional Network (GCN) encoder learning the embeddings of the molecule graph and protein graph, (2) a Subgraph Information Bottleneck (SIB) module generating the essential IB-subgraph of the protein graph as a potential binding pocket, (3) a Multilayer Perceptron (MLP) module concatenating the protein IB-subgraph embedding and molecular embedding to perform DTI prediction, and (4) a task adaptive self-attention module to measure the importance of different tasks, where different DTI tasks contribute differently to the meta-learner. The generated task weight is used for weighted average loss and further incorporated into the meta-learning procedure.</p>
    <p id="Par8">In summary, our contributions are as follows: (1) We formulate the drug-target interaction prediction for unseen drugs and proteins as a zero-shot learning problem. The general knowledge of DTI prediction learned from existing proteins, drugs, and their interactions with meta-learning strategy have a greater ability for generalization to unseen proteins and drugs than existing methods. (2) We train one DTI task model per protein, where task adaptive self-attention is designed to calculate the contributions of multiple DTI tasks to the protein-specific meta-learner. Thus, each protein-specific model captures individual binding patterns to drugs. (3) We propose model-agnostic IB-subgraph learning to automatically discover compressed subgraphs as potential binding pockets in proteins instead of redundant graph information derived from the whole protein. (4) We conduct extensive experiments on three independent zero-shot test sets and one few-shot test set. Results show that ZeroBind consistently outperforms existing methods. Further validation of real-world SARS-COV-2 drug-target binding prediction demonstrates the reliability of ZeroBind predictions and the subgraphs detected by IB-subgraph learning align well with the known binding pockets in proteins.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of ZeroBind</title>
      <p id="Par9">In this study, ZeroBind formulates the DTI prediction as a meta-learning task and proposes a meta-learning framework to solve the generalization problem of unseen proteins and drugs in DTI prediction. Specifically, a meta-learning task is defined as binding drug predictions of a specific protein, where IB-subgraph learning is leveraged to automatically discover compressed subgraphs as potential binding pockets in proteins and a self-attention mechanism is designed to learn weights for each task of a protein. The flowchart of ZeroBind is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><title>The framework of ZeroBind.</title><p><bold>a</bold> Network-based negative sampling strategy. The bipartite network consisting of drugs and protein targets: The square nodes represent the protein nodes and the circle nodes represent the molecule nodes, and there are only edges between different types of nodes, representing the corresponding drug-target interaction. Solid lines represent existing drug-target interactions (DTIs) and dotted lines represent the generated negative interactions with the shortest path distance ≥ 7. <bold>b</bold> The positive ratio of the training set before the network-based negative sampling strategy. <bold>c</bold> The positive ratio of the training set after the network-based negative sampling strategy. <bold>d</bold> Given the support set and query set, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{support}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq9.gif"/></alternatives></inline-formula> is first calculated and utilized to update the base model with parameter <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\theta }}}}}}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq10.gif"/></alternatives></inline-formula> to a task-specific model with parameter <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}^{{{{\prime}}}}$$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq11.gif"/></alternatives></inline-formula> using the support set of each task, and then the task-specific model calculates the <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{query}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq12.gif"/></alternatives></inline-formula> using the query set of the task. After repeating N inner steps, all losses are weighted average by <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\boldsymbol{\omega }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ω</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq13.gif"/></alternatives></inline-formula>, and gradient descent is further performed to optimize the meta model. <bold>e</bold> The architecture of the base model in ZeroBind. For each task, the protein graph and the molecule graph are fed into a backbone graph convolutional network (GCN) with parameters <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{M}}}}}}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq15.gif"/></alternatives></inline-formula>, respectively, to obtain their embeddings. Subsequently, a SIB module is proposed to generate the IB-subgraph of a protein as potential binding pockets in a weakly supervised way. The protein subgraph embedding is concatenated with the molecular embedding and they are fed into a Multilayer Perceptron (MLP) module to identify the interactions. <bold>f</bold> Task adaptive attention module. It takes the concatenation of the protein embedding <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{p}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{k}}}}}}}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq16.gif"/></alternatives></inline-formula> and the average of all molecule embeddings <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{k}}}}}}}^{{{{{{\bf{i}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq17.gif"/></alternatives></inline-formula> in the query set as the task embedding. After using the self-attention layer to compute the weight of each task, denoted as <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\right\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq18.gif"/></alternatives></inline-formula>, the overall loss is averaged and incorporated into the meta-training process for updating the model parameters. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig1_HTML" id="d32e716"/></fig></p>
      <p id="Par10">In detail, ZeroBind uses network-based negative sampling<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> as data augmentation to alleviate the annotation imbalance (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, Methods section). Figure <xref rid="Fig1" ref-type="fig">1</xref>b, <xref rid="Fig1" ref-type="fig">c</xref> illustrates the ratio of positive samples before and after network-based negative sampling on the training set, indicating that network-based negative sampling alleviates the annotation imbalance to a certain extent. Then, it samples the DTIs into the support and query set (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>), where the support set is used to train the meta-learner and the query set is used to train the task-specific models. After repeating N inner steps, all losses are weighted to optimize the meta-learner with gradient descent. For each protein, ZeroBind trains a DTI prediction task. Figure <xref rid="Fig1" ref-type="fig">1e</xref> gives the architecture of the base model in ZeroBind, where the protein graph and molecule graph are fed into a backbone GCN to learn embeddings for drugs and proteins. Furthermore, a weakly supervised Subgraph Information Bottleneck (SIB) module is designed to model and discover potential binding pockets in proteins. The SIB module not only reduces redundant information to boost the performance, but also brings interpretable insights into ZeroBind by identifying the critical residues in the protein. Figure <xref rid="Fig1" ref-type="fig">1f</xref> introduces an adaptive self-attention module to measure the contribution of each task of a protein, where different DTI tasks contribute differently to the meta-learner. ZeroBind support predicting DTIs in zero-shot and few-shot scenarios. The former uses the meta-learner to make predictions directly without fine-tuning using the samples of proteins in meta-testing, and the latter uses the protein-specific model to make predictions with fine-tuning using the samples of the protein in meta-testing.</p>
    </sec>
    <sec id="Sec4">
      <title>ZeroBind outperforms existing methods in both zero-shot and few-shot settings for DTI prediction</title>
      <p id="Par11">To demonstrate the advantages of ZeroBind, we compare it with multiple baseline methods and calculate the area under the receiver operating characteristic (AUROC) and the area under the precision-recall curve (AUPRC) on three independent test sets and one few-shot test set. To ensure the effectiveness of performance comparison, we conduct five independent experiments with five random seeds for datasets partitioning and model training, and report the average results along with standard deviation.</p>
      <p id="Par12">The overall performances of all methods in three independent test sets are reported in Fig. <xref rid="Fig2" ref-type="fig">2a</xref> (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). ZeroBind achieves an AUROC of 0.9521(±0.0034), 0.8681(±0.0052), 0.8139(±0.0035) in the Transductive, Semi-inductive, and Inductive test sets, respectively. We can see that ZeroBind outperforms all baseline methods in the Transductive, Semi-inductive, and Inductive test sets. Compared to the best baseline method, ZeroBind achieves relative improvements in AUROC with 2.86% on the Transductive test set, 10.29% on the Semi-inductive test set, and 3.38% on the Inductive test set, the corresponding t-test p-value is 1.02 × 10<sup>−6</sup>, 8.02 × 10<sup>−11</sup>, 3.06 × 10<sup>−7</sup>, respectively. Moreover, the relative improvements of AUPRC are 1.00% on the Transductive test set, 0.96% on the Semi-inductive test set, and 1.21% on the Inductive test set compared to the best baseline method, the corresponding <italic>t</italic>-test <italic>p</italic>-value is 8.93 × 10<sup>−8</sup>, 5.15 × 10<sup>−3</sup>, 1.56 × 10<sup>−5</sup>, respectively. In addition, on the three test sets, we observe that the performance of all methods decreases, indicating that a certain external shortcut learning exists for the Transductive test set.<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance comparison of ZeroBind with baseline methods in zero-shot and few-shot scenarios.</title><p><bold>a</bold> Zero-shot performance evaluation with ZeroBind and baseline methods on three independent test sets. <bold>b</bold> Area Under the Receiver Operating Characteristic Curve (AUROC) comparison of the protein-specific ZeroBind and the baseline methods for 775 proteins in the combined inductive and semi-inductive test set. The color of points stands for the number of training proteins. <bold>c</bold> The number of proteins that the method performs the best among the compared methods for the combined inductive and semi-inductive test sets. <bold>d</bold> Few-shot performance comparison of ZeroBind with baseline methods on the few-shot test sets. Supplementary Tables <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM1" ref-type="media">2</xref> provide the data statistics for zero-shot and few-shot prediction with two-sided <italic>t</italic>-test without adjustment. Source data are provided as a Source Data file. AUPRC refers to Area Under the Precision-recall Curve.</p></caption><graphic xlink:href="41467_2023_43597_Fig2_HTML" id="d32e802"/></fig></p>
      <p id="Par13">Figure <xref rid="Fig2" ref-type="fig">2a</xref> shows that AI-bind and our proposed ZeroBind outperform other baseline methods on the Inductive test set due to the incorporation of network-based negative sampling and unsupervised pre-trained embeddings to avoid the potential shortcut learning. ZeroBind achieves stable and better performance at Transductive and semi-inductive test sets than baseline methods, indicating that ZeroBind can effectively learn useful embeddings of proteins and drugs. Furthermore, ZeroBind achieves better performance in the inductive test set than AI-Bind. The potential reason is that ZeroBind uses a meta-learning framework to obtain a general knowledge of DTI prediction across multiple proteins, which can generalize well to the DTI prediction of unseen proteins and drugs.</p>
      <p id="Par14">We also evaluate the protein-specific DTI prediction performance of ZeroBind with other baseline methods on the inductive test set and semi-inductive test set (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). After excluding proteins without binding or nonbinding labels, we obtain 775 proteins with binding drugs and one task model is trained per protein, here ZeroBind is evaluated on the combined inductive and semi-inductive test sets. ZeroBind achieves an average AUROC of 0.78, which is higher than the AUROC 0.66 of DeepConv-DTI, 0.68 of GraphDTA, 0.69 of Deeppurpose, 0.75 of AI-bind and 0.73 of DrugBAN across the 775 proteins. Of the 775 proteins, ZeroBind outperforms DeepConv-DTI, GraphDTA, Deeppurpose, AI-bind, and DrugBAN for 525, 491, 305, 180 and 346 proteins, respectively. For each method, we present the number of proteins that this method outperforms other methods (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>) according to the number of binding molecules. We observe that ZeroBind outperforms other baseline methods for the most proteins in the three ranges, especially for the proteins with only 1–10 known binding molecules, followed by AI-Bind.</p>
      <p id="Par15">We further evaluate ZeroBind against the baseline methods on the few-shot test set. ZeroBind and other baseline methods are first trained with the training set as the pre-training model, and further fine-tuned on each few-shot fine-tuning set and evaluated on the corresponding few-shot test set. The performance of ZeroBind model and other baselines on the few-shot test set is shown in Fig. <xref rid="Fig2" ref-type="fig">2d</xref> (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>). In the few-shot test, ZeroBind outperforms the best baseline methods with relative improvements of AUROC 1.55% and AUPRC 1.62%. The potential reason is that the meta-learning framework has the strong generalization ability to quickly adapt to additional protein tasks with a few training samples. We can see that fine-tuning improves the zero-shot prediction performance by a large margin, which is very useful for the real-world application scenario that a protein has only a few known binding drugs.</p>
    </sec>
    <sec id="Sec5">
      <title>ZeroBind detects the subgraphs that align well with known binding pockets of proteins in a weakly supervised way</title>
      <p id="Par16">ZeroBind does not use binding pocket information as ground truth labels for model training, instead, it uses the global DTI labels as a weakly supervised labels. To demonstrate that the IB-subgraph module in ZeroBind is able to detect the binding pocket in the protein, we use the Jaccard similarity coefficient<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> to compare the predicted binding pocket against the true binding pocket on PDBbind dataset<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. The true binding pocket information containing pocket residues and 3D coordinate locations are downloaded from PDBbind, which contains 14,000 binding residues for 535 proteins. The Jaccard similarity coefficient is used to calculate the degree of intersection between two sets of individual DTIs, and the formula is defined as <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Jaccard\; similarity\; coefficient}(\hat{P},P)=\frac{\hat{P}\cap P}{\hat{P}\cup P}$$\end{document}</tex-math><mml:math id="M38"><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.16em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∩</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∪</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{P}$$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq20.gif"/></alternatives></inline-formula> represents the set of predicted binding pocket residues by ZeroBind for a DTI, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M42"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq21.gif"/></alternatives></inline-formula> represents the set of true binding residues in the pocket for this DTI.</p>
      <p id="Par17">In addition, we calculate the Jaccard similarity coefficient of predicted binding pockets nodes and the first-order neighbors of the true binding pocket nodes as <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Jaccard\; similarity\; coefficient}(\hat{P},{P}_{{neighbor}})=\frac{\hat{P}\cap {P}_{{neighbor}}}{\hat{P}\cup {P}_{{neighbor}}}$$\end{document}</tex-math><mml:math id="M44"><mml:mi>J</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.16em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq22.gif"/></alternatives></inline-formula>, <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{{neighbor}}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq23.gif"/></alternatives></inline-formula> represents the set of first-order neighbor pockets of the real binding pocket.</p>
      <p id="Par18">Figure <xref rid="Fig3" ref-type="fig">3</xref>a, <xref rid="Fig3" ref-type="fig">b</xref> shows the distribution of Jaccard similarity coefficients of predicted binding pockets with true binding pockets and the first-order neighbors of true binding pockets, respectively. ZeroBind yields average Jaccard similarity coefficients of 0.358 and 0.605, respectively. For the neighboring pockets, Jaccard similarity coefficients are above 0.5 for most pockets. The results show that despite some discrepancy between the predicted binding pockets and true binding pockets, the predicted binding pockets are mostly around the true binding pockets, indicating the effectiveness of the generated IB-subgraph in ZeroBind as the potential binding pocket with some biological interpretability. We further conduct an experiment of randomly sampled residues as potential protein pockets, here denoted as ZeroBind<sup>random</sup>. The results are shown in the ablation studies and here we also calculate the Jaccard similarity coefficients of randomly sampled binding residues with true binding pockets and the first-order neighbors of true binding pockets, respectively. The ZeroBind<sup>random</sup> yields an average Jaccard similarity coefficients of 0.013 and 0.072 (all the values are below 0.2), which is much smaller than that of ZeroBind, respectively. As shown in Fig. <xref rid="Fig3" ref-type="fig">3a, b</xref>, we can see that the randomly selected binding residues have little overlap with the true binding pockets or their neighbors in proteins. The results indicate that the SIB module in ZeroBind learns the potential binding pockets instead of other unrelated factors, since the DTI binding information is to a certain extent able to guide the IB-subgraph module to locate potential binding pockets.<fig id="Fig3"><label>Fig. 3</label><caption><title>ZeroBind is able to detect binding pockets of proteins in a weakly supervised way.</title><p><bold>a</bold> The distribution of Jaccard similarity coefficients of the predicted binding pockets with the true binding pockets and randomly selected binding residues as binding pockets with the true binding pockets of individual DTIs. <bold>b</bold> The distribution of Jaccard similarity coefficients of the predicted binding pockets with the first-order neighbors of true binding pockets and randomly selected binding residues as binding pockets with the first-order neighbors of true binding pockets of individual DTIs. <bold>c</bold> The Serine/threonine-protein kinase N1 protein. Experimentally validated DTI binding pocket queried by BioLiP. The blue part represents the experimentally validated binding pocket along with the residue name and number. <bold>d</bold> The potential binding pocket predicted by IB-subgraph in ZeroBind. The red part represents the helix structure of protein, the yellow part represents the loop structure of protein and the green part represents the sheet structure of protein. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig3_HTML" id="d32e1089"/></fig></p>
      <p id="Par19">To further demonstrate the effectiveness of the IB-subgraph module, we train a variant ZeroBind for those proteins with known binding pockets using true binding pocket as the node assignment matrix <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M48"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq24.gif"/></alternatives></inline-formula> for the inductive test set. This variant ZeroBind achieves an average AUROC of 0.8278, which is higher than the AUROC 0.8032 of the ZeroBind that uses learned node assignment matrix <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M50"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq25.gif"/></alternatives></inline-formula> by a narrow margin. The experimental results further validate the effectiveness of the IB-subgraph module in ZeroBind.</p>
      <p id="Par20">We further visualize the generated IB-subgraph as the potential binding pocket for Serine/threonine-protein kinase N1 protein in Fig. <xref rid="Fig3" ref-type="fig">3c, d</xref>. We can see that although the IB-subgraph introduces some false positive binding residues due to no known binding pocket information for IB-subgraph module training, the potential binding residues included in the IB-subgraph contain most of the true binding residues deposited in BioLip<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
    </sec>
    <sec id="Sec6">
      <title>ZeroBind is able to predict potential drugs against SARS-COV-2 Proteins</title>
      <p id="Par21">To better demonstrate the effectiveness of ZeroBind, we use Auto-Docking simulations to validate its predicted potential drugs targeting the SARS-COV-2 proteins. Auto-Docking simulation is a time-consuming but reliable tool to simulate the drug-target binding process. To respond quickly to public health emergencies, we need to validate ZeroBind on proteins that don’t have many binding molecules. Thus, we apply ZeroBind to predict the interactions between the structures of 10 SARS-CoV-2 viral proteins not in the training set and 10,000 drugs in PubChem<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, where the PDB IDs for SARS-COV-2 protein structures are given in Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>. Then, we choose top-10 binding confidence pairs based on the predicted scores by ZeroBind and further perform Auto-Docking simulations to validate the effectiveness of ZeroBind predictions with AutoDock Vina<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>.</p>
      <p id="Par22">The average binding affinity of the top-10 predicted pairs by ZeroBind is −7.42 kcal/mole (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>), which are promising drug-target pairs and also validate the reliability of ZeroBind predictions<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. As demonstrated in<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, the average binding affinities are close to −7.5 kcal/mole for three binding pairs of SARS-COV-2 proteins and drugs. Furthermore, we simulate the drug-target binding complex between ORF8 accessory protein and VZBSCWDKCMOJCR-UHFFFAOYSA-N drug in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, it yields a relative good binding affinity score of −8.4 kcal/mole. And we also simulate the drug-target binding complex between ORF3a protein and OLTVRSUIOUTBRQ-UHFFFAOYSA-N drug in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, which yields a binding affinity score of −5.8 kcal/mole. As shown in Fig. <xref rid="Fig4" ref-type="fig">4b, c</xref>, we can see that the predicted drugs bind well to the pockets in SARS-COV-2 proteins. In future work, we expect ZeroBind to validate the potential drugs against the target proteins, especially those proteins with no verified drugs.<fig id="Fig4"><label>Fig. 4</label><caption><title>ZeroBind predicts binding drugs for SARS-COV-2 proteins.</title><p><bold>a</bold> Top 10 drug-target binding pairs of SARS-COV-2 proteins. <bold>b</bold> The drug-target binding complex between the drug InChI Key VZBSCWDKCMOJCR-UHFFFAOYSA-N and SARS-CoV-2 ORF8 protein. The green part represents the main part of the protein, the blue part represents the binding drug and the red part represent potential binding sites consisting of the residue name and number. <bold>c</bold> The drug-target binding complex between the drug InChI Key OLTVRSUIOUTBRQ-UHFFFAOYSA-N and SARS-CoV-2 ORF3a protein. The purple part and blue part represents the two main chains of ORF3a protein, the green part represents the binding drug and the red part represent potential binding sites consisting of the residue name and number. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_43597_Fig4_HTML" id="d32e1175"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Ablation studies on ZeroBind</title>
      <p id="Par23">To demonstrate the added value of individual modules in ZeroBind, we also conducted an ablation study to evaluate the effectiveness. The details of ZeroBind with different modules are illustrated as follows:<list list-type="order"><list-item><p id="Par24">ZeroBind<sup>MAML-</sup>: Train the base model of ZeroBind directly without the meta-learning strategy.</p></list-item><list-item><p id="Par25">ZeroBind<sup>SIB-</sup>: Using all node embeddings of the protein to identify the interaction instead of applying a SIB module to find the IB-graph on the protein graph.</p></list-item><list-item><p id="Par26">ZeroBind<sup>attention-</sup>: ZeroBind without task adapted attention module to balance the importance of different tasks.</p></list-item><list-item><p id="Par27">ZeroBind<sup>GIN</sup>: ZeroBind uses GIN instead of GCN as the backbone GNN.</p></list-item><list-item><p id="Par28">ZeroBind<sup>random</sup>: ZeroBind sets the node assignment matrix <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M52"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq26.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) randomly.</p></list-item></list></p>
      <p id="Par29">The results are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. For ZeroBind<sup>MAML-</sup>, we observe a significant decrease in the semi-inductive and inductive test sets, demonstrating that the meta-learning training strategy provides the powerful generalization ability to unseen proteins and drugs. We can see that ZeroBind<sup>SIB-</sup> yields a lower performance without the SIB module to find the IB-subgraph, indicating the embedding of the whole protein is less effective than the subgraph embedding. The potential reason is that redundant graph information exists in the whole protein graph, further indicating that the molecule binds to a binding pocket instead of the whole protein. ZeroBind<sup>attention-</sup> performs slightly worse than ZeroBind, indicating the necessity of task adaptive self-attention module to balance different DTI tasks for different proteins. We also see a performance decline for ZeroBind<sup>sampling-</sup>, due to the lack of the value-generated nonbinding annotations by network-based negative samplings that is able to alleviate the potential short-cut learning. For ZeroBind<sup>GIN</sup>, there is no significant difference in the performance compared with ZeroBind, which indicates that the backbone GNN has a smaller impact on the performance than other modules in ZeroBind. Compared to randomly selected binding pockets, ZeroBind<sup>random</sup> performs worse than ZeroBind, further validating the effectiveness of the SIB module for detecting potential binding pockets. Moreover, we can see that ZeroBind<sup>random</sup> with randomly selected pockets performs worse than ZeroBind<sup>SIB-</sup> without the IB-subgraph module, indicating that initially inaccurate binding pockets guides the model to not locate true binding pockets, resulting in a wrong DTI prediction.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance evaluation of ablation studies on ZeroBind</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Metric</th><th>Model</th><th>Transductive test</th><th>Semi-inductive test</th><th>Inductive test</th></tr></thead><tbody><tr><td rowspan="7">AUROC</td><td>ZeroBind<sup>MAML-</sup></td><td>0.8632 ± 0.0071</td><td>0.7835 ± 0.0063</td><td>0.6153 ± 0.0031</td></tr><tr><td>ZeroBind<sup>SIB-</sup></td><td>0.8556 ± 0.0056</td><td>0.8018 ± 0.0121</td><td>0.7122 ± 0.0042</td></tr><tr><td>ZeroBind<sup>attention-</sup></td><td>0.9057 ± 0.0078</td><td>0.8352 ± 0.0020</td><td>0.7585 ± 0.0026</td></tr><tr><td>ZeroBind<sup>sampling-</sup></td><td>0.9066 ± 0.0018</td><td>0.8280 ± 0.0031</td><td>0.7852 ± 0.0043</td></tr><tr><td>ZeroBind<sup>GIN</sup></td><td>0.9412 ± 0.0050</td><td>0.8652 ± 0.0046</td><td>0.8025 ± 0.0027</td></tr><tr><td>ZeroBind<sup>random</sup></td><td>0.8865 ± 0.0017</td><td>0.8254 ± 0.0082</td><td>0.7562 ± 0.0031</td></tr><tr><td><bold>ZeroBind</bold></td><td><bold>0.9521</bold> ± 0.0038</td><td><bold>0.8681</bold> ± 0.0065</td><td><bold>0.8139</bold> ± 0.0045</td></tr><tr><td rowspan="7">AUPRC</td><td>ZeroBind<sup>MAML-</sup></td><td>0.9540 ± 0.0044</td><td>0.9115±0.0010</td><td>0.8547 ± 0.0027</td></tr><tr><td>ZeroBind<sup>SIB-</sup></td><td>0.9385 ± 0.0117</td><td>0.9375 ± 0.0028</td><td>0.9242 ± 0.0058</td></tr><tr><td>ZeroBind<sup>attention-</sup></td><td>0.9789 ± 0.0050</td><td>0.9742 ± 0.0065</td><td>0.9408 ± 0.0061</td></tr><tr><td>ZeroBind<sup>sampling-</sup></td><td>0.9782 ± 0.0027</td><td>0.9645 ± 0.0063</td><td>0.9655 ± 0.0057</td></tr><tr><td>ZeroBind<sup>GIN</sup></td><td>0.9831 ± 0.0043</td><td>0.9850 ± 0.0058</td><td>0.9817 ± 0.0062</td></tr><tr><td>ZeroBind<sup>random</sup></td><td>0.9635 ± 0.0056</td><td>0.9375 ± 0.0151</td><td>0.9288 ± 0.0071</td></tr><tr><td><bold>ZeroBind</bold></td><td><bold>0.9896</bold> ± 0.0013</td><td><bold>0.9880</bold> ± 0.0062</td><td><bold>0.9872</bold> ± 0.0020</td></tr></tbody></table><table-wrap-foot><p>The average is reported after performing each experiment five times, along with the standard deviation. The bold face indicates the method is the best across the compared methods.</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par30">The interaction of proteins with drug molecules is an important research topic, especially in the face of proteins and drug molecules not seen in the training set. Considering the information of proteins and molecules simultaneously is an under-explored idea to solve this problem. In this study, we formulate the drug-target interaction (DTI) prediction as a meta-learning task and propose a meta-learning framework called ZeroBind to solve the generalization problem of unseen proteins and drugs in DTI. Specifically, a meta-learning task is defined as binding drug predictions of a specific protein. The results demonstrate that ZeroBind outperforms existing methods in zero-shot and few-shot scenarios. In addition, the subgraphs learned by SIB align well with binding pockets in the protein, where randomly selected residues as binding pockets almost do not overlap with true binding pockets. Furthermore, we validate ZeroBind’s performance in a real-world scenario, where it predicts drug-target bindings for SARS-COV-2.</p>
    <p id="Par31">Due to the rapid development of the research on GNNs, proteins and molecules can be encoded in a more natural form than sequences in previous studies. In addition, the meta-learning strategy also provides a more precise way of delineating the protein-specific DTI task space, which is also consistent with the experimental workflow for proteins in real drug experiments. However, ZeroBind also has some limitations, such as the difficulty of meta-learning training, where the training procedure is complex and prone to instability.</p>
    <p id="Par32">The IB-subgraph method offers an interpretable ability of the model for understanding representation learning. In ZeroBind, the potential binding pockets are automatically detected with the weakly supervised IB-subgraph method that does not use binding pocket annotations as labels. To the best of our knowledge, still no published methods use IB-subgraph or other subgraph-based methods to identify potential binding pockets in the proteins, existing subgraph-based methods are focused on drug molecules. In the current study, we do not incorporate real binding pocket information into model training, since the binding pocket data is far less than the DTI data, and the protein structures predicted by AlphaFold2 still have no known binding pocket annotations. Of the proteins in the benchmark dataset, only 535 proteins have a part of known binding pockets. Thus, it is difficult to train the SIB module in ZeroBind for all proteins to detect binding pockets using the local binding pocket labels. Instead, we train the SIB module of ZeroBind using the global DTI binding labels, which potentially guides the SIB module to locate the potential binding pockets in proteins. As shown in our experiment, ZeroBind with true binding pockets yields better performance. A future update of ZeroBind is expected to take true binding pocket information into the training process to make a more accurate fitting to the DTI problem, if we can collect more true binding pocket data.</p>
    <p id="Par33">Furthermore, the base model in ZeroBind is GCN and there have been more advanced neural architectures for protein-molecule binding, such as SE(3)-equivariant GNN used in EquiBind<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. In future work, we expect to investigate more advanced GNNs in ZeroBind.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Dataset generation and augmentation</title>
      <p id="Par34">BindingDB<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> is a public database of DTI interactions, which deposits binding affinity data between drugs (drug-like molecules) and target proteins. It currently contains over 2,600,000 experimentally determined binding affinities of protein-drug complexes between over 8000 protein targets and over 1,100,000 small molecules.</p>
      <p id="Par35">To create the training and test datasets for ZeroBind, we apply several filtering and preprocessing steps to create a high-quality benchmark dataset. First, data points are filtered with “single protein” for the “target type” attribute, and kinetic constants <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq28.gif"/></alternatives></inline-formula>, <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq30.gif"/></alternatives></inline-formula> for the “standard type” attribute. In addition, all target proteins should be human or human-like proteins, so they are filtered using “Homo sapiens” for “Target Source Organism” attribute. After excluding proteins that don’t have SwissProt name and molecules that cannot be handled by RDKit<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, 1,500,000 protein-drug pairs were collected. We use the threshold in AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, which treats kinetic constants <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{i}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{d}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq32.gif"/></alternatives></inline-formula>, <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{IC}}_{50}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{EC}}_{50} &lt; $$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq34.gif"/></alternatives></inline-formula>1000 nM as positive samples and <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ &gt; {10}^{6}$$\end{document}</tex-math><mml:math id="M70"><mml:mo>&gt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq35.gif"/></alternatives></inline-formula> nM as negative samples.</p>
      <p id="Par36">To demonstrate the effectiveness of ZeroBind, we construct three independent test sets for model evaluation through protein sequence similarity clustering by cd-hit and molecule scaffold split: (1) Transductive test set, where molecules with the same scaffold and proteins with the same cluster are in the training set, but their interactions do not exist in the training set; (2) Semi-inductive test set, where the proteins in the same cluster are in the training set, but the molecules with the same scaffold are not; (3) Inductive test set, where molecules with the same scaffolds and proteins in the same clusters are not in the training set.</p>
      <p id="Par37">We first use cd-hit, a widely used program for clustering protein sequences, to cluster 1603 proteins into 1101 clusters with a similarity threshold 0.4. Through comparing molecule scaffolds, we split the molecules into the training molecule set and test molecule set with a training ratio of 0.95, and ensure that these two sets do not have overlapping scaffolds. As the meta-learning-based framework requires sufficient data, we first divide the clusters that have any protein with the number of associated molecules &lt;20 into the test clusters, and the remaining clusters as the training clusters. Then, we construct the training set using 95% of the proteins in the training clusters and SMILES in the training molecules set. The remaining 5% of the proteins in the training clusters and smiles in the training molecules set are used as the Transductive test set. Finally, the proteins and smiles both in the test clusters and molecule set are further used as the Inductive test set, and the rest data are used as the Semi-inductive test set. During the model training, the cross-validation approach is applied for model optimization.</p>
      <p id="Par38">In addition, we construct another few-shot test set with combining the Semi-inductive test set and the Inductive test set to evaluate the few-shot learning power of ZeroBind. Then, we randomly select 5 positive and 5 negative DTIs of each protein as the few-shot fine-tuning set, and the rest DTIs of each protein as the few-shot test set. Proteins that don’t have enough positive or negative DTIs are excluded from the few-shot fine-tuning set and the few-shot test set. The details of the training set and four test sets are given in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The details of the training set and four test sets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Number of proteins</th><th>Number of drugs</th><th>Number of interactions</th></tr></thead><tbody><tr><td>Training set</td><td>426</td><td>248,997</td><td>392,032</td></tr><tr><td>Transductive test set</td><td>392</td><td>16,946</td><td>17,314</td></tr><tr><td>Semi-inductive test set</td><td>1575</td><td>159,182</td><td>228,320</td></tr><tr><td>Inductive test set</td><td>688</td><td>7261</td><td>10,165</td></tr><tr><td>Few-shot test set</td><td>1253</td><td>127,665</td><td>160,948</td></tr></tbody></table></table-wrap></p>
      <p id="Par39">We observe there exists data imbalance in the training set, and most proteins have a high positive ratio. AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> demonstrates that the annotation imbalance causes the network to learn topological shortcuts instead of the binding patterns of drug-target interactions. Similar to AI-Bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, we use the network-based negative sampling of training datasets as data augmentation to alleviate the annotation imbalance. Specifically, we construct a bipartite drug-target network. The bipartite network is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. Dijkstra’s Algorithm is used to find the shortest path distances between any pairs of nodes in the network, and we consider the node pairs with the shortest path distance ≥ 7 in the network as non-binding pairs. After this processing, the annotation imbalance was slightly relieved as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, <xref rid="Fig1" ref-type="fig">c</xref>.</p>
      <p id="Par40">The 3D structures of 996 proteins in this study are downloaded in PDB format from the RCSB Protein Data Bank (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org">https://www.rcsb.org</ext-link>)<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, and the rest 3D structures of 635 proteins are predicted by AlphaFold2<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. In addition, we download the true binding pocket information containing pocket residuals and pocket 3D coordinate locations from the PDBbind database, which contains binding pockets for 14,336 DTIs.</p>
    </sec>
    <sec id="Sec11">
      <title>Graph construction for proteins and drugs</title>
      <p id="Par41">In this section, we first introduce the construction of drug graphs and protein graphs, and then give formal definitions of the DTI task and its derivatives, zero-shot DTI predicting task and few-shot DTI predicting task.</p>
      <p id="Par42">After using RDkit<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> to construct a molecule from a SMILES<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> string, we apply the encoding format used in Open Graph Benchmark (OGB) datasets<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> to obtain molecular representation. Specifically, atom chemical features consist of atomic number, chirality, atomic formal charge, number of hydrogen atoms attached, radical electrons number, hybridization type, and aromatic. Geometric features consist of atom degree, and a binary value that whether in the ring is used for encoding node representation. Edge features consist of bond type, bond stereo and a binary value that whether bond is conjugated.</p>
      <p id="Par43">Definition 1: We define a drug as a graph denoted as <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{m}=\left\{{V}_{m},{E}_{m}\right\}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq36.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{m}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq37.gif"/></alternatives></inline-formula> is the node set representing the atoms of a molecule and <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{m}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq38.gif"/></alternatives></inline-formula> is the edge set indicating which pair of nodes are connected.</p>
      <p id="Par44">Definition 2: We define a protein graph as <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{p}=\left\{{V}_{p},{E}_{p}\right\}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq39.gif"/></alternatives></inline-formula> from the protein 3D structure, where <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{p}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq40.gif"/></alternatives></inline-formula> is the node set of the residues, <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{p}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq41.gif"/></alternatives></inline-formula> is the edge set indicating which pair of residue nodes are connected. In this study, if the Euclidean distance between two residues in 3D structure space is less than 8 angstroms (Å)<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>, the two residue nodes are connected with one edge in the protein graph.</p>
      <p id="Par45">For proteins without known 3D structures, we use AlphaFold2<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to predict their structures as complementary. The node features of the protein graph are initialized with pre-trained ESM-2<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> emebddings, a general-purpose protein language model, of the residues to incorporate prior knowledge. The edge features of the protein graph are the Euclidean distance between the pairs of nodes. The whole process of constructing a protein graph is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><title>The data processing of ZeroBind.</title><p><bold>a</bold> The process of constructing a protein graph from the protein 3D structure. Instead of using peptide bonds as edges, we connect two residues with the cutoff distance &lt; 8 angstroms (Å), where edges and node features are extracted using ESM-2 pretrained model. <bold>b</bold> An example of the protein graph construction from the protein 3D structure. <bold>c</bold> The few-shot DTI prediction process and zero-shot DTI prediction process.</p></caption><graphic xlink:href="41467_2023_43597_Fig5_HTML" id="d32e1880"/></fig></p>
      <p id="Par46">In this work, we train a DTI task per protein.</p>
      <p id="Par47">Definition 3: We define a DTI task <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{p}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq42.gif"/></alternatives></inline-formula> from a task set <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathscr{T}}}}}}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq43.gif"/></alternatives></inline-formula> for meta learning as <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{p}=\left\{p,{M}_{p}\right\}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq44.gif"/></alternatives></inline-formula>, where <italic>p</italic> is a protein in the protein set <italic>P</italic> and <italic>M</italic><sub><italic>p</italic></sub> is the drug set of its corresponding binding molecules and non-binding molecules.</p>
      <p id="Par48">Definition 4: We define the zero-shot DTI predicting task inherited from DTI task, which represents that the meta-model is directly used for prediction without fine-tuning with samples of the protein in meta-learning test set.</p>
      <p id="Par49">Definition 5: We define the few-shot DTI predicting task inherited from DTI task, which uses the protein-specific model for prediction after fine-tuning with samples of the protein in meta-testing.</p>
      <p id="Par50">The few-shot DTI prediction schedule and zero-shot DTI prediction schedule are shown in Fig. <xref rid="Fig5" ref-type="fig">5c</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>Meta-learning setup in ZeroBind</title>
      <p id="Par51">The meta-learning framework was originally proposed to learn general knowledge across multiple related tasks within a distribution and used this general experience to quickly adapt to additional tasks and improve prediction performance<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. There are two main types of meta-learning framework: (1) Gradient-based methods: The classic gradient-based method MAML<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> uses a meta-learner to learn a good initialization by summing up multiple task losses and updating the parameters across tasks. Therefore, MAML could achieve both high accuracy and speed for generalization; (2) Metric-based methods: The prototypical network<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> is a classic metric-based meta-learning algorithm that directly trains the vector representation (i.e., prototypes) of each category. Once a good feature extractor is trained, the category of a new sample is determined by its closest prototype in the vector space. In our study, we apply gradient-based methods MAML as the training strategy. Besides, we follow MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> to make some improvements to stabilize the training process of MAML.</p>
      <p id="Par52">In the details of ZeroBind, several techniques including multi-step loss optimization (MSL), learning per-layer per-step learning rates and gradient directions (LSLR), subgraph information bottleneck (SIB), and task adaptive self-attention are applied to improve the performance of ZeroBind. We build the zero-shot learning framework based on MAML. First, we randomly initialize the network parameter <bold><italic>θ</italic></bold>. Given training tasks (proteins) sampled from the task distribution <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{\boldsymbol{{{{{\mathscr{T}}}}}}}}}}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="bold-script">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq45.gif"/></alternatives></inline-formula>, MAML aims to learn good initial parameters that can quickly adapt to additional tasks. For a pair of a protein and drug, we sample a 2-way, k-shot, m-query training task. Of these three hyperparameters, 2-way is set up since there are only two types of labels of binding and nonbinding in the classification task. In the original MAML framework, the model first trains <italic>k</italic> data samples of each label for several inner steps to learn a task-specific model and then tests on <italic>m</italic> data samples. After obtaining the loss for each task, MAML applies the gradient descent with the sum or average of the loss across all tasks. Here we refer the training task and test task as the support set and query set, respectively. However, MAML suffers from instability during training and is sensitive to neural network architectures and a large number of hyperparameters. Therefore, we follow MAML++<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> training procedure, which leverages multi-step loss optimization (MSL) and learning per-layer per-step learning rates and gradient directions (LSLR) in MAML.</p>
      <p id="Par53">Specifically, the multi-step loss optimization calculates the loss of the query set after each inner step, and optimizes the base network with the support set after all inner step optimization is completed. More formally, we optimize the model parameters as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta=\theta -\alpha {\nabla }_{\theta }\mathop{\sum }\limits_{b=1}^{B}\mathop{\sum }\limits_{i=0}^{N}{\upsilon }_{i}{{{{{{\mathscr{L}}}}}}}_{{T}_{b}}\left({f}_{{\theta }_{i}^{b}}\right)$$\end{document}</tex-math><mml:math id="M92"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M94"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq46.gif"/></alternatives></inline-formula> is the learning rate, <inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{T}_{b}}\left({f}_{{\theta }_{i}^{b}}\right)$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq47.gif"/></alternatives></inline-formula> denotes the loss of the query set after every inner step optimization with the support step and <inline-formula id="IEq48"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\upsilon }}}}}}}_{{{{{{\bf{i}}}}}}}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">υ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq48.gif"/></alternatives></inline-formula> denotes the importance of step <inline-formula id="IEq49"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M100"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq49.gif"/></alternatives></inline-formula> generated by the number of inner steps.</p>
      <p id="Par54">The LSLR module sets the learning rate to be learnable parameters for each layer at each inner step. Without adding much computation, different learning rates are automatically learned for each layer at each step, which may help alleviate overfitting.</p>
      <p id="Par55">To summarize the meta-learning procedure in ZeroBind (Boxes <xref rid="Sec13" ref-type="sec">1</xref> and <xref rid="Sec14" ref-type="sec">2</xref>), the model is first updated to task-specific models using the support set of each task, and then calculates the loss of the query set of the task. After repeating N inner steps, the losses of all query sets are weighted average by <inline-formula id="IEq50"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{{{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{i}}}}}}}}\}}_{{{{{{\bf{i}}}}}}{{{{{\boldsymbol{=}}}}}}{{{{{\bf{1}}}}}}}^{{{{{{\bf{N}}}}}}}$$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold-italic">=</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq50.gif"/></alternatives></inline-formula>, and are used to optimize the meta-model by gradient descent. After training with a sufficient number of samples, the learned model has a good capability of predicting DTI for unseen molecules and proteins or quickly adapting to additional protein tasks with a few training samples. The meta-learning procedure of ZeroBind is shown in Fig. <xref rid="Fig1" ref-type="fig">1d</xref>.</p>
    </sec>
    <sec id="Sec13">
      <boxed-text>
        <label>Box 1 ZeroBind training process</label>
        <p id="Par56">Require: <inline-formula id="IEq51"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right\}:$$\end{document}</tex-math><mml:math id="M104"><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>:</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq51.gif"/></alternatives></inline-formula> training data;</p>
        <p id="Par57">While not done do:</p>
        <p id="Par58">Sample batch of tasks <inline-formula id="IEq52"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }\sim p\left(\tau \right)$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq52.gif"/></alternatives></inline-formula></p>
        <p id="Par59">For all <inline-formula id="IEq53"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq53.gif"/></alternatives></inline-formula> do</p>
        <p id="Par60"> Sample k examples as support sets of <inline-formula id="IEq54"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq54.gif"/></alternatives></inline-formula>
<inline-formula id="IEq55"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{G}_{{mn}}^{\tau },{G}_{{pn}}^{\tau },{Y}_{n}^{\tau }\right\}}_{n=1}^{k}\in \left({G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right)$$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq55.gif"/></alternatives></inline-formula></p>
        <p id="Par61"> Sample m examples as query sets of <inline-formula id="IEq56"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{\tau }$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq56.gif"/></alternatives></inline-formula>
<inline-formula id="IEq57"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{G}_{{mn}}^{\tau },{G}_{{pn}}^{\tau },{Y}_{n}^{\tau }\right\}}_{n=1}^{m}\in \left({G}_{m}^{\tau },{G}_{p}^{\tau },{Y}^{\tau }\right)$$\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq57.gif"/></alternatives></inline-formula></p>
        <p id="Par62"> <inline-formula id="IEq58"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{{base}}\leftarrow \theta$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq58.gif"/></alternatives></inline-formula></p>
        <p id="Par63"> For i=1 to inner steps do:</p>
        <p id="Par64">  Calculate the inner step loss weight <inline-formula id="IEq59"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\omega }_{i}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq59.gif"/></alternatives></inline-formula></p>
        <p id="Par65">  <inline-formula id="IEq60"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}={BaseModel}\left({\left\{{G}_{{Pn}}^{\tau }\right\}}_{n=1}^{k},{\left\{{G}_{{Mn}}^{\tau }\right\}}_{n=1}^{k}{{{{{\rm{;}}}}}}{\theta }_{{base}}\right)$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq60.gif"/></alternatives></inline-formula></p>
        <p id="Par66">  <inline-formula id="IEq61"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\leftarrow {Eq}.\left(11\right){with}{\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>←</mml:mo><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfenced><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq61.gif"/></alternatives></inline-formula></p>
        <p id="Par67">  <inline-formula id="IEq62"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{{base}}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq62.gif"/></alternatives></inline-formula> optimize with <inline-formula id="IEq63"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{k}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq63.gif"/></alternatives></inline-formula></p>
        <p id="Par68">  <inline-formula id="IEq64"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{m}={BaseModel}\left({\left\{{G}_{{Pn}}^{\tau }\right\}}_{n=1}^{m},{\left\{{G}_{{Mn}}^{\tau }\right\}}_{n=1}^{m}{{{{{\rm{;}}}}}}{\theta }_{{base}}\right)$$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq64.gif"/></alternatives></inline-formula></p>
        <p id="Par69">  <inline-formula id="IEq65"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\leftarrow {Eq}.\left(11\right){with}{\left\{{y}_{in}^{\tau }\right\}}_{n=1}^{m}$$\end{document}</tex-math><mml:math id="M132"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup><mml:mo>←</mml:mo><mml:mi>E</mml:mi><mml:mi>q</mml:mi><mml:mo>.</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfenced><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq65.gif"/></alternatives></inline-formula></p>
        <p id="Par70"> End for</p>
        <p id="Par71">
          <inline-formula id="IEq66">
            <alternatives>
              <tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}^{\tau }={\left\{{\omega }_{i}\right\}}_{i=1}^{N}\cdot {\left\{{{{{{{\mathscr{L}}}}}}}_{i}^{\tau }\right\}}_{i=1}^{N}$$\end{document}</tex-math>
              <mml:math id="M134">
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ω</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>⋅</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="script">L</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq66.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par72">End for</p>
        <p id="Par73">
          <inline-formula id="IEq67">
            <alternatives>
              <tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\eta }_{i}\right\}}_{i=1}^{N}\leftarrow {Eq}.\left(14\right)$$\end{document}</tex-math>
              <mml:math id="M136">
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mfenced close="}" open="{">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>η</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>14</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq67.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par74">
          <inline-formula id="IEq68">
            <alternatives>
              <tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \leftarrow \theta -\alpha {\nabla }_{\theta }{\sum }_{{T}_{\tau }\sim p\left(\tau \right)}{\eta }_{i}\cdot {{{{{{\mathscr{L}}}}}}}^{\tau }$$\end{document}</tex-math>
              <mml:math id="M138">
                <mml:mi>θ</mml:mi>
                <mml:mo>←</mml:mo>
                <mml:mi>θ</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mi>α</mml:mi>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>∇</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>τ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>~</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mi>τ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>η</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>⋅</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq68.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par75">End while</p>
      </boxed-text>
    </sec>
    <sec id="Sec14">
      <boxed-text>
        <label>Box 2 BaseModel forward process</label>
        <p id="Par76">Require: <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{G}_{P},{G}_{M}\right\}:$$\end{document}</tex-math><mml:math id="M140"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>:</mml:mo></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq69.gif"/></alternatives></inline-formula> training data;</p>
        <p id="Par77">
          <inline-formula id="IEq70">
            <alternatives>
              <tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{P}={{GNN}}_{P}\left({G}_{P};{\theta }_{P}\right)$$\end{document}</tex-math>
              <mml:math id="M142">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                    <mml:mi>N</mml:mi>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq70.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par78">
          <inline-formula id="IEq71">
            <alternatives>
              <tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{M}={{GNN}}_{M}\left({G}_{M};{\theta }_{M}\right)$$\end{document}</tex-math>
              <mml:math id="M144">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                    <mml:mi>N</mml:mi>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq71.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par79">
          <inline-formula id="IEq72">
            <alternatives>
              <tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z\leftarrow {Eq}.\left(4\right){with}\left({G}_{P},{G}_{M}\right)$$\end{document}</tex-math>
              <mml:math id="M146">
                <mml:mi>Z</mml:mi>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>4</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq72.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par80">
          <inline-formula id="IEq73">
            <alternatives>
              <tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{G}_{P}}_{{sub}}\leftarrow {Eq}.\left(5\right){with}\left(Z,{G}_{P}\right)$$\end{document}</tex-math>
              <mml:math id="M148">
                <mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                    <mml:mi>u</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>5</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq73.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par81">For i=1 to num steps do</p>
        <p id="Par82">
          <inline-formula id="IEq74">
            <alternatives>
              <tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\leftarrow {Eq}.\left(8\right){with}\left({G}_{P},{{G}_{P}}_{{sub}};{\varphi }_{2}\right)$$\end{document}</tex-math>
              <mml:math id="M150">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>I</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>o</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>8</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>φ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq74.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par83">
          <inline-formula id="IEq75">
            <alternatives>
              <tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}\leftarrow {Eq}.\left(6\right){with\; Z}$$\end{document}</tex-math>
              <mml:math id="M152">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>S</mml:mi>
                    <mml:mi>E</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>6</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mspace width="0.16em"/>
                <mml:mi>Z</mml:mi>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq75.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par84">
          <inline-formula id="IEq76">
            <alternatives>
              <tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}\leftarrow {Eq}.\left(10\right){with}\left({G}_{m},{{G}_{P}}_{{sub}}{;Y}\right)$$\end{document}</tex-math>
              <mml:math id="M154">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mi>u</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq76.gif"/>
            </alternatives>
          </inline-formula>
        </p>
        <p id="Par85">
          <inline-formula id="IEq77">
            <alternatives>
              <tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{Base}}\leftarrow {Eq}.\left(11\right){with}\left({{{{{{\mathscr{L}}}}}}}_{{cls}},{{{{{{\mathscr{L}}}}}}}_{{MSE}},{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\right)$$\end{document}</tex-math>
              <mml:math id="M156">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>←</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mi>q</mml:mi>
                <mml:mo>.</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mn>11</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>w</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>S</mml:mi>
                        <mml:mi>E</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="script">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>I</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>o</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <inline-graphic xlink:href="41467_2023_43597_Article_IEq77.gif"/>
            </alternatives>
          </inline-formula>
        </p>
      </boxed-text>
    </sec>
    <sec id="Sec15">
      <title>Architecture of base model in ZeroBind</title>
      <p id="Par86">Figure <xref rid="Fig1" ref-type="fig">1e</xref> shows the architecture of the base model in ZeroBind, which mainly consists of three modules: a GNN module to obtain the embedding of molecules and proteins, a SIB module to find the most predictive subgraph as the binding pocket in the protein, and a dense module with concatenating protein subgraph representation and molecular representation to score the interactions.</p>
      <p id="Par87">Graph neural network-based representation learning for proteins and drugs. After constructing drug and protein graphs for a given protein-drug pair, we first embed the molecule atom features to vector space with randomly initialized parameters. We denote the node embedding of the molecule as <inline-formula id="IEq78"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{X}}}}}}}_{{{{{{\bf{m}}}}}}}{{{{{\boldsymbol{\in }}}}}}{{\mathbb{R}}}^{{N}_{m}*{D}_{m}}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">∈</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq78.gif"/></alternatives></inline-formula>, and also as the initial node embedding of GNN, denoted as <inline-formula id="IEq79"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{0}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq79.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq80"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{m}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq80.gif"/></alternatives></inline-formula> is the number of nodes and <inline-formula id="IEq81"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{m}$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq81.gif"/></alternatives></inline-formula> is the dimension of the node embeddings. Here, we denote the graph convolutional network (GCN) based molecule backbone as <inline-formula id="IEq82"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq82.gif"/></alternatives></inline-formula>, which is used to learn the graph embedding from the molecule graph. Then, the <inline-formula id="IEq83"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M168"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq83.gif"/></alternatives></inline-formula>-th layer output of <inline-formula id="IEq84"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq84.gif"/></alternatives></inline-formula> can be formulated as:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{m}^{\left(l\right)}={RELU}\left({\hat{A}}_{m}{G}_{m}^{\left(l-1\right)}{W}_{m}^{\left(l-1\right)}+{b}^{\left(l-1\right)}\right)$$\end{document}</tex-math><mml:math id="M172"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq85"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{{{{{\bf{A}}}}}}}}_{{{{{{\bf{m}}}}}}}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq85.gif"/></alternatives></inline-formula> represents the adjacent matrix of a graph, <inline-formula id="IEq86"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{l}}}}}}{{{{{\boldsymbol{-}}}}}}{{{{{\bf{1}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold-italic">-</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq86.gif"/></alternatives></inline-formula> denotes the node embedding of <inline-formula id="IEq87"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(l-1\right)$$\end{document}</tex-math><mml:math id="M178"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq87.gif"/></alternatives></inline-formula>-th layer and <inline-formula id="IEq88"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{m}}}}}}}^{\left({{{{{\bf{l}}}}}}{{{{{\boldsymbol{-}}}}}}{{{{{\bf{1}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M180"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold-italic">-</mml:mi><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq88.gif"/></alternatives></inline-formula> is the learnable weight matrix.</p>
      <p id="Par88">For protein graphs, we initialize the node embedding <inline-formula id="IEq89"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{p}}}}}}}^{\left({{{{{\bf{0}}}}}}\right)}$$\end{document}</tex-math><mml:math id="M182"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq89.gif"/></alternatives></inline-formula> of a protein graph with ESM-2, a pre-trained general-purpose protein embedding. Similarly to the molecule graph, a GCN-based backbone <inline-formula id="IEq90"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{p}}}}}}}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq90.gif"/></alternatives></inline-formula> is used to learn the graph embedding from the protein graphs. Then, the <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M186"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq91.gif"/></alternatives></inline-formula>-th layer output of <inline-formula id="IEq92"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{p}}}}}}}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq92.gif"/></alternatives></inline-formula> can be formulated as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{p}^{\left(l\right)}={RELU}\left({\hat{A}}_{p}{G}_{p}^{\left(l-1\right)}{W}_{p}^{\left(l-1\right)}+{b}^{\left(l-1\right)}\right)$$\end{document}</tex-math><mml:math id="M190"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par89">Subgraph learning in ZeroBind for potential binding pockets in proteins. Considering that a molecule binds to a binding pocket in the protein instead of the whole protein, after the protein backbone GCN, we apply a model-agnostic SIB module<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> to identify the most interpretable subgraph with the most crucial information associated with the DTI task, where the learned subgraph corresponds to the binding pocket on the protein graph. The SIB module is proposed to recognize a compressed subgraph named IB-subgraph under the information bottleneck (IB) principle. The IB-subgraph could also eliminate the noisy and redundant graph information. In our DTI task, the DTI score is largely determined by the protein pocket features, which are the subgraph information bottleneck of the protein graph or the potential drug binding sites in the protein.</p>
      <p id="Par90">The SIB module contains a subgraph generator for node assignment and a dense layer to guarantee that the generated subgraph matches the IB-subgraph. The subgraph generator is a Multi-layer Perceptron (MLP), which takes the protein node embedding and the molecule embedding as the input and outputs the node assignment matrix <inline-formula id="IEq93"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M192"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq93.gif"/></alternatives></inline-formula>, which is formulated as follows:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z={Softmax}\left({MLP}\left({concatenate}\left({G}_{p}^{\left(l\right)},{G}_{m}^{\left(l\right)}\right){{{{{\rm{;}}}}}}{\varphi }_{1}\right)\right)$$\end{document}</tex-math><mml:math id="M194"><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${G}_{{sub}}={Z}^{T}{G}_{p}^{\left(l\right)}\left[0\right]$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where the output of the MLP is a <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times 2$$\end{document}</tex-math><mml:math id="M198"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq94.gif"/></alternatives></inline-formula> matrix with the number of nodes n. After applying <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Softmax}$$\end{document}</tex-math><mml:math id="M200"><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq95.gif"/></alternatives></inline-formula> on the output of MLP layer, each row of <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M202"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq96.gif"/></alternatives></inline-formula> is the probability of the corresponding node belonging to the <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{{{{{{\bf{G}}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq98.gif"/></alternatives></inline-formula>, denoted as <inline-formula id="IEq99"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right),p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)\right]$$\end{document}</tex-math><mml:math id="M208"><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq99.gif"/></alternatives></inline-formula>,where <inline-formula id="IEq100"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq100.gif"/></alternatives></inline-formula> represents the generated subgraph of protein graph <inline-formula id="IEq101"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{{{{{{\bf{G}}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq102.gif"/></alternatives></inline-formula> represents the leftover subgraph of protein graph. After training with a sufficient number of training samples, the learned node assignment matrix <inline-formula id="IEq103"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M216"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq103.gif"/></alternatives></inline-formula> is supposed to approach to 0 or 1. Thus, the generated IB-subgraph embedding can be obtained by taking the first row of the product between <inline-formula id="IEq104"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{Z}}}}}}}^{{{{{{\bf{T}}}}}}}$$\end{document}</tex-math><mml:math id="M218"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq104.gif"/></alternatives></inline-formula> and node embedding.</p>
      <p id="Par91">To stabilize the training process of the subgraph generation and separate <inline-formula id="IEq105"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right)$$\end{document}</tex-math><mml:math id="M220"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq105.gif"/></alternatives></inline-formula> from <inline-formula id="IEq106"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)$$\end{document}</tex-math><mml:math id="M222"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq106.gif"/></alternatives></inline-formula>, we apply a connectivity loss as follows:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}={MSE}\left({diag}\left({Norm}\left({Z}^{T}{AZ}\right)\right)-{diag}\left({I}_{2}\right)\right)$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq107"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Norm}\left(\cdot \right)$$\end{document}</tex-math><mml:math id="M226"><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>⋅</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq107.gif"/></alternatives></inline-formula> is the row normalization, <inline-formula id="IEq108"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{A}}}}}}$$\end{document}</tex-math><mml:math id="M228"><mml:mi mathvariant="bold">A</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq108.gif"/></alternatives></inline-formula> is the adjacency matrix of protein graph <inline-formula id="IEq109"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{I}}}}}}}_{{{{{{\bf{2}}}}}}}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">2</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq110.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq111"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2{\times} 2$$\end{document}</tex-math><mml:math id="M234"><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq111.gif"/></alternatives></inline-formula> identity matrix. Minimizing <inline-formula id="IEq112"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq112.gif"/></alternatives></inline-formula> could encourages <inline-formula id="IEq113"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[p\left({h}_{i}\in {G}_{{sub}}|{h}_{i}\right),p\left({h}_{i}\in {\bar{G}}_{{sub}}|{h}_{i}\right)\right]\to \left[{{{{\mathrm{0,1}}}}}\right]/\left[{{{{\mathrm{1,0}}}}}\right]$$\end{document}</tex-math><mml:math id="M238"><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Ḡ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>→</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">0, 1</mml:mi></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">1, 0</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq113.gif"/></alternatives></inline-formula>, which results in a distinctive <inline-formula id="IEq114"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Z}}}}}}$$\end{document}</tex-math><mml:math id="M240"><mml:mi mathvariant="bold">Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq114.gif"/></alternatives></inline-formula> to stabilize the training process and a compact topology in the subgraph.</p>
      <p id="Par92">Formally, the subgraph information bottleneck seeks the IB-subgraph by optimizing the following objective function:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\max }\limits_{{G}_{{sub}}}I\left(Y,{G}_{{sub}}\right)-\beta I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M242"><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq115"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M244"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq115.gif"/></alternatives></inline-formula> is a weight, <inline-formula id="IEq116"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y$$\end{document}</tex-math><mml:math id="M246"><mml:mi>Y</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq116.gif"/></alternatives></inline-formula> represents the label associated with <inline-formula id="IEq117"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M248"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq117.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq118"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M250"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq118.gif"/></alternatives></inline-formula> represents the original graph. <inline-formula id="IEq119"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M252"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq119.gif"/></alternatives></inline-formula> and <inline-formula id="IEq120"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M254"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq120.gif"/></alternatives></inline-formula> respectively represents the mutual information between <inline-formula id="IEq121"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M256"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq121.gif"/></alternatives></inline-formula> and <inline-formula id="IEq122"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M258"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq122.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq123"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq123.gif"/></alternatives></inline-formula> represents the IB-subgraph embedding.</p>
      <p id="Par93">To optimize the objective function, the lower bound of the first term is formulated as the opposite number of classification loss between the ground truth label and predicted label with subgraph embedding. By minimizing the classification loss, the lower bound of <inline-formula id="IEq124"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M262"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq124.gif"/></alternatives></inline-formula> achieves the maximum value. For the second term, the DONSKER-VARADHAN representation<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> of the KL-divergence is applied to approximate the upper bound of <inline-formula id="IEq125"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M264"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq125.gif"/></alternatives></inline-formula>. The approximation of <inline-formula id="IEq126"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M266"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq126.gif"/></alternatives></inline-formula> can be formulate as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\max }\limits_{{\varphi }_{2}}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}\left({\varphi }_{2},{G}_{{sub}}\right)=	 \frac{1}{N}\mathop{\sum }\limits_{i=1}^{N}{Dense}\left({G}_{i},{G}_{{{sub}}_{i}}{{{{{\rm{;}}}}}}{\varphi }_{2}\right)\\ 	 -\log \frac{1}{N}\mathop{\sum }\limits_{i=1,j\ne i}^{N}{e}^{{Dense}\left({G}_{i},{G}_{{{sub}}_{j}}{{{{{\rm{;}}}}}}{\varphi }_{2}\right)}$$\end{document}</tex-math><mml:math id="M268"><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq127"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Dense}\left(\bullet \right)$$\end{document}</tex-math><mml:math id="M270"><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>∙</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq127.gif"/></alternatives></inline-formula> is the dense network of several MLP layers with the concatenation of the embedding of <inline-formula id="IEq128"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{G}}}}}}$$\end{document}</tex-math><mml:math id="M272"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq128.gif"/></alternatives></inline-formula> and <inline-formula id="IEq129"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{G}}}}}}}_{{{{{{\bf{sub}}}}}}}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq129.gif"/></alternatives></inline-formula> as the input.</p>
      <p id="Par94">To minimize <inline-formula id="IEq130"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M276"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq130.gif"/></alternatives></inline-formula>, several inner steps of the maximum optimization of <inline-formula id="IEq131"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq131.gif"/></alternatives></inline-formula> are applied to minimize the upper bound of <inline-formula id="IEq132"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M280"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq132.gif"/></alternatives></inline-formula>.</p>
      <p id="Par95">After obtaining the embedding of the generated protein IB-subgraph, we concatenate the molecular embedding and protein IB-subgraph embedding as the input to the MLP classification layer. The DTI classification loss could be formulated as:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y}={MLP}\left({concatenate}\left({G}_{m},{G}_{{sub}}\right){{{{{\rm{;}}}}}}{\theta }_{{cls}}\right)$$\end{document}</tex-math><mml:math id="M282"><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">;</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}=-y\log \hat{y}-\left(1-y\right)\log \left(1-\hat{y}\right)$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mi>log</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mi>log</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par96">The overall loss can be formulated as:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\min }\limits_{{\theta }_{M},{\theta }_{P},{\varphi }_{1},{\varphi }_{2},{\theta }_{{cls}}}{{{{{{\mathscr{L}}}}}}}_{{base}}={{{{{{\mathscr{L}}}}}}}_{{cls}}+{\lambda }_{1}{{{{{{\mathscr{L}}}}}}}_{{MSE}}+{\lambda }_{2}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M286"><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equa"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s.t.{\varphi }_{2}^{*}={\arg }\mathop{\max }\limits_{{\varphi }_{2}}{{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:msubsup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq133"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{1}$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{2}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq134.gif"/></alternatives></inline-formula> are weights to balance the importance of different losses, <inline-formula id="IEq135"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{M}}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">,</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq135.gif"/></alternatives></inline-formula> are the parameters of <inline-formula id="IEq136"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{GCN}}}}}}}_{{{{{{\rm{m}}}}}}}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq136.gif"/></alternatives></inline-formula> and <inline-formula id="IEq137"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{GCN}}}}}}}_{{{{{{\rm{p}}}}}}}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq137.gif"/></alternatives></inline-formula>, <inline-formula id="IEq138"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\varphi }}}}}}}_{{{{{{\bf{1}}}}}}}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">1</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq138.gif"/></alternatives></inline-formula> is the parameters of IB-subgraph generator, <inline-formula id="IEq139"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\varphi }}}}}}}_{{{{{{\bf{2}}}}}}}$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">2</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq139.gif"/></alternatives></inline-formula> is the parameters of the dense network, and <inline-formula id="IEq140"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\theta }}}}}}}_{{{{{{\bf{cls}}}}}}}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq140.gif"/></alternatives></inline-formula> is the parameters of the MLP layer.</p>
      <p id="Par97">Here, we summarize the training process, the <inline-formula id="IEq141"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq141.gif"/></alternatives></inline-formula> measures the discrepancy between the estimated distribution and the original data distribution by utilizing the cross-entropy between the predicted values and the ground truth (the DTI labels instead of binding pocket labels). The <inline-formula id="IEq142"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MSE}}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq142.gif"/></alternatives></inline-formula>, as indicated by Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>), encourages the node assignment matrix <inline-formula id="IEq143"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M310"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq143.gif"/></alternatives></inline-formula> to approach close to either 1 or 0. The <inline-formula id="IEq144"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq144.gif"/></alternatives></inline-formula>, as indicated by Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>), represents an approximation of <inline-formula id="IEq145"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M314"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq145.gif"/></alternatives></inline-formula> introduced in Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>). To maximize Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) and achieve subgraph information bottleneck, the lower bound of <inline-formula id="IEq146"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M316"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq146.gif"/></alternatives></inline-formula> needs to increase as much as possible and the upper bound of <inline-formula id="IEq147"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M318"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq147.gif"/></alternatives></inline-formula> needs to decrease. Therefore, we begin by performing gradient descent on the negative of <inline-formula id="IEq148"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq148.gif"/></alternatives></inline-formula> within the dense network. The goal is to maximize <inline-formula id="IEq149"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq149.gif"/></alternatives></inline-formula> and achieve the upper bound of <inline-formula id="IEq150"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M324"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq150.gif"/></alternatives></inline-formula>, thus satisfying the constraints of Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>). After that, we utilize gradient descent to optimize Eq. (<xref rid="Equ11" ref-type="disp-formula">11</xref>). By optimizing <inline-formula id="IEq151"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{cls}}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq151.gif"/></alternatives></inline-formula>, we increase the lower bound of <inline-formula id="IEq152"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(Y,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M328"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq152.gif"/></alternatives></inline-formula>, and decrease the upper bound of <inline-formula id="IEq153"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left(G,{G}_{{sub}}\right)$$\end{document}</tex-math><mml:math id="M330"><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq153.gif"/></alternatives></inline-formula> by optimizing <inline-formula id="IEq154"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq154.gif"/></alternatives></inline-formula>. This approach aims to maximize Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>) and seek the subgraph information bottleneck for detecting potential binding pockets in proteins.</p>
      <p id="Par98">In our task, we aim to find the protein binding pocket under the weakly supervised training process, since the amount of protein binding pockets data is much smaller than the amount of binding data. So we design the IB-subgraph to find the protein binding pockets optimized on the DTI binding labels instead of binding pocket labels in proteins. Considering the protein pockets are determined by both proteins and molecules, we take the concatenation of molecule embedding and protein embedding as input when we generate the node assignment matrix <inline-formula id="IEq155"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M334"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq155.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>).</p>
    </sec>
    <sec id="Sec16">
      <title>Task adaptive self-attention</title>
      <p id="Par99">In a traditional meta-learning schedule, <inline-formula id="IEq156"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${batch\_size}$$\end{document}</tex-math><mml:math id="M336"><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mo>_</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq156.gif"/></alternatives></inline-formula> tasks are sampled and treated with the same weight when applying mini-batch gradient descent. However, the same weight of multiple tasks can’t reflect the importance of different tasks contributing to the meta-model optimization. We further design a task adaptive self-attention module (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>) to learn the importance of different tasks automatically. Since each task is a DTI prediction of a specific protein, we take the concatenation of protein subgraph embedding and the average of the embeddings of all molecules in the query set as the task embedding. The self-attention module is:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${h}_{{T}_{b}}={concatenate}\left({G}_{p},{Mean}\left({\left\{{G}_{m}^{i}\right\}}_{i=1}^{m}\right)\right)$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}Q={W}_{Q}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\\ K={W}_{K}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\\ V={W}_{V}{\left\{{h}_{{T}_{b}}\right\}}_{b=1}^{B}\end{array}$$\end{document}</tex-math><mml:math id="M340"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\eta }_{{T}_{b}}\right\}}_{b=1}^{B}={Attention}\left(Q,K,V\right)={softmax}\left(\frac{Q{K}^{T}}{\sqrt{{d}_{k}}}\right)V$$\end{document}</tex-math><mml:math id="M342"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>V</mml:mi></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>16</label><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{all}}=\mathop{\sum }\limits_{b=1}^{B}{\eta }_{{T}_{b}}{{{{{{\mathscr{L}}}}}}}_{{query},b}$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_43597_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq157"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{b}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq157.gif"/></alternatives></inline-formula> is one of the DTI tasks, <inline-formula id="IEq158"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{h}}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{b}}}}}}}}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq158.gif"/></alternatives></inline-formula> represents the task embedding, <inline-formula id="IEq159"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{Q}}}}}}}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq159.gif"/></alternatives></inline-formula>, <inline-formula id="IEq160"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{K}}}}}}}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq160.gif"/></alternatives></inline-formula> and <inline-formula id="IEq161"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{W}}}}}}}_{{{{{{\bf{V}}}}}}}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq161.gif"/></alternatives></inline-formula> are learnable parameter matrices, <inline-formula id="IEq162"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Q}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{K}}}}}}{{{{{\boldsymbol{,}}}}}}{{{{{\bf{V}}}}}}$$\end{document}</tex-math><mml:math id="M356"><mml:mi mathvariant="bold">Q</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">K</mml:mi><mml:mi mathvariant="bold-italic">,</mml:mi><mml:mi mathvariant="bold">V</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq162.gif"/></alternatives></inline-formula> are the generated attention matrices, <inline-formula id="IEq163"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{k}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq163.gif"/></alternatives></inline-formula> is the dimension of task embedding to normalize the variance of <inline-formula id="IEq164"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{Q}}}}}}{{{{{{\bf{K}}}}}}}^{{{{{{\bf{T}}}}}}}$$\end{document}</tex-math><mml:math id="M360"><mml:mi mathvariant="bold">Q</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq164.gif"/></alternatives></inline-formula> and stabilize gradient values during training, and <inline-formula id="IEq165"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\eta }}}}}}}_{{{{{{{\bf{T}}}}}}}_{{{{{{\bf{b}}}}}}}}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq165.gif"/></alternatives></inline-formula> is the generated weight to balance the importance of different task.</p>
      <p id="Par100">MetaDTA<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> uses multi-head cross-attention network to capture the relationships between the support and the query ligands instead of different proteins, where it does not use any protein information. In contrast, ZeroBind utilizes a task adaptive self-attention module to learn the importance for different tasks of proteins, and it focuses on the shared binding patterns among different proteins.</p>
    </sec>
    <sec id="Sec17">
      <title>Experimental settings</title>
      <p id="Par101">We take graph convolutional networks as base graph neural network. In our experiment, the GCN layer number of <inline-formula id="IEq166"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{P}}}}}}}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq166.gif"/></alternatives></inline-formula> is set as 4 and we set the embedding dimensions as 1280,512,256,256,256, and the GCN layer number of <inline-formula id="IEq167"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{GCN}}}}}}}_{{{{{{\bf{M}}}}}}}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mrow><mml:mi mathvariant="bold">GCN</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq167.gif"/></alternatives></inline-formula> is set as 3, the embedding dimensions we set are 256,256,256. We set the update step in inner loops as 5. 20 inner steps of the maximum optimization of <inline-formula id="IEq168"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq168.gif"/></alternatives></inline-formula> are applied. We set the <inline-formula id="IEq169"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{1}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq169.gif"/></alternatives></inline-formula> and <inline-formula id="IEq170"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{2}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq170.gif"/></alternatives></inline-formula> as 0.05. The learning rate of optimization of <inline-formula id="IEq171"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathscr{L}}}}}}}_{{MI}-{pro}}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_43597_Article_IEq171.gif"/></alternatives></inline-formula> is set at 0.01. The meta learning rate is using simulated annealing algorithm. We use Pytorch to implement the model and run it on a GPU.</p>
    </sec>
    <sec id="Sec18">
      <title>Baseline methods</title>
      <p id="Par102">We compare ZeroBind with multiple baselines to evaluate its advantages, and calculate the area under the receiver operating characteristic (AUROC) and the area under the precision-recall curve (AUPRC) on three independent test sets and one few-shot test set.<list list-type="order"><list-item><p id="Par103">DeepConv-DTI<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>: DeepConv-DTI trains a CNN to learn the embedding of the neighboring residues and an MLP to learn the molecular fingerprint, which is concatenated to make DTI prediction.</p></list-item><list-item><p id="Par104">GraphDTA<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>: GraphDTA leverages multiple types of GNN models to embed molecular embeddings and a CNN model to embed protein residue features.</p></list-item><list-item><p id="Par105">Deeppurpose<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>: Deeppurpose is a state-of-art deep learning library for DTI prediction with multiple backbone networks. Here we use CNN as the backbone network for learning embeddings of both drugs and proteins.</p></list-item><list-item><p id="Par106">AI-bind<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>: AI-bind uses pre-trained mol2vec and protvec models to initialize the molecule embedding and protein embedding, and makes the DTI predictions by concatenating the molecule embedding and protein embedding.</p></list-item><list-item><p id="Par107">DrugBAN<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>: DrugBAN uses a deep bilinear attention network (BAN) framework with domain adaptation to explicitly learn local pairwise interactions between drugs and targets.</p></list-item></list></p>
    </sec>
    <sec id="Sec19">
      <title>Reporting summary</title>
      <p id="Par108">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_43597_MOESM1_ESM.pdf">
            <caption>
              <p>SupplementaryInformation</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_43597_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_43597_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec21">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_43597_MOESM4_ESM.xlsx">
            <caption>
              <p>Source data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-43597-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the National Key Research and Development Program of China (No. 2020AAA0107600 to X.P.), the National Natural Science Foundation of China (No. 61725302 and 62073219 to H.B.S., 61903248 to X.P.), and the Science and Technology Commission of Shanghai Municipality (20S11902100 to X.P., 22511104100 to H.B.S.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Y.W. contributed to writing the manuscript, data curation, and preparation, implemented the prediction model and performing the experiments, running docking simulation, and writing the manuscript. Y.X. contributed to data preparation and writing the manuscript. J.Y., Y.Y., and H.B.S. provided the guidance on designing the model and experiments and writing the manuscript. X.P. conceived the project, designed the experiments, contributed to data analysis and writing the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par109"><italic>Nature Communications</italic> thanks Thin Nguyen, and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The online webserver is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/">http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/</ext-link>. The benchmark dataset is collected from the original database BindingDB (<ext-link ext-link-type="uri" xlink:href="https://www.bindingdb.org/bind/downloads/BindingDB_All_2D_202311_sdf.zip">https://www.bindingdb.org/bind/downloads/BindingDB_All_2D_202311_sdf.zip</ext-link>) and it is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/datasets.html">http://www.csbio.sjtu.edu.cn/bioinf/ZeroBind/datasets.html</ext-link> along with the SARS-COV-2 test dataset, and the experimental protein structure data used in this study are downloaded from the RCSB PDB database (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/downloads/">https://www.rcsb.org/downloads/</ext-link>) and the predicted structures by AlphaFold are downloaded from AlphaFold Protein Structure Database (<ext-link ext-link-type="uri" xlink:href="https://www.alphafold.ebi.ac.uk/">https://www.alphafold.ebi.ac.uk/</ext-link>). All PDB and AlphaFold codes can be found on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/myprecioushh/ZeroBind">https://github.com/myprecioushh/ZeroBind</ext-link>). <xref ref-type="sec" rid="Sec21">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source codes of ZeroBind are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/myprecioushh/ZeroBind">https://github.com/myprecioushh/ZeroBind</ext-link>), together with a usage documentation and setup environment.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par110">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peska</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Buza</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Drug-target interaction prediction: a Bayesian ranking approach</article-title>
        <source>Comput. Methods Prog. Biomed.</source>
        <year>2017</year>
        <volume>152</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmpb.2017.09.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagherian</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Machine learning approaches and databases for prediction of drug–target interaction: a survey paper</article-title>
        <source>Brief. Bioinforma.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>247</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbasi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Razzaghi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Poso</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ghanbari-Ara</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Masoudi-Nejad</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Deep learning in drug target interaction prediction: current and future perspectives</article-title>
        <source>Curr. Med. Chem.</source>
        <year>2021</year>
        <volume>28</volume>
        <fpage>2100</fpage>
        <lpage>2113</lpage>
        <pub-id pub-id-type="doi">10.2174/0929867327666200907141016</pub-id>
        <?supplied-pmid 32895036?>
        <pub-id pub-id-type="pmid">32895036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Deng, J., Yang, Z., Ojima, I., Samaras, D. &amp; Wang, F. Artificial intelligence in drug discovery: applications and techniques. <italic>Briefings Bioinformatics</italic><bold>23</bold>, bbab430 (2022).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thafar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Raies</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Albaradei</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Essack</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bajic</surname>
            <given-names>VB</given-names>
          </name>
        </person-group>
        <article-title>Comparison study of computational prediction tools for drug-target binding affinities</article-title>
        <source>Front. Chem.</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>782</fpage>
        <pub-id pub-id-type="doi">10.3389/fchem.2019.00782</pub-id>
        <?supplied-pmid 31824921?>
        <pub-id pub-id-type="pmid">31824921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure-based maximal affinity model predicts small-molecule druggability</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2007</year>
        <volume>25</volume>
        <fpage>71</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1273</pub-id>
        <?supplied-pmid 17211405?>
        <pub-id pub-id-type="pmid">17211405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alonso</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bliznyuk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Gready</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Combining docking and molecular dynamic simulations in drug design</article-title>
        <source>Med. Res. Rev.</source>
        <year>2006</year>
        <volume>26</volume>
        <fpage>531</fpage>
        <lpage>568</lpage>
        <pub-id pub-id-type="doi">10.1002/med.20067</pub-id>
        <?supplied-pmid 16758486?>
        <pub-id pub-id-type="pmid">16758486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepPurpose: a deep learning library for drug–target interaction prediction</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>5545</fpage>
        <lpage>5547</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa1005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving the generalizability of protein-ligand binding predictions with AI-Bind</article-title>
        <source>Nat. Commun.</source>
        <year>2023</year>
        <volume>14</volume>
        <fpage>1989</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-023-37572-z</pub-id>
        <?supplied-pmid 37031187?>
        <pub-id pub-id-type="pmid">37031187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GraphDTA: predicting drug–target binding affinity with graph neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>1140</fpage>
        <lpage>1147</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa921</pub-id>
        <?supplied-pmid 33119053?>
        <pub-id pub-id-type="pmid">33119053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Keum</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>DeepConv-DTI: Prediction of drug-target interactions via deep learning with convolution on protein sequences</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1007129</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007129</pub-id>
        <?supplied-pmid 31199797?>
        <pub-id pub-id-type="pmid">31199797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilson</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BindingDB in 2015: a public database for medicinal chemistry, computational chemistry and systems pharmacology</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D1045</fpage>
        <lpage>D1053</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1072</pub-id>
        <?supplied-pmid 26481362?>
        <pub-id pub-id-type="pmid">26481362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChEMBL web services: streamlining access to drug discovery data and utilities</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>W612</fpage>
        <lpage>W620</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv352</pub-id>
        <?supplied-pmid 25883136?>
        <pub-id pub-id-type="pmid">25883136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The PDBbind database: Collection of binding affinities for protein− ligand complexes with known three-dimensional structures</article-title>
        <source>J. Med. Chem.</source>
        <year>2004</year>
        <volume>47</volume>
        <fpage>2977</fpage>
        <lpage>2980</lpage>
        <pub-id pub-id-type="doi">10.1021/jm030580l</pub-id>
        <?supplied-pmid 15163179?>
        <pub-id pub-id-type="pmid">15163179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The PDBbind database: methodologies and updates</article-title>
        <source>J. Med. Chem.</source>
        <year>2005</year>
        <volume>48</volume>
        <fpage>4111</fpage>
        <lpage>4119</lpage>
        <pub-id pub-id-type="doi">10.1021/jm048957q</pub-id>
        <?supplied-pmid 15943484?>
        <pub-id pub-id-type="pmid">15943484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DrugBank 5.0: a major update to the DrugBank database for 2018</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D1074</fpage>
        <lpage>D1082</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1037</pub-id>
        <?supplied-pmid 29126136?>
        <pub-id pub-id-type="pmid">29126136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sachdev</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive review of feature based methods for drug target interaction prediction</article-title>
        <source>J. Biomed. Inform.</source>
        <year>2019</year>
        <volume>93</volume>
        <fpage>103159</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2019.103159</pub-id>
        <?supplied-pmid 30926470?>
        <pub-id pub-id-type="pmid">30926470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Network-based methods for prediction of drug-target interactions</article-title>
        <source>Front. Pharmacol.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1134</fpage>
        <pub-id pub-id-type="doi">10.3389/fphar.2018.01134</pub-id>
        <?supplied-pmid 30356768?>
        <pub-id pub-id-type="pmid">30356768</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Wang, H., Zhou, G., Liu, S., Jiang, J.-Y. &amp; Wang, W. Drug-target interaction prediction with graph attention networks. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2107.06099">https://arxiv.org/abs/2107.06099</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Öztürk</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ozkirimli</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Özgür</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A comparative study of SMILES-based compound similarity functions for drug-target interaction prediction</article-title>
        <source>BMC Bioinforma.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0977-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perlman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gottlieb</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Atias</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ruppin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sharan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Combining drug and gene similarity measures for drug-target elucidation</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0213</pub-id>
        <?supplied-pmid 21314453?>
        <pub-id pub-id-type="pmid">21314453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mei</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Kwoh</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X-L</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Drug–target interaction prediction by learning from local information and neighbors</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>238</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts670</pub-id>
        <?supplied-pmid 23162055?>
        <pub-id pub-id-type="pmid">23162055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thafar</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DTiGEMS+: drug–target interaction prediction using graph embedding, graph mining, and similarity-based techniques</article-title>
        <source>J. Cheminformatics</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00447-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of drug-target interactions and drug repositioning via network-based inference</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002503</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002503</pub-id>
        <?supplied-pmid 22589709?>
        <pub-id pub-id-type="pmid">22589709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A network integration approach for drug-target interaction prediction and computational drug repositioning from heterogeneous information</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00680-8</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>A semi-supervised method for drug-target interaction prediction with consistency in networks</article-title>
        <source>PlOS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e62975</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0062975</pub-id>
        <?supplied-pmid 23667553?>
        <pub-id pub-id-type="pmid">23667553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SMILES, a chemical language and information system. 1. Introduction to methodology and encoding rules</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>1988</year>
        <volume>28</volume>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00057a005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Backpropagation applied to handwritten zip code recognition</article-title>
        <source>Neural Comput.</source>
        <year>1989</year>
        <volume>1</volume>
        <fpage>541</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="doi">10.1162/neco.1989.1.4.541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elman</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Finding structure in time</article-title>
        <source>Cogn. Sci.</source>
        <year>1990</year>
        <volume>14</volume>
        <fpage>179</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1207/s15516709cog1402_1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Vaswani, A. et al. Attention is all you need. <italic>Adv. Neural Inf. Process. Syst.</italic><bold>30</bold>, 6000–6010 (2017).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiménez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Skalic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martinez-Rosell</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>De Fabritiis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>K deep: protein–ligand absolute binding affinity prediction via 3d-convolutional neural networks</article-title>
        <source>J. Chem. Inf. Modeling</source>
        <year>2018</year>
        <volume>58</volume>
        <fpage>287</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scarselli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gori</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsoi</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Hagenbuchner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Monfardini</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The graph neural network model</article-title>
        <source>IEEE Trans. Neural Netw.</source>
        <year>2008</year>
        <volume>20</volume>
        <fpage>61</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1109/TNN.2008.2005605</pub-id>
        <?supplied-pmid 19068426?>
        <pub-id pub-id-type="pmid">19068426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamilton</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leskovec</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Inductive representation learning on large graphs</article-title>
        <source>31th Conf. Neural Inf. Process. Syst.</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>1025</fpage>
        <lpage>1035</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>GEFA: early fusion approach in drug-target affinity prediction</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>718</fpage>
        <lpage>728</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2021.3094217</pub-id>
        <?supplied-pmid 34197324?>
        <pub-id pub-id-type="pmid">34197324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geirhos</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shortcut learning in deep neural networks</article-title>
        <source>Nat. Mach. Intell.</source>
        <year>2020</year>
        <volume>2</volume>
        <fpage>665</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="doi">10.1038/s42256-020-00257-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Lee, E., Yoo, J., Lee, H. &amp; Hong, S. MetaDTA: meta-learning-based drug-target binding affinity prediction. <italic>ICLR2022 Machine Learning for Drug Discovery</italic> (2022).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Antoniou, A., Edwards, H. &amp; Storkey, A. How to train your MAML. Proc. ICLR 2019 (2019).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>AH</given-names>
          </name>
        </person-group>
        <article-title>The Finley affair: a signal event in the history of forecast verification</article-title>
        <source>Weather Forecast.</source>
        <year>1996</year>
        <volume>11</volume>
        <fpage>3</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1175/1520-0434(1996)011&lt;0003:TFAASE&gt;2.0.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>BioLiP: a semi-manually curated database for biologically relevant ligand–protein interactions</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>41</volume>
        <fpage>D1096</fpage>
        <lpage>D1103</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks966</pub-id>
        <?supplied-pmid 23087378?>
        <pub-id pub-id-type="pmid">23087378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PubChem 2019 update: improved access to chemical data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D1102</fpage>
        <lpage>D1109</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
        <?supplied-pmid 30371825?>
        <pub-id pub-id-type="pmid">30371825</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trott</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
        <source>J. Comput. Chem.</source>
        <year>2010</year>
        <volume>31</volume>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
        <?supplied-pmid 19499576?>
        <pub-id pub-id-type="pmid">19499576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurung</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bhattacharjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Exploring the physicochemical profile and the binding patterns of selected novel anticancer Himalayan plant derived active compounds with macromolecular targets</article-title>
        <source>Inform. Med. Unlocked</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.imu.2016.09.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ganea</surname>
            <given-names>OE</given-names>
          </name>
          <name>
            <surname>Pattanaik</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barzilay</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>EquiBind: geometric deep learning for drug binding structure prediction</article-title>
        <source>Int. Conf. Mach. Learn.</source>
        <year>2022</year>
        <volume>2022</volume>
        <fpage>20503</fpage>
        <lpage>20521</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Landrum, G. RDKit: A software suite for cheminformatics, computational chemistry, and predictive modeling. <italic>Greg Landrum</italic> (2013).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sussman</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein Data Bank (PDB): database of three-dimensional structural information of biological macromolecules</article-title>
        <source>Acta Crystallogr. Sect. D: Biol. Crystallogr.</source>
        <year>1998</year>
        <volume>54</volume>
        <fpage>1078</fpage>
        <lpage>1084</lpage>
        <pub-id pub-id-type="doi">10.1107/S0907444998009378</pub-id>
        <pub-id pub-id-type="pmid">10089483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Hu, W. et al. OGB-LSC A large-scale challenge for machine learning on graphs. <italic>35th Conference on Neural Information Processing Systems (NeurIPS 2021)</italic> Track on Datasets and Benchmarks (2021).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Deep graph learning of inter-protein contacts</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>947</fpage>
        <lpage>953</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab761</pub-id>
        <?supplied-pmid 34755837?>
        <pub-id pub-id-type="pmid">34755837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>
        <source>Science</source>
        <year>2023</year>
        <volume>379</volume>
        <fpage>1123</fpage>
        <lpage>1130</lpage>
        <pub-id pub-id-type="doi">10.1126/science.ade2574</pub-id>
        <?supplied-pmid 36927031?>
        <pub-id pub-id-type="pmid">36927031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hospedales</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Antoniou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Micaelli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Storkey</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Meta-learning in neural networks: a survey</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2021</year>
        <volume>44</volume>
        <fpage>5149</fpage>
        <lpage>5169</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Finn, C., Abbeel, P. &amp; Levine, S. Model-agnostic meta-learning for fast adaptation of deep networks. <italic>Pr. Mach. Learn. Res.</italic><bold>70</bold>, 1126–1135 (2017).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Snell, J., Swersky, K. &amp; Zemel, R. Prototypical networks for few-shot learning. <italic>Adv. Neural Inf. Process. Syst.</italic><bold>30</bold> (2017).</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Yu, J. et al. Recognizing predictive substructures with subgraph information bottleneck. <italic>IEEE Trans. Pattern Anal. Mach. Intell.</italic>10.1109/TPAMI.2021.3112205 (2021).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donsker</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Varadhan</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic evaluation of certain Markov process expectations for large time, I</article-title>
        <source>Commun. Pure Appl. Math.</source>
        <year>1975</year>
        <volume>28</volume>
        <fpage>1</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1002/cpa.3160280102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bai</surname>
            <given-names>PZ</given-names>
          </name>
          <name>
            <surname>Miljkovic</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>John</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>Interpretable bilinear attention network with domain adaptation improves drug-target prediction</article-title>
        <source>Nat. Mach. Intell.</source>
        <year>2023</year>
        <volume>5</volume>
        <fpage>126</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="doi">10.1038/s42256-022-00605-1</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
