<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Struct Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Acta Crystallogr D Struct Biol</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica. Section D, Structural Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2059-7983</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5349439</article-id>
    <article-id pub-id-type="publisher-id">ba5267</article-id>
    <article-id pub-id-type="doi">10.1107/S2059798316020234</article-id>
    <article-id pub-id-type="coden">ACSDAD</article-id>
    <article-id pub-id-type="pii">S2059798316020234</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The <italic>XChemExplorer</italic> graphical workflow tool for routine or large-scale protein–ligand structure determination</article-title>
      <alt-title>The <italic>XChemExplorer</italic> graphical workflow tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Krojer</surname>
          <given-names>Tobias</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Talon</surname>
          <given-names>Romain</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pearce</surname>
          <given-names>Nicholas</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-6265-9922</contrib-id>
        <name>
          <surname>Collins</surname>
          <given-names>Patrick</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Douangamath</surname>
          <given-names>Alice</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brandao-Neto</surname>
          <given-names>Jose</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dias</surname>
          <given-names>Alexandre</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marsden</surname>
          <given-names>Brian</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="aff" rid="c">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-0378-0017</contrib-id>
        <name>
          <surname>von Delft</surname>
          <given-names>Frank</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="aff" rid="b">b</xref>
        <xref ref-type="aff" rid="d">d</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>Structural Genomics Consortium, <institution>University of Oxford</institution>, Roosevelt Drive, Oxford OX3 7DQ, <country>England</country></aff>
      <aff id="b"><label>b</label>Diamond Light Source Ltd, Harwell Science and Innovation Campus, Didcot OX11 0QX, <country>England</country></aff>
      <aff id="c"><label>c</label>Kennedy Institute of Rheumatology, <institution>University of Oxford</institution>, Roosevelt Drive, Oxford OX3 7FY, <country>England</country></aff>
      <aff id="d"><label>d</label>Department of Biochemistry, <institution>University of Johannesburg</institution>, Auckland Park 2006, <country>South Africa</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>frank.vondelft@sgc.ox.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>73</volume>
    <issue>Pt 3</issue>
    <issue-id pub-id-type="publisher-id">d170300</issue-id>
    <fpage>267</fpage>
    <lpage>278</lpage>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>11</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>12</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Krojer et al. 2017</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://creativecommons.org/licenses/by/2.0/uk/</ali:license_ref>
      </license>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S2059798316020234">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p><italic>XChemExplorer</italic> is a graphical workflow and data-management tool for the parallel determination of protein–ligand complexes. Its implementation, usage and application are described here.</p>
    </abstract>
    <abstract>
      <p><italic>XChemExplorer</italic> (<italic>XCE</italic>) is a data-management and workflow tool to support large-scale simultaneous analysis of protein–ligand complexes during structure-based ligand discovery (SBLD). The user interfaces of established crystallo­graphic software packages such as <italic>CCP</italic>4 [Winn <italic>et al.</italic> (2011<xref ref-type="bibr" rid="bb36"> ▸</xref>), <italic>Acta Cryst.</italic> D<bold>67</bold>, 235–242] or <italic>PHENIX</italic> [Adams <italic>et al.</italic> (2010<xref ref-type="bibr" rid="bb1"> ▸</xref>), <italic>Acta Cryst.</italic> D<bold>66</bold>, 213–221] have entrenched the paradigm that a ‘project’ is concerned with solving one structure. This does not hold for SBLD, where many almost identical structures need to be solved and analysed quickly in one batch of work. Functionality to track progress and annotate structures is essential. <italic>XCE</italic> provides an intuitive graphical user interface which guides the user from data processing, initial map calculation, ligand identification and refinement up until data dissemination. It provides multiple entry points depending on the need of each project, enables batch processing of multiple data sets and records metadata, progress and annotations in an SQLite database. <italic>XCE</italic> is freely available and works on any Linux and Mac OS X system, and the only dependency is to have the latest version of <italic>CCP</italic>4 installed. The design and usage of this tool are described here, and its usefulness is demonstrated in the context of fragment-screening campaigns at the Diamond Light Source. It is routinely used to analyse projects comprising 1000 data sets or more, and therefore scales well to even very large ligand-design projects.</p>
    </abstract>
    <kwd-group>
      <kwd>
        <italic>XChemExplorer</italic>
      </kwd>
      <kwd>
        <italic>PanDDA</italic>
      </kwd>
      <kwd>structure-based ligand design</kwd>
      <kwd>protein–ligand structure</kwd>
      <kwd>fragment screening</kwd>
    </kwd-group>
    <conference>
      <conf-date/>
      <conf-name>Protein–ligand complexes: understanding biological chemistry (Part 2)</conf-name>
      <conf-loc/>
    </conference>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title>Introduction   </title>
    <p>Protein crystallography is a cornerstone of structure-based ligand design (SBLD; Blundell <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb3"> ▸</xref>), providing the molecular details of how newly synthesized compounds interact with the protein of interest in order to drive the compound-design process. This requires iterative cycles of design and synthesis of compounds with improved binding characteristics, based on structural information of previous protein–ligand complexes and biophysical measurements (Carvalho <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb6"> ▸</xref>). In the past, SBLD was the preserve of industry, but academic groups have lately started to pick up on this approach (Hole <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb14"> ▸</xref>; Brem <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb4"> ▸</xref>).</p>
    <p>Depending on the magnitude of the project and its resources, every development cycle may yield tens of novel compounds, each of which requires a protein–ligand structure, either by co-crystallization or soaking into preformed crystals. The widespread availability of third-generation synchrotron sources which are equipped with reliable robotic sample changers and fast X-ray detectors has made it possible to collect hundreds of data sets during a single visit (Broennimann <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb5"> ▸</xref>; Nurizzo <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb23"> ▸</xref>). The extreme case is crystallographic fragment screening, in which hundreds of similar data sets are collected rapidly and automatically (Bauman <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb2"> ▸</xref>; Schiebel <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb29"> ▸</xref>). In 2012, Wasserman and coworkers estimated that industry determines in excess of 10 000 protein–ligand structures per year (Wasserman <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb35"> ▸</xref>), and in the light of ever-improving hardware and software this number is likely to increase manyfold in the near future. For instance, the Oxford site of the Structural Genomics Consortium (SGC) alone collected 960 data sets from different protein–ligand complexes in 2015.</p>
    <p>The success and throughput of SBLD projects depends on the availability of robust and well diffracting crystal systems (Danley, 2006<xref ref-type="bibr" rid="bb8"> ▸</xref>). Hence, from a crystallographic point of view, data collection, processing and refinement of such samples might appear to be algorithmically trivial: most crystals will be nearly isomorphous, so that phasing is achieved by simple molecular substitution, while adjustments to the model are usually restricted to the region around the respective ligand-binding site.</p>
    <p>Crystallographic software packages have undergone a remarkable degree of automation over the last decade which facilitates all steps of structure determination, starting with data processing (Vonrhein <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb34"> ▸</xref>; Winter, 2010<xref ref-type="bibr" rid="bb37"> ▸</xref>; Sparta <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb30"> ▸</xref>; Grochulski <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb13"> ▸</xref>), through phasing (Holton &amp; Alber, 2004<xref ref-type="bibr" rid="bb15"> ▸</xref>; Keegan &amp; Winn, 2008<xref ref-type="bibr" rid="bb17"> ▸</xref>; Ness <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb22"> ▸</xref>; Panjikar <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb24"> ▸</xref>; Terwilliger <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb31"> ▸</xref>) and model building (Cowtan, 2006<xref ref-type="bibr" rid="bb7"> ▸</xref>; Porebski <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb27"> ▸</xref>; Terwilliger <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb32"> ▸</xref>), all the way to refinement (Joosten <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb16"> ▸</xref>). Additionally, pipelines have become available to specifically support the solution of protein–ligand structures (Echols <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb10"> ▸</xref>).</p>
    <p>However, what remains unaddressed is the logistics of analysing large numbers of data sets. Crystallographic software suites such as <italic>CCP</italic>4 or <italic>PHENIX</italic> have not evolved beyond the early paradigm that one project leads to one structure, a design that is adequate for the determination of novel or otherwise challenging crystal structures but does not really reflect the requirements of SBLD projects. In SBLD, a single project consists of multiple structures, all of which need to be analysed in relation to each other. Additionally, protein–ligand structure solution is usually a linear, well defined process and mostly requires the repetitive usage of a limited number of software tools. This seemingly simple workflow becomes tedious because it requires the user to relaunch the same processes over and over again. Ideally, users should be able to analyse, build and refine multiple structures within one software instance without having to open and close different programs.</p>
    <p>The <italic>AutoSolve</italic> platform from Astex (Mooij <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb20"> ▸</xref>) represents one solution to the problem, and it can be assumed that many industrial or industry-like groups have developed similar software solutions that tie in with their internal databases. However, these solutions are not publicly available and, even if they were, such systems would not be trivial to set up or to maintain. There exist no up-to-date workflow-management tools to support multi-data-set analysis that are available to the broad crystallographic community.</p>
    <p>Here, we present <italic>XChemExplorer</italic> (<italic>XCE</italic>), a graphical, data-management and workflow tool that brings together established programs that are typically used to process, solve and refine protein–ligand structures. <italic>XCE</italic> does not try to automate the structure-determination process, but it serves as the control centre for running the necessary programs and allows the user to annotate each experiment easily but thoroughly. <italic>XCE</italic> was originally developed to support crystallographic fragment screening at the Diamond Light Source, but it is a generic tool that can be used for any project that needs to solve many similar protein–ligand structures.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Philosophy   </title>
    <p>Protein–ligand structure determination may be an algorithmically simple and linear process, but it turns into a challenge when many samples are analysed as part of an SBLD project which can go on for months and years. Not only are there specific demands on project design, but there have to be mechanisms to capture progress and results. This becomes exponentially challenging as the numbers of data sets become large, unless it is explicitly supported by software. For example, compounds often do not bind to a protein and the reason for this is not always immediately clear. While the experiment ultimately remains unsuccessful, the reason for the failure may be unrelated to the compound, and become evident only when every step of that particular experiment is analysed. <italic>XCE</italic> records compound information, metadata, file locations, observations, outcome and status of the project in a database. It serves as a funnel which channels disparate data into a grid so that it becomes comprehensible for the scientist. The program does not try to make decisions for the crystallo­grapher, but it provides the tools to evaluate each experiment, assign a result and (re)run calculations in batches. The recommended workflow (Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>) is reflected by the design of the graphical user interface (Figs. 2–5): each tab in the interface represent a milestone in the workflow, and the processes necessary to achieve the respective objectives are bundled in the coloured boxes at the bottom of the panel. The main workflow is grouped into four sections (data processing, initial map calculation, hit identification and refinement) and it is possible to enter at any point, provided that the required data are present in a suitable format.</p>
    <p><italic>XCE</italic> uses a relational SQLite database to store, retrieve and update all of the metadata that are generated as part of a project. The database can be populated by different means depending on the entry point.<list list-type="simple" id="l1"><list-item><p>(i) In the most general case, <italic>XCE</italic> will be used to process diffraction images, whereby the software will create a sample entry for every data set.</p></list-item><list-item><p>(ii) It is possible to manually create the anticipated directory structure, and the software will be able to auto-populate the database while parsing the project directory. Details of the naming conventions and project directory structure are given in §<xref ref-type="sec" rid="sec3.2"/>3.2 and Supporting Information §S1.</p></list-item><list-item><p>(iii) If the data were collected at the Diamond Light Source then the database can be populated by parsing the respective visit directory as long as the data sets were collected according to the following folder structure: <monospace>&lt;protein name&gt;/&lt;crystal name&gt;</monospace>, <italic>e.g.</italic>
<monospace>Lysozyme/Lysozyme-x001</monospace>
<italic>etc</italic>. All results from automatic data processing are stored in a folder named <monospace>processed</monospace> in the respective visit directory, and the folder hierarchy during data collection is reflected in the structure of the processed folder. It contains a directory for each protein target and subfolders for every protein crystal belonging to the target, which then branch into subfolders for different runs and finally into folders for the different data-processing pipelines.</p></list-item><list-item><p>(iv) In the special case where crystals were mounted and collected as part of a crystallographic fragment-screening project at beamline I04-1 at the Diamond Light Source, then the resulting SQLite file can be directly used as input for <italic>XCE</italic>.</p></list-item></list>
</p>
    <p><italic>XCE</italic> tracks the status of each mounted crystal by storing the data-collection outcome, refinement stage and ligand confidence in the respective field in the database. An overview and an explanation of the different flags can be found in Supplementary Tables S1–S3. Some of the assignments are performed automatically, while others must be explicitly triggered by the user.</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Software design and implementation   </title>
    <p><italic>XChemExplorer</italic> is implemented in Python (<ext-link ext-link-type="uri" xlink:href="http://www.python.org">http://www.python.org</ext-link>) and, like <italic>CCP</italic>4, uses the PyQt4 library to provide the graphical user interface functionality. It runs on any Linux or Mac OS X system that has <italic>CCP</italic>4 v.7.0 or higher installed. <italic>XCE</italic> uses SQLite (<ext-link ext-link-type="uri" xlink:href="http://www.sqlite.org">http://www.sqlite.org</ext-link>) as a relational database-management system. The <italic>RDKit</italic> library (<ext-link ext-link-type="uri" xlink:href="http://www.rdkit.org">http://www.rdkit.org</ext-link>) is used to create two-dimensional images of compounds. Since <italic>XCE</italic> is a workflow and data-management tool and not an algorithm, it makes use of existing software for different parts of the structure-determination process: <italic>xia</italic>2 (Winter, 2010<xref ref-type="bibr" rid="bb37"> ▸</xref>) for data processing; <italic>DIMPLE</italic> for initial refinement and map calculation; <italic>AceDRG</italic> (Long <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb19"> ▸</xref>) for generation of ligand coordinates and restraints; <italic>REFMAC</italic> (Murshudov <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb21"> ▸</xref>) for refinement; <italic>PanDDA</italic> (Pearce <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb25"> ▸</xref>) for hit identification; a variety of tools from <italic>PHENIX</italic> (Adams <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb1"> ▸</xref>) for validation purposes; and <italic>Coot</italic> (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb11"> ▸</xref>) for model building. There is, however, no fundamental limitation to incorporating other software packages. Source code for <italic>XChemExplorer</italic> and installation instructions are available at <ext-link ext-link-type="uri" xlink:href="http://tkrojer.github.io/XChemExplorer">http://tkrojer.github.io/XChemExplorer</ext-link>.</p>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Filesystem organization   </title>
      <p><italic>XCE</italic> is a filesystem-based program, meaning that all files are stored in the same project directory and have to be organized in a hierarchical manner. All files belonging to one crystal are stored in a subfolder and the name of this folder is equal to the sample identifier. The filenames have to adhere to a naming convention, but the program will manage the correct labelling if used throughout the process. Nevertheless, the requirements are minimal and it is easy to add data manually by adjusting the folder and file names to the expected nomenclature. All that needs to be provided are an MTZ file and an <italic>AIMLESS</italic> logfile (Evans &amp; Murshudov, 2013<xref ref-type="bibr" rid="bb12"> ▸</xref>) in the respective sample directory. The files must have the same filename root as the folder name, <italic>e.g.</italic> if the folder name is <monospace>TEST-x001</monospace>, then the MTZ and logfile must be called <monospace>TEST-x001.mtz</monospace> and <monospace>TEST-x001.log</monospace>, respectively. Alternatively, the MTZ file and logfile must have the same name in all subfolders, <italic>e.g.</italic>
<monospace>datafile.mtz</monospace> and <monospace>datafile.log</monospace>. Details of naming conventions are given in Supporting Information §S1.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>SQLite database   </title>
      <p><italic>XCE</italic> relies on an SQLite relational database to store and retrieve all of the many pieces of metadata for each sample and experiment. As described in §<xref ref-type="sec" rid="sec2"/>2, the database can be generated in different ways, while its contents can be viewed and edited in the Overview tab (Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>). An SQLite database is essentially just a file and therefore requires little maintenance, in contrast to more sophisticated server–client database engines which are not easy to set up and maintain without dedicated IT support. <italic>XCE</italic> could be configured to support such systems, but priority was given to establishing a transparent, comprehensible and editable system which reflects the day-to-day reality of the typical practising crystallographer. The database consists of a main table which contains a row for each sample and columns for different metadata, and a secondary table to capture results specific to the novel <italic>PanDDA</italic> (<italic>Pan-Dataset Density Analysis</italic>) hit-analysis software (Pearce <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb25"> ▸</xref>). The location and name of the database is defined in the settings of <italic>XCE</italic> and, since the database is just a file, it can be located anywhere on the filesystem. Access control is file-based, so that any user with read-access to the relevant file system will be able to access the data. The content of the database can be displayed with <italic>XCE</italic> or with freely available software such as the <italic>SQLite Browser</italic> (<ext-link ext-link-type="uri" xlink:href="http://sqlitebrowser.org">http://sqlitebrowser.org</ext-link>)</p>
      <p><italic>XCE</italic> can export the database to a comma-separated file (csv), which can then be read into programs such as <italic>Microsoft Excel</italic> for analysis or manipulation. An updated csv file can be reimported into the database if necessary, which is particularly useful for retroactively adding ligand information. <italic>XCE</italic> does not work without a database being specified, but it is always possible to recreate the database from an existing filesystem. In its current form, <italic>XCE</italic> does not provide an interface to external databases, but users who have their own database can easily query the SQLite file and synchronize it with their own system.</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Job submission   </title>
      <p><italic>XCE</italic> checks for the availability of a functional queuing system during startup and will submit all computationally intensive calculations to the cluster. Alternatively, the local machine will be used. At the moment only the Portable Batch System (PBS) is supported, but implementation of other queuing systems would not in principle be difficult.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Description of usage   </title>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Starting the program   </title>
      <p>The program can be started with little preparation. It is sufficient to provide a database file and the location of a project directory. If the database does not already exist, then the ‘Data Source’ menu can be used to create a database from scratch. Additional directories can be specified as relevant, for example the location of reference files, the output of <italic>PanDDA</italic> hit analysis or a visit directory at the Diamond Light Source.</p>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Data-collection review and data (re)processing   </title>
      <p>The Datasets tab is for reviewing data collections at the Diamond Light Source and for analysing data sets processed with different auto-processing pipelines. Additionally, diffraction images can be (re)processed with the <italic>xia</italic>2 data-reduction system (Winter, 2010<xref ref-type="bibr" rid="bb37"> ▸</xref>). Historically, this was the first module of the program, because data collected at Diamond Light Source are immediately processed by several automated data-processing pipelines (Winter &amp; McAuley, 2011<xref ref-type="bibr" rid="bb38"> ▸</xref>). The availability of such a system appears to be indispensable for any ambitious SBLD program since the multiple programs provide redundancy that ensures that the pipeline robustly provides outputs. Individual programs are prone to unpredictable failures in ways that are neither feasible nor interesting to troubleshoot in the face of large amounts of raw data. At the same time, it does present the challenge of having to assess and select one of multiple processed versions of the data for each crystal.</p>
      <p>After the processed data are available, the program will walk through the data directories, check for the presence of scaled MTZ files and parse the corresponding <italic>AIMLESS</italic> logfiles. For data collected at Diamond Light Source, it will additionally read and encode crystal images which are recorded before data collection and which indicate whether the specimen was correctly aligned. MTZ and logfiles from all auto-processing pipelines are then immediately copied to the project directory. The program can additionally monitor an ongoing data collection by parsing a specified visit directory every 2 min and dynamically updating the table in the Datasets tab. The current implementation of <italic>XCE</italic> allows only data collected at Diamond Light Source to be reviewed, because the specific directory structure at Diamond is necessarily hard-coded. However, the relevant code is isolated, meaning it can be adapted for other sites with relative ease.</p>
      <p>Results are displayed in the central table, showing one line for each sample, together with the currently selected processing results, crystal images after alignment and a drop-down list that specifies the outcome of the experiment (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>). <italic>XCE</italic> will copy the final MTZ and logfiles from all pipelines into the project directory, but only the one that is currently selected will be used for any downstream calculations. The program will preselect one result, but it is possible to expand the view and to manually select any data-processing result. Details of the available selection criteria can be found in Supporting Information §S2.</p>
      <p>The annotation mechanism is implemented by a drop-down menu for each sample which can be set with a quick scroll of the mouse wheel: this operational simplicity is a vital pre­requisite for data sets to be annotated completely. <italic>XCE</italic> automatically flags data collections as successful if a valid MTZ file is found which fulfils a user-defined resolution criterion. If no MTZ file can be found in a given sample directory then <italic>XCE</italic> will label the data collection as an unknown failure. However, if a user wants to specify the type of failure in more detail, for example no diffraction, loop broken <italic>etc.</italic>, then they can do so by manually changing the text of the drop-down menu (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>). Details about the available annotation criteria are given in Supplementary Table S1. The snapshots after crystal alignment are essential for determining the reason for failure: correct crystal alignment is only a peripheral problem for manual data collection, but can be a major issue for automatically centred crystals.</p>
      <p>The final facilitator of identifying problematic crystals is the ability to sort the table by any of the displayed categories. Thus, for instance, abnormally large <italic>R</italic>
<sub>merge</sub> values in the inner resolution shell of data sets are usually a good indicator of samples that warrant closer inspection.</p>
    </sec>
    <sec id="sec4.3">
      <label>4.3.</label>
      <title>Initial map calculation   </title>
      <p>The Maps &amp; Restraints panel enables initial refinement of each data set with the <italic>DIMPLE</italic> difference-map pipeline (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>). The table provides an overview of all successfully reduced data sets, their resolution and <italic>R</italic>
<sub>cryst</sub>/<italic>R</italic>
<sub>free</sub> values in the case where any refinement has been carried out already. <italic>XCE</italic> uses a simple but fast and effective mechanism to search for suitable PDB input files: it will compare the point group and unit-cell volume of each PDB file in the reference directory with the sample MTZ file and suggest it as input for <italic>DIMPLE</italic> if they have the same point group and differ by less than 10% in unit-cell volume. The latter parameter can be adjusted in the Preferences menu. The currently selected reference file is displayed in the drop-down menu, but any of the files in the Reference directory can be chosen. Individual samples or batches can be selected for (re)processing with <italic>DIMPLE</italic>. Since <italic>DIMPLE</italic> is able to solve the structures of non-isomorphous crystals by performing an additional molecular-replacement step, it may not seem necessary to devote much thought to the careful selection of a suitable reference file. However, it is not advisable to completely rely on automated decision making because it is invariably a warning sign if no suitable reference file is available: the program after all assumes that all data sets are similar to the available reference models and it is always better to prepare a good model outside the <italic>XCE</italic> workflow which accurately explains the respective crystal rather than to continue with a suboptimal model. The latter option may sound tempting at the time, but usually results in additional work downstream.</p>
    </sec>
    <sec id="sec4.4">
      <label>4.4.</label>
      <title>Ligand preparation   </title>
      <p>It is a hallmark of SBLD that novel compounds are used that are unlikely to feature in the Cambridge Structural Database or the Protein Data Bank. Hence, ligand coordinates and accurate geometry restraints need to be generated for subsequent model building and refinement purposes (Kleywegt, 2007<xref ref-type="bibr" rid="bb18"> ▸</xref>). The Maps &amp; Restraints tab allows the calculation of ligand coordinates, restraints and two-dimensional pictures of batches of compounds with <italic>AceDRG</italic> and the <italic>RDkit</italic> library.</p>
      <p>Information about the compounds needs to be provided in the SQLite database as a SMILES notation. The resulting files are stored in the respective sample folder in the project directory. The database is updated with information about the location of ligand coordinates and restraints once the files have been successfully created. In case of problems, <italic>XCE</italic> does not analyse the cause for failure, but users can query the database and obtain a quick overview of all failed attempts to generate restraints and find the location of the respective sample folder. Note that ligand coordinates and restraints are automatically loaded into <italic>Coot</italic> during the Refinement stage. Hence, validation and editing functionalities in <italic>Coot</italic> can be used in case the respective values need to be updated (Debreczeni &amp; Emsley, 2012<xref ref-type="bibr" rid="bb9"> ▸</xref>). Not currently supported are scenarios where the chirality of the compound is unknown, which are not uncommon in ligand-binding studies. In such cases the corresponding files need to be generated manually and copied into the respective folder.</p>
    </sec>
    <sec id="sec4.5">
      <label>4.5.</label>
      <title>Hit identification (<italic>PanDDA</italic>)   </title>
      <p><italic>XCE</italic> offers a graphical entry point for the recently developed <italic>PanDDA</italic> (<italic>Pan-Dataset Density Analysis</italic>) software (Pearce <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb25"> ▸</xref>) for improved hit identification (Fig. 5<xref ref-type="fig" rid="fig5"> ▸</xref>). Interpreting weak and ambiguous ligand density can significantly slow down a project and make the final models less reliable and dependent on subjective decisions of the responsible scientist (Pozharski <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb28"> ▸</xref>), whereas the <italic>PanDDA</italic> algorithm establishes statistically significant measures of confidence for each analysed sample.</p>
      <p>The <italic>PanDDA</italic> protocol consists of three steps: analysis, inspection and export. <italic>XCE</italic> displays details of the available data sets for <italic>pandda.analyse</italic> in a table and allows the user to adjust key parameters of the analysis protocol. The results can be displayed with <italic>pandda.inspect</italic>, which uses <italic>Coot</italic> and a special inspection panel for assessing and modelling of the bound ligands. The resulting models undergo a round of refinement and validation during the export step. Additionally, all output which is generated by the <italic>PanDDA</italic> software will be imported into the database at this point. Details of the processes taking place during the export step are given in Supplementary Fig. S2. While it is recommended to use <italic>PanDDA</italic> for hit identification, it is not necessary to be able to continue with the workflow since it is possible to proceed directly to refinement after initial map calculation.</p>
    </sec>
    <sec id="sec4.6">
      <label>4.6.</label>
      <title>Refinement   </title>
      <p>Completing structures requires iterative cycles of model building, refinement and validation, with progress monitored by the convergence of global quality metrics. Unfortunately, the endpoint is often ill-defined and mostly depends on the assessment of a skilled crystallographer. <italic>XCE</italic> addresses this challenge by minimizing the number of cycles through assisting the user in obtaining the best possible starting model (see §§<xref ref-type="sec" rid="sec4.3"/>4.3 and <xref ref-type="sec" rid="sec4.5"/>4.5).</p>
      <p>The process is greatly accelerated by a graphical command interface which allows modelling and refinement of all data sets within a single instance of <italic>Coot</italic> (Fig. 6<xref ref-type="fig" rid="fig6"> ▸</xref>). A subset of all available structures can be selected based on their refinement stage and, in the case where the ligands were built with <italic>PanDDA</italic>, location of the respective binding site. The interface displays global and ligand-specific quality metrics of the currently loaded structure, as well as a two-dimensional picture of the ligand and a radar plot summarizing a set of ligand-validation scores: correlation between model and observed electron density (RSCC), a statistical measure of difference density in this region of the model (RSZD), the <italic>B</italic>-factor ratio of ligand and surrounding protein side-chain atoms within 4 Å (<italic>B</italic>-factor ratio), the root-mean-squared deviation of ligand coordinates in the initial model and after refinement (r.m.s.d.), and the strength of density over model normalized for occupancy (RSZO/OCC) (Pearce &amp; von Delft, 2017<xref ref-type="bibr" rid="bb26"> ▸</xref>; Tickle, 2012<xref ref-type="bibr" rid="bb33"> ▸</xref>). The corresponding ligand coordinates and restraints are loaded as a separate molecule in C<italic>oot</italic> when a new molecule is chosen. In the case where the ligand had not been modelled before, then the interface can be used to first place the molecule into the centre of the screen for further fitting and then to merge it into the loaded protein structure. Refinement can be triggered with a single button click and is carried out with <italic>REFMAC</italic>, followed by comprehensive valid­ation with different programs from the <italic>PHENIX</italic> package. Details of the procedure can be found in Supplementary Fig. S3. Finally, global and ligand-specific quality metrics of the resulting model are determined and the database is updated accordingly.</p>
      <p>Additionally, a qualitative assessment of refinement stage and ligand confidence of each sample can be chosen from pre-defined categories. <italic>XCE</italic> uses a hierarchical annotation system to help the refiner describe the refinement stage of a given data set, facilitating the organization and prioritization of samples within a project. The respective database field is updated automatically during data collection, initial refinement with <italic>DIMPLE</italic> and <italic>PanDDA</italic> analysis, but once the final refinement stage is reached crystallographers need to change the flag individually. The categories are mostly self-descriptive and details can be found in Supplementary Table S2. Introduction of this hierarchy helps to provide an overview of the work that is still needed to finish all the models, and it allows subsets of all available structures to be selected which need more work to be performed before they are ready for subsequent analysis and deposition. The ligand confidence category reflects the trust of the refiner in the modelled ligand. This may change as refinement progresses and is informed by how well the electron density or the <italic>PanDDA</italic> event map describes the ligand and by the quantitative metrics described above. Ultimately, it remains a subjective statement, but it is especially useful in cases where the crystallographer cannot unambiguously establish the binding pose and therefore needs a way to communicate the limitations of the model to whoever uses it for further analysis.</p>
    </sec>
    <sec id="sec4.7">
      <label>4.7.</label>
      <title>Data sharing   </title>
      <p>The final problem addressed by <italic>XCE</italic> is how to communicate the results with other scientists; this is of particular importance in SBLD projects, which are per definition multi-disciplinary. The software tools and quality metrics that are well known to the crystallographic community tend to be alien to non-structural biologists, and not in fact relevant to their problems. In our experience, they ask the following questions.<list list-type="simple" id="l2"><list-item><p>(i) Which protein–ligand structures are available?</p></list-item><list-item><p>(ii) Where is the PDB file?</p></list-item><list-item><p>(iii) Is this a ‘good model’?</p></list-item><list-item><p>(iv) Is that water/methyl/hydroxyl really where it was modelled?</p></list-item></list>
</p>
      <p><italic>XCE</italic> therefore includes a tool which converts the results in the database into an HTML document (Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>). The HTML format allows the easy sharing of results either within an organization or with other scientists <italic>via</italic> the internet. The bound ligands are displayed in a tabular form, including details of the compound, manual annotations of reliability and links to download PDB, MTZ and CIF files. Most importantly, the recipients can themselves assess the reliability of the model: numerically by a radar plot that summarizes the reliability of the ligand and model (Pearce &amp; von Delft, 2017<xref ref-type="bibr" rid="bb26"> ▸</xref>) and graphically through an interactive <italic>IcmJS</italic> plugin (Molsoft LLC) that displays the primary evidence for the ligand, namely the <italic>PanDDA</italic> event map.</p>
    </sec>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Results and discussion   </title>
    <p><italic>XCE</italic> has been extensively tested by supporting crystallo­graphic fragment screening at Diamond Light Source. In the course of several iterations of bug fixes, the program has become one of the cornerstones of the facility: only once the program was available in its current stable form did it become possible to completely model fragment-screening projects promptly and efficiently.</p>
    <p>The philosophy of the program was stress-tested in a retrospective analysis of six historic fragment campaigns where the goal was to detect and model all bound ligands with the novel <italic>PanDDA</italic> algorithm and assemble information about how the fragment set influences the diffraction behaviour of different crystal systems. The review of 5970 individual data sets was completed by two experienced crystallographers in only 5 d, including the documenting of all experiments and finalizing all 380 protein–ligand structures. This was only possible because the program condensed huge amounts of information to make it comprehensible for the user. For instance, many data-quality statistics are available, but we confirmed that two criteria, namely the resolution limit, defined as where Mn〈<italic>I</italic>/σ(<italic>I</italic>)〉 falls below 1.5, and the <italic>R</italic>
<sub>merge</sub> value for the inner resolution shell, were wholly sufficient for identifying problematic data sets. Additionally, the representation of results in tables and the possibility to sort them made it straightforward to triage data sets into those that could be taken forward and those that needed further attention. Therefore, most of the work up to manual inspection of the <italic>PanDDA</italic> output was completed with minimal user input. Here too, only around 20% of the all data sets had to be checked for bound ligands, as they were the only ones with a statistically significant difference signal. Finally, all steps that required manipulation of models or decision making by the refiner were facilitated because all commands and annotations could be carried out within a single instance of <italic>Coot</italic>, allowing the users to finish tens of structures within a few hours.</p>
    <p>While <italic>XCE</italic> implements all steps required to solve protein–ligand structures, the program is designed to accommodate multiple entry points, since different projects have different requirements and not all will always conform to the standard workflow. For example, while the <italic>PanDDA</italic> algorithm is known to be a powerful tool for hit identification, if a user decides that this is not applicable, <italic>XCE</italic> nevertheless supports inspection of initial electron-density maps, ligand building and refinement.</p>
    <p><italic>XCE</italic> depends on a relational SQLite database, but is at its heart a filesystem-based tool. While a server-based database system may have certain advantages and seem more elegant, the chosen paradigm is more transparent for the responsible scientists and allows the introduction of changes without the user having to be familiar with relational database systems. However, there are clearly some limitations to this approach, which other recently presented developments have circumvented, including <italic>ManageCCP</italic>4<italic>i</italic>2<italic>Archive</italic>, a tool for the collaborative sharing of large sets of structural projects undertaken across a research group, written in the <italic>CCP</italic>4<italic>i</italic>2 structure-determination environment but using a web-based approach (M. Noble, personal communication). Both developments clearly point in the same direction and could indeed be combined with relative ease for multi-disciplinary research projects: the structures and results generated by <italic>XCE</italic> could be fed into <italic>ManageCCP</italic>4<italic>i</italic>2<italic>Archive</italic>, which could then be used to distribute the information to all the scientists involved in the project, providing a high-level platform for further structural analysis.</p>
    <p>The algorithmic simplicity of the workflow means that most apparent errors are in fact caused by undetected crystallo­graphic problems. The unexpected appearance of new crystal forms for a subset of the collected crystals is a typical case where the underlying problem can be quickly and easily established with <italic>XCE</italic>. In particular, discrepancies between the reference files provided and the data sets will almost always show up in the Maps &amp; Restraints table when the point groups are not in agreement, the differences between unit-cell volumes are large or the <italic>R</italic>
<sub>cryst</sub>/<italic>R</italic>
<sub>free</sub> values are high after initial refinement. The sorting mechanism allows the identity and the number of data sets affected to be rapidly identified. Additionally, more subtle differences between the data sets can be detected with a <italic>PanDDA</italic> data-set clustering algorithm.</p>
    <p>Although deposition procedures at the Protein Data Bank are well established, using them to deposit dozens of structures is not realistic without helper tools. The PDB is currently developing a bulk deposition interface to encourage groups which are working on SBLD projects to contribute their structures (Stephen K. Burley, personal communication). Even so, a major bottleneck remains that all the required metadata must be collated; as <italic>XCE</italic> already records much of the required information, it can automatically generate valid mmCIF files. This required functionality will be fully implemented in the near future.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data">
      <p>Supporting Information.. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1107/S2059798316020234/ba5267sup1.pdf">10.1107/S2059798316020234/ba5267sup1.pdf</ext-link>
</p>
      <media mimetype="application" mime-subtype="pdf" xlink:href="d-73-00267-sup1.pdf" orientation="portrait" id="d35e199" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank David Damerell, Laura Diaz Saez, Joseph Newman, Dan Pinkas and Srikannathasan Velupillai for testing of the program and helpful feedback. The SGC is a registered charity (No. 1097737) that receives funds from AbbVie, Bayer, Boehringer Ingelheim, the Canada Foundation for Innovation, the Canadian Institutes for Health Research, Genome Canada, GlaxoSmithKline, Janssen, Lilly Canada, the Novartis Research Foundation, the Ontario Ministry of Economic Development and Innovation, Pfizer, Takeda and the Wellcome Trust (092809/Z/10/Z).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Adams, P. D. <italic>et al.</italic> (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 213–221.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Bauman, J. D., Patel, D., Dharia, C., Fromer, M. W., Ahmed, S., Frenkel, Y., Vijayan, R. S., Eck, J. T., Ho, W. C., Das, K., Shatkin, A. J. &amp; Arnold, E. (2013). <italic>J. Med. Chem.</italic>
<bold>56</bold>, 2738–2746.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Blundell, T. L., Jhoti, H. &amp; Abell, C. (2002). <italic>Nature Rev. Drug. Discov.</italic>
<bold>1</bold>, 45–54.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Brem, J., Cain, R., Cahill, S., McDonough, M. A., Clifton, I. J., Jimenez-Castellanos, J. C., Avison, M. B., Spencer, J., Fishwick, C. W. G. &amp; Schofield, C. J. (2016). <italic>Nature Commun.</italic>
<bold>7</bold>, 12406.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Broennimann, C., Eikenberry, E. F., Henrich, B., Horisberger, R., Huelsen, G., Pohl, E., Schmitt, B., Schulze-Briese, C., Suzuki, M., Tomizaki, T., Toyokawa, H. &amp; Wagner, A. (2006). <italic>J. Synchrotron Rad.</italic>
<bold>13</bold>, 120–130.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Carvalho, A. L., Trincão, J. &amp; Romão, M. J. (2009). <italic>Methods Mol. Biol.</italic>
<bold>572</bold>, 31–56.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Cowtan, K. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 1002–1011.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Danley, D. E. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 569–575.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Debreczeni, J. É. &amp; Emsley, P. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 425–430.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Echols, N., Moriarty, N. W., Klei, H. E., Afonine, P. V., Bunkóczi, G., Headd, J. J., McCoy, A. J., Oeffner, R. D., Read, R. J., Terwilliger, T. C. &amp; Adams, P. D. (2014). <italic>Acta Cryst.</italic> D<bold>70</bold>, 144–154.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Emsley, P., Lohkamp, B., Scott, W. G. &amp; Cowtan, K. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 486–501.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Evans, P. R. &amp; Murshudov, G. N. (2013). <italic>Acta Cryst.</italic> D<bold>69</bold>, 1204–1214.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Grochulski, P., Fodje, M., Labiuk, S., Gorin, J., Janzen, K. &amp; Berg, R. (2012). <italic>J. Struct. Funct. Genomics</italic>, <bold>13</bold>, 49–55.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Hole, A. J., Baumli, S., Shao, H., Shi, S., Huang, S., Pepper, C., Fischer, P. M., Wang, S., Endicott, J. A. &amp; Noble, M. E. (2013). <italic>J. Med. Chem.</italic>
<bold>56</bold>, 660–670.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Holton, J. &amp; Alber, T. (2004). <italic>Proc. Natl Acad. Sci. USA</italic>, <bold>101</bold>, 1537–1542.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Joosten, R. P., Joosten, K., Murshudov, G. N. &amp; Perrakis, A. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 484–496.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Keegan, R. M. &amp; Winn, M. D. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 119–124.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Kleywegt, G. J. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 94–100.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Long, F., Nicholls, R. A., Emsley, P., Grazulis, S., Merkys, A., Vaitkus, A. &amp; Murshudov, G. N. (2017). <italic>Acta Cryst.</italic> D<bold>73</bold>, 112–122.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Mooij, W. T., Hartshorn, M. J., Tickle, I. J., Sharff, A. J., Verdonk, M. L. &amp; Jhoti, H. (2006). <italic>ChemMedChem</italic>, <bold>1</bold>, 827–838.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Murshudov, G. N., Skubák, P., Lebedev, A. A., Pannu, N. S., Steiner, R. A., Nicholls, R. A., Winn, M. D., Long, F. &amp; Vagin, A. A. (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 355–367.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Ness, S. R., de Graaff, R. A. G., Abrahams, J. P. &amp; Pannu, N. S. (2004). <italic>Structure</italic>, <bold>12</bold>, 1753–1761.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Nurizzo, D., Bowler, M. W., Caserotto, H., Dobias, F., Giraud, T., Surr, J., Guichard, N., Papp, G., Guijarro, M., Mueller-Dieckmann, C., Flot, D., McSweeney, S., Cipriani, F., Theveneau, P. &amp; Leonard, G. A. (2016). <italic>Acta Cryst.</italic> D<bold>72</bold>, 966–975.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Panjikar, S., Parthasarathy, V., Lamzin, V. S., Weiss, M. S. &amp; Tucker, P. A. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 449–457.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Pearce, N. M., Bradley, A. R., Collins, P., Krojer, T., Nowak, R. P., Talon, R., Marsden, B. D., Kelm, S., Shi, J., Deane, C. M. &amp; von Delft, F. (2016). <italic>bioRxiv</italic>, https://doi.org/10.1101/073411.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Pearce, N. M., Krojer, T. &amp; von Delft, F. (2017). <italic>Acta Cryst.</italic> D<bold>73</bold>, 256–266.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Porebski, P. J., Cymborowski, M., Pasenkiewicz-Gierula, M. &amp; Minor, W. (2016). <italic>Acta Cryst.</italic> D<bold>72</bold>, 266–280.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Pozharski, E., Weichenberger, C. X. &amp; Rupp, B. (2013). <italic>Acta Cryst.</italic> D<bold>69</bold>, 150–167.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Schiebel, J. <italic>et al.</italic> (2016). <italic>Structure</italic>, <bold>24</bold>, 1398–1409.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Sparta, K. M., Krug, M., Heinemann, U., Mueller, U. &amp; Weiss, M. S. (2016). <italic>J. Appl. Cryst.</italic>
<bold>49</bold>, 1085–1092.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Terwilliger, T. C., Adams, P. D., Read, R. J., McCoy, A. J., Moriarty, N. W., Grosse-Kunstleve, R. W., Afonine, P. V., Zwart, P. H. &amp; Hung, L.-W. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 582–601.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Terwilliger, T. C., Grosse-Kunstleve, R. W., Afonine, P. V., Moriarty, N. W., Zwart, P. H., Hung, L.-W., Read, R. J. &amp; Adams, P. D. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 61–69.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Tickle, I. J. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 454–467.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Vonrhein, C., Flensburg, C., Keller, P., Sharff, A., Smart, O., Paciorek, W., Womack, T. &amp; Bricogne, G. (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 293–302.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Wasserman, S. R., Koss, J. W., Sojitra, S. T., Morisco, L. L. &amp; Burley, S. K. (2012). <italic>Trends Pharmacol. Sci.</italic>
<bold>33</bold>, 261–267.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Winn, M. D. <italic>et al.</italic> (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Winter, G. (2010). <italic>J. Appl. Cryst.</italic>
<bold>43</bold>, 186–190.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Winter, G. &amp; McAuley, K. E. (2011). <italic>Methods</italic>, <bold>55</bold>, 81–93.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Conceptual design of <italic>XChemExplorer</italic>. The diagram illustrates the supported workflow and the interplay of database and filesystem. User input is mediated through the graphical user interface.</p>
    </caption>
    <graphic xlink:href="d-73-00267-fig1"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Overview and design principle of the <italic>XChemExplorer</italic> GUI. The Overview tab shows the contents of the database. The general design principle is the same for all tabs: information and parameters which are specific for each milestone during structure solution are displayed in the centre. The coloured action boxes at the bottom of the window bundle a set of commands that are relevant for each stage of the structure-determination process. The inset gives an example of the different processes that can be executed in the Maps &amp; Restraints tab. The grey button at the bottom left corner is for refreshing the tables of the GUI. Status messages and a progress bar in the lowermost part of the window provide feedback and inform about ongoing processes.</p>
    </caption>
    <graphic xlink:href="d-73-00267-fig2"/>
  </fig>
  <fig id="fig3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>The Datasets panel which allows users to review data collected at the Diamond Light Source. Selected data-collection statistics, crystal images after alignment and a drop-down widget for annotating the outcome of the experiment are displayed for each crystal. The upper red box shows a selection of the various data-collection outcome annotations. The Show Details checkbox is for displaying an extended view of the output from all auto-processing pipelines; the lower red box shows detailed data-collection statistics for different auto-processing pipelines. It is possible to manually choose any outcome from the respective table.</p>
    </caption>
    <graphic xlink:href="d-73-00267-fig3"/>
  </fig>
  <fig id="fig4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>The Maps &amp; Restraints panel which allows users to calculate initial maps and generate ligand coordinates and restraints. The central table gives an overview of all data sets that can be used for initial map calculation with <italic>DIMPLE</italic>. <italic>R</italic>
<sub>cryst</sub> and <italic>R</italic>
<sub>free</sub> are displayed if initial refinement has already taken place. Like all other tables, the table can be sorted by any of the displayed columns. <italic>XCE</italic> tries to automatically assign a suitable reference file for input into <italic>DIMPLE</italic>. The drop-down menu displays the currently selected reference file, but it is possible to select any other file from the list. The last three columns indicate the status of each data set, <italic>i.e.</italic> whether they were already subject to analysis and inspection with the <italic>PanDDA</italic> algorithm. Ranges of rows can be selected and marked for map calculation with <italic>DIMPLE</italic>.</p>
    </caption>
    <graphic xlink:href="d-73-00267-fig4"/>
  </fig>
  <fig id="fig5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>The PanDDA panel allows the configuration of calculations by the <italic>PanDDA</italic> software. (<italic>a</italic>) The left table provides an overview of all the data sets that are available for input into <italic>PanDDA</italic>; the right side displays the currently selected input parameters for <italic>pandda.analyse</italic>. These are relevant mostly when multiple crystal forms are available. (<italic>b</italic>) <italic>PanDDA</italic> data-set summary. (<italic>c</italic>) <italic>PanDDA</italic> inspection summary.</p>
    </caption>
    <graphic xlink:href="d-73-00267-fig5"/>
  </fig>
  <fig id="fig6" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>The <italic>XCE</italic> Refinement interface for accelerated model building and refinement. The small panel on the left side shows how <italic>Coot</italic> and the new dialogue work in relation to each other; the middle and right side show an extended image of the dialogue and a schematic outline of its arrangement. The dialogue displays global and ligand-specific quality metrics of the currently loaded structure as well as a two-dimensional picture of the ligand and a radar plot summarizing a set of ligand-validation scores. <italic>XCE</italic> will automatically display 2<italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> and <italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> maps as well as <italic>PanDDA</italic> event maps when they are available. The arrow buttons and a drop-down menu in the control panel are used to step through the data sets. It also allows the refinement stage of a given structure and the confidence of the modelled ligand to be assigned. All structures which are part of the project can be handled within a single instance of <italic>Coot</italic>.</p>
    </caption>
    <graphic xlink:href="d-73-00267-fig6"/>
  </fig>
  <fig id="fig7" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Data sharing <italic>via</italic> HTML export. Results generated with <italic>XCE</italic> can be exported as an HTML document, which can be put on a web server and shared with other scientists. The figure shows the contents of the summary page; details of each modelled ligand and download links are displayed on one line. Additionally, an interactive <italic>IcmJS</italic> plugin (Molsoft LLC) allows display of the ligand-binding site and the respective <italic>PanDDA</italic> event map.</p>
    </caption>
    <graphic xlink:href="d-73-00267-fig7"/>
  </fig>
</floats-group>
