<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Biomed Sci</journal-id>
    <journal-title>Journal of Biomedical Science</journal-title>
    <issn pub-type="ppub">1021-7770</issn>
    <issn pub-type="epub">1423-0127</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2711065</article-id>
    <article-id pub-id-type="publisher-id">1423-0127-16-52</article-id>
    <article-id pub-id-type="pmid">19486537</article-id>
    <article-id pub-id-type="doi">10.1186/1423-0127-16-52</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A novel tool for individual haplotype inference using mixed data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Chen-Pang</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>michael@ibms.sinica.edu.tw</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Fann</surname>
          <given-names>Cathy SJ</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>csjfann@ibms.sinica.edu.tw</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Institute of Public Health, National Yang-Ming University, Taipei, Taiwan</aff>
    <aff id="I2"><label>2</label>Institute of Biomedical Sciences, Academia Sinica, Taipei, Taiwan</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <volume>16</volume>
    <issue>1</issue>
    <fpage>52</fpage>
    <lpage>52</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.jbiomedsci.com/content/16/1/52"/>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>2</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>6</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â© 2009 Lin and Fann; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Lin and Fann; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Lin
               Chen-Pang
               
               michael@ibms.sinica.edu.tw
            </dc:author><dc:title>
            A novel tool for individual haplotype inference using mixed data
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>Journal of Biomedical Science 16(1): 52-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1423-0127(2009)16:1&#x0003c;52&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1423-0127</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>In many studies, researchers may recruit samples consisting of independent trios and unrelated individuals. However, most of the currently available haplotype inference methods do not cope well with these kinds of mixed data sets.</p>
      </sec>
      <sec sec-type="methods">
        <title>Methods</title>
        <p>We propose a general and simple methodology using a mixture of weighted multinomial (MIXMUL) approach that combines separate haplotype information from unrelated individuals and independent trios for haplotype inference to the individual level.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The new MIXMUL procedure improves over existing methods in that it can accurately estimate haplotype frequencies from mixed data sets and output probable haplotype pairs in optimized reconstruction outcomes for all subjects that have contributed to estimation. Simulation results showed that this new MIXMUL procedure competes well with the EM-based method, i.e. FAMHAP, under a few assumed scenarios.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The results showed that MIXMUL can provide accurate estimates similar to those haplotype frequencies obtained from FAMHAP and output the probable haplotype pairs in the most optimal reconstruction outcome for all subjects that have contributed to estimation. If available data consist of combinations of unrelated individuals and independent trios, the MIXMUL procedure can be used to estimate the haplotype frequencies accurately and output the most likely reconstructed haplotype pairs of each subject in the estimation.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Since the completion of the International HapMap Project, millions of single nucleotide polymorphisms (SNPs) and haplotype information have been deposited into public databases for studies in the fields of population genetics, evolutionary genetics, and complex disease gene mapping. Several studies have demonstrated that haplotypes can provide more power than single markers in detecting associations [<xref ref-type="bibr" rid="B1">1</xref>]. However, haplotype information cannot usually be obtained directly from unphased genotype data. It is possible to determine haplotypes using molecular experimental techniques, but such approaches are still expensive and labor intensive. Therefore, haplotype determination from genotype data by statistical methods is used if the estimation is done accurately.</p>
    <p>The population-based case-control design is a commonly used design in genetic association studies, in which unrelated cases and controls are collected and compared with respect to the frequencies of some haplotypes. An advantage of this study design is that the implementation is very convenient, since recruiting unrelated individuals is both time- and cost-effective.</p>
    <p>One potential disadvantage for the population-based study is due to population stratification which may make an excess of false-positive results. To avoid a deceptive association confounded by population stratification, the family-based designs using relatives of the cases as controls have been proposed. The trio design is the simplest family design, where both parents of the affected subjects are included as family controls. When genotype data for parents are not available, such as in the study of late onset diseases, the unaffected siblings can be included instead. Recruitment, which is the primary disadvantage of family design, usually requires more resources in terms of time and money [<xref ref-type="bibr" rid="B2">2</xref>].</p>
    <p>A few studies have drawn attention to the association study using both family-based and population-based controls [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. One motivation for this type of study is the supplementation of case-parent trios with additional unrelated controls, if available, to ensure sufficient power to detect association, since parental controls may be hard to recruit, especially for late-onset diseases.</p>
    <p>Several statistical and computational approaches have been developed for the inference of haplotype phase from genotype data of unrelated individuals or independent trios, but most programs cannot deal with family-based and population-based controls at the same time. Becker and Knapp [<xref ref-type="bibr" rid="B5">5</xref>] proposed a program FAMHAP, which calculates maximum likelihood estimates of haplotype frequencies from general nuclear families via the EM-algorithm. One feature of this program is the possibility of estimating haplotype frequencies from data sets consisting of a combination of unrelated individuals and nuclear families. Nevertheless, this program cannot output the most likely haplotypes pairs of each subject.</p>
    <p>In this work, using a MIXture of weighted MULtinomial (MIXMUL) approach, a new procedure based on PHASE [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>] is proposed for dealing with mixed data sets to estimate the haplotype frequencies and to reconstruct the most likely haplotype pairs of each subject contributed into estimation. We evaluated the MIXMUL procedure with respect to the accuracy of haplotype frequency estimation for the combination data sets. We also considered a few factors, including genotyping error and extent of linkage disequilibrium. The new MIXMUL procedure competes well with the likelihood-based method FAMHAP of Becker &amp; Knapp, which is also applicable to mixed data sets. While FAMHAP can only output haplotype frequency estimates, the MIXMUL procedure can further provide a list of the most probable haplotype pairs for every subject in the mixed data sets.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>MIXture of weighted MULtinomial (MIXMUL) approach</title>
      <p>We assumed Hardy-Weinberg equilibrium for haplotypes in all subjects and throughout this study and considered a sample consisting of <italic>n</italic><sub>1 </sub>unrelated individuals and <italic>n</italic><sub>2 </sub>independent trios. For each subject in the mixed sample, we observed <italic>q </italic>SNPs with alleles 1 and 2 in a specific region of the genome, and <italic>Q </italic>possible haplotypes, with <italic>Q </italic>â¤ 2<sup><italic>q</italic></sup>. Let <italic>H </italic>= <italic>H</italic><sub>1</sub>, <italic>H</italic><sub>2</sub>, â¯, <italic>H</italic><sub><italic>Q </italic></sub>denote the <italic>Q </italic>possible haplotypes, and a vector <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i1.gif"/></inline-formula> was used to describe the unknown haplotype frequencies, with <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i2.gif"/></inline-formula>.</p>
      <p>Assuming that the haplotypes from the <italic>n</italic><sub>1 </sub>unrelated individuals followed a multinomial distribution, the multinomial distribution model was defined as</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1423-0127-16-52-i3.gif"/>
        </disp-formula>
      </p>
      <p>Let <italic>x</italic><sub><italic>i </italic></sub>be the number of times that haplotype <italic>H</italic><sub><italic>i </italic></sub>occurs, and the vector <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i4.gif"/></inline-formula> be the vector of counts for all haplotypes, with <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i5.gif"/></inline-formula> being the total number of haplotypes. Let <italic>Î±</italic><sub><italic>i </italic></sub>be the mean haplotype frequency for haplotype <italic>i</italic>, and <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i6.gif"/></inline-formula> be the vector of haplotype frequencies.</p>
      <p>Because only parents of each trio would contribute to the estimation, the haplotypes from the founders of the <italic>n</italic><sub>2 </sub>independent trios also followed a multinomial distribution defined as</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1423-0127-16-52-i7.gif"/>
        </disp-formula>
      </p>
      <p>Where <italic>Î²</italic><sub><italic>j </italic></sub>is the mean haplotype frequency for haplotype <italic>j</italic>, and <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i8.gif"/></inline-formula> is the vector of haplotype frequencies. Let <italic>y</italic><sub><italic>i </italic></sub>be the number of times haplotype <italic>H</italic><sub><italic>i </italic></sub>occurs within the <italic>n</italic><sub>2 </sub>trios, and the vector <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i9.gif"/></inline-formula> be the vector of counts for all haplotypes.</p>
      <p>With a weight parameter <italic>Î»</italic>, we combined these two sets of haplotype frequencies, <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i10.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i11.gif"/></inline-formula>. Thus, the distribution specified by the mixture of weighted multinomial model is</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1423-0127-16-52-i12.gif"/>
        </disp-formula>
      </p>
      <p>where <italic>z</italic><sub><italic>i </italic></sub>is the total number of times haplotype <italic>H</italic><sub><italic>i </italic></sub>occurs, and the vector <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i13.gif"/></inline-formula> is the vector of counts for all haplotypes. Thus, we obtained <italic>z</italic><sub><italic>i </italic></sub>as the sum of the number of times that haplotype <italic>H</italic><sub><italic>i </italic></sub>occurs in <italic>n</italic><sub>1 </sub>unrelated individuals and <italic>n</italic><sub>2 </sub>independent trios i.e. <italic>z</italic><sub><italic>i </italic></sub>= <italic>x</italic><sub><italic>i </italic></sub>+ <italic>y</italic><sub><italic>i</italic></sub>. Clearly, the multinomial with haplotype frequency vector <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i14.gif"/></inline-formula> specified the same distribution [<xref ref-type="bibr" rid="B8">8</xref>].</p>
    </sec>
    <sec>
      <title>Simulation study</title>
      <p>We examined the performance of the proposed MIXMUL procedure via simulation studies. The simulations were conducted under settings where the combining of the data is suitable. We generated three dense multi-locus genotype data sets using the program SNaP [<xref ref-type="bibr" rid="B9">9</xref>] based on the different haplotype frequency distributions provided from three authentic data sets. The first simulated data set was based on the five SNPs within the N-acetyltransferase 2 gene (<italic>NAT2</italic>) described by Xu <italic>et al </italic>[<xref ref-type="bibr" rid="B10">10</xref>]. The haplotype frequencies of the five SNPs were over the 850-bp fragment of <italic>NAT2 </italic>sequenced from each of the 81 individuals to resolve the haplotypes for both chromosomes of each individual. The second simulated data set was the eight SNP haplotype frequencies within the gene <italic>ARHGDIB </italic>on chromosome 12, which were identified from 44 unrelated individuals [<xref ref-type="bibr" rid="B11">11</xref>]. The third haplotype frequency distribution was based on the ten SNPs from the original Oxford ACE data described by Zhang <italic>et al </italic>[<xref ref-type="bibr" rid="B12">12</xref>]. The ACE data set contained genotypes of 666 individuals with ten SNPs in strong linkage disequilibrium (LD), spanning a very short region (26 kb) within the gene <italic>ACE</italic>.</p>
      <p>First, we used PHASE to obtain the count of each haplotype in the "best" reconstruction for the unrelated individuals, i.e. <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i4.gif"/></inline-formula>. Then we could obtain an estimated haplotype frequency vector <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i15.gif"/></inline-formula> by <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i16.gif"/></inline-formula>. Separately, we used PHASE to obtain the count of each haplotype for the independent trios to form the vector of counts for all haplotypes in these trio families, <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i9.gif"/></inline-formula>. A vector of estimated haplotype frequencies <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i17.gif"/></inline-formula> can be obtained by <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i18.gif"/></inline-formula>. We then used our proposed MIXMUL procedure to calculate the estimated mixture haplotype frequency vector <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i19.gif"/></inline-formula> as</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1423-0127-16-52-i20.gif"/>
        </disp-formula>
      </p>
      <p>The weight parameter <italic>Î» </italic>was estimated by the maximum likelihood method to obtain the estimator <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i21.gif"/></inline-formula>. Given a weight parameter estimate of <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i21.gif"/></inline-formula>, a set of estimated haplotype frequencies were obtained by MIXMUL. Based on the set of estimated frequencies for the mixed data set, the MIXMUL procedure can further output the best reconstructed haplotype pairs of each subject contributed into estimation.</p>
    </sec>
    <sec>
      <title>Comparing MIXMUL with FAMHAP</title>
      <p>The MIXMUL procedure was developed to deal with mixed data sets consisting of unrelated individuals and independent trios for haplotype frequency estimation and haplotype inference. Using the MIXMUL approach, the weight parameter <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i21.gif"/></inline-formula> was obtained by maximizing the likelihood function of a mixture of two independent multinomial distributions in order to perform haplotype frequency estimation for the mixed data sets. We examined the accuracy for haplotype frequency estimation of the proposed MIXMUL procedure and compared the performance with that of the EM-based FAMHAP proposed by Becker &amp; Knapp, which can also estimate haplotype frequencies for mixed data sets. We set the mixed data sets consisting of 20 unrelated individuals and 5, 10, 15, 20, 25, or 30 independent trios, respectively. Because only parents of each trio would contribute to the estimation, these combinations correspond to a total number of subjects in estimation of 30, 40, 50, 60, 70, and 80, respectively.</p>
      <p>To evaluate the performance of MIXMUL and FAMHAP in the presence of genotyping error, we used the ARHGDIB data to generate the simulated data in the existence of genotyping error at the levels of the 0.025, 0.05, and 0.1. The error rates range from 0.025 to 0.1 as suggested by Tintle et al. [<xref ref-type="bibr" rid="B13">13</xref>] and Cheng and Lin [<xref ref-type="bibr" rid="B14">14</xref>]. To assess the performance of MIXMUL with weak LD extent, we simulated a data set based on eight SNPs with 15 equally frequent haplotypes and average <italic>D' </italic>= 0.3782 for comparing with FAMHAP. On the other hand, we used the ARHGDIB data (average <italic>D' </italic>= 0.9051) and simulated 30 unrelated individuals and 10 independent trios, respectively, to evaluate the estimation accuracy of rare haplotype frequencies (haplotype frequency &lt; 10%) contingent on the same number of subjects utilized.</p>
    </sec>
    <sec>
      <title>Measurement of accuracy</title>
      <p>To evaluate the quality of haplotype frequency estimation, the indices <italic>I</italic><sub><italic>F </italic></sub>and <italic>I</italic><sub><italic>H </italic></sub>proposed by Excoffier and Slatkin [<xref ref-type="bibr" rid="B15">15</xref>] were used. The first was a similarity measure <italic>I</italic><sub><italic>F </italic></sub>which describes how close the estimated haplotype frequencies are to the actual frequencies and is defined as one minus half of the sum of absolute differences between the true and estimated haplotype frequencies, i.e.,</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1423-0127-16-52-i22.gif"/>
        </disp-formula>
      </p>
      <p>where <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i23.gif"/></inline-formula> is the estimated frequency of the <italic>i</italic>-th haplotype, and <italic>Î¸</italic><sub><italic>i </italic></sub>is the true haplotype frequency. <italic>I</italic><sub><italic>F </italic></sub>ranges between 0 and 1 (a value of 1 indicates that the actual and estimated frequencies are identical).</p>
      <p>Another measurement <italic>I</italic><sub><italic>H </italic></sub>was used to quantify the effectiveness of computational algorithms for haplotype reconstruction. <italic>I</italic><sub><italic>H </italic></sub>compares the number of haplotypes in a sample and the number of haplotypes detected by an algorithm. In a sample with <italic>N </italic>subjects, the minimum frequency of every true haplotype has to be greater than or equal to <inline-formula><inline-graphic xlink:href="1423-0127-16-52-i24.gif"/></inline-formula>, which could be used as a lower bound threshold value for determining the existence of a haplotype. Based on this,</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1423-0127-16-52-i25.gif"/>
        </disp-formula>
      </p>
      <p>where <italic>k</italic><sub><italic>true </italic></sub>is the number of true haplotypes, <italic>k</italic><sub><italic>found </italic></sub>is the number of identified haplotypes with frequencies above the threshold value, and <italic>k</italic><sub><italic>missed </italic></sub>is the number of true haplotypes not identified. The measure <italic>I</italic><sub><italic>H </italic></sub>also varies between 0 (when none of the true haplotypes is identified) and 1 (when the haplotypes identified are exactly the same as the true haplotypes).</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>The plots in Figure <xref ref-type="fig" rid="F1">1</xref> show accuracy comparison of haplotype frequency estimations between MIXMUL and FAMHAP using NAT2 data (panels a and b), ARHGDIB data (panels c and d), and ACE data (panels e and f). Compared to the EM-based program FAMHAP, results were consistent with the notion that MIXMUL has comparable accuracy for haplotype frequency estimation with FAMHAP. Moreover, MIXMUL can output the most likely reconstructed haplotype pairs for every subject into estimation, while FAMHAP only output overall estimated haplotype frequencies.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Performance comparisons of MIXMUL and FAMHAP</bold>. The upper panels (a and b) show the average measures of accuracy based on the NAT2 data. The middle panels (c and d) show the average measures of accuracy based on the ARHGDIB data. The lower panels (e and e) show the average measures of accuracy based on the ACE data. The left panels (a, c and e) and the right panels (b, d and f) show the similarity indices <italic>I</italic><sub><italic>G </italic></sub>and <italic>I</italic><sub><italic>H</italic></sub>, respectively, between the estimated and the actual haplotype frequencies.</p>
      </caption>
      <graphic xlink:href="1423-0127-16-52-1"/>
    </fig>
    <p>It is known that genotyping error can severely affect the performance of haplotype frequency estimation algorithms. Because these results were similar for each level of the genotyping error rate, Figure <xref ref-type="fig" rid="F2">2</xref> only shows the results for genotyping error rate of 0.05. They indicated that in most cases, the accuracy using MIXMUL was slightly better than that obtained from using FAMHAP.</p>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>Performance comparison when genotyping error rate is 0.05</bold>. The graph shows the accuracy indices <italic>I</italic><sub><italic>G </italic></sub>and <italic>I</italic><sub><italic>H </italic></sub>between MIXMUL and FAMHAP based on the ARHGDIB data given the genotyping error rate of 0.05.</p>
      </caption>
      <graphic xlink:href="1423-0127-16-52-2"/>
    </fig>
    <p>The extent of linkage disequilibrium (LD) between SNP markers also has an important effect on haplotype-inference accuracy. We evaluated the performance of MIXMUL under a scenario of weak LD extent. Plots of the accuracy measures for the simulated data set were shown in Figure <xref ref-type="fig" rid="F3">3</xref>. It can be seen that MIXMUL performed well with FAMHAP even when the LD extent was weak.</p>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>Performance comparison when LD extent is weak</bold>. The graph shows the accuracy indices <italic>I</italic><sub><italic>G </italic></sub>and <italic>I</italic><sub><italic>H </italic></sub>between MIXMUL and FAMHAP based on the simulated data when the extent of LD is weak (average <italic>D' </italic>= 0.3782).</p>
      </caption>
      <graphic xlink:href="1423-0127-16-52-3"/>
    </fig>
    <p>Most haplotype inference methods can estimate common haplotypes (haplotype frequency &gt; 10%) very accurately when the LD content across the constituent loci is strong, but the performances were lower in estimating rare haplotypes (haplotype frequency &lt;10%). Thus, we used the ARHGDIB data and focused on the estimation accuracy of rare haplotype frequencies contingent on the same number of subjects utilized. Our results showed that the measure <italic>I</italic><sub><italic>F </italic></sub>of 30 unrelated individuals and 10 independent trios were 0.9217 and 0.9720, respectively. Indeed, for rare haplotypes inference, taking family information into account will increase the frequency estimation accuracy.</p>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Haplotype inference for a large number of tightly linked markers through close relatives has drawn much attention in recent years. Several novel methods and programs have been developed. However, it's likely that researchers collected samples consisting of independent trios and unrelated individuals. The MIXMUL procedure proposed here can be conveniently and efficiently utilized to deal with such data sets for haplotype inference. The MIXMUL procedure will also output the most likely reconstructed haplotype pairs of each subject contributed into the estimation.</p>
    <p>The current version of the PHASE program (version 2.1) can reconstruct haplotypes from population-based or trio-based genotype data respectively, but it cannot handle mixed data sets consisting of both. On the other hand, the FAMHAP program is able to deal with mixed data sets, however, this program does not provide haplotype inference to the individual level; it only provides overall haplotype frequencies. Based on the outputs of the PHASE program, we proposed the MIXMUL procedure that deals with mixed data sets and infer most probable haplotypes to the individual level by using a weighted function.</p>
    <p>Becker and Knapp proposed a program FAMHAP, which calculates maximum likelihood estimates of haplotype frequencies from general nuclear families with an arbitrary number of children via the EM-algorithm. This program can estimate haplotype frequencies from data sets consisting of a combination of unrelated individuals and nuclear families. However, in our simulation, we compared some factors that would affect haplotype frequency estimation, including number of SNP markers, genotyping error rates, and extent of LD. On the basis of our results, the accuracy of haplotype frequency estimation for MIXMUL competes well with FAMHAP when considering all these factors. Furthermore, MIXMUL can provide not only the accurate haplotype frequency estimates, but also the most likely reconstructed haplotype pairs of each subject.</p>
    <p>As suggested by other studies [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>], including family information improved the accuracy of haplotype estimation. We examined whether adding families to unrelated individual data could improve the accuracy of haplotype frequency estimation by using MIXMUL. On the basis of our results, the accuracy of haplotype frequency estimation by MIXMUL showed that taking family information or partial family information into account did improve the accuracy of haplotype frequency estimation. However, the accuracy of using more than 60 unrelated individuals for haplotype inference was almost the same as those from using trio or mixed data.</p>
    <p>A systematic approach was not used in this study to address the issues because the true haplotype frequencies (derived from experiments) were more suitable for comparison purposes with inferred haplotype frequencies using <italic>I</italic><sub><italic>F </italic></sub>and <italic>I</italic><sub><italic>H </italic></sub>calculated from MIXMUL and FAMHAP. Thus, we selected three published data sets available online where the true haplotype frequencies were derived from experiments. We carried out simulations based on these known frequencies and the number of SNPs ranged from 5 ~10 with linkage disequilibrium coefficient (<italic>D'</italic>) ranged from 0.8522 ~0.9341. The levels of genotyping error rates were 0.025, 0.05 and 0.1 as suggested by other studies [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. By using this approach, we obtained approximate information about the impact of these factors in assessing accuracy in comparison between MIXMUL and FAMHAP.</p>
    <p>Incomplete trios (1 parent, one child) in mixed data sets can be analyzed by MIXMUL by setting one parent in a trio as missing. We used the ARHGDIB data to conduct 100 simulations to evaluate the impact of using incomplete trios. The results showed that when using only incomplete trios in the mixed data sets, the accuracy of haplotype frequencies estimation was lower than that obtained from using complete trios (2 parents, one child) because the degree of family information was deficient. For example, given 10 unrelated individuals and 5 incomplete trios, <italic>I</italic><sub><italic>F </italic></sub>was 0.769 and it was 0.825 if these trios were complete. <italic>I</italic><sub><italic>H </italic></sub>was 0.805 for the former and 0.825 for the later. Given 5 unrelated individuals and 40 incomplete trios, <italic>I</italic><sub><italic>F </italic></sub>was 0.925 and it was 0.958 if these trios were complete; <italic>I</italic><sub><italic>H </italic></sub>was 0.928 for the former and 0.985 for the later. The differences of accuracy measurements between using incomplete and complete trios were smaller when the number of subjects used in estimation increased.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>Haplotypes capture LD information in chromosomal regions descended from ancestral chromosomes. Such information is of considerable interest in population genetics and genetic epidemiology studies. With widespread applications of new generations of genotyping techniques, especially high-density SNP arrays, the human genome will eventually be unlocked by linking haplotype information to biomarker and phenotypic data. In current association studies, it is likely that researchers may recruit mixed samples consisting of independent trios and unrelated individuals. However, most existing methods for haplotype inference and frequency estimation cannot cope with these kinds of mixed data sets. Although the EM-based FAMHAP of Becker &amp; Knapp can deal with such kind of data, it cannot reconstruct the haplotype pairs of the individual level. Therefore, in this study we developed the MIXMUL procedure based on the program PHASE to deal with mixed data sets. According to our results, MIXMUL can provide accurate estimates for haplotype frequencies as FAMHAP and further output the probable haplotype pairs in the most optimal reconstruction outcome for every subject that have contributed to estimation. If available data consist of combinations of unrelated individuals and independent trios, the proposed MIXMUL procedure can be used to perform haplotype frequency estimation to obtain accurate haplotype frequency estimates in the mixed sample as well as to output the most likely reconstructed haplotype pairs of each subject into the estimation for further haplotype level association analysis. The MIXMUL procedure is available for download from <ext-link ext-link-type="uri" xlink:href="http://www.csjfann.ibms.sinica.edu.tw/EAG/program/programlist.htm"/></p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>CL carried out this study and drafted the manuscript. CSJF conceived of the study, and participated in its design and coordination and helped to draft the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This project was partially funded by two grants from the Taiwan National Science Council (NSC 94-2314-B-001-009 and NSC 96-2628-B-001-015-MY2).</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Efficient multilocus association mapping for whole genome association studies using localized haplotype clustering</article-title>
        <source>Genet Epidemiol</source>
        <year>2007</year>
        <volume>31</volume>
        <fpage>365</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="pmid">17326099</pub-id>
        <pub-id pub-id-type="doi">10.1002/gepi.20216</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Family-based designs in the age of large-scale gene-association studies</article-title>
        <source>Nat Rev Genet</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>385</fpage>
        <lpage>394</lpage>
        <pub-id pub-id-type="pmid">16619052</pub-id>
        <pub-id pub-id-type="doi">10.1038/nrg1839</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagelkerke</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Hoebee</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Teunis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kimman</surname>
            <given-names>TG</given-names>
          </name>
        </person-group>
        <article-title>Combining the transmission disequilibrium test and case-control methodology using generalized logistic regression</article-title>
        <source>Eur J Hum Genet</source>
        <year>2004</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>964</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="pmid">15340361</pub-id>
        <pub-id pub-id-type="doi">10.1038/sj.ejhg.5201255</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kazeem</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Farrall</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Integrating case-control and TDT studies</article-title>
        <source>Ann Hum Genet</source>
        <year>2005</year>
        <volume>69</volume>
        <fpage>329</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="pmid">15845037</pub-id>
        <pub-id pub-id-type="doi">10.1046/J.1469-1809.2005.00156.x</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Knapp</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Maximum-likelihood estimation of haplotype frequencies in nuclear families</article-title>
        <source>Genet Epidemiol</source>
        <year>2004</year>
        <volume>27</volume>
        <fpage>21</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="pmid">15185400</pub-id>
        <pub-id pub-id-type="doi">10.1002/gepi.10323</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A new statistical method for haplotype reconstruction from population data</article-title>
        <source>Am J Hum Genet</source>
        <year>2001</year>
        <volume>68</volume>
        <fpage>978</fpage>
        <lpage>989</lpage>
        <pub-id pub-id-type="pmid">11254454</pub-id>
        <pub-id pub-id-type="doi">10.1086/319501</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Accounting for decay of linkage disequilibrium in haplotype inference and missing data imputation</article-title>
        <source>Am J Hum Genet</source>
        <year>2005</year>
        <volume>76</volume>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="pmid">15700229</pub-id>
        <pub-id pub-id-type="doi">10.1086/428594</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yantis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Analyses of multinomial mixture distributions: new tests for stochastic of cognition and action</article-title>
        <source>Psychol Bull</source>
        <year>1991</year>
        <volume>110</volume>
        <issue>2</issue>
        <fpage>350</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="pmid">1946869</pub-id>
        <pub-id pub-id-type="doi">10.1037/0033-2909.110.2.350</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nothnagel</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Simulation of LD block-structured SNP haplotype data and its use for the analysis of case-control data by supervised learning methods</article-title>
        <source>Am J Hum Genet</source>
        <year>2002</year>
        <volume>71</volume>
        <issue>Suppl 4</issue>
        <fpage>A2363</fpage>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cantone</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Crocker</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Zaykin</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Purvis</surname>
            <given-names>IJ</given-names>
          </name>
        </person-group>
        <article-title>Effectiveness of computational methods in haplotype prediction</article-title>
        <source>Hum Genet</source>
        <year>2002</year>
        <volume>110</volume>
        <fpage>148</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="pmid">11935321</pub-id>
        <pub-id pub-id-type="doi">10.1007/s00439-001-0656-4</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reich</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Cargill</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ireland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Richter</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Lavery</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kouyoumjian</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farhadian</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Linkage disequilibrium in the human genome</article-title>
        <source>Nature</source>
        <year>2001</year>
        <volume>411</volume>
        <fpage>199</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="pmid">11346797</pub-id>
        <pub-id pub-id-type="doi">10.1038/35075590</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A comparison of several methods for haplotype frequency estimation and haplotype reconstruction for tightly linked markers from general pedigrees</article-title>
        <source>Genet Epidemiol </source>
        <year>2006</year>
        <volume>30</volume>
        <issue>5</issue>
        <fpage>423</fpage>
        <lpage>437</lpage>
        <pub-id pub-id-type="pmid">16685719</pub-id>
        <pub-id pub-id-type="doi">10.1002/gepi.20154</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tintle</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Ahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mendell</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Finch</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Characteristics of replicated single-nucleotide polymorphism genotypes from COGA: Affymetrix and Center for Inherited Disease Research</article-title>
        <source>BMC Genet</source>
        <year>2005</year>
        <volume>30</volume>
        <issue>6 Suppl 1</issue>
        <fpage>S154</fpage>
        <pub-id pub-id-type="pmid">16451615</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2156-6-S1-S154</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>KF</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Simultaneously correcting for population stratification and for genotyping error in case-control association studies</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <issue>4</issue>
        <fpage>726</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="pmid">17846998</pub-id>
        <pub-id pub-id-type="doi">10.1086/520962</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Excoffier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Slatkin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Maximum-likelihood estimation of molecular haplotype frequencies in a diploid population</article-title>
        <source>Mol Biol Evol</source>
        <year>1995</year>
        <volume>12</volume>
        <fpage>921</fpage>
        <lpage>927</lpage>
        <pub-id pub-id-type="pmid">7476138</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Knapp</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Efficiency of haplotype frequency estimation when nuclear family information is included</article-title>
        <source>Hum Hered</source>
        <year>2002</year>
        <volume>54</volume>
        <fpage>45</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="pmid">12446986</pub-id>
        <pub-id pub-id-type="doi">10.1159/000066692</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaid</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Relative efficiency of ambiguous vs. directly measured haplotype frequencies</article-title>
        <source>Genet Epidemiol</source>
        <year>2002</year>
        <volume>23</volume>
        <fpage>426</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="pmid">12432508</pub-id>
        <pub-id pub-id-type="doi">10.1002/gepi.10184</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
