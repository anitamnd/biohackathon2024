<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9825501</article-id>
    <article-id pub-id-type="pmid">36243967</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkac874</article-id>
    <article-id pub-id-type="publisher-id">gkac874</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Database Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Aquila: a spatial omics database and analysis platform</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0394-9735</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Yimin</given-names>
        </name>
        <aff><institution>Cancer Centre, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Centre for Precision Medicine Research and Training, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>MoE Frontiers Science Center for Precision Oncology, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Faculty of Health Sciences, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6159-8160</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Yitian</given-names>
        </name>
        <aff><institution>Cancer Centre, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Centre for Precision Medicine Research and Training, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>MoE Frontiers Science Center for Precision Oncology, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Faculty of Health Sciences, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1549-3499</contrib-id>
        <name>
          <surname>Ding</surname>
          <given-names>Xianting</given-names>
        </name>
        <aff><institution>Institute for Personalized Medicine, School of Biomedical Engineering, Shanghai Jiao Tong University</institution>, <addr-line>Shanghai 200240</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9264-5118</contrib-id>
        <name>
          <surname>Wong</surname>
          <given-names>Koon Ho</given-names>
        </name>
        <aff><institution>Cancer Centre, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Centre for Precision Medicine Research and Training, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>MoE Frontiers Science Center for Precision Oncology, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Faculty of Health Sciences, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8034-2833</contrib-id>
        <name>
          <surname>Cheung</surname>
          <given-names>Edwin</given-names>
        </name>
        <!--echeung@um.edu.mo-->
        <aff><institution>Cancer Centre, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Centre for Precision Medicine Research and Training, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>MoE Frontiers Science Center for Precision Oncology, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <aff><institution>Faculty of Health Sciences, University of Macau</institution>, Taipa 999078, Macau SAR</aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +853 8822 4992; Fax: +853 8822 2933; Email: <email>echeung@um.edu.mo</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>06</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-10-16">
      <day>16</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>51</volume>
    <issue>D1</issue>
    <fpage>D827</fpage>
    <lpage>D834</lpage>
    <history>
      <date date-type="accepted">
        <day>07</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>12</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkac874.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Spatial omics is a rapidly evolving approach for exploring tissue microenvironment and cellular networks by integrating spatial knowledge with transcript or protein expression information. However, there is a lack of databases for users to access and analyze spatial omics data. To address this limitation, we developed Aquila, a comprehensive platform for managing and analyzing spatial omics data. Aquila contains 107 datasets from 30 diseases, including 6500+ regions of interest, and 15.7 million cells. The database covers studies from spatial transcriptome and proteome analyses, 2D and 3D experiments, and different technologies. Aquila provides visualization of spatial omics data in multiple formats such as spatial cell distribution, spatial expression and co-localization of markers. Aquila also lets users perform many basic and advanced spatial analyses on any dataset. In addition, users can submit their own spatial omics data for visualization and analysis in a safe and secure environment. Finally, Aquila can be installed as an individual app on a desktop and offers the RESTful API service for power users to access the database. Overall, Aquila provides a detailed insight into transcript and protein expression in tissues from a spatial perspective. Aquila is available at <ext-link xlink:href="https://aquila.cheunglab.org" ext-link-type="uri">https://aquila.cheunglab.org</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Macau</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004733</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>MYRG2018-00033-FHS</award-id>
        <award-id>MYRG2020-00100-FHS</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Science and Technology Development Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/100015549</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>0011/2019/AKP</award-id>
        <award-id>0137/2020/A3</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Highly complex
biological processes, such as the development of the neurological system or the progression of diseases like diabetes and cancer, are extremely challenging to study due to the heterogeneous cellular nature of tissues and the complex interactions between cells. However, the spatial distribution of cells within tissues is positively related to their function and lineage trajectories (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>). Thus, understanding the spatial organization of tissues and the evolutionary relationship among cells is vital for capturing the different steps of developmental processes and the complete portrait of diseases. The rapid development and adoption of spatial omics technologies recently have accelerated our understanding of these essential processes.</p>
    <p>Many spatial omics technologies have been developed so far, with the majority geared toward interrogating the spatial transcriptome of tissues (<xref rid="B3" ref-type="bibr">3</xref>). Spatial transcriptome methods can be broadly divided into either sequencing- or imaging-based techniques. Sequencing-based techniques capture and preserve spatial gene expression information of tissues by <italic toggle="yes">in situ</italic> hybridizing RNA transcripts onto spatially immobilized arrays of indexed sequences. Visium is currently the most popular sequencing-based tool, although, at present, this technology and similar technologies like Slide-seq (<xref rid="B4" ref-type="bibr">4</xref>) and DBiT-seq (<xref rid="B5" ref-type="bibr">5</xref>) are not yet at single-cell resolution (<xref rid="B6" ref-type="bibr">6</xref>). In contrast, newer techniques such as spatial enhanced resolution omics sequencing (Stereo-seq) (<xref rid="B7" ref-type="bibr">7</xref>), Seq-Scope (<xref rid="B8" ref-type="bibr">8</xref>) and sci-Space (<xref rid="B9" ref-type="bibr">9</xref>) are at single-cell or subcellular resolution. Imaging-based spatial transcriptome technologies include sequential fluorescence <italic toggle="yes">in situ</italic> hybridization (seqFISH) (<xref rid="B10" ref-type="bibr">10</xref>), multiplexed error-robust fluorescence <italic toggle="yes">in situ</italic> hybridization (MERFISH) (<xref rid="B11" ref-type="bibr">11</xref>) and spatially resolved transcript amplicon readout mapping (STARmap) (<xref rid="B12" ref-type="bibr">12</xref>). These technologies require designing fluorescent-labeled probes to hybridize with known RNA targets and a super-resolution microscope to capture the fluorescent signal.</p>
    <p>Besides measuring transcript information, spatial omics technologies can also detect the proteome of tissues (<xref rid="B13" ref-type="bibr">13</xref>). Compared to spatial transcriptome technologies, the throughput of spatial proteomic technologies is currently limited due to the availability of fluorescent or metal-conjugated antibodies required for detecting target proteins. As with spatial transcriptome technologies, spatial proteomic technologies can also be categorized into two main groups. For example, cyclic immunofluorescence (<xref rid="B14" ref-type="bibr">14</xref>) and co-detection by indexing (<xref rid="B15" ref-type="bibr">15</xref>) are imaging-based techniques that measure protein abundance by repeatedly staining tissues with three to five fluorescent-labeled antibodies at a time. In comparison, imaging mass cytometry (IMC) (<xref rid="B16" ref-type="bibr">16</xref>) and mass ion beam imaging (MIBI) (<xref rid="B17" ref-type="bibr">17</xref>) are mass cytometry-based technologies that stain and quantify tissues using a maximum of 40 metal-conjugated antibodies at once.</p>
    <p>Since spatial omics technologies produce a rich amount of data, they have been widely adopted in the scientific field, resulting in many exciting new findings. For example, Stereo-seq has been applied extensively for the spatial–temporal gene expression profiling of early embryonic stages at unprecedented resolution in mice (<xref rid="B7" ref-type="bibr">7</xref>), flies (<xref rid="B18" ref-type="bibr">18</xref>) and zebrafish (<xref rid="B19" ref-type="bibr">19</xref>). In a multimodal study integrating scRNA-seq, Visium and MIBI, Khavari and colleagues examined the spatial architecture of squamous cell carcinoma, revealing a multifaceted immunosuppression mechanism, including the exhaustion of T cells (<xref rid="B20" ref-type="bibr">20</xref>). Recently, IMC was used to map the spatial and temporal landscape of the lung at subcellular resolution during the progression of coronavirus disease 2019 (<xref rid="B21" ref-type="bibr">21</xref>). This study showed that the abundance, hyperactivities, the interplay between different inflammatory cells and structural changes contribute to the poor immune response in the late stage of the disease (<xref rid="B21" ref-type="bibr">21</xref>).</p>
    <p>The recent precipitous expansion of spatial omics has also produced many datasets, and the increase will continue as the technology matures and becomes more widely accessible. A database that users can easily access, visualize and use for analyzing different types of spatial omics datasets is immensely beneficial for the scientific community. Unfortunately, no databases currently provide users with all these features in one complete package. At present, SpatialDB (<xref rid="B22" ref-type="bibr">22</xref>) is the only spatial omics database available, but it hosts only 24 transcriptome datasets, lacks proteomics data and does not support 3D datasets. SpatialDB also does not offer users any type of spatial analysis. While users can turn to software such as Giotto (<xref rid="B23" ref-type="bibr">23</xref>) and Squidpy (<xref rid="B24" ref-type="bibr">24</xref>) to analyze their data, these programs are targeted toward bioinformaticians with programming skills, which are unsuitable for most biologists.</p>
    <p>Thus, we developed Aquila, a combined spatial omics database and analysis platform that supports all types of spatial omics data, including transcriptome and proteome, 2D and 3D, and from different technologies (Figure <xref rid="F1" ref-type="fig">1A</xref>). Aquila currently hosts 107 datasets from 15 technologies with &gt;15.7 million cells. Aquila provides users the visualization of spatial omics data in multiple formats, such as cell maps, expression maps and co-localization of markers (Figure <xref rid="F1" ref-type="fig">1B</xref>). Users can also easily retrieve any dataset and run a repertoire of integrated analyses directly in the same browser, including advanced spatial analyses that typically require coding skills (Figure <xref rid="F1" ref-type="fig">1C</xref>). Furthermore, users can submit spatial omics data of their own to Aquila and perform the same analyses as the datasets found in the database. We address data privacy issues by storing all user datasets locally without uploading them to the remote server. Finally, Aquila can also be installed as an individual application on a desktop through the progressive web application standard.</p>
    <fig position="float" id="F1">
      <label>Figure 1.</label>
      <caption>
        <p>Schematic design of Aquila. (<bold>A</bold>) Various types of spatial omics datasets accessible in Aquila. (<bold>B</bold>) Examples of ROI visualization (i.e. cell map, expression map and co-localization of markers) in 2D and 3D. (<bold>C</bold>) A comprehensive list of spatial analyses with examples of results.</p>
      </caption>
      <graphic xlink:href="gkac874fig1" position="float"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Data collection and preprocessing</title>
      <p>We manually searched for spatial omics-related keywords using PubMed and Google Scholar to acquire publications with relevant datasets. Only publicly available data were collected. To handle the different types of spatial omics data, they were stored in three parts: expression matrix (matrix market format), spatial location and region of interest (ROI) annotation information. For the expression matrix, we filtered out genes or proteins expressed in &lt;100 cells (or spots) and cells (or spots) expressing &lt;1 gene or protein. Any negative expression values were replaced with a minimum value of 0 to ensure all the expression values were non-negative. Afterward, the expression matrix was log transformed as <inline-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm log}( {1 + X} )$\end{document}</tex-math></inline-formula>. The spatial and annotation information was left intact without any transformation. The processing scripts were written in Python using Numpy (<xref rid="B25" ref-type="bibr">25</xref>), Pandas (<xref rid="B26" ref-type="bibr">26</xref>) and Scanpy (<xref rid="B27" ref-type="bibr">27</xref>).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Determining the dimension of ROIs</title>
      <p>Aquila uses the envelope of an ROI as its dimension, which is the maximum boundary of the ROI. For a series of 2D points, the envelope is calculated as <inline-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$[{\rm Min} ( x ){\rm Min} ( y ){\rm Max} ( x ){\rm{Max}}( y )]$\end{document}</tex-math></inline-formula>. This equation is also extended to 3D data.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Mixing colors for co-localization of markers</title>
      <p>Aquila uses the following algorithm to determine mixed colors by combining two or more colors. Colors are represented in RGB color space, with color A as <inline-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {{R}_1, {G}_1, {B}_1} )$\end{document}</tex-math></inline-formula> and color B as <inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {{R}_2, {G}_2, {B}_2} )$\end{document}</tex-math></inline-formula>, and the mixed color result as <inline-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {{R}_{{\rm mix}}, {G}_{{\rm mix}}, {B}_{{\rm mix}}} )$\end{document}</tex-math></inline-formula>. For each channel, the mixing value is calculated as <inline-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${C}_{{\rm mix}} = \sqrt {{{(C_1^2 + C_2^2)}}/{2}}$\end{document}</tex-math></inline-formula>.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Co-expression analysis</title>
      <p>Aquila uses Pearson correlation and Spearman correlation to determine the relationship between the expression of any genes or markers. Users can select 2–50 genes to perform co-expression analysis. This analysis is implemented in Rust for optimized computing pair correlation using <inline-formula><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {{x}_i - \bar{x}} )$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {{y}_i - \bar{y}} )$\end{document}</tex-math></inline-formula> as the kernel for acceleration. Co-expression is calculated as</p>
      <p>
        <inline-formula>
          <tex-math id="M0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$r = \frac{{\mathop \sum \nolimits_{i = 1}^n ( {{x}_i - \bar{x}} )( {{y}_i - \bar{y}} )}}{{\sqrt {\mathop \sum \nolimits_{i = 1}^n {{( {{x}_i - \bar{x}} )}}^2} \sqrt {\mathop \sum \nolimits_{i = 1}^n {{( {{y}_i - \bar{y}} )}}^2} }}.$\end{document}</tex-math>
        </inline-formula>
      </p>
      <p>Spearman correlation has an additional process in which input vectors are ranked by Spearman ranking, and the ranked vectors are then used for subsequent calculations. Users do not need to provide any parameters for this analysis.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Cell distribution pattern analysis</title>
      <p>The cell distribution pattern analysis examines whether cells are distributed randomly, evenly or in a cluster. Aquila offers users three methods to choose from, including the index of dispersion (<xref rid="B28" ref-type="bibr">28</xref>), the Morisita index (<xref rid="B29" ref-type="bibr">29</xref>) and the Clarks–Evans index (<xref rid="B30" ref-type="bibr">30</xref>). For all three methods, the null hypothesis is that points are in a completely random state (Poisson random point process). Each method is tested against the null hypothesis to determine which pattern cells are distributed in an ROI.</p>
      <p>The index of dispersion method uses a sampling window to sample an ROI multiple times randomly. Each time, we obtain the number of cells in a window. <inline-formula><tex-math id="M0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${S}^2$\end{document}</tex-math></inline-formula> is defined as the variance and <inline-formula><tex-math id="M00010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\bar{x}$\end{document}</tex-math></inline-formula> is the mean. The <inline-formula><tex-math id="M00011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\chi }^2$\end{document}</tex-math></inline-formula>-test is used to determine significance. The index value is calculated as<disp-formula><tex-math id="M00012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}I = \frac{{{s}^2}}{{\bar{x}}}.\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>Since Aquila uses circles as sampling windows, users will need to define the radius for the circle and the number of sampling times. By default, Aquila uses one-tenth of the minimum side of the ROI envelope as the radius and samples 1000 times. For each run, the results will be different due to the difference between samplings.</p>
      <p>The Morisita index method is based on quadratic statistics that rasterize an ROI into a grid. The number of points in a square is denoted as <inline-formula><tex-math id="M00013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x$\end{document}</tex-math></inline-formula>. The <inline-formula><tex-math id="M00014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\chi }^2$\end{document}</tex-math></inline-formula>-test is used to determine significance. The index value is calculated as<disp-formula><tex-math id="M00015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}I = n\left[ {\frac{{\sum {x}^2 - \sum x}}{{{{\left( {\sum x} \right)}}^2 - \sum x}}} \right].\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>Users can define the dimension of the grid to control the granularity of the rasterization process. The default setting uses a 10 × 10 grid to rasterize the ROI.</p>
      <p>The Clark–Evans index is a nonparametric statistical method in which the distribution of cells is based on the distance between neighboring points. Here, <inline-formula><tex-math id="M00016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\rho$\end{document}</tex-math></inline-formula> is defined as the density and <inline-formula><tex-math id="M00017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> as the number of individuals.<disp-formula><tex-math id="M00018" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm{\ }}\bar{D} = \frac{{\mathop \sum \nolimits_{i = 1}^n {d}_i}}{n},\end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M00019" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}E \left( D \right) = \frac{1}{{2\sqrt \rho }},\end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M00020" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm SE} \left( D \right) = \frac{{4 - \pi }}{{4\rho \pi }}, \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M00021" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}R = \frac{{\bar{D}}}{{E\left( D \right)}}, \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M00022" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}Z = \frac{{\bar{D} - E\left( D \right)}}{{{\rm SE}\left( D \right)}}. \end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>The index of dispersion, the Morisita index and the Clarks–Evans index are all implemented in Rust.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Ripley’s cell distribution analysis</title>
      <p>Ripley’s <italic toggle="yes">K</italic> function (<xref rid="B31" ref-type="bibr">31</xref>) is a cell distribution pattern analysis that works by calculating the average number of points from different distance intervals. Users need to define the number of intervals for the function. In Aquila, the <italic toggle="yes">K</italic> function and its variants <italic toggle="yes">G</italic>, <italic toggle="yes">F</italic> and <italic toggle="yes">L</italic> are made available by Pointpats (v2.2.0) in the PySAL ecosystem (<xref rid="B32" ref-type="bibr">32</xref>).</p>
    </sec>
    <sec id="SEC2-7">
      <title>Spatial entropy analysis</title>
      <p>Aquila uses two entropy metrics to measure tissue heterogeneity, the Shannon entropy (<xref rid="B33" ref-type="bibr">33</xref>) and Leibovici entropy (<xref rid="B34" ref-type="bibr">34</xref>). Shannon entropy is a classic method for evaluating the chaos of a system. In contrast, Leibovici entropy considers the contribution of spatial information to a system’s entropy. It requires a distance parameter to determine the range of co-occurring events. By default, the distance is one-tenth of the minimum side of the ROI envelope. Shannon entropy is calculated as<disp-formula><tex-math id="M00023" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}H \left( X \right) = - \sum {P}_i\,{{\rm log}}_2\left( {{P}_i} \right),\end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M00024" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${P}_i$\end{document}</tex-math></inline-formula> is defined as the proportion of cell type <inline-formula><tex-math id="M00025" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> in the ROI. Leibovici entropy is determined as<disp-formula><tex-math id="M00026" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}H (Z|d) = \mathop \sum \limits_{r = 1}^{{I}^m} p({z}_r|d){\rm log}\left( {\frac{1}{{p({z}_r|d)}}} \right) ,\end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M00027" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p({z}_r|d)$\end{document}</tex-math></inline-formula> is equal to the proportion of different co-occurring events within the distance condition <inline-formula><tex-math id="M00028" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$d$\end{document}</tex-math></inline-formula>. Spatial entropy analysis is implemented in Rust.</p>
    </sec>
    <sec id="SEC2-8">
      <title>Spatial variable gene analysis</title>
      <p>The spatial expression pattern of a gene may or may not depend on the spatial context. Aquila identifies spatial variable genes using a GPU accelerated version of SpatialDE (<xref rid="B35" ref-type="bibr">35</xref>,<xref rid="B36" ref-type="bibr">36</xref>). The current method for detecting spatial variable genes in a regular ROI on a web server is inefficient and can take more than a few minutes. Due to this limitation, users can select no more than 50 genes per run.</p>
    </sec>
    <sec id="SEC2-9">
      <title>Constructing neighboring networks</title>
      <p>The results from the neighboring network analysis lay the foundation for the following analyses: spatial community, cell centrality, cell–cell interaction, spatial co-expression and spatial autocorrelation. Aquila provides two methods, KD-Tree and Delaunay triangulation, to determine the neighbors of a cell. KD-Tree employs a binary tree structure approach to analyze spatial data, making it an efficient way for spatial queries. Users set two parameters to use this method, the search radius for each cell and the number of nearest neighbors for a cell. Delaunay triangulation is a nonparametric method that can be thought of as filling a discrete set of points (i.e. cells) in a 2D plane with triangles. Each point is used as the vertex of a triangle such that no points lie in the circumcircle of any triangle. Cells are considered neighbors if they are connected to the edge of the triangle. Both methods construct a spatial network and display the results graphically with nodes representing cells and edges as the Euclidean distance between cells. With the network graph, users can examine the quality of the network and determine which cells have neighbors. They can also check the Euclidean distance between cells by hovering over the edges. Both methods are implemented in Rust using Kiddo (v0.2.3) and Delaunator (v1.0.1).</p>
    </sec>
    <sec id="SEC2-10">
      <title>Spatial community analysis</title>
      <p>Tissue phenotyping can be conducted by grouping cells within a local environment as a community (<xref rid="B37" ref-type="bibr">37</xref>). Thus, it is essential to identify these groups of cells that are spatially distinguished. Aquila includes three community detection methods, Leiden (<xref rid="B38" ref-type="bibr">38</xref>), Louvain (<xref rid="B39" ref-type="bibr">39</xref>) and Infomap (<xref rid="B40" ref-type="bibr">40</xref>), for clustering cells based on the above-mentioned neighboring network results. For the Louvain method, a multilevel version was implemented, which has a better computation efficiency than the original (<xref rid="B41" ref-type="bibr">41</xref>). The Leiden method requires users to input a resolution parameter that affects the size of each community. No input parameters are needed for either Louvain or Infomap. These three methods are executed using Python-igraph (v0.9.10).</p>
    </sec>
    <sec id="SEC2-11">
      <title>Cell centrality analysis</title>
      <p>Cell centrality analysis measures the importance of a cell in a network. Aquila provides three ways to determine cell centrality based on ‘degree’, ‘closeness’ and ‘betweenness’ (<xref rid="B42" ref-type="bibr">42</xref>). ‘Degree’ centrality works by counting the number of links connected to a node, while ‘closeness’ centrality is based on calculating the number of times a node acts as a bridge along the shortest path between two other nodes. Finally, ‘betweenness’ centrality measures the average length of the shortest path between a node and all other nodes in the network. Cell centrality analysis is implemented in Python using Python-igraph (v0.9.10).</p>
    </sec>
    <sec id="SEC2-12">
      <title>Cell–cell interaction analysis</title>
      <p>The spatial relationship between each cell type is determined by bootstrapping, a previously described approach used to analyze spatial single-cell data (<xref rid="B43" ref-type="bibr">43</xref>). For each ROI, the cell type identity is randomly reassigned, while the physical location of each cell type remains unchanged. First, a null distribution is generated for the number of cells A in the neighborhood of cell B. This result is derived from several times of bootstrapping. The null distribution is then compared to the actual distribution to determine the significance. A pseudo <italic toggle="yes">P</italic>-value (two-tailed) is calculated by<disp-formula><tex-math id="M00029" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{P}_{{\rm association}} = \frac{{{\rm number}\ {\rm of} \left( {\overline {{\rm simulation}} \ge \overline {{\rm real}} } \right)}}{{{\rm resample}\ {\rm times }+ 1}}, \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M00030" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{P}_{{\rm avoidance}} = \frac{{{\rm number}\ {\rm of} \left( {\overline {{\rm simulation}} \le \overline {{\rm real}} } \right)}}{{{\rm resample}\ {\rm times} + 1}}. \end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>If a <italic toggle="yes">Z</italic>-score is used, the significance is calculated as<disp-formula><tex-math id="M00031" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}z = \frac{{{\rm real} - \overline {{\rm simulation}} }}{\sigma }.\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>The <italic toggle="yes">Z</italic>-score will then be converted into a <italic toggle="yes">P</italic>-value. An interaction result with a <italic toggle="yes">P</italic>-value &lt;0.05 is considered significant. If two cells are likely to occur in each other’s neighborhood, their relationship is considered an association (+1); otherwise, their relationship is classified as avoidance (−1). Users need to define the number of times to perform the bootstrapping (500–2000). The cell–cell interaction analysis is implemented in Rust.</p>
    </sec>
    <sec id="SEC2-13">
      <title>Spatial co-expression analysis</title>
      <p>The spatial co-expression analysis is similar to the co-expression analysis described above, except that here Aquila uses the adjacency list from the neighbor network result to construct an expression vector. For example, the expression of marker A is <inline-formula><tex-math id="M00032" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{ {{A}_1,{A}_2,{A}_3, \ldots ,{A}_x } \}$\end{document}</tex-math></inline-formula> and that of marker B is <inline-formula><tex-math id="M00033" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{ {{B}_1,{B}_2,{B}_3, \ldots ,{B}_x } \}$\end{document}</tex-math></inline-formula>.</p>
    </sec>
    <sec id="SEC2-14">
      <title>Spatial autocorrelation analysis</title>
      <p>Spatial autocorrelation analysis calculates the degree of random spatial distribution of cells. If cells tend to locate closely together, they are considered positively spatially correlated. Moran’s <italic toggle="yes">I</italic> (<xref rid="B44" ref-type="bibr">44</xref>) measures global spatial autocorrelation, while Geary’s <italic toggle="yes">C</italic> (<xref rid="B45" ref-type="bibr">45</xref>) measures local spatial autocorrelation. Moran’s <italic toggle="yes">I</italic> is defined as<disp-formula><tex-math id="M00034" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}I = \frac{N}{W} \frac{{\mathop \sum \nolimits_i \mathop \sum \nolimits_j {w}_{ij}\left( {{x}_i - \bar{x}} \right)\left( {{x}_j - \bar{x}} \right)}}{{\mathop \sum \nolimits_i {{\left( {{x}_i - \bar{x}} \right)}}^2}},\end{equation*}$$\end{document}</tex-math></disp-formula>while Geary’s <italic toggle="yes">C</italic> is defined as<disp-formula><tex-math id="M00035" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}C = \frac{{\left( {N - 1} \right)\mathop \sum \nolimits_i \mathop \sum \nolimits_j {w}_{ij}{{\left( {{x}_i - {x}_j} \right)}}^2}}{{2W\mathop \sum \nolimits_i {{\left( {{x}_i - \bar{x}} \right)}}^2}}.\end{equation*}$$\end{document}</tex-math></disp-formula><inline-formula><tex-math id="M00036" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N$\end{document}</tex-math></inline-formula> is defined as the number of spatial units indexed by <inline-formula><tex-math id="M00037" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00038" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula>, while <inline-formula><tex-math id="M00039" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${w}_{ij}$\end{document}</tex-math></inline-formula> is the spatial weight matrix derived from the neighbor network analysis and <inline-formula><tex-math id="M00040" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W$\end{document}</tex-math></inline-formula> is the sum of the matrix. The spatial autocorrelation analysis is implemented in Rust.</p>
    </sec>
    <sec id="SEC2-15">
      <title>Structure and implementations</title>
      <p>The Aquila web user interface (UI) was generated using Next.js, a framework based on React. The web UI was designed using MUI, following the Material Design Guidelines. The visualization was created using Echarts.js with WebGL support to enable GPU acceleration. The codes for processing user datasets were implemented using pure JavaScript and executed directly in the browser using Web Workers. All user data are stored locally using IndexedDB. The central API server was constructed using the Actix framework and written in Rust. Analyses including cell neighbor network, cell distribution, co-expression analysis, spatial autocorrelation analysis, spatial entropy and cell–cell interactions were also implemented in Rust. The secondary API server was constructed using FastAPI, written in Python and implemented the following analyses: Ripley statistics, spatial community, cell centrality and spatial variable gene. SpatialDE powered the spatial variable gene analysis with GPU support. Currently, we are running Aquila on a server with an NVIDIA GTX750 GPU. Nginx was used as the reverse proxy server to register the two API servers under the same API gateway.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>DATABASE CONTENT AND USAGE</title>
    <sec id="SEC3-1">
      <title>Querying and selecting data</title>
      <p>To query and select datasets, users must first click on the ‘Explore’ button on the home page, which will direct them to the ‘Dataset’ page. This page displays all the datasets as a list of cards. Each card highlights the essential information of a dataset, including species, tissue, disease, technology, molecule, the statistics of datasets and associated publications. The card also contains buttons that users can choose to view the dataset, download the dataset or add the dataset to the download list to download multiple datasets at once (Figure <xref rid="F2" ref-type="fig">2A</xref>). Aquila has a powerful filtering panel on the same page that helps users look for the dataset(s) they are interested in faster. Users can select dataset(s) based on multiple conditions such as species, technology, tissue or disease (Figure <xref rid="F2" ref-type="fig">2B</xref>). They can also find datasets by running a fuzzy search with any keywords. Searching datasets by gene names (case-insensitive) is also supported (Figure <xref rid="F2" ref-type="fig">2B</xref>). After narrowing down their search, users can sort the filtered datasets by publication name, year or the number of cells/ROIs/genes in either an ascending or a descending order. Aquila also supports viewing datasets from the ‘Publications’ page since each publication may contain multiple datasets. Once users find their dataset of interest, they can explore it in detail by selecting the ‘View’ button. After entering the details page of data, users can also select to view different ROIs in each dataset through a feature-rich data table. The default will present the first ROI in the dataset.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Navigating and using Aquila. (<bold>A</bold>) An example of a dataset card displaying different essential information. (<bold>B</bold>) A panel for filtering and searching datasets with a sort button. (<bold>C</bold>) An example of an analysis panel for selecting methods and inserting parameters to run an analysis.</p>
        </caption>
        <graphic xlink:href="gkac874fig2" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-2">
      <title>Visualizing spatial maps</title>
      <p>Spatial maps are shown in 2D or 3D, depending on the dataset (Figure <xref rid="F1" ref-type="fig">1B</xref>). Users can begin by obtaining a general overview of the dataset by choosing one or more ROIs they would like to view in the ROI preview panel. They can then pick from the ROI preview panel one ROI at a time that they would like to acquire additional details. Once users have selected an ROI, they can view different contents of the ROI by toggling between ‘Cell Map’, ‘Expression Map’ and ‘Co-localization of Markers’. ‘Cell Map’ shows users the spatial distribution of the different cell types in the ROI. ‘Cell Map’ also contains general information about the ROI, including the dimension (minimum bounding box) and the number of cells. As for ‘Expression Map’, this option lets users look at the spatial expression of individual markers. Users can select or search for their markers of interest using the dropdown menu. Multiple expression maps can be viewed at once, so users can compare the spatial expression patterns of the different markers. Users can click on an ROI to obtain a larger view. Quantification of the expression distribution for the selected marker is also provided under ‘Expression Map’. Finally, by selecting ‘Co-localization of Markers’, users can view the expression of multiple markers in a cell, similar to immunofluorescent and fluorescent <italic toggle="yes">in situ</italic> hybridization analyses. Users can select up to two to five markers, assigning each marker a different color to see whether their expression is co-localized. All spatial maps allow users to adjust the point size and canvas size and zoom in and out to check tissue structures at different resolutions. All visualizations displayed in Aquila can be downloaded as PNGs.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Performing spatial analysis</title>
      <p>Users can perform a comprehensive spatial analysis of any selected ROI within Aquila. Currently, 14 types of analyses are available. A concise explanation of each analysis can be found by clicking on the down arrowhead icon to the right of each analysis title. Users can choose to use the general default parameters supplied for every analysis, or they can input their own values. Users can also hover over the question mark at the end of each parameter to learn its functionalities in the popup card (Figure <xref rid="F2" ref-type="fig">2C</xref>). Many analyses come with more than one method, which allows users to try out different methods to achieve optimal results. Analyses will start immediately after selecting the ‘Run’ button, and users can visualize the results as soon as they are completed. Some spatial analyses, as described above, rely on the results from the neighboring network analysis to work and, by default, are not accessible to users. To unlock and run these other spatial analyses, users will need to perform the ‘neighboring network’ analysis, which will then embed the results into these analyses. Other analyses require cell type information to run, and thus they are not available for datasets that do not provide this information. The details of each analysis and how to choose parameters are found in the ‘Materials and Methods’ section.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Analyzing user data</title>
      <p>Users can use Aquila to analyze their data by uploading them on the ‘Analysis’ page. Users must upload three files containing ROI annotation, cell/spot coordination and gene expression values. After these files are processed, users can then view and analyze their data in Aquila with the exact layout and functionalities as the public datasets. To protect sensitive private information from patient samples or unpublished research data from possible leaks, Aquila processes the data and stores the results locally.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC4">
    <title>CONCLUSION AND FUTURE DEVELOPMENT</title>
    <p>In this work, we introduce Aquila, a database and analysis package for spatial omics data. Aquila provides a 2D and 3D spatial omics data visualization platform and allows users to analyze existing datasets in the database. Moreover, Aquila also supports visualizing and analyzing user data. Overall, Aquila provides users with results in a detailed and comprehensive profile from a spatial perspective.</p>
    <p>Many spatial omics datasets provide tissue images such as H&amp;E staining and expression information. Combining expression information with images helps users better understand the datasets and gain deeper insights into their findings. However, Aquila currently does not support tissue images, mainly due to the vast storage size needed to archive them and the resulting performance degradation in the backend database. We will seek better technical solutions in the future to incorporate tissue images. Finally, we will continuously update Aquila with new datasets and integrate additional analyses to provide a richer understanding of the data.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>Aquila is freely accessible to anyone with no registration requirements. The database can be accessed and all the datasets can be downloaded via <ext-link xlink:href="https://aquila.cheunglab.org" ext-link-type="uri">https://aquila.cheunglab.org</ext-link>. For usage and API documentation, please refer to <ext-link xlink:href="https://aquila.cheunglab.org/about" ext-link-type="uri">https://aquila.cheunglab.org/about</ext-link>. All preprocessing and source codes for deploying the database are found at <ext-link xlink:href="https://github.com/Mr-Milk/Aquila-next" ext-link-type="uri">https://github.com/Mr-Milk/Aquila-next</ext-link>.</p>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to Nitin Narwade, Lingling Hu, Zhengqiang Miao and Jianfei Zheng for devoting their valuable time to testing and providing priceless advice for improving Aquila. We thank the Information and Communication Technology Office from the University of Macau for providing network and hardware support to host the API server for the database. We also thank all the members of the Cheung lab for critical feedback on this work.</p>
  </ack>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>University of Macau [MYRG2018-00033-FHS, MYRG2020-00100-FHS]; Science and Technology Development Fund [0011/2019/AKP, 0137/2020/A3]. Funding for open access charge: University of Macau.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><collab>HuBMAP Consortium</collab><article-title>The human body at cellular resolution: the NIH Human Biomolecular Atlas Program</article-title>. <source>Nature</source>. <year>2019</year>; <volume>574</volume>:<fpage>187</fpage>.<pub-id pub-id-type="pmid">31597973</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X.</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>K.B.</given-names></string-name></person-group><article-title>From tissues to cell types and back: single-cell gene expression analysis of tissue architecture</article-title>. <source>Annu. Rev. Biomed. Data Sci.</source><year>2018</year>; <volume>1</volume>:<fpage>29</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moses</surname><given-names>L.</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L.</given-names></string-name></person-group><article-title>Museum of spatial transcriptomics</article-title>. <source>Nat. Methods</source>. <year>2022</year>; <volume>19</volume>:<fpage>534</fpage>–<lpage>546</lpage>.<pub-id pub-id-type="pmid">35273392</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stickels</surname><given-names>R.R.</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E.</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>P.</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.</given-names></string-name>, <string-name><surname>Marshall</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Di Bella</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Arlotta</surname><given-names>P.</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>F.</given-names></string-name></person-group><article-title>Highly sensitive spatial transcriptomics at near-cellular resolution with Slide-seqV2</article-title>. <source>Nat. Biotechnol.</source><year>2021</year>; <volume>39</volume>:<fpage>313</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">33288904</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>M.</given-names></string-name>, <string-name><surname>Deng</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Su</surname><given-names>G.</given-names></string-name>, <string-name><surname>Enninful</surname><given-names>A.</given-names></string-name>, <string-name><surname>Guo</surname><given-names>C.C.</given-names></string-name>, <string-name><surname>Tebaldi</surname><given-names>T.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>D.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>D.</given-names></string-name>, <string-name><surname>Bai</surname><given-names>Z.</given-names></string-name></person-group><article-title>High-spatial-resolution multi-omics sequencing via deterministic barcoding in tissue</article-title>. <source>Cell</source>. <year>2020</year>; <volume>183</volume>:<fpage>1665</fpage>–<lpage>1681</lpage>.<pub-id pub-id-type="pmid">33188776</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>P.L.</given-names></string-name>, <string-name><surname>Salmén</surname><given-names>F.</given-names></string-name>, <string-name><surname>Vickovic</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lundmark</surname><given-names>A.</given-names></string-name>, <string-name><surname>Navarro</surname><given-names>J.F.</given-names></string-name>, <string-name><surname>Magnusson</surname><given-names>J.</given-names></string-name>, <string-name><surname>Giacomello</surname><given-names>S.</given-names></string-name>, <string-name><surname>Asp</surname><given-names>M.</given-names></string-name>, <string-name><surname>Westholm</surname><given-names>J.O.</given-names></string-name>, <string-name><surname>Huss</surname><given-names>M.</given-names></string-name></person-group><article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source>. <year>2016</year>; <volume>353</volume>:<fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>A.</given-names></string-name>, <string-name><surname>Liao</surname><given-names>S.</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>M.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>K.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>L.</given-names></string-name>, <string-name><surname>Lai</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S.</given-names></string-name></person-group><article-title>Spatiotemporal transcriptomic atlas of mouse organogenesis using DNA nanoball-patterned arrays</article-title>. <source>Cell</source>. <year>2022</year>; <volume>185</volume>:<fpage>1777</fpage>–<lpage>1792</lpage>.<pub-id pub-id-type="pmid">35512705</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cho</surname><given-names>C.-S.</given-names></string-name>, <string-name><surname>Xi</surname><given-names>J.</given-names></string-name>, <string-name><surname>Si</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Park</surname><given-names>S.-R.</given-names></string-name>, <string-name><surname>Hsu</surname><given-names>J.-E.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>M.</given-names></string-name>, <string-name><surname>Jun</surname><given-names>G.</given-names></string-name>, <string-name><surname>Kang</surname><given-names>H.M.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>J.H.</given-names></string-name></person-group><article-title>Microscopic examination of spatial transcriptome using Seq-Scope</article-title>. <source>Cell</source>. <year>2021</year>; <volume>184</volume>:<fpage>3559</fpage>–<lpage>3572</lpage>.<pub-id pub-id-type="pmid">34115981</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivatsan</surname><given-names>S.R.</given-names></string-name>, <string-name><surname>Regier</surname><given-names>M.C.</given-names></string-name>, <string-name><surname>Barkan</surname><given-names>E.</given-names></string-name>, <string-name><surname>Franks</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Packer</surname><given-names>J.S.</given-names></string-name>, <string-name><surname>Grosjean</surname><given-names>P.</given-names></string-name>, <string-name><surname>Duran</surname><given-names>M.</given-names></string-name>, <string-name><surname>Saxton</surname><given-names>S.</given-names></string-name>, <string-name><surname>Ladd</surname><given-names>J.J.</given-names></string-name>, <string-name><surname>Spielmann</surname><given-names>M.</given-names></string-name></person-group><article-title>Embryo-scale, single-cell spatial transcriptomics</article-title>. <source>Science</source>. <year>2021</year>; <volume>373</volume>:<fpage>111</fpage>–<lpage>117</lpage>.<pub-id pub-id-type="pmid">34210887</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eng</surname><given-names>C.-H.L.</given-names></string-name>, <string-name><surname>Lawson</surname><given-names>M.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Dries</surname><given-names>R.</given-names></string-name>, <string-name><surname>Koulena</surname><given-names>N.</given-names></string-name>, <string-name><surname>Takei</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Yun</surname><given-names>J.</given-names></string-name>, <string-name><surname>Cronin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Karp</surname><given-names>C.</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>G.-C.</given-names></string-name></person-group><article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH+</article-title>. <source>Nature</source>. <year>2019</year>; <volume>568</volume>:<fpage>235</fpage>–<lpage>239</lpage>.<pub-id pub-id-type="pmid">30911168</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xia</surname><given-names>C.</given-names></string-name>, <string-name><surname>Fan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Emanuel</surname><given-names>G.</given-names></string-name>, <string-name><surname>Hao</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zhuang</surname><given-names>X.</given-names></string-name></person-group><article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>. <source>Proc. Natl Acad. Sci. U.S.A.</source><year>2019</year>; <volume>116</volume>:<fpage>19490</fpage>–<lpage>19499</lpage>.<pub-id pub-id-type="pmid">31501331</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Allen</surname><given-names>W.E.</given-names></string-name>, <string-name><surname>Wright</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Sylwestrak</surname><given-names>E.L.</given-names></string-name>, <string-name><surname>Samusik</surname><given-names>N.</given-names></string-name>, <string-name><surname>Vesuna</surname><given-names>S.</given-names></string-name>, <string-name><surname>Evans</surname><given-names>K.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>C.</given-names></string-name>, <string-name><surname>Ramakrishnan</surname><given-names>C.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J.</given-names></string-name></person-group><article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title>. <source>Science</source>. <year>2018</year>; <volume>361</volume>:<fpage>eaat5691</fpage>.<pub-id pub-id-type="pmid">29930089</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lewis</surname><given-names>S.M.</given-names></string-name>, <string-name><surname>Asselin-Labat</surname><given-names>M.-L.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Berthelet</surname><given-names>J.</given-names></string-name>, <string-name><surname>Tan</surname><given-names>X.</given-names></string-name>, <string-name><surname>Wimmer</surname><given-names>V.C.</given-names></string-name>, <string-name><surname>Merino</surname><given-names>D.</given-names></string-name>, <string-name><surname>Rogers</surname><given-names>K.L.</given-names></string-name>, <string-name><surname>Naik</surname><given-names>S.H.</given-names></string-name></person-group><article-title>Spatial omics and multiplexed imaging to explore cancer biology</article-title>. <source>Nat. Methods</source>. <year>2021</year>; <volume>18</volume>:<fpage>997</fpage>–<lpage>1012</lpage>.<pub-id pub-id-type="pmid">34341583</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>J.-R.</given-names></string-name>, <string-name><surname>Izar</surname><given-names>B.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Yapp</surname><given-names>C.</given-names></string-name>, <string-name><surname>Mei</surname><given-names>S.</given-names></string-name>, <string-name><surname>Shah</surname><given-names>P.M.</given-names></string-name>, <string-name><surname>Santagata</surname><given-names>S.</given-names></string-name>, <string-name><surname>Sorger</surname><given-names>P.K.</given-names></string-name></person-group><article-title>Highly multiplexed immunofluorescence imaging of human tissues and tumors using t-CyCIF and conventional optical microscopes</article-title>. <source>eLife</source>. <year>2018</year>; <volume>7</volume>:<fpage>e31657</fpage>.<pub-id pub-id-type="pmid">29993362</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goltsev</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Samusik</surname><given-names>N.</given-names></string-name>, <string-name><surname>Kennedy-Darling</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bhate</surname><given-names>S.</given-names></string-name>, <string-name><surname>Hale</surname><given-names>M.</given-names></string-name>, <string-name><surname>Vazquez</surname><given-names>G.</given-names></string-name>, <string-name><surname>Black</surname><given-names>S.</given-names></string-name>, <string-name><surname>Nolan</surname><given-names>G.P.</given-names></string-name></person-group><article-title>Deep profiling of mouse splenic architecture with CODEX multiplexed imaging</article-title>. <source>Cell</source>. <year>2018</year>; <volume>174</volume>:<fpage>968</fpage>–<lpage>981</lpage>.<pub-id pub-id-type="pmid">30078711</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giesen</surname><given-names>C.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H.A.</given-names></string-name>, <string-name><surname>Schapiro</surname><given-names>D.</given-names></string-name>, <string-name><surname>Zivanovic</surname><given-names>N.</given-names></string-name>, <string-name><surname>Jacobs</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hattendorf</surname><given-names>B.</given-names></string-name>, <string-name><surname>Schüffler</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Grolimund</surname><given-names>D.</given-names></string-name>, <string-name><surname>Buhmann</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Brandt</surname><given-names>S.</given-names></string-name></person-group><article-title>Highly multiplexed imaging of tumor tissues with subcellular resolution by mass cytometry</article-title>. <source>Nat. Methods</source>. <year>2014</year>; <volume>11</volume>:<fpage>417</fpage>–<lpage>422</lpage>.<pub-id pub-id-type="pmid">24584193</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keren</surname><given-names>L.</given-names></string-name>, <string-name><surname>Bosse</surname><given-names>M.</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>S.</given-names></string-name>, <string-name><surname>Risom</surname><given-names>T.</given-names></string-name>, <string-name><surname>Vijayaragavan</surname><given-names>K.</given-names></string-name>, <string-name><surname>McCaffrey</surname><given-names>E.</given-names></string-name>, <string-name><surname>Marquez</surname><given-names>D.</given-names></string-name>, <string-name><surname>Angoshtari</surname><given-names>R.</given-names></string-name>, <string-name><surname>Greenwald</surname><given-names>N.F.</given-names></string-name>, <string-name><surname>Fienberg</surname><given-names>H.</given-names></string-name></person-group><article-title>MIBI-TOF: a multiplexed imaging platform relates cellular phenotypes and tissue structure</article-title>. <source>Sci. Adv.</source><year>2019</year>; <volume>5</volume>:<fpage>eaax5851</fpage>.<pub-id pub-id-type="pmid">31633026</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Lv</surname><given-names>T.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Xiang</surname><given-names>R.</given-names></string-name>, <string-name><surname>Tu</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Wei</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Han</surname><given-names>K.</given-names></string-name>, <string-name><surname>Shi</surname><given-names>C.</given-names></string-name></person-group><article-title>High-resolution 3D spatiotemporal transcriptomic maps of developing <italic toggle="yes">Drosophila</italic> embryos and larvae</article-title>. <source>Dev. Cell</source>. <year>2022</year>; <volume>57</volume>:<fpage>1271</fpage>–<lpage>1283</lpage>.<pub-id pub-id-type="pmid">35512700</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>C.</given-names></string-name>, <string-name><surname>Li</surname><given-names>R.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>K.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Shi</surname><given-names>X.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>Y.</given-names></string-name></person-group><article-title>Spatiotemporal mapping of gene expression landscapes and developmental trajectories during zebrafish embryogenesis</article-title>. <source>Dev. Cell</source>. <year>2022</year>; <volume>57</volume>:<fpage>1284</fpage>–<lpage>1298</lpage>.<pub-id pub-id-type="pmid">35512701</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ji</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Thrane</surname><given-names>K.</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Reynolds</surname><given-names>D.L.</given-names></string-name>, <string-name><surname>Meyers</surname><given-names>R.M.</given-names></string-name>, <string-name><surname>Guo</surname><given-names>M.G.</given-names></string-name>, <string-name><surname>George</surname><given-names>B.M.</given-names></string-name>, <string-name><surname>Mollbrink</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bergenstråhle</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Multimodal analysis of composition and spatial architecture in human squamous cell carcinoma</article-title>. <source>Cell</source>. <year>2020</year>; <volume>182</volume>:<fpage>497</fpage>–<lpage>514</lpage>.<pub-id pub-id-type="pmid">32579974</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendeiro</surname><given-names>A.F.</given-names></string-name>, <string-name><surname>Ravichandran</surname><given-names>H.</given-names></string-name>, <string-name><surname>Bram</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Chandar</surname><given-names>V.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J.</given-names></string-name>, <string-name><surname>Meydan</surname><given-names>C.</given-names></string-name>, <string-name><surname>Park</surname><given-names>J.</given-names></string-name>, <string-name><surname>Foox</surname><given-names>J.</given-names></string-name>, <string-name><surname>Hether</surname><given-names>T.</given-names></string-name>, <string-name><surname>Warren</surname><given-names>S.</given-names></string-name></person-group><article-title>The spatial landscape of lung pathology during COVID-19 progression</article-title>. <source>Nature</source>. <year>2021</year>; <volume>593</volume>:<fpage>564</fpage>–<lpage>569</lpage>.<pub-id pub-id-type="pmid">33780969</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>R.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X.</given-names></string-name></person-group><article-title>SpatialDB: a database for spatially resolved transcriptomes</article-title>. <source>Nucleic Acids Res.</source><year>2020</year>; <volume>48</volume>:<fpage>D233</fpage>–<lpage>D237</lpage>.<pub-id pub-id-type="pmid">31713629</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dries</surname><given-names>R.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Dong</surname><given-names>R.</given-names></string-name>, <string-name><surname>Eng</surname><given-names>C.-H.L.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>K.</given-names></string-name>, <string-name><surname>Fu</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>T.</given-names></string-name>, <string-name><surname>Sarkar</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bao</surname><given-names>F.</given-names></string-name></person-group><article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title>. <source>Genome Biol.</source><year>2021</year>; <volume>22</volume>:<fpage>1</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">33397451</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palla</surname><given-names>G.</given-names></string-name>, <string-name><surname>Spitzer</surname><given-names>H.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>M.</given-names></string-name>, <string-name><surname>Fischer</surname><given-names>D.</given-names></string-name>, <string-name><surname>Schaar</surname><given-names>A.C.</given-names></string-name>, <string-name><surname>Kuemmerle</surname><given-names>L.B.</given-names></string-name>, <string-name><surname>Rybakov</surname><given-names>S.</given-names></string-name>, <string-name><surname>Ibarra</surname><given-names>I.L.</given-names></string-name>, <string-name><surname>Holmberg</surname><given-names>O.</given-names></string-name>, <string-name><surname>Virshup</surname><given-names>I.</given-names></string-name></person-group><article-title>Squidpy: a scalable framework for spatial omics analysis</article-title>. <source>Nat. Methods</source>. <year>2022</year>; <volume>19</volume>:<fpage>171</fpage>–<lpage>178</lpage>.<pub-id pub-id-type="pmid">35102346</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>C.R.</given-names></string-name>, <string-name><surname>Millman</surname><given-names>K.J.</given-names></string-name>, <string-name><surname>van der Walt</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Gommers</surname><given-names>R.</given-names></string-name>, <string-name><surname>Virtanen</surname><given-names>P.</given-names></string-name>, <string-name><surname>Cournapeau</surname><given-names>D.</given-names></string-name>, <string-name><surname>Wieser</surname><given-names>E.</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>J.</given-names></string-name>, <string-name><surname>Berg</surname><given-names>S.</given-names></string-name>, <string-name><surname>Smith</surname><given-names>N.J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Array programming with NumPy</article-title>. <source>Nature</source>. <year>2020</year>; <volume>585</volume>:<fpage>357</fpage>–<lpage>362</lpage>.<pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKinney</surname><given-names>W.</given-names></string-name></person-group><article-title>pandas: a foundational Python library for data analysis and statistics</article-title>. <source>Proceedings of the Workshop onPython for High Performance and Scientific Computing</source>. <year>2011</year>; <volume>14</volume>:<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol.</source><year>2018</year>; <volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fath</surname><given-names>B.D.</given-names></string-name></person-group><source>Encyclopedia of Ecology</source>. <year>2018</year>; <publisher-loc>Amsterdam, The Netherlands</publisher-loc><publisher-name>Elsevier</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morisita</surname><given-names>M.</given-names></string-name></person-group><article-title><italic toggle="yes">I</italic><sub>σ</sub>-index, a measure of dispersion of individuals</article-title>. <source>Res. Popul. Ecol.</source><year>1962</year>; <volume>4</volume>:<fpage>1</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Evans</surname><given-names>F.C.</given-names></string-name></person-group><article-title>Distance to nearest neighbor as a measure of spatial relationships in populations</article-title>. <source>Ecology</source>. <year>1954</year>; <volume>35</volume>:<fpage>445</fpage>–<lpage>453</lpage>.</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ripley</surname><given-names>B.D.</given-names></string-name></person-group><source>Spatial Statistics</source>. <year>2005</year>; <publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rey</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Anselin</surname><given-names>L.</given-names></string-name></person-group><source>Handbook of Applied Spatial Analysis</source>. <year>2010</year>; <publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name><fpage>175</fpage>–<lpage>193</lpage>.</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shannon</surname><given-names>C.E.</given-names></string-name></person-group><article-title>A mathematical theory of communication</article-title>. <source>Bell Syst. Tech. J.</source><year>1948</year>; <volume>27</volume>:<fpage>379</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leibovici</surname><given-names>D.G.</given-names></string-name>, <string-name><surname>Claramunt</surname><given-names>C.</given-names></string-name>, <string-name><surname>Le Guyader</surname><given-names>D.</given-names></string-name>, <string-name><surname>Brosset</surname><given-names>D</given-names></string-name></person-group><article-title>Local and global spatio-temporal entropy indices based on distance-ratios and co-occurrences distributions</article-title>. <source>Int. J. Geogr. Inf. Sci.</source><year>2014</year>; <volume>28</volume>:<fpage>1061</fpage>–<lpage>1084</lpage>.</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Svensson</surname><given-names>V.</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Stegle</surname><given-names>O.</given-names></string-name></person-group><article-title>SpatialDE: identification of spatially variable genes</article-title>. <source>Nat. Methods</source>. <year>2018</year>; <volume>15</volume>:<fpage>343</fpage>–<lpage>346</lpage>.<pub-id pub-id-type="pmid">29553579</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kats</surname><given-names>I.</given-names></string-name>, <string-name><surname>Vento-Tormo</surname><given-names>R.</given-names></string-name>, <string-name><surname>Stegle</surname><given-names>O.</given-names></string-name></person-group><article-title>SpatialDE2: fast and localized variance component analysis of spatial transcriptomics</article-title>. <year>2021</year>; <comment>bioRxiv doi:</comment><comment>27 October 2021, preprint: not peer reviewed</comment><pub-id pub-id-type="doi">10.1101/2021.10.27.466045</pub-id>.</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname><given-names>H.W.</given-names></string-name>, <string-name><surname>Fischer</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Zanotelli</surname><given-names>V.R.</given-names></string-name>, <string-name><surname>Ali</surname><given-names>H.R.</given-names></string-name>, <string-name><surname>Mechera</surname><given-names>R.</given-names></string-name>, <string-name><surname>Soysal</surname><given-names>S.D.</given-names></string-name>, <string-name><surname>Moch</surname><given-names>H.</given-names></string-name>, <string-name><surname>Muenst</surname><given-names>S.</given-names></string-name>, <string-name><surname>Varga</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Weber</surname><given-names>W.P.</given-names></string-name></person-group><article-title>The single-cell pathology landscape of breast cancer</article-title>. <source>Nature</source>. <year>2020</year>; <volume>578</volume>:<fpage>615</fpage>–<lpage>620</lpage>.<pub-id pub-id-type="pmid">31959985</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Traag</surname><given-names>V.A.</given-names></string-name>, <string-name><surname>Waltman</surname><given-names>L.</given-names></string-name>, <string-name><surname>van Eck</surname><given-names>N.J.</given-names></string-name></person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci. Rep.</source><year>2019</year>; <volume>9</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">30626917</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rotta</surname><given-names>R.</given-names></string-name>, <string-name><surname>Noack</surname><given-names>A.</given-names></string-name></person-group><article-title>Multilevel local search algorithms for modularity clustering</article-title>. <source>J. Exp. Algorithmics</source>. <year>2011</year>; <volume>16</volume>:<fpage>2.1</fpage>–<lpage>2.27</lpage>.</mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rosvall</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bergstrom</surname><given-names>C.T.</given-names></string-name></person-group><article-title>Maps of information flow reveal community structure in complex networks</article-title>. <source>PNAS</source>. <year>2007</year>; <volume>105</volume>:<fpage>1118</fpage>–<lpage>1123</lpage>.</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>V.</given-names></string-name>, <string-name><surname>Guillaume</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lambiotte</surname><given-names>R.</given-names></string-name>, <string-name><surname>Lefebvre</surname><given-names>E.</given-names></string-name></person-group><article-title>Fast unfolding of community hierarchies in large networks</article-title>. <source>J. Stat. Mech.</source><year>2008</year>; <volume>2008</volume>:<fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>West</surname><given-names>D.B.</given-names></string-name></person-group><source>Introduction to Graph Theory</source>. <year>2001</year>; <publisher-loc>Upper Saddle River, NJ</publisher-loc><publisher-name>Prentice Hall</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schapiro</surname><given-names>D.</given-names></string-name>, <string-name><surname>Jackson</surname><given-names>H.W.</given-names></string-name>, <string-name><surname>Raghuraman</surname><given-names>S.</given-names></string-name>, <string-name><surname>Fischer</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Zanotelli</surname><given-names>V.R.</given-names></string-name>, <string-name><surname>Schulz</surname><given-names>D.</given-names></string-name>, <string-name><surname>Giesen</surname><given-names>C.</given-names></string-name>, <string-name><surname>Catena</surname><given-names>R.</given-names></string-name>, <string-name><surname>Varga</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Bodenmiller</surname><given-names>B.</given-names></string-name></person-group><article-title>histoCAT: analysis of cell phenotypes and interactions in multiplex image cytometry data</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>873</fpage>.<pub-id pub-id-type="pmid">28783155</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moran</surname><given-names>P.A.</given-names></string-name></person-group><article-title>Notes on continuous stochastic phenomena</article-title>. <source>Biometrika</source>. <year>1950</year>; <volume>37</volume>:<fpage>17</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">15420245</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geary</surname><given-names>R.C.</given-names></string-name></person-group><article-title>The contiguity ratio and statistical mapping</article-title>. <source>Inc. Stat.</source><year>1954</year>; <volume>5</volume>:<fpage>115</fpage>–<lpage>146</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
