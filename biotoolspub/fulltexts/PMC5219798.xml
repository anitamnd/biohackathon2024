<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Res Notes</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Res Notes</journal-id>
    <journal-title-group>
      <journal-title>BMC Research Notes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-0500</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5219798</article-id>
    <article-id pub-id-type="publisher-id">2340</article-id>
    <article-id pub-id-type="doi">10.1186/s13104-016-2340-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>treeman: an R package for efficient and intuitive manipulation of phylogenetic trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bennett</surname>
          <given-names>Dominic J.</given-names>
        </name>
        <address>
          <email>dominic.john.bennett@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sutton</surname>
          <given-names>Mark D.</given-names>
        </name>
        <address>
          <email>m.sutton@imperial.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Turvey</surname>
          <given-names>Samuel T.</given-names>
        </name>
        <address>
          <email>samuel.turvey@ioz.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Department of Earth Science and Engineering, Imperial College London, London, UK </aff>
      <aff id="Aff2"><label>2</label>Institute of Zoology, Zoological Society of London, London, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>30</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>9</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>12</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Phylogenetic trees are hierarchical structures used for representing the inter-relationships between biological entities. They are the most common tool for representing evolution and are essential to a range of fields across the life sciences. The manipulation of phylogenetic trees—in terms of adding or removing tips—is often performed by researchers not just for reasons of management but also for performing simulations in order to understand the processes of evolution. Despite this, the most common programming language among biologists, R, has few class structures well suited to these tasks.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present an R package that contains a new class, called TreeMan, for representing the phylogenetic tree. This class has a list structure allowing phylogenetic trees to be manipulated more efficiently. Computational running times are reduced because of the ready ability to vectorise and parallelise methods. Development is also improved due to fewer lines of code being required for performing manipulation processes.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We present three use cases—pinning missing taxa to a supertree, simulating evolution with a tree-growth model and detecting significant phylogenetic turnover—that demonstrate the new package’s speed and simplicity.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13104-016-2340-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogenetic trees</kwd>
      <kwd>Evolution</kwd>
      <kwd>Tree simulation</kwd>
      <kwd>R</kwd>
      <kwd>Statistical computing</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Phylogenetic trees have been a mainstay of the R statistical software environment since the release of Emmanuel Paradis’ APE package in 2002 [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. This package introduced the phylo object, an S3 class for the presentation and manipulation of phylogenetic tree data in the R environment. In its most basic implementation, the phylo object contains a list of three elements: an edge matrix, a vector of tip labels and an integer of the number of internal nodes. The use of an edge matrix facilitates phylogenetically structured statistical analyses because of its convenience for generating distance, cophenetic or covariance matrices. For this reason the APE package’s phylo is the dominant class for phylogenetic tree representation in R and is used by many well-known phylogenetic R packages (e.g. phangorn [<xref ref-type="bibr" rid="CR3">3</xref>], phytools [<xref ref-type="bibr" rid="CR4">4</xref>]). Since phylo’s first incarnation the number of available functions in the APE package has risen from 28 to 171 (versions 0.1–3.4), and to date there are 147 reverse dependencies, i.e. packages on CRAN [<xref ref-type="bibr" rid="CR1">1</xref>] that depend on the phylo class. More recently, the phylo class has been updated to S4 as part of the phylobase package [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p>An edge matrix, however, leads to a dependence on index referencing, leading to certain computational scenarios in which the phylo object performs poorly: in particular, analyses that require the manipulation of the tree itself (i.e. tip and node addition/deletion). Such analyses include simulating, comparing, pruning, and merging trees, and calculating phylogenetic statistics such as measures of phylogenetic richness [<xref ref-type="bibr" rid="CR6">6</xref>] and evolutionary distinctness [<xref ref-type="bibr" rid="CR7">7</xref>]. These have become the preserve of software solutions external to R, e.g. [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], hindering their integration with the many packages in biomolecular, evolutionary and ecological studies already available for R. Although there are alternatives to the phylo class for phylogenetics or more generally ‘networks’ available in R [<xref ref-type="bibr" rid="CR10">10</xref>], these packages and classes are rarely used for phylogenetics and may lack the intuitive functional framework for manipulating evolutionary trees.</p>
    <p>Here we present the new phylogenetic tree manipulation class ‘TreeMan’ (see Fig. <xref rid="Fig1" ref-type="fig">1</xref> for an overview); this is presented as the R package ‘treeman’ (N.B. the package name is all lowercase). This class is built around a list of named nodes rather than an index-based edge matrix as is the case for the phylo class. Using an edge matrix, whenever a node is added or removed the new positions of all nodes in the matrix must be determined and the tree must be re-computed. With a node list, however, order does not matter; nodes can be added and removed without altering the entire tree structure. Manipulations are also less dependent on tree size because all that is required is to update the local nodes: those that directly descend or ascend from the new node, converting that scale of computation time from <italic>O(N</italic>
<sup><italic>2</italic></sup>
<italic>) to O(N)</italic> (see Fig. <xref rid="Fig2" ref-type="fig">2</xref> for a comparison of growing a tree with the phylo and TreeMan classes). Furthermore, with a node list the nodes in the tree can have unique IDs, which persist after insertions or deletions, allowing elements in a tree (such as node labels) to be more easily tracked during analysis. The subsequent sections of the paper describe the overall structure of the new class, describe treeman’s naming convention, and provide examples of tree manipulations that use the new package. The aims of treeman are to be conceptually intuitive for tree manipulation and as computationally efficient as possible within the R environment.<fig id="Fig1"><label>Fig. 1</label><caption><p>Representation of simple tree as TreeMan object: an eight-tipped tree with node and tip IDs annotated and N2′s key slots identified, <bold>b</bold> representation of printed Node information for N2, <bold>c</bold> representation of printed TreeMan information</p></caption><graphic xlink:href="13104_2016_2340_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of tree building using APE’s phylo and treeman’s TreeMan classes. Starting with trees of two tips, 1000 new tips were added to the trees and the time taken to run the process was recorded every ten tips. The rate of increase in time taken for larger trees increases faster for the phylo class than TreeMan
</p></caption><graphic xlink:href="13104_2016_2340_Fig2_HTML" id="MO2"/></fig>
</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>The TreeMan object in R is an S4 formal class whose main data slot is a list—which in R is a vector whose elements can be named. All nodes in a TreeMan object are named elements in this list (ndlst). Each node usually contains the following data slots: the node ID (id), the length of the preceding edge (spn, for “span”), the IDs of all connecting ascending/ancestral nodes to root (pre-node IDs, prid), the IDs of the immediately descending nodes (post-node IDs, ptid), and the IDs of all descending tips (kids). Additionally, if all nodes in a tree contain the spn slot, then each node will also contain: the total edge length of all descending nodes (phylogenetic diversity, pd), total edge length of all connected pre-nodes (prdst; in a rooted tree this is the root-to-tip distance), and the relative distance of the node in the tree (age, for a time-calibrated rooted tree). All nodes must have either a prid and/or ptid data slots: tip nodes have only prid slots, root nodes have only ptid slots, and internal nodes have both. These slots must contain IDs that are found within the ndlst; if they do not, an error is raised. These core slots are supplemented by optional slots, a non-unique taxonomic name that can be used to generate lineages (txnym) and user-defined slots that can contain any kind of information. In addition to the ndlst, the TreeMan object contains informative slots that are generated upon reading or generating the tree, and are updated whenever modified. Basic tree information can be seen by printing the tree to console.</p>
    <p>The treeman package implements an intuitive naming convention in which each tree feature has a specific name that all methods and objects must use (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>; Table <xref rid="Tab1" ref-type="table">1</xref>). Specific tree or node information can be accessed using R indexing by character-string. For example, entering tree [“tips”] will output data on a tree’s tips. Double square brackets are used for pulling out information on individual nodes, e.g. tree [[“t1”]] will return node information on tip/node t1. The majority of methods in the treeman package are grouped into four main groups: <italic>get</italic>, <italic>set</italic>, <italic>calc</italic> and <italic>manip</italic> (see Table <xref rid="Tab1" ref-type="table">1</xref>). The <italic>get</italic> methods return node or tree specific information, <italic>set</italic> methods change the tree’s or its nodes’ parameters, <italic>calc</italic> methods generate tree statistics, and <italic>manip</italic> methods alter the tree, usually by adding or removing tips and nodes. Methods that act across nodes are indicated with ‘nd’ or ‘nds’ in their function name, e.g. getNdAge() for a single node and getNdsAge() for multiple nodes. These core methods are designed to be fast and modular, allowing them to be readily combined into more complex functions. For example, evolutionary distinctness using the Fair Proportion metric [<xref ref-type="bibr" rid="CR6">6</xref>] can be calculated by using the method calcFrPrp(). In implementation, this method uses getNdPrid() to get all pre-node IDs, runs getNdsKids() on these IDs to find the number of descendants per pre-node, and then sums the division of the numbers of descendants over the pre-nodes’ spans.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Taxonomy of treeman functions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method set</th><th align="left">Description</th><th align="left">Examples</th></tr></thead><tbody><tr><td align="left"><italic>get</italic></td><td align="left">Retrieve specific information about parts of a tree, often nodes</td><td align="left">getNdAge, getPrnt, getNdKids, getNdLng, getNdPrid, getNdPtid, getPath, getSubtree</td></tr><tr><td align="left"><italic>calc</italic></td><td align="left">Calculate tree statistics and tree associated information</td><td align="left">calcDstMtrx, calcTrDst, calcPhyDv, calcFrPrp</td></tr><tr><td align="left"><italic>set</italic></td><td align="left">Set node or overall tree values</td><td align="left">setNdSpn, setAge, setPD, setRoot, setTol</td></tr><tr><td align="left"><italic>manip</italic></td><td align="left">Change tree structure by adding or removing tips and nodes</td><td align="left">addTip, rmTip, pinTip</td></tr></tbody></table></table-wrap>
</p>
    <p>Because the TreeMan class depends on the ndlst, all functions that run over this list are vectorised. All treeman functions that can be vectorised are done so using plyr vectorisation [<xref ref-type="bibr" rid="CR11">11</xref>], providing substantial performance benefits, as computation is no longer taking place at the scripting level. Through the use of plyr these functions can also be parallelised using the “.parallel” argument that is passed onto plyr functions, which work in conjunction with parallel R packages such as DoMC [<xref ref-type="bibr" rid="CR12">12</xref>] and doSNOW [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <p>To demonstrate the TreeMan class and how the treeman functions can be combined to complete complex tasks, we demonstrate three use-cases: pinning missing taxa using online taxonomic databases to a molecular phylogenetic tree; simulating phylogenetic trees through time using different models of evolution; and testing for significant phylogenetic turnover between ecological communities.</p>
    <sec id="Sec4">
      <title>Tip pinning: adding missing taxa to a tree using online taxonomies</title>
      <p>Trees often have missing tips due to a lack of data for phylogenetic construction. One approach to placing these tips is to use the taxonomy of the missing taxa and constraining placement with a model of evolution, as implemented by the Pastis software package [<xref ref-type="bibr" rid="CR14">14</xref>]. Similar methods can be implemented in R using treeman. Our package provides an addTip() function that takes as arguments the incipient edge and an age range. Furthermore, TreeMan objects can be taxonomically informed: taxonomic names (txnyms) can be assigned to every node in a tree, allowing a user to constrain random placement of nodes. To demonstrate this functionality we present the mammalian supertree [<xref ref-type="bibr" rid="CR15">15</xref>] that has been taxonomically informed using NCBI’s taxonomy [<xref ref-type="bibr" rid="CR16">16</xref>]. We retrieved all the species names listed in NCBI but not present in the supertree, and pinned an example set of 100 new tips to the supertree. New tips were added to the supertree at any point in the branches that shared the lowest matching taxonomic rank with the taxonomy of the new tip (Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>). This was implemented with pinTips(), a function of 49 lines. The equivalent function using a phylo object is approximately 500 lines (see ‘pinning-with-phylo.R’ in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Code snippet used to generated “pinned” tree: load mammal supertree that comes with the treeman package, load resolved names of missing taxa pre-generated with MoreTreeTools, select 100 names at random, pin using pinTips()
</p></caption><graphic xlink:href="13104_2016_2340_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Mammalian supertree [<xref ref-type="bibr" rid="CR15">15</xref>] showing ten tips that have been “pinned” using taxonomically constrained random placement</p></caption><graphic xlink:href="13104_2016_2340_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
    <sec id="Sec5">
      <title>Tree simulation: generating trees using different models of evolution</title>
      <p>Tree simulation is an important tool for exploring the processes that may have generated biodiversity. A common tool for simulating trees is the birth–death simulation or equals-rates Markov model (ERMM) that randomly removes and adds tips on a tree [<xref ref-type="bibr" rid="CR17">17</xref>]. Many publications have independently explored alterations of the ERMM, such as modifying the rates of speciation for different tips in the tree [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. All such studies, however, have developed their own software tools for tree simulation. The TreeMan object is easily modified using the addTip() and rmTip() functions and its speed of processing and implementation makes TreeMan an ideal software tool for tree simulation. Furthermore, as part of the R environment a user has access to the wide range of eco-evolutionary R packages already available to expand on these earlier tree simulations. To demonstrate this functionality, we produced an R script for simulating a tree using an Evolutionary Distinctness Biased Markov Model (EDBMM [<xref ref-type="bibr" rid="CR21">21</xref>]) with fewer than 40 lines of R code (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The simulation randomly adds and removes tips but with a bias towards evolutionary distinctness: more evolutionarily distinct tips have a lower rate of speciation and extinction (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The equivalent script for running a vectorised EDBMM with a phylo object takes 188 lines (see ‘edbmm-with-phylo.R’ in Additional file <xref rid="MOESM2" ref-type="media">2</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Code snippet for running EDBMM with treeman: read in balanced tree and set parameters for simulation; in loop, calculate fair proportion measure of evolutionary distinctness and add or remove tips based on these values; finally, extend the tip edges by adding 1</p></caption><graphic xlink:href="13104_2016_2340_Fig5_HTML" id="MO5"/></fig>
<fig id="Fig6"><label>Fig. 6</label><caption><p>Phylogenetic tree simulated using an Evolutionary Distinctness Biased Markov Model (EDBMM), where tips with greater ED have lower rates of speciation and extinction. <italic>Branch colours</italic> indicate the local number of descending branches, in this case the number of descendants within 20 branch length units</p></caption><graphic xlink:href="13104_2016_2340_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
    <sec id="Sec6">
      <title>Testing for significant phylogenetic turnover</title>
      <p>A common need in biological analysis is the detection of phylogenetic signal. Such analyses are often executed using model-based statistical analyses for which APE has been primarily designed [<xref ref-type="bibr" rid="CR1">1</xref>]. A model-based approach, however, is not always applicable to every question related to phylogenetic signal. One such question is whether the changes in species between habitat types are due to phylogenetic signal in species’ gains and losses, e.g. as a result of human-caused habitat loss [<xref ref-type="bibr" rid="CR22">22</xref>]. A useful metric for calculating such a difference is the UniFrac measure [<xref ref-type="bibr" rid="CR23">23</xref>], which measures the unique and shared fractions of branches represented between communities. The TreeMan object is well suited to calculating this metric as all nodes in a tree have IDs; even if nodes are added or removed, IDs are constant. To demonstrate this we randomly generated community data with different intensities of overlap. We then ran permutation tests that detect whether there has been significant phylogenetic turnover between these communities using treeman’s calcOvrlp() (Figs. <xref rid="Fig5" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig7"><label>Fig. 7</label><caption><p>Code snippet for calculating overlap between two different communities using treeman and MoreTreeTool: generate random communities using parameters of community overlap for a random tree, plot as community trees (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>), convert trees from phylo to TreeMan using MoreTreeTool [<xref ref-type="bibr" rid="CR24">24</xref>] ’s as(), generate null communities to test whether the two communities have significant overlap</p></caption><graphic xlink:href="13104_2016_2340_Fig7_HTML" id="MO7"/></fig>
<fig id="Fig8"><label>Fig. 8</label><caption><p>Using calcOvrlp() to test for phylogenetic turnover. <italic>Left</italic>, phylogenetic trees with distributions of taxa found in two non-overlapping communities (<italic>red</italic> and <italic>blue</italic>) randomly generated with phylogenetic distance bias. The strength of this bias is determined by psi; greater psi leads to reduced overlap between communities. <italic>Right</italic>, distribution of 99 iterations for null communities’ overlap in phylogenetic diversity with <italic>red community</italic>. <italic>Red line</italic> indicates observed overlap between <italic>red</italic> and <italic>blue communities</italic>
</p></caption><graphic xlink:href="13104_2016_2340_Fig8_HTML" id="MO8"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Conclusions</title>
    <p>
TreeMan is an S4 class that encodes a phylogenetic tree using a node list. The advantage of a node list is the faster computational processing, and the ready capacity to track nodes between manipulations and vectorise or parallelise large-scale tree manipulations. The treeman package introduces new terminology to describe different elements of a tree and uses a naming convention to combine these new terms to make a more intuitive set of methods for tree manipulation. </p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec19">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="13104_2016_2340_MOESM1_ESM.r" id="MOESM1">
            <caption>
              <p><bold>Additional file 1.</bold> Pinning-with-phylo.R.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13104_2016_2340_MOESM2_ESM.r" id="MOESM2">
            <caption>
              <p><bold>Additional file 2.</bold> Edbmm with-phylo.R.</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <ack>
    <title>Authors’ contributions</title>
    <p>DJB initiated the project, developed the code and wrote the paper. STT and MDS provided supervision, ideas and critically reviewed the final manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Acknowledgements</title>
      <p>Thanks to Susy Echeverría-Londoño for testing the initial code, and to the volunteers at CRAN for making the code available.</p>
    </sec>
    <sec id="FPar2">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar3">
      <title>Availability of data and materials</title>
      <p>The datasets supporting the conclusions of this article are available in the project GitHub repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/DomBennett/treeman">https://github.com/DomBennett/treeman</ext-link>.</p>
    </sec>
    <sec id="FPar4">
      <title>Funding</title>
      <p>This project was funded by a Natural and Environmental Research Council (NERC, UK) PhD. grant.</p>
    </sec>
    <sec id="FPar5">
      <title>Software details</title>
      <p>Project name—treeman</p>
      <p>Project home page—<ext-link ext-link-type="uri" xlink:href="https://github.com/DomBennett/TreeMan">https://github.com/DomBennett/treeman</ext-link>
</p>
      <p>Operating system(s)—platform independent</p>
      <p>Programming language—R</p>
      <p>Other requirements—R v. 3+</p>
      <p>License—GPL-2</p>
      <p>Any restrictions to use by non-academics—none.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Paradis E, Blomberg S, Bolker B, Claude J, Cuong HS, Desper R, Didier G, Durand B, Dutheil J, Gascuel O. ape: Analyses of phylogenetics and evolution. 2016. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/ape/index.html">https://cran.r-project.org/web/packages/ape/index.html</ext-link>. Accessed 24 Feb 2016.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paradis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Claude</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>APE: analyses of phylogenetics and evolution in R language</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>289</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id>
        <?supplied-pmid 14734327?>
        <pub-id pub-id-type="pmid">14734327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schliep</surname>
            <given-names>KP</given-names>
          </name>
        </person-group>
        <article-title>phangorn: phylogenetic analysis in R</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>592</fpage>
        <lpage>593</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq706</pub-id>
        <?supplied-pmid 21169378?>
        <pub-id pub-id-type="pmid">21169378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Revell</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>phytools: an R package for phylogenetic comparative biology (and other things)</article-title>
        <source>Methods Ecol Evol</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>217</fpage>
        <lpage>223</lpage>
        <pub-id pub-id-type="doi">10.1111/j.2041-210X.2011.00169.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Michonneau F. phylobase: Base package for phylogenetic structures and comparative data. 2016. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/phylobase/index.html">https://cran.r-project.org/web/packages/phylobase/index.html</ext-link>. Accessed 3 Sep 2016.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faith</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Conservation evaluation and phylogenetic diversity</article-title>
        <source>Biol Conserv</source>
        <year>1992</year>
        <volume>61</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/0006-3207(92)91201-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Isaac</surname>
            <given-names>NJB</given-names>
          </name>
          <name>
            <surname>Turvey</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Collen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Baillie</surname>
            <given-names>JEM</given-names>
          </name>
        </person-group>
        <article-title>Mammals on the EDGE: conservation priorities based on threat and phylogeny</article-title>
        <source>PLoS ONE</source>
        <year>2007</year>
        <volume>2</volume>
        <issue>3</issue>
        <fpage>e296</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0000296</pub-id>
        <?supplied-pmid 17375184?>
        <pub-id pub-id-type="pmid">17375184</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>CW</given-names>
          </name>
        </person-group>
        <article-title>Phyutility: a phyloinformatics tool for trees, alignments and molecular data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>5</issue>
        <fpage>715</fpage>
        <lpage>716</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm619</pub-id>
        <?supplied-pmid 18227120?>
        <pub-id pub-id-type="pmid">18227120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bogdanowicz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Giaro</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wróbel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>TreeCmp: comparison of trees in polynomial time</article-title>
        <source>Evolut Bioinform Online.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>475</fpage>
        <lpage>487</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Csardi G. igraph: network analysis and visualization. 2015. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/igraph/index.html">https://cran.r-project.org/web/packages/igraph/index.html</ext-link>. Accessed 3 Sep 2016.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The split-apply-combine strategy for data</article-title>
        <source>J Stat Softw</source>
        <year>2011</year>
        <volume>40</volume>
        <fpage>1</fpage>
        <lpage>29</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Calaway R, Weston S, Revolution analytics. doMC: foreach parallel adaptor for ‘parallel’. 2015. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/doMC/index.html">https://cran.r-project.org/web/packages/doMC/index.html</ext-link>. Accessed 17 April 2016.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Calaway R, Weston S, Revolution analytics. doSNOW: foreach parallel adaptor for the ‘snow’ package. 2015. [<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/doSNOW/index.html">https://cran.r-project.org/web/packages/doSNOW/index.html</ext-link>]. Accessed 17 April 2016.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jetz</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Joy</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Mimoto</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mooers</surname>
            <given-names>AO</given-names>
          </name>
        </person-group>
        <article-title>PASTIS: an R package to facilitate phylogenetic assembly with soft taxonomic inferences</article-title>
        <source>Methods Ecol Evol</source>
        <year>2013</year>
        <volume>4</volume>
        <issue>11</issue>
        <fpage>1011</fpage>
        <lpage>1017</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210X.12117</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bininda-Emonds</surname>
            <given-names>ORP</given-names>
          </name>
          <name>
            <surname>Cardillo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>MacPhee</surname>
            <given-names>RDE</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>RMD</given-names>
          </name>
          <name>
            <surname>Grenyer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Vos</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gittleman</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Purvis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The delayed rise of present-day mammals</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>446</volume>
        <issue>7135</issue>
        <fpage>507</fpage>
        <lpage>512</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05634</pub-id>
        <?supplied-pmid 17392779?>
        <pub-id pub-id-type="pmid">17392779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Federhen S. The NCBI taxonomy database. Nucleic acids research, 40 (Database issue), 2012; D136–43. doi:10.1093/nar/gkr1178.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mooers</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <article-title>Inferring evolutionary process from phylogenetic tree shape</article-title>
        <source>Q Rev Biol.</source>
        <year>1997</year>
        <volume>72</volume>
        <fpage>31</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1086/419657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purvis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fritz</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Rodríguez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Harvey</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Grenyer</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The shape of mammalian phylogeny: patterns, processes and scales</article-title>
        <source>Philos Trans Royal Soc Lond B.</source>
        <year>2011</year>
        <volume>366</volume>
        <issue>1577</issue>
        <fpage>2462</fpage>
        <lpage>2477</lpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2011.0025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hagen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Steel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Age-dependent speciation can explain the shape of empirical phylogenies</article-title>
        <source>Systematic Biol.</source>
        <year>2015</year>
        <volume>64</volume>
        <issue>3</issue>
        <fpage>432</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syv001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabosky</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Goldberg</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Model inadequacy and mistaken inferences of trait-dependent speciation</article-title>
        <source>Syst Biol</source>
        <year>2015</year>
        <volume>64</volume>
        <issue>2</issue>
        <fpage>340</fpage>
        <lpage>355</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syu131</pub-id>
        <?supplied-pmid 25601943?>
        <pub-id pub-id-type="pmid">25601943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Bennett DJ, Sutton MD, Turvey ST. Evolutionarily distinct “living fossils” require both lower speciation and lower extinction rates. Paleobiology. (<bold>In press</bold>).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frishkoff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>M’Gonigle</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Loss of avian phylogenetic diversity in neotropical agricultural systems</article-title>
        <source>Science</source>
        <year>2014</year>
        <?supplied-pmid 25214627?>
        <pub-id pub-id-type="pmid">25214627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lozupone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2005</year>
        <volume>71</volume>
        <issue>12</issue>
        <fpage>8228</fpage>
        <lpage>8235</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.71.12.8228-8235.2005</pub-id>
        <?supplied-pmid 16332807?>
        <pub-id pub-id-type="pmid">16332807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Bennett DJ. MoreTreeTools: more phylogenetic tree tools in R (development copy). 2016. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/badge/latestdoi/4641/DomBennett/MoreTreeTools">https://zenodo.org/badge/latestdoi/4641/DomBennett/MoreTreeTools</ext-link>. Accessed 24 July 2016.</mixed-citation>
    </ref>
  </ref-list>
</back>
