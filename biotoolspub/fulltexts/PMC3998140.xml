<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3998140</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu019</article-id>
    <article-id pub-id-type="publisher-id">btu019</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ProbMetab: an <italic>R</italic> package for Bayesian probabilistic annotation of LC–MS-based metabolomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Silva</surname>
          <given-names>Ricardo R.</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jourdan</surname>
          <given-names>Fabien</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salvanha</surname>
          <given-names>Diego M.</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Letisse</surname>
          <given-names>Fabien</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamin</surname>
          <given-names>Emilien L.</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guidetti-Gonzalez</surname>
          <given-names>Simone</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Labate</surname>
          <given-names>Carlos A.</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vêncio</surname>
          <given-names>Ricardo Z. N.</given-names>
        </name>
        <xref ref-type="aff" rid="btu019-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu019-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btu019-AFF1"><sup>1</sup>LabPIB, Department of Computing and Mathematics FFCLRP-USP, University of Sao Paulo, Ribeirao Preto, Brazil, <sup>2</sup>INRA UMR1331, Toxalim, Research Centre in Food Toxicology, <sup>3</sup>Universit de Toulouse, INSA, UPS, INP; LISBP, Toulouse, France, <sup>4</sup>Institute for Systems Biology, Seattle, Washington, USA, <sup>5</sup>CNRS, UMR5504, Toulouse, France, <sup>6</sup>Department of Genetics ESALQ-USP, University of Sao Paulo, Piracicaba, Brazil and <sup>7</sup>Laboratorio Nacional de Ciencia e Tecnologia do Bioetanol CTBE, Campinas, Brazil</aff>
    <author-notes>
      <corresp id="btu019-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>1</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>1</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>9</issue>
    <fpage>1336</fpage>
    <lpage>1337</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>11</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>6</day>
        <month>1</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>1</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> We present ProbMetab, an R package that promotes substantial improvement in automatic probabilistic liquid chromatography–mass spectrometry-based metabolome annotation. The inference engine core is based on a Bayesian model implemented to (i) allow diverse source of experimental data and metadata to be systematically incorporated into the model with alternative ways to calculate the likelihood function and (ii) allow sensitive selection of biologically meaningful biochemical reaction databases as Dirichlet-categorical prior distribution. Additionally, to ensure result interpretation by system biologists, we display the annotation in a network where observed mass peaks are connected if their candidate metabolites are substrate/product of known biochemical reactions. This graph can be overlaid with other graph-based analysis, such as partial correlation networks, in a visualization scheme exported to Cytoscape, with web and stand-alone versions.</p>
      <p><bold>Availability and implementation:</bold> ProbMetab was implemented in a modular manner to fit together with established upstream (xcms, CAMERA, AStream, mzMatch.R, etc) and downstream R package tools (GeneNet, RCytoscape, DiffCorr, etc). ProbMetab, along with extensive documentation and case studies, is freely available under GNU license at: <ext-link ext-link-type="uri" xlink:href="http://labpib.fmrp.usp.br/methods/probmetab/">http://labpib.fmrp.usp.br/methods/probmetab/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>rvencio@usp.br</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu019/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Metabolomics is an emerging field of study in post-genomics, which aims at comprehensive analysis of small organic molecules in biological systems. Techniques of mass spectrometry coupled to liquid chromatography [liquid chromatography–mass spectrometry (LC–MS)] stand out as dominant methods in metabolomic experiments.</p>
    <p>Although computational strategies have been used to filter and annotate mass peaks in LC–MS experiments (<xref rid="btu019-B3" ref-type="bibr">Dunn <italic>et al.</italic>, 2012</xref>), these methods do not include the addition of external information into a mathematical model in a principled way. Recently, <xref rid="btu019-B7" ref-type="bibr">Rogers <italic>et al.</italic> (2009)</xref> put forward a proof-of-concept in which information incorporated to a probabilistic model provides better annotation (<xref rid="btu019-B2" ref-type="bibr">Breitling <italic>et al.</italic>, 2013</xref>). Their Bayesian model, by means of appropriate prior distribution selection, introduces the elegant idea of using a set of known chemical reactions among candidate compounds to improve annotation, as certain combinations, detected together, would make more biochemical sense than others.</p>
    <p>The state-of-the-art in probabilistic annotation established by <xref rid="btu019-B7" ref-type="bibr">Rogers <italic>et al.</italic> (2009)</xref> did not include an integrative computational implementation, a practical connection to public biological databases such as KEGG or MetaCyc (<xref rid="btu019-B1" ref-type="bibr">Altman <italic>et al.</italic>, 2013</xref>) or a network-based output visualization schema. Therefore, our contribution is to fulfill these specific needs allowing easy access to this powerful statistical model for all metabolomic bioinformatics community.</p>
  </sec>
  <sec>
    <title>2 RESULTS AND CONCLUSION</title>
    <p>The platform chosen for implementation of these ideas was the well-known and established <italic>R</italic> programming environment, which incorporates a wide range of analyses including successful tools that perform preprocessing of spectral data required for metabolite annotation (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu019/-/DC1">Supplementary Fig. S1</ext-link>) (<xref rid="btu019-B5" ref-type="bibr">Kuhl <italic>et al.</italic>, 2011</xref>; <xref rid="btu019-B10" ref-type="bibr">Smith <italic>et al.</italic>, 2006</xref>).</p>
    <p>Following <xref rid="btu019-B8" ref-type="bibr">Rogers <italic>et al.</italic> (2011)</xref> brief suggestion on how their previous method could be extended to incorporate additional experimental information and metadata, we implemented modifications to the likelihood term. Expanding the likelihood function <italic>L</italic> in multiplicative independent terms allows one to account for additional orthogonal (independent) information sources: <italic>L</italic> = <italic>L<sub>N</sub></italic> · <italic>L<sub>rt</sub></italic> · <italic>L<sub>iso</sub></italic>, where subindexes <italic>N, rt</italic> and <italic>iso</italic> stand for measurement noise model, retention time error model and isotope profile error model, respectively. For a complete model’s description, we refer the interested reader to the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu019/-/DC1">Supplementary Material</ext-link>.</p>
    <p>The main product of a probabilistic annotation is a list of compound candidates ranked by their probabilities (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu019/-/DC1">Supplementary Fig. S2</ext-link>). To easily navigate over ProbMetabs results, we display tabular and dynamic network outputs along with supporting information, which assists practitioners to ultimately decide on most parsimonious annotations instead of forcing them to simplistically rely on the top probability assignment. All mass peaks are viewed as graph’s nodes. Edges between two nodes are drawn if any candidate compound assigned to the outgoing node can be metabolized to any candidate compound assigned to the incoming node by means of a known biochemical reaction (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu019/-/DC1">Supplementary Fig. S3</ext-link>). ProbMetab is capable of producing reaction graphs and export them as standard Cytoscape input files or broadcasting the necessary graph data and attributes (colour, shapes, etc) directly to Cytoscape Desktop using RCytoscape (<xref rid="btu019-B9" ref-type="bibr">Shannon <italic>et al.</italic>, 2013</xref>). This information can be easily overlaid with other widely used systems biology strategies such as correlation or partial correlation networks. If a mass spectra time-series or biological replicates are available, ProbMetab uses third-party packages integrated downstream to export correlation or partial correlation graphs, along with their intersection/difference with the reaction graph.</p>
    <p>Alternatively, a biologist can visualize ProbMetab’s results in a simplified searchable web interface. Our package has a function that is responsible to consume an online web-service, which checks and renders the broadcast results as a web page. The visualization approach was developed taking advantage of the cytoscape.js library (<xref rid="btu019-B6" ref-type="bibr">Lopes <italic>et al.</italic>, 2010</xref>) and its dependencies and can be easily integrated or embedded into any html5 web application.</p>
    <p>ProbMetab’s documentation brings two detailed case studies in which all its features are explored. Moreover, to highlight integration with downstream and upstream third-party <italic>R</italic> packages, data analysis examples mentioned are carried out from raw data, following through preprocessing until it reaches ProbMetab’s specific point of action. We used publicly available data from <italic>Trypanosoma brucei</italic>, causative agent of sleeping sickness, and an original dataset from <italic>Saccharum officinarum</italic> (sugarcane), an important biofuel source, to illustrate several points in typical metabolomics analysis sections.</p>
    <p>The <italic>T. brucei</italic> dataset, obtained from the mzMatch.R project website, was chosen because it presents a set of metabolites identified with the aid of internal control standard compounds, being specially suited for performance evaluation. With this validation dataset, we compare the MetSamp (<ext-link ext-link-type="uri" xlink:href="http://www.dcs.gla.ac.uk/inference/metsamp/">http://www.dcs.gla.ac.uk/inference/metsamp/</ext-link>) implementation from <xref rid="btu019-B7" ref-type="bibr">Rogers <italic>et al.</italic> (2009)</xref> with ProbMetab’s implementation and show that, the efficient <italic>R</italic>/c++ integrated function (<xref rid="btu019-B4" ref-type="bibr">Eddelbuettel and François, 2011</xref>) had a 3-fold running time improvement over the MATLAB implementation. For both implementations, the higher probability candidate was the true identity in up to 60% of the metabolites. However, instead of reporting only the higher probability candidate identity as proposed by <xref rid="btu019-B7" ref-type="bibr">Rogers <italic>et al.</italic> (2009)</xref>, we show that exporting the complete ranking in summarized visualizations, up to 90% of metabolite identities are among the top three higher probabilities. The full or filtered ranking allows the experimenter to associate the candidates with additional information present in this output and attribute the correct identity.</p>
    <p>The sugarcane dataset was chosen to exemplify differential expression of annotated metabolites in contrasting environmental perturbation. We successfully recovered changes in a known stress response pathway (flavone and flavonol biosynthesis), showing the importance of a network-centric visualization for metabolite annotation to track metabolism changes. The benchmark dataset confirms, as preconceived by <xref rid="btu019-B7" ref-type="bibr">Rogers <italic>et al.</italic> (2009)</xref>, that a probabilistic model using orthogonal data and metadata yields better automatic mass peak annotation. The perturbation dataset shows that probabilistic annotation can produce otherwise impossible interpretation for differential network connectivity.</p>
    <p>We implemented a method to annotate compounds in a computational framework that allows the introduction of prior knowledge and additional spectral information. With the <italic>R</italic> package ProbMetab, we provide ways to summarize the results of series of analysis needed to extract information from complex high-dimensional MS data, and help the experimenter to track metabolism changes in the process of interest.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_9_1336__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu019_supplemental_material.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank Bruno M. Della Vecchia (USP), Dr Oscar Yanes’s team (Rovira i Virgili University) and Paul Shannon (Fred Hutchinson Cancer Research Center) for critical discussions. They thank EBI/EMBO’s courses for catalyzing cooperation among coauthors.</p>
    <p><italic>Funding</italic>: <funding-source>Microsoft Research</funding-source> and <funding-source>FAPESP</funding-source> (<award-id>09/53161-6</award-id>); <funding-source>FAPESP Temático</funding-source> grant (<award-id>08/56100-5</award-id>) and <funding-source>fellowships</funding-source> (<award-id>10/14926-4</award-id>, <award-id>12/05392-1</award-id> and <award-id>10/15417-6</award-id>); <funding-source>CAPES through Pós-graduação em Genética FMRP-USP</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu019-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altman</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A systematic comparison of the MetaCyc and KEGG pathway databases</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>112</fpage>
        <pub-id pub-id-type="pmid">23530693</pub-id>
      </element-citation>
    </ref>
    <ref id="btu019-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitling</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modeling challenges in the synthetic biology of secondary metabolism</article-title>
        <source>ACS Synth. Biol.</source>
        <year>2013</year>
        <volume>2</volume>
        <fpage>373</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="pmid">23659212</pub-id>
      </element-citation>
    </ref>
    <ref id="btu019-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mass appeal: metabolite identification in mass spectrometry-focused untargeted metabolomics</article-title>
        <source>Metabolomics</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>S44</fpage>
        <lpage>S66</lpage>
      </element-citation>
    </ref>
    <ref id="btu019-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Rcpp: seamless R and c++ integration</article-title>
        <source>J. Stat. Softw.</source>
        <year>2011</year>
        <volume>40</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
      </element-citation>
    </ref>
    <ref id="btu019-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CAMERA: an integrated strategy for compound spectra extraction and annotation of LC/MS data sets</article-title>
        <source>Anal. Chem.</source>
        <year>2011</year>
        <volume>84</volume>
        <fpage>283</fpage>
        <lpage>289</lpage>
        <pub-id pub-id-type="pmid">22111785</pub-id>
      </element-citation>
    </ref>
    <ref id="btu019-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopes</surname>
            <given-names>CT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cytoscape web: an interactive web-based network browser</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2347</fpage>
        <lpage>2348</lpage>
        <pub-id pub-id-type="pmid">20656902</pub-id>
      </element-citation>
    </ref>
    <ref id="btu019-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic assignment of formulas to mass peaks in metabolomics experiments</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>512</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">19095699</pub-id>
      </element-citation>
    </ref>
    <ref id="btu019-B8">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Stumpf</surname>
            <given-names>MPH</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Girolami</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approaches for mass spectrometry based metabolomics</article-title>
        <source>Handbook of Statistical Systems Biology</source>
        <year>2011</year>
        <publisher-name>John Wiley &amp; Sons Ltd, Chichester, UK</publisher-name>
        <fpage>467</fpage>
        <lpage>476</lpage>
      </element-citation>
    </ref>
    <ref id="btu019-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>PT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RCytoscape: tools for exploratory network analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>217</fpage>
        <pub-id pub-id-type="pmid">23837656</pub-id>
      </element-citation>
    </ref>
    <ref id="btu019-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal. Chem.</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
