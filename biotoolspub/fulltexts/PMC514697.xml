<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">514697</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-5-104</article-id>
    <article-id pub-id-type="pmid">15294028</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-5-104</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Design, implementation and evaluation of a practical pseudoknot folding algorithm based on thermodynamics</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Reeder</surname>
          <given-names>Jens</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>jreeder@techfak.uni-bielefeld.de</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Giegerich</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>robert@techfak.uni-bielefeld.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Faculty of Technology, Bielefeld University, 33615 Bielefeld, Germany</aff>
    <pub-date pub-type="collection">
      <year>2004</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>8</month>
      <year>2004</year>
    </pub-date>
    <volume>5</volume>
    <fpage>104</fpage>
    <lpage>104</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/5/104"/>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>2</month>
        <year>2004</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>8</month>
        <year>2004</year>
      </date>
    </history>
    <copyright-statement>Copyright © 2004 Reeder and Giegerich; licensee BioMed Central Ltd.</copyright-statement>
    <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
      <p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
    </license>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The general problem of RNA secondary structure prediction under the widely used thermodynamic model is known to be NP-complete when the structures considered include arbitrary pseudoknots. For restricted classes of pseudoknots, several polynomial time algorithms have been designed, where the <italic>O</italic>(<italic>n</italic><sup>6</sup>)time and <italic>O</italic>(<italic>n</italic><sup>4</sup>) space algorithm by Rivas and Eddy is currently the best available program.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We introduce the class of canonical simple recursive pseudoknots and present an algorithm that requires <italic>O</italic>(<italic>n</italic><sup>4</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space to predict the energetically optimal structure of an RNA sequence, possible containing such pseudoknots. Evaluation against a large collection of known pseudoknotted structures shows the adequacy of the canonization approach and our algorithm.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>RNA pseudoknots of medium size can now be predicted reliably as well as efficiently by the new algorithm.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <sec>
      <title>Biological relevance</title>
      <p>Pseudoknots have been shown to be functionally relevant in many RNA mediated processes. Examples are the self-splicing group I introns [<xref ref-type="bibr" rid="B1">1</xref>], ribosomal RNAs, or RNaseP. Recently, pseudoknots were located in prion proteins of humans, and confirmed for many other species [<xref ref-type="bibr" rid="B2">2</xref>]. With the current increased interest in the universe of RNA functions [<xref ref-type="bibr" rid="B3">3</xref>], algorithmic support for analysing structures that include pseudoknots is much in demand.</p>
    </sec>
    <sec>
      <title>Previous algorithmic work</title>
      <p>Well established algorithms for the prediction of RNA secondary structures (MFOLD [<xref ref-type="bibr" rid="B4">4</xref>], RNAfold [<xref ref-type="bibr" rid="B5">5</xref>]) are commonly based on a thermodynamic model [<xref ref-type="bibr" rid="B6">6</xref>], returning a structure of minimal free energy, called MFE-structure for short. In spite of their importance, pseudoknots are excluded from consideration by these programs for reasons of computational complexity: While folding a sequence of length <italic>n </italic>into unknotted structures requires <italic>O</italic>(<italic>n</italic><sup>3</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space, finding the best structure including arbitrary pseudoknots has been proved to be NP-complete [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. In fact, the proof given in [<xref ref-type="bibr" rid="B8">8</xref>] uses a scoring scheme based on adjacent base pairs only, simpler than the MFE model because it neglects entropic energies from loops. These complexity results leave two routes to achieve practical algorithms.</p>
      <p>The first route is to consider pseudoknots in full generality, but resort to an even more simplistic energy model. An <italic>O</italic>(<italic>n</italic><sup>4</sup>) time and <italic>O</italic>(<italic>n</italic><sup>3</sup>) space algorithm for base pair maximization has been given in [<xref ref-type="bibr" rid="B7">7</xref>], and an <italic>O</italic>(<italic>n</italic><sup>3</sup>) time algorithm based on maximum weight matching in [<xref ref-type="bibr" rid="B9">9</xref>] and [<xref ref-type="bibr" rid="B10">10</xref>].</p>
      <p>The second route is the one followed here: We retain the established thermodynamic model, but restrict to a more tractable subclass of pseudoknots. For some quite general classes of pseudoknots, polynomial time algorithms have been designed: Rivas and Eddy achieve <italic>O</italic>(<italic>n</italic><sup>6</sup>) time and <italic>O</italic>(<italic>n</italic><sup>4</sup>) space [<xref ref-type="bibr" rid="B11">11</xref>]. This algorithm is available, and, in spite of the high computational cost, it is actually used in practice. We build upon this work and shall call it <italic>pknotsRE </italic>for later reference. Further improvements have been shown to be possible for yet more restricted classes, e.g. the non-recursive simple pseudoknots considered by Lyngsø and Pedersen [<xref ref-type="bibr" rid="B12">12</xref>] with <italic>O</italic>(<italic>n</italic><sup>5</sup>) time and <italic>O</italic>(<italic>n</italic><sup>4</sup>) space, but to our knowledge, no implementations are available. Recently, an <italic>O</italic>(<italic>n</italic><sup>4</sup>) time and <italic>O</italic>(<italic>n</italic><sup>3</sup>) space algorithm based on the technique of [<xref ref-type="bibr" rid="B7">7</xref>], that uses a thermodynamic model has been reported in [<xref ref-type="bibr" rid="B13">13</xref>]. While it handles simple pseudoknots consisting of more than two helices, it is restricted to non-recursive pseudoknots. Thus, this class of pseudoknots and the class presented here have a nonempty intersection, but neither of them contains the other.</p>
    </sec>
    <sec>
      <title>Our contributions</title>
      <p>The new contributions reported here are the following:</p>
      <p>• We present an algorithm <italic>pknotsRG </italic>for folding RNA secondary structures including pseudoknots under the MFE model which requires <italic>O</italic>(<italic>n</italic><sup>4</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space.</p>
      <p>• The algorithm considers the class of simple recursive pseudoknots, further restricted by three rules of canonization. Each simple recursive pseudoknot has a canonical representative that is recognized by <italic>pknotsRG</italic>.</p>
      <p>• While this class is more restricted than the one of the Rivas/Eddy algorithm, practical evaluation shows that our algorithm finds the same pseudoknots, while the length range of tractable sequences is increased significantly.</p>
      <p>• We provide an evaluation of the class of pseudoknots introduced here against known examples from the literature.</p>
      <p>• We perform a rigorous evaluation of our algorithm on 212 sequences from PseudoBase [<xref ref-type="bibr" rid="B14">14</xref>] plus 7 other structures and compare our results with those obtained with <italic>RNAfold </italic>and, where feasible, with <italic>pknotsRE</italic>.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>It is not easy to relate the classes of pseudoknots recognized by the different algorithms mentioned above. We refer the reader to the review by Lyngsø and Pedersen [<xref ref-type="bibr" rid="B8">8</xref>], which compares these classes by means of examples. The starting point of our work is the algorithm <italic>pknotsRE </italic>by Rivas and Eddy. It recognizes pseudoknots that can be nested and can have unlimited chains of helices involved in crosswise interactions. The drawback of this powerful, but computationally expensive algorithm is the following paradox: Pseudoknots with complex helix interactions naturally require longer primary sequence than simpler ones. The high runtime complexity of <italic>O</italic>(<italic>n</italic><sup>6</sup>), however, as well as the space consumption of <italic>O</italic>(<italic>n</italic><sup>4</sup>) restricts the use of this algorithm to a maximal sequence length of around 150 nucleotides. Most of the pseudoknots predicted belong to a much simpler structural class and do not exhibit chains of crosswise interactions.</p>
    <p>The algorithm developed here achieves time complexity <italic>O</italic>(<italic>n</italic><sup>4</sup>) and space complexity <italic>O</italic>(<italic>n</italic><sup>2</sup>). The runtime improvement, compared to <italic>pknotsRE</italic>, results from an idea of canonization, while the space improvement results from disallowing chained pseudoknots. These improvements extend the range of tractable sequences to a length up to 800 nucleotides, and we can locate pseudoknots up to this size in even longer sequences.</p>
    <sec>
      <title>Simple recursive pseudoknots</title>
      <p>Following the terminology of [<xref ref-type="bibr" rid="B7">7</xref>], a <italic>simple </italic>pseudoknot is a crosswise interaction of two helices, as shown in Figure <xref ref-type="fig" rid="F1">1</xref>. In simple <italic>recursive </italic>pseudoknots, we allow the unpaired strands <italic>u, v, w </italic>in a simple pseudoknot to fold internally in an arbitrary way, including simple recursive pseudoknots. Let us call this class sr-PK. More complex knotted structures like triple crossing helices or kissing hairpins, as shown in Figure <xref ref-type="fig" rid="F4">4</xref>, are excluded from sr-PK. We will show later how they can be integrated in our approach and outline the increased computational cost of doing so. For the main part of this paper, we concentrate on the class sr-PK.</p>
    </sec>
    <sec>
      <title>Anticipating the complexity of a DP algorithm</title>
      <p>Thermodynamic RNA folding is implemented via dynamic programming (DP). We start with a semi-formal discussion of how to estimate the efficiency of a DP algorithm for folding (or any kind of motif search) <italic>before </italic>it is written in detail. We consider elements of RNA structure as sequence motifs of different types: hairpins, bulges, multiloops, etc. The following notation is taken from the algebraic dynamic programming approach [<xref ref-type="bibr" rid="B15">15</xref>]. By an equation</p>
      <p>m = f &lt;&lt;&lt; a ~~~ b ~~~ c | | | g &lt;&lt;&lt; c ~~~ a</p>
      <p>we specify that the sequence motif <italic>m </italic>can be composed in two alternative ways: The first case, labelled by <italic>f</italic>, requires adjacent occurrences of motifs <italic>a</italic>, <italic>b </italic>and <italic>c</italic>. The second case, labelled by <italic>g</italic>, requires adjacent occurrences of motifs <italic>c </italic>and <italic>a</italic>. When motif <italic>m </italic>is to be scored, <italic>f </italic>and <italic>g </italic>are seen as the scoring functions that combine the local score contribution of each case with the scores of sub-motifs <italic>a</italic>, <italic>b</italic>, and <italic>c</italic>.</p>
      <p>What is the computational effort of locating motif <italic>m </italic>in an input sequence <italic>x </italic>of length <italic>n</italic>, say at sequence positions <italic>i </italic>through <italic>j? </italic>First we assume that all motifs can have arbitrary size between 0 and <italic>n</italic>. The algorithm must consider all boundary positions (<italic>i, j</italic>) for motif <italic>m</italic>, which requires <italic>O</italic>(<italic>n</italic><sup>2</sup>) steps at least. In case <italic>g</italic>, it must consider all boundary positions <italic>k </italic>where motifs <italic>c </italic>meets <italic>a</italic>, such that the runtime for case <italic>g </italic>is in <italic>O</italic>(<italic>n</italic><sup>3</sup>). In case <italic>f</italic>, there are two such moving boundaries <italic>k </italic>and <italic>l </italic>between the three sub-motifs, so we obtain <italic>O</italic>(<italic>n</italic><sup>4</sup>) overall for motif <italic>m</italic>.</p>
      <p>This can be improved if there is an upper bound on the size of some motif involved. If motif <italic>a </italic>is a single base, for example, the exponent of <italic>n </italic>decreases by 1 in both cases. Furthermore, if motif <italic>b </italic>is (say) a loop of maximal size 40, then one factor of <italic>n </italic>is reduced to a constant factor and overall asymptotic runtime is now <italic>O</italic>(<italic>n</italic><sup>2</sup>). Sometimes a motif description can be restructured to improve efficiency by reducing the number of moving boundaries. Whether or not this is possible does not depend on the motif structure, but on the scoring scheme! This is a somewhat surprising observation from [<xref ref-type="bibr" rid="B15">15</xref>], where such optimizations are studied, and where also the line of reasoning exercised here is given a mathematical basis.</p>
      <p>In the sequel, we shall exploit another source of efficiency improvement. If the lengths of two sub-motifs are coupled somehow, say <italic>a </italic>and <italic>c </italic>have the same length, then the boundaries <italic>k </italic>and <italic>l </italic>in case <italic>f </italic>are related by <italic>k </italic>- <italic>i </italic>= <italic>j </italic>- <italic>l</italic>. When iterating over <italic>k</italic>, we can use <italic>l </italic>:= <italic>j </italic>- <italic>k </italic>+ <italic>i </italic>(rather than <italic>k </italic>≤ <italic>l </italic>≤ <italic>j</italic>)and save another factor of <italic>n</italic>.</p>
    </sec>
    <sec>
      <title>Canonization</title>
      <p>When the search space of a combinatorial problem seems to be too complex to be evaluated efficiently, heuristics are employed. Canonization restricts the search space in a well-defined way, arguing that all the relevant solutions in the full search space have a representative that is canonical, and hence, nothing relevant is overlooked. One such technique is the purging of structures that have isolated basepairs. Here the plausibility argument refers to the underlying energy model, where base pairings without stacking have little or no stabilizing effect. This canonization does not affect efficiency, but it achieves a significant reduction of the search space (figures in [<xref ref-type="bibr" rid="B16">16</xref>]), which renders the enumeration of near-optimal solutions [<xref ref-type="bibr" rid="B17">17</xref>] much more meaningful.</p>
      <p>We shall introduce three canonization rules that reduce class sr-PK to the class of <italic>canonized simple recursive pseudoknots</italic>, csr-PK. Using the notation introduced above, the motif definition of a simple recursive pseudoknot is given by</p>
      <p>knot = knt &lt;&lt;&lt; a ~~~ u ~~~ b ~~~ v ~~~ a' ~~~ w ~~~ b'</p>
      <p>with boundaries at sequence positions <italic>i, e, k, g, f, l, h, j </italic>as shown in Figure <xref ref-type="fig" rid="F2">2</xref>.</p>
      <p>Segment <italic>a </italic>forms a helix with <italic>a</italic>', and <italic>b </italic>with <italic>b'</italic>. Segments <italic>u</italic>, <italic>v</italic>, and <italic>w </italic>can have arbitrary structures, including pseudoknots. Naively implemented, we can expect a DP algorithm of time complexity <italic>O</italic>(<italic>n</italic><sup>8</sup>) according to our efficiency estimation technique introduced above. We now apply canonization. Note that it only applies to helices forming pseudoknots; other helices are unaffected. We first present the technical aspects; the discussion of these restrictions is deferred to the next section.</p>
      <sec>
        <title>Canonization rule 1</title>
        <p>(a) Both strands in a helix must have the same length, i.e. |<italic>a</italic>| = |<italic>a</italic>'| and |<italic>b</italic>| = |<italic>b</italic>'|. (b) Both helices must not have bulges.</p>
        <p>Note that (b) is a stronger restriction and trivially implies (a). Under the regime of Rule 1 we may conclude:</p>
        <p><italic>f </italic>= <italic>l </italic>- (<italic>e </italic>- <italic>i</italic>)</p>
        <p><italic>h </italic>= <italic>j </italic>- (<italic>g </italic>- <italic>k</italic>)</p>
        <p>We are left with 6 out of 8 boundaries that vary independently, and runtime is down to <italic>O</italic>(<italic>n</italic><sup>6</sup>).</p>
      </sec>
      <sec>
        <title>Canonization rule 2</title>
        <p>The helices <italic>a</italic>, <italic>a' </italic>and <italic>b</italic>, <italic>b' </italic>facing each other must have maximal extent, or in other words, compartment <italic>v </italic>must be as short as possible under the rules of base pairing.</p>
        <p>We observe that the maximal length of <italic>a </italic>and <italic>a' </italic>is fixed once <italic>i </italic>and <italic>l </italic>are chosen. The maximal helix length <italic>stacklen</italic>(<italic>i, l</italic>) can be precomputed and stored in an <italic>O</italic>(<italic>n</italic><sup>2</sup>) table. The same observation holds with respect to the other helix, and we fix</p>
        <p><italic>e </italic>= <italic>i </italic>+ <italic>stacklen</italic>(<italic>i, l</italic>)</p>
        <p><italic>g </italic>= <italic>k </italic>+ <italic>stacklen</italic>(<italic>k, j</italic>).</p>
        <p>Thus, we are left with only four independently moving boundaries – <italic>i, k, l, j </italic>–, and can hope to obtain an algorithm with runtime O(<italic>n</italic><sup>4</sup>). Scores of pseudoknots found between <italic>i </italic>and <italic>j </italic>are stored in table <italic>knot</italic>(<italic>i, j</italic>), and hence the space requirements are O(<italic>n</italic><sup>2</sup>), which is the same asymptotic space efficiency as in the folding of unknotted structures.</p>
        <p>A subtlety arises when both helices, chosen maximally, compete for the same bases of <italic>v</italic>, or in other words, the length of <italic>v </italic>would become negative. This case is addressed by</p>
      </sec>
      <sec>
        <title>Canonization rule 3</title>
        <p>If two maximal helices would overlap, their boundary is fixed at an arbitrary point between them.</p>
        <p>Let <italic>m </italic>and <italic>m' </italic>be the helix lengths so determined. We finally obtain</p>
        <p><italic>e </italic>= <italic>i </italic>+ <italic>m</italic></p>
        <p><italic>g </italic>= <italic>k </italic>+ <italic>m'</italic></p>
        <p>The language of pseudoknots in class csr-PK can be defined by a simple context free grammar over an infinite terminal alphabet. Let <italic>a</italic><sup><italic>k </italic></sup>denote a terminal symbol of <italic>k </italic>times the letter <italic>a</italic>. The grammar uses a single nonterminal symbol <italic>S </italic>and its productions are</p>
        <p>
          <inline-graphic xlink:href="1471-2105-5-104-i1.gif"/>
        </p>
        <p>for arbitrary <italic>k, l </italic>≥ 1. For example, the simple pseudoknot of Figure <xref ref-type="fig" rid="F1">1</xref> is represented as the string</p>
        <p>.. [[[......{{..]]]]..........}}.</p>
        <p>This grammar is useful to judge how different an experimentally determined structure is from class csr-PK. It is not useful for programming, since it is ambiguous and does not distinguish the fine grained level of detail required in the energy model.</p>
      </sec>
    </sec>
    <sec>
      <title>Canonical representatives</title>
      <p>A careful discussion is required to show that each simple recursive pseudoknot, if not canonical by itself, has (a) a canonical representative of (b) similar free energy.</p>
      <p>Rule 1 (b) affects the length of helices that are considered in forming the pseudoknot. Let there be a pseudoknot between <italic>i' </italic>and <italic>j'</italic>. It is not canonical if one of the two helices contains bulges. However, there must be at least one pair of shorter helices without bulges at <italic>i, j </italic>with <italic>i' ≤ i </italic>and <italic>j </italic>≤ <italic>j'</italic>, which serves as a canonical representative, albeit with somewhat higher free energy.</p>
      <p>Rule 2 is justified by the fact that the energy model strongly favours helix extension. Clearly, for each family of pseudoknots delineated by <italic>i, k</italic>, <italic>l</italic>, <italic>j </italic>there is a canonical one with maximal helices, whose free energy is at least as low – except for the following case: The maximal helices compete with the internal structure of <italic>u</italic>, <italic>v </italic>and <italic>w</italic>. It may be possible to contrive a structure where shortening (say) helix <italic>a – a' </italic>by one base pair allows to create two pairs with new partner bases in <italic>u </italic>and <italic>v</italic>, resulting in a structure which has slightly lower energy. Still, the free energy of the canonical pseudoknot must be very similar.</p>
      <p>Finally, Rule 3 requires a decision where to draw the border between two helices facing each other and competing for the same bases. An arbitrary decision here can only slightly affect free energy, as the same base pairs are stacked either on the a – <italic>a' </italic>or the <italic>b – b' </italic>helix.</p>
      <p>Let <italic>E</italic>(<italic>s</italic>) denote the free energy computed for structure <italic>s</italic>. Summing up, we have shown that for each simple recursive pseudoknot <italic>K</italic>, there is a canonical one <italic>C </italic>in the search space. While we cannot prove that <italic>E</italic>(<italic>C</italic>) ≤ <italic>E</italic>(<italic>K</italic>), we have argued that this is likely, and if not, the energies will at least be close. Still, there might be another, energetically optimal canonical structure <italic>S </italic>(knotted or not) such that <italic>E</italic>(<italic>K</italic>) &lt;<italic>E</italic>(<italic>S</italic>) &lt;<italic>E</italic>(<italic>C</italic>). In this case, if only the "best" structure <italic>S </italic>is reported, neither <italic>K </italic>nor its canonical representative <italic>C </italic>is observed. (A remedy to this is the computation of near-optimal structures.)</p>
      <p>Finally, let us add that the implementation described below is actually slightly more general that the "pure" csr-PK model described above: We do allow a single nucleotide bulge in either helix of a pseudoknot, which complicates the program, but does not affect asymptotic efficiency.</p>
    </sec>
    <sec>
      <title>Evaluation of the class csr-PK</title>
      <p>To evaluate how well the class csr-PK covers known pseudoknots, we considered 212 pseudoknot structures from PseudoBase. The observations are shown in Table <xref ref-type="table" rid="T1">1</xref>.</p>
      <p>We find 172 simple recursive pseudoknots, and 40 of more general shapes. We find that 135 out of the 172 pseudoknots lie in csr-PK, i.e. they are their own canonical representatives. 11 more fall into the relaxed csr-PK, where we allow a single nucleotide bulge in Canonization Rule 1. Thus, we cover 146 out of 212 (68%). 26 simple recursive pseudoknot do not fall in class csr-PK, since they contain isolated basepairs, non canonical basepairs or one of the helices has not maximal extent.</p>
      <p>Considering the remaining 20% complex pseudoknots, note that often pseudoknots in more general classes also have a good representative in csr-PK. For example, the pseudoknot of Hepatitis delta virus (Figure <xref ref-type="fig" rid="F3">3</xref>) consists of four interacting helices of shape <italic>a – b – c – d – c' – a' – d' – b</italic>', where helix <italic>d – d' </italic>is very short – only two base pairs. Deleting it, helix <italic>c – c' </italic>is no longer interacting with other helices, and the pseudoknot falls within class csr-PK.</p>
    </sec>
    <sec>
      <title>Better than optimal </title>
      <p>There are many reasons why "the" MFE structure may only be part of what we want to know about a molecule's foldings. To deal with the problem when the optimal (knotted) structure is non-canonical, and its canonical representative is dominated by an unrelated structure, we provide two means: First of all, our algorithm is non-ambiguous, the prerequisite for a non-redundant enumeration of near-optimal structures [<xref ref-type="bibr" rid="B16">16</xref>]. We can let the program to report the <italic>k </italic>best structures. Secondly, we shall provide three variants of our program:</p>
      <p><italic>pknotsRG-mfe </italic>computes the mfe structure (or the k best), pseudoknotted or not.</p>
      <p><italic>pknotsRG-enf </italic>picks out from the folding space the energetically best structure that contains at least one pseudoknot.</p>
      <p><italic>pknotsRG-loc </italic>computes the energetically best pseudoknot that can be formed locally, i. e. somewhere in the sequence. "Best" is defined here as minimal free energy per base, to avoid a built-in bias towards large pseudoknots.</p>
      <p>The best local pseudoknot motif is included by adding two cases:</p>
      <p>bestPK = skipleft &lt;&lt;&lt; base ~~~ bestPK ||| bestPKl</p>
      <p>bestPKl = skipright&lt;&lt;&lt; bestPKl ~~~ base ||| knot</p>
      <p>These clauses have time complexity <italic>O</italic>(<italic>n</italic><sup>2</sup>) and preserve the non-ambiguity of the algorithm. If desired, an enumeration of near-optimal "local" pseudoknots is also feasible.</p>
    </sec>
    <sec>
      <title>Predictive accuracy</title>
      <p>We first consider the predictive accuracy achieved by our approach. We have already evaluated the class csr-PK against the known pseudoknots, and we know that our algorithm correctly implements this class in its search space. What is really tested in the following is the adequacy of the current thermodynamic model (which our algorithm shares with <italic>RNAfold </italic>and in an older version with <italic>pknotsRE</italic>), and the results in this section may improve if this model is further improved in the future.</p>
      <p>We test our algorithm on the set of sequences listed in Table <xref ref-type="table" rid="T2">2</xref>, including 212 sequences from PseudoBase. Although there is some redundancy on the sequence level, there is a good reason why we found it important to use all available sequences for testing: Even near identical sequences can have different MFE structures, or a small change may prevent successful pseudoknot prediction. In contrast to [<xref ref-type="bibr" rid="B13">13</xref>] we did not restrict the evaluation to the class of pseudoknots recognized by our program. It is also instructive to retain the difficult cases, and see whether the predictions catch at least some aspect of a more general pseudoknot.</p>
      <p>We compare our results to the output of <italic>RNAfold</italic>, as a representative for RNA folding tools without pseudoknot folding capability, and to <italic>pknotsRE </italic>where computationally feasible. For each predicted structure we count the number of correctly and falsely predicted base pairs (TP and FP). Let BP be the number of basepairs in the reference structure from the database or literature. We define the sensitivity as (TP/BP), selectivity as (TP/TP+FP).</p>
      <p>In Table <xref ref-type="table" rid="T3">3</xref> we list the prediction accuracy for our sequence set. For all sequences we enhance the prediction accuracy with respect to <italic>RNAfold</italic>. Both, the sensitivity and the selectivity increase. Compared to <italic>pknotsRE </italic>our results are slightly better, probably because we are using the newer and subtler energy model. For example, for the sequence of hepatitis delta virus, our algorithm predicts all helices except for the very short helix 5 (see Figure <xref ref-type="fig" rid="F3">3</xref>), while the other programs miss more than 50% of the basepairs.</p>
      <p>We also folded 14 randomly selected human tRNAs (third line in Table <xref ref-type="table" rid="T3">3</xref>) and found only one false positive pseudoknot. Interestingly, the pseudoknotted structure has two helices (9 bp) in common with the true clover-leaf structure, while the structure computed by <italic>RNAfold </italic>has only one helix (4 bp). For all programs the overall prediction accuracy for tRNAs is not very high. tRNAs are a known hard case for structure prediction because they contain many modified bases.</p>
      <p>Since we use the same energy model as <italic>RNAfold </italic>and our algorithm does not introduce spurious pseudoknots, predictions of <italic>RNAfold </italic>and <italic>pknotsRG </italic>for unknotted structures are identical. Of course, if there is more than one optimal structure, each of the optimal alternatives may be reported and thus the same folding can not be guaranteed.</p>
    </sec>
    <sec>
      <title>Computational performance</title>
      <p>Clearly, we are able to fold sequences that are longer than <italic>pknotsRE's </italic>limit of 150 nucleotides. Short sequences up to 100 nucleotides are folded within a minute. Long sequences (400 bp) take about 2 hours (see Table <xref ref-type="table" rid="T4">4</xref>). If we restrict the maximal pseudoknot size to a reasonable constant, say 150 nucleotides, we can further increase the running time. The algorithm runs now in <italic>O</italic>(<italic>cn</italic><sup>3</sup>) with a rather large constant <italic>c</italic>. This enables us to fold sequence of length 1000 in approximately 12 hours. We can further observe that the space requirements scale quadratically with the input size, as expected.</p>
      <p>For a fair comparison, the reader should keep in mind that the extra time spent by <italic>pknotsRE </italic>is not strictly wasted: It is spent on assuring that the optimal folding of the input RNA sequence does not contain pseudoknots with chained interacting helices of lower free energy than the reported structure. <italic>pknotsRG </italic>does not consider such structures and hence cannot make this assertion.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In the following, we discuss extensions of the implemented model and their expected computational cost</p>
    <sec>
      <title>Bulges, triple crossing and kissing hairpins</title>
      <p>Canonization Rule 1 can be relaxed further to allow larger bulges inside the helices forming a pseudoknot. As long as their number (and hence the length difference of the two arms of a helix) is bounded by a constant, asymptotic efficiency is not affected.</p>
      <p>Two examples of non-simple pseudoknots are shown in Figure <xref ref-type="fig" rid="F4">4</xref>. We can incorporate them into our algorithm adding the definitions</p>
      <p>kiss = kss &lt;&lt;&lt; a~~~u~~~b~~~v~~~a'~~~w~~~c~~~x~~~b'~~~y~~~c'</p>
      <p>triple = trp &lt;&lt;&lt; a~~~u~~~b~~~v~~~c~~~w~~~a'~~~x~~~b'~~~y~~~c'</p>
      <p>Canonization can be applied as above, with Rule 3 becoming more sophisticated for the triple interaction case. This would yield an algorithm of runtime <italic>O</italic>(<italic>n</italic><sup>6</sup>), bringing runtime back to the efficiency class of the Rivas/Eddy algorithm. But note that the space requirements remain <italic>O</italic>(<italic>n</italic><sup>2</sup>). This is due to the fact that we now consider three interacting helices, but not arbitrary chains.</p>
    </sec>
    <sec>
      <title>Folding long sequences</title>
      <p>RNA folding <italic>in vivo </italic>as <italic>in vitro </italic>must be understood as a hierarchical process, where small structures in close vicinity form first, and then combine to larger ones [<xref ref-type="bibr" rid="B18">18</xref>]. The folding path becomes relevant, and the longer a sequence, the more unlikely it is that its folding path leads to a global energy minimum. In other words, the longer the sequence, the less reliable are the results of minimum free energy folding. <italic>pknotsRG </italic>gives us the possibility to test this using a fairly large structure containing pseudoknots that have been proved experimentally. We considered the sequence of the group I intron from Tetrahymena thermophila (419 NT) (V01416).</p>
      <p>The MFE-structure found was quite different from the "true" structure taken from the literature. We hand-coded the experimental structure and evaluated its stability in our energy model. The result was striking: the experimental structure (-132.26 kcal/mole) was significantly far from the possible minimum of free energy (-155.64 kcal/mole). So far in fact that it seems infeasible to detect the structure by scanning the space of near-optimal structures. This could be interpreted as the energy model being incorrect, but since it works well for short sequences, we suggest that this is an indication that the kinetics of folding already have a strong influence with this size of sequence, at least when pseudoknots are involved.</p>
      <p>While we have achieved a considerable speedup for predicting small pseudoknotted structures, it seems that minimum free energy approach is not meaningful with the largest structures which it now can handle algorithmically. However, the situation changes when we are looking for particular structural motifs (see below).</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We presented an algorithm <italic>pknotsRG-mfe</italic>, based on the MFE-model, for finding the best RNA structure including the pseudoknot class csr-PK. This requires <italic>O</italic>(<italic>n</italic><sup>4</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space. The algorithm variant <italic>pknotsRG-enf </italic>returns the energetically best structure that contains a pseudoknot (interesting when the MFE structure is unknotted), while <italic>pknotsRG-loc </italic>reports the best pseudoknot (under a length-normalized energy score) <italic>somewhere </italic>in a sequence. We achieve a high prediction accuracy for moderate length sequences, whereas long sequences, at least when pseudoknots are involved, seem to have a folding scheme that cannot be modelled with minimum free energy folding.</p>
    <p>Algorithm <italic>pknotsRG </italic>is based on a simpler grammar model than the crossed interaction grammars [<xref ref-type="bibr" rid="B19">19</xref>] underlying <italic>pknotsRE</italic>, as well as the communicating grammars underlying the recent approach by Cai [<xref ref-type="bibr" rid="B20">20</xref>]. It requires only a minor extension over the ADP tree grammars that are applicable to a wide range of sequence analysis problems [<xref ref-type="bibr" rid="B21">21</xref>]. Furthermore, the grammar is not only a theoretical backup, explaining the underlying model. With minor annotation for the sake of efficiency, the grammar actually constitutes executable code. This means that <italic>pknotsRG </italic>can serve as a template for a new class of programs we call thermodynamic matchers.</p>
    <p>Many functionally important RNAs like RNase P or group-I-introns have known structures that include pseudoknots. The search for such motifs using combinatorial matchers like RNAmotif [<xref ref-type="bibr" rid="B22">22</xref>] is hampered by the problem that a motif description is either too specific and misses relevant instances, or else it is too vague and produces a large number of different matches to the same sequence. We suggest to develop <italic>thermodynamic matchers</italic>, which are RNA folding programs, based on the established MFE model, but specialized to the particular structural motif at hand. Such a matcher returns the optimal way to fold a sequence into the motif structure, together with the free energy of this folding. Comparing this energy to the MFE of an unrestricted folding can give us a hint with respect to the significance of such a match.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Choice of implementation method</title>
      <p>Using the ideas presented so far, our folding algorithm can be implemented in any language suitable for dynamic programming, say FORTRAN or C. However, we are interested in a reusable implementation that can be integrated without change in specialized folding programs called thermodynamic matchers. Therefore <italic>pknotsRG </italic>was implemented using the method of algebraic dynamic programming (ADP) [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B23">23</xref>].</p>
    </sec>
    <sec>
      <title>RNA folding in ADP</title>
      <p>In ADP, the search space of a DP problem is defined on a declarative level, specified by clauses like the ones we have already seen above. Together they form a tree grammar, defining a tree language whose elements are all the candidates in the search space. In our case, the candidates are RNA structures represented as trees. The typical DP recurrences are implicit in this description. Scoring is achieved by interpreting the operators (e.g., <italic>knt, skipleft, skipright</italic>) that build the trees as scoring functions. The grammar needs to be annotated with respect to tabulation and the application of the objective function (in our case, minimization).</p>
      <p>The advantage of this method is its high level of abstraction. No subscripts, no errors. The perfect separation of search space definition and evaluation allows the same grammar to be used for different kinds of analyses, e. g. folding space statistics. Relevant algorithmic properties such as non-ambiguity and efficiency can be studied on this level of abstraction. Last not least, an ADP program can be executed as is, avoiding the explicit formulation of DP recurrences (and a whole universe of programming errors). A significant, but constant factor of speedup can be gained by explicitly formulating the recurrences and implementing them in a lower level language. Automating this process is part of our current work.</p>
      <p>We start from an ADP algorithm for folding RNA secondary structures (excluding pseudoknots) provided by Dirk Evers [<xref ref-type="bibr" rid="B24">24</xref>]. We show ADP clauses defining the closed substructures: stacks, hairpins, bulges, and multiloops, adding an alternative for pseudoknots. region denotes an arbitrary sequence of (unpaired) bases.</p>
      <p>
        <inline-graphic xlink:href="1471-2105-5-104-i2.gif"/>
      </p>
      <p>The shown code abstracts from efficiency annotation and the treatment of dangling bases. The complete algorithm is found on the ADP WWW pages [<xref ref-type="bibr" rid="B25">25</xref>]. It is based on the standard MFE model with dangling bases, is non-ambiguous and requires <italic>O</italic>(<italic>n</italic><sup>3</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space. A size constraint of 30 is used to bound loop length in internal loops. Closed substructures are defined such as to avoid lonely base pairs. While all this is easily expressed within the standard ADP framework, our new algorithm requires extensions which are now explained.</p>
    </sec>
    <sec>
      <title>Adding pseudoknots</title>
      <p>The implementation strictly follows the outline given in the methods section, except that a considerable amount of detail related to the energy model has to be taken care of. While ADP bans the use of subscripts, our canonization ideas require to explicitly manipulate subscripts. We show the concrete pseudoknot code, but explain only the essential points. A subscript pair (<italic>i, j</italic>) denotes input sequence positions <italic>inp</italic><sub><italic>i</italic>+1</sub>.. .<italic>inp</italic><sub><italic>j</italic></sub>. [...] denotes lists, and &lt;- denotes enumerating a list of alternative values.</p>
      <p>knot (i, j) = [pk energy a u b v a' w b' | k &lt;-[i+2 .. j-1], l&lt;-[k+1 .. j-2],</p>
      <p>These line chooses <italic>k </italic>and <italic>l </italic>from the interval (<italic>i, j</italic>), and put together the results from <italic>a</italic>, <italic>u</italic>, <italic>b</italic>, <italic>v, a'</italic>, <italic>w, b' </italic>under the scoring function <italic>pk</italic>. Each helix must have a minimum length of two bases. Due to stereochemical reasons one base in the front part and two bases in the back part are left explicitly unpaired; these bases should bridge the stacks. This consideration is taken over from <italic>pknotsRE</italic>. The next definitions implement canonization rules 1, 2 and 3. They determine the helix lengths, finally computed into the variables <italic>m </italic>and <italic>m'</italic>. If either of them is smaller than 2, a pseudoknot is not possible at this particular location.</p>
      <p>
        <inline-graphic xlink:href="1471-2105-5-104-i3.gif"/>
      </p>
      <p>The function <italic>cut </italic>shortens the helix <italic>b – b' </italic>as much as necessary in case of overlapping helices. The next lines define the pseudoknot components <italic>a </italic>through <italic>b</italic>', plus the local energy contribution. To avoid an extra factor of <italic>n </italic>in time complexity, the energies of maximal length helices are also precomputed in table <italic>stackenergy</italic>. If the helix <italic>b – b' </italic>must be chosen shorter than maximal to avoid overlap, a correction term has to be subtracted. This explains the negative term in the energy computation.</p>
      <p>
        <inline-graphic xlink:href="1471-2105-5-104-i4.gif"/>
      </p>
      <p>Left to be defined are the interior structures front, middle, and back. For reasons of space, we only show the definition of <italic>front</italic>. For a full implementation of the algorithm see <xref ref-type="supplementary-material" rid="S1">additional file 1</xref>.</p>
      <p>
        <inline-graphic xlink:href="1471-2105-5-104-i5.gif"/>
      </p>
      <p>This case takes care of a potentially dangling base from the <italic>b</italic>-helix, and if the remaining region is not empty, an arbitrary list of substructures (<italic>comps</italic>) is recognized. <italic>idd, frd </italic>and <italic>pul </italic>are the corresponding functions from the energy model.</p>
      <p>Overall, the energy of a pseudoknot consists of stabilizing and destabilizing terms. Where possible, we use the values from the current thermodynamic energy model [<xref ref-type="bibr" rid="B6">6</xref>]. As stabilizing terms we count the nearest neighbour stacking energies of the pseudoknot helices and contributions of dangling bases at both ends of each helix. If the length of the middle part <italic>v </italic>is smaller or equal to 1, the pseudoknot helices stack coaxially on each other and we further add the appropriate stacking energy. In [<xref ref-type="bibr" rid="B11">11</xref>] a pseudoknot initiation parameter of 7 kcal/mole is proposed. However, we found out, that setting this value to 9 kcal/mole performs better with the new energy model. Our observation supports the similar choice made by Dirks and Pierce [<xref ref-type="bibr" rid="B26">26</xref>]. Finally, we penalize each unpaired nucleotide inside a pseudoknot loop with 0.3 kcal/mole. This seems to be the best approximation of the values given in [<xref ref-type="bibr" rid="B27">27</xref>]. Of course, if the pseudoknot is recursive the energy of the subcomponent is taken into account as well.</p>
      <p>The first clause (knot) chooses <italic>k, l </italic>inside (<italic>i, j</italic>), computes <italic>m </italic>and <italic>m' </italic>using the precomputed maximal helix information, and passes these boundaries to the pseudoknot compartments. Methodically, this is a use of inherited attributes with the underlying tree grammar, and appears to be a novel technique in dynamic programming, at least in its grammar oriented tradition [<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B28">28</xref>-<xref ref-type="bibr" rid="B30">30</xref>].</p>
      <p>The relative effort of implementing the three variants of <italic>pknotsRG </italic>can be judged from the sizes of the tree grammars required, which are summarized in Table <xref ref-type="table" rid="T5">5</xref>.</p>
    </sec>
    <sec>
      <title>Availability</title>
      <p>The three variants of the algorithm <italic>pknotsRG-mfe, pknotsRG-enf</italic>, and <italic>pknotsRG-loc </italic>are available as executables and source code on the Bielefeld Bioinformatics Server [<xref ref-type="bibr" rid="B31">31</xref>].</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contribution</title>
    <p>RG had the initial idea for the algorithm. JR developed and evaluated the software. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>Source code of pknotsRG-mfe</p>
      </caption>
      <media xlink:href="1471-2105-5-104-S1.LHS" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgement</title>
      <p>We gratefully acknowledge the help of Dirk Evers, whose ADP code for folding unknotted structures served as a starting point for our implementation. Marc Rehmsmeier helped with some delicate algorithmic aspects. Peter Steffen acted as a semi-automated compiler of ADP code into C. We also thank Elena Rivas for discussing effects of canonization at an early stage of this work.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cech</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Conserved sequences and structures of group I introns: building an active site for RNA catalysis–A review</article-title>
        <source>Gene</source>
        <year>1988</year>
        <volume>73</volume>
        <fpage>259</fpage>
        <lpage>271</lpage>
        <pub-id pub-id-type="pmid">3072259</pub-id>
        <pub-id pub-id-type="doi">10.1016/0378-1119(88)90492-1</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barette</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Poisson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gendron</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Pseudoknots in prion protein mRNAs confirmed by comparative sequence analysis and pattern searching</article-title>
        <source>Nucleic Acids Research</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>753</fpage>
        <lpage>758</lpage>
        <pub-id pub-id-type="pmid">11160898</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/29.3.753</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dennis</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The brave new world of RNA</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>418</volume>
        <fpage>122</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="pmid">12110860</pub-id>
        <pub-id pub-id-type="doi">10.1038/418122a</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sankoff</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structures and their prediction</article-title>
        <source>Bull Math Biol</source>
        <year>1984</year>
        <volume>46</volume>
        <fpage>591</fpage>
        <lpage>621</lpage>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Fontana</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bonhoeffer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tacker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Fast folding and comparison of RNA secondary structures</article-title>
        <source>Monatshefte Chemie</source>
        <year>1994</year>
        <volume>125</volume>
        <fpage>167</fpage>
        <lpage>188</lpage>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sabina</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1999</year>
        <volume>288</volume>
        <fpage>911</fpage>
        <lpage>940</lpage>
        <pub-id pub-id-type="pmid">10329189</pub-id>
        <pub-id pub-id-type="doi">10.1006/jmbi.1999.2700</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akutsu</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Dynamic programming algorithms for RNA secondary structure prediction with pseudoknots</article-title>
        <source>Discrete Applied Mathematics</source>
        <year>2000</year>
        <volume>104</volume>
        <fpage>45</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1016/S0166-218X(00)00186-4</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lyngsø</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RNA pseudoknot prediction in energy based models</article-title>
        <source>Journal of Computational Biology</source>
        <year>2001</year>
        <volume>7</volume>
        <fpage>409</fpage>
        <lpage>428</lpage>
        <pub-id pub-id-type="doi">10.1089/106652700750050862</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabaska</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Cary</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Gabow</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>An RNA folding method capable of identifying pseudoknots and base triples</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>691</fpage>
        <lpage>699</lpage>
        <pub-id pub-id-type="pmid">9789095</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.8.691</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>An iterated loop matching approach to the prediction of RNA secondary structures with pseudoknots</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>58</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="pmid">14693809</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg373</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A dynamic programming algorithm for RNA structure prediction including pseudoknots</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1999</year>
        <volume>285</volume>
        <fpage>2053</fpage>
        <lpage>2068</lpage>
        <pub-id pub-id-type="pmid">9925784</pub-id>
        <pub-id pub-id-type="doi">10.1006/jmbi.1998.2436</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lyngsø</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>Pseudoknots in RNA secondary structures</article-title>
        <source>In Proceedings of the fourth annual international conference on computational molecular biology</source>
        <year>2000</year>
        <publisher-name>ACM Press</publisher-name>
        <fpage>201</fpage>
        <lpage>209</lpage>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Deogun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Donis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Komina</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction with simple pseudoknots</article-title>
        <source>In Proc Second Asia-Pacific Bioinformatics Conference 2004</source>
        <year>2004</year>
        <fpage>239</fpage>
        <lpage>246</lpage>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="other">
        <article-title>PseudoBase homepage</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://wwwbio.LeidenUniv.nl/~Batenburg/PKB.html"/>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Kirchner H, Ringeissen C</surname>
          </name>
        </person-group>
        <article-title>Algebraic Dynamic Programming</article-title>
        <source>In Algebraic Methodology And Software Technology, 9th International Conference, AMAST 2002</source>
        <year>2002</year>
        <publisher-name>Saint-Gilles-les-Bains, Reunion Island, France: Springer LNCS 2422</publisher-name>
        <fpage>349</fpage>
        <lpage>364</lpage>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Explaining and controlling ambiguity in dynamic programming</article-title>
        <source>In Proc Combinatorial Pattern Matching</source>
        <year>2000</year>
        <publisher-name>Springer Verlag</publisher-name>
        <fpage>46</fpage>
        <lpage>59</lpage>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wuchty</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fontana</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Complete suboptimal folding of RNA and the stability of secondary structures</article-title>
        <source>Biopolymers</source>
        <year>1998</year>
        <volume>49</volume>
        <fpage>145</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0282(199902)49:2&lt;145::AID-BIP4&gt;3.3.CO;2-7</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tinoco</surname>
            <given-names>I</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>How RNA folds</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1999</year>
        <volume>293</volume>
        <fpage>271</fpage>
        <lpage>281</lpage>
        <pub-id pub-id-type="pmid">10550208</pub-id>
        <pub-id pub-id-type="doi">10.1006/jmbi.1999.3001</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>The language of RNA: a formal grammar that includes pseudoknots</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>334</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">10869031</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/16.4.334</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Malmberg</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Stochastic modeling of RNA pseudoknotted structures: a grammatical approach</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>66</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg1007</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Steffen</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A discipline of dynamic programming over sequence data</article-title>
        <source>Science of Computer Programming</source>
        <year>2004</year>
        <volume>51</volume>
        <fpage>215</fpage>
        <lpage>263</lpage>
        <pub-id pub-id-type="doi">10.1016/j.scico.2003.12.005</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gutell</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gautheret</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Case</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sampath</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNAMotif, an RNA secondary structure definition and search algorithm</article-title>
        <source>Nucleid Acids Research</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>4724</fpage>
        <lpage>4735</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/29.22.4724</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A systematic approach to dynamic programming in bioinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>665</fpage>
        <lpage>677</lpage>
        <pub-id pub-id-type="pmid">11099253</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/16.8.665</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Evers</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>RNA folding via algebraic dynamic programming</article-title>
        <source>PhD thesis, Universität Bielefeld, Technische Fakultät</source>
        <year>2003</year>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="other">
        <article-title>Algebraic Dynamic Programming home page</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bibiserv.techfak.uni-bielefeld.de/adp"/>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dirks</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>A partition function algorithm for nucleic acid secondary structure including pseudoknots</article-title>
        <source>Journal of Computational Chemistry</source>
        <year>2003</year>
        <volume>24</volume>
        <fpage>1664</fpage>
        <lpage>1677</lpage>
        <pub-id pub-id-type="pmid">12926009</pub-id>
        <pub-id pub-id-type="doi">10.1002/jcc.10296</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gultyaev</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>van Batenburg</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pleij</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>An approximation of loop free energy values of RNA H-pseudoknots</article-title>
        <source>RNA</source>
        <year>1999</year>
        <volume>5</volume>
        <fpage>609</fpage>
        <lpage>617</lpage>
        <pub-id pub-id-type="pmid">10334330</pub-id>
        <pub-id pub-id-type="doi">10.1017/S135583829998189X</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Searls</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Linguistic approaches to biological sequences</article-title>
        <source>CABIOS</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>333</fpage>
        <lpage>344</lpage>
        <pub-id pub-id-type="pmid">9283748</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lefebvre</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A grammar-based unification of several alignment and folding algorithms</article-title>
        <source>In Proceedings 4th ISMB</source>
        <year>1996</year>
        <publisher-name>AAAI Press, Menlo Park, CA, USA</publisher-name>
        <fpage>143</fpage>
        <lpage>154</lpage>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Evers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Reducing the conformation space in RNA structure prediction</article-title>
        <source>In German Conference on Bioinformatics</source>
        <year>2001</year>
        <fpage>118</fpage>
        <lpage>124</lpage>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <collab>BibiServ</collab>
        </person-group>
        <article-title>Bielefeld Bioinformatics Server</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bibiserv.techfak.uni-bielefeld.de/"/>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferré-D'Amaré</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Doudna</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Crystal structure of a hepatitis delta virus ribozyme</article-title>
        <source>Nature</source>
        <year>1998</year>
        <volume>395</volume>
        <fpage>567</fpage>
        <lpage>674</lpage>
        <pub-id pub-id-type="pmid">9783582</pub-id>
        <pub-id pub-id-type="doi">10.1038/26912</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rijk</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Wuyts</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wachter</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>RnaViz2: an improved representation of RNA secondary structure</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>299</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="pmid">12538259</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/19.2.299</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tuerk</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>MacDougal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gold</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>RNA pseudoknots that inhibit Human Immunodeficiency Virus Type 1 Reverse Transcriptase</article-title>
        <source>PNAS</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>6988</fpage>
        <lpage>6992</lpage>
        <pub-id pub-id-type="pmid">1379730</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deiman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kortlever</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pleij</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The role of the pseudoknot at the 3' end of turnip yellow mosaic virus RNA in minus-strand synthesis by the viral RNA-dependent RNA polymerase</article-title>
        <source>J Virol</source>
        <year>1997</year>
        <volume>71</volume>
        <fpage>5990</fpage>
        <lpage>5996</lpage>
        <pub-id pub-id-type="pmid">9223489</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Belkum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abrahams</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Pleij</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Bosch</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Five pseudoknots are present at the 204 nucleotides long 3' noncoding region of tobacco mosaic virus RNA</article-title>
        <source>Nucleic Acid Research</source>
        <year>1985</year>
        <volume>13</volume>
        <fpage>7673</fpage>
        <lpage>7686</lpage>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>A simple pseudoknot. </bold>A simple pseudoknot, formed by helices <italic>a – a' </italic>and <italic>b – b'</italic>, with intervening sequences <italic>u, v, w</italic>. If the internal parts <italic>u, v, w </italic>contain further secondary structures, we call it a simple recursive pseudoknot.</p>
      </caption>
      <graphic xlink:href="1471-2105-5-104-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>The boundaries of a pseudoknot. </bold>Eight moving boundaries delineating a simple recursive pseudoknot.</p>
      </caption>
      <graphic xlink:href="1471-2105-5-104-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>The pseudoknot of Hepatitis Delta Virus. </bold>On the left side the structure proposed by [32], on the right the MFE-structure predicted by <italic>pknotsRG</italic>. Our algorithm misses only the short helix 5 and adds 3 basepairs to helix 4. Image created with RnaViz2 [33].</p>
      </caption>
      <graphic xlink:href="1471-2105-5-104-3"/>
    </fig>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p><bold>Kissing hairpins and triple helix interaction. </bold>Two examples of more complex pseudoknots with three helices: Kissing hairpins (left) and triple helix interaction (right).</p>
      </caption>
      <graphic xlink:href="1471-2105-5-104-4"/>
    </fig>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Class membership of 212 pseudoknots from PseudoBase. The sequences were determined by comparative sequence analysis and/or by experimental techniques. The largest class of pseudoknots is simple recursive or even canonical simple recursive.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="center" colspan="6">simple recursive pseudoknots</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center">csr-PK</td>
            <td align="center">1-nt bulge</td>
            <td align="center">Rule 2 violated</td>
            <td align="center">isolated basepair</td>
            <td align="center">G-A basepair</td>
            <td align="center">total</td>
          </tr>
          <tr>
            <td colspan="6">
              <hr/>
            </td>
          </tr>
          <tr>
            <td align="center">135</td>
            <td align="center">11</td>
            <td align="center">6</td>
            <td align="center">17</td>
            <td align="center">3</td>
            <td align="center">172</td>
          </tr>
          <tr>
            <td colspan="6">
              <hr/>
            </td>
          </tr>
          <tr>
            <td align="center" colspan="6">complex pseudoknots</td>
          </tr>
          <tr>
            <td colspan="6">
              <hr/>
            </td>
          </tr>
          <tr>
            <td align="center">internal loop</td>
            <td align="center">triple helix</td>
            <td align="center">four helices</td>
            <td align="center">kissing hairpins</td>
            <td align="center">large bulge</td>
            <td align="center">total</td>
          </tr>
          <tr>
            <td colspan="6">
              <hr/>
            </td>
          </tr>
          <tr>
            <td align="center">23</td>
            <td align="center">12</td>
            <td align="center">1</td>
            <td align="center">3</td>
            <td align="center">1</td>
            <td align="center">40</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T2">
      <label>Table 2</label>
      <caption>
        <p>Sequences used for testing</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="right">Sequence</td>
            <td align="center">Length</td>
            <td align="center">BP</td>
            <td align="center">Reference</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right">PseudoBase</td>
            <td align="center">variable</td>
            <td align="center">variable</td>
            <td align="center">[14]</td>
          </tr>
          <tr>
            <td align="right">7 HIVRT</td>
            <td align="center">35</td>
            <td align="center">11</td>
            <td align="center">[34]</td>
          </tr>
          <tr>
            <td align="right">14 tRNAs</td>
            <td align="center">71–82</td>
            <td align="center">18–19</td>
            <td/>
          </tr>
          <tr>
            <td align="right">HDV</td>
            <td align="center">87</td>
            <td align="center">32</td>
            <td align="center">[32]</td>
          </tr>
          <tr>
            <td align="right">ag-HDV</td>
            <td align="center">91</td>
            <td align="center">25</td>
            <td align="center">[32]</td>
          </tr>
          <tr>
            <td align="right">TYMV</td>
            <td align="center">86</td>
            <td align="center">24</td>
            <td align="center">[35]</td>
          </tr>
          <tr>
            <td align="right">TMV (up)</td>
            <td align="center">85</td>
            <td align="center">25</td>
            <td align="center">[36]</td>
          </tr>
          <tr>
            <td align="right">STNV</td>
            <td align="center">252</td>
            <td align="center">69</td>
            <td align="center">GenBank:M64479</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T3">
      <label>Table 3</label>
      <caption>
        <p>Evaluation of predictive accuracy <italic>TP </italic>= true positives, sens. = sensitivity, <italic>FP </italic>= false positives, sel. = selectivity, <italic>K </italic>= (number of correct predicted pseudoknot helices)/ (expected number of pseudoknot helices). False negatives can be derived from: <italic>FN </italic>= <italic>BP </italic>– <italic>TP</italic>. For HIVRT, PseudoBase and tRNA the average over all sequences is taken.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td/>
            <td/>
            <td align="center" colspan="3">RNAfold</td>
            <td align="center" colspan="3">pknotsRE</td>
            <td align="center" colspan="3">pknotsRG-mfe</td>
          </tr>
          <tr>
            <td align="left">Sequence</td>
            <td align="left">BP</td>
            <td align="center"><italic>TP</italic>(sens.)</td>
            <td align="center">FP(sel.)</td>
            <td align="center">K</td>
            <td align="center">TP(sens.)</td>
            <td align="center">FP(sel.)</td>
            <td align="center">K</td>
            <td align="center">TP(sens.)</td>
            <td align="center">FP(sel.)</td>
            <td align="center">K</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">PseudoBase</td>
            <td align="left">13.1</td>
            <td align="right">7.1(54.2)</td>
            <td align="right">4.4(61.9)</td>
            <td align="right">-</td>
            <td align="right">9.2(72.3)</td>
            <td align="right">3.8(70.7)</td>
            <td align="right">-</td>
            <td align="right">10.2(77.3)</td>
            <td align="right">3.5(74.7)</td>
            <td align="right">-</td>
          </tr>
          <tr>
            <td align="left">HIVRT</td>
            <td align="left">11</td>
            <td align="right">4.7(42.8)</td>
            <td align="right">1.7(73.3)</td>
            <td align="right">1/2</td>
            <td align="right">11(100)</td>
            <td align="right">0(100)</td>
            <td align="right">2/2</td>
            <td align="right">11(100)</td>
            <td align="right">0(100)</td>
            <td align="right">2/2</td>
          </tr>
          <tr>
            <td align="left">tRNAs</td>
            <td align="left">18.7</td>
            <td align="right">9.4(50.4)</td>
            <td align="right">12.5(43.0)</td>
            <td align="right">0/0</td>
            <td align="right">-</td>
            <td align="right">-</td>
            <td align="right">-</td>
            <td align="right">9.8(52.3)</td>
            <td align="right">12.2(44.5)</td>
            <td align="right">0/0</td>
          </tr>
          <tr>
            <td align="left">HDV</td>
            <td align="left">32</td>
            <td align="right">12(37.5)</td>
            <td align="right">16(42.9)</td>
            <td align="right">2/4</td>
            <td align="right">14(43.8)</td>
            <td align="right">16(46.7)</td>
            <td align="right">2/4</td>
            <td align="right">29(90.6)</td>
            <td align="right">2(93.5)</td>
            <td align="right">3/4</td>
          </tr>
          <tr>
            <td align="left">ag-HDV</td>
            <td align="left">25</td>
            <td align="right">4(16.0)</td>
            <td align="right">24(14.3)</td>
            <td align="right">1/2</td>
            <td align="right">24(96.0)</td>
            <td align="right">9(72.7)</td>
            <td align="right">2/2</td>
            <td align="right">21(84.0)</td>
            <td align="right">11(65.6)</td>
            <td align="right">2/2</td>
          </tr>
          <tr>
            <td align="left">TYMV</td>
            <td align="left">24</td>
            <td align="right">17(70.8)</td>
            <td align="right">6(73.9)</td>
            <td align="right">1/2</td>
            <td align="right">24(100)</td>
            <td align="right">1(96.0)</td>
            <td align="right">2/2</td>
            <td align="right">23(95.8)</td>
            <td align="right">2(92.0)</td>
            <td align="right">2/2</td>
          </tr>
          <tr>
            <td align="left">TMV</td>
            <td align="left">25</td>
            <td align="right">13(52.0)</td>
            <td align="right">8(61.9)</td>
            <td align="right">3/6</td>
            <td align="right">13(52.0)</td>
            <td align="right">9(59.1)</td>
            <td align="right">3/6</td>
            <td align="right">20(80.0)</td>
            <td align="right">4(83.3)</td>
            <td align="right">6/6</td>
          </tr>
          <tr>
            <td align="left">STNV</td>
            <td align="left">69</td>
            <td align="right">26(37.7)</td>
            <td align="right">54(32.5)</td>
            <td align="right">2/8</td>
            <td align="right">-</td>
            <td align="right">-</td>
            <td align="right">-</td>
            <td align="right">42(60.9)</td>
            <td align="right">37(53.2)</td>
            <td align="right">5/8</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T4">
      <label>Table 4</label>
      <caption>
        <p>Performance results Performance results for random RNA sequences and comparison to <italic>pknotsRE</italic>. The performance of <italic>pknotsRG-loc </italic>is similar to <italic>pknotsRG-mfe </italic>and therefore not shown. The bounded version restricts pseudoknots to a maximum length of 150 nucleotides; measured on an UltraSPARC CPU with 450 MHz and 4 GB main memory. Time is measured in (h:m:s), memory in MB.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="center">Length</td>
            <td align="center" colspan="2">pknotsRE</td>
            <td align="center" colspan="2">pknotsRG-mfe</td>
            <td align="center" colspan="2">pknotsRG-enf</td>
            <td align="center" colspan="2">pknotsRG-enf bounded</td>
          </tr>
          <tr>
            <td/>
            <td align="center">Time</td>
            <td align="center">Mem.</td>
            <td align="center">Time</td>
            <td align="center">Mem.</td>
            <td align="center">Time</td>
            <td align="center">Mem.</td>
            <td align="center">Time</td>
            <td align="center">Mem.</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center">40</td>
            <td align="center">17.4</td>
            <td align="center">-</td>
            <td align="center">0.7</td>
            <td align="center">1</td>
            <td align="center">0.9</td>
            <td align="center">2</td>
            <td align="center">0.9</td>
            <td align="center">2</td>
          </tr>
          <tr>
            <td align="center">80</td>
            <td align="center">21:11</td>
            <td align="center">38</td>
            <td align="center">9.5</td>
            <td align="center">5</td>
            <td align="center">8.7</td>
            <td align="center">5</td>
            <td align="center">8.8</td>
            <td align="center">5</td>
          </tr>
          <tr>
            <td align="center">100</td>
            <td align="center">1:23:50</td>
            <td align="center">80</td>
            <td align="center">20.0</td>
            <td align="center">8</td>
            <td align="center">32.5</td>
            <td align="center">10</td>
            <td align="center">34.5</td>
            <td align="center">9</td>
          </tr>
          <tr>
            <td align="center">200</td>
            <td align="center">-</td>
            <td align="center">-</td>
            <td align="center">6:46</td>
            <td align="center">36</td>
            <td align="center">8:03</td>
            <td align="center">42</td>
            <td align="center">6:33.6</td>
            <td align="center">42</td>
          </tr>
          <tr>
            <td align="center">300</td>
            <td align="center">-</td>
            <td align="center">-</td>
            <td align="center">33:07</td>
            <td align="center">80</td>
            <td align="center">44:58</td>
            <td align="center">102</td>
            <td align="center">20:48.4</td>
            <td align="center">90</td>
          </tr>
          <tr>
            <td align="center">400</td>
            <td align="center">-</td>
            <td align="center">-</td>
            <td align="center">1:48:08</td>
            <td align="center">146</td>
            <td align="center">2:28:18</td>
            <td align="center">184</td>
            <td align="center">45:28.9</td>
            <td align="center">155</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T5">
      <label>Table 5</label>
      <caption>
        <p>Program sizes</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">Program variant</td>
            <td align="center">Nonterminals</td>
            <td align="center">Productions</td>
            <td align="center">Tables</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">pknotsRG-mfe</td>
            <td align="center">27</td>
            <td align="center">74</td>
            <td align="center">8</td>
          </tr>
          <tr>
            <td align="left">pknotsRG-loc</td>
            <td align="center">27</td>
            <td align="center">68</td>
            <td align="center">8</td>
          </tr>
          <tr>
            <td align="left">pknotsRG-enf</td>
            <td align="center">40</td>
            <td align="center">119</td>
            <td align="center">11</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
</back>
