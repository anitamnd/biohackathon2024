<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6929295</article-id>
    <article-id pub-id-type="publisher-id">6380</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-019-6380-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An improved catalogue of putative synaptic genes defined exclusively by temporal transcription profiles through an ensemble machine learning approach</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4980-1071</contrib-id>
        <name>
          <surname>Pazos Obregón</surname>
          <given-names>Flavio</given-names>
        </name>
        <address>
          <email>fpazos@iibce.edu.uy</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Palazzo</surname>
          <given-names>Martín</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Soto</surname>
          <given-names>Pablo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guerberoff</surname>
          <given-names>Gustavo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yankilevich</surname>
          <given-names>Patricio</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cantera</surname>
          <given-names>Rafael</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2323 2857</institution-id><institution-id institution-id-type="GRID">grid.482688.8</institution-id><institution>Neurodevelopmental Biology Department, </institution><institution>Instituto de Investigaciones Biológicas Clemente Estable, </institution></institution-wrap>Montevideo, Uruguay </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1945 2152</institution-id><institution-id institution-id-type="GRID">grid.423606.5</institution-id><institution>Instituto de Investigación en Biomedicina de Buenos Aires (IBioBA), </institution><institution>CONICET - Partner Institute of the Max Planck Society, </institution></institution-wrap>Buenos Aires, Argentina </aff>
      <aff id="Aff3"><label>3</label>Instituto de Matemática y Estadística “Prof. Ing. Rafael Laguardia”, Facultad de Ingeniería, UDELAR, Montevideo, Uruguay </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>1011</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Assembly and function of neuronal synapses require the coordinated expression of a yet undetermined set of genes. Previously, we had trained an ensemble machine learning model to assign a probability of having synaptic function to every protein-coding gene in <italic>Drosophila melanogaster</italic>. This approach resulted in the publication of a catalogue of 893 genes which we postulated to be very enriched in genes with a still undocumented synaptic function. Since then, the scientific community has experimentally identified 79 new synaptic genes. Here we use these new empirical data to evaluate our original prediction. We also implement a series of changes to the training scheme of our model and using the new data we demonstrate that this improves its predictive power. Finally, we added the new synaptic genes to the training set and trained a new model, obtaining a new, enhanced catalogue of putative synaptic genes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">The retrospective analysis demonstrate that our original catalogue was significantly enriched in new synaptic genes. When the changes to the training scheme were implemented using the original training set we obtained even higher enrichment. Finally, applying the new training scheme with a training set including the 79 new synaptic genes, resulted in an enhanced catalogue of putative synaptic genes. Here we present this new catalogue and announce that a regularly updated version will be available online at: <ext-link ext-link-type="uri" xlink:href="http://synapticgenes.bnd.edu.uy/">http://synapticgenes.bnd.edu.uy</ext-link></p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We show that training an ensemble of machine learning classifiers solely with the whole-body temporal transcription profiles of known synaptic genes resulted in a catalogue with a significant enrichment in undiscovered synaptic genes. Using new empirical data provided by the scientific community, we validated our original approach, improved our model an obtained an arguably more precise prediction. This approach reduces the number of genes to be tested through hypothesis-driven experimentation and will facilitate our understanding of neuronal function.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p id="Par4">
          <ext-link ext-link-type="uri" xlink:href="http://synapticgenes.bnd.edu.uy/">http://synapticgenes.bnd.edu.uy</ext-link>
        </p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Synaptic genes</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Temporal transcription profiles</kwd>
      <kwd>Gene function prediction</kwd>
      <kwd>
        <italic>Drosophila melanogaster</italic>
      </kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008725</institution-id>
            <institution>Agencia Nacional de Investigación e Innovación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FSDA_1_2017_1_142427</award-id>
        <award-id>POS_NAC_2016_1_129915</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pazos Obregón</surname>
            <given-names>Flavio</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Sistema Nacional de Investigadores (UY)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par5">The synapse, a specialized contact between neurons, is currently of fundamental importance for our understanding of learning, memory and other brain functions. Assembly and function of neuronal synapses require the coordinated expression of a yet undetermined set of genes, which for simplicity will be called here “synaptic genes”. There is a broad consensus that only a fraction of the total number of synaptic genes have been identified so far [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Due to the evolutionary conservation among synaptic genes, the knowledge obtained from studies in model organisms is very relevant for other species, including humans [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par6">Since the biological roles of the vast majority of known amino acid sequences remain partly or completely unknown [<xref ref-type="bibr" rid="CR4">4</xref>], computational prediction of gene function is an open research problem of much relevance. In recent years diverse methodologies have been assayed, with a strong prevalence of machine learning approaches. The top-performing algorithms, architectures and training schemes are function-specific and context-dependent [<xref ref-type="bibr" rid="CR5">5</xref>]. In a previous study [<xref ref-type="bibr" rid="CR6">6</xref>], we implemented an ensemble machine learning model that assigned a probability of being a “synaptic gene” to each protein-coding gene of <italic>Drosophila melanogaster.</italic> The features to infer the synaptic function were the whole-body transcription levels of all protein-coding genes at 24 developmental stages, published by the modENCODE project [<xref ref-type="bibr" rid="CR7">7</xref>]. As far as we know, this is the only study that predicts gene function relying exclusively on temporal transcriptions profiles obtained through NGS technologies. After an exhaustive bibliographic review, a set of genes for which a function in synapse formation and/or maturation, and/or neurotransmission, and/or plasticity and/or maintenance had been experimentally demonstrated was selected as a positive example and included in the training set. Genes fulfilling any of two biological criteria defined ad hoc were selected as negatives examples [<xref ref-type="bibr" rid="CR6">6</xref>] (See Methods and Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Our model intersected the results of three learning algorithms: k-nearest neighbours (kNN) [<xref ref-type="bibr" rid="CR8">8</xref>], Random Forest (RF) [<xref ref-type="bibr" rid="CR9">9</xref>], Support Vector Machines (SVM) [<xref ref-type="bibr" rid="CR10">10</xref>]. These algorithms had been chosen after obtaining similar results with these and other algorithms during an exploratory study and because they are widely used and among those with the best average performance when applied to biological data [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The classification threshold of the algorithms was set to meet the expected number of unknown synaptic genes (estimated a priori) at that time. We obtained a catalogue that we postulated to be highly enriched in genes for which a synaptic function was yet to be discovered.</p>
    <p id="Par7">Following the publication of that catalogue, scientists around the world have experimentally identified 79 new synaptic genes (NSG), giving us the opportunity to empirically evaluate the predictive power of the catalogue. Thereafter we tested a new training scheme and evaluated it by measuring the enrichment in NSG of the resulting catalogues. Briefly, the tested training scheme includes randomly sub-sampling the available labelled data to train a number of models and then ensemble those models in only one classifier (see Methods). This new training scheme is meant to alleviate a probable bias of our model due to a relatively small training set [<xref ref-type="bibr" rid="CR13">13</xref>]. We found that the new training scheme resulted in a model producing a catalogue more enriched in NSG. Finally, we added the 79 NSG to the training set and trained a new model with the new training scheme. With this new model we obtained the new, enhanced catalogue of putative synaptic genes that we are publishing here. The whole procedure is schematized in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. A monthly updated version of this catalogue will be available online at: <ext-link ext-link-type="uri" xlink:href="http://synapticgenes.bnd.edu.uy">http://synapticgenes.bnd.edu.uy</ext-link>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Scheme of the work-flow used to obtain the new catalogue of putative synaptic genes. First, we trained two models with the original training set, one with the original training scheme and one with the new training scheme (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Then we compared the enrichment in new synaptic genes (NSG, see Methods for definition of enrichment) of the catalogues resulting from each method. After testing that the new training scheme improved the prediction (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), we incorporated the 79 NSG to the training set, trained a new model with the new training scheme and obtained a new catalogue of putative synaptic genes</p></caption><graphic xlink:href="12864_2019_6380_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Evaluation of the original catalogue</title>
      <p id="Par8">Since the publication of our original catalogue up to the preparation of this manuscript, we identified 79 <italic>Drosophila</italic> genes that had gathered enough experimental evidence to be considered a synaptic gene according to our previous criteria [<xref ref-type="bibr" rid="CR6">6</xref>]. Additional file <xref rid="MOESM2" ref-type="media">2</xref> lists these genes along with the references supporting their synaptic functions. Roughly a third of these NSG (28 genes) were present in our original catalogue. A standard approach to evaluate the overrepresentation of certain feature (in this case, being a NSG) in a list of genes is to perform enrichment analysis (see Methods). Using in-house scripts and the hypergeometric distribution we calculated the enrichment in NSG of our original catalogue and its associated <italic>p</italic>-value. We found our original catalogue has an enrichment in NSG of 4.38 with a <italic>p</italic>-value &lt; 10<sup>− 10</sup>
<bold>(</bold>Table <xref rid="Tab1" ref-type="table">1</xref><bold>)</bold>.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Evaluation of our original prediction. Comparison between the results of the original model, a model trained with the original training set but with the new training scheme and a model trained with the new training scheme and the updated training set. The enrichment in NSG found in the catalogue obtained with the new training scheme is 38% higher than that found in the catalogue obtained with the original training scheme even though both models were trained with the same set of genes. The training set for the new model includes the 79 NSG, thus the enrichment in NSG of the resulting catalogues cannot be defined</p></caption><graphic position="anchor" xlink:href="12864_2019_6380_Tab1_HTML" id="MO2"/></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Improved training scheme</title>
      <p id="Par9">The changes to the training scheme of our model tested here are detailed in the Methods section and schematized in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison between the original and the improved models. Original model (above): with the whole training set we trained three algorithms: kNN, SVM and Random Forest. The hyper parameters of each classifier were set by exhaustive grid search combined with 10-fold cross validation over the training set. Finally, we increased the classification threshold of the classifiers and considered the intersection between the resulting catalogues. Improved model (below): first, we sub-sampled five times the original training set, leaving out each time a different fifth of the positive and negative examples. By this procedure we obtained five smaller, slightly different training sets. Using the positive and negative examples left out in each iteration, we created five test sets, used to independently evaluate each classifier. With each training set we trained three algorithms: kNN, SVM and Random Forest, thus obtaining 15 different classifiers. The hyper parameters of each classifier were set by exhaustive grid search combined with 10-fold cross validation over the training set. After training, we evaluated each classifier (accuracy, ROC and F1) using a different test set. Finally, we increased the classification threshold of the classifiers and considered the intersection between the resulting catalogues</p></caption><graphic xlink:href="12864_2019_6380_Fig2_HTML" id="MO3"/></fig></p>
      <p id="Par10">To test if these changes improved the predictive performance of our approach, we trained a model implementing these changes with the original training set and then compared the results with those of the original model. As shown in Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the changes resulted in a better predictive power measured as enrichment in NSG. This improvement is also observed when we considered each classification algorithm separately (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a-c). The performance of the intersection of the classifiers trained with the sub-samples of the training set was always better than that of the performance of the classifier trained with the full training set. By intersection of the classifiers for a given threshold we mean the set of genes that were assigned with a probability above the threshold by the 3 classifiers simultaneously.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison between the original and the improved model. Enrichment in NSG for an increasing classification threshold. <bold>a</bold>: kNN, <bold>b</bold>: SVM, <bold>c</bold>: Random Forest, <bold>d</bold>: Intersection of the three algorithms. For a definition of enrichment see Methods. In each panel, the red line represents the results of the original model, the gray lines represent the results of the models obtained after training the corresponding algorithm with each sub-sample of the original training set and the black line shows the results of the intersection of these last models</p></caption><graphic xlink:href="12864_2019_6380_Fig3_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Evaluation of the new classifiers</title>
      <p id="Par11">After demonstrating that the proposed changes to the training scheme and ensemble rules would have resulted in a series of catalogues more enriched in NSG, we incorporated the 79 NSG to the training set and repeated the whole procedure described above, obtaining 15 new classifiers. Each of these classifiers was evaluated with an independent test set, which was used to calculate the accuracy, the F1 score and the area under the ROC curve (Fig.<xref rid="Fig2" ref-type="fig">2</xref> and Table <xref rid="Tab2" ref-type="table">2</xref>). The obtained values were compared with those reported by other colleagues when training models to predict other biological functions [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>].
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Evaluation of the 15 classifiers. Fifteen classifiers were obtained by training three algorithms with five different training sets. The performance of each classifier was evaluated using a test set conformed by genes that were not used during training. The table shows the mean and standard deviation of the accuracy, the F1 score and the area under the ROC curve of the five classifiers trained with each algorithm. The last three rows show the area under the ROC obtained by other colleagues when predicting other biological functions through machine learning</p></caption><graphic position="anchor" xlink:href="12864_2019_6380_Tab2_HTML" id="MO5"/></table-wrap></p>
    </sec>
    <sec id="Sec6">
      <title>A new catalogue of putative synaptic genes</title>
      <p id="Par12">We trained a new model incorporating the 79 NSG to the training set and the changes to the training scheme. In our original work only those genes assigned with a probability of being synaptic of at least 0.9 by the three classifiers were included in the final catalogue. This high classification threshold was set to obtain a catalogue of a given size. Now the threshold was set at 0.95 because we aimed to obtain a smaller catalogue since there are fewer unknown synaptic genes. The resulting catalogue had 601 genes.</p>
    </sec>
    <sec id="Sec7">
      <title>Enrichment of the new catalogue in synapse-related GO terms</title>
      <p id="Par13">To evaluate the quality of the new catalogue, we determined its enrichment in synapse-related GO terms. This could be done because we constructed our training set without taking into account Gene Ontology. We found that 83 of the 601 genes to which our 15 classifiers assigned a probability above 0.95 had some synapse-related GO annotation. To determine whether this is a significant enrichment, all the genes in our training set that have some synapse-related GO annotation must be removed from the background set. This analysis was performed with Gorilla [<xref ref-type="bibr" rid="CR17">17</xref>] and the results are shown in Table <xref rid="Tab3" ref-type="table">3</xref>. After excluding from the catalogue these 83 genes a final catalogue of 518 putative synaptic genes was obtained (Additional file <xref rid="MOESM3" ref-type="media">3</xref>).
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Enrichment of the new catalogue in synapse-related GO terms. First and second columns show the GO term identifier and its name. Third and fourth columns show the p-value and its correction for false discovery rate associated with the enrichment found, which is shown in the last column</p></caption><graphic position="anchor" xlink:href="12864_2019_6380_Tab3_HTML" id="MO6"/></table-wrap></p>
    </sec>
    <sec id="Sec8">
      <title>Regularly updated on-line catalogue</title>
      <p id="Par14">The model we are presenting here will be re-trained as new synaptic genes are identified. This will result in an updated catalogue that will be available here: <ext-link ext-link-type="uri" xlink:href="http://synapticgenes.bnd.edu.uy/">http://synapticgenes.bnd.edu.uy</ext-link>. The updated list of synaptic genes used to train the model will be available at the same site.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par15">An underlying rationale for our approach was that the transcription of genes of importance for neuronal synapses will probably increment very much during times of massive synapse assembly and will go down when synapses are massively degraded. A temporal correlation between changes in gene transcription and biological function has been reported for a variety of neuronal functions in <italic>Drosophila</italic> [<xref ref-type="bibr" rid="CR18">18</xref>]. A catalogue obtained by training an ensemble machine-learning model that assigned each <italic>Drosophila</italic> protein-coding gene a probability of having synaptic function was published four years ago [<xref ref-type="bibr" rid="CR6">6</xref>]. Of note, the model was based exclusively on a whole-body temporal transcriptome. It was hypothesized that the catalogue was enriched in genes of relevance for neuronal synapses which were still not recognized as such. Since the publication of the catalogue, 79 NSG were experimentally identified by others with a variety of experimental methods. This offered a great opportunity to test both the predictive power of our machine learning approach and to test changes to the training scheme that could improve the predictive power of our model. Here we found that our previous catalogue [<xref ref-type="bibr" rid="CR6">6</xref>] was enriched in genes for which a synaptic function was experimentally identified by other colleagues between 2015 and 2019. We believe that this represents a good experimental validation of the predictive power of our machine learning approach and we conclude that it is thus possible to predict gene function using machine learning based exclusively on temporal transcription data.</p>
    <p id="Par16">Our original model assigned very low probabilities to some genes that were later proven to have synaptic functions. A possible explanation could be that our model cannot capture the entire diversity in expression profiles among the hundreds of genes required for assembly and function of neuronal synapses. It is suitable that any model exclusively trained with transcription profiles will fail to recognize some of the interesting genes, for several reasons and two of them will be considered in the following. Many genes have more than one biological function and are expressed at different levels in different organs or tissues. Hence, a machine learning approach applied to expression values obtained from total RNA samples from whole-organisms will probably fail to identify some of the genes of interest because of the composite nature of the sample. Moreover, the coordinated expression of hundreds of genes, during the two massive waves of synapse formation taking place during <italic>Drosophila</italic> development [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] probably includes genes that encode activators or repressors, which will result in very different transcription profiles.</p>
    <p id="Par17">It is also worth noting that none of the 79 NSG belongs to the list of “non-synaptic genes” which had been used to train the algorithms. This provides unequivocal validation for the biological criteria used to select the negative examples of the training set and is consistent with our assumption that the genes of importance for neuronal communication are the same in both sexes.</p>
    <p id="Par18">It is important to note that even when the original model and its improved version were based on the same algorithms and were trained with the same set of genes, the enrichment in NSG found in the catalogue obtained with the improved model was 38% higher. This is interpreted as a clear demonstration that the new training scheme really improved the predictive performance of our approach. A possible explanation is that the tested training scheme alleviated a probable bias of our model due to a relatively small training set and increased its generalization capacity [<xref ref-type="bibr" rid="CR19">19</xref>]. Since there are hundreds of synaptic genes to be discovered this is an important feature.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par19">We show here that a catalogue of <italic>Drosophila</italic> putative synaptic genes obtained by an ensemble machine learning model four years ago has a significant enrichment in genes whose synaptic function was discovered by others after its publication. This confirms that it is possible to predict gene function based on a temporal data-set of transcription values and a machine learning approach of the type presented here.</p>
    <p id="Par20">After testing the predictive power of our methods, we constructed a new catalogue of putative synaptic genes and make it available to the scientific community, firmly believing that this will facilitate the identification of genes important for the assembly and function of synapses, by means of gene silencing, mutant analysis, electrophysiology, neuroanatomy, behavioral assays and other traditional protocols, all of which will most likely lead to a better understanding of the function of the brain. The catalogue is available at: <ext-link ext-link-type="uri" xlink:href="http://synapticgenes.bnd.edu.uy/">http://synapticgenes.bnd.edu.uy</ext-link></p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Data</title>
      <p id="Par21">We used the developmental transcriptome of <italic>Drosophila melanogaster</italic> published by the MODENCODE Project [<xref ref-type="bibr" rid="CR7">7</xref>]. In these data, each sample consisted of total polyAAA-RNA isolated from 30 whole bodies obtained at different time points along the organism life cycle. Originally the data set consisted of the transcript levels of 15,398 genes expressed as fragments per kilo base of exon per million fragments mapped (FPKM). We excluded 1756 genes that showed transcript levels above zero only during adult life and normalized each gene’s temporal series dividing it by its maximum value, thus obtaining for each gene a series of 24 values oscillating between 0 and 1. More details in [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Evaluation of the predictive power of our original model</title>
      <p id="Par22">Using the same ad hoc definition for “synaptic gene” that was adopted in our previous work, we performed a bibliographic revision and identified 79 new synaptic genes defined as such by other scientists since the publication of our first catalogue [<xref ref-type="bibr" rid="CR6">6</xref>]. Then we analyzed the enrichment of our original catalogue in these NSG using in-house scripts assuming a hyper-geometric distribution. If N is the number of genes in the background set, i.e. the set from which the analyzed list is extracted, B is the number of genes in the background set associated with the feature of interest, n is the number of genes in the analyzed list and b is the number of genes associated with the feature of interest in the analyzed list, the Enrichment is defined as ((b/n) / (B/N)).</p>
    </sec>
    <sec id="Sec14">
      <title>A new training scheme</title>
      <p id="Par23">To obtain our original catalogue we had trained three learning algorithms (k-NN, RF and SVM) with an unbalanced training set, in which there were many more negative than positive examples. A careful bibliographic revision was done to select genes for which the importance for neuronal synapses had been demonstrated with a variety of experimental approaches. In this way, 92 genes were selected as positive examples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). As negative examples, 397 genes were selected based on two biological criteria: genes that are not expressed at developmental stages when massive synapse formation takes place and genes with no expression during adult life in females or males, because available data indicate that the fundamental principles of structure and function of neuronal synapses are the same in both sexes.</p>
      <p id="Par24">With the aim of improving the predictive power of our model, here we propose a new training scheme, based on repetitive sub-sampling of the original training set to construct five smaller, slightly different training sets (<bold>see</bold> Fig. <xref rid="Fig1" ref-type="fig">1</xref>). To construct each of these training sets, four fifths of the original positive examples and four fifths of the original negative examples were randomly picked out. This procedure was repeated five times, leaving out a different fifth each time. Using the positive and negative examples left out when constructing each training set we defined a test set, used to independently calculate the accuracy, the AUC of the ROC and the F1 score of each classifier.</p>
      <p id="Par25">The hyper parameters of each classifier were set by grid search combined with 10-fold cross validation and its performance was evaluated by an independent test set. Each classifier assigned a different probability of being synaptic to each gene. To obtain our catalogues we considered, for each classification threshold, the intersection of the 15 results and then we took the mean probability assigned to each gene in the intersection.</p>
      <p id="Par26">All calculations were performed using Jupyter Notebooks and Sklearn [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2019_6380_MOESM1_ESM.xls">
            <caption>
              <p><bold>Additional file 1:</bold> List of genes in the original training set (XLS 41 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2019_6380_MOESM2_ESM.xls">
            <caption>
              <p><bold>Additional file 2:</bold> New synaptic genes &amp; references (XLS 21 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12864_2019_6380_MOESM3_ESM.xls">
            <caption>
              <p><bold>Additional file 3:</bold> New catalogue of putative synaptic genes (XLS 39 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-019-6380-z.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge the criticism of two anonymous reviewers, which greatly improved the original version of our manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>FPO conceived the study, performed the experiments and data analysis and wrote the manuscript. PS discussed the experiments prepared the web site and corrected the manuscript. MP discussed the experiments and corrected the manuscript. GG supervised the project and corrected the manuscript. PY supervised the project and corrected the manuscript. RC conceived the study, supervised the project and corrected the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>FPO received financial assistance from PEDECIBA (Uruguay), a PhD Fellowship and a research grant (FSDA_1_2017_1_142427) from the Agencia Nacional de Investigación e Innovación (ANII, Uruguay). FPO, RC and GG received funds from Sistema Nacional de Investigadores (Uruguay). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All data generated or analyzed during this study are included in this published article [and its supplementary information files].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par27">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par28">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par29">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Rodal</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Verstreken</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>New approaches for studying synaptic development, function, and plasticity using Drosophila as a model system</article-title>
        <source>J Neurosci</source>
        <year>2013</year>
        <volume>33</volume>
        <fpage>17560</fpage>
        <lpage>17568</lpage>
        <pub-id pub-id-type="doi">10.1523/JNEUROSCI.3261-13.2013</pub-id>
        <pub-id pub-id-type="pmid">24198346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laßek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weingarten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Volknandt</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The synaptic proteome</article-title>
        <source>Cell Tissue Res</source>
        <year>2015</year>
        <volume>359</volume>
        <fpage>255</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="doi">10.1007/s00441-014-1943-4</pub-id>
        <pub-id pub-id-type="pmid">25038742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burkhardt</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The origin and evolution of synaptic proteins – choanoflagellates lead the way</article-title>
        <source>J Exp Biol</source>
        <year>2015</year>
        <volume>218</volume>
        <fpage>506</fpage>
        <pub-id pub-id-type="doi">10.1242/jeb.110247</pub-id>
        <pub-id pub-id-type="pmid">25696814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>UniProt</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>UniProt: the universal protein knowledgebase</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>2699</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky092</pub-id>
        <pub-id pub-id-type="pmid">29425356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Oron</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Bankapur</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>D’Andrea</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lepore</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An expanded evaluation of protein function prediction methods shows an improvement in accuracy</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>184</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1037-6</pub-id>
        <pub-id pub-id-type="pmid">27604469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pazos Obregón</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Papalardo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Castro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Guerberoff</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cantera</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Putative synaptic genes defined from a Drosophila whole body developmental transcriptome by a machine learning approach</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>694</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1888-3</pub-id>
        <pub-id pub-id-type="pmid">26370122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graveley</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Duff</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Landolin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The developmental transcriptome of Drosophila melanogaster</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>471</volume>
        <fpage>473</fpage>
        <lpage>479</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09715</pub-id>
        <pub-id pub-id-type="pmid">21179090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altman</surname>
            <given-names>NS</given-names>
          </name>
        </person-group>
        <article-title>An introduction to kernel and nearest-neighbor nonparametric regression</article-title>
        <source>Am Stat</source>
        <year>1992</year>
        <volume>46</volume>
        <fpage>175</fpage>
        <lpage>185</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>Leo</given-names>
          </name>
        </person-group>
        <source>Machine Learning</source>
        <year>2001</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Vapnik</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>The nature of statistical learning theory</source>
        <year>2000</year>
        <edition>2</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Caruana</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Niculescu-Mizil</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>An empirical comparison of supervised learning algorithms</source>
        <year>2006</year>
        <publisher-loc>Pittsburgh, Pennsylvania</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>161</fpage>
        <lpage>168</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernández-Delgado</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cernadas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amorim</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Do we need hundreds of classifiers to solve real world classification problems?</article-title>
        <source>J Mach Learn Res</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>3133</fpage>
        <lpage>3181</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dietterich</surname>
            <given-names>TG</given-names>
          </name>
        </person-group>
        <article-title>Ensemble Methods in Machine Learning</article-title>
        <source>Multiple Classifier Systems</source>
        <year>2000</year>
        <publisher-loc>Berlin Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>1</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kacsoh</surname>
            <given-names>BZ</given-names>
          </name>
          <name>
            <surname>Greene</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Bosco</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Machine Learning Analysis Identifies Drosophila Grunge/Atrophin as an Important Learning and Memory Gene Required for Memory Retention and Social Learning</article-title>
        <source>G3 GenesGenomesGenetics</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>3705</fpage>
        <lpage>3718</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.117.300172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerepesi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Daróczy</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sturm</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Vellai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Benczúr</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Prediction and characterization of human ageing-related proteins by using machine learning</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>4094</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-22240-w</pub-id>
        <pub-id pub-id-type="pmid">29511309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Leong</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schenck</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>JP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust predictions of specialized metabolism genes through machine learning</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>2344</fpage>
        <lpage>2353</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1817074116</pub-id>
        <pub-id pub-id-type="pmid">30674669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Eden E, Navon R, Steinfeld I, Lipson D, Yakhini Z. GOrilla: a tool for discovery and visualization of enriched GO terms in ranked gene lists. BMC Bioinformatics. 2009;10:48.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cantera</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ferreiro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Aransay</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Barrio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Global gene expression shift during the transition from early neural development to late neuronal differentiation in Drosophila melanogaster</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e97703</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0097703</pub-id>
        <pub-id pub-id-type="pmid">24830291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <source>The elements of statistical learning data mining, inference, and prediction</source>
        <year>2009</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: Machine Learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
