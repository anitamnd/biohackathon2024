<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8652036</article-id>
    <article-id pub-id-type="pmid">34255820</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab495</article-id>
    <article-id pub-id-type="publisher-id">btab495</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>On the stability of log-rank test under labeling errors</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3067-667X</contrib-id>
        <name>
          <surname>Galili</surname>
          <given-names>Ben</given-names>
        </name>
        <xref rid="btab495-cor1" ref-type="corresp"/>
        <aff><institution>Faculty of Computer Science, Technion-Israel Institute of Technology</institution>, Haifa, <country country="IL">Israel</country></aff>
        <!--benga9@gmail.com-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Samohi</surname>
          <given-names>Anat</given-names>
        </name>
        <xref rid="btab495-cor1" ref-type="corresp"/>
        <aff><institution>Arazi School of Computer Science, Interdisciplinary Center</institution>, Herzliya, <country country="IL">Israel</country></aff>
        <!--anatsamohi@gmail.com-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yakhini</surname>
          <given-names>Zohar</given-names>
        </name>
        <xref rid="btab495-cor1" ref-type="corresp"/>
        <aff><institution>Faculty of Computer Science, Technion-Israel Institute of Technology</institution>, Haifa, <country country="IL">Israel</country></aff>
        <aff><institution>Arazi School of Computer Science, Interdisciplinary Center</institution>, Herzliya, <country country="IL">Israel</country></aff>
        <!--zohar.yakhini@gmail.com-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab495-cor1">To whom correspondence should be addressed. <email>benga9@gmail.com</email> or <email>anatsamohi@gmail.com</email> or <email>zohar.yakhini@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-13">
      <day>13</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>23</issue>
    <fpage>4451</fpage>
    <lpage>4459</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>30</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab495.pdf"/>
    <related-article related-article-type="companion" ext-link-type="doi" id="RA1" xlink:href="10.1093/bioinformatics/btab693"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Log-rank test is a widely used test that serves to assess the statistical significance of observed differences in survival, when comparing two or more groups. The log-rank test is based on several assumptions that support the validity of the calculations. It is naturally assumed, implicitly, that no errors occur in the labeling of the samples. That is, the mapping between samples and groups is perfectly correct. In this work, we investigate how test results may be affected when considering some errors in the original labeling.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce and define the uncertainty that arises from labeling errors in log-rank test. In order to deal with this uncertainty, we develop a novel algorithm for efficiently calculating a stability interval around the original log-rank <italic toggle="yes">P</italic>-value and prove its correctness. We demonstrate our algorithm on several datasets.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>We provide a Python implementation, called LoRSI, for calculating the stability interval using our algorithm <ext-link xlink:href="https://github.com/YakhiniGroup/LoRSI" ext-link-type="uri">https://github.com/YakhiniGroup/LoRSI</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 Research and Innovation Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>847912</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The comparison of different treatments or, more generally, policies or protocols, in terms of survival rates or in terms of success rates is a central aspect of investigating these regimes and of taking related decisions. There are two approaches that are generally taken in analyzing survival data. The first uses a permutational null distribution (<xref rid="btab495-B8" ref-type="bibr">Heimann and Neuhaus, 1998</xref>; <xref rid="btab495-B24" ref-type="bibr">Vandin <italic toggle="yes">et al.</italic>, 2015</xref>) and is more appropriate for imbalanced data. The second, more popular approach, uses a conditional null model, based on the hypergeometric distribution. This second approach is also the focus of this article. The log-rank test was introduced by <xref rid="btab495-B19" ref-type="bibr">Mantel (1966)</xref> and is extensively used since then. It is a standard tool in survival analysis, e.g. <xref rid="btab495-B15" ref-type="bibr">Kleinbaum and Klein (2012)</xref>. In <xref rid="btab495-B23" ref-type="bibr">Tourneau <italic toggle="yes">et al.</italic> (2015)</xref>, reporting on the SHIVA study, the log-rank test was used to determine whether the use of several targeted therapies outside their intended indications will improve progression-free survival in cancer. In <xref rid="btab495-B21" ref-type="bibr">Pitt <italic toggle="yes">et al.</italic> (1999)</xref>, the authors used log-rank test to conclude that the use of Spironolactone is effective to lower the risk of death in patients who suffered from severe heart failure. <xref rid="btab495-B6" ref-type="bibr">Galili <italic toggle="yes">et al.</italic> (2021)</xref> investigate efficient gene signatures that characterize a breast cancer subtype related to the patient’s immune response. The signature is optimized using a survival criterion based on the log-rank test. <xref rid="btab495-B16" ref-type="bibr">Levy-Jurgenson <italic toggle="yes">et al.</italic> (2020)</xref> report how cancer intratumor heterogeneity can affect patient survival.</p>
    <p>When applying the log-rank test to a set of data, we are implicitly assuming that the association of a subject, or, more generally, a sample, to one of the two labels, is not in doubt. In reality, however, this assumption is often compromised. In some cases, the label assignment is, indeed, rather straight forward. This is typically the case in the assignment to treatment arms. In other situations, it may be much less well defined.</p>
    <p>This is the case, as a first example, when label assignment is determined by a human judgment, e.g. based on inspection by pathologists, which is often prone to errors. Literature explicitly reports inconsistency in pathology. <xref rid="btab495-B14" ref-type="bibr">Jackson <italic toggle="yes">et al.</italic> (2017)</xref> report a study that found that the decision of the same pathologist varied when examining the same samples in different times. They showed that two diagnostic calls of the same pathologist, separated by at least 9 months, on the same biopsy, have an agreement rate of 92% (95% CI 88–95%) for invasive breast cancer and even less for other breast cancer types. <xref rid="btab495-B14" ref-type="bibr">Jackson <italic toggle="yes">et al.</italic> (2017)</xref> also showed that for different pathologists testing the same biopsy the agreement rates dropped by additional 3–10%. <xref rid="btab495-B4" ref-type="bibr">Elmore <italic toggle="yes">et al.</italic> (2017)</xref> reported similar results. In a different context, any subjective scoring approach, such as the Eastern Cooperative Oncology Group (ECOG) score, as used in <xref rid="btab495-B18" ref-type="bibr">Loprinzi <italic toggle="yes">et al.</italic> (1994)</xref>, depends, based on the same principles, on the individual making the calls.</p>
    <p>As a second example consider labeling that follows a machine decision. Three recent studies (<xref rid="btab495-B7" ref-type="bibr">Ha <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab495-B12" ref-type="bibr">Islam <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab495-B13" ref-type="bibr">Jaber <italic toggle="yes">et al.</italic>, 2020</xref>) introduce machine-learning models to determine breast cancer subtypes. They all reported around 70% accuracy.</p>
    <p>Finally, consider sample labeling, which is based on the results of some molecular measurement assay. <xref rid="btab495-B3" ref-type="bibr">Ebbert <italic toggle="yes">et al.</italic> (2011)</xref> showed how intrinsic errors in the laboratory process, specifically in gene expression profiling, affect the final results. They test this on PAM50 results and reported around 5% error in the classification.</p>
    <p>In the context of survival analysis, wrong sample labels can lead to dramatically different statistical assessments. Consider the MAINZ cohort, <xref rid="btab495-B22" ref-type="bibr">Schmidt <italic toggle="yes">et al.</italic> (2008)</xref>, that describes survival data for breast cancer patients. As extensively reported, including in <xref rid="btab495-B5" ref-type="bibr">Fallahpour <italic toggle="yes">et al.</italic> (2017)</xref> and <xref rid="btab495-B11" ref-type="bibr">Howlader <italic toggle="yes">et al.</italic> (2018)</xref>, Luminal A patients have better prognosis than the other types. This can be seen also in the MAINZ cohort, see the left panel in <xref rid="btab495-F1" ref-type="fig">Figure 1</xref>. We note a significant difference in the Luminal A prognosis with <italic toggle="yes">P</italic>-value =0.014. Now, what will the effect be, on the resulting <italic toggle="yes">P</italic>-value, of changing one Luminal A label out of the 200 samples (0.5%) in the MAINZ cohort? <xref rid="btab495-F2" ref-type="fig">Figure 2</xref> shows the original data and the data after one label change. <xref rid="btab495-F1" ref-type="fig">Figure 1</xref> shows the Kaplan–Meier graphs, before (left) and after (right) the change, and the corresponding <italic toggle="yes">P</italic>-values. Examining <xref rid="btab495-F1" ref-type="fig">Figure 1</xref> shows a dramatic change in the <italic toggle="yes">P</italic>-value from 0.014 to 0.029, when it is not so simple to notice any change in the plots themselves. Expanding this observation to the actual labeling error, e.g. as reported in <xref rid="btab495-B3" ref-type="bibr">Ebbert <italic toggle="yes">et al.</italic> (2011)</xref> for breast cancer subtypes, can lead to even more dramatically changes in the <italic toggle="yes">P</italic>-value.</p>
    <fig position="float" id="btab495-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Kaplan–Meier curve and log-rank <italic toggle="yes">P</italic>-value on the MAINZ cohort—Luminal A versus not Luminal A. On the left the original data and on the right the data after one change</p>
      </caption>
      <graphic xlink:href="btab495f1" position="float"/>
    </fig>
    <fig position="float" id="btab495-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>MAINZ cohort data, before and after one change in the labels</p>
      </caption>
      <graphic xlink:href="btab495f2" position="float"/>
    </fig>
    <p>Previous investigations addressed several aspects of uncertainty in survival analysis. Heterogeneity between individuals is not taken into account in the basic form of log-rank test. To address this bias, <xref rid="btab495-B10" ref-type="bibr">Hougaard (1995)</xref> introduced the concept of frailty models for survival analysis. Under this approach, the null model does not assume that the distribution of time to event is the same for all subjects. In order to overcome the unobserved heterogeneity in the survival data the frailty models use random effect to create different time to event distributions. Addressing a different issue, it is common to report (and plot) confidence intervals for each of the observed hazard ratios, resulting in a confidence envelope around the survival lines. In <xref rid="btab495-B24" ref-type="bibr">Vandin <italic toggle="yes">et al.</italic> (2015)</xref>, the authors demonstrated that asymptotic approximation, as in log-rank test, can be misleading when the two groups under consideration have very different sizes. They introduced a novel approach to accurately calculate the log-rank <italic toggle="yes">P</italic>-value regardless of the group sizes. Splitting subjects to two groups, in order to determine an association between the split and, potentially, low risk and high risk, is an important task in the context of survival analysis. Standard studies use treatment types, protocols etc. When studying a quantitative potential determinant of survival, we are often interested in splitting according to that quantity. For example, the expression level of some gene or maybe BMI. Trying all possible cut-points (thresholds) is not practical due to multiple testing problems. In an important paper treating this issue, <xref rid="btab495-B9" ref-type="bibr">Hothorn and Lausen (2003)</xref> developed a method for calculating an upper bound on the log-rank test <italic toggle="yes">P</italic>-value, which efficiently takes into account multiple testing. This approach checks different label assignments, similar to our work, but limits the splits being considered. In addition, it focuses on finding the best split. In this work, we address general labeling and not necessarily such which is driven by a quantitative feature. Our study also considers completely general labeling changes and not ones related to consistent threshold splits.</p>
    <p>In this work, we address, for the first time, the uncertainty that arises from general labeling errors and label instability. Given survival data with <italic toggle="yes">n</italic> samples and an error rate, <italic toggle="yes">α</italic>, we find the minimum and maximum log-rank <italic toggle="yes">P</italic>-values that can result from changing the labels of at most <italic toggle="yes">αn</italic> samples. These minimum and maximum <italic toggle="yes">P</italic>-values, <italic toggle="yes">P<sub>L</sub></italic> and <italic toggle="yes">P<sub>U</sub></italic>, define a stability interval [<italic toggle="yes">P<sub>L</sub></italic>, <italic toggle="yes">P<sub>U</sub></italic>]. To make our analysis less sensitive to extreme cases, we support the use of a confidence level, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>δ</mml:mo></mml:mrow></mml:math></inline-formula>, to further narrow our interval. The main contributions of our work are as follows:
</p>
    <list list-type="bullet">
      <list-item>
        <p>A definition of labeling errors stability intervals for statistical tests.</p>
      </list-item>
      <list-item>
        <p>A procedure that, given data and a bound on the labeling error, calculates a stability interval for the log-rank test.</p>
      </list-item>
      <list-item>
        <p>A software implementation of the above procedure.</p>
      </list-item>
      <list-item>
        <p><ext-link xlink:href="https://github.com/YakhiniGroup/LoRSI" ext-link-type="uri">https://github.com/YakhiniGroup/LoRSI</ext-link>.</p>
      </list-item>
      <list-item>
        <p>Applications to several example cases.</p>
      </list-item>
    </list>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 The statistical framework for log-rank stability</title>
      <sec>
        <label>2.1.1</label>
        <title>Preliminaries</title>
        <p>We first set the notation for the log-rank test, in the context of the conditional null distribution (<xref rid="btab495-B19" ref-type="bibr">Mantel, 1966</xref>), as will be used in the rest of the manuscript.
</p>
        <list list-type="bullet">
          <list-item>
            <p>Consider time and event data <italic toggle="yes">D</italic> (survival data) with a partition labeling <italic toggle="yes">λ</italic><sub>0</sub> [a binary vector mapping subjects into the groups <italic toggle="yes">A</italic> (0) &amp; <italic toggle="yes">B</italic> (1)] over <italic toggle="yes">n</italic> subjects.</p>
          </list-item>
          <list-item>
            <p>Let <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> be the distinct times of observed events in either group.</p>
          </list-item>
          <list-item>
            <p>Let <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the number of subjects ‘at risk’ (who have not yet had an event nor have been censored) at the time of occurrence of the <italic toggle="yes">j</italic>th event in the two groups, respectively.</p>
          </list-item>
          <list-item>
            <p>Let <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the random variables representing the observed number of events in each group at time <italic toggle="yes">j</italic>.</p>
          </list-item>
          <list-item>
            <p>Denote <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the number of at-risk subjects at time <italic toggle="yes">j</italic>.</p>
          </list-item>
          <list-item>
            <p>Denote <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the number of actual events observed at time <italic toggle="yes">j</italic>.</p>
          </list-item>
          <list-item>
            <p>Let T be the time of failure of a subject. <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the probability distribution function of <italic toggle="yes">T</italic>. The survival function is defined as <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>In log-rank testing, we are working under the null model that assumes that the two groups have identical survival functions, <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
          <list-item>
            <p>We then have
<disp-formula id="IE10"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>Similar for group <italic toggle="yes">B</italic> (HG stands for Hypergeometric).</p>
          </list-item>
          <list-item>
            <p>The null model also assumes that the variables <inline-formula id="IE11"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are (collectively) independent.</p>
          </list-item>
          <list-item>
            <p>The expected value and the variance of <inline-formula id="IE12"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> under the null model are:
<disp-formula id="IE13"><mml:math id="M2" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>Similar for group B.</p>
          </list-item>
          <list-item>
            <p>Putting everything together, for all <inline-formula id="IE14"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, the log-rank statistic compares <inline-formula id="IE15"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to their expected values <inline-formula id="IE16"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> under the null model. The statistic is defined as:
<disp-formula id="IE17"><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>O</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mi>V</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where:
<disp-formula id="IE18"><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>Similar for group B.</p>
          </list-item>
        </list>
        <p>If <italic toggle="yes">J</italic> is sufficiently large and the partition into <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic> is reasonably balanced (see e.g. <xref rid="btab495-B24" ref-type="bibr">Vandin <italic toggle="yes">et al.</italic>, 2015</xref>) then, <italic toggle="yes">Z</italic> is approximately distributed as <italic toggle="yes">N</italic>(0, 1). This allows us to compute a <italic toggle="yes">P</italic>-value for the comparative survival data <italic toggle="yes">D</italic>, using the value actually observed for <italic toggle="yes">O</italic>, which we denote <inline-formula id="IE19"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>o</mml:mi><mml:mo>=</mml:mo><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This <italic toggle="yes">P</italic>-value is denoted by <inline-formula id="IE20"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. By extension <inline-formula id="IE21"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> will denote the log-rank <italic toggle="yes">P</italic>-value that would be obtained for any different partition labeling <italic toggle="yes">λ</italic>.</p>
      </sec>
      <sec>
        <label>2.1.2</label>
        <title>Definition of the log-rank stability interval</title>
        <p>We now define a log-rank stability interval for given survival data and two parameters <inline-formula id="IE22"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.
</p>
        <list list-type="bullet">
          <list-item>
            <p>Again, consider time and event data <italic toggle="yes">D</italic> with a partition labeling <italic toggle="yes">λ</italic><sub>0</sub> (mapping subjects into the groups A &amp; B) over <italic toggle="yes">n</italic> subjects. Recall that <inline-formula id="IE24"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the log-rank <italic toggle="yes">P</italic>-value computed for this data.</p>
          </list-item>
          <list-item>
            <p>Let <inline-formula id="IE25"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>α</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Given a different binary labeling <italic toggle="yes">λ</italic>, we say that <italic toggle="yes">λ</italic> is an <italic toggle="yes">α</italic>-modification of <italic toggle="yes">λ</italic><sub>0</sub> if the labels have changed in less than a fraction <italic toggle="yes">α</italic> of the samples.</p>
          </list-item>
          <list-item>
            <p>Formally, <inline-formula id="IE26"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mo>α</mml:mo><mml:mo>·</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">H</italic> is the Hamming distance.</p>
          </list-item>
          <list-item>
            <p>Let <inline-formula id="IE27"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the set of all possible labeling partitions <italic toggle="yes">λ</italic> that are <italic toggle="yes">α</italic>-modifications of <italic toggle="yes">λ</italic><sub>0</sub>.</p>
          </list-item>
          <list-item>
            <p>Let <inline-formula id="IE28"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mo>δ</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We want to compute a tight interval <inline-formula id="IE29"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> in the following sense: <italic toggle="yes">p<sub>U</sub></italic> should be the smallest number for which <inline-formula id="IE30"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> holds for a <inline-formula id="IE31"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>δ</mml:mo></mml:mrow></mml:math></inline-formula> fraction of <inline-formula id="IE32"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mo>λ</mml:mo><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Note that under this definition, we require tightness on the right hand side, which is, in practice, taking a conservative approach, the more interesting case (see Section 4).</p>
          </list-item>
          <list-item>
            <p>The interval defined above is the stability interval for the two parameters <inline-formula id="IE33"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE34"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and the input data. We write:
<disp-formula id="IE35"><label>(1)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
          </list-item>
        </list>
        <p>For example, given data <italic toggle="yes">D</italic> with <italic toggle="yes">n</italic> = 100 (100 samples), <inline-formula id="IE36"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE37"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, we want to compute an interval SI so that for 95% of the single label changes (1% change) the log-rank <italic toggle="yes">P</italic>-value will fall in SI.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Computing stability intervals for log-rank test</title>
      <p>In this section, we describe our algorithmic approach and prove its correctness.</p>
      <sec>
        <label>2.2.1</label>
        <title>Algorithm: LoRSI</title>
        <p>We start by some definitions and notations.</p>
        <p>Let:</p>
        <list list-type="bullet">
          <list-item>
            <p><inline-formula id="IE38"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>−</mml:mo></mml:mrow></mml:math></inline-formula> the dataset. Consisting of three vectors of length <italic toggle="yes">n</italic>:
</p>
            <list list-type="alpha-lower">
              <list-item>
                <p><italic toggle="yes">e</italic>: event/censored descriptor. Indicates whether event or censored occurred.</p>
              </list-item>
              <list-item>
                <p><italic toggle="yes">t</italic>: time. The time from the beginning of an observation period to an event, censored or end of the study.</p>
              </list-item>
              <list-item>
                <p><italic toggle="yes">l</italic>: group. Indicates the group of the subject.</p>
              </list-item>
            </list>
          </list-item>
          <list-item>
            <p><inline-formula id="IE39"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represents a single instance: an instance <inline-formula id="IE40"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> is defined by three quantities—the group label <italic toggle="yes">l</italic>(<italic toggle="yes">d</italic>), the time <italic toggle="yes">t</italic>(<italic toggle="yes">d</italic>) and the event/censored descriptor <italic toggle="yes">e</italic>(<italic toggle="yes">d</italic>).</p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE41"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>F</mml:mi><mml:mo>:</mml:mo></mml:mrow></mml:math></inline-formula> the set of interest (the Focus set).</p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE42"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo>:</mml:mo></mml:mrow></mml:math></inline-formula> the other set (the Background set).</p>
          </list-item>
          <list-item>
            <p>The set <italic toggle="yes">F</italic> is typically the one that has a better survival rate. That is: <italic toggle="yes">Z<sub>F</sub></italic> &lt; <italic toggle="yes">Z<sub>B</sub></italic>. In this article, we also take this approach and therefore <italic toggle="yes">F</italic> is the set that has the better survival rate in the input data, <italic toggle="yes">D</italic>.</p>
          </list-item>
        </list>
        <p>We further define the following subsets of <italic toggle="yes">F</italic> and <italic toggle="yes">B</italic>:
</p>
        <list list-type="bullet">
          <list-item>
            <p><italic toggle="yes">EF</italic>: the events of the group <italic toggle="yes">F</italic>, ordered from the earliest to the latest.</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">CF</italic>: the censored samples of the group <italic toggle="yes">F</italic>, ordered from the earliest to the latest.</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">EB</italic>: the events of the group <italic toggle="yes">B</italic>, ordered from the earliest to the latest.</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">CB</italic>: the censored samples of the group <italic toggle="yes">B</italic>, ordered from the earliest to the latest.</p>
          </list-item>
        </list>
        <p>Note that <inline-formula id="IE43"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo>∪</mml:mo><mml:mi>C</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE44"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mi>B</mml:mi><mml:mo>∪</mml:mo><mml:mi>C</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
        <p>Now define the prefixes and sufixes of these ordered subsets as follows:
</p>
        <list list-type="bullet">
          <list-item>
            <p><inline-formula id="IE45"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> the samples <inline-formula id="IE46"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE47"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> the samples <inline-formula id="IE48"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE49"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> the samples <inline-formula id="IE50"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE51"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> the samples <inline-formula id="IE52"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE53"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> the samples <inline-formula id="IE54"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE55"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> the samples <inline-formula id="IE56"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mi>F</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mi>F</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
        </list>
        <p>Following standard notation for the set of types of denominator <italic toggle="yes">k</italic> over a three letter alphabet (<xref rid="btab495-B2" ref-type="bibr">Cover, 1999</xref>), we denote:
<disp-formula id="E1"><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Note that:
<disp-formula id="E2"><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><statement id="mthst1"><label>Definition 1.</label><p>The set of <italic toggle="yes">P<sub>U</sub></italic> candidates is defined by:
<disp-formula id="E3"><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></statement></p>
        <p>We will show that this is the collection of candidate sample sets of size <italic toggle="yes">k</italic>, amongst which we will identify the set of samples that, if swapped, will lead to the most extreme positive change in the <italic toggle="yes">P</italic>-value. Note that the size of <italic toggle="yes">C<sub>U</sub></italic> is the same as that of <inline-formula id="IE57"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, namely <inline-formula id="IE58"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p>Similarly:<statement id="mthst2"><label>Definition 2.</label><p>The set of <italic toggle="yes">P<sub>L</sub></italic> candidates is defined by:
<disp-formula id="E4"><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></statement></p>
        <p>Algorithm 1 describes the Log-Rank Stability Interval Algorithm (LoRSI) for finding <italic toggle="yes">P<sub>L</sub></italic> and <italic toggle="yes">P<sub>U</sub></italic>, where <inline-formula id="IE59"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. For <italic toggle="yes">P<sub>U</sub></italic>, the idea of the algorithm is to iterate over the set of all relevant sets of <italic toggle="yes">k</italic> changes. The size of this collection is relatively small, namely <inline-formula id="IE60"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, due to the monotonicity effect on the <italic toggle="yes">z</italic>-score in each one of the groups <inline-formula id="IE61"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>&amp;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as proven below in Section 2.2.2. In each iteration, our procedure calculates the <italic toggle="yes">P</italic>-value after changing the labels of the current <italic toggle="yes">k</italic> subjects. Finally, it selects the max <italic toggle="yes">P</italic>-value among the <inline-formula id="IE62"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> candidates. Note that, if we consider only one label change (<italic toggle="yes">k</italic> = 1), then, the SI (both sides) is determined by only six candidates, three for <italic toggle="yes">P<sub>U</sub></italic> and three for <italic toggle="yes">P<sub>L</sub></italic> (see <xref rid="btab495-F3" ref-type="fig">Fig. 3</xref>). In the <xref rid="sup1" ref-type="supplementary-material">Supplementary</xref>  <xref rid="sup1" ref-type="supplementary-material">Material</xref>, we describe the LoRSI algorithm, where <inline-formula id="IE63"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> and for any <inline-formula id="IE64"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
        <fig position="float" id="btab495-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>Log-rank stability analysis for single label changes. The figure represents results for three datasets, as described in the text. Each of the depicted datasets consists of two groups (<bold>F</bold>)<italic toggle="yes">—</italic>the (actual, as per the original data) group of patients with good prognosis, and (<bold>B</bold>)<italic toggle="yes">—</italic>the bad prognosis group. Each data point is either an event or a censored point. The combination of the group and the event type leads to four categories of patients. The scatter plots provide a visual representation of the effect, on the <italic toggle="yes">P</italic>-value, that follows from changing the label of a single sample (i.e. <inline-formula id="IE65"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>). We can observe the monotonicity of the effect, with a direction depending on the category, as proven in Section 2. For each dataset, we indicate the original (non-swap) <italic toggle="yes">P</italic>-value (solid black lines on the right panel), the numbers <italic toggle="yes">P<sub>L</sub></italic> and <italic toggle="yes">P<sub>U</sub></italic> (solid red lines) for <italic toggle="yes">δ</italic>=0 and the number <italic toggle="yes">P<sub>U</sub></italic> for <inline-formula id="IE66"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> (dashed red lines). Sample categories, in the scatter plots are represented by shape and color: blue dots—event swap from (B) to (F), red dots—event swap from (F) to (B), cyan Xs—censored sample swap from (B) to (F) and purple Xs—censored sample swap from (F) to (B). The green and red circles represent <italic toggle="yes">P<sub>L</sub></italic> and <italic toggle="yes">P<sub>U</sub></italic> candidates, respectively, at <italic toggle="yes">δ</italic> = 0</p>
          </caption>
          <graphic xlink:href="btab495f3" position="float"/>
        </fig>
        <p>
          <boxed-text id="btab495-BOX1" position="float">
            <sec>
              <title><bold>Algorithm 1:</bold> LoRSI pseoducode.</title>
              <p>
                <bold>Log-Rank Stability Interval</bold>
              </p>
              <p><bold>input</bold>: Dataset—<italic toggle="yes">D</italic>, <inline-formula id="IE67"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></p>
              <p><bold>output</bold>: Stability Interval <inline-formula id="IE68"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></p>
              <p>
                <inline-formula id="E5">
                  <mml:math id="IM64" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mi>L</mml:mi>
                      </mml:msub>
                      <mml:mo>_</mml:mo>
                      <mml:mi mathvariant="italic">candidates</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mo>∅</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </p>
              <p>
                <inline-formula id="E6">
                  <mml:math id="IM65" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mi>U</mml:mi>
                      </mml:msub>
                      <mml:mo>_</mml:mo>
                      <mml:mi mathvariant="italic">candidates</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mo>∅</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </p>
              <p>//each of these sets will hold all <inline-formula id="IE69"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> relevant <italic toggle="yes">P</italic>-values</p>
              <p><bold>for</bold> <italic toggle="yes">current_set_of_changes in C<sub>U</sub></italic> <bold>do</bold></p>
              <p> //see Definition 1 for <italic toggle="yes">C<sub>U</sub></italic></p>
              <p> <italic toggle="yes">p</italic> = log-rank <italic toggle="yes">P</italic>-value after swapping the labels of all the <italic toggle="yes">k</italic> samples in <italic toggle="yes">current_set_of_changes</italic></p>
              <p> <inline-formula id="IE171"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo>_</mml:mo><mml:mi mathvariant="italic">candidates</mml:mi></mml:mrow></mml:math></inline-formula>.append (<italic toggle="yes">p</italic>)</p>
              <p>
                <bold>end</bold>
              </p>
              <p><bold>for</bold> <italic toggle="yes">current_set_of_changes in C<sub>L</sub></italic> <bold>do</bold></p>
              <p> //see Definition 2 for <italic toggle="yes">C<sub>L</sub></italic></p>
              <p> <italic toggle="yes">p</italic> = log-rank <italic toggle="yes">P</italic>-value after swapping the labels of all the <italic toggle="yes">k</italic> samples in <italic toggle="yes">current_set_of_changes</italic></p>
              <p> <inline-formula id="E10"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>_</mml:mo><mml:mi mathvariant="italic">candidates</mml:mi></mml:mrow><mml:mtext>.append</mml:mtext></mml:math></inline-formula> (<italic toggle="yes">p</italic>)</p>
              <p>
                <bold>end</bold>
              </p>
              <p>
                <inline-formula id="E11">
                  <mml:math id="IM69" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mi>U</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                    </mml:mrow>
                    <mml:mtext>max</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mi>U</mml:mi>
                      </mml:msub>
                      <mml:mo>_</mml:mo>
                      <mml:mi mathvariant="italic">candidates</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:math>
                </inline-formula>
              </p>
              <p>
                <inline-formula id="E12">
                  <mml:math id="IM70" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mi>L</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                    </mml:mrow>
                    <mml:mtext>min</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mi>L</mml:mi>
                      </mml:msub>
                      <mml:mo>_</mml:mo>
                      <mml:mi mathvariant="italic">candidates</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:math>
                </inline-formula>
              </p>
              <p><bold>return</bold> <italic toggle="yes">p<sub>L</sub></italic>, <italic toggle="yes">p<sub>U</sub></italic></p>
            </sec>
          </boxed-text>
        </p>
      </sec>
      <sec>
        <label>2.2.2</label>
        <title>Correctness</title>
        <p>In this section, we prove the correctness of Algorithm 1. This, in essence, is the content of Theorem 1, stated at the end of this section. We start with some definitions and notations.
</p>
        <list list-type="bullet">
          <list-item>
            <p>Let <italic toggle="yes">z</italic><sub>0</sub> be the original <italic toggle="yes">Z</italic>-statistic obtained from the input labeling.</p>
          </list-item>
          <list-item>
            <p>Now consider a labeling swap for the instance <italic toggle="yes">d</italic>. That is, if in <italic toggle="yes">λ</italic><sub>0</sub>, the instance <italic toggle="yes">d</italic> is in the group <italic toggle="yes">F</italic>, then, it is swapped to <italic toggle="yes">B</italic> and symmetrically otherwise. This swap will affect the value of <italic toggle="yes">Z</italic> calculated for the new data. Let
<disp-formula id="IE70"><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">o</italic><sub>new</sub>, <italic toggle="yes">E</italic><sub>new</sub> and <italic toggle="yes">V</italic><sub>new</sub> are obtained for the swapped data as described in the preliminaries.</p>
          </list-item>
          <list-item>
            <p>We are specifically interested in the resulting change in the observed value of <italic toggle="yes">Z</italic>, which we denote
<disp-formula id="IE71"><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
          </list-item>
        </list>
        <p>Let <inline-formula id="IE72"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a set of RVs. We say that <inline-formula id="IE73"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is an independent hypergeometric set (IHS) if:</p>
        <p>1. <inline-formula id="IE74"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are (collectively) independent.</p>
        <p>2. <inline-formula id="E13"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></inline-formula></p>
        <p>3. <inline-formula id="E14"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="italic">Var</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:math></inline-formula></p>
        <p>For a single RV <italic toggle="yes">X</italic> let
<disp-formula id="E15"><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>and then, for a set of independent RVs,
<disp-formula id="E16"><mml:math id="M13" display="block" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>We note that if <inline-formula id="IE75"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is an IHS and if <italic toggle="yes">n</italic> is sufficiently large then the distribution of <inline-formula id="IE76"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is approximately standard normal (<xref rid="btab495-B17" ref-type="bibr">Lindeberg, 1922</xref>). We also note that, as stated above, the variables <inline-formula id="IE77"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE78"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, constitute an IHS.</p>
        <p>For an observation <italic toggle="yes">x</italic>, derived from an RV <italic toggle="yes">X</italic>, we further define the Z-transformed value:
<disp-formula id="E17"><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>For a set observation we now define
<disp-formula id="E18"><mml:math id="M15" display="block" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>For a random variable <italic toggle="yes">X</italic> and a number <inline-formula id="IE79"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></inline-formula>, we use the notation <italic toggle="yes">CDF</italic>(<italic toggle="yes">X</italic>, <italic toggle="yes">x</italic>) to represent the cumulative distribution of <italic toggle="yes">X</italic> at <italic toggle="yes">x</italic>. Or, in other words: <inline-formula id="IE80"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">CDF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>Claim 1. <italic toggle="yes">Given two RVs X, Y where:</italic>
 <disp-formula id="E19"><mml:math id="M16" display="block" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><italic toggle="yes">and</italic>
 <disp-formula id="E20"><mml:math id="M17" display="block" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></disp-formula><italic toggle="yes">then</italic>
 <disp-formula id="E21"><mml:math id="M18" display="block" overflow="scroll"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>b</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">CDF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">CDF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>See <xref rid="sup1" ref-type="supplementary-material">Supplementary</xref>  <xref rid="sup1" ref-type="supplementary-material">Material</xref> for a proof.</p>
        <p>Claim 2. <italic toggle="yes">Consider two RVs X, Y where:</italic>
 <disp-formula id="E22"><mml:math id="M19" display="block" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p><italic toggle="yes">Let</italic> <inline-formula id="IE81"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">be k RVs where both</italic> <inline-formula id="IE82"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE83"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">are IHS. Denote</italic> <inline-formula id="IE84"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE85"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p>
        <p><italic toggle="yes">Let:</italic>
 <disp-formula id="E23"><mml:math id="M20" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p><italic toggle="yes">If</italic>
 <disp-formula id="E24"><mml:math id="M21" display="block" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></disp-formula><italic toggle="yes">then:</italic></p>
        <list list-type="order">
          <list-item>
            <p>
              <inline-formula id="IE86">
                <mml:math id="IM87" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mi mathvariant="italic">CDF</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>z</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>&lt;</mml:mo>
                    <mml:mi mathvariant="italic">CDF</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>z</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">For sufficiently large values of k (</italic>which <italic toggle="yes">is the interesting case, in the context of log-rank, see comment after the proof), we also have:</italic> <inline-formula id="IE87"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p>
          </list-item>
        </list>
        <p>See <xref rid="sup1" ref-type="supplementary-material">Supplementary</xref>  <xref rid="sup1" ref-type="supplementary-material">Material</xref> for a proof.</p>
        <p>As noted above, we are interested in working with large values of <italic toggle="yes">k</italic> in the context of log-rank. Without this assumption, the second part of Claim 2 is not necessarily true. For example, for <italic toggle="yes">k</italic> = 1, consider:
</p>
        <list list-type="bullet">
          <list-item>
            <p><inline-formula id="IE88"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>90</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with observed value <inline-formula id="IE89"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE90"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with observed value <italic toggle="yes">a</italic> = 1</p>
          </list-item>
          <list-item>
            <p><inline-formula id="IE91"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>99</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with observed value <italic toggle="yes">a</italic> = 1,</p>
          </list-item>
        </list>
        <p>which yields: <inline-formula id="IE92"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>5.554</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2.835.</mml:mn></mml:mrow></mml:math></inline-formula></p>
        <p>Claim 3. <italic toggle="yes">Let</italic> <inline-formula id="IE93"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE94"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">be censored samples in D from group F.</italic></p>
        <p><italic toggle="yes">Let</italic> <inline-formula id="IE95"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE96"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p><italic toggle="yes">If</italic> <inline-formula id="IE97"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">then</italic> <inline-formula id="IE98"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula><italic toggle="yes">, and therefore:</italic>
 <disp-formula id="E25"><mml:math id="M22" display="block" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p><italic toggle="yes">Similarly, if the censored samples</italic>, <inline-formula id="IE99"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE100"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula><italic toggle="yes">, come from group B then if</italic> <inline-formula id="IE101"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">then</italic> <inline-formula id="IE102"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula><italic toggle="yes">, and therefore:</italic>
 <disp-formula id="E26"><mml:math id="M23" display="block" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&gt;</mml:mo><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula><statement id="mthst3"><label>Proof.</label><p>We use the fact that the random variables <inline-formula id="IE103"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as defined in the log-rank setup constitute an IHS. Swapping <inline-formula id="IE104"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from <italic toggle="yes">F</italic> to <italic toggle="yes">B</italic> leads to a change in the at risk numbers <inline-formula id="IE105"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. More specifically each one of them is decreased by 1. Nothing changes for the later indices. Assuming that <italic toggle="yes">J</italic> is sufficiently large, we now iteratively use Claim 2. In every iteration, we decrease <inline-formula id="IE106"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> by 1, starting at <italic toggle="yes">j</italic> = 1 and ending at <inline-formula id="IE107"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. At every index <italic toggle="yes">j</italic> let <inline-formula id="IE108"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE109"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the hypergeometric variables representing the number of events at time <italic toggle="yes">j</italic> before and after a hypothetical swap at <italic toggle="yes">j</italic>, respectively. Claim 2 therefore applies, at every iteration <italic toggle="yes">j</italic>, with <inline-formula id="IE110"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE111"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> playing the role of <italic toggle="yes">Y</italic> and <italic toggle="yes">X</italic>, respectively, and <inline-formula id="IE112"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE113"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE114"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE115"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> playing the role of the <italic toggle="yes">T<sub>i</sub></italic>s. We, thus, get <inline-formula id="IE116"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p></statement></p>
        <p>Similarly, since <inline-formula id="IE117"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> the swap of <inline-formula id="IE118"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> will affect all at risk numbers above as well as several others <inline-formula id="IE119"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Continuing the above iterations, we therefore have <inline-formula id="IE120"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p>When swapping away from group <italic toggle="yes">B</italic>, the effect of the swap will be to increase the at risk numbers, leading to the reverse inequalities. ■</p>
        <p>Claim 4. <italic toggle="yes">Consider the RVs X<sub>1</sub>, X<sub>2</sub> and Y <sub>1</sub>, Y <sub>2</sub> where:</italic>
 <disp-formula id="E27"><mml:math id="M24" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi>H</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p><italic toggle="yes">Let</italic> <inline-formula id="IE121"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">be k −1 RVs where both</italic> <inline-formula id="IE122"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE123"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">are IHS. Denote</italic> <inline-formula id="IE124"><mml:math id="IM125" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE125"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p>
        <p><italic toggle="yes">Let:</italic>
 <disp-formula id="E28"><mml:math id="M25" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p><italic toggle="yes">If</italic>
 <disp-formula id="E29"><mml:math id="M26" display="block" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></disp-formula><italic toggle="yes">then</italic>
 <disp-formula id="E30"><mml:math id="M27" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula><statement id="mthst4"><label>Proof.</label><p>First, we write explicitly:
<disp-formula id="E31"><mml:math id="M28" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>By definition <inline-formula id="IE126"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE127"><mml:math id="IM128" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Let <inline-formula id="IE128"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We rearrange the term to get:
<disp-formula id="E32"><mml:math id="M29" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>We now apply Claim 2, with: <inline-formula id="IE129"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>X</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and get <inline-formula id="IE130"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.■</p></statement></p>
        <p>Claim 5. <italic toggle="yes">Let</italic> <inline-formula id="IE131"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE132"><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">be events in D from group F.</italic></p>
        <p><italic toggle="yes">Let</italic> <inline-formula id="IE133"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE134"><mml:math id="IM135" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p><italic toggle="yes">If</italic> <inline-formula id="IE135"><mml:math id="IM136" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">then</italic> <inline-formula id="IE136"><mml:math id="IM137" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula><italic toggle="yes">, and therefore:</italic>
 <disp-formula id="E33"><mml:math id="M30" display="block" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p><italic toggle="yes">Similarly, if the events</italic>, <inline-formula id="IE137"><mml:math id="IM138" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">and</italic> <inline-formula id="IE138"><mml:math id="IM139" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula><italic toggle="yes">, come from group B then if</italic> <inline-formula id="IE139"><mml:math id="IM140" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">then</italic> <inline-formula id="IE140"><mml:math id="IM141" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula><italic toggle="yes">, and therefore:</italic>
 <disp-formula id="E34"><mml:math id="M31" display="block" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>
          <statement id="mthst5">
            <label>Proof.</label>
            <p>We once again use the fact that the random variables <inline-formula id="IE141"><mml:math id="IM142" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as defined in the log-rank setup constitute an IHS. Swapping <inline-formula id="IE142"><mml:math id="IM143" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from <italic toggle="yes">F</italic> to <italic toggle="yes">B</italic> leads to a change in the at risk numbers <inline-formula id="IE143"><mml:math id="IM144" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. More specifically each one of them is decreased by 1. Similarly, since <inline-formula id="IE144"><mml:math id="IM145" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">time</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the swap of <inline-formula id="IE145"><mml:math id="IM146" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> will affect all at risk numbers above as well as several others, namely <inline-formula id="IE146"><mml:math id="IM147" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. In addition, <inline-formula id="IE147"><mml:math id="IM148" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> becomes <inline-formula id="IE148"><mml:math id="IM149" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> when swapping <inline-formula id="IE149"><mml:math id="IM150" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE150"><mml:math id="IM151" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> becomes <inline-formula id="IE151"><mml:math id="IM152" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> when swapping <inline-formula id="IE152"><mml:math id="IM153" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Therefore, <inline-formula id="IE153"><mml:math id="IM154" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in both swaps.</p>
          </statement>
        </p>
        <p>Now, let <italic toggle="yes">Y</italic><sub>1</sub> and <italic toggle="yes">Y</italic><sub>2</sub> be <inline-formula id="IE154"><mml:math id="IM155" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE155"><mml:math id="IM156" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> after swapping <inline-formula id="IE156"><mml:math id="IM157" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from <italic toggle="yes">F</italic> to <italic toggle="yes">B</italic>, respectively. In addition, let <italic toggle="yes">X</italic><sub>1</sub> and <italic toggle="yes">X</italic><sub>2</sub> be <inline-formula id="IE157"><mml:math id="IM158" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE158"><mml:math id="IM159" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> after swapping <inline-formula id="IE159"><mml:math id="IM160" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from <italic toggle="yes">F</italic> to <italic toggle="yes">B</italic>, respectively. By iteratively using Claim 4 and assuming that <italic toggle="yes">J</italic> is sufficiently large, we get <inline-formula id="IE160"><mml:math id="IM161" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p>In the case of swapping away from group <italic toggle="yes">B</italic>, the effect of the swap will be to increase both the at risk numbers and the observed <inline-formula id="IE161"><mml:math id="IM162" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and therefore we get the reverse inequalities. ■</p>
        <p>In summary, we proved that changing one sample will lead to a monotonic effect on the z-score and therefore on the log-rank <italic toggle="yes">P</italic>-value.</p>
        <p>Now consider the case of <italic toggle="yes">k</italic> swaps. We claim that the <italic toggle="yes">k</italic> instances that yield the most extreme positive change in the <italic toggle="yes">P</italic>-value is one of the candidates in <italic toggle="yes">C<sub>U</sub></italic>. Let <inline-formula id="IE162"><mml:math id="IM163" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> be the labeling that, indeed, yields the largest <inline-formula id="IE163"><mml:math id="IM164" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> within <inline-formula id="IE164"><mml:math id="IM165" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>. To see why the above claim holds assume, WLOG, that <inline-formula id="IE165"><mml:math id="IM166" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> swaps some instance <inline-formula id="IE166"><mml:math id="IM167" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> but does not swap <inline-formula id="IE167"><mml:math id="IM168" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for some <italic toggle="yes">i </italic>&lt;<italic toggle="yes"> j</italic>. By the monotonicity proven above (Claim 5), we can swap <inline-formula id="IE168"><mml:math id="IM169" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> instead of <inline-formula id="IE169"><mml:math id="IM170" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and get a larger <inline-formula id="IE211"><mml:math id="IM171" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>. A similar argument holds for an assumed usage, by <inline-formula id="IE212"><mml:math id="IM172" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, of a non-continuous suffix of EF and CF, respectively. Furthermore, a similar argument holds for the left side of the interval.</p>
        <p>We conclude that:<statement id="mthst6"><label>Theorem 1.</label><p><italic toggle="yes">For any k (counting label swaps in a data D)</italic>, <inline-formula id="IE213"><mml:math id="IM173" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">max</mml:mi><mml:mo>{</mml:mo><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>λ</mml:mo><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">is attained by swapping the labels in one of the sets listed in C<sub>U</sub> and therefore determined by a triplet</italic> <inline-formula id="IE173"><mml:math id="IM174" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic toggle="yes">. Similarly</italic>, <inline-formula id="IE174"><mml:math id="IM175" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">min</mml:mi><mml:mo>{</mml:mo><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>λ</mml:mo><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>  <italic toggle="yes">is attained by a set in C<sub>L</sub> and therefore also determined by some (other) triplet</italic> <inline-formula id="IE175"><mml:math id="IM176" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></statement></p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We now demonstrate the calculation of stability intervals on three different datasets (see Kaplan-Meier curves in Figs 1, 4 and 5). In calculating the interval, we use our efficient LoRSI algorithm, which is considering only a small set of relevant swaps, depending on the value of <italic toggle="yes">α</italic>, as described above. To provide a more complete information on how labeling errors can affect a given dataset, we also present the full <italic toggle="yes">P</italic>-value distribution. In order to do this, we calculate the log-rank <italic toggle="yes">P</italic>-value for all possible swaps according to <italic toggle="yes">α</italic>. The <italic toggle="yes">P</italic>-value distributions for <inline-formula id="IE176"><mml:math id="IM177" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, pertaining to the <italic toggle="yes">n</italic> + 1 swaps (including the non-swap original data) are depicted in <xref rid="btab495-F3" ref-type="fig">Figure 3B, D and F</xref>. In addition, we present, in <xref rid="btab495-F3" ref-type="fig">Figure 3A, C and E</xref>, for each dataset, the <italic toggle="yes">P</italic>-value as a function of the time and type of the swapped sample. For the first dataset, we also calculated the interval for 2 and 3 changes (<xref rid="btab495-F6" ref-type="fig">Fig. 6</xref>). It should be noted that the calculation of the full distribution introduces a prohibitive time complexity. A more detailed comparison to our efficient approach is given below.</p>
    <fig position="float" id="btab495-F4">
      <label>Fig. 4.</label>
      <caption>
        <p>Kaplan Meier curve and log-rank p-value according to ECOG score of patients with advanced colorectal or lung cancer - ECOG=0 Vs ECOG &gt; 0</p>
      </caption>
      <graphic xlink:href="btab495f4" position="float"/>
    </fig>
    <p>The first dataset is the MAINZ cohort (<xref rid="btab495-B22" ref-type="bibr">Schmidt <italic toggle="yes">et al.</italic>, 2008</xref>). We divided the data according to the subtype—Luminal A versus not Luminal A. It is well known that the breast cancer subtype Luminal A has better prognosis than the rest of the subgroups (<xref rid="btab495-B5" ref-type="bibr">Fallahpour <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab495-B11" ref-type="bibr">Howlader <italic toggle="yes">et al.</italic>, 2018</xref>). As expected and as stated in the introduction, a log-rank test demonstrates this difference with <italic toggle="yes">P</italic>-value = 0.014 (see the left panel in <xref rid="btab495-F1" ref-type="fig">Fig. 1</xref>). The stability interval calculated given <inline-formula id="IE180"><mml:math id="IM178" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo> </mml:mo><mml:mo>&amp;</mml:mo><mml:mo> </mml:mo><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is [0.006, 0.029], see <xref rid="btab495-F3" ref-type="fig">Figure 3A and B</xref>. This interval represents a 57% and 107% decrease/increase from the original <italic toggle="yes">P</italic>-value, respectively. We note that <inline-formula id="IE181"><mml:math id="IM179" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> in this dataset is only 0.5%. Using <inline-formula id="IE182"><mml:math id="IM180" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, the effect is still dramatic: a 101% increase to the inferred maximum <italic toggle="yes">P</italic>-value (SI = [0.006, 0.0282]). We further investigate the effect of <inline-formula id="IE183"><mml:math id="IM181" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE184"><mml:math id="IM182" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. The stability interval calculated for <inline-formula id="IE185"><mml:math id="IM183" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> is [0.0029, 0.055] and when using <inline-formula id="IE186"><mml:math id="IM184" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, we got <inline-formula id="IE187"><mml:math id="IM185" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.034</mml:mn></mml:mrow></mml:math></inline-formula>. The stability interval calculated for <inline-formula id="IE188"><mml:math id="IM186" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> is [0.0013, 0.095] and when using <inline-formula id="IE189"><mml:math id="IM187" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> we got <inline-formula id="IE190"><mml:math id="IM188" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.043</mml:mn></mml:mrow></mml:math></inline-formula>. Here, again, we calculated the full <italic toggle="yes">P</italic>-value distribution to provide the complete information (see <xref rid="btab495-F6" ref-type="fig">Fig. 6</xref>), a time consuming process. In order to find the stability interval, using the full <italic toggle="yes">P</italic>-value distribution for <inline-formula id="IE191"><mml:math id="IM189" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, one needs to perform <inline-formula id="IE192"><mml:math id="IM190" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> log-rank calculations. Our LoRSI algorithm needs only <inline-formula id="IE193"><mml:math id="IM191" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> such calculations, as described in Section 2. It took 2.5 min to calculate the SI using the full <italic toggle="yes">P</italic>-value distribution, for <inline-formula id="IE194"><mml:math id="IM192" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, where LoRSI took 0.5 s. For <inline-formula id="IE195"><mml:math id="IM193" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, the gap is much larger: almost 3 h to calculate the SI using the full <italic toggle="yes">P</italic>-value distribution and only 0.75 s for LoRSI. Furthermore, setting <inline-formula id="IE196"><mml:math id="IM194" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math></inline-formula>, which represents the error rate according to <xref rid="btab495-B3" ref-type="bibr">Ebbert <italic toggle="yes">et al.</italic> (2011)</xref>, we need to investigate <italic toggle="yes">k</italic> = 8 changes, which is totally impractical. LoRSI will take seconds to do the SI calculation.</p>
    <p>The second dataset came from a study that was developed to compare descriptive information from a patient-completed questionnaire to that obtained by the patient’s physician <xref rid="btab495-B18" ref-type="bibr">Loprinzi <italic toggle="yes">et al.</italic> (1994)</xref>. All the patients suffered from advanced colorectal or lung cancer. We consider the ECOG score calculated by a physician that assess the patients as a label for assessing survival differences. The 0 score represents fully active, able to carry on all pre-disease activities without restriction. Higher ECOG means less ability to perform usual daily activities, where 5 is the highest score. We divided the data according to ECOG = 0 and ECOG &gt; 0. The statistical difference in survival between the groups is significant with log-rank <italic toggle="yes">P</italic>-value = 0.0021 (<xref rid="btab495-F4" ref-type="fig">Fig. 4</xref>). The stability interval calculated given <inline-formula id="IE197"><mml:math id="IM195" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo> </mml:mo><mml:mo>&amp;</mml:mo><mml:mo> </mml:mo><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is [0.0004, 0.0079], see in <xref rid="btab495-F3" ref-type="fig">Figure 3C and D</xref>. This interval represents a 81% and 276% decrease/increase from the original <italic toggle="yes">P</italic>-value, respectively.</p>
    <fig position="float" id="btab495-F5">
      <label>Fig. 5.</label>
      <caption>
        <p>Kaplan Meier curve and log-rank p-value according to expression of the gene MSH2 in ovarian cancer patients - MSH2 expression &gt;-0.7 Vs MSH2 expression ≤-0.7</p>
      </caption>
      <graphic xlink:href="btab495f5" position="float"/>
    </fig>
    <p>The third and last dataset comes from an investigation of the gene expression in ovarian cancer patients, using the TCGA data (<xref rid="btab495-B20" ref-type="bibr">Network <italic toggle="yes">et al.</italic>, 2011</xref>). The MSH2 gene was shown to be associated with survival in ovarian cancer (<xref rid="btab495-B1" ref-type="bibr">Borcherding <italic toggle="yes">et al.</italic>, 2018</xref>). We took the relevant part of the TCGA dataset and split the samples into two groups according the optimal cutoff suggested by <xref rid="btab495-B1" ref-type="bibr">Borcherding <italic toggle="yes">et al.</italic> (2018)</xref>. This cutoff is (standardized) MSH2 expression &gt;−0.7 and it yields a log-rank <italic toggle="yes">P</italic>-value of 0.0347 (<xref rid="btab495-F5" ref-type="fig">Fig. 5</xref>). The resulting SI at <inline-formula id="IE199"><mml:math id="IM196" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> is [0.009275, 0.0947], see in <xref rid="btab495-F3" ref-type="fig">Figure 3E and F</xref>. Here, the SI represents a 73% decrease from the original <italic toggle="yes">P</italic>-value to the minimum <italic toggle="yes">P</italic>-value and a 273% increase to the maximum <italic toggle="yes">P</italic>-value. This <italic toggle="yes">P<sub>U</sub></italic> results from swapping only one single sample (the latest censored sample in <italic toggle="yes">C<sub>F</sub></italic>), which is 0.24% of the samples in the cohort. Moreover, increasing <italic toggle="yes">δ</italic> to 0.05 will change <italic toggle="yes">P<sub>U</sub></italic> to 0.06, still a dramatic effect. To obtain <inline-formula id="IE200"><mml:math id="IM197" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, we need to set <italic toggle="yes">δ</italic> to 0.1. The meaning of this result is that 10% of the single sample labeling swaps, applied to a dataset that originally had a significant survival signal, result in a non-significant <italic toggle="yes">P</italic>-value.</p>
    <fig position="float" id="btab495-F6">
      <label>Fig. 6.</label>
      <caption>
        <p>p-value distribution on the MAINZ cohort (Luminal A versus not Luminal A), when <inline-formula id="IE599"><mml:math id="IM198" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, panel A, and when <inline-formula id="IE699"><mml:math id="IM199" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, panel B. The black line is the original p-value. The solid red lines are the <italic toggle="yes">P<sub>L</sub></italic> and <italic toggle="yes">P<sub>U</sub></italic> when <italic toggle="yes">δ</italic> = 0. The dashed red line represents the <italic toggle="yes">P<sub>U</sub></italic> when <italic toggle="yes">δ</italic> = 0.05</p>
      </caption>
      <graphic xlink:href="btab495f6" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this work, we introduce the novel concept of stability interval for log-rank test. This interval represents the possible effects of perturbing the labels from the original survival analysis data. We show that even a small error rate in the labels can lead to dramatically different statistical conclusions. Our calculated stability interval bounds these differences, thus allowing an assessment of the stability of the statistical test, under labeling errors. We focus on the definition of the stability interval for log-rank and develop an algorithm for efficiently calculating the interval for any <italic toggle="yes">α</italic>.</p>
    <p>We present a deterministic approach for addressing the labeling error issue, where we consider all possible label swaps that affect different sample sets representing exactly <italic toggle="yes">α</italic> fraction of the samples. One can also take a stochastic approach, wherein instances are generated, in which each sample label is swapped with probability <italic toggle="yes">α</italic>. The number of labels actually swapped will then have a <inline-formula id="IE202"><mml:math id="IM200" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Binom</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> distribution. Sampling sufficiently many instances, or analytically characterizing the resulting sample space, will lead to a new way of calculating the stability interval from the resulting <italic toggle="yes">P</italic>-value distribution. While in the deterministic approach, we (in effect) assume a uniform error distribution, in this stochastic approach we can, theoretically, use any error distribution. This includes, e.g. models that would assign confidence to individual labels, making swaps less or more likely for individual subjects in the cohort. The study of this interesting and potentially useful extension is a topic for future research. Our approach is also extended to address a confidence parameter <italic toggle="yes">δ</italic>. Specifically, we find the smallest number <italic toggle="yes">p<sub>U</sub></italic> for which <inline-formula id="IE203"><mml:math id="IM201" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> holds for a <inline-formula id="IE204"><mml:math id="IM202" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>δ</mml:mo></mml:mrow></mml:math></inline-formula> fraction of possible labeling changes <inline-formula id="IE205"><mml:math id="IM203" display="inline" overflow="scroll"><mml:mrow><mml:mo>λ</mml:mo><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This represents a conservative approach to taking <italic toggle="yes">δ</italic> into account. Namely, one that focuses on the desired significance threshold, as may be determined, by the user, in the study design.</p>
    <p>We note that in the proof of our algorithmic approach, we distinguish between working with the CDFs of sums of hypergeometric distributions and working with their standardized versions. Our result, pertaining to how the ends of the log-rank SI can be obtained by calculating the results of <inline-formula id="IE206"><mml:math id="IM204" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> sets of <italic toggle="yes">k</italic> swapped, holds for large <italic toggle="yes">J</italic>s as it requires a normal approximation. If differences in survival are directly assessed against the underlying sum of hypergeometric variables null model, then some of our results hold for any <italic toggle="yes">J</italic>.</p>
    <p>We investigated the advantage of using our efficient LoRSI approach as compared to calculating the stability interval by generating the full <italic toggle="yes">P</italic>-value distribution. While LoRSI performs <inline-formula id="IE207"><mml:math id="IM205" display="inline" overflow="scroll"><mml:mrow><mml:mo>Θ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> log-rank calculations to address <italic toggle="yes">k</italic> changes, the exhaustive approach takes <inline-formula id="IE208"><mml:math id="IM206" display="inline" overflow="scroll"><mml:mrow><mml:mo>Θ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> such calculations. This complexity gap leads to seconds versus hours difference for small values of <italic toggle="yes">k</italic> and to LoRSI being the only practical approach in higher values.</p>
    <p>We provide a Python implementation of the LoRSI algorithm. Current work focuses on the development of more efficient and user friendly implementations of the methods described herein as well as on visualization tools. All will be made available through future releases. We hope that such efforts will make statistical stability analysis more accessible and useful for the community.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab495_Supplementary_Data</label>
      <media xlink:href="btab495_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the Technion Computer Science Department and the School of Computer Science at IDC Herzliya, for their support of the project. We thank the Yakhini Research Group for important discussions and input. We thank Xavier Tekpli for important discussion and insights.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the European Union’s Horizon 2020 Research and Innovation Program under RESCUER, GA No. [847912].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab495-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borcherding</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>TRGAted: a web tool for survival analysis using protein data in the cancer genome atlas</article-title>. <source>F1000Res</source>., <volume>7</volume>, <fpage>1235</fpage>.<pub-id pub-id-type="pmid">30345029</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Cover</surname><given-names>T.M.</given-names></string-name></person-group> (<year>1999</year>) <source>Elements of Information Theory</source>. <publisher-name>John Wiley &amp; Sons, NJ, USA</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btab495-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebbert</surname><given-names>M.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Characterization of uncertainty in the classification of multivariate assays: application to pam50 centroid-based genomic predictors for breast cancer treatment plans</article-title>. <source>J. Clin. Bioinform</source>., <volume>1</volume>, <fpage>37</fpage>.</mixed-citation>
    </ref>
    <ref id="btab495-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elmore</surname><given-names>J.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Pathologists’ diagnosis of invasive melanoma and melanocytic proliferations: observer accuracy and reproducibility study</article-title>. <source>BMJ</source>, <volume>357</volume>, <fpage>j2813</fpage>.<pub-id pub-id-type="pmid">28659278</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fallahpour</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Breast cancer survival by molecular subtype: a population-based analysis of cancer registry data</article-title>. <source>CMAJ Open</source>, <volume>5</volume>, <fpage>E734</fpage>–<lpage>E739</lpage>.</mixed-citation>
    </ref>
    <ref id="btab495-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Galili</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Efficient gene expression signature for a breast cancer immuno-subtype</article-title>. <source>PLoS One</source>, <volume>16</volume>, <fpage>e0245215</fpage>.<pub-id pub-id-type="pmid">33434192</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ha</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Predicting breast cancer molecular subtype with MRI dataset utilizing convolutional neural network algorithm</article-title>. <source>J. Digit. Imaging</source>, <volume>32</volume>, <fpage>276</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">30706213</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heimann</surname><given-names>G.</given-names></string-name>, <string-name><surname>Neuhaus</surname><given-names>G.</given-names></string-name></person-group> (<year>1998</year>) <article-title>Permutational distribution of the log-rank statistic under random censorship with applications to carcinogenicity assays</article-title>. <source>Biometrics</source>, <volume>54</volume>, <fpage>168</fpage>–<lpage>184</lpage>.<pub-id pub-id-type="pmid">9544515</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hothorn</surname><given-names>T.</given-names></string-name>, <string-name><surname>Lausen</surname><given-names>B.</given-names></string-name></person-group> (<year>2003</year>) <article-title>On the exact distribution of maximally selected rank statistics</article-title>. <source>Comput. Stat. Data Anal</source>., <volume>43</volume>, <fpage>121</fpage>–<lpage>137</lpage>.</mixed-citation>
    </ref>
    <ref id="btab495-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hougaard</surname><given-names>P.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Frailty models for survival data</article-title>. <source>Lifetime Data Anal</source>., <volume>1</volume>, <fpage>255</fpage>–<lpage>273</lpage>.<pub-id pub-id-type="pmid">9385105</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howlader</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Differences in breast cancer survival by molecular subtypes in the united states</article-title>. <source>Cancer Epidemiol. Biomarkers Prev</source>., <volume>27</volume>, <fpage>619</fpage>–<lpage>626</lpage>.<pub-id pub-id-type="pmid">29593010</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Islam</surname><given-names>M.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>An integrative deep learning framework for classifying molecular subtypes of breast cancer</article-title>. <source>Comput. Struct. Biotechnol. J</source>., <volume>18</volume>, <fpage>2185</fpage>–<lpage>2199</lpage>.<pub-id pub-id-type="pmid">32952934</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaber</surname><given-names>M.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A deep learning image-based intrinsic molecular subtype classifier of breast tumors reveals tumor heterogeneity that may affect survival</article-title>. <source>Breast Cancer Res</source>., <volume>22</volume>, <fpage>12</fpage>.<pub-id pub-id-type="pmid">31992350</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname><given-names>S.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Diagnostic reproducibility: what happens when the same pathologist interprets the same breast biopsy specimen at two points in time?</article-title>  <source>Ann. Surg. Oncol</source>., <volume>24</volume>, <fpage>1234</fpage>–<lpage>1241</lpage>.<pub-id pub-id-type="pmid">27913946</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kleinbaum</surname><given-names>D.G.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>M.</given-names></string-name></person-group> (<year>2012</year>) <source>Survival Analysis</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab495-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levy-Jurgenson</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Spatial transcriptomics inferred from pathology whole-slide images links tumor heterogeneity to survival in breast and lung cancer</article-title>. <source>Sci. Rep</source>., <volume>10</volume>, <fpage>18802</fpage>.<pub-id pub-id-type="pmid">33139755</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lindeberg</surname><given-names>J.W.</given-names></string-name></person-group> (<year>1922</year>) <article-title>Eine neue herleitung des exponentialgesetzes in der wahrscheinlichkeitsrechnung</article-title>. <source>Math. Z</source>., <volume>15</volume>, <fpage>211</fpage>–<lpage>225</lpage>.</mixed-citation>
    </ref>
    <ref id="btab495-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loprinzi</surname><given-names>C.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1994</year>) <article-title>Prospective evaluation of prognostic variables from patient-completed questionnaires. North Central Cancer Treatment Group</article-title>. <source>J. Clin. Oncol</source>., <volume>12</volume>, <fpage>601</fpage>–<lpage>607</lpage>.<pub-id pub-id-type="pmid">8120560</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mantel</surname><given-names>N.</given-names></string-name></person-group> (<year>1966</year>) <article-title>Evaluation of survival data and two new rank order statistics arising in its consideration</article-title>. <source>Cancer Chemother. Rep</source>., <volume>50</volume>, <fpage>163</fpage>–<lpage>170</lpage>.<pub-id pub-id-type="pmid">5910392</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Network</surname><given-names>C.G.A.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Integrated genomic analyses of ovarian carcinoma</article-title>. <source>Nature</source>, <volume>474</volume>, <fpage>609</fpage>.<pub-id pub-id-type="pmid">21720365</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pitt</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1999</year>) <article-title>The effect of spironolactone on morbidity and mortality in patients with severe heart failure</article-title>. <source>N. Engl. J. Med</source>., <volume>341</volume>, <fpage>709</fpage>–<lpage>717</lpage>.<pub-id pub-id-type="pmid">10471456</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schmidt</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>The humoral immune system has a key prognostic impact in node-negative breast cancer</article-title>. <source>Cancer Res</source>., <volume>68</volume>, <fpage>5405</fpage>–<lpage>5413</lpage>.<pub-id pub-id-type="pmid">18593943</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tourneau</surname><given-names>C.L.</given-names></string-name></person-group>  <etal>et al</etal>; SHIVA investigators. (<year>2015</year>) <article-title>Molecularly targeted therapy based on tumour molecular profiling versus conventional therapy for advanced cancer (SHIVA): a multicentre, open-label, proof-of-concept, randomised, controlled phase 2 trial</article-title>. <source>Lancet Oncol</source>., <volume>16</volume>, <fpage>1324</fpage>–<lpage>1334</lpage>.<pub-id pub-id-type="pmid">26342236</pub-id></mixed-citation>
    </ref>
    <ref id="btab495-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vandin</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Accurate computation of survival statistics in genome-wide studies</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004071</fpage>.<pub-id pub-id-type="pmid">25950620</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
