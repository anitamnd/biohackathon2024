<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6503164</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2019.00400</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NormExpression: An R Package to Normalize Gene Expression Data Using Evaluated Methods</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Zhenfeng</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="fn002">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Weixiang</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="author-notes" rid="fn002">
          <sup>†</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/520656/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Xiufeng</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Haishuo</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/513908/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Hua</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/662453/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glusman</surname>
          <given-names>Gustavo</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/196951/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Max</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/42047/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jishou</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gao</surname>
          <given-names>Shan</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/512809/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>School of Mathematical Sciences, Nankai University</institution>, <addr-line>Tianjin</addr-line>, <country>China</country></aff>
    <aff id="aff2"><sup>2</sup><institution>College of Life Sciences, Nankai University</institution>, <addr-line>Tianjin</addr-line>, <country>China</country></aff>
    <aff id="aff3"><sup>3</sup><institution>School of Biomedical Engineering, Health Science Center, Shenzhen University</institution>, <addr-line>Shenzhen</addr-line>, <country>China</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Institute for Systems Biology</institution>, <addr-line>Washington, DC</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Tuo Zhang, Cornell University, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Yudong Cai, Shanghai University, China; Naibin Duan, Shandong Academy of Agricultural Sciences, China</p>
      </fn>
      <corresp id="c001">*Correspondence: Jishou Ruan, <email>jsruan@nankai.edu.cn</email> Shan Gao, <email>gao_shan@mail.nankai.edu.cn</email></corresp>
      <fn fn-type="other" id="fn002">
        <p><sup>†</sup>These authors have contributed equally to this work</p>
      </fn>
      <fn fn-type="other" id="fn003">
        <p>This article was submitted to Bioinformatics and Computational Biology, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>400</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Wu, Liu, Jin, Ji, Wang, Glusman, Robinson, Liu, Ruan and Gao.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Wu, Liu, Jin, Ji, Wang, Glusman, Robinson, Liu, Ruan and Gao</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Data normalization is a crucial step in the gene expression analysis as it ensures the validity of its downstream analyses. Although many metrics have been designed to evaluate the existing normalization methods, different metrics or different datasets by the same metric yield inconsistent results, particularly for the single-cell RNA sequencing (scRNA-seq) data. The worst situations could be that one method evaluated as the best by one metric is evaluated as the poorest by another metric, or one method evaluated as the best using one dataset is evaluated as the poorest using another dataset. Here raises an open question: principles need to be established to guide the evaluation of normalization methods. In this study, we propose a principle that one normalization method evaluated as the best by one metric should also be evaluated as the best by another metric (the consistency of metrics) and one method evaluated as the best using scRNA-seq data should also be evaluated as the best using bulk RNA-seq data or microarray data (the consistency of datasets). Then, we designed a new metric named Area Under normalized CV threshold Curve (AUCVC) and applied it with another metric mSCC to evaluate 14 commonly used normalization methods using both scRNA-seq data and bulk RNA-seq data, satisfying the consistency of metrics and the consistency of datasets. Our findings paved the way to guide future studies in the normalization of gene expression data with its evaluation. The raw gene expression data, normalization methods, and evaluation metrics used in this study have been included in an R package named NormExpression. NormExpression provides a framework and a fast and simple way for researchers to select the best method for the normalization of their gene expression data based on the evaluation of different methods (particularly some data-driven methods or their own methods) in the principle of the consistency of metrics and the consistency of datasets.</p>
    </abstract>
    <kwd-group>
      <kwd>gene expression</kwd>
      <kwd>normalization</kwd>
      <kwd>evaluation</kwd>
      <kwd>R package</kwd>
      <kwd>scRNA-seq</kwd>
    </kwd-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="0"/>
      <equation-count count="0"/>
      <ref-count count="17"/>
      <page-count count="8"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Global gene expression analysis provides quantitative information about the population of RNA species in cells and tissues (<xref rid="B13" ref-type="bibr">Lovén et al., 2012</xref>). High-throughput technologies to measure global gene expression levels started with Serial Analysis of Gene Expression (SAGE) and are widely used with microarray and RNA-seq (<xref rid="B7" ref-type="bibr">Gao et al., 2014</xref>). Recently, single-cell RNA sequencing (scRNA-seq) has been used to simultaneously measure the expression levels of genes from a single cell, providing a higher resolution of cellular differences than what can be achieved by bulk RNA-seq, which can only produce an expression value for each gene by averaging its expression levels across a large population of cells (<xref rid="B6" ref-type="bibr">Gao, 2018</xref>). Raw gene expression data from these high-throughput technologies must be normalized to remove technical variation so that meaningful biological comparisons can be made. Data normalization is a crucial step in the gene expression analysis as it ensures the validity of its downstream analyses (<xref rid="B13" ref-type="bibr">Lovén et al., 2012</xref>). The differential expression analysis or the co-expression analysis using the same dataset could produce significant different genes using different data normalization methods. Although the significance of data normalization in the gene expression analysis has been demonstrated (<xref rid="B3" ref-type="bibr">Bullard et al., 2010</xref>), how to select a successful normalization method is still an open question, particularly for scRNA-seq data.</p>
    <p>Basically, two classes of methods are available to normalize gene expression data using global normalization factors. They are the control-based normalization and the average-bulk normalization. The former class of methods assumes the total expression level summed over a pre-specified group of genes is approximately the same across all the samples. The latter class of methods assumes most genes are not significantly Differentially Expressed (DE) across all the samples. The control-based normalization often uses RNA from a group of internal control genes (e.g., housekeeping genes) or external spike-in RNA [e.g., ERCC RNA (<xref rid="B11" ref-type="bibr">Jiang et al., 2011</xref>)], while the average-bulk normalization is more commonly used for their universality. Five average-bulk normalization methods designed to normalize bulk RNA-seq data are library size, median of the ratios of observed counts that is also referred to as DESeq (<xref rid="B1" ref-type="bibr">Anders and Huber, 2010</xref>), Relative Log Expression (RLE), upper quartile (UQ), and Trimmed Mean of M values (TMM) (<xref rid="B15" ref-type="bibr">Robinson et al., 2010</xref>). Recently, three new methods were introduced as Total Ubiquitous (TU), Network Centrality Scaling (NCS), and Evolution Strategy (ES) with the best performance among 15 tested methods (<xref rid="B10" ref-type="bibr">Glusman et al., 2013</xref>). To improve scRNA-seq data normalization, <xref rid="B14" ref-type="bibr">Lun et al. (2016)</xref> introduced a new method using the pooled size factors (Pooled) and claimed that their method outperformed the library size method, DESeq and TMM. <xref rid="B2" ref-type="bibr">Bacher et al. (2017)</xref> addressed that using existing normalization methods on scRNA-seq data introduced artifacts that bias downstream analyses. Then, another new method SCnorm was introduced and claimed to outperform MR, Transcripts Per Million (TPM), scran, SCDE, and BASiCS using both simulated and case study data (<xref rid="B2" ref-type="bibr">Bacher et al., 2017</xref>).</p>
    <p>Although many metrics have been designed to evaluate the relative success of these methods, different metrics or different datasets yield inconsistent evaluation results. Here raises another open question: principles need to be established to guide the evaluation of normalization methods. <xref rid="B10" ref-type="bibr">Glusman et al. (2013)</xref> proposed that a successful normalization method should simultaneously maximize the number of uniform genes and minimize the correlation between the expression profiles of gene pairs. Based on this criterion, they presented two novel and mutually independent metrics to evaluate 15 normalization methods and achieved consistent results using bulk RNA-seq data (<xref rid="B10" ref-type="bibr">Glusman et al., 2013</xref>). In this study, we designed a new metric named Area Under normalized CV threshold Curve (AUCVC) and applied it with another metric mSCC (see section “Materials and Methods”) to evaluate 14 commonly used normalization methods using both scRNA-seq and bulk RNA-seq data from the same library construction protocol. The evaluation results by both AUCVC and mSCC achieved consistency. In addition, the evaluation results using both scRNA-seq and bulk RNA-seq data also achieved consistency. So, we propose a principle that one normalization method evaluated as the best by one metric should also be evaluated as the best by another metric (the consistency of metrics) and one method evaluated as the best using one dataset should also be evaluated as the best using another dataset (the consistency of datasets). The datasets using different protocols (RNA-seq, scRNA-seq, or microarray) need to be used to validate the consistency, which is beyond the scope of this study. As many new normalization methods are being developed, researchers need a fast and simple way to evaluate different methods, particularly some data-driven methods or their own methods, rather than obtain information from published evaluation results, which could have biases or mistakes, e.g., misunderstanding of RLE, UQ and TMM (see section “Results”). To satisfy this demand, we developed an R package NormExpression including the raw gene expression data, normalization methods and evaluation metrics used in this study. This tool provides a framework for researchers to select the best method for the normalization of their gene expression data based on the evaluation of different methods in the principle proposed in this study.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Basic Concepts</title>
      <p>In total, 14 normalization methods have been evaluated in this study. They are Housekeeping Genes (HG7), External RNA Control Consortium (ERCC), Total Read Number (TN), Total Read Count (TC), Cellular RNA (CR), Nuclear RNA (NR), median of the ratios of observed counts (DESeq), Relative Log Expression (RLE), UQ, Trimmed Mean of M values (TMM), Total Ubiquitous (TU), Network Centrality Scaling (NCS), Evolution Strategy (ES), and SCnorm (see section “Materials and Methods”). Currently, most methods with a few exceptions (e.g., SCnorm) are used to normalize a raw gene expression matrix (n samples by m genes) by multiplying a global normalization factor to each of its columns, yielding a normalized gene expression matrix (<xref ref-type="fig" rid="F1">Figure 1A</xref>). In different methods, the definitions of normalization factor, scaling factor and size factor are inconsistent and need to be explained here. Both the normalization factor defined in the package NormExpression and the scaling factor defined in a previous study (<xref rid="B10" ref-type="bibr">Glusman et al., 2013</xref>) are the global normalization factors (<xref ref-type="fig" rid="F1">Figure 1A</xref>). As the library size methods, TN, TC, CR, or NR can be used to estimate a library size, which represents the amount of total RNA in a cDNA library from a sample. HG7, ERCC, DESeq, TU, NCS, and ES produce a pseudo library size (in <xref ref-type="fig" rid="F1">Figure 1B</xref>), which represents the relative amount of total RNA. Library size is also named as size factor in the Bioconductor package DESeq (<xref rid="B1" ref-type="bibr">Anders and Huber, 2010</xref>). In general, HG7, ERCC, TN, TC, CR, NR, DESeq, TU, NCS, and ES produce the global normalization factor by the reciprocal of library size or pseudo library size. RLE, UQ, and TMM in the Bioconductor package edgeR (<xref rid="B15" ref-type="bibr">Robinson et al., 2010</xref>) produce normalization factors to normalize the library sizes and the global normalization factors for data normalization should be calculated by one million multiplying the reciprocal of normalized library sizes (<xref ref-type="fig" rid="F1">Figure 1B</xref>). However, the normalization factors produced by RLE, UQ, and TMM have been wrongly used as the global normalization factors in previous studies (<xref rid="B12" ref-type="bibr">Li et al., 2015</xref>). The NormExpression package includes such modifications as below to integrate the above normalization methods. DESeq, RLE, UQ, and TMM have been modified to ignore zero values to be fit for the scRNA-seq data processing. As NR is the best among the library size methods (TN, TC, CR, and NR), RLE, UQ, and TMM use NR to estimate library sizes. As HG7 and ERCC produce pseudo library sizes (<xref ref-type="fig" rid="F1">Figure 1B</xref>) as TN, TC, CR, and NR, their normalization factors are amplified by one million for a uniform representation (<xref ref-type="fig" rid="F1">Figure 1B</xref>). The resulting normalization factors of all 14 methods except SCnorm need to be further normalized by their geometric mean values (<xref ref-type="fig" rid="F1">Figure 1B</xref>). After further normalization, RLE is identical to DESeq and presented as DESeq (RLE) or DESeq<sup>∗</sup> in this study. It has been confirmed that all the modifications do not change the evaluation results.</p>
      <fig id="F1" position="float">
        <label>FIGURE 1</label>
        <caption>
          <p>Basic concepts. <bold>(A)</bold> A raw gene expression matrix can be transformed into a normalized gene expression matrix by the multiplication of a global factor f<sub>j</sub> to each column. Each column represents the expression levels of all genes from a sample and each row represents the expression levels of a gene across all samples. <bold>(B)</bold> As the library size methods, TN, TC, CR, or NR can be used to estimate a library size N<sub>j</sub>. The library size methods (TN, TC, CR, and NR) produce the global normalization factor f<sub>j</sub> by the reciprocal of library size N<sub>j</sub>. HG7, ERCC, DESeq, TU, NCS, and ES produce a pseudo library size N<sub>j</sub><sup>∗</sup>, which represents the relative amount of total RNA. RLE, UQ, and TMM produce a normalization factor s<sub>j</sub> to normalize the library size N<sub>j</sub> and the global normalization factor for data normalization should be 10<sup>6</sup>/N<sub>j</sub>s<sub>j</sub>. Q<sub>75</sub> represents the third quartile Q<sub>3</sub>. For all methods, log represents the natural logarithm.</p>
        </caption>
        <graphic xlink:href="fgene-10-00400-g001"/>
      </fig>
    </sec>
    <sec>
      <title>Evaluation of 14 Normalization Methods</title>
      <p>In the previous study, <xref rid="B10" ref-type="bibr">Glusman et al. (2013)</xref> had quantified the success of normalization methods by the number of uniform genes (see section “Materials and Methods”) and used the Coefficient of Variation (CV) cutoff 0.25 to determine the number of uniform genes for each method. This metric was designed based on the theory that the relative values among different normalization methods are quite stable, although the absolute number of uniform genes depend on the cutoff value. However, it is almost impossible to determine a CV cutoff for scRNA-seq data as CV in scRNA-seq data has a much larger dynamic range than in bulk RNA-seq data. Inspired by Area Under the receiver operating characteristic Curve (AUC) (<xref rid="B9" ref-type="bibr">Gao et al., 2009</xref>), we designed a new metric named Area Under normalized CV threshold Curve (AUCVC) to evaluate normalization methods. Using one scRNA-seq dataset scRNA663 and one bulk RNA-seq dataset bkRNA18 (see section “Materials and Methods”), we applied AUCVC and another metric mSCC (see section “Materials and Methods”) to evaluate 14 normalization methods and then we compared the evaluation results by mSCC with those by AUCVC to assess the consistency of datasets and the consistency of metrics.</p>
      <p>The non-zero ratio cutoffs (see section “Materials and Methods”) from 0.2 to 0.9 for scRNA663 and from 0.7 to 1 for bkRNA18 were used to produce AUCVCs of all methods (<xref ref-type="fig" rid="F2">Figure 2A,B</xref>). Among 14 methods, TU, NCS, and ES are parameter-dependent approaches, which use the occurrence rate, upper and lower cutoffs as three parameters (see section “Materials and Methods”). For each non-zero ratio cutoff, TU used the maximum AUCVC to determine the optimal ones by testing all possible combinations of three parameters. In addition, the calculation only considered each combination of three parameters which produced more than 100 ubiquitous genes (see section “Materials and Methods”) for scRNA663 and more than 1,000 for bkRNA18. The occurrence rate cutoff was tested from 0.2 to 0.6 for scRNA663 at interval of 0.1 and set to 1 for bkRNA18. The lower cutoff was tested from 5 to 40% and the upper cutoff was tested from 60 to 95% at interval of 5%. For each non-zero ratio cutoff, NCS and ES used the occurrence rate, lower and upper cutoffs determined by TU, when TU achieved the maximum AUCVC.</p>
      <fig id="F2" position="float">
        <label>FIGURE 2</label>
        <caption>
          <p>Consistency of metrics and consistency of datasets. The non-zero ratio cutoffs from 0.2 to 0.9 for scRNA663 and from 0.7 to 1 for bkRNA18 were used to produce AUCVCs and mSCCs. All the normalization methods were classified into three groups based on their AUCVC values sorted in descending order (from the best to the poorest) using one scRNA-seq dataset scRNA663 <bold>(A)</bold> and one bulk RNA-seq dataset bkRNA18 <bold>(B)</bold>. These methods were also classified into three groups based on their mSCC values sorted in ascending order (from the best to the poorest) using one scRNA-seq dataset scRNA663 <bold>(C)</bold> and one bulk RNA-seq dataset bkRNA18 <bold>(D)</bold>. GAPDH is not applicable to scRNA-seq data due to zero counts of GAPDH present in many samples. All the numbers are accurate to two decimal places, the marginal differences are reflected by their orders. The raw gene expression data (None) was also used to produce AUCVCs and mSCCs for comparison. After further normalization, RLE is identical to DESeq and presented as DESeq (RLE) or DESeq<sup>∗</sup> in this study.</p>
        </caption>
        <graphic xlink:href="fgene-10-00400-g002"/>
      </fig>
      <p>The evaluation results using both scRNA663 and bkRNA18 showed consistency (the consistency of datasets) that all methods except HG7, TN and SCnorm were classified into three groups, based on their AUCVC values sorted in descending order (<xref ref-type="fig" rid="F2">Figure 2A,B</xref>). The first group including TU, NCS and ES achieved the best performances. TU, NCS and ES, which had only been evaluated using bulk RNA-seq data in the previous study (<xref rid="B10" ref-type="bibr">Glusman et al., 2013</xref>), were evaluated by our new metric AUCVC as the best normalization methods using both scRNA-seq and bulk RNA-seq data. The second group including ERCC, TC, CR, NR, DESeq, RLE, UQ, and TMM achieved medial performances using both scRNA663 and bkRNA18. In the second group, ERCC, TC, CR, and NR outperformed DESeq, RLE, UQ, and TMM using scRNA663 but underperformed them using bkRNA18. The third group achieved the poorest performances, including TN, SCnorm and None (the raw gene expression data) for scRNA663 (<xref ref-type="fig" rid="F2">Figure 2A</xref>), and HG7, GAPDH and None for bkRNA18 (<xref ref-type="fig" rid="F2">Figure 2B</xref>). The evaluation results of HG7, TN, and SCnorm did not achieve the consistency using scRNA663 and bkRNA18. HG7 and GAPDH achieved the poorest performances using bkRNA18, suggesting that a predefined set of housekeeping genes may not be appropriate guides for the normalization of bulk RNA-seq data. However, it could be coincidental that HG7 was classified into the first group using scRNA663. TN underperformed the second group of methods using scRNA663 but outperformed it using bkRNA18. SCnorm was designed to improve the normalization of scRNA-seq data but it performed poorer using scRNA-seq data than bulk RNA-seq data. Particularly, SCnorm ranked the first in the best group by its AUCVC to normalize bkRNA18 when the non-zero ratio cutoffs were set to 0.7 or 0.8 (<xref ref-type="fig" rid="F2">Figure 2B</xref>), but ranked the last in the poorest group to normalize scRNA663 when the non-zero ratio cutoffs were set to 0.2–0.4 (<xref ref-type="fig" rid="F2">Figure 2A</xref>). SCnorm claimed that it is not designed to process datasets containing more than 80% zero counts. However, scRNA663 was build using the Smart-seq2 scRNA-seq protocol, which contained the least zero counts among current scRNA-seq protocols.</p>
      <p>The evaluation results (<xref ref-type="fig" rid="F2">Figure 2C,D</xref>) by mSCC were consistent with those by AUCVC (the consistency of metrics). This proved that a successful normalization method simultaneously maximizes the number of uniform genes and minimizes the correlation between the expression profiles of gene pairs. We selected the best evaluation results using scRNA-seq data (the none-zero ratio cutoff = 0.2) and bulk RNA-seq data (the none-zero ratio cutoff = 1) in <xref ref-type="fig" rid="F2">Figure 2</xref> for visualization using NormExpression (<xref ref-type="fig" rid="F3">Figure 3</xref>). Then, we calculated the Spearman’s rank Correlation Coefficients (SCCs) between all the normalization factors except that using SCnorm. Using 1-SCCs as distances, hierarchical clustering of 13 normalization factors showed equivalent classification into the same groups (<xref ref-type="fig" rid="F3">Figure 3E,F</xref>) as those by AUCVC and by mSCC (<xref ref-type="fig" rid="F2">Figure 2</xref>). From <xref ref-type="fig" rid="F3">Figure 3</xref>, it can be seen that while all normalization methods except HG7, GAPDH and None performed without much differences using bulk RNA-seq data (<xref ref-type="fig" rid="F3">Figure 3B,D</xref>), they had significant differences in the performances using scRNA-seq data (<xref ref-type="fig" rid="F3">Figure 3A,C</xref>). These differences suggest that although scRNA-seq provides a higher resolution of cellular differences, it is more challenging to select the best method for the normalization of scRNA-seq data. In addition, these differences provided an explanation as to why scRNA-seq data and bulk RNA-seq data from the same samples resulted in different results in many previous studies. From <xref ref-type="fig" rid="F3">Figure 3</xref>, it also can be seen that the best mSCC (TU-normalized) using scRNA-seq data still had a certain distance from 0 (<xref ref-type="fig" rid="F3">Figure 3C</xref>), while the best mSCC (TU-normalized) using bulk RNA-seq data was close to 0 (<xref ref-type="fig" rid="F3">Figure 3D</xref>). Therefore, further studies need to be conducted to investigate whether we can obtain the best mSCC using scRNA-seq data close to 0 as that using bulk RNA-seq data. If we cannot, what is the reason? And is it the nature of scRNA-seq data that result in this bias from 0?</p>
      <fig id="F3" position="float">
        <label>FIGURE 3</label>
        <caption>
          <p>Visualization of evaluation results. A normalization method with a higher AUCVC produced a lower median of Spearman’s rank Correlation Coefficient (mSCC) between the normalized expression profiles of ubiquitous gene pairs using both scRNA-seq <bold>(A,C)</bold> and bulk RNA-seq data <bold>(B,D)</bold>. Using 1-SCCs as distances, hierarchical clustering of 13 normalization factors showed equivalent classification into the same groups <bold>(E,F)</bold> as those by AUCVC and by mSCC (<xref ref-type="fig" rid="F2">Figure 2</xref>). SCnorm was not applicable to be used to calculate SCCs, as it produced a factor matrix rather than a factor vector as 13 other methods. GAPDH is not applicable to scRNA-seq data due to zero counts of GAPDH present in many samples. The raw gene expression data (None) was also used to produce AUCVCs and mSCCs for comparison. After further normalization, RLE is identical to DESeq and presented as DESeq (RLE) or DESeq<sup>∗</sup> in this study.</p>
        </caption>
        <graphic xlink:href="fgene-10-00400-g003"/>
      </fig>
      <p>To further test our principle, we searched other performance metrics in the published papers. The Bioconductor package scone (<xref rid="B4" ref-type="bibr">Cole et al., 2018</xref>) provides eight metrics to evaluate the normalization methods using scRNA-seq data. Among eight metrics, three are based on clustering properties and three other metrics are associated with control genes or QC metrics. Only two metrics based on global distributional properties can be used as general metrics. These two metrics are named as mean squared median relative log-expression (RLE_MED) and variance of inter-quartile range (IQR) of RLE (RLE_IQR). The evaluation results (Supplementary File <xref ref-type="supplementary-material" rid="SM1">1</xref>) of three groups (particularly TU and ES) by RLE_MED were consistent with those by mSCC and by AUCVC using both scRNA-seq and bulk RNA-seq data. However, the evaluation results (Supplementary File <xref ref-type="supplementary-material" rid="SM1">1</xref>) by RLE_IQR were not consistent with those by mSCC and by AUCVC. This suggests that mSCC, AUCVC, RLE_MED can be used together for method evaluation to test the consistency of metrics.</p>
    </sec>
    <sec>
      <title>Implementation and Availability</title>
      <p>The raw gene expression data, normalization methods (except NCS, ES and SCnorm) and evaluation metrics (AUCVC and mSCC) have been included in the R package NormExpression. The data process in this study is provided in detail (Supplementary File <xref ref-type="supplementary-material" rid="SM1">1</xref>). All the methods except NCS and ES have been implemented in R programs for their running on R platforms of any version. DESeq uses an R program from the Bioconductor package DESeq (<xref rid="B1" ref-type="bibr">Anders and Huber, 2010</xref>), which has been modified to process scRNA-seq data. RLE, UQ and TMM use R programs from the Bioconductor package edgeR (<xref rid="B15" ref-type="bibr">Robinson et al., 2010</xref>), which have been modified to process scRNA-seq data. NCS and ES had been implemented in Perl programs with multiple dependencies on Perl modules (<xref rid="B10" ref-type="bibr">Glusman et al., 2013</xref>), which have been modified into stand-alone programs for Linux systems (Supplementary File <xref ref-type="supplementary-material" rid="SM2">2</xref>). SCnorm uses the Bioconductor package SCnorm (<xref rid="B2" ref-type="bibr">Bacher et al., 2017</xref>).</p>
      <p>NormExpression can be used in three modes: normalization without evaluation, normalization with simple evaluation or normalization with complete evaluation. In the first mode, TU is recommended for the normalization of gene expression data, as it has been already ranked as the best method for both scRNA-seq and bulk RNA-seq data. In the second mode, AUCVC is used to select the best method from 10 normalization methods, which are HG7, ERCC (if available), TN, TC, CR, NR, DESeq (RLE), UQ, and TMM. TN, NCS, ES, and SCnorm are not used in the second mode, as the evaluation results of TN and SCnorm cannot achieve consistency, and NCS and ES have similar performances to TU but are much more time consuming. In the third mode, AUCVC and mSCC are used to select the best method from TU and at least 10 normalization methods. The normalization with simple evaluation determines the best method based on AUCVC values, while the normalization with complete evaluation determines the best method in the principle of the consistency of metrics and the consistency of datasets. As a result of a complete evaluation, the tables of AUCVC and mSCC (<xref ref-type="fig" rid="F2">Figure 2</xref>) are required for the method selection.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="s1">
    <title>Materials and Methods</title>
    <sec>
      <title>Datasets</title>
      <p>In a previous study (SRA: SRP113436), 831 single-cell samples and 18 bulk samples had been sequenced using the Smart-seq2 scRNA-seq protocol. In this study, we built a scRNA-seq dataset including 663 single cells from colon tumor tissues and 10 single cells from distal tissues (&gt;10 cm) as control. The data of 166 single-cell samples were removed, as each of them contained NR less than 100,000 reads. The data of two single-cell samples were removed, as each of them contained simulated ERCC RNA less than 0 reads. We also built a bulk RNA-seq dataset including nine samples from colon tumor tissues and nine samples from distal tissues. The cleaning and quality control of both scRNA-seq and bulk RNA-seq data were performed using the pipeline Fastq_clean (<xref rid="B17" ref-type="bibr">Zhang et al., 2014</xref>) that was optimized to clean the raw reads from Illumina platforms. Using the software STAR (<xref rid="B5" ref-type="bibr">Dobin et al., 2013</xref>) v2.5.2b, we aligned all the cleaned scRNA-seq and bulk RNA-seq reads to the human genome GRCh38/hg38 and quantified the expression levels of 57,992 annotated genes (57,955 nuclear and 37 mitochondrial). Mitochondrial RNAs should have been, but were not discarded to test the robustness of normalization methods. Non-polyA RNAs and small RNAs (&lt;200 bp) were not discarded either, although the Smart-seq2 protocol theoretically had only captured polyA RNAs. In addition, the expression levels of 92 ERCC RNAs and the long non-coding RNA (lncRNA) MDL1 in the human mitochondrial genome (<xref rid="B8" ref-type="bibr">Gao et al., 2017</xref>) were also quantified. ERCC RNA had been spiked into 208 single-cell samples before library construction; the expression levels of 92 ERCC RNAs in other 455 single-cell samples and 18 bulk samples were simulated by linear regression. Finally, the two datasets were named scRNA663 (58085 × 663) and bkRNA18 (58085 × 18), and used as raw gene expression data in this study. As these two datasets were obtained by sequencing the libraries using the same protocol and samples from the same group of patients, they had great values to be used to evaluate normalization methods and assess the consistency of datasets. Researchers can select the best method for the normalization of their gene expression data or evaluate different methods using the data of 57,955 nuclear genes.</p>
    </sec>
    <sec>
      <title>Normalization Methods</title>
      <p>The library size methods (TN, TC, CR, and NR) use the gene expression level summed over total genes in a sample as the library size to calculate the normalization factor. HG7, ERCC and TU use the gene expression level summed over these pre-selected genes in a sample as the pseudo library size (see section “Results”). NR only counts reads which can be aligned to nuclear genomes, while CR counts reads which can be aligned to both nuclear and mitochondrial genomes. TC counts reads which can be aligned to 92 ERCC RNAs, nuclear and mitochondrial genomes (TC = CR + ERCC). TN uses the number of all reads which can be aligned to 92 ERCC RNAs, nuclear and mitochondrial genomes. The pre-selected genes used by HG7, ERCC and TU are seven housekeeping genes, 92 ERCC RNAs and the ubiquitous genes (described below), respectively. Seven genes (UBC, HMBS, TBP, GAPDH, HPRT1, RPL13A, and ACTB) in HG7 had been used to achieve the best evaluation result among those using all possible combinations of tested housekeeping genes in the previous study by <xref rid="B10" ref-type="bibr">Glusman et al. (2013)</xref>. ERCC RNA is a set of commonly used spike-in RNA consisting of 92 polyadenylated transcripts with short 3′ polyA tails but without 5′ caps (<xref rid="B11" ref-type="bibr">Jiang et al., 2011</xref>). A single housekeeping gene GAPDH was used for comparison in the evaluation of normalization methods using bulk RNA-seq data, but it was not applicable to scRNA-seq data due to zero counts of GAPDH present in many samples. The raw gene expression data (None) was also used to produce AUCVCs and mSCCs for comparison.</p>
    </sec>
    <sec>
      <title>Uniform Genes and Ubiquitous Genes</title>
      <p>A gene is defined as uniform when the Coefficient of Variation (CV, Formula 1) of its expression values across all samples is not more than a cutoff (<xref rid="B10" ref-type="bibr">Glusman et al., 2013</xref>). To determine the number of uniform genes using scRNA-seq data containing a high frequency of zeros, NormExpression only considers genes with non-zero ratios not less than a cutoff. The non-zero ratio of one gene should be calculated as the number of its all non-zero expression values divided by the number of total samples.</p>
      <p>Ubiquitous genes are defined as the intersection of a trimmed sets of all samples (<xref rid="B10" ref-type="bibr">Glusman et al., 2013</xref>). This trimmed set of genes are selected for each sample by (1) excluding genes with zero values, (2) sorting the non-zero genes by their expression levels in that sample, and (3) removing the upper and lower ends of the sample-specific expression distribution. <xref rid="B10" ref-type="bibr">Glusman et al. (2013)</xref> determined the optimal parameters by testing all possible combinations of lower and upper cutoffs at interval of 5% to maximize the number of resulting uniform genes using one bulk RNA-seq dataset. The size of a scRNA-seq dataset is usually very large, which could result in a very small or even empty set of ubiquitous genes, as the number of ubiquitous genes depends on the sizes of datasets. To identify the ubiquitous genes using scRNA-seq data, we defined a parameter named occurrence rate, governing the minimal fraction of trimmed sets in which a gene must appear to be considered ubiquitous. In NormExpression, TU includes three parts. The first part determines the optimal parameters by testing all possible combinations of occurrence rate, lower and upper cutoffs to maximize AUCVC (described below) instead of the number of resulting uniform genes. The second part uses the optimal occurrence rate, upper and lower cutoffs to obtain the ubiquitous genes. The third part uses the ubiquitous genes to calculate the TU normalization factor. NormExpression only use the raw gene expression data to obtain the ubiquitous genes, which are used to calculate the TU normalization factor and to evaluate all methods. In addition, the same ubiquitous genes are used by NCS and ES to obtain the NCS and ES normalization factors, respectively. These ubiquitous genes are also used by TU, NCS and ES to produce their mSCCs for method evaluation.</p>
    </sec>
    <sec>
      <title>AUCVC and mSCC</title>
      <p>In the previous study, <xref rid="B10" ref-type="bibr">Glusman et al. (2013)</xref> designed two novel and mutually independent metrics, which were the number of uniform genes and Spearman’s rank Correlation Coefficients (SCCs) between expression profiles of gene pairs. The basic theory underlying these two evaluation metrics is that a successful normalization method simultaneously maximizes the number of uniform genes and minimizes the correlation between the expression profiles of gene pairs. In this study, we designed a new metric AUCVC instead of the number of uniform genes and used the median of Spearman’s rank Correlation Coefficients between the normalized expression profiles of ubiquitous gene pairs (mSCC) instead of observation of SCC distributions for method evaluation. On default settings, NormExpression randomly selected 1,000,000 ubiquitous gene pairs to calculate the mSCCs for method evaluation (<xref ref-type="fig" rid="F3">Figure 3C,D</xref>).</p>
      <p>AUCVC (<xref ref-type="fig" rid="F3">Figure 3A,B</xref>) is created by plotting the number of uniform genes (y-axis) at each normalized CV (Formula 2) cutoff (<italic>x</italic>-axis). As a high or a low normalized CV cutoff produces more false or less true uniform genes, it is reasonable to consider the overall performance of each method at various cutoff settings instead of that at one specific cutoff setting. In Formula 1 and 2, symbols have the same meanings as those in <xref ref-type="fig" rid="F1">Figure 1</xref> and n<sup>∗</sup> does not count zero elements in each sample.</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="italic">CV</mml:mi>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>x</mml:mi>
                                  <mml:mrow>
                                    <mml:mi mathvariant="italic">ij</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:msub>
                                  <mml:mover accent="true">
                                    <mml:mi>x</mml:mi>
                                    <mml:mo>¯</mml:mo>
                                  </mml:mover>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:msqrt>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>/</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>x</mml:mi>
                    <mml:mo>¯</mml:mo>
                  </mml:mover>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:mtext> </mml:mtext>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>x</mml:mi>
                    <mml:mo>¯</mml:mo>
                  </mml:mover>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mi>n</mml:mi>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi mathvariant="italic">ij</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2">
          <mml:mrow>
            <mml:mtable columnalign="left">
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="italic">Normalized CV</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>{</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">CV</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">min</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:munder>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">CV</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mo>}</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>/</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>{</mml:mo>
                          <mml:mrow>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">max</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:munder>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">CV</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>−</mml:mo>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">min</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:munder>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">CV</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mo>}</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="italic">CV</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msqrt>
                              <mml:mrow>
                                <mml:mfrac>
                                  <mml:mn>1</mml:mn>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                    <mml:mo>*</mml:mo>
                                    <mml:mo>−</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:mfrac>
                                <mml:mstyle displaystyle="true">
                                  <mml:msubsup>
                                    <mml:mo>∑</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo>=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                      <mml:mo>*</mml:mo>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:mrow>
                                    <mml:msup>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi mathvariant="italic">log</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:msub>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:msub>
                                          <mml:mi>x</mml:mi>
                                          <mml:mrow>
                                            <mml:mi mathvariant="italic">ij</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                        <mml:mo stretchy="false">)</mml:mo>
                                        <mml:mo>−</mml:mo>
                                        <mml:msub>
                                          <mml:mover accent="true">
                                            <mml:mi>x</mml:mi>
                                            <mml:mo>¯</mml:mo>
                                          </mml:mover>
                                          <mml:mi>i</mml:mi>
                                        </mml:msub>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:msup>
                                  </mml:mrow>
                                </mml:mstyle>
                              </mml:mrow>
                            </mml:msqrt>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>/</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>x</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:mtext> </mml:mtext>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>x</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mo>*</mml:mo>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mstyle displaystyle="true">
                          <mml:msubsup>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                              <mml:mo>*</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">log</mml:mi>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>x</mml:mi>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">ij</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mstyle>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mspace width="2.5em"/>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi mathvariant="italic">ij</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>&gt;</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
  </sec>
  <sec>
    <title>Author Contributions</title>
    <p>SG conceived this project. SG and JR supervised this project. ZW, WL, and XJ performed the programming. ZW and HJ analyzed the data. HW prepared all the figures and <xref ref-type="supplementary-material" rid="SM1">Supplementary Files</xref>. SG drafted the main manuscript. GG, MR, and LL revised the manuscript. All authors read and approved the manuscript.</p>
  </sec>
  <sec>
    <title>Conflict of Interest Statement</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was supported by grants from National Key Research and Development Program of China (2016YFC0502304-03) to Defu Chen, National Natural Science Foundation of China (11701296) to Jianzhao Gao, and Internationalization of Outstanding Postdoctoral Training Program from Tianjin Government to SG.</p>
    </fn>
  </fn-group>
  <ack>
    <p>We thank Professor Sui Huang and Dr. Joseph Zhou from Institute for Systems Biology (ISB) their hosts on SG’ visiting to ISB. This manuscript has been released as a preprint (<xref rid="B16" ref-type="bibr">Wu et al., 2018</xref>).</p>
  </ack>
  <sec sec-type="supplementary material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fgene.2019.00400/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fgene.2019.00400/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <label>FILE S1</label>
      <caption>
        <p>How to use NormExpression.</p>
      </caption>
      <media xlink:href="Data_Sheet_1.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM2">
      <label>FILE S2</label>
      <caption>
        <p>Perl scripts to run NCS and ES.</p>
      </caption>
      <media xlink:href="Data_Sheet_2.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>). <article-title>Differential expression analysis for sequence count data.</article-title>
<source><italic>Genome Biol.</italic></source>
<volume>11</volume>:<issue>R106</issue>. <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
<?supplied-pmid 20979621?><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bacher</surname><given-names>R.</given-names></name><name><surname>Chu</surname><given-names>L.</given-names></name><name><surname>Leng</surname><given-names>N.</given-names></name><name><surname>Gasch</surname><given-names>A. P.</given-names></name><name><surname>Thomson</surname><given-names>J. A.</given-names></name><name><surname>Stewart</surname><given-names>R. M.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>SCnorm: robust normalization of single-cell RNA-seq data.</article-title>
<source><italic>Nat. Methods</italic></source>
<volume>14</volume>:<issue>584</issue>. <pub-id pub-id-type="doi">10.1038/nmeth.4263</pub-id>
<?supplied-pmid 28418000?><pub-id pub-id-type="pmid">28418000</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>J. H.</given-names></name><name><surname>Purdom</surname><given-names>E.</given-names></name><name><surname>Hansen</surname><given-names>K. D.</given-names></name><name><surname>Dudoit</surname><given-names>S.</given-names></name></person-group> (<year>2010</year>). <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments.</article-title>
<source><italic>BMC Bioinformatics</italic></source>
<volume>11</volume>:<issue>94</issue>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id>
<?supplied-pmid 20167110?><pub-id pub-id-type="pmid">20167110</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>M. B.</given-names></name><name><surname>Risso</surname><given-names>D.</given-names></name><name><surname>Wagner</surname><given-names>A.</given-names></name><name><surname>DeTomaso</surname><given-names>D.</given-names></name><name><surname>Ngai</surname><given-names>J.</given-names></name><name><surname>Purdom</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Performance assessment and selection of normalization procedures for single-cell RNA-seq.</article-title>
<source><italic>bioRxiv</italic></source> [Preprint]. <pub-id pub-id-type="doi">10.1101/235382</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A.</given-names></name><name><surname>Davis</surname><given-names>C. A.</given-names></name><name><surname>Schlesinger</surname><given-names>F.</given-names></name><name><surname>Drenkow</surname><given-names>J.</given-names></name><name><surname>Zaleski</surname><given-names>C.</given-names></name><name><surname>Jha</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>STAR: ultrafast universal RNA-seq aligner.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>29</volume>
<fpage>15</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
<?supplied-pmid 23104886?><pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>S.</given-names></name></person-group> (<year>2018</year>). <article-title>Data analysis in single-cell transcriptome sequencing.</article-title>
<source><italic>Methods Mol. Biol.</italic></source>
<volume>1754</volume>:<issue>18</issue>.</mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>S.</given-names></name><name><surname>Ou</surname><given-names>J.</given-names></name><name><surname>Xiao</surname><given-names>K. R.</given-names></name></person-group> (<year>2014</year>). <source><italic>language and Bioconductor in Bioinformatics Applications(Chinese Edition)</italic>.</source>
<publisher-loc>Tianjin</publisher-loc>: <publisher-name>Tianjin Science and Technology Translation Publishing Ltd.</publisher-name></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>S.</given-names></name><name><surname>Tian</surname><given-names>X.</given-names></name><name><surname>Chang</surname><given-names>H.</given-names></name><name><surname>Sun</surname><given-names>Y.</given-names></name><name><surname>Wu</surname><given-names>Z.</given-names></name><name><surname>Cheng</surname><given-names>Z.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Two novel lncRNAs discovered in human mitochondrial DNA using PacBio full-length transcriptome data.</article-title>
<source><italic>Mitochondrion</italic></source>
<volume>38</volume>
<fpage>41</fpage>–<lpage>47</lpage>. <pub-id pub-id-type="doi">10.1016/j.mito.2017.08.002</pub-id>
<?supplied-pmid 28802668?><pub-id pub-id-type="pmid">28802668</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>S.</given-names></name><name><surname>Zhang</surname><given-names>N.</given-names></name><name><surname>Duan</surname><given-names>G. Y.</given-names></name><name><surname>Yang</surname><given-names>Z.</given-names></name><name><surname>Ruan</surname><given-names>J. S.</given-names></name><name><surname>Zhang</surname><given-names>T.</given-names></name></person-group> (<year>2009</year>). <article-title>Prediction of function changes associated with single-point protein mutations using support vector machines (SVMs).</article-title>
<source><italic>Hum. Mutat.</italic></source>
<volume>30</volume>
<fpage>1161</fpage>–<lpage>1166</lpage>. <pub-id pub-id-type="doi">10.1002/humu.21039</pub-id>
<?supplied-pmid 19462464?><pub-id pub-id-type="pmid">19462464</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glusman</surname><given-names>G.</given-names></name><name><surname>Caballero</surname><given-names>J.</given-names></name><name><surname>Robinson</surname><given-names>M.</given-names></name><name><surname>Kutlu</surname><given-names>B.</given-names></name><name><surname>Hood</surname><given-names>L.</given-names></name></person-group> (<year>2013</year>). <article-title>Optimal scaling of digital transcriptomes.</article-title>
<source><italic>PLoS One</italic></source>
<volume>8</volume>:<issue>e77885</issue>. <pub-id pub-id-type="doi">10.1371/journal.pone.0077885</pub-id>
<?supplied-pmid 24223126?><pub-id pub-id-type="pmid">24223126</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>L.</given-names></name><name><surname>Schlesinger</surname><given-names>F.</given-names></name><name><surname>Davis</surname><given-names>C. A.</given-names></name><name><surname>Zhang</surname><given-names>Y.</given-names></name><name><surname>Li</surname><given-names>R.</given-names></name><name><surname>Salit</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Synthetic spike-in standards for RNA-seq experiments.</article-title>
<source><italic>Genome Res.</italic></source>
<volume>21</volume>:<issue>1543</issue>. <pub-id pub-id-type="doi">10.1101/gr.121095.111</pub-id>
<?supplied-pmid 21816910?><pub-id pub-id-type="pmid">21816910</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>P.</given-names></name><name><surname>Piao</surname><given-names>Y.</given-names></name><name><surname>Shon</surname><given-names>H. S.</given-names></name><name><surname>Ryu</surname><given-names>K. H.</given-names></name></person-group> (<year>2015</year>). <article-title>Comparing the normalization methods for the differential analysis of Illumina high-throughput RNA-Seq data.</article-title>
<source><italic>BMC Bioinformatics</italic></source>
<volume>16</volume>:<issue>347</issue>. <pub-id pub-id-type="doi">10.1186/s12859-015-0778-7</pub-id>
<?supplied-pmid 26511205?><pub-id pub-id-type="pmid">26511205</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lovén</surname><given-names>J.</given-names></name><name><surname>Orlando</surname><given-names>D. A.</given-names></name><name><surname>Sigova</surname><given-names>A. A.</given-names></name><name><surname>Lin</surname><given-names>C. Y.</given-names></name><name><surname>Rahl</surname><given-names>P. B.</given-names></name><name><surname>Burge</surname><given-names>C. B.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Revisiting global gene expression analysis.</article-title>
<source><italic>Cell</italic></source>
<volume>151</volume>
<fpage>476</fpage>–<lpage>482</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2012.10.012</pub-id>
<?supplied-pmid 23101621?><pub-id pub-id-type="pmid">23101621</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>A. T.</given-names></name><name><surname>Karsten</surname><given-names>B.</given-names></name><name><surname>Marioni</surname><given-names>J. C.</given-names></name></person-group> (<year>2016</year>). <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts.</article-title>
<source><italic>Genome Biol.</italic></source>
<volume>17</volume>:<issue>75</issue>. <pub-id pub-id-type="doi">10.1186/s13059-016-0947-7</pub-id>
<?supplied-pmid 27122128?><pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M. D.</given-names></name><name><surname>McCarthy</surname><given-names>D. J.</given-names></name><name><surname>Smyth</surname><given-names>G. K.</given-names></name></person-group> (<year>2010</year>). <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>26</volume>
<fpage>139</fpage>–<lpage>140</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
<?supplied-pmid 19910308?><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Z.</given-names></name><name><surname>Liu</surname><given-names>W.</given-names></name><name><surname>Jin</surname><given-names>X.</given-names></name><name><surname>Yu</surname><given-names>D.</given-names></name><name><surname>Wang</surname><given-names>H.</given-names></name><name><surname>Glusman</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>NormExpression: an R package to normalize gene expression data using evaluated methods.</article-title>
<source><italic>bioRxiv</italic></source> [Preprint]. <pub-id pub-id-type="doi">10.1101/251140</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>M.</given-names></name><name><surname>Zhan</surname><given-names>F.</given-names></name><name><surname>Sun</surname><given-names>H.</given-names></name><name><surname>Gong</surname><given-names>X.</given-names></name><name><surname>Fei</surname><given-names>Z.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>“Fastq_clean: an optimized pipeline to clean the Illumina sequencing data with quality control,” in</article-title>
<source><italic>Proceedings of the IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</italic></source>, (<publisher-loc>Piscataway, NJ</publisher-loc>: <publisher-name>IEEE</publisher-name>).</mixed-citation>
    </ref>
  </ref-list>
</back>
