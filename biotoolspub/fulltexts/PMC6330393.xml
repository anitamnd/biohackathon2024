<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6330393</article-id>
    <article-id pub-id-type="pmid">30634901</article-id>
    <article-id pub-id-type="publisher-id">2600</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2600-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Manhattan Harvester and Cropper: a system for GWAS peak detection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5069-6523</contrib-id>
        <name>
          <surname>Haller</surname>
          <given-names>Toomas</given-names>
        </name>
        <address>
          <phone>+372-737-4000</phone>
          <email>Toomas.Haller@ut.ee</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tasa</surname>
          <given-names>Tõnis</given-names>
        </name>
        <address>
          <email>Tonis.Tasa@ut.ee</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Metspalu</surname>
          <given-names>Andres</given-names>
        </name>
        <address>
          <email>Andres.Metspalu@ut.ee</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 7661</institution-id><institution-id institution-id-type="GRID">grid.10939.32</institution-id><institution>Estonian Genome Center, Institute of Genomics, </institution><institution>University of Tartu, </institution></institution-wrap>23b Riia Street, 51010 Tartu, Estonia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 7661</institution-id><institution-id institution-id-type="GRID">grid.10939.32</institution-id><institution>Institute of Computer Science, </institution><institution>University of Tartu, </institution></institution-wrap>Juhan Liivi 2, 50409 Tartu, Estonia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>22</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>1</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Selection of interesting regions from genome wide association studies (GWAS) is typically performed by eyeballing of Manhattan Plots. This is no longer possible with thousands of different phenotypes. There is a need for tools that can automatically detect genomic regions that correspond to what the experienced researcher perceives as peaks worthwhile of further study.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed Manhattan Harvester, a tool designed for “peak extraction” from GWAS summary files and computation of parameters characterizing various aspects of individual peaks. We present the algorithms used and a model for creating a general quality score that evaluates peaks similarly to that of a human researcher. Our tool Cropper utilizes a graphical interface for inspecting, cropping and subsetting Manhattan Plot regions. Cropper is used to validate and visualize the regions detected by Manhattan Harvester.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We conclude that our tools fill the current void in automatically screening large number of GWAS output files in batch mode. The interesting regions are detected and quantified by various parameters by Manhattan Harvester. Cropper offers graphical tools for in-depth inspection of the regions. The tools are open source and freely available.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2600-4) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>GWAS</kwd>
      <kwd>Manhattan plots</kwd>
      <kwd>Peak detection</kwd>
      <kwd>Peak quality score</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EU H2020 grant ePerMed </institution>
        </funding-source>
        <award-id>692145</award-id>
        <principal-award-recipient>
          <name>
            <surname>Metspalu</surname>
            <given-names>Andres</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EU H2020 grant </institution>
        </funding-source>
        <award-id>633589</award-id>
        <principal-award-recipient>
          <name>
            <surname>Metspalu</surname>
            <given-names>Andres</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Estonian Government</institution>
        </funding-source>
        <award-id>IUT20-60</award-id>
        <principal-award-recipient>
          <name>
            <surname>Metspalu</surname>
            <given-names>Andres</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Estonian Center of Genomics/Roadmap II </institution>
        </funding-source>
        <award-id>2014-2020.4.01.16-0125</award-id>
        <principal-award-recipient>
          <name>
            <surname>Metspalu</surname>
            <given-names>Andres</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Regional Development Fund </institution>
        </funding-source>
        <award-id>2014-2020.4.01.15-0012</award-id>
        <principal-award-recipient>
          <name>
            <surname>Metspalu</surname>
            <given-names>Andres</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>US National Institute of Health</institution>
        </funding-source>
        <award-id>R01DK075787</award-id>
        <principal-award-recipient>
          <name>
            <surname>Metspalu</surname>
            <given-names>Andres</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par16">For over a decade the genome-wide association studies (GWAS) have been a powerful tool in the arsenal used for unraveling the information present in the genome [<xref ref-type="bibr" rid="CR1">1</xref>]. Despite certain skepticism this approach is not showing signs of fatigue. Quite to the contrary, the number of GWAS carried out is increasing, returning useful information for understanding the genome and predicting and helping to cure disease [<xref ref-type="bibr" rid="CR2">2</xref>]. All this paves the road for personalized medicine – bound to become the backbone of the medicine in the future. With the increasing number of genotyped and sequenced individuals as well as advances in high performance computing the GWAS projects undertaken have grown in size and technological complexity [<xref ref-type="bibr" rid="CR3">3</xref>]. There are reports out that have boosted the number of individual phenotypes in some cases to tens of thousands or more [<xref ref-type="bibr" rid="CR4">4</xref>]. It is not rare to combinatorially generate even more phenotypes (e.g. metabolite ratio phenotypes) and analyze in one go [<xref ref-type="bibr" rid="CR5">5</xref>]. These results can no longer be individually evaluated by a researcher. Automatic screening of results is much needed for a quick summary of the findings and to rank them in the order of significance. Yet well documented specific tools for this purpose are still missing to the best of our knowledge. We present Manhattan Harvester (MH) that uses the GWAS output files and detects the signals (peaks) of potential interest from them by mimicking the eye of a researcher. The software computes a list of parameters for each peak and a quality score based on these. MH is supplemented by another original tool – Cropper. Cropper is a visual aid for viewing, zooming, cropping and subsetting GWAS results. It can be used in combination with MH when studying the findings of MH.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Scripting and properties</title>
      <p id="Par17">Both MH and Cropper are written in C++/Qt [<xref ref-type="bibr" rid="CR6">6</xref>]. They are open source and can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.geenivaramu.ee/en/tools">www.geenivaramu.ee/en/tools</ext-link>. It is possible to compile them for all major computational platforms. Both tools are fully documented and accompanied by instructions and examples.</p>
    </sec>
    <sec id="Sec4">
      <title>Manhattan harvester (MH)</title>
      <p id="Par18">MH is a command line tool working on GWAS output files. It is able to analyze all chromosomes together or one at a time and can operate in single file or batch mode. MH provides the user with a table containing all physical position regions (peaks) detected in the GWAS output, the peak parameters and their general quality scores (see below). It utilizes original and efficient algorithms to handle the GWAS files. MH starts by reading rows with valid position numbers and <italic>p</italic>-values under a certain threshold (p-value&lt; 0.001 as the default). Two copies of the data sets are handled in parallel – one remains unchanged (Reference Branch), the other one (Test Branch) is modified by various functions required for signal detection. Later the information from the two branches is merged to get the final annotations (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The modifications performed in the test branch standardize the input so that the peaks (nearby data points representing local regions of low <italic>p</italic>-values) can be separated from the background noise. The test branch data undergo the following modifications:<list list-type="alpha-lower"><list-item><p id="Par19">Signal smoothing. The data are smoothed using a sliding window. Linear regression is performed sequentially for each data point by making use of 5 data points (2 before and 2 after). The middle data point is replaced with its prediction from linear regression (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, a-b).</p></list-item><list-item><p id="Par20">Height-based compression. The spaces between data points are compressed based on the average -log(<italic>p</italic>-value) of their flanking data points multiplied by a constant (default value = 2). This step ensures that the points with small <italic>p</italic>-values (and hence more likely to belong to the peaks) are compressed closer to one another than the points corresponding to the intermediate space between the peaks (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, c). As an example to illustrate this step: points A (-logP<sub>A</sub> = 4) and B (-logP<sub>B</sub> = 10) that are originally 1000 bp apart become 100 bp apart (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \raisebox{1ex}{$1000\  bp$}\!\left/ \!\raisebox{-1ex}{$\left(2\ast \left(4+6\right)/2\right)$}\right. $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mfrac bevelled="true"><mml:mrow><mml:mn>1000</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="italic">bp</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_2600_Article_IEq1.gif"/></alternatives></inline-formula>).</p></list-item><list-item><p id="Par21">Local-range re-distribution. From this step forward the <italic>p</italic>-values of the points are ignored as the algorithm continues only with a one dimensional projection of the compressed (see step b) physical position values. In this step all points are evenly distributed between their neighboring data points. This is done in two stages so that each point is slid along the position axis relative to two secure anchor points. This means that every other point is relocated using its neighbors as anchors, then the anchors themselves are relocated using their own flanking points as anchors. For example consider sequential points 1, 2, 3, 4, 5 that have variable distances between them. In the first stage point 2 is set to equal distance from 1 and 3 and point 4 is set to equal distance from 3 and 5. In the second stage point 3 is set to equal distance from 2 and 3. This re-distribution ensures that the distances between points are more evenly distributed - a prerequisite for the next step. The points in the regions falling between the peaks relocate much more than those in the peak regions because the latter are locked tight between their neighbors and they have less space to relocate (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, d). The order of points is never altered. As a result the difference between the largest gap found inside the peaks and the smallest gap found in the inter-peak region is widened; essentially the peak points become more distinguishable from the background. This is relevant because the peak regions are now differentiated from the inter-peak regions only by the data point density in the one-dimensional array.</p></list-item><list-item><p id="Par22">Vector fragmentation. We modified the framework of univariate clustering [<xref ref-type="bibr" rid="CR7">7</xref>] for our specific needs. Our vector fragmentation procedure is searching for the optimal clusters within the physical position values space of the chromosome. It is a carried out on the standardized input (step c) and the outcome is the genome regions that constitute Manhattan Plot peaks. These regions are separated from the flanking regions by sequential fragmentation of the position values array. The chunks are created by iteratively breaking the vector where the distances between the points are the largest, gradually moving to the smallest. Always the chunk with more data points is carried over to the next round of fragmentation (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). During such fragmentation there is a termination point that optimally corresponds to the peak with the densest point distribution. To pinpoint the best stopping point the mean inter-point gap size (<italic>meanG</italic>) and the maximal inter-point gap size (<italic>maxG</italic>) are recorded for each fragmentation step. Two parameters are computed for each chunk: a) <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ stop{1}_i=\frac{\mathit{\max}{G}_i}{mean{G}_i} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mtext mathvariant="italic">stop</mml:mtext><mml:msub><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo mathvariant="italic">max</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">mean</mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_2600_Article_IEq2.gif"/></alternatives></inline-formula>, b) <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ stop{2}_i=\frac{\mathit{\max}{G}_i}{\mathit{\max}{G}_{i+1}} $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:mtext mathvariant="italic">stop</mml:mtext><mml:msub><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo mathvariant="italic">max</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo mathvariant="italic">max</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_2600_Article_IEq3.gif"/></alternatives></inline-formula>, where <italic>i</italic> is the fragmentation step index. The optimal chunk was found to correspond to the index <italic>i</italic> of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \underset{\mathrm{i}\in \mathrm{n}}{\max } stop{1}_i $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:munder><mml:mo>max</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="italic">stop</mml:mtext><mml:msub><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2600_Article_IEq4.gif"/></alternatives></inline-formula>, or else <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \underset{\mathrm{i}\in \mathrm{n}}{\max } stop{2}_i $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:munder><mml:mo>max</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="italic">stop</mml:mtext><mml:msub><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2600_Article_IEq5.gif"/></alternatives></inline-formula> if <italic>stop</italic>1<sub><italic>i</italic></sub> − <italic>stop</italic>2<sub><italic>i</italic></sub> &gt; 2. This empirical solution to choose the best fragmentation stopping point eliminated the need for more complicated decision making structures and proved fully adequate for analyzing real data. Larger stop1 and stop2 values generally correspond to the inter-peak regions whereas small values are indicative of fragmentation cuts in the middle of the peaks. Hence the borders where these values turn from large to small align with the peak borders. In addition to this detection system MH also applies several “sanity check” filters such as the maximal height to width ratio, chunk size etc. to narrow down the options space for the stop1/stop2 fragmentation termination system. The last filter in the algorithm is a function that tests the left and right <italic>p</italic>-values of the newly detected peak candidates to decide whether the next smallest chunk size has more fitting left and right peak termini in terms of p-value (as decided relative to the smallest peak height and baseline p-values); in which case the next smallest chunk is selected instead. MH comes optimized with regard to the analytical parameters as the default values. However, all key parameters can be changed by the user via command line flags as the need arises (see MH manual).</p></list-item><list-item><p id="Par23">Peak characterization and re-looping. Once the peak borders are identified the peak is characterized by a number of parameters. This includes for example General Quality Score (GQS, see below), maximal slope, height to width ratio and more (see Table <xref rid="Tab1" ref-type="table">1</xref> of Additional file <xref rid="MOESM1" ref-type="media">1</xref>). These parameters can be used to let the user filter and prioritize the findings. After this step the data points corresponding to the peak are removed from the data and the algorithm loops back to step d for the next round of vector fragmentation and the identification of the peak with the second highest point density (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The cycle between vector fragmentation, characterization of the created fragments and removal of the characterized fragments continues until data points are depleted.</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of MH</p></caption><graphic xlink:href="12859_2019_2600_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>The key steps of data processing in the Test Branch of MH. <bold>a</bold>: original (raw) data, <bold>b</bold>: smoothing, <bold>c</bold>: height-based compression, <bold>d</bold>: local range re-distribution. The Y axis is -log(<italic>p</italic>-value), the X axis is physical position. The absolute position values can be different between different panels of the graph, they were scaled based on the first and last data point position</p></caption><graphic xlink:href="12859_2019_2600_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>The order of chunk creation during vector fragmentation by MH. The numbers indicate the order of gaps by size. The first fragmentation round (1) yields 8 points, (2) yields 6 points, (3) is not executed because the corresponding area was lost after step (1), and (4) yields 5 points – the densest area of the plot</p></caption><graphic xlink:href="12859_2019_2600_Fig3_HTML" id="MO3"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Execution speed of MH with various input file sizes, number of detected peaks and computational systems</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Min p-val</th><th>Peaks</th><th>File size (MB)</th><th>Data points (rows)</th><th>PC, sec (mean ± stdev)</th><th>HPC, sec (mean ± stdev)</th></tr></thead><tbody><tr><td>0.01</td><td>1</td><td>0.257</td><td>8507</td><td>0.037 ± 0.0018</td><td>0.037 ± 0.0045</td></tr><tr><td>0.01</td><td>3</td><td>0.348</td><td>11,781</td><td>0.052 ± 0.0049</td><td>0.056 ± 0.011</td></tr><tr><td>0.01</td><td>5</td><td>0.215</td><td>7116</td><td>0.031 ± 0.0018</td><td>0.033 ± 0.0033</td></tr><tr><td>&lt; 1</td><td>6</td><td>85</td><td>560,646</td><td>NA</td><td>3.07 ± 0.0758</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Cropper</title>
      <p id="Par24">Cropper is a GUI tool using standard data visualization logic and patterns. It is specifically designed for handling Manhattan Plots. Cropper was developed in synchronization with the demands that originated during MH production, validation and usage. The user can zoom, crop and output parts of Manhattan Plot in both graphical and numerical format. Cropper also allows to sequentially remove peaks from Manhattan plot so that the user can continue work with the leftover data set after cropping out peaks. Cropper offers two views: a) global view showing all chromosomes, b) local view showing the selected chromosome (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Chromosomes are chosen from the global view while all the selections and manipulations are done in the local view by using the mouse (see Fig. <xref rid="Fig1" ref-type="fig">1</xref> in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). It is easy to visualize the regions picked out by MH by copying their ranges directly from the MH output file to the range data field of Cropper.<fig id="Fig4"><label>Fig. 4</label><caption><p>A summary of how Cropper works. The two views (global and local) make different control options available to the user</p></caption><graphic xlink:href="12859_2019_2600_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results</title>
    <sec id="Sec7">
      <title>Data</title>
      <p id="Par25">In this work we used the NMR metabolite GWAS meta-analysis data set from the MAGNETIC consortium which is freely available [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. The files had a GWAMA format [<xref ref-type="bibr" rid="CR10">10</xref>]. The data files were randomly divided into two non-overlapping subsets: method development set (MDS) and the method validation set (MVS).</p>
    </sec>
    <sec id="Sec8">
      <title>General quality score (GQS)</title>
      <p id="Par26">MH computes 16 parameters for each peak. Each parameter describes a certain aspect of the peak region and can be used for subjective ranking (see Table <xref rid="Tab1" ref-type="table">1</xref> in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We built a model to predict the “goodness” of GWAS peak based on these values to generate a GQS for each peak. The more comprehensive GQS score was invented to provide a more global quality assignment for each peak that could be used as the main parameter for peak assessment. The peak quality score model was created using the quality scores assigned by the volunteer knowledgeable human evaluators (KHEs, the scientists from the Institute of Genomics, University of Tartu, knowledgeable in GWAS) as dependent variables. We collected the benchmark data set by asking 20 KHEs to evaluate 277 Manhattan Plot peaks (extracted with Cropper from the MDS) on a 5 point scale. These peaks were shown to the KHEs together with flanking areas (1/3 before and 1/3 after the peak region). Each KHE could also see the maximal –log(<italic>p</italic>-value) for the top of the peak and the width of the peak at p-value = 0.01. The evaluation marks generally agreed well between the KHEs as witnessed by the grading correlation structure (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The correlation structure within the set of parameters used for modeling was investigated (see Fig. <xref rid="Fig2" ref-type="fig">2</xref> in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Many parameters showed either a strong positive or negative correlation with the marks given by the KHEs and in most cases the variation was low (see Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Fig. <xref rid="Fig4" ref-type="fig">4</xref> in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>A heat-map with hierarchical clustering showing the Manhattan Plot peak assignment groupings between KHEs</p></caption><graphic xlink:href="12859_2019_2600_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par27">We used the KHE-generated peak scores together with the16 parameters generated by MH as attributes to model the outcome grade variables with a mixed-effects proportional odds model [<xref ref-type="bibr" rid="CR11">11</xref>]. The attribute “peak repetition” was transformed by taking the square-root, the attributes “skewness” and “peak balance” were raised to the power of 0.25 and all other attributes except “Kolmogorov normality test” were log-transformed (see Table <xref rid="Tab1" ref-type="table">1</xref> in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). All variables were additionally mean scaled and standardized. The model used was a mixed-effects proportional odds model with a cumulative link that assumes an ordinal response of the peak scores. These scores are assumed to be subject to expert specific effects. We used a step-wise model development approach starting from the null model that minimized the average mean square error (<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 1/\mathrm{n}{\sum}_{i=1}^n{\left(\underset{i}{\Pr }-T{r}_i\right)}^2 $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo>Pr</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2600_Article_IEq6.gif"/></alternatives></inline-formula> where <italic>Pr</italic><sub><italic>i</italic></sub> is the <italic>predicted grade</italic> of the i<sub>th</sub> graded peak, <italic>Tr</italic><sub><italic>i</italic></sub> is <italic>true grade</italic> given to a peak and n is the number of graded instances of the predictions using five-fold out-of-sample cross validation. The initial dataset was split five-fold and the model was trained five times using 4 of the 5 folds and using the fold left-out fold as test data. We used R (version 3.3.3) package ordinal (version 2018.4–19) for model development [<xref ref-type="bibr" rid="CR12">12</xref>]. Of all parameters “log max <italic>p</italic>-value” and “bestslope” were incorporated into the final model. This was the optimal solution that resulted in minimum 5-fold cross validation MSE of 0.92. The final model parameters were obtained from refitting the final model on all data. This resulted in Pearson correlation coefficient of <italic>r</italic> = 0.88 between the expected value of predicted scores (E (score)=<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \sum \limits_{i=1}^5P\left( score=i\right)\ast i $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mtext mathvariant="italic">score</mml:mtext><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>∗</mml:mo><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2600_Article_IEq7.gif"/></alternatives></inline-formula>) and the mean estimate from 20 KHE GQSs (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The R code used for modeling is presented in Additional file <xref rid="MOESM2" ref-type="media">2</xref>. The model was implemented in MH.<fig id="Fig6"><label>Fig. 6</label><caption><p>Validation of the statistical model to estimate GQS – expected scores (based on KHE marks) vs. observed (computed by MH)</p></caption><graphic xlink:href="12859_2019_2600_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Manhattan harvester peak detection accuracy</title>
      <p id="Par28">It is important to evaluate the implemented algorithms of MH on test data to show how well they detect the Manhattan Plot peak regions and estimate peak quality. The adequacy of the MH algorithm can be evaluated relative to the KHE estimations. It is not preferable to use known (published) biological significance of the detected regions as a quality measure because the quality of the peak is not linked to biological significance. Instead it is the peak height, width and shape that typically mark a peak as interesting for the next steps of the study. We assessed the MH output by comparing the MH-detected regions with the opinion of a KHE using the MVS. Cropper was used by the KHE to conduct the comparison between the Manhattan Plot and the regions picked out as peaks by MH. The KHE inspected 100 randomly chosen peaks ranging from 5.1 to 81.7 on a –log(<italic>p</italic>-value) scale. Of those 97 coincided very closely with the KHE opinion, only one peak (max(−log(p-value)) = 39.1) was detected as to have a base range two times wider (extended equally to the left and right of the highest point) than marked by the KHE. Massive peaks were fragmented into 2 or 3 sub-peaks on two occasions (separating the center of the peak region from the shoulders). It was not unambiguous, however, if this solution was better or worse than reporting those peaks (3 MB wide at the height of –log(p-value) = 3) as single clumps. In no cases were the existing peaks not reported and the reported peak ranges never overlapped as judged by the KHE. A KHE also visually validated the GQS on the data used to validate the results above. The GQS values computed by MH were always within one unit of the score visually assigned by the KHE using Cropper.</p>
    </sec>
    <sec id="Sec10">
      <title>Computational speed</title>
      <p id="Par29">The computational speed of MH was measured by analyzing MDS files on two systems: a) Hewlett Packard EliteBook 2540p (PC), with 14.04.5 LTS (32 bit), 2 GHz Processor, b) High Performance Computing (HPC) cluster of the University of Tartu running CentOS Linux release 7.4 (64 bit) and 2.2 GHz processor. All measurements were carried out 5 times on a single processor using the Unix command “time”. We used minimal (filtered) file size with <italic>p</italic>-val &lt; 0.01 (&lt; 1 MB) as well as an un-modified GWAMA meta-analysis file (85 MB) (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p id="Par30">We show that an 85 MB GWAMA format file with 19 columns, 560,646 rows and 6 genomic regions detected by MH was analyzed in just over 3 s (see Fig. <xref rid="Fig5" ref-type="fig">5</xref> in Additional file <xref rid="MOESM1" ref-type="media">1</xref> for Manhattan Plot). The analysis took 0.031–0.056 s when file reading time was minimized. We did not detect association between execution speed and the number of peaks detected. Most of the computational time was spent on file reading and the overall analysis speed was sufficiently fast for practical purposes.</p>
      <p id="Par31">The execution speed of Cropper was not quantified. It was qualitatively judged by the users (KHEs) as sufficiently fast.</p>
    </sec>
    <sec id="Sec11">
      <title>Cropper evaluation</title>
      <p id="Par32">Cropper was initially created to facilitate the development process of MH. It gained a role as a tandem tool in the MH workflow – used for visual validation of MH assignments. The other graphical tools that could be adopted for viewing or cropping of Manhattan Plots were not convenient for a quick visual assessment of the findings from MH. Cropper proved uniquely valuable for quickly conducting the comparison between the peak assignments by MH and KHE for this project both in terms of ease of use and speed. The capability of Cropper to visualize regions from MH output file in one copy and paste step proved most useful. It was specifically brought out by the KHEs that Cropper had no easy-to-use alternatives for fast visualization of selected Manhattan plot regions.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par33">To this day GWAS results are typically evaluated visually one at a time. This approach works well only with a small number of files. With many files automated help is needed. Manhattan Plot peaks are difficult to model based on simple mathematical function because they reflect genomic structure and underlying biological aspects in addition to certain expected peak geometry. We tackled this issue by creating a) MH which uses GQS and other parameters to mimic the opinion of an experienced researcher when picking out genome regions with features calling for further attention, b) Cropper that accompanies MH whenever there is a need to study the detected regions up-close. We demonstrate that our tools are fully adequate both in terms of accuracy and speed.</p>
    <p id="Par34">We have developed MH so that it is certain to detect all peaks and it is up to the user to draw the line between the interesting and uninteresting. The MH algorithms can automatically scale to adapt to various peak identities. The peaks are not initially identified based on <italic>p</italic>-value but rather on a collection of peak qualities via specialized data pre-processing and vector fragmentation techniques. Data points with very low <italic>p</italic>-values are ignored if they are not found to belong to high certainty peaks. MH outperforms simple GWAS output screening based on the magnitude of p-value: the low p-value points are combined into regions and the regions, not the individual low p-values, are reported as peaks. This converts the findings into a manageable set that can be further ranked according to the user needs.</p>
    <p id="Par35">MH and Cropper are meant to integrate into the GWAS result analysis workflow. It starts with generation of GWAS summary statistics with GWAS software. All resulting files are then analyzed by MH in the batch mode. The regions of interest are ranked by filtering and sorting the MH output. Only a small number of hits are brought to the researcher’s attention. The researcher can next focus on the short list by using Cropper. The utility of Cropper was assessed by asking the UT scientists using it. The feedback was fully positive ensuring that the tool was needed.</p>
    <p id="Par36">MH is not dealing with issues of biological significance. The peaks are evaluated based solely on the visually observable characteristics. This was the goal because this is also how the scientist evaluates the peaks. The same phenotype can result in Manhattan Plots of different visual qualities depending on the number of subjects and other study characteristics.</p>
    <p id="Par37">MH is not devoid of limitations. It is not currently using the MAF or imputation quality info and thus relies on using quality pre-filtered GWAS files. Also it is not attempting to validate the peaks using non-mathematical methods such as performing database searches or comparing against known genome region associations to find gene identities. Although MH is not providing graphical output this functionality is performed by Cropper. Our future plans include updating the tools based on user feedback.</p>
  </sec>
  <sec id="Sec13">
    <title>Conclusions</title>
    <p id="Par38">We created a system for quickly detecting the interesting genomic regions from GWAS output files. To the best of our knowledge there are no other tools for helping to extend the human eye to a large number of GWAS outputs the same way as MH/Cropper. However these tools are needed. The aim of MH is to do a fast initial screening of data not manageable for the human eye. MH and Cropper together constitute a system that allows the user to qualitatively study a large number of GWAS results.</p>
    <sec id="Sec14">
      <title>Availability and requirements</title>
      <p id="Par39">Project name: Manhattan Harvester.</p>
      <p id="Par40">Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.geenivaramu.ee/en/tools">www.geenivaramu.ee/en/tools</ext-link></p>
      <p id="Par41">Operating system(s): Cross platform.</p>
      <p id="Par42">Programming language: C++/Qt.</p>
      <p id="Par43">Other requirements: Qt4.3 or higher (free from <ext-link ext-link-type="uri" xlink:href="http://www.qt.io">www.qt.io</ext-link>).</p>
      <p id="Par44">License: GNU GPL.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2600_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p>Supplementary table and figures that show the parameters computed by MH and the Cropper interface. (PDF 679 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2600_MOESM2_ESM.zip">
            <label>Additional file 2:</label>
            <caption>
              <p>R files showing the computer code used for modeling. (ZIP 2 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>GHz</term>
        <def>
          <p id="Par4">Gigahertz</p>
        </def>
      </def-item>
      <def-item>
        <term>GQS</term>
        <def>
          <p id="Par5">General Quality Score</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p id="Par6">Graphical User Interface</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par7">Genome-Wide Association Study</p>
        </def>
      </def-item>
      <def-item>
        <term>KHE(s)</term>
        <def>
          <p id="Par8">Knowledgeable Human Evaluator(s)</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p id="Par9">Minor Allele Frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>MAGNETIC</term>
        <def>
          <p id="Par10">Metabolites And GeNETIcs Consortium</p>
        </def>
      </def-item>
      <def-item>
        <term>MB</term>
        <def>
          <p id="Par11">Megabite</p>
        </def>
      </def-item>
      <def-item>
        <term>MDS</term>
        <def>
          <p id="Par12">Method Development Set (subset of the MAGNETIC data set)</p>
        </def>
      </def-item>
      <def-item>
        <term>MH</term>
        <def>
          <p id="Par13">Manhattan Harvester</p>
        </def>
      </def-item>
      <def-item>
        <term>MVS</term>
        <def>
          <p id="Par14">Method Validation Set (subset of the MAGNETIC data set)</p>
        </def>
      </def-item>
      <def-item>
        <term>NMR</term>
        <def>
          <p id="Par15">Nuclear Magnetic Resonance</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank 20 scientists (KHEs) from the Genome Institute, University of Tartu for evaluating peaks for MH development. We also acknowledge the High Performance Computing Centre of the University of Tartu for their technical support.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par45">We received support from EU H2020 grant ePerMed (#692145), EU H2020 grant 633589, targeted financing from Estonian Government IUT20–60, Estonian Center of Genomics/Roadmap II (project No. 2014–2020.4.01.16–0125). This research was also supported by the European Union through the European Regional Development Fund (Project No. 2014–2020.4.01.15–0012) and by the US National Institute of Health [R01DK075787].</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par46">Manhattan Harvester and Cropper together with their source code and supporting materials can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://www.geenivaramu.ee/en/tools">www.geenivaramu.ee/en/tools</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>TH initiated the project, developed the algorithms, implemented the algorithms in C++, generated part of the figures and wrote the manuscript. TT performed statistical modeling, provided R programming knowledge, generated part of the figures and critically reviewed the manuscript. AM coordinated the project and provided funding. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Population genetics and GWAS: a primer</article-title>
        <source>PLoS Biol</source>
        <year>2018</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>e2005485</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.2005485</pub-id>
        <pub-id pub-id-type="pmid">29547618</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>10 years of GWAS discovery: biology, function, and Translation</article-title>
        <source>Am J Hum Genet</source>
        <year>2017</year>
        <volume>101</volume>
        <issue>1</issue>
        <fpage>5</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2017.06.005</pub-id>
        <pub-id pub-id-type="pmid">28686856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ganna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Genovese</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Howrigan</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Byrnes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kurki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zekavat</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultra-rare disruptive and damaging mutations influence educational attainment in the general population</article-title>
        <source>Nat Neurosci</source>
        <year>2016</year>
        <volume>19</volume>
        <issue>12</issue>
        <fpage>1563</fpage>
        <lpage>1565</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4404</pub-id>
        <pub-id pub-id-type="pmid">27694993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Neale Lab. http://www.nealelab.is/blog/2017/7/19/rapid-gwas-of-thousands-of-phenotypes-for-337000-samples-in-the-uk-biobank. Accessed 27 June 2018.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kals</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Esko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mägi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>RegScan: a GWAS tool for quick estimation of allele effects on continuous traits and their combinations</article-title>
        <source>Brief Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>39</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt066</pub-id>
        <pub-id pub-id-type="pmid">24008273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Qt. <ext-link ext-link-type="uri" xlink:href="https://www.qt.io/">https://www.qt.io/</ext-link>. Accessed 27 June 2018.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Song J, Wang, H. Tutorial: Optimal univariate clustering. 2017. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/Ckmeans.1d.dp/vignettes/Ckmeans.1d.dp.html">https://cran.r-project.org/web/packages/Ckmeans.1d.dp/vignettes/Ckmeans.1d.dp.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kettunen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Demirkan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Würtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Draisma</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Haller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rawal</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide study for circulating metabolites identifies 62 loci and reveals novel systemic effects of LPA</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11122</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11122</pub-id>
        <pub-id pub-id-type="pmid">27005778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Computational Medicine, MAGENTIC NMR-GWAS summary statistics. <ext-link ext-link-type="uri" xlink:href="http://www.computationalmedicine.fi/data#NMR_GWAS">http://www.computationalmedicine.fi/data#NMR_GWAS</ext-link>. Accessed 27 June 2018.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mägi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>GWAMA: software for genome-wide association meta-analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>288</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-288</pub-id>
        <?supplied-pmid 20509871?>
        <pub-id pub-id-type="pmid">20509871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedeker</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mermelstein</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Demirtas</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Berbaum</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>A mixed-effects location-scale model for ordinal questionnaire data</article-title>
        <source>Health Serv Outcomes Res Methodol</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>117</fpage>
        <lpage>131</lpage>
        <pub-id pub-id-type="doi">10.1007/s10742-016-0145-9</pub-id>
        <pub-id pub-id-type="pmid">27570476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">R Core Team. 2017. R: a language and environment for statistical computing. R Foundation for Statistical Computing, Vienna. <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>Accessed 27 June 2018.</mixed-citation>
    </ref>
  </ref-list>
</back>
