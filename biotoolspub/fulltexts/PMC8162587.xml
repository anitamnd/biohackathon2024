<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8162587</article-id>
    <article-id pub-id-type="pmid">34003823</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-01697</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008978</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Functions</subject>
            <subj-group>
              <subject>Convolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Models</subject>
            <subj-group>
              <subject>Random Walk</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Data Visualization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cell Processes</subject>
            <subj-group>
              <subject>Cell Cycle and Cell Division</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Chromosome Biology</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Similarity Measures</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Cluster Analysis</subject>
            <subj-group>
              <subject>Spectral Clustering</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Cell Differentiation</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scHiCTools: A computational toolbox for analyzing single-cell Hi-C data</article-title>
      <alt-title alt-title-type="running-head">scHiCTools: A computational toolbox for analyzing single-cell Hi-C data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Xinjun</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5990-312X</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Fan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pu</surname>
          <given-names>Hongxi</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6059-7000</contrib-id>
        <name>
          <surname>Leung</surname>
          <given-names>Wai Yan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9504-0587</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Jie</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Statistics, University of Michigan, Ann Arbor, Michigan, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Computational Medicine and Bioinformatics, University of Michigan, Ann Arbor, Michigan, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>College of Literature Science, and the Arts, University of Michigan, Ann Arbor, Michigan, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Johns Hopkins University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>drjieliu@umich.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>5</issue>
    <elocation-id>e1008978</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Li et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Li et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008978.pdf"/>
    <abstract>
      <p>Single-cell Hi-C (scHi-C) sequencing technologies allow us to investigate three-dimensional chromatin organization at the single-cell level. However, we still need computational tools to deal with the sparsity of the contact maps from single cells and embed single cells in a lower-dimensional Euclidean space. This embedding helps us understand relationships between the cells in different dimensions, such as cell-cycle dynamics and cell differentiation. We present an open-source computational toolbox, <bold>scHiCTools</bold>, for analyzing single-cell Hi-C data comprehensively and efficiently. The toolbox provides two methods for screening single cells, three common methods for smoothing scHi-C data, three efficient methods for calculating the pairwise similarity of cells, three methods for embedding single cells, three methods for clustering cells, and a build-in function to visualize the cells embedding in a two-dimensional or three-dimensional plot. <bold>scHiCTools</bold>, written in Python3, is compatible with different platforms, including Linux, macOS, and Windows.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Single-cell Hi-C contact maps describe the numbers of interactions among genomic loci across the entire genome, and provide researchers 3D chromatin organization in each cell. There are growing demands for an easy and fast way to analyze and visualize single-cell Hi-C data, and analyzing single-cell Hi-C data exposes several inherent data analysis challenges. To move beyond existing computational tools and methods to analyze and visualize single-cell Hi-C data, we present a software package, scHiCTools, which is implemented in Python. The software package provides researchers a collection of methods to investigate the cell-to-cell similarity based on their 3D chromatin organization, cluster cells into groups accordingly, and visualize cells in two-dimensional or three-dimensional scatter plots. In this paper, we provide an overview of scHiCTools’ structure and capabilities. We then apply scHiCTools to several single-cell Hi-C datasets to benchmark the performance of the methods provided in our toolbox, and present some plots generated using the software package.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35HG011279</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Xinjun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35HG011279</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5990-312X</contrib-id>
          <name>
            <surname>Feng</surname>
            <given-names>Fan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35HG011279</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9504-0587</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Jie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>XL, FF and JL were supported by National Human Genome Research Institute award R35HG011279. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="2"/>
      <page-count count="14"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-05-28</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its <xref ref-type="sec" rid="sec016">Supporting information</xref> files. Our scHiCTools is implemented in Python. The source code is available and maintained at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/liu-bioinfo-lab/scHiCTools">https://github.com/liu-bioinfo-lab/scHiCTools</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its <xref ref-type="sec" rid="sec016">Supporting information</xref> files. Our scHiCTools is implemented in Python. The source code is available and maintained at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/liu-bioinfo-lab/scHiCTools">https://github.com/liu-bioinfo-lab/scHiCTools</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Recent single-cell Hi-C sequencing (scHi-C) technologies profile three-dimensional (3D) chromatin contact maps in individual cells, allowing us to characterize chromatin organization dynamics and cell-to-cell heterogeneity [<xref rid="pcbi.1008978.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1008978.ref003" ref-type="bibr">3</xref>]. However, the interpretation of scHi-C data exposes several inherent data analysis challenges [<xref rid="pcbi.1008978.ref004" ref-type="bibr">4</xref>]. First, unlike RNA-seq data and ATAC-seq data which are vectors of <italic>m</italic>-dimensional measures, Hi-C data are essentially symmetric matrices of <italic>m</italic> × <italic>m</italic>-dimensional pairwise measures, where the number of genomic loci <italic>m</italic> is usually more than tens of thousands, depending on the resolution of the contact maps. Second, scHi-C analysis suffers from high-dimensionality, the sparsity of the contact maps, and sequencing noise. Typically in a scHi-C experiment, up to a few thousands of single cells are profiled, whereas the number of contacts in each cell ranges from a few thousands to hundreds of thousands. Third, single cells in one experiment usually reside in a low-dimensional manifold, such as a circular cell cycle structure or a bifurcation differentiation structure. Thus, proper embedding of scHi-C data in a low-dimensional Euclidean space is vital in scHi-C data analysis.</p>
    <p>In a previous exploratory study [<xref rid="pcbi.1008978.ref004" ref-type="bibr">4</xref>], different similarity methods [<xref rid="pcbi.1008978.ref005" ref-type="bibr">5</xref>–<xref rid="pcbi.1008978.ref009" ref-type="bibr">9</xref>] have been applied to scHi-C data from <italic>n</italic> single cells, and coupled with multidimensional scaling (MDS) to project the <italic>n</italic> single cells into a low-dimensional Euclidean space. Among these methods, HiCRep [<xref rid="pcbi.1008978.ref005" ref-type="bibr">5</xref>] yields reasonable similarity measures and satisfactory embedding of the single cells, but its <italic>O</italic>(<italic>n</italic><sup>2</sup>) computational complexity makes it impractical when the number of cells is large. In addition, this proof-of-concept study [<xref rid="pcbi.1008978.ref004" ref-type="bibr">4</xref>] did not provide any software implementation to embed scHi-C data, let along upstream analysis such as screening single cells and smoothing contact maps, and downstream analysis such as clustering and visualization.</p>
    <p>In this work, we implemented a versatile <bold>scHiCTools</bold> which includes many common approaches in the entire workflow of analyzing single-cell Hi-C data. In particular, we implemented three similarity measures, including a faster version of HiCRep, a new “InnerProduct” approach, and another efficient Hi-C similarity measure named Selfish [<xref rid="pcbi.1008978.ref010" ref-type="bibr">10</xref>]. Among the three methods implemented, InnerProduct provides the most efficient and satisfactory similarity measure. Benchmarking experiments demonstrate that the new InnerProduct approach runs thousands of times faster than the original HiCRep, and produces comparably accurate projection. To deal with the sparsity in scHi-C data, different smoothing approaches are implemented, including linear convolution, random walk, and network enhancing [<xref rid="pcbi.1008978.ref011" ref-type="bibr">11</xref>]. Among the three approaches, linear convolution appears to be most effective for smoothing contact maps in our experiments. In addition to the computational components, our toolbox supports different input file formats, diagnostic summary plots, and flexible projection plots. Our open-source toolbox, <bold>scHiCTools</bold>, as the first toolbox of such kind, can be useful for analyzing scHi-C data.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <sec id="sec003">
      <title>Overview</title>
      <p>Our <bold>scHiCTools</bold> implements commonly used approaches to analyze single-cell Hi-C data. The key component of the toolbox is a number of dimension reduction approaches which takes a number of single cells’ contact maps as input, and embeds the cells in a low-dimensional Euclidean space. The toolbox also provides a number of built-in auxiliary functions for flexible and interactive visualization. The entire workflow of scHiCTools, illustrated in <xref ref-type="fig" rid="pcbi.1008978.g001">Fig 1</xref>, includes five steps: (1) reading single-cell data in .txt, .hic, or .cool format, generating diagnostic summary plots, and screening cells by their contact number and contact distance profile, (2) smoothing scHi-C contact maps using linear convolution, random walk, or network enhancing, (3) calculating pairwise similarity between cells using fastHiCRep, InnerProduct, or Selfish, (4) embedding or clustering the cells in a low-dimensional space using dimension reduction methods, and (5) visualizing the two-dimensional or three-dimensional embedding in a scatter plot. Except for the two pairwise similarity calculation methods, fastHiCRep and InnerProduct, other methods are implemented as originally stated.</p>
      <fig id="pcbi.1008978.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008978.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>The workflow of scHiCTools.</title>
          <p>The workflow of scHiCTools includes five steps: (1) reading input single-cell data in .txt, .hic, or .cool format, generating the summary plots of the cells, and screening cells based on their contact number and contact distance profile, (2) smoothing the scHi-C contact maps using linear convolution, random walk, or network enhancing, (3) calculating the pairwise similarity between cells using fastHiCRep, InnerProduct, or Selfish, (4) embedding or clustering the cells in a low-dimensional Euclidean space using dimension reduction methods, and (5) visualizing the two-dimensional or three-dimensional embedding in a scatter plot.</p>
        </caption>
        <graphic xlink:href="pcbi.1008978.g001"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Loading data and screening cells</title>
      <p>Users can load scHi-C data in different file formats, including .hic files, .cool files, and sparse contact matrices in text files. When users choose to load sparse matrices in text files, they are able to customize each column in the text files, and specify additional information including reference genome and the resolution of the contact maps. In addition, <bold>scHiCTools</bold> supports parallel file loading on a multi-core processor. After loading the data files, <bold>scHiCTools</bold> allows users to plot two summary plots to examine the quality of the loaded single-cell Hi-C data, namely a histogram of contact numbers, and a scatter plot of cells with the proportion of short-range contacts (&lt;2 Mb) versus the proportion of the contacts at the mitotic band (2 ∼ 12 Mb) (<xref ref-type="fig" rid="pcbi.1008978.g002">Fig 2</xref>). A low-quality contact map is characterized by a low number of contacts and a relatively high proportion of short-range contacts. Users can further remove the low-quality cells by thresholding the number of contacts and the proportion of short-range contacts in the cells.</p>
      <fig id="pcbi.1008978.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008978.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Summary plots for examining the quality of input scHi-C data.</title>
          <p>(a) A histogram of contact numbers in the individual cells. (b) A scatter plot showing the percentage of short-range contacts (&lt;2 Mb) versus the percentage of contacts at the mitotic band (2 ∼ 12 Mb) in individual cells.</p>
        </caption>
        <graphic xlink:href="pcbi.1008978.g002"/>
      </fig>
    </sec>
    <sec id="sec005">
      <title>Smoothing contact maps</title>
      <p>Smoothing single cell contact maps is necessary when they are sparse, especially in a comparative analysis. Our toolbox <bold>scHiCTools</bold> implements three smoothing approaches.</p>
      <p><bold>Linear convolution</bold> is essentially a two-dimensional convolution filter with equal weights in every position, which can be viewed as smoothing over neighboring bins in Hi-C contact maps. For example, original HiCRep [<xref rid="pcbi.1008978.ref005" ref-type="bibr">5</xref>] uses a parameter <italic>h</italic> to describe a (2<italic>h</italic> + 1) × (2<italic>h</italic> + 1) convolution filter, i.e., <italic>h</italic> = 1 indicating a 3 × 3 kernel with each element <inline-formula id="pcbi.1008978.e001"><alternatives><graphic xlink:href="pcbi.1008978.e001.jpg" id="pcbi.1008978.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>9</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula>.</p>
      <p><bold>Random walk</bold> [<xref rid="pcbi.1008978.ref012" ref-type="bibr">12</xref>] is another approach to smooth chromatin contact maps. Unlike linear convolution which takes information from neighbors on the contact map, random walk captures the signals from a global setting as follows. Let <italic>W</italic> be the input <italic>m</italic> × <italic>m</italic> contact matrix. Random walk updates <italic>W</italic> by <italic>W</italic><sup>(<italic>t</italic>)</sup> = <italic>W</italic><sup>(<italic>t</italic>−1)</sup> ⋅ <italic>B</italic> in the <italic>t</italic>-th iteration, where <italic>W</italic><sup>(0)</sup> = <italic>W</italic>, and <inline-formula id="pcbi.1008978.e002"><alternatives><graphic xlink:href="pcbi.1008978.e002.jpg" id="pcbi.1008978.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. The matrix <italic>B</italic> is the input matrix divided by its row sum (i.e., every row of <italic>B</italic> sum up to 1). We can write <italic>B</italic> as <italic>B</italic> = <italic>D</italic><sup>−1</sup> ⋅ <italic>W</italic>, where <inline-formula id="pcbi.1008978.e003"><alternatives><graphic xlink:href="pcbi.1008978.e003.jpg" id="pcbi.1008978.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. After <italic>t</italic> steps of update, <italic>W</italic><sup>(<italic>t</italic>)</sup> = <italic>W</italic> ⋅ <italic>B</italic><sup><italic>t</italic></sup> is the output matrix after smoothing.</p>
      <p><bold>Network enhancing</bold> [<xref rid="pcbi.1008978.ref011" ref-type="bibr">11</xref>] is a special type of random walk which enhances network signals by increasing gaps between leading eigenvalues of a doubly stochastic matrix (DSM, the sum of each row and the sum of each column are both 1). To get a DSM, Knight-Ruiz (KR) normalization [<xref rid="pcbi.1008978.ref013" ref-type="bibr">13</xref>] is applied to the original contact matrix <italic>W</italic>, i.e., finding a vector <italic>a</italic>, such that <italic>W</italic>′ = <italic>aWa</italic><sup>⊤</sup> is a DSM. Network enhancing makes the partition of contact maps more prominent, and enhances boundaries of topologically associated domains (TADs) in chromatin contact maps [<xref rid="pcbi.1008978.ref011" ref-type="bibr">11</xref>].</p>
    </sec>
    <sec id="sec006">
      <title>Calculating pairwise similarity</title>
      <p>Hi-C contact maps are <italic>m</italic> × <italic>m</italic>-dimensional measures, where <italic>m</italic> is the number of genomic loci. By calculating pairwise similarity among the cells, we avoid dealing with the high-dimensional measure in the following embedding and clustering steps. Our toolbox <bold>scHiCTools</bold> includes the following three approaches for calculating pairwise similarity among the single cells.</p>
      <p><bold>InnerProduct</bold> calculates the pairwise similarity matrix among cells in two steps. The first step is “scaling”, which directly sets the first <italic>s</italic>
<italic>z</italic>-normalized strata of one cell’s contact map as a feature vector for the cell. Because we only need to apply this step to the individual cells sequentially, this scaling step has an <italic>O</italic>(<italic>n</italic>) time complexity. Denote <italic>v</italic><sub><italic>i</italic></sub> = [<italic>v</italic><sub><italic>i</italic>,1</sub>, <italic>v</italic><sub><italic>i</italic>,2</sub>, ⋯, <italic>v</italic><sub><italic>i</italic>,<italic>m</italic>−<italic>i</italic></sub>]<sup>⊤</sup> to be the <italic>i</italic>-th stratum of the chromosome, <italic>i</italic> from 1 to <italic>s</italic>. <italic>v</italic><sub><italic>i</italic>,<italic>k</italic></sub> = <italic>W</italic><sub><italic>k</italic>,<italic>k</italic>+<italic>i</italic></sub> is the <italic>k</italic>-th element of <italic>v</italic><sub><italic>i</italic></sub>, where <italic>W</italic> is the contact matrix of a chromosome. Subsequently, <italic>z</italic>-normalization is applied to each <italic>v</italic><sub><italic>i</italic></sub> to get a zero-mean and unit-variance vector <inline-formula id="pcbi.1008978.e004"><alternatives><graphic xlink:href="pcbi.1008978.e004.jpg" id="pcbi.1008978.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>. By concatenating all strata, the feature vector for each contact map is <inline-formula id="pcbi.1008978.e005"><alternatives><graphic xlink:href="pcbi.1008978.e005.jpg" id="pcbi.1008978.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msup><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The second step is “multiplication”, which calculates an inner product of the <italic>n</italic> feature vectors from the <italic>n</italic> cells to obtain the <italic>n</italic> × <italic>n</italic> similarity matrix. The second step has an <italic>O</italic>(<italic>n</italic><sup>2</sup>) time complexity, but this step can be implemented efficiently with matrix multiplication in NumPy. Namely, we directly calculate the inner product of the two feature vectors <italic>V</italic><sub><italic>x</italic></sub> and <italic>V</italic><sub><italic>y</italic></sub> of map <italic>x</italic> and map <italic>y</italic> as their similarity,
<disp-formula id="pcbi.1008978.e006"><alternatives><graphic xlink:href="pcbi.1008978.e006.jpg" id="pcbi.1008978.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>…</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>…</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>Run time of InnerProduct is also linear with respect to the length of <italic>V</italic>, which depends on the product of <italic>m</italic> and <italic>s</italic>, where <italic>m</italic> is the size of the contact map, and <italic>s</italic> is the number of strata from the diagonal considered in the calculation. Taking the average of <italic>r</italic><sub><italic>xy</italic></sub> over all chromosomes keeps the matrix positive definite, and gives us an overall kernel matrix of all the cells in the input. In practice, although taking the median may make the matrix no longer positive definite, it makes the similarity more stable and robust to noisy measurements.</p>
      <p><bold>fastHiCRep</bold> is a faster implementation of the original HiCRep approach [<xref rid="pcbi.1008978.ref005" ref-type="bibr">5</xref>]. Original HiCRep [<xref rid="pcbi.1008978.ref005" ref-type="bibr">5</xref>] calculates <italic>s</italic> stratum-adjusted correlation coefficients (SCCs) of the <italic>s</italic> strata near the diagonal of two contact maps, namely
<disp-formula id="pcbi.1008978.e007"><alternatives><graphic xlink:href="pcbi.1008978.e007.jpg" id="pcbi.1008978.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>SCC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>v</italic><sub><italic>i</italic></sub> is the <italic>i</italic>-th stratum of the chromosome, <italic>m</italic> − <italic>i</italic> is the length of <italic>v</italic><sub><italic>i</italic></sub>, and <italic>r</italic><sub><italic>i</italic></sub> is the Pearson’s correlation coefficient of <inline-formula id="pcbi.1008978.e008"><alternatives><graphic xlink:href="pcbi.1008978.e008.jpg" id="pcbi.1008978.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008978.e009"><alternatives><graphic xlink:href="pcbi.1008978.e009.jpg" id="pcbi.1008978.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
      <p>We have <inline-formula id="pcbi.1008978.e010"><alternatives><graphic xlink:href="pcbi.1008978.e010.jpg" id="pcbi.1008978.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo accent="true">¯</mml:mo></mml:mover><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, then
<disp-formula id="pcbi.1008978.e011"><alternatives><graphic xlink:href="pcbi.1008978.e011.jpg" id="pcbi.1008978.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Note that the denominator term of <italic>r</italic><sub><italic>i</italic></sub> can be cancelled out with <inline-formula id="pcbi.1008978.e012"><alternatives><graphic xlink:href="pcbi.1008978.e012.jpg" id="pcbi.1008978.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> in the numerator of SCC in <xref ref-type="disp-formula" rid="pcbi.1008978.e007">Eq (2)</xref>. We can write SCC between contact maps <italic>x</italic> and <italic>y</italic> as
<disp-formula id="pcbi.1008978.e013"><alternatives><graphic xlink:href="pcbi.1008978.e013.jpg" id="pcbi.1008978.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msup><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mi>x</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:msup><mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1008978.e014"><alternatives><graphic xlink:href="pcbi.1008978.e014.jpg" id="pcbi.1008978.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo form="prefix" stretchy="true">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable><mml:mo form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<inline-formula id="pcbi.1008978.e015"><alternatives><graphic xlink:href="pcbi.1008978.e015.jpg" id="pcbi.1008978.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo form="prefix" stretchy="true">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>y</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>y</mml:mi></mml:msubsup><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable><mml:mo form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008978.e016"><alternatives><graphic xlink:href="pcbi.1008978.e016.jpg" id="pcbi.1008978.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mi>x</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo form="prefix" stretchy="true">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msqrt><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mtd></mml:mtr></mml:mtable><mml:mo form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<inline-formula id="pcbi.1008978.e017"><alternatives><graphic xlink:href="pcbi.1008978.e017.jpg" id="pcbi.1008978.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo form="prefix" stretchy="true">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msqrt><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>y</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msqrt><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mtd></mml:mtr></mml:mtable><mml:mo form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      <p>From above, SCC can be calculated efficiently because for each cell, cell <italic>x</italic> for example, <italic>vec</italic><sup><italic>x</italic></sup> and <italic>var</italic><sup><italic>x</italic></sup> only need to be calculated once. The vectors required in both the numerator and the denominator are generated sequentially for individual cells with an <italic>O</italic>(<italic>n</italic>) time complexity. Note that both the numerator and the denominator are inner products. Calculating the inner products has an <italic>O</italic>(<italic>n</italic><sup>2</sup>) time complexity, but this step can be implemented efficiently with matrix multiplication in NumPy. However, there is one subtle difference between original HiCRep and our implemented fastHiCRep. In original HiCRep, if one chromatin contact in both cells <italic>x</italic> and <italic>y</italic> is zero, then this contact position will not be used in the calculation of SCC. Because HiCRep need to remove zeros and this operation is specific to the two cells to be compared, we need to calculate <italic>r</italic><sub><italic>i</italic></sub>, <inline-formula id="pcbi.1008978.e018"><alternatives><graphic xlink:href="pcbi.1008978.e018.jpg" id="pcbi.1008978.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1008978.e019"><alternatives><graphic xlink:href="pcbi.1008978.e019.jpg" id="pcbi.1008978.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1008978.e007">Eq (2)</xref>
<inline-formula id="pcbi.1008978.e020"><alternatives><graphic xlink:href="pcbi.1008978.e020.jpg" id="pcbi.1008978.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> times. Empirically, the SCC calculated by fastHiCRep and HiCRep did not differ too much. We randomly select a cell from Nagano dataset (cell 205 of Early-S stage) and compare the SCC scores using fastHiCRep versus HiCRep of other 1710 cells from Nagano dataset. The correlation coefficient of the SCC scores calculated by fastHiCRep and SCC scores calculated by HiCRep is 0.991.</p>
      <p>The third similarity measure <bold>Selfish</bold> [<xref rid="pcbi.1008978.ref010" ref-type="bibr">10</xref>] was recently proposed for bulk Hi-C comparative analysis. It first uses a sliding window to obtain a number of rectangular regions along the diagonal of the contact map, and then counts overall contact numbers in each region. Then it generates a one-hot “fingerprint matrix” for each contact map. Finally, Gaussian kernels over the fingerprint matrices are calculated as similarities among the cells.</p>
    </sec>
    <sec id="sec007">
      <title>Embedding and clustering</title>
      <p>Although single cell measures are high-dimensional, the single cells usually reside in a low-dimensional manifold such as a circular cell cycle structure and a bifurcation differentiation structure. By embedding the cells in a lower-dimensional Euclidean space, we can easily explore the heterogeneity and structures among the single cells. <bold>scHiCTools</bold> includes three different dimension reduction methods that use pairwise similarity matrices among the cells to embed them in a low-dimensional Euclidean space. The three dimension reduction methods are as follows.</p>
      <p><bold>MDS</bold> (Multidimensional scaling) takes in a pairwise distance matrix evaluated in the original space, and embeds the data points in a lower-dimensional space which preserves the pairwise distance matrix. In our package, we use the classical MDS which finds the <italic>p</italic> dimensional embedding <inline-formula id="pcbi.1008978.e021"><alternatives><graphic xlink:href="pcbi.1008978.e021.jpg" id="pcbi.1008978.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo>⊤</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> that minimizes the loss function: <italic>loss</italic> = ‖<italic>XX</italic><sup>⊤</sup> − <italic>G</italic>‖<sub><italic>F</italic></sub>, where <inline-formula id="pcbi.1008978.e022"><alternatives><graphic xlink:href="pcbi.1008978.e022.jpg" id="pcbi.1008978.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mn mathvariant="bold">1</mml:mn><mml:msup><mml:mn mathvariant="bold">1</mml:mn><mml:mo>⊤</mml:mo></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>D</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mn mathvariant="bold">1</mml:mn><mml:msup><mml:mn mathvariant="bold">1</mml:mn><mml:mo>⊤</mml:mo></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>D</italic><sub><italic>ij</italic></sub> is the distance between <italic>i</italic>-th and <italic>j</italic>-th cells, and <bold>1</bold> denotes a column vector of all ones.</p>
      <p><bold><italic>t</italic>-SNE</bold> [<xref rid="pcbi.1008978.ref014" ref-type="bibr">14</xref>] embeds high-dimensional data in a low-dimensional space with an emphasis on preserving local neighborhood. <italic>t</italic>-SNE assumes that data points <italic>x</italic><sub>1</sub>, ⋯, <italic>x</italic><sub><italic>n</italic></sub> in the high-dimensional space follow a Gaussian distribution, and the embedded points <italic>y</italic><sub>1</sub>, ⋯, <italic>y</italic><sub><italic>n</italic></sub> follow a Student’s <italic>t</italic>-distribution. In the higher-dimensional space, the conditional probability of <italic>x</italic><sub><italic>i</italic></sub> picking <italic>x</italic><sub><italic>j</italic></sub> as its neighbor is <inline-formula id="pcbi.1008978.e023"><alternatives><graphic xlink:href="pcbi.1008978.e023.jpg" id="pcbi.1008978.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. In our implementation, instead of computing the norm between two points, we directly use distances between two cells to calculate the similarity. The similarity between <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> is defined as the probability of picking <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> as neighbors, which is <inline-formula id="pcbi.1008978.e024"><alternatives><graphic xlink:href="pcbi.1008978.e024.jpg" id="pcbi.1008978.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∣</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. In the embedding space, since <italic>y</italic><sub>1</sub>, ⋯, <italic>y</italic><sub><italic>n</italic></sub> ∼ <italic>t</italic><sub>1</sub>, the probability of picking <italic>y</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>j</italic></sub> as neighbors is <inline-formula id="pcbi.1008978.e025"><alternatives><graphic xlink:href="pcbi.1008978.e025.jpg" id="pcbi.1008978.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. The Kullback–Leibler divergence of the distribution of data points from the distribution of embedded points is <inline-formula id="pcbi.1008978.e026"><alternatives><graphic xlink:href="pcbi.1008978.e026.jpg" id="pcbi.1008978.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext>log</mml:mtext><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. The embedding of the cells are optimized by minimizing the KL-divergence above.</p>
      <p><bold>PHATE</bold> (Potential of Heat-diffusion for Affinity-based Trajectory Embedding) [<xref rid="pcbi.1008978.ref015" ref-type="bibr">15</xref>] is a dimension reduction approach which preserves both local and global similarity. PHATE first calculates a local affinity matrix based on <italic>k</italic>-nearest neighbor distance <italic>K</italic><sub><italic>k</italic></sub>, which captures the local structure of the data points. PHATE normalizes <italic>K</italic><sub><italic>k</italic></sub> using a Gaussian kernel to obtain a new matrix <italic>P</italic>, and then diffuses <italic>P</italic> by <italic>t</italic> steps to get a new matrix <italic>P</italic><sup><italic>t</italic></sup> which preserves the global structure of data points. Based on matrix <italic>P</italic><sup><italic>t</italic></sup>, a potential representation of data can be calculated as <italic>U</italic><sub><italic>t</italic></sub> = −<italic>log</italic>(<italic>P</italic><sup><italic>t</italic></sup>). Finally, PHATE applies non-metric MDS to <italic>U</italic><sub><italic>t</italic></sub> and generates low-dimensional embedding of the cells.</p>
      <p>Clustering methods are desirable in the situation that the single cells come from discrete clusters rather than a continuous manifold. The following optional clustering methods are implemented in our toolbox.</p>
      <p><bold><italic>k</italic>-means</bold> assigns an observation to the cluster with the nearest cluster centroid, which is the mean of all observations belonging to the cluster. We use <italic>k</italic>-means++ [<xref rid="pcbi.1008978.ref016" ref-type="bibr">16</xref>] to initialize the centroids of clusters. Iterations of <italic>k</italic>-means algorithm renew the clusters by finding the points closest to the centroid in the last iteration, and update the centroid of each cluster by taking the mean of points in each cluster. Since <italic>k</italic>-means needs coordinates of cells in a Euclidean space to find the centroid of each cluster, we use MDS to embed the cells into a <italic>l</italic>-dimensional space first, and then perform <italic>k</italic>-means accordingly.</p>
      <p><bold>Spectral clustering</bold> [<xref rid="pcbi.1008978.ref017" ref-type="bibr">17</xref>] takes in a distance matrix of data points and divides <italic>n</italic> observations into <italic>k</italic> clusters. Spectral clustering directly takes in the distance matrix and constructs a similarity graph with Gaussian similarity function. Based on the similarity graph, spectral clustering calculates the Laplacian of the similarity graph, and projects the points into a <italic>k</italic>-dimensional space based on the first <italic>k</italic> eigenvectors of the graph Laplacian matrix. Finally, it uses <italic>k</italic>-means to divide the data points into <italic>k</italic> group.</p>
      <p><bold>scHiCluster</bold> [<xref rid="pcbi.1008978.ref018" ref-type="bibr">18</xref>] is a clustering method designed explicitly for single-cell Hi-C data. It uses convolution and random walk for smoothing and imputation, then converts the contact matrices to binary matrices. scHiCluster conducts principal component analysis for embedding, and then <italic>k</italic>-means for clustering.</p>
    </sec>
    <sec id="sec008">
      <title>Visualization of embedding</title>
      <p><bold>scHiCTools</bold> supports two-dimensional and three-dimensional plotting of the cell embedding. <xref ref-type="fig" rid="pcbi.1008978.g003">Fig 3</xref> shows the scatter plots of the two-dimensional embedding of the cells in a cell cycle study [<xref rid="pcbi.1008978.ref002" ref-type="bibr">2</xref>]. In the situation that the cells reside on a three-dimensional manifold, a three-dimensional scatter plot of the cells can be visualized (<xref ref-type="supplementary-material" rid="pcbi.1008978.s002">S2 File</xref>). As a convenient option, an interactive scatter plot can be visualized, in which the cell label is displayed when the user’s mouse hovers (see <xref ref-type="supplementary-material" rid="pcbi.1008978.s003">S3 File</xref>). In order to use this feature, <italic>ploty</italic> is required on user’s device.</p>
      <fig id="pcbi.1008978.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008978.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Two-dimensional scatter plots of the embedding from the three methods that calculate the similarity between contact matrices, including InnerProduct, fastHiCRep and Selfish.</title>
          <p>(Dataset: Nagano et al., 2017). (a) Two-dimensional projection from InnerProduct and MDS shows a clear circular pattern along the four stages of cell cycle. (b) Two-dimensional projection using fastHiCRep and MDS does not show clear separation between the four stages of cell cycle. (c) Two-dimensional projection using Selfish and MDS does not show clear separation between the four stages of cell cycle. (d) Evaluating the three embedding methods in a cell-cycle phasing task by ACROC. The ACROC values from InnerProduct, fastHiCRep and Selfish are 0.904, 0.858 and 0.642, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1008978.g003"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results" id="sec009">
    <title>Results</title>
    <p>In this section, we apply the toolbox on a number of scHi-C datasets [<xref rid="pcbi.1008978.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1008978.ref019" ref-type="bibr">19</xref>], and benchmark the performance of different methods implemented. In addition to plotting the two-dimensional embedding of cells and examining whether the embedding is sensible, we benchmark the projection performance on a scHi-C dataset [<xref rid="pcbi.1008978.ref002" ref-type="bibr">2</xref>] with the average area under the curve of a circular ROC calculation (ACROC) proposed in a recent work [<xref rid="pcbi.1008978.ref004" ref-type="bibr">4</xref>]. ACROC measure ranges between 0 to 1. An embedding representing a better circular pattern produces a larger ACROC value. We record the run time of these methods to compare their efficiency. We evaluate the clustering performance with two criteria: normalized mutual information (NMI) [<xref rid="pcbi.1008978.ref020" ref-type="bibr">20</xref>] and adjusted rand index (ARI) [<xref rid="pcbi.1008978.ref021" ref-type="bibr">21</xref>] on another scHi-C dataset [<xref rid="pcbi.1008978.ref019" ref-type="bibr">19</xref>]. We have the following observations.</p>
    <sec id="sec010">
      <title>InnerProduct is effective for calculating the pairwise similarity among single-cell Hi-C contact maps</title>
      <p>When InnerProduct is coupled with MDS, it produces an accurate projection of single cells along four stages of cell cycle (<xref ref-type="fig" rid="pcbi.1008978.g003">Fig 3a</xref>), achieving an average area under a circular ROC calculation curve (ACROC) of 0.904, which is comparable to original HiCRep reported in the recent work [<xref rid="pcbi.1008978.ref004" ref-type="bibr">4</xref>]. Two-dimensional scatter plots from fastHiCRep and Selfish show a circular pattern along the four stages of cell cycle, but the separation between the stages is not as clear as that from InnerProduct (<xref ref-type="fig" rid="pcbi.1008978.g003">Fig 3b and 3c</xref>). The ACROC measure from fastHiCRep is 0.858 and the ACROC measure from Selfish is 0.642, which are both lower than that from InnerProduct (<xref ref-type="fig" rid="pcbi.1008978.g003">Fig 3d</xref>).</p>
    </sec>
    <sec id="sec011">
      <title>PHATE and <italic>t</italic>-SNE produce satisfactory projections</title>
      <p>Since MDS recovers global pairwise distance in its projection, it is unclear whether methods that preserve local pairwise distance (i.e., PHATE and <italic>t</italic>-SNE) can produce a better projection. <xref ref-type="fig" rid="pcbi.1008978.g004">Fig 4a and 4b</xref> show that PHATE and <italic>t</italic>-SNE are suitable embedding methods that project the smoothed contact maps into a lower-dimensional space while preserving a cell-cycle pattern. The ACROC measure of PHATE is 0.920, which is better than <italic>t</italic>-SNE (0.901) and MDS (0.904). Therefore, PHATE and <italic>t</italic>-SNE can be used alternatively, especially when faraway neighbors’ similarity cannot be properly evaluated.</p>
      <fig id="pcbi.1008978.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008978.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Two-dimensional embedding using different dimension reduction methods.</title>
          <p>(Dataset: Nagano et al., 2017). (a) Two-dimensional projection from InnerProduct/PHATE shows a circular pattern similiar to MDS projection (ACROC: 0.920). (b) Two-dimensional projection from InnerProduct/<italic>t</italic>-SNE shows a circular pattern (ACROC: 0.901).</p>
        </caption>
        <graphic xlink:href="pcbi.1008978.g004"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>All three methods to calculate pairwise similarity are computationally efficient</title>
      <p>The run time of InnerProduct, fastHiCRep, Selfish, and original HiCRep was measured on an Intel Xeon W-2175 CPU with a frequency of 2.50GHz (<xref rid="pcbi.1008978.t001" ref-type="table">Table 1</xref>). Each experiment was replicated ten times, and the average run time was reported (Run time from different replicate experiments showed little variance. See <xref ref-type="supplementary-material" rid="pcbi.1008978.s005">S5 File</xref> for raw data). For embedding 1,000 cells randomly selected from data [<xref rid="pcbi.1008978.ref002" ref-type="bibr">2</xref>], three methods in our package, including InnerProduct, fastHiCRep, and Selfish, finished within minutes. In contrast, original HiCRep, also implemented in Python, took around five hours. For InnerProduct, we further measured the time spent in the first scaling step and in the second multiplication step. It was observed that the run time from the “scaling” step was linear in terms of cell number <italic>n</italic>, whereas the run time from the “multiplication” step was quadratic in terms of cell number <italic>n</italic>.</p>
      <table-wrap id="pcbi.1008978.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008978.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Average run time (in seconds) of different methods as the number of cells vary.</title>
          <p>(Run time is averaged from 10 replicate experiments, performed on an Intel Xeon W-2175 CPU with a frequency of 2.50GHz).</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008978.t001g" xlink:href="pcbi.1008978.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1"># cells</th>
                <th align="center" rowspan="2" colspan="1">HiCRep</th>
                <th align="center" rowspan="2" colspan="1">fastHiCRep</th>
                <th align="center" colspan="3" rowspan="1">InnerProduct</th>
                <th align="center" rowspan="2" colspan="1">Selfish</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">Scaling</th>
                <th align="center" rowspan="1" colspan="1">Multiplication</th>
                <th align="center" rowspan="1" colspan="1">Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="char" char="." rowspan="1" colspan="1">267.91</td>
                <td align="char" char="." rowspan="1" colspan="1">0.05</td>
                <td align="char" char="." rowspan="1" colspan="1">0.05</td>
                <td align="char" char="." rowspan="1" colspan="1">0.03</td>
                <td align="char" char="." rowspan="1" colspan="1">0.08</td>
                <td align="char" char="." rowspan="1" colspan="1">0.11</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">200</td>
                <td align="char" char="." rowspan="1" colspan="1">1105.85</td>
                <td align="char" char="." rowspan="1" colspan="1">0.11</td>
                <td align="char" char="." rowspan="1" colspan="1">0.10</td>
                <td align="char" char="." rowspan="1" colspan="1">0.07</td>
                <td align="char" char="." rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">0.21</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">300</td>
                <td align="char" char="." rowspan="1" colspan="1">2470.76</td>
                <td align="char" char="." rowspan="1" colspan="1">0.19</td>
                <td align="char" char="." rowspan="1" colspan="1">0.14</td>
                <td align="char" char="." rowspan="1" colspan="1">0.10</td>
                <td align="char" char="." rowspan="1" colspan="1">0.24</td>
                <td align="char" char="." rowspan="1" colspan="1">0.36</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">400</td>
                <td align="char" char="." rowspan="1" colspan="1">4451.97</td>
                <td align="char" char="." rowspan="1" colspan="1">0.29</td>
                <td align="char" char="." rowspan="1" colspan="1">0.19</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.34</td>
                <td align="char" char="." rowspan="1" colspan="1">0.55</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">500</td>
                <td align="char" char="." rowspan="1" colspan="1">7025.12</td>
                <td align="char" char="." rowspan="1" colspan="1">0.41</td>
                <td align="char" char="." rowspan="1" colspan="1">0.25</td>
                <td align="char" char="." rowspan="1" colspan="1">0.23</td>
                <td align="char" char="." rowspan="1" colspan="1">0.48</td>
                <td align="char" char="." rowspan="1" colspan="1">0.80</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">600</td>
                <td align="char" char="." rowspan="1" colspan="1">10384.73</td>
                <td align="char" char="." rowspan="1" colspan="1">0.54</td>
                <td align="char" char="." rowspan="1" colspan="1">0.30</td>
                <td align="char" char="." rowspan="1" colspan="1">0.31</td>
                <td align="char" char="." rowspan="1" colspan="1">0.61</td>
                <td align="char" char="." rowspan="1" colspan="1">1.08</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">700</td>
                <td align="char" char="." rowspan="1" colspan="1">14366.02</td>
                <td align="char" char="." rowspan="1" colspan="1">0.70</td>
                <td align="char" char="." rowspan="1" colspan="1">0.37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.44</td>
                <td align="char" char="." rowspan="1" colspan="1">0.80</td>
                <td align="char" char="." rowspan="1" colspan="1">1.41</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">800</td>
                <td align="char" char="." rowspan="1" colspan="1">18944.04</td>
                <td align="char" char="." rowspan="1" colspan="1">0.87</td>
                <td align="char" char="." rowspan="1" colspan="1">0.40</td>
                <td align="char" char="." rowspan="1" colspan="1">0.58</td>
                <td align="char" char="." rowspan="1" colspan="1">0.94</td>
                <td align="char" char="." rowspan="1" colspan="1">1.79</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">900</td>
                <td align="char" char="." rowspan="1" colspan="1">23878.24</td>
                <td align="char" char="." rowspan="1" colspan="1">1.10</td>
                <td align="char" char="." rowspan="1" colspan="1">0.49</td>
                <td align="char" char="." rowspan="1" colspan="1">0.82</td>
                <td align="char" char="." rowspan="1" colspan="1">1.30</td>
                <td align="char" char="." rowspan="1" colspan="1">2.21</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1000</td>
                <td align="char" char="." rowspan="1" colspan="1">28335.26</td>
                <td align="char" char="." rowspan="1" colspan="1">1.32</td>
                <td align="char" char="." rowspan="1" colspan="1">0.55</td>
                <td align="char" char="." rowspan="1" colspan="1">0.98</td>
                <td align="char" char="." rowspan="1" colspan="1">1.53</td>
                <td align="char" char="." rowspan="1" colspan="1">2.70</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec013">
      <title>Linear convolution smoothing and random walk improve projection at high dropout rates</title>
      <p>To examine the three smoothing approaches implemented in our toolbox, we sparsified the scHi-C dataset [<xref rid="pcbi.1008978.ref002" ref-type="bibr">2</xref>] with two methods. The first sparsification method is to remove 40% ∼ 99.9% of the contacts randomly from all genomic positions (i.e., contact number ranging from ∼200,000 to ∼500 in each cell). The second sparsification method is to simulate dropout events in sequencing data which discard contacts from 5% ∼ 60% of the genomic loci. With the sparsified datasets, we examined the quality of single cell embedding when different smoothing approaches were used. It was observed that none of the three smoothing methods, including linear convolution, random walk, and network enhancing, improved the embedding performance when the single cell contact maps were down-sampled by the first sparsification method (<xref ref-type="fig" rid="pcbi.1008978.g005">Fig 5a</xref>). The ACROC decreased from around 0.9 to around 0.6 as down-sampling rate changed from 1 to 0.05. Under the second sparsification method (dropout), linear convolution and random walk produced better single cell embedding, compared with the situation when no smoothing was used (<xref ref-type="fig" rid="pcbi.1008978.g005">Fig 5b</xref>). At a high dropout rate (0.7), linear convolution kept the average ACROC above 0.9, whereas other methods’ average ACROC’s dropped to below 0.9. Therefore, we recommend users use linear convolution to smooth scHi-C contact maps if they suspect dropout events exist moderately in their scHi-C data.</p>
      <fig id="pcbi.1008978.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008978.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Average ACROC measures from InnerProduct without any smoothing, InnerProduct with random walk smoothing, InnerProduct with linear convolution, and InnerProduct with network enhancing.</title>
          <p>(a) When the dataset was sparsified with the first sparsification method, ACROC measures from the four approaches decreased when down-sampling rate increased. (b) When the dataset was sparsified with the second sparsification method, ACROC measures from the four approaches decreased when down-sampling rate increased, but at a high dropout rate (0.7), linear convolution’s ACROC remained high, whereas other methods’ ACROC dropped to below 0.9.</p>
        </caption>
        <graphic xlink:href="pcbi.1008978.g005"/>
      </fig>
    </sec>
    <sec id="sec014">
      <title>scHiCluster produces better clustering results than InnerProduct coupled with spectral clustering or with <italic>k</italic>-means, but less efficient</title>
      <p><xref rid="pcbi.1008978.t002" ref-type="table">Table 2</xref> shows the performance of different clustering methods implemented in <bold>scHiCTools</bold> on the dataset of Collombet et al., 2020 [<xref rid="pcbi.1008978.ref019" ref-type="bibr">19</xref>]. We use all 750 mouse embryo cells at five differentiation stages in the study of Collombet et al., including the 1-cell, 2-cell, 4-cell, 8-cell, and 64-cell stages. We separate the cells into five clusters and evaluate the clusters using two evaluation measures, including normalized mutual information (NMI) [<xref rid="pcbi.1008978.ref020" ref-type="bibr">20</xref>], and adjusted rand index (ARI) [<xref rid="pcbi.1008978.ref021" ref-type="bibr">21</xref>]. A better clustering produces larger values of NMI and ARI. For random clustering, the values of NMI and ARI are close to 0. When the cluster agrees with the true label, NMI and ARI reach the upper bound 1. scHiCluster shows better NMI and ARI values than InnerProduct with <italic>k</italic>-means and InnerProduct with spectral clustering. InnerProduct with <italic>k</italic>-means and InnerProduct with spectral clustering are more efficient than scHiCluster. The run time of scHiCluster, InnerProduct with <italic>k</italic>-means, Selfish, and InnerProduct with spectral clustering was measured on an Intel Xeon W-2175 CPU with a frequency of 2.50GHz. Each experiment was replicated ten times, and the average run time was reported (Run time from different replicate experiments showed little variance. See <xref ref-type="supplementary-material" rid="pcbi.1008978.s005">S5 File</xref> for more details).</p>
      <table-wrap id="pcbi.1008978.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008978.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The normalized mutual information (NMI), adjusted rand index (ARI), and run time of three clustering approaches.</title>
          <p>(Data: 750 embryo cells at five differentiation stages, including 1-cell, 2-cell, 4-cell, 8-cell and 64-cell stages, Collombet et al., 2020).</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008978.t002g" xlink:href="pcbi.1008978.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">NMI</th>
                <th align="center" rowspan="1" colspan="1">ARI</th>
                <th align="center" rowspan="1" colspan="1">Average run time (in seconds)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">scHiCluster</td>
                <td align="char" char="." rowspan="1" colspan="1">0.266</td>
                <td align="char" char="." rowspan="1" colspan="1">0.259</td>
                <td align="char" char="." rowspan="1" colspan="1">114.421</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">InnerProduct+MDS+<italic>k</italic>-means</td>
                <td align="char" char="." rowspan="1" colspan="1">0.222</td>
                <td align="char" char="." rowspan="1" colspan="1">0.208</td>
                <td align="char" char="." rowspan="1" colspan="1">1.771</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">InnerProduct+spectral clustering</td>
                <td align="char" char="." rowspan="1" colspan="1">0.241</td>
                <td align="char" char="." rowspan="1" colspan="1">0.197</td>
                <td align="char" char="." rowspan="1" colspan="1">1.531</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
  </sec>
  <sec id="sec015">
    <title>Availability and future directions</title>
    <p>Our scHiCTools is implemented in Python. The source code is available and maintained at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/liu-bioinfo-lab/scHiCTools">https://github.com/liu-bioinfo-lab/scHiCTools</ext-link>. This package is also available on PyPI python package manager. The current code runs under Python 3.7 or newer versions. Other dependency includes numpy, scipy, matplotlib, pandas, simplejson, six, and h5py. For the interactive scatter plot function, you need to have plotly installed. In the future, we will keep updating the toolbox with new scHi-C analysis algorithms, including new embedding methods such as UMAP and new clustering methods such as hierarchical clustering.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec016">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008978.s001">
      <label>S1 File</label>
      <caption>
        <title>Plots from different similarity measures and embedding methods applied to Nagano single-cell dataset.</title>
        <p>This zip file includes the plots of other combination of similarity measures (InnerProduct, fastHiCRep and Selfish) and embedding methods (MDS, <italic>t</italic>-SNE and PHATE).</p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pcbi.1008978.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008978.s002">
      <label>S2 File</label>
      <caption>
        <title>Three-dimensional scatter plots.</title>
        <p>This zip file includes the 3D scatter plots of different embedding methods (MDS, <italic>t</italic>-SNE and PHATE) applied to Nagano single-cell dataset.</p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pcbi.1008978.s002.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008978.s003">
      <label>S3 File</label>
      <caption>
        <title>Interactive plots.</title>
        <p>This file includes examples of interactive 2D and 3D scatter plots of cells from Nagano et al.</p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pcbi.1008978.s003.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008978.s004">
      <label>S4 File</label>
      <caption>
        <title>scHiCTools source code, documentation and test dataset.</title>
        <p>This zip file is a clone of scHiCTools public Git repository. To install from this file rather than from PyPI, please follow installation instructions in the readme file.</p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pcbi.1008978.s004.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008978.s005">
      <label>S5 File</label>
      <caption>
        <title>Run time details.</title>
        <p>This PDF file includes the run time of similarity calculation methods and clustering methods.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008978.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008978.s006">
      <label>S6 File</label>
      <caption>
        <title>Details of applying our toolbox to Flyamer et al. [<xref rid="pcbi.1008978.ref001" ref-type="bibr">1</xref>], Collombet et al. [<xref rid="pcbi.1008978.ref019" ref-type="bibr">19</xref>] and Ramani et al. [<xref rid="pcbi.1008978.ref003" ref-type="bibr">3</xref>] datasets.</title>
        <p>This PDF file includes the number of cells and the contacts numbers of Flyamer et al., Collombet et al. and Ramani et al. datasets, and their scatter plots.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008978.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008978.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Flyamer</surname><given-names>IM</given-names></name>, <name><surname>Gassler</surname><given-names>J</given-names></name>, <name><surname>Imakaev</surname><given-names>M</given-names></name>, <name><surname>Brandão</surname><given-names>HB</given-names></name>, <name><surname>Ulianov</surname><given-names>SV</given-names></name>, <name><surname>Abdennur</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Single-nucleus Hi-C reveals unique chromatin reorganization at oocyte-to-zygote transition</article-title>. <source>Nature</source>. <year>2017</year>;<volume>544</volume>(<issue>7648</issue>):<fpage>110</fpage>. <pub-id pub-id-type="doi">10.1038/nature21711</pub-id><?supplied-pmid 28355183?><pub-id pub-id-type="pmid">28355183</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Nagano</surname><given-names>T</given-names></name>, <name><surname>Lubling</surname><given-names>Y</given-names></name>, <name><surname>Várnai</surname><given-names>C</given-names></name>, <name><surname>Dudley</surname><given-names>C</given-names></name>, <name><surname>Leung</surname><given-names>W</given-names></name>, <name><surname>Baran</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Cell-cycle dynamics of chromosomal organization at single-cell resolution</article-title>. <source>Nature</source>. <year>2017</year>;<volume>547</volume>(<issue>7661</issue>):<fpage>61</fpage>. <pub-id pub-id-type="doi">10.1038/nature23001</pub-id><?supplied-pmid 28682332?><pub-id pub-id-type="pmid">28682332</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Ramani</surname><given-names>V</given-names></name>, <name><surname>Deng</surname><given-names>X</given-names></name>, <name><surname>Qiu</surname><given-names>R</given-names></name>, <name><surname>Gunderson</surname><given-names>KL</given-names></name>, <name><surname>Steemers</surname><given-names>FJ</given-names></name>, <name><surname>Disteche</surname><given-names>CM</given-names></name>, <etal>et al</etal>. <article-title>Massively multiplex single-cell Hi-C</article-title>. <source>Nature Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>3</issue>):<fpage>263</fpage>–<lpage>266</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4155</pub-id><?supplied-pmid 28135255?><pub-id pub-id-type="pmid">28135255</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>D</given-names></name>, <name><surname>Yardımcı</surname><given-names>GG</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Unsupervised embedding of single-cell Hi-C data</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>13</issue>):<fpage>i96</fpage>–<lpage>i104</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty285</pub-id><?supplied-pmid 29950005?><pub-id pub-id-type="pmid">29950005</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>T</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>, <name><surname>Ymcı</surname><given-names>GG</given-names></name>, <name><surname>Song</surname><given-names>F</given-names></name>, <name><surname>Hardison</surname><given-names>RC</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>, <etal>et al</etal>. <article-title>HiCRep: assessing the reproducibility of Hi-C data using a stratum-adjusted correlation coefficient</article-title>. <source>Genome Research</source>. <year>2017</year>;<volume>27</volume>(<issue>11</issue>):<fpage>1939</fpage>–<lpage>1949</lpage>. <pub-id pub-id-type="doi">10.1101/gr.220640.117</pub-id><?supplied-pmid 28855260?><pub-id pub-id-type="pmid">28855260</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Ursu</surname><given-names>O</given-names></name>, <name><surname>Boley</surname><given-names>N</given-names></name>, <name><surname>Taranova</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>YR</given-names></name>, <name><surname>Yardimci</surname><given-names>GG</given-names></name>, <name><surname>Stafford Noble</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>GenomeDISCO: A concordance score for chromosome conformation capture experiments using random walks on contact map graphs</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>16</issue>):<fpage>2701</fpage>–<lpage>2707</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty164</pub-id><?supplied-pmid 29554289?><pub-id pub-id-type="pmid">29554289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Yan</surname><given-names>KK</given-names></name>, <name><surname>Ymcı</surname><given-names>GG</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>. <article-title>HiC-Spector: A matrix library for spectral analysis and reproducibility of Hi-C contact maps</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>14</issue>):<fpage>2199</fpage>–<lpage>2201</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx152</pub-id><?supplied-pmid 28369339?><pub-id pub-id-type="pmid">28369339</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Sauria</surname><given-names>MEG</given-names></name>, <name><surname>Taylor</surname><given-names>J</given-names></name>. <article-title>QuASAR: Quality Assessment of Spatial Arrangement Reproducibility in Hi-C Data</article-title>. <source>bioRxiv</source>. <year>2017</year>;.</mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Yardımcı</surname><given-names>GG</given-names></name>, <name><surname>Ozadam</surname><given-names>H</given-names></name>, <name><surname>Sauria</surname><given-names>ME</given-names></name>, <name><surname>Ursu</surname><given-names>O</given-names></name>, <name><surname>Yan</surname><given-names>KK</given-names></name>, <name><surname>Yang</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Measuring the reproducibility and quality of Hi-C data</article-title>. <source>Genome biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>57</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1658-7</pub-id><?supplied-pmid 30890172?><pub-id pub-id-type="pmid">30890172</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Ardakany</surname><given-names>AR</given-names></name>, <name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Lonardi</surname><given-names>S</given-names></name>. <article-title>Selfish: discovery of differential chromatin interactions via a self-similarity measure</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>14</issue>):<fpage>i145</fpage>–<lpage>i153</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz362</pub-id><?supplied-pmid 31510653?><pub-id pub-id-type="pmid">31510653</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>B</given-names></name>, <name><surname>Pourshafeie</surname><given-names>A</given-names></name>, <name><surname>Zitnik</surname><given-names>M</given-names></name>, <name><surname>Zhu</surname><given-names>J</given-names></name>, <name><surname>Bustamante</surname><given-names>CD</given-names></name>, <name><surname>Batzoglou</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Network enhancement as a general method to denoise weighted biological networks</article-title>. <source>Nature communications</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>3108</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-018-05469-x</pub-id><?supplied-pmid 30082777?><pub-id pub-id-type="pmid">30082777</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Cowen</surname><given-names>L</given-names></name>, <name><surname>Ideker</surname><given-names>T</given-names></name>, <name><surname>Raphael</surname><given-names>BJ</given-names></name>, <name><surname>Sharan</surname><given-names>R</given-names></name>. <article-title>Network propagation: a universal amplifier of genetic associations</article-title>. <source>Nature Reviews Genetics</source>. <year>2017</year>;<volume>18</volume>(<issue>9</issue>):<fpage>551</fpage>–<lpage>562</lpage>. <pub-id pub-id-type="doi">10.1038/nrg.2017.38</pub-id><?supplied-pmid 28607512?><pub-id pub-id-type="pmid">28607512</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Knight</surname><given-names>PA</given-names></name>, <name><surname>Ruiz</surname><given-names>D</given-names></name>. <article-title>A fast algorithm for matrix balancing</article-title>. <source>IMA Journal of Numerical Analysis</source>. <year>2013</year>;<volume>33</volume>(<issue>3</issue>):<fpage>1029</fpage>–<lpage>1047</lpage>. <pub-id pub-id-type="doi">10.1093/imanum/drs019</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Maaten</surname><given-names>Lvd</given-names></name>, <name><surname>Hinton</surname><given-names>G</given-names></name>. <article-title>Visualizing Data using t-SNE</article-title>. <source>Journal of Machine Learning Research</source>. <year>2008</year>;<volume>9</volume>(<issue>Nov</issue>):<fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Moon</surname><given-names>KR</given-names></name>, <name><surname>van Dijk</surname><given-names>D</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Gigante</surname><given-names>S</given-names></name>, <name><surname>Burkhardt</surname><given-names>DB</given-names></name>, <name><surname>Chen</surname><given-names>WS</given-names></name>, <etal>et al</etal>. <article-title>Visualizing structure and transitions in high-dimensional biological data</article-title>. <source>Nature Biotechnology</source>. <year>2019</year>;<volume>37</volume>(<issue>12</issue>):<fpage>1482</fpage>–<lpage>1492</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0336-3</pub-id><?supplied-pmid 31796933?><pub-id pub-id-type="pmid">31796933</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref016">
      <label>16</label>
      <mixed-citation publication-type="book"><name><surname>Arthur</surname><given-names>D</given-names></name>, <name><surname>Vassilvitskii</surname><given-names>S</given-names></name>. <source>k-means++: The Advantages of Careful Seeding</source>. <publisher-name>Stanford InfoLab</publisher-name>; <year>2006</year>. <fpage>2006</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>von Luxburg</surname><given-names>U</given-names></name>. <article-title>A tutorial on spectral clustering</article-title>. <source>Statistics and Computing</source>. <year>2007</year>;<volume>17</volume>(<issue>4</issue>):<fpage>395</fpage>–<lpage>416</lpage>. <pub-id pub-id-type="doi">10.1007/s11222-007-9033-z</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>J</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Cheng</surname><given-names>C</given-names></name>, <name><surname>Bao</surname><given-names>B</given-names></name>, <name><surname>Peng</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Robust single-cell Hi-C clustering by convolution- and random-walk–based imputation</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2019</year>;<volume>116</volume>(<issue>28</issue>):<fpage>14011</fpage>–<lpage>14018</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1901423116</pub-id><?supplied-pmid 31235599?><pub-id pub-id-type="pmid">31235599</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Collombet</surname><given-names>S</given-names></name>, <name><surname>Ranisavljevic</surname><given-names>N</given-names></name>, <name><surname>Nagano</surname><given-names>T</given-names></name>, <name><surname>Varnai</surname><given-names>C</given-names></name>, <name><surname>Shisode</surname><given-names>T</given-names></name>, <name><surname>Leung</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Parental-to-embryo switch of chromosome organization in early embryogenesis</article-title>. <source>Nature</source>. <year>2020</year>;<volume>580</volume>(<issue>7801</issue>):<fpage>142</fpage>–<lpage>146</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-020-2125-z</pub-id><?supplied-pmid 32238933?><pub-id pub-id-type="pmid">32238933</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Strehl</surname><given-names>A</given-names></name>, <name><surname>Ghosh</surname><given-names>J</given-names></name>. <article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2003</year>;<volume>3</volume>(<issue>null</issue>):<fpage>583</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008978.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Hubert</surname><given-names>L</given-names></name>, <name><surname>Arabie</surname><given-names>P</given-names></name>. <article-title>Comparing partitions</article-title>. <source>Journal of Classification</source>. <year>1985</year>;<volume>2</volume>(<issue>1</issue>):<fpage>193</fpage>–<lpage>218</lpage>. <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
