<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1-mathml3.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Ecol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Ecol Evol</journal-id>
    <journal-id journal-id-type="doi">10.1002/(ISSN)2045-7758</journal-id>
    <journal-id journal-id-type="publisher-id">ECE3</journal-id>
    <journal-title-group>
      <journal-title>Ecology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-7758</issn>
    <publisher>
      <publisher-name>John Wiley and Sons Inc.</publisher-name>
      <publisher-loc>Hoboken</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8601886</article-id>
    <article-id pub-id-type="doi">10.1002/ece3.8129</article-id>
    <article-id pub-id-type="publisher-id">ECE38129</article-id>
    <article-categories>
      <subj-group subj-group-type="overline">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The <monospace>forestecology</monospace> R package for fitting and assessing neighborhood models of the effect of interspecific competition on the growth of trees</article-title>
      <alt-title alt-title-type="left-running-head">KIM et al.</alt-title>
    </title-group>
    <contrib-group>
      <contrib id="ece38129-cr-0001" contrib-type="author" corresp="yes">
        <name>
          <surname>Kim</surname>
          <given-names>Albert Y.</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7824-306X</contrib-id>
        <xref rid="ece38129-aff-0001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <address>
          <email>akim04@smith.edu</email>
        </address>
      </contrib>
      <contrib id="ece38129-cr-0002" contrib-type="author">
        <name>
          <surname>Allen</surname>
          <given-names>David N.</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0712-9603</contrib-id>
        <xref rid="ece38129-aff-0002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib id="ece38129-cr-0003" contrib-type="author">
        <name>
          <surname>Couch</surname>
          <given-names>Simon P.</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5676-5107</contrib-id>
        <xref rid="ece38129-aff-0003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="ece38129-aff-0001">
      <label>
        <sup>1</sup>
      </label>
      <named-content content-type="organisation-division">Program in Statistical &amp; Data Sciences</named-content>
      <institution>Smith College</institution>
      <city>Northampton</city>
      <named-content content-type="country-part">MA</named-content>
      <country country="US">USA</country>
    </aff>
    <aff id="ece38129-aff-0002">
      <label>
        <sup>2</sup>
      </label>
      <named-content content-type="organisation-division">Biology Department</named-content>
      <institution>Middlebury College</institution>
      <city>Middlebury</city>
      <named-content content-type="country-part">VT</named-content>
      <country country="US">USA</country>
    </aff>
    <aff id="ece38129-aff-0003">
      <label>
        <sup>3</sup>
      </label>
      <named-content content-type="organisation-division">Department of Biostatistics</named-content>
      <institution>Johns Hopkins University</institution>
      <city>Baltimore</city>
      <named-content content-type="country-part">MD</named-content>
      <country country="US">USA</country>
    </aff>
    <author-notes>
      <corresp id="correspondenceTo"><label>*</label><bold>Correspondence</bold><break/>
Albert Y. Kim, Program in Statistical &amp; Data Sciences, Smith College, Northampton MA, USA.<break/>
Email: <email>akim04@smith.edu</email>
<break/>
</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <issue seq="100">22</issue>
    <issue-id pub-id-type="doi">10.1002/ece3.v11.22</issue-id>
    <fpage>15556</fpage>
    <lpage>15572</lpage>
    <history>
      <date date-type="rev-recd">
        <day>11</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="received">
        <day>21</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <!--&#x000a9; 2021 Published by John Wiley & Sons Ltd.-->
      <copyright-statement content-type="article-copyright">© 2021 The Authors. <italic toggle="yes">Ecology and Evolution</italic> published by John Wiley &amp; Sons Ltd.</copyright-statement>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link> License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="file:ECE3-11-15556.pdf"/>
    <abstract id="ece38129-abs-0001">
      <title>Abstract</title>
      <p>
        <list list-type="order" id="ece38129-list-0001">
          <list-item>
            <p>Neighborhood competition models are powerful tools to measure the effect of interspecific competition. Statistical methods to ease the application of these models are currently lacking.</p>
          </list-item>
          <list-item>
            <p>We present the <monospace>forestecology</monospace> package providing methods to (a) specify neighborhood competition models, (b) evaluate the effect of competitor species identity using permutation tests, and (cs) measure model performance using spatial cross‐validation. Following Allen and Kim <italic toggle="yes">(PLoS One, 15,</italic> 2020, e0229930), we implement a Bayesian linear regression neighborhood competition model.</p>
          </list-item>
          <list-item>
            <p>We demonstrate the package's functionality using data from the Smithsonian Conservation Biology Institute's large forest dynamics plot, part of the ForestGEO global network of research sites. Given ForestGEO’s data collection protocols and data formatting standards, the package was designed with cross‐site compatibility in mind. We highlight the importance of spatial cross‐validation when interpreting model results.</p>
          </list-item>
          <list-item>
            <p>The package features (a) tidyverse‐like structure whereby verb‐named functions can be modularly “piped” in sequence, (b) functions with standardized inputs/outputs of simple features <monospace>sf</monospace> package class, and (c) an S3 object‐oriented implementation of the Bayesian linear regression model. These three facts allow for clear articulation of all the steps in the sequence of analysis and easy wrangling and visualization of the geospatial data. Furthermore, while the package only has Bayesian linear regression implemented, the package was designed with extensibility to other methods in mind.</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="graphical" id="ece38129-abs-0002">
      <p>Schematic of spatial cross‐validation. Using the <italic toggle="yes">k</italic> = 1 fold (bottom‐left) as the test set, <italic toggle="yes">k</italic> = 2 through 4 as the training set, along with a “fold buffer” extending outward from the test set to maintain spatial independence between it and the training set.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0001"><graphic xlink:href="ECE3-11-15556-g009.jpg" position="anchor" id="jats-graphic-1"/></boxed-text>
</p>
    </abstract>
    <kwd-group>
      <kwd id="ece38129-kwd-0001">forest ecology</kwd>
      <kwd id="ece38129-kwd-0002">ForestGEO</kwd>
      <kwd id="ece38129-kwd-0003">interspecific competition</kwd>
      <kwd id="ece38129-kwd-0004">neighborhood competition</kwd>
      <kwd id="ece38129-kwd-0005">R</kwd>
      <kwd id="ece38129-kwd-0006">spatial cross‐validation</kwd>
      <kwd id="ece38129-kwd-0007">tree growth</kwd>
    </kwd-group>
    <counts>
      <fig-count count="32"/>
      <table-count count="0"/>
      <page-count count="17"/>
      <word-count count="6057"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>source-schema-version-number</meta-name>
        <meta-value>2.0</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>November 2021</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>details-of-publishers-convertor</meta-name>
        <meta-value>Converter:WILEY_ML3GV2_TO_JATSPMC version:6.0.9 mode:remove_FC converted:18.11.2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <p content-type="self-citation">
      <mixed-citation publication-type="journal" id="ece38129-cit-1001"><string-name><surname>Kim</surname>, <given-names>A. Y.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>D. N.</given-names></string-name>, &amp; <string-name><surname>Couch</surname>, <given-names>S. P.</given-names></string-name> (<year>2021</year>). <article-title>The <monospace>forestecology</monospace> R package for fitting and assessing neighborhood models of the effect of interspecific competition on the growth of trees</article-title>. <source>Ecology and Evolution</source>, <volume>11</volume>, <fpage>15556</fpage>–<lpage>15572</lpage>. <pub-id pub-id-type="doi">10.1002/ece3.8129</pub-id>
</mixed-citation>
    </p>
  </notes>
</front>
<body id="ece38129-body-0001">
  <sec id="ece38129-sec-0001">
    <label>1</label>
    <title>INTRODUCTION</title>
    <p>Repeat‐censused forest plots offer excellent opportunities to test neighborhood models of the effect of competition on the growth of trees (Canham et al., <xref rid="ece38129-bib-0007" ref-type="bibr">2004</xref>). Neighborhood models of competition have been used to test whether the species identity of a competitor matters Uriarte et al. (<xref rid="ece38129-bib-0025" ref-type="bibr">2004</xref>); measure species‐specific competition coefficients (Das, <xref rid="ece38129-bib-0009" ref-type="bibr">2012</xref>; Tatsumi et al., <xref rid="ece38129-bib-0024" ref-type="bibr">2016</xref>); test competing models to see what structures competitive interactions, for example, traits or phylogeny (Allen &amp; Kim, <xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>; Uriarte et al., <xref rid="ece38129-bib-0026" ref-type="bibr">2010</xref>); and inform selective logging practices (Canham et al., <xref rid="ece38129-bib-0008" ref-type="bibr">2006</xref>). Although these are well‐described methods, few methods are currently available for easy application.</p>
    <p>We address this shortcoming with the <monospace>forestecology</monospace> R package providing methods and data for forest ecology model fitting and assessment, available on CRAN (<ext-link xlink:href="https://cran.r-project.org/package=forestecology" ext-link-type="uri">https://cran.r‐project.org/package=forestecology</ext-link>) and on GitHub (<ext-link xlink:href="https://github.com/rudeboybert/forestecology" ext-link-type="uri">https://github.com/rudeboybert/forestecology</ext-link>). The package is written to model stem diameter growth between two censuses based on neighborhood competition, largely following the methods in Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>).</p>
    <p>Let <italic toggle="yes">i</italic> = 1,…, <italic toggle="yes">n<sub>j</sub>
</italic> index all <italic toggle="yes">n<sub>j</sub>
</italic> trees of “focal” species <italic toggle="yes">j</italic>; let <italic toggle="yes">j</italic> = 1,…, <italic toggle="yes">J</italic> index all <italic toggle="yes">J</italic> focal species; and let <italic toggle="yes">k</italic> = 1,…, <italic toggle="yes">K</italic> index all <italic toggle="yes">K</italic> “competitor” species. The average annual growth in diameter at breast height (DBH) <italic toggle="yes">y<sub>ij</sub>
</italic> (in centimeters/year) of the <italic toggle="yes">i</italic>
<sup>th</sup> tree of focal species <italic toggle="yes">j</italic> is modeled as<disp-formula id="ece38129-disp-0001"><label>(1)</label><mml:math id="jats-math-1" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mtext>dbh</mml:mtext><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mtext>dbh</mml:mtext><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="italic">jk</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ijk</mml:mi><mml:mtext>comp</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">β</italic>
<sub>0,</sub>
<italic toggle="yes"><sub>j</sub></italic> is the diameter‐independent growth rate of species <italic toggle="yes">j</italic>; <italic toggle="yes">dbh<sub>ij</sub>
</italic> is the DBH of the focal tree at the earlier census and <italic toggle="yes">β</italic>
<sub>dbh,</sub>
<italic toggle="yes"><sub>j</sub></italic> the slope of that species's diameter–growth relationship; <mml:math id="jats-math-2"><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ijk</mml:mi><mml:mtext>comp</mml:mtext></mml:msubsup></mml:math> is the sum of some numerical explanatory variable of all trees of competitor species <italic toggle="yes">k</italic>, and <italic toggle="yes">λ<sub>jk</sub>
</italic> quantifies the corresponding change in growth for individuals of species <italic toggle="yes">j</italic> from these competitors; and <italic toggle="yes">ε<sub>ij</sub>
</italic> is a random error term distributed Normal (0, <italic toggle="yes">σ</italic>
<sup>2</sup>).</p>
    <p>Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>) use the sum of the basal area of all trees of competitor species <italic toggle="yes">k</italic> as <mml:math id="jats-math-3"><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ijk</mml:mi><mml:mtext>comp</mml:mtext></mml:msubsup></mml:math>. Furthermore, they estimate all parameters via Bayesian linear regression, while exploiting Normal/Inverse Gamma conjugacy to derive closed‐form solutions to all posterior distributions.<xref rid="ece38129-note-1001" ref-type="fn"><sup>1</sup></xref> These closed‐form solutions are not as computationally expensive as approximations from Markov chain Monte Carlo algorithms.</p>
    <p>To evaluate whether competitor species identity matters, Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>) run a permutation test where a null hypothesis of no species grouping‐specific effects of competition is assumed; thus, the species identity of all competitors can be permuted:<disp-formula id="ece38129-disp-0002"><label>(2)</label><mml:math id="jats-math-4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="italic">jk</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>all</mml:mtext><mml:mspace width="0.277778em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mtext>vs</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>H</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mtext>at</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>least</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>one</mml:mtext><mml:mspace width="0.277778em"/><mml:msub><mml:mi>λ</mml:mi><mml:mi mathvariant="italic">jk</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>different</mml:mtext></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
</p>
    <p>Furthermore, to account for the spatial autocorrelation in their estimates of out‐of‐sample model error, Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>) use spatial cross‐validation. Estimates of model error that do not account for this dependence tend to underestimate the true model error (Roberts et al., <xref rid="ece38129-bib-0020" ref-type="bibr">2017</xref>).</p>
    <p>The package is designed with “tidy” design principles in mind (Wickham et al., <xref rid="ece38129-bib-0031" ref-type="bibr">2019</xref>). Much like all <monospace>tidyverse</monospace> packages, <monospace>forestecology</monospace> has verb‐named functions that can be modularly composed using the pipe <monospace>%&gt;%</monospace> operator to sequentially complete all necessary analysis steps (Bache &amp; Wickham, <xref rid="ece38129-bib-0004" ref-type="bibr">2020</xref>).</p>
    <p>Furthermore, the inputs and outputs of most functions use the same “simple features for R” data structures for spatial data from the <monospace>sf</monospace> package (Pebesma, <xref rid="ece38129-bib-0018" ref-type="bibr">2018</xref>). Previously, <monospace>sp</monospace> package classes were commonly used for storing spatial data and interfacing with geospatial libraries (Bivand et al., <xref rid="ece38129-bib-0005" ref-type="bibr">2013</xref>); the <monospace>sf</monospace> package aims to improve on the <monospace>sp</monospace> package by:
<list list-type="order" id="ece38129-list-0002"><list-item><p>Using simple feature access as the base standard for representing and encoding spatial data, rather than shapefiles (Herring, <xref rid="ece38129-bib-0014" ref-type="bibr">2011</xref>).</p></list-item><list-item><p>Leveraging improvements in external libraries for reading and writing spatial data (GDAL) and for geometrical operations (GEOS) (GEOS Development Team, <xref rid="ece38129-bib-0011" ref-type="bibr">2017</xref>; Warmerdam, <xref rid="ece38129-bib-0029" ref-type="bibr">2008</xref>).</p></list-item><list-item><p>Integrating closely with the popular <monospace>tidyverse</monospace> suite of packages for data science (Wickham et al., <xref rid="ece38129-bib-0031" ref-type="bibr">2019</xref>).</p></list-item></list>
</p>
    <p>By using the <monospace>sf</monospace> package classes to represent spatial data rather than the <monospace>sp</monospace> package, the implementation and use of the <monospace>forestecology</monospace> package's spatial algorithms was greatly simplified.</p>
  </sec>
  <sec id="ece38129-sec-0002">
    <label>2</label>
    <title><monospace>forestecology</monospace> WORKFLOW: A CASE STUDY</title>
    <p>We present a case study of <monospace>forestecology's</monospace> functionality on data from the Smithsonian Conservation Biology Institute (SCBI) large forest dynamics plot in Front Royal, VA, USA, part of the ForestGEO global network of research sites (Anderson‐Teixeira et al., <xref rid="ece38129-bib-0003" ref-type="bibr">2015</xref>; Bourg et al., <xref rid="ece38129-bib-0006" ref-type="bibr">2013</xref>; Davies et al., <xref rid="ece38129-bib-0010" ref-type="bibr">2021</xref>). The 25.6‐ha (640 × 400 m) plot is located at the intersection of three of the major physiographic provinces of the eastern United States—the Blue Ridge, Ridge and Valley, and Piedmont provinces—and is adjacent to the northern end of Shenandoah National Park.</p>
    <p>The package has the following goals: to evaluate (a) the effect of competitor species identity using permutation tests and (b) model performance using spatial cross‐validation. We outline the four‐step basic analysis sequence:
<list list-type="order" id="ece38129-list-0003"><list-item><p>Compute the growth of stems based on two censuses.</p></list-item><list-item><p>Add spatial information:
</p><list list-type="alpha-lower" id="ece38129-list-0004"><list-item><p>Define a buffer region of trees.</p></list-item><list-item><p>Add spatial cross‐validation block information.</p></list-item></list></list-item><list-item><p>Identify all focal trees and their competitors.</p></list-item><list-item><p>Apply model, which includes:
</p><list list-type="alpha-lower" id="ece38129-list-0005"><list-item><p>Fit model.</p></list-item><list-item><p>Compute predicted values.</p></list-item><list-item><p>Visualize posterior distributions.</p></list-item></list></list-item></list>
</p>
    <p>We start by loading all packages (all code in this paper can be copied from here <ext-link xlink:href="https://urldefense.com/v3/__https:/github.com/rudeboybert/forestecology/blob/master/paper/paper.R__;!!N11eV2iwtfs!8n71aLKCBnptraC-Fhk7bt8FdPqstZx59HOshfOPFcLZIjrJ9bom06mOfxDx0Dk$" ext-link-type="uri">https://github.com/rudeboybert/forestecology/blob/master/paper/paper.R</ext-link>).
<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0002"><graphic xlink:href="ECE3-11-15556-g013.jpg" position="anchor" id="jats-graphic-3"/></boxed-text>
</p>
    <sec id="ece38129-sec-0003">
      <label>2.1</label>
      <title>Step 1: Compute the growth of trees based on census data</title>
      <p>We first compute the growth of trees using data from two censuses. <monospace>compute_growth()</monospace> computes the average annual growth based on census data that roughly follows ForestGEO standards. Despite such standards, minor variations will still exist between sites, thereby necessitating some data wrangling. For example, the SCBI site records all DBH values in millimeters (Bourg et al., <xref rid="ece38129-bib-0006" ref-type="bibr">2013</xref>), whereas the Michigan Big Woods site used in Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>) records them in centimeters (Allen et al., <xref rid="ece38129-bib-0001" ref-type="bibr">2020</xref>).</p>
      <p>We load both 2008 and 2014 SCBI census.csv files as they existed on GitHub on 2021/08/02 and perform minor data wrangling (Gonzalez‐Akre, McGregor, et al., <xref rid="ece38129-bib-0012" ref-type="bibr">2020</xref>). We then only consider a 9‐ha subsection of the 25.6 ha of the site to speed up computation for this example: gx from 0–300 instead of 0–400 and gy from 300–600 instead of 0–640.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0003"><graphic xlink:href="ECE3-11-15556-g028.jpg" position="anchor" id="jats-graphic-5"/></boxed-text>
</p>
      <p>These two data frames are then used as inputs to <monospace>compute_growth()</monospace>, along with id specifying the variable that uniquely identifies each tree‐stem. We also discard all resprouts with <monospace>code == R</monospace> in the later census, since we are only interested in the growth of surviving, and not resprouted, stems.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0004"><graphic xlink:href="ECE3-11-15556-g030.jpg" position="anchor" id="jats-graphic-7"/></boxed-text>
</p>
      <p>The output growth_scbi is a data frame of class sf that includes among other variables the species variable sp converted to a factor, the average annual growth in DBH (cm·y<sup>−1</sup>) for all stems that were alive at both time points, and the <monospace>sf</monospace> package's encoding of geolocations of geometry type <monospace>&lt;POINT&gt;</monospace>. Given that <monospace>growth_scbi</monospace> is of class <monospace>sf</monospace>, it can be easily plotted in ggplot2 using <monospace>geom_sf()</monospace> as seen in Figure <xref rid="ece38129-fig-0001" ref-type="fig">1</xref>.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0005"><graphic xlink:href="ECE3-11-15556-g021.jpg" position="anchor" id="jats-graphic-9"/></boxed-text>
</p>
      <fig position="float" fig-type="FIGURE" id="ece38129-fig-0001">
        <label>FIGURE 1</label>
        <caption>
          <p>Step 1—Compute growth of trees based on census data. A map of the growth of a random sample of 500 trees from a 9‐ha subsection of the Smithsonian Conservation Biology Institute (SCBI) forest plot</p>
        </caption>
        <graphic xlink:href="ECE3-11-15556-g010" position="anchor" id="jats-graphic-11"/>
      </fig>
      <p>We also load species information as it existed on GitHub on 2021/08/02, which includes family, genus, and species information, as well as classifications of the canopy position (canopy, canopy emergent, understory, shrub layer), drought tolerance (intolerant, resistant), and other characteristics of the species.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0006"><graphic xlink:href="ECE3-11-15556-g019.jpg" position="anchor" id="jats-graphic-13"/></boxed-text>
</p>
      <p>We join this species information to our growth_scbi data frame and convert the species variable to a factor.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0007"><graphic xlink:href="ECE3-11-15556-g008.jpg" position="anchor" id="jats-graphic-15"/></boxed-text>
</p>
      <p>Furthermore, we compute two potential competitor explanatory variables <mml:math id="jats-math-5"><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ijk</mml:mi><mml:mtext>comp</mml:mtext></mml:msubsup></mml:math> from Equation <xref rid="ece38129-disp-0001" ref-type="disp-formula">1</xref>. First, the basal area of each tree as a function of its DBH in the earlier census. Second, the aboveground biomass as estimated by allometric equations encoded in the <monospace>get_biomass()</monospace> function from the <monospace>allodb</monospace> package (Gonzalez‐Akre et al., <xref rid="ece38129-bib-0013" ref-type="bibr">2020</xref>); this function has DBH, species, and geographic coordinates as arguments.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0008"><graphic xlink:href="ECE3-11-15556-g015.jpg" position="anchor" id="jats-graphic-17"/></boxed-text>
</p>
    </sec>
    <sec id="ece38129-sec-0004">
      <label>2.2</label>
      <title>Step 2: Add spatial information</title>
      <p>We then add spatial information to <monospace>growth_scbi</monospace>. We first add a “buffer region” to the periphery of the study region. Since some of our model's explanatory variables are cumulative, we must ensure that all trees being modeled are not biased to have different neighbor structures. This is of concern for trees at the boundary of the study region who will not have all their neighbors included in the census stems. To account for such edge effects, only trees that are not part of this buffer region, that is, are part of the interior of the study region, will have their growth modeled (Waller &amp; Gotway, <xref rid="ece38129-bib-0028" ref-type="bibr">2004</xref>).</p>
      <p>Our model of interspecific competition relies on a spatial definition of who competitor trees are: all trees within a distance <monospace>comp_dist</monospace> of a focal tree. Here, we set <monospace>comp_dist</monospace> to 7.5m, a value informed by other studies (Canham et al., <xref rid="ece38129-bib-0007" ref-type="bibr">2004</xref>; Canham et al., <xref rid="ece38129-bib-0008" ref-type="bibr">2006</xref>; Uriarte et al., <xref rid="ece38129-bib-0025" ref-type="bibr">2004</xref>), but the package could also be used to compare multiple distances and see which is best supported (see Appendix <xref rid="ece38129-app-0001" ref-type="app">1</xref>). We use comp_dist and a manually constructed sf representation of the study region's boundary as inputs to <monospace>add_buffer_variable()</monospace> to add a buffer Boolean variable to <monospace>growth_scbi</monospace>. All trees with buffer equal to FALSE will be our focal trees whose growth will be modeled, whereas those with TRUE will only act as competitor trees.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0009"><graphic xlink:href="ECE3-11-15556-g006.jpg" position="anchor" id="jats-graphic-19"/></boxed-text>
</p>
      <p>The second element of spatial information we add are blocks corresponding to folds of a spatial cross‐validation algorithm. Conventional cross‐validation algorithms assign individual observations to folds by randomly resampling them all while assuming they are statistically independent. In the case of forest census data however, observations exhibit spatial autocorrelation. We therefore incorporate this dependence into the cross‐validation algorithm by resampling spatial blocks of trees (Pohjankukka et al., <xref rid="ece38129-bib-0019" ref-type="bibr">2017</xref>; Roberts et al., <xref rid="ece38129-bib-0020" ref-type="bibr">2017</xref>).</p>
      <p>We first manually define an <monospace>sf</monospace> object defining four folds that partition the study region. We then use the output of the <monospace>spatialBlock()</monospace> function from the <monospace>blockCV</monospace> package to associate each tree in <monospace>growth_scbi</monospace> to the correct <monospace>foldID</monospace> (Valavi et al., <xref rid="ece38129-bib-0027" ref-type="bibr">2019</xref>). This <monospace>foldID</monospace> variable will be used in Section <xref rid="ece38129-sec-0008" ref-type="sec">2.6</xref>.</p>
      <p>Figure <xref rid="ece38129-fig-0002" ref-type="fig">2</xref> illustrates the net effect of adding these two elements of spatial information to <monospace>growth_scbi</monospace>.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0010"><graphic xlink:href="ECE3-11-15556-g032.jpg" position="anchor" id="jats-graphic-21"/></boxed-text>
</p>
      <fig position="float" fig-type="FIGURE" id="ece38129-fig-0002">
        <label>FIGURE 2</label>
        <caption>
          <p>Step 2—Add spatial information. A buffer region and spatial cross‐validation blocks 1 through 4. The location of each tree is marked with its fold number where the folds are delineated with solid lines. The color of each digit indicates whether the tree is part of the buffer region (thus will only be considered as a competitor tree) or is part of the interior of the study region (thus is a focal tree whose growth is of modeled interest)</p>
        </caption>
        <graphic xlink:href="ECE3-11-15556-g001" position="anchor" id="jats-graphic-23"/>
      </fig>
    </sec>
    <sec id="ece38129-sec-0005">
      <label>2.3</label>
      <title>Step 3: Identify all focal and corresponding competitor trees</title>
      <p>We then identify all focal trees and their corresponding competitor trees and, more specifically, identify all trees that are not part of the buffer region, have a valid growth measurement, and have at least one neighbor within 7.5 m. We do this using <monospace>create_focal_vs_comp()</monospace>, which takes the previously detailed <monospace>comp_dist</monospace> and <monospace>id</monospace> arguments, the <monospace>sf</monospace> representation of the spatial cross‐validation blocks <monospace>blocks_scbi</monospace>, and a specification <monospace>comp_x_var</monospace> of the <monospace>basal_area</monospace> variable we use as the competitor explanatory variable <mml:math id="jats-math-6"><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ijk</mml:mi><mml:mtext>comp</mml:mtext></mml:msubsup></mml:math> from Equation <xref rid="ece38129-disp-0001" ref-type="disp-formula">1</xref>. This function returns a new data frame <monospace>focal_vs_comp_scbi</monospace>.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0011"><graphic xlink:href="ECE3-11-15556-g031.jpg" position="anchor" id="jats-graphic-25"/></boxed-text>
</p>
      <p>The resulting <monospace>focal_vs_comp_scbi</monospace> has 6,296 rows, representing the subset of the 7,954 trees in <monospace>growth_scbi</monospace> that will be considered as focal trees. The variables <monospace>focal_ID</monospace> and <monospace>focal_sp</monospace> relate to tree‐stem identification and species information. Most notably however is the variable <monospace>comp</monospace>, which contains information on all competitor trees saved in <monospace>tidyr</monospace> package list‐column format (Wickham, <xref rid="ece38129-bib-0030" ref-type="bibr">2020</xref>). To inspect this information, we flatten the comp list‐column for the tree with <monospace>focal_ID</monospace> 4 in the first row, here a tibble [20 × 4], into regular columns using <monospace>unnest()</monospace> from the <monospace>tidyr</monospace> package.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0012"><graphic xlink:href="ECE3-11-15556-g026.jpg" position="anchor" id="jats-graphic-27"/></boxed-text>
</p>
      <p>We observe 4 variables describing 20 competitor trees: the unique tree‐stem ID, the distance to the focal tree (all ≤7.5 m), the species, and the basal area (in m<sup>2</sup>) calculated as <mml:math id="jats-math-7"><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>DBH</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>10000</mml:mn></mml:mfrac></mml:math> for the DBH in cm from the earlier census. Saving competitor information in list‐column format minimizes redundancy since we do not need to repeat information on the focal tree 20 times. We visualize the spatial distribution of these trees in Figure <xref rid="ece38129-fig-0003" ref-type="fig">3</xref>.</p>
      <fig position="float" fig-type="FIGURE" id="ece38129-fig-0003">
        <label>FIGURE 3</label>
        <caption>
          <p>Step 3—Identify all focal and corresponding competitor trees. The dashed circle extends 7.5m away from the focal tree 4, while all 20 competitor trees are within this circle</p>
        </caption>
        <graphic xlink:href="ECE3-11-15556-g005" position="anchor" id="jats-graphic-29"/>
      </fig>
      <p>Here, we use basal area as the continuous competitor explanatory variable, but the package is flexible to allow the user to specify any competitor explanatory variable (basal area, biomass, tree height, a soil nutrient value). The package can also be used to compare competitor explanatory variables and see which best explains tree growth, see Appendix <xref rid="ece38129-app-0002" ref-type="app">2</xref> for an example comparing basal area and above‐ground biomass. Similarly, the package can use any categorical variable as an explanatory variable and compare between different categorical variables. For example, in Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>), we compare grouping individuals based on species, family, and based on trait‐based groups. In Appendix <xref rid="ece38129-app-0003" ref-type="app">3</xref>, we give another example and compare grouping individuals by species or by potential canopy position (canopy, understory, shrub layer).</p>
    </sec>
    <sec id="ece38129-sec-0006">
      <label>2.4</label>
      <title>Step 4: Fit model</title>
      <p>Lastly, we fit the competition Bayesian linear regression model for tree growth outlined in Equation <xref rid="ece38129-disp-0001" ref-type="disp-formula">1</xref> using <monospace>comp_bayes_lm()</monospace>. This function has an option to specify prior distributions of all parameters, chosen here to be the defaults detailed in <monospace>?comp_bayes_lm</monospace>.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0013"><graphic xlink:href="ECE3-11-15556-g004.jpg" position="anchor" id="jats-graphic-31"/></boxed-text>
</p>
      <p>The resulting <monospace>comp_bayes_lm_scbi</monospace> is an object of S3 class type <monospace>comp_bayes_lm</monospace> containing the posterior values of all parameters. Furthermore, this class includes generics for three methods. First, the generic for <monospace>print()</monospace> displays the names of all prior and posterior parameters and the model formula:<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0014"><graphic xlink:href="ECE3-11-15556-g003.jpg" position="anchor" id="jats-graphic-33"/></boxed-text>
</p>
      <p>Next, the generic for <monospace>predict()</monospace> takes the posterior parameter values in <monospace>comp_bayes_lm_scbi</monospace> and a newdata data frame and outputs a vector <monospace>growth_hat</monospace> of predicted DBH values <mml:math id="jats-math-8"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math> computed from the posterior predictive distribution.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0015"><graphic xlink:href="ECE3-11-15556-g011.jpg" position="anchor" id="jats-graphic-35"/></boxed-text>
</p>
      <p>We can now compare the observed and predicted growths to compute the root mean squared error (RMSE) of our model:<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0016"><graphic xlink:href="ECE3-11-15556-g014.jpg" position="anchor" id="jats-graphic-37"/></boxed-text>
</p>
      <p>Lastly, the generic for <monospace>ggplot2::autoplot()</monospace> allows us to visualize all posterior distributions, as seen in Figure <xref rid="ece38129-fig-0004" ref-type="fig">4</xref>. Setting <monospace>type</monospace> to “<monospace>intercepts</monospace>” and “<monospace>dbh_slopes</monospace>” returns species‐specific posterior distributions for <italic toggle="yes">β</italic>
<sub>0,</sub>
<italic toggle="yes"><sub>j</sub></italic> and <italic toggle="yes">β</italic>
<sub>dbh,</sub>
<italic toggle="yes"><sub>j</sub></italic>, respectively, while setting <monospace>type =</monospace> “<monospace>competition</monospace>” returns competition coefficients <italic toggle="yes">λ<sub>j,k</sub>
</italic>.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0017"><graphic xlink:href="ECE3-11-15556-g023.jpg" position="anchor" id="jats-graphic-39"/></boxed-text>
</p>
      <fig position="float" fig-type="FIGURE" id="ece38129-fig-0004">
        <label>FIGURE 4</label>
        <caption>
          <p>Step 4—Fit model. Posterior distributions of all parameters. For compactness, we include only three species</p>
        </caption>
        <graphic xlink:href="ECE3-11-15556-g029" position="anchor" id="jats-graphic-41"/>
      </fig>
      <p>For many users, the visualizations of <italic toggle="yes">λ<sub>j,k</sub>
</italic> will be of particular interest as they provide insight into species‐specific competitive interactions, where negative values indicate a competitor species which slows the growth of a focal species. Here, for example, we see that tulip poplars (litu) have a strong negative effect on the growth of conspecifics but relatively lesser effect on pignut hickory (cagl) and red oak (quru) neighbors.</p>
      <p>Currently, the <monospace>forestecology</monospace> package can only fit the competition Bayesian linear regression model in Equation <xref rid="ece38129-disp-0001" ref-type="disp-formula">1</xref>. However, it can be extended to any model as long as it is implemented in a function similar to <monospace>comp_bayes_lm()</monospace>.</p>
    </sec>
    <sec id="ece38129-sec-0007">
      <label>2.5</label>
      <title>Evaluate the effect of competitor species identity using permutation tests</title>
      <p>To evaluate the effect of competitor species identity, we use the above four steps along with the permutation test in Equation <xref rid="ece38129-disp-0002" ref-type="disp-formula">2</xref>. Under a null hypothesis where competitor species identity does not matter, we can permute the competitor species identities within each focal tree, compute the RMSE test statistic, repeat this process several times to construct a null distribution, and compare it to the observed RMSE to assess significance. Going back to our example in Section <xref rid="ece38129-sec-0005" ref-type="sec">2.3</xref> of focal tree with <monospace>focal_ID</monospace> 4 and its 20 competitors, the permutation test only randomly resamples the <monospace>comp_sp</monospace> variable without replacement, leaving all other variables intact. This resampling is nested within each focal tree in order to preserve neighborhood structure. We perform this permutation test once again using <monospace>comp_bayes_lm()</monospace> but by setting <monospace>run_shuffle = TRUE</monospace>.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0018"><graphic xlink:href="ECE3-11-15556-g017.jpg" position="anchor" id="jats-graphic-43"/></boxed-text>
</p>
      <p>The resulting permutation test RMSE of 0.131 is larger than the earlier RMSE of 0.128, suggesting that models that do incorporate competitor species identity better fit the data.</p>
    </sec>
    <sec id="ece38129-sec-0008">
      <label>2.6</label>
      <title>Evaluate model performance using spatial cross‐validation</title>
      <p>To evaluate model performance, we use spatial cross‐validation. The model fit in Section <xref rid="ece38129-sec-0006" ref-type="sec">2.4</xref> uses the same data to both fit and assess model performance. Given the spatial‐autocorrelation of our data, this can potentially lead to overfit models (Roberts et al., <xref rid="ece38129-bib-0020" ref-type="bibr">2017</xref>). To mitigate this risk, we use the spatial cross‐validation blocking scheme encoded in the <monospace>foldID</monospace> variable from Section <xref rid="ece38129-sec-0003" ref-type="sec">2.2</xref> and visualized in Figure <xref rid="ece38129-fig-0002" ref-type="fig">2</xref>.</p>
      <p>At each iteration of the cross‐validation, one fold acts as the test set and the remaining three act as the training set. We fit the model to all focal trees in the training set, apply the model to all focal trees in the test set, compute predicted values, and compute the RMSE. Furthermore, to maintain spatial independence between the test and training sets, a “fold buffer” that extends 7.5 m outward from the boundary of the test set is considered; all trees within this “fold buffer” are excluded from the training set (see Figure <xref rid="ece38129-fig-0005" ref-type="fig">5</xref>).</p>
      <fig position="float" fig-type="FIGURE" id="ece38129-fig-0005">
        <label>FIGURE 5</label>
        <caption>
          <p>Schematic of spatial cross‐validation. Using the k = 1 fold (bottom‐left) as the test set, k = 2 through 4 as the training set, along with a fold buffer extending outward from the test set to maintain spatial independence between it and the training set</p>
        </caption>
        <graphic xlink:href="ECE3-11-15556-g027" position="anchor" id="jats-graphic-45"/>
      </fig>
      <p>This process is repeated for each of the four folds acting as the test set, and then, the four RMSE’s are averaged to provide a single estimate of model error. This algorithm is implemented in <monospace>run_cv()</monospace>, which acts as a wrapper function to both <monospace>comp_bayes_lm()</monospace> that fits the model and <monospace>predict()</monospace> that returns predicted values.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0019"><graphic xlink:href="ECE3-11-15556-g025.jpg" position="anchor" id="jats-graphic-47"/></boxed-text>
</p>
      <p>The resulting RMSE of 0.14 computed using cross‐validation is larger than the earlier RMSE of 0.128, suggesting that models that do not account for spatial autocorrelation generate model error estimates that are overly optimistic, that is, RMSE values that are too low.</p>
    </sec>
  </sec>
  <sec id="ece38129-sec-0009">
    <label>3</label>
    <title>IMPORTANCE OF SPATIAL CROSS‐VALIDATION</title>
    <p><monospace>run_cv()</monospace> also accepts the <monospace>run_shuffle</monospace> argument in order to permute competitor species identity as described in Section <xref rid="ece38129-sec-0007" ref-type="sec">2.5</xref>. Figure <xref rid="ece38129-fig-0006" ref-type="fig">6</xref> compares model performance for 49 permutations of competitor species and RMSE calculations, both with and without cross‐validation. Without cross‐validation, competitor species identity does matter as the observed RMSE was significantly lower than the permutation null distribution of RMSE. However, once we incorporate spatial cross‐validation, this improvement disappears. These results suggest that in this 9 ha subplot of the SCBI plot, competitive interactions do not depend on the identity of the competitor, which is the opposite of what has been observed in other locations (Allen &amp; Kim, <xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>; Uriarte et al., <xref rid="ece38129-bib-0025" ref-type="bibr">2004</xref>). This provides a striking example of the importance of cross‐validation, as without it the over‐fit model gives rise to an incorrect conclusion.</p>
    <fig position="float" fig-type="FIGURE" id="ece38129-fig-0006">
      <label>FIGURE 6</label>
      <caption>
        <p>Comparison of root mean squared error of models for standard, permuted, and spatially cross‐validated error estimates. The dotted lines show observed RMSE while the histograms show the null distribution of RMSE for 49 permutations under the null hypothesis of no competitor species identity effects. The colors indicate whether spatial cross‐validation was used or not</p>
      </caption>
      <graphic xlink:href="ECE3-11-15556-g020" position="anchor" id="jats-graphic-49"/>
    </fig>
    <fig position="float" fig-type="FIGURE" id="ece38129-fig-0007">
      <label>FIGURE 7</label>
      <caption>
        <p>Cross‐validated RMSE estimates for 5 competitive distances</p>
      </caption>
      <graphic xlink:href="ECE3-11-15556-g022" position="anchor" id="jats-graphic-51"/>
    </fig>
    <fig position="float" fig-type="FIGURE" id="ece38129-fig-0008">
      <label>FIGURE 8</label>
      <caption>
        <p>Posterior distributions of all competition parameters</p>
      </caption>
      <graphic xlink:href="ECE3-11-15556-g012" position="anchor" id="jats-graphic-53"/>
    </fig>
  </sec>
  <sec id="ece38129-sec-0010">
    <label>4</label>
    <title>CONCLUSION AND FUTURE WORK</title>
    <p>The <monospace>forestecology</monospace> package provides an accessible way to fit and test models of neighborhood competition. The package follows the tidy data design principles, leverages the <monospace>sf</monospace> package for spatial data, and S3 open‐oriented model implementation structure (Pebesma, <xref rid="ece38129-bib-0018" ref-type="bibr">2018</xref>). We hope that the package will increase the use of neighborhood competition models to better understand what structures plant competition.</p>
    <p>While the package is designed with ForestGEO plot data in mind, we envision that it can be modified to work on any single large, mapped forest plot in which at least two measurements of each individual have been taken. Furthermore, we hope that future versions of the package will be flexible to other plot layouts, for example, inventory plot‐structure with many spatially separated plots like the US Forest Service Forest Inventory and Analysis plots (Smith, <xref rid="ece38129-bib-0023" ref-type="bibr">2002</xref>).</p>
    <p>We also hope to extend the <monospace>forestecology</monospace> package's functionality to account for a larger variety of models for tree growth. One clear future direction would be to allow competition based on species trait values rather than species identity. There is evidence that traits predict competitive outcomes (Kunstler et al., <xref rid="ece38129-bib-0016" ref-type="bibr">2012</xref>; Lasky et al., <xref rid="ece38129-bib-0017" ref-type="bibr">2014</xref>; Uriarte et al., <xref rid="ece38129-bib-0026" ref-type="bibr">2010</xref>). Thus, an extension of the model would allow <italic toggle="yes">λ</italic> values from Equation <xref rid="ece38129-disp-0001" ref-type="disp-formula">1</xref> to be a function of the traits of competing species.</p>
    <p>Lastly, the <monospace>forestecology</monospace> package current uses the <monospace>blockCV</monospace> package behind the scenes to create the spatial blocks acting as folds for our spatial cross‐validation algorithm detailed in Sections <xref rid="ece38129-sec-0003" ref-type="sec">2.2</xref> and <xref rid="ece38129-sec-0008" ref-type="sec">2.6</xref> (Valavi et al., <xref rid="ece38129-bib-0027" ref-type="bibr">2019</xref>). This back‐end functionality could be substituted with the <monospace>spatialsample</monospace> package for spatial resampling infrastructure; a <monospace>tidymodels</monospace> package under active development as of 2021 (Kuhn &amp; Wickham, <xref rid="ece38129-bib-0015" ref-type="bibr">2020</xref>; Silge, <xref rid="ece38129-bib-0021" ref-type="bibr">2021</xref>).</p>
    <p>Lastly, currently, the package only implements the Bayesian linear regression model detailed in Equation <xref rid="ece38129-disp-0001" ref-type="disp-formula">1</xref>. As we demonstrate in Section <xref rid="ece38129-sec-0006" ref-type="sec">2.4</xref> however, the fitting of this model is self‐contained in a single function <monospace>comp_bayes_lm()</monospace> which returns an object of S3 class type <monospace>comp_bayes_lm</monospace>. This class has generic methods implemented to print, make predictions, and plot all results. Therefore, the package can be modularly extended to fit other models as long as they are coded similarly to <monospace>comp_bayes_lm()</monospace> and have equivalent generic methods implemented.</p>
  </sec>
  <sec sec-type="COI-statement" id="ece38129-sec-0012">
    <title>CONFLICT OF INTEREST</title>
    <p>We declare no competing interests.</p>
  </sec>
  <sec id="ece38129-sec-0013">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p><bold>Albert Y. Kim:</bold> Conceptualization (equal); Methodology (equal); Software (equal); Writing‐original draft (lead); Writing‐review &amp; editing (equal). <bold>David N. Allen:</bold> Conceptualization (equal); Methodology (equal); Software (equal); Writing‐original draft (supporting); Writing‐review &amp; editing (equal). <bold>Simon P. Couch:</bold> Software (supporting); Writing‐review &amp; editing (supporting).</p>
  </sec>
  <sec id="ece38129-sec-0014">
    <sec disp-level="2" id="ece38129-sec-0015">
      <title>OPEN RESEARCH BADGES</title>
      <p>This article has been awarded &lt;Open Materials, Open Data&gt; Badges. All materials and data are publicly accessible via the Open Science Framework at [<ext-link xlink:href="https://zenodo.org/record/4070038" ext-link-type="uri">https://zenodo.org/record/4070038</ext-link>; <ext-link xlink:href="https://github.com/rudeboybert/forestecology/tree/master/paper" ext-link-type="uri">https://github.com/rudeboybert/forestecology/tree/master/paper</ext-link>].</p>
    </sec>
  </sec>
</body>
<back>
  <ack id="ece38129-sec-0011">
    <title>ACKNOWLEDGMENT</title>
    <p>We thank Sophie Li for their feedback on the package interface.</p>
  </ack>
  <fn-group id="ece38129-ntgp-0001">
    <title>ENDNOTE</title>
    <fn id="ece38129-note-1001">
      <label>
        <sup>1</sup>
      </label>
      <p>See Appendix <xref rid="ece38129-app-0001" ref-type="app">1</xref>, <xref rid="ece38129-app-0002" ref-type="app">2</xref>, <xref rid="ece38129-app-0003" ref-type="app">3</xref>, <xref rid="ece38129-app-0004" ref-type="app">4</xref> of Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>), available at <ext-link xlink:href="https://doi.org/10.1371/journal.pone.0229930.s004" ext-link-type="uri">https://doi.org/10.1371/journal.pone.0229930.s004</ext-link>.</p>
    </fn>
  </fn-group>
  <sec sec-type="data-availability" id="ece38129-sec-0016">
    <title>DATA AVAILABILITY STATEMENT</title>
    <p>All data and source code for this manuscript on GitHub at <ext-link xlink:href="https://github.com/rudeboybert/forestecology" ext-link-type="uri" specific-use="software is-supplemented-by">https://github.com/rudeboybert/forestecology</ext-link> and are archived on Zenodo at <ext-link xlink:href="https://doi.org/10.5281/zenodo.5367351" ext-link-type="uri" specific-use="dataset is-supplemented-by">https://doi.org/10.5281/zenodo.5367351</ext-link>. The example Smithsonian Conservation Biology Institute census and species information data are available on GitHub at <ext-link xlink:href="https://github.com/SCBI-ForestGEO/SCBI-ForestGEO-Data/tree/master/" ext-link-type="uri" specific-use="software is-supplemented-by">https://github.com/SCBI‐ForestGEO/SCBI‐ForestGEO‐Data/tree/master/</ext-link> and are archived on Zenodo at <ext-link xlink:href="https://doi.org/10.5281/zenodo.2649301" ext-link-type="uri" specific-use="dataset is-supplemented-by">https://doi.org/10.5281/zenodo.2649301</ext-link> (Gonzalez‐Akre, McGregor, et al., <xref rid="ece38129-bib-0012" ref-type="bibr">2020</xref>).</p>
  </sec>
  <ref-list content-type="cited-references" id="ece38129-bibl-0001">
    <title>REFERENCES</title>
    <ref id="ece38129-bib-0001">
      <mixed-citation publication-type="book" id="ece38129-cit-0001"><string-name><surname>Allen</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Dick</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Burnham</surname>, <given-names>R. J.</given-names></string-name>, <string-name><surname>Perfecto</surname>, <given-names>I.</given-names></string-name>, &amp; <string-name><surname>Vandermeer</surname>, <given-names>J.</given-names></string-name> (<year>2020</year>). <source>The Michigan big woods research plot at the Edwin S. George, Pinckney, MI, USA</source>. Miscellaneous Publications of the Museum of Zoology, University of Michigan 207. <ext-link xlink:href="http://hdl.handle.net/2027.42/156251" ext-link-type="uri">http://hdl.handle.net/2027.42/156251</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0002">
      <mixed-citation publication-type="journal" id="ece38129-cit-0002"><string-name><surname>Allen</surname>, <given-names>D.</given-names></string-name>, &amp; <string-name><surname>Kim</surname>, <given-names>A. Y.</given-names></string-name> (<year>2020</year>). <article-title>A permutation test and spatial cross‐validation approach to assess models of interspecific competition between trees</article-title>. <source>PLoS One</source>, <volume>15</volume>(<issue>3</issue>), <elocation-id>e0229930</elocation-id>. <pub-id pub-id-type="doi">10.1371/journal.pone.0229930</pub-id>
<pub-id pub-id-type="pmid">32160247</pub-id></mixed-citation>
    </ref>
    <ref id="ece38129-bib-0003">
      <mixed-citation publication-type="journal" id="ece38129-cit-0003"><string-name><surname>Anderson‐Teixeira</surname>, <given-names>K. J.</given-names></string-name>, <string-name><surname>Davies</surname>, <given-names>S. J.</given-names></string-name>, <string-name><surname>Bennett</surname>, <given-names>A. C.</given-names></string-name>, <string-name><surname>Gonzalez‐Akre</surname>, <given-names>E. B.</given-names></string-name>, <string-name><surname>Muller‐Landau</surname>, <given-names>H. C.</given-names></string-name>, <string-name><surname>Joseph Wright</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Abu Salim</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Almeyda Zambrano</surname>, <given-names>A. M.</given-names></string-name>, <string-name><surname>Alonso</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Baltzer</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Basset</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Bourg</surname>, <given-names>N. A.</given-names></string-name>, <string-name><surname>Broadbent</surname>, <given-names>E. N.</given-names></string-name>, <string-name><surname>Brockelman</surname>, <given-names>W. Y.</given-names></string-name>, <string-name><surname>Bunyavejchewin</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Burslem</surname>, <given-names>D. F. R. P.</given-names></string-name>, <string-name><surname>Butt</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Cardenas</surname>, <given-names>D.</given-names></string-name>, … <string-name><surname>Zimmerman</surname>, <given-names>J.</given-names></string-name> (<year>2015</year>). <article-title>CTFS‐ForestGEO: A worldwide network monitoring forests in an era of global change</article-title>. <source>Global Change Biology</source>, <volume>21</volume>(<issue>2</issue>), <fpage>528</fpage>–<lpage>549</lpage>. <pub-id pub-id-type="doi">10.1111/gcb.12712</pub-id>
<pub-id pub-id-type="pmid">25258024</pub-id></mixed-citation>
    </ref>
    <ref id="ece38129-bib-0004">
      <mixed-citation publication-type="book" id="ece38129-cit-0004"><string-name><surname>Bache</surname>, <given-names>S. M.</given-names></string-name>, &amp; <string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name> (<year>2020</year>). <source>Magrittr: A Forward‐Pipe Operator for R</source>. <ext-link xlink:href="https://CRAN.R-project.org/package=magrittr" ext-link-type="uri">https://CRAN.R‐project.org/package=magrittr</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0005">
      <mixed-citation publication-type="book" id="ece38129-cit-0005"><string-name><surname>Bivand</surname>, <given-names>R. S.</given-names></string-name>, <string-name><surname>Pebesma</surname>, <given-names>E.</given-names></string-name>, &amp; <string-name><surname>Gomez‐Rubio</surname>, <given-names>V.</given-names></string-name> (<year>2013</year>). <source>Applied spatial data analysis with R</source> (<edition>2</edition>nd ed.) <publisher-name>Springer</publisher-name>. <ext-link xlink:href="https://asdar-book.org/" ext-link-type="uri">https://asdar‐book.org/</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0006">
      <mixed-citation publication-type="journal" id="ece38129-cit-0006"><string-name><surname>Bourg</surname>, <given-names>N. A.</given-names></string-name>, <string-name><surname>McShea</surname>, <given-names>W. J.</given-names></string-name>, <string-name><surname>Thompson</surname>, <given-names>J. R.</given-names></string-name>, <string-name><surname>McGarvey</surname>, <given-names>J. C.</given-names></string-name>, &amp; <string-name><surname>Shen</surname>, <given-names>X.</given-names></string-name> (<year>2013</year>). <article-title>Initial census, woody seedling, seed rain, and stand structure data for the SCBI SIGEO large forest dynamics plot</article-title>. <source>Ecology</source>, <volume>94</volume>(<issue>9</issue>), <fpage>2111</fpage>–<lpage>2112</lpage>. <pub-id pub-id-type="doi">10.1890/13-0010.1</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0007">
      <mixed-citation publication-type="journal" id="ece38129-cit-0007"><string-name><surname>Canham</surname>, <given-names>C. D.</given-names></string-name>, <string-name><surname>LePage</surname>, <given-names>P. T.</given-names></string-name>, &amp; <string-name><surname>Dave Coates</surname>, <given-names>K.</given-names></string-name> (<year>2004</year>). <article-title>A neighborhood analysis of canopy tree competition: Effects of shading versus crowding</article-title>. <source>Canadian Journal of Forest Research</source>, <volume>34</volume>(<issue>4</issue>), <fpage>778</fpage>–<lpage>787</lpage>. <pub-id pub-id-type="doi">10.1139/x03-232</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0008">
      <mixed-citation publication-type="journal" id="ece38129-cit-0008"><string-name><surname>Canham</surname>, <given-names>C. D.</given-names></string-name>, <string-name><surname>Papaik</surname>, <given-names>M. J.</given-names></string-name>, <string-name><surname>Uriarte</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>McWilliams</surname>, <given-names>W. H.</given-names></string-name>, <string-name><surname>Jenkins</surname>, <given-names>J. C.</given-names></string-name>, &amp; <string-name><surname>Twery</surname>, <given-names>M. J.</given-names></string-name> (<year>2006</year>). <article-title>Neighborhood analyses of canopy tree competition along environmental gradients in New England forests</article-title>. <source>Ecological Applications</source>, <volume>16</volume>(<issue>2</issue>), <fpage>540</fpage>–<lpage>554</lpage>.<pub-id pub-id-type="pmid">16711043</pub-id></mixed-citation>
    </ref>
    <ref id="ece38129-bib-0009">
      <mixed-citation publication-type="journal" id="ece38129-cit-0009"><string-name><surname>Das</surname>, <given-names>A.</given-names></string-name> (<year>2012</year>). <article-title>The effect of size and competition on tree growth rate in old‐growth coniferous forests</article-title>. <source>Canadian Journal of Forest Research</source>, <volume>42</volume>, <fpage>1983</fpage>–<lpage>1995</lpage>. <pub-id pub-id-type="doi">10.1139/x2012-142</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0010">
      <mixed-citation publication-type="journal" id="ece38129-cit-0010"><string-name><surname>Davies</surname>, <given-names>S. J.</given-names></string-name>, <string-name><surname>Abiem</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Abu Salim</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Aguilar</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Alonso</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Anderson‐Teixeira</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Andrade</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Arellano</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Ashton</surname>, <given-names>P. S.</given-names></string-name>, <string-name><surname>Baker</surname>, <given-names>P. J.</given-names></string-name>, <string-name><surname>Baker</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Baltzer</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Basset</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Bissiengou</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Bohlman</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Bourg</surname>, <given-names>N. A.</given-names></string-name>, <string-name><surname>Brockelman</surname>, <given-names>W. Y.</given-names></string-name>, <string-name><surname>Bunyavejchewin</surname>, <given-names>S.</given-names></string-name>, … <string-name><surname>Zuleta</surname>, <given-names>D.</given-names></string-name> (<year>2021</year>). <article-title>ForestGEO: Understanding forest diversity and dynamics through a global observatory network</article-title>. <source>Biological Conservation</source>, <volume>253</volume>, <fpage>108907</fpage>. <pub-id pub-id-type="doi">10.1016/j.biocon.2020.108907</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0011">
      <mixed-citation publication-type="book" id="ece38129-cit-0011"><collab collab-type="authors">GEOS Development Team</collab>
. (<year>2017</year>). <source>GEOS ‐ Geometry Engine, Open Source</source>. In, 211. <publisher-name>Open Source Geospatial Foundation</publisher-name>. <ext-link xlink:href="https://trac.osgeo.org/geos/" ext-link-type="uri">https://trac.osgeo.org/geos/</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0012">
      <mixed-citation publication-type="book" id="ece38129-cit-0012"><string-name><surname>Gonzalez‐Akre</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>McGregor</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Anderson‐Teixeira</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Dow</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Herrmann</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Terrell</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>A. Y.</given-names></string-name>, <string-name><surname>Vinod</surname>, <given-names>N.</given-names></string-name>, &amp; <string-name><surname>Helcoski</surname>, <given-names>R.</given-names></string-name> (<year>2020</year>). <source>SCBI‐ForestGEO/SCBI‐ForestGEO‐Data: 2020 Update</source>. Zenodo. <pub-id pub-id-type="doi">10.5281/zenodo.4041595</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0013">
      <mixed-citation publication-type="book" id="ece38129-cit-0013"><string-name><surname>Gonzalez‐Akre</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Piponiot</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Lepore</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Anderson‐Teixeira</surname>, <given-names>K.</given-names></string-name> (<year>2020</year>). <source>Allodb: An R database for biomass estimation at extratropical forest plots</source>. <ext-link xlink:href="https://github.com/forestgeo/allodb" ext-link-type="uri">https://github.com/forestgeo/allodb</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0014">
      <mixed-citation publication-type="book" id="ece38129-cit-0014"><string-name><surname>Herring</surname>, <given-names>J. R.</given-names></string-name> (<year>2011</year>). <source>OpenGIS implementation standard for geographic information‐Simple feature access Part 1: Common architecture</source>. Version 1.2.1. <publisher-name>Open Geospatial Consortium Inc</publisher-name>.</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0015">
      <mixed-citation publication-type="book" id="ece38129-cit-0015"><string-name><surname>Kuhn</surname>, <given-names>M.</given-names></string-name>, &amp; <string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name> (<year>2020</year>). <source>Tidymodels: A collection of packages for modeling and machine learning using Tidyverse principles</source>. <ext-link xlink:href="https://www.tidymodels.org" ext-link-type="uri">https://www.tidymodels.org</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0016">
      <mixed-citation publication-type="journal" id="ece38129-cit-0016"><string-name><surname>Kunstler</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Lavergne</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Courbaud</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Thuiller</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Vieilledent</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Zimmermann</surname>, <given-names>N. E.</given-names></string-name>, <string-name><surname>Kattge</surname>, <given-names>J.</given-names></string-name>, &amp; <string-name><surname>Coomes</surname>, <given-names>D. A.</given-names></string-name> (<year>2012</year>). <article-title>Competitive interactions between forest trees are driven by species’ trait hierarchy, not phylogenetic or functional similarity: Implications for forest community assembly</article-title>. <source>Ecology Letters</source>, <volume>15</volume>(<issue>8</issue>), <fpage>831</fpage>–<lpage>840</lpage>. <pub-id pub-id-type="doi">10.1111/j.1461-0248.2012.01803.x</pub-id>
<pub-id pub-id-type="pmid">22625657</pub-id></mixed-citation>
    </ref>
    <ref id="ece38129-bib-0017">
      <mixed-citation publication-type="journal" id="ece38129-cit-0017"><string-name><surname>Lasky</surname>, <given-names>J. R.</given-names></string-name>, <string-name><surname>Uriarte</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Boukili</surname>, <given-names>V. K.</given-names></string-name>, &amp; <string-name><surname>Chazdon</surname>, <given-names>R. L.</given-names></string-name> (<year>2014</year>). <article-title>Trait‐mediated assembly processes predict successional changes in community diversity of tropical forests</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>111</volume>(<issue>15</issue>), <fpage>5616</fpage>–<lpage>5621</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1319342111</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0018">
      <mixed-citation publication-type="journal" id="ece38129-cit-0018"><string-name><surname>Pebesma</surname>, <given-names>E.</given-names></string-name> (<year>2018</year>). <article-title>Simple features for R: Standardized Support for spatial vector data</article-title>. <source>The R Journal</source>, <volume>10</volume>(<issue>1</issue>), <fpage>439</fpage>–<lpage>446</lpage>. <pub-id pub-id-type="doi">10.32614/RJ-2018-009</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0019">
      <mixed-citation publication-type="journal" id="ece38129-cit-0019"><string-name><surname>Pohjankukka</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Pahikkala</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Nevalainen</surname>, <given-names>P.</given-names></string-name>, &amp; <string-name><surname>Heikkonen</surname>, <given-names>J.</given-names></string-name> (<year>2017</year>). <article-title>Estimating the prediction performance of spatial models via spatial K‐fold cross validation</article-title>. <source>International Journal of Geographical Information Science</source>, <volume>31</volume>(<issue>10</issue>), <fpage>2001</fpage>–<lpage>2019</lpage>. <pub-id pub-id-type="doi">10.1080/13658816.2017.1346255</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0020">
      <mixed-citation publication-type="journal" id="ece38129-cit-0020"><string-name><surname>Roberts</surname>, <given-names>D. R.</given-names></string-name>, <string-name><surname>Bahn</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Ciuti</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Boyce</surname>, <given-names>M. S.</given-names></string-name>, <string-name><surname>Elith</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Guillera‐Arroita</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Hauenstein</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Lahoz‐Monfort</surname>, <given-names>J. J.</given-names></string-name>, <string-name><surname>Schröder</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Thuiller</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Warton</surname>, <given-names>D. I.</given-names></string-name>, <string-name><surname>Wintle</surname>, <given-names>B. A.</given-names></string-name>, <string-name><surname>Hartig</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>Dormann</surname>, <given-names>C. F.</given-names></string-name> (<year>2017</year>). <article-title>Cross‐validation strategies for data with temporal, spatial, hierarchical, or phylogenetic structure</article-title>. <source>Ecography</source>, <volume>40</volume>(<issue>8</issue>), <fpage>913</fpage>–<lpage>929</lpage>. <pub-id pub-id-type="doi">10.1111/ecog.02881</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0021">
      <mixed-citation publication-type="book" id="ece38129-cit-0021"><string-name><surname>Silge</surname>, <given-names>J.</given-names></string-name> (<year>2021</year>). <source>Spatialsample: Spatial Resampling Infrastructure</source>. <ext-link xlink:href="https://CRAN.R-project.org/package=spatialsample" ext-link-type="uri">https://CRAN.R‐project.org/package=spatialsample</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0022">
      <mixed-citation publication-type="book" id="ece38129-cit-0022"><string-name><surname>Smith</surname>, <given-names>D. M.</given-names></string-name> (<year>1986</year>). <source>The Practice of Silviculture</source>.</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0023">
      <mixed-citation publication-type="journal" id="ece38129-cit-0023"><string-name><surname>Smith</surname>, <given-names>W. B.</given-names></string-name> (<year>2002</year>). <article-title>Forest inventory and analysis: A National Inventory and Monitoring Program</article-title>. <source>Environmental Pollution</source>, <volume>116</volume>, <fpage>S233</fpage>–<lpage>S242</lpage>. <pub-id pub-id-type="doi">10.1016/S0269-7491(01)00255-X</pub-id>
<pub-id pub-id-type="pmid">11833910</pub-id></mixed-citation>
    </ref>
    <ref id="ece38129-bib-0024">
      <mixed-citation publication-type="journal" id="ece38129-cit-0024"><string-name><surname>Tatsumi</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Owari</surname>, <given-names>T.</given-names></string-name>, &amp; <string-name><surname>Mori</surname>, <given-names>A. S.</given-names></string-name> (<year>2016</year>). <article-title>Estimating competition coefficients in tree communities: A hierarchical Bayesian approach to neighborhood analysis</article-title>. <source>Ecosphere</source>, <volume>7</volume>, <elocation-id>e01273</elocation-id>. <pub-id pub-id-type="doi">10.1002/ecs2.1273</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0025">
      <mixed-citation publication-type="journal" id="ece38129-cit-0025"><string-name><surname>Uriarte</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Condit</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Canham</surname>, <given-names>C. D.</given-names></string-name>, &amp; <string-name><surname>Hubbell</surname>, <given-names>S. P.</given-names></string-name> (<year>2004</year>). <article-title>A spatially explicit model of sapling growth in a tropical forest: Does the identity of neighbours matter?</article-title>
<source>Journal of Ecology</source>, <volume>92</volume>(<issue>2</issue>), <fpage>348</fpage>–<lpage>360</lpage>. <pub-id pub-id-type="doi">10.1111/j.0022-0477.2004.00867.x</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0026">
      <mixed-citation publication-type="journal" id="ece38129-cit-0026"><string-name><surname>Uriarte</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Swenson</surname>, <given-names>N. G.</given-names></string-name>, <string-name><surname>Chazdon</surname>, <given-names>R. L.</given-names></string-name>, <string-name><surname>Comita</surname>, <given-names>L. S.</given-names></string-name>, <string-name><surname>John Kress</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Erickson</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Forero‐Montaǹa</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Zimmeran</surname>, <given-names>J. K.</given-names></string-name>, &amp; <string-name><surname>Thompson</surname>, <given-names>J.</given-names></string-name> (<year>2010</year>). <article-title>Trait similarity, shared ancestry and the structure of neighbourhood interactions in a subtropical wet forest: Implications for community assembly</article-title>. <source>Ecology Letters</source>, <volume>13</volume>, <fpage>1503</fpage>–<lpage>1514</lpage>. <pub-id pub-id-type="doi">10.1111/j.1461-0248.2010.01541.x</pub-id>
<pub-id pub-id-type="pmid">21054732</pub-id></mixed-citation>
    </ref>
    <ref id="ece38129-bib-0027">
      <mixed-citation publication-type="journal" id="ece38129-cit-0027"><string-name><surname>Valavi</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Elith</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Lahoz‐Monfort</surname>, <given-names>J. J.</given-names></string-name>, &amp; <string-name><surname>Guillera‐Arroita</surname>, <given-names>G.</given-names></string-name> (<year>2019</year>). <article-title>blockCV: An R package for generating spatially or environmentally separated folds for K‐Fold cross‐validation of species distribution models</article-title>. <source>Methods in Ecology and Evolution</source>, <volume>10</volume>(<issue>2</issue>), <fpage>225</fpage>–<lpage>232</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.13107</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0028">
      <mixed-citation publication-type="book" id="ece38129-cit-0028"><string-name><surname>Waller</surname>, <given-names>L. A.</given-names></string-name>, &amp; <string-name><surname>Gotway</surname>, <given-names>C. A.</given-names></string-name> (<year>2004</year>). <source>Applied spatial statistics for public health data</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>, Incorporated. <ext-link xlink:href="http://ebookcentral.proquest.com/lib/smith/detail.action?docID=214360" ext-link-type="uri">http://ebookcentral.proquest.com/lib/smith/detail.action?docID=214360</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0029">
      <mixed-citation publication-type="book" id="ece38129-cit-0029"><string-name><surname>Warmerdam</surname>, <given-names>F.</given-names></string-name> (<year>2008</year>). <part-title>“The geospatial data abstraction library” Open source approaches in spatial data handling</part-title>. In <person-group person-group-type="editor"><string-name><given-names>G. B.</given-names><surname>Hall</surname></string-name></person-group> &amp; <person-group person-group-type="editor"><string-name><given-names>M. G.</given-names><surname>Leahy</surname></string-name></person-group> (Eds.), <source>Advances in geographic information science</source> (pp. <fpage>87</fpage>–<lpage>104</lpage>). <publisher-name>Springer</publisher-name>. <pub-id pub-id-type="doi">10.1007/978-3-540-74831-1_5</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0030">
      <mixed-citation publication-type="book" id="ece38129-cit-0030"><string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name> (<year>2020</year>). <source>Tidyr: Tidy Messy Data</source>. <ext-link xlink:href="https://CRAN.R-project.org/package=tidyr" ext-link-type="uri">https://CRAN.R‐project.org/package=tidyr</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece38129-bib-0031">
      <mixed-citation publication-type="journal" id="ece38129-cit-0031"><string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Averick</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Bryan</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Chang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>McGowan</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>François</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Grolemund</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Hayes</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Henry</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Hester</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kuhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pedersen</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Miller</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Bache</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Müller</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ooms</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Robinson</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Seidel</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Spinu</surname>, <given-names>V.</given-names></string-name>, … <string-name><surname>Yutani</surname>, <given-names>H.</given-names></string-name> (<year>2019</year>). <article-title>Welcome to the Tidyverse</article-title>. <source>Journal of Open Source Software</source>, <volume>4</volume>(<issue>43</issue>), <fpage>1686</fpage>. <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="ece38129-app-0001" content-type="APPENDIX">
      <label>APPENDIX 1</label>
      <title>Compare different competitive distances</title>
      <p>For all the above analyses, we set the cutoff distance (<monospace>comp_dist</monospace>) for two stems to compete as 7.5m. This distance has been estimated in previous neighborhood competition studies in forests (Canham et al., <xref rid="ece38129-bib-0007" ref-type="bibr">2004</xref>; Canham et al., <xref rid="ece38129-bib-0008" ref-type="bibr">2006</xref>; Uriarte et al., <xref rid="ece38129-bib-0025" ref-type="bibr">2004</xref>). We used 7.5 m in Allen and Kim (<xref rid="ece38129-bib-0002" ref-type="bibr">2020</xref>) as an average of the values estimated in other studies, but our package can be used to find which distance is best supported by the data. Here, we provide an example using another section of the SCBI plot to provide an additional example of the cross‐validation block layout. To speed computation, we do not consider species differences in competitive effects and treat all species as the same.</p>
      <p>We observe in Figure <xref rid="ece38129-fig-0007" ref-type="fig">7</xref>, that a cutoff distance of approximately 6m minimizes the cross‐validation estimated RMSE.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0020"><graphic xlink:href="ECE3-11-15556-g002.jpg" position="anchor" id="jats-graphic-55"/></boxed-text>
</p>
    </app>
    <app id="ece38129-app-0002" content-type="APPENDIX">
      <label>APPENDIX 2</label>
      <title>Compare competitor explanatory variables</title>
      <p>In the above code, we use the basal area of an individual as a continuous competitor explanatory variable, but the package allows the user to specify any competitor explanatory variable in the <monospace>comp_x_var</monospace> argument of <monospace>create_focal_vs_comp</monospace> function. Here, we use the cross‐validated model comparison to see which of two possible competitor explanatory variables computed in Section <xref rid="ece38129-sec-0003" ref-type="sec">2.1</xref>, basal area or aboveground biomass, best explains growth.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0021"><graphic xlink:href="ECE3-11-15556-g016.jpg" position="anchor" id="jats-graphic-57"/></boxed-text>
</p>
      <p>Here, we observe that basal area is a better competitor explanatory variable competitor explanatory variables <mml:math id="jats-math-9"><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ijk</mml:mi><mml:mtext>comp</mml:mtext></mml:msubsup></mml:math> from Equation <xref rid="ece38129-disp-0001" ref-type="disp-formula">1</xref> than aboveground biomass as suggested by the lower estimated RMSE.</p>
    </app>
    <app id="ece38129-app-0003" content-type="APPENDIX">
      <label>APPENDIX 3</label>
      <title>Compare grouping variables</title>
      <p>The package also allows the user to specify the categorical explanatory grouping variable. Here, we compare two different such variables: species and the potential canopy position of that species. If we had individual‐level crown classes (Smith (<xref rid="ece38129-bib-0022" ref-type="bibr">1986</xref>) dominant, codominant, intermediate and suppressed) that could also be used.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0022"><graphic xlink:href="ECE3-11-15556-g007.jpg" position="anchor" id="jats-graphic-59"/></boxed-text>
</p>
      <p>We find that species identity has a lower RMSE, so does a better job. We still however plot the competition posteriors for the canopy position groupings in Figure <xref rid="ece38129-fig-0008" ref-type="fig">8</xref>. Unsurprisingly, we see that canopy and canopy emergent competitors generally have negative effects on their neighbors, while shrubs and understory competitors have neutral or even positive effects.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0023"><graphic xlink:href="ECE3-11-15556-g018.jpg" position="anchor" id="jats-graphic-61"/></boxed-text>
</p>
    </app>
    <app id="ece38129-app-0004" content-type="APPENDIX">
      <label>APPENDIX 4</label>
      <title>Replicate RMSE comparison</title>
      <p>This code replicates Figure <xref rid="ece38129-fig-0006" ref-type="fig">6</xref>: A comparison of root mean squared error of models for standard, permuted, and spatial cross‐validated error estimates.<boxed-text position="anchor" content-type="graphic" id="ece38129-blkfxd-0024"><graphic xlink:href="ECE3-11-15556-g024.jpg" position="anchor" id="jats-graphic-63"/></boxed-text>
</p>
    </app>
  </app-group>
</back>
