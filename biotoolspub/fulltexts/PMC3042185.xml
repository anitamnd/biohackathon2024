<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3042185</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq725</article-id>
    <article-id pub-id-type="publisher-id">btq725</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Clustering 16S rRNA for OTU prediction: a method of unsupervised Bayesian clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hao</surname>
          <given-names>Xiaolin</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Rui</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Ting</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Molecular and Computational Biology Program, Department of Biology, University of Southern California, University Park, Los Angeles, CA 90089, USA and <sup>2</sup>MOE Key Laboratory of Bioinformatics and Bioinformatics Division, TNLIST/Department of Automation, Tsinghua University, Beijing, 100084, China</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>3</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>5</issue>
    <fpage>611</fpage>
    <lpage>618</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>7</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>8</day>
        <month>11</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>12</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> With the advancements of next-generation sequencing technology, it is now possible to study samples directly obtained from the environment. Particularly, 16S rRNA gene sequences have been frequently used to profile the diversity of organisms in a sample. However, such studies are still taxed to determine both the number of operational taxonomic units (OTUs) and their relative abundance in a sample.</p>
      <p><bold>Results:</bold> To address these challenges, we propose an unsupervised Bayesian clustering method termed Clustering 16S rRNA for OTU Prediction (CROP). CROP can find clusters based on the natural organization of data without setting a hard cut-off threshold (3%/5%) as required by hierarchical clustering methods. By applying our method to several datasets, we demonstrate that CROP is robust against sequencing errors and that it produces more accurate results than conventional hierarchical clustering methods.</p>
      <p><bold>Availability and Implementation:</bold> Source code freely available at the following URL: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/crop-tingchenlab/">http://code.google.com/p/crop-tingchenlab/</ext-link>, implemented in C++ and supported on Linux and MS Windows.</p>
      <p>
        <bold>Contact:</bold>
        <email>tingchen@usc.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq725/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>In recent years, the development of next-generation sequencing technology has made it possible to directly sequence a huge amount of high-quality DNA/RNA fragments extracted from environmental samples in an acceptable time period (<xref ref-type="bibr" rid="B5">Eisen, 2007</xref>; <xref ref-type="bibr" rid="B17">Rothberg and Leamon, 2008</xref>). Meanwhile, analytical tools have been developed, including multiple sequence alignments (<xref ref-type="bibr" rid="B4">DeSantis <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="B11">Katoh <italic>et al.</italic>, 2005</xref>), pairwise alignments (global/local) (<xref ref-type="bibr" rid="B14">Needleman and Wunsch, 1970</xref>) and clustering (<xref ref-type="bibr" rid="B19">Schloss and Handelsman, 2005</xref>; <xref ref-type="bibr" rid="B20">Schloss <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B23">Sun <italic>et al.</italic>, 2009</xref>), by which we are able to address the fundamental problems in Metagenomics, in particular, the distribution, abundance and co-occurrence of microorganisms in given environmental samples. Recent studies have shown that such information may indicate environmental changes or disease conditions (<xref ref-type="bibr" rid="B7">Grice <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B12">Marco, 2010</xref>).</p>
    <p>16S rRNA gene sequences are widely used to infer the phylogenetic relationship between organisms. That is, by comparing two 16S rRNA gene sequences, biologists can determine whether they belong to the same genus using a conventional threshold of 5% dissimilarity, or the same species using a conventional threshold of 3% dissimilarity, although the validity of using these thresholds has not been proven. By combining sequence comparison with hierarchical clustering methods, programs such as DOTUR (<xref ref-type="bibr" rid="B19">Schloss and Handelsman, 2005</xref>) and its current version mothur (<xref ref-type="bibr" rid="B20">Schloss <italic>et al.</italic>, 2009</xref>), and ESPRIT (<xref ref-type="bibr" rid="B23">Sun <italic>et al.</italic>, 2009</xref>) can partition 16S rRNA sequence data into clusters. Then, by using a predefined dissimilarity threshold, these methods can, in turn, report sequence clusters satisfying certain criteria (complete/average/single-linkage). In hierarchical clustering, the complete linkage and the average linkage methods are more widely used than the single linkage method (<xref ref-type="bibr" rid="B15">Quince <italic>et al.</italic>, 2009</xref>).</p>
    <p>However, a common problem with these clustering methods is the sensitivity of the results to the dissimilarity threshold such that even a slight change can result in very different clusters. Furthermore, the inevitable sequencing errors, as well as the unknown structure of microorganisms underlying an environmental sample, make it very difficult to find the optimal threshold for hierarchical clustering. For these reasons, the otherwise simple choice of 5 and 3% thresholds becomes problematic (<xref ref-type="bibr" rid="B9">Huse <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B12">Marco, 2010</xref>) and may result in the overestimation of operational taxonomic units (OTUs). <xref ref-type="bibr" rid="B15">Quince <italic>et al.</italic> (2009</xref>) showed that hierarchical clustering methods overestimated the number of OTUs in a given sample when sequencing errors occurred, potentially leading to faulty conclusions. <xref ref-type="bibr" rid="B23">Sun <italic>et al.</italic> (2009</xref>) also explained that distance calculated from multiple alignment was, in general, larger than those calculated from pairwise alignments and thus might also result in overestimation of the number of OTUs.</p>
    <p>In addition to the aforementioned reasons, Schloss listed and analyzed many other factors that may result in overestimation of hierarchical clustering (<xref ref-type="bibr" rid="B18">Schloss, 2010</xref>). Many groups have taken steps to address these problems. For example, mothur included a single linkage preclustering module to merge similar sequences before clustering (<xref ref-type="bibr" rid="B20">Schloss <italic>et al.</italic>, 2009</xref>), and PyroNoise (<xref ref-type="bibr" rid="B15">Quince <italic>et al.</italic>, 2009</xref>) was developed to remove sequencing errors to alleviate the overestimation of the number of OTUs.</p>
    <p>The large size of datasets currently being produced by the next-generation sequencing machines accounts for still another challenge in clustering 16S rRNA sequences. In the process of hierarchical clustering, it is necessary to calculate a distance matrix by comparing all pairs of sequences in order to find the proper clusters to merge (<xref ref-type="bibr" rid="B10">Johnson, 1967</xref>). As a result, the computational complexity is at least quadratic, <italic>O</italic>(<italic>N</italic><sup>2</sup>), in terms of the number of sequences (<italic>N</italic>). Thus, for large-scale datasets, traditional hierarchical clustering methods quickly arrive at a bottleneck in terms of computational time and memory usage. Although ESPRIT (<xref ref-type="bibr" rid="B23">Sun <italic>et al.</italic>, 2009</xref>) has improved these factors by using an approximated <italic>k</italic>-mer distance to reduce the burden of calculating pairwise alignments and by parallelizing the pairwise alignment process on a computer cluster and clustering sequences on-the-fly, its algorithm can only support complete linkage instead of average linkage clustering.</p>
    <p>In this paper, we therefore propose an unsupervised Bayesian clustering method termed Clustering 16S rRNA for OTU Prediction (CROP), which specifically addresses the problems of OTU overestimation, computational efficiency and memory requirement. This Bayesian method, if modeled properly, can infer the optimal clustering results without setting a simple equal dissimilarity threshold for every cluster. Previously, similar ideas which use probability models for clustering have been applied to classify protein subgroups. Proponents of this approach (<xref ref-type="bibr" rid="B1">Brown, 2008</xref>; <xref ref-type="bibr" rid="B13">Marttinen <italic>et al.</italic>, 2006</xref>) considered every column of a multiple alignment to be a sample from an underlying multinomial distribution, therefore, the product of the probability mass function of all columns could form a likelihood function. However, because the sequences of 16S rRNA genes are usually much longer than the protein domains, this model is computationally impractical for long sequences and large datasets. Another probabilistic approach called Markov Clustering (<xref ref-type="bibr" rid="B6">Enright <italic>et al.</italic>, 2002</xref>) used random walk and matrix transformations on a given distance matrix to form clusters to detect protein families. However, this approach currently cannot be applied directly to 16S rRNA sequence clustering, since the clustering results at different similarity levels are desirable as they correspond to different phylogenetic levels. Thus, applying a probabilistic approach to the clustering of 16S rRNA sequences requires the identification of parameter subspaces in which the optimal clustering results correspond to the partitions of the dataset at the desired phylogenetic level. Markov Clustering only has an inflation parameter to tune. The direct relationship between the inflation parameter and similarity levels is hard to establish.</p>
    <p>To address above-mentioned problems, we use the Gaussian mixture model to describe the data (<xref ref-type="sec" rid="SEC2">Section 2</xref>). The key concept of our method replaces the mean value of a Gaussian distribution and instead uses a âcenterâ sequence to characterize a specific cluster. Thus, if we consider the sequences as data points in a high-dimensional space and we calculate the pairwise distances as the distance between two data points, then the probability that a sequence belongs to a cluster becomes a function of the distance between the sequence and the center. The nature of Gaussian distributions can handle sequencing errors as well as sequence variations. However, by restricting the parameter space of the standard deviations of the Gaussian distributions, we could limit our probabilistic search to the parameter subspace in which the clustering results reflect the desired partitions of the datasets and, hence, the accurate number of underlying OTUs (<xref ref-type="sec" rid="SEC2">Section 2</xref>). Based on this model, we can define the likelihood of the data and use a Markov Chain Monte Carlo (MCMC) approach to sample from the posterior distribution of the parameters to obtain the optimal clustering. The optimal result, which maximizes the posterior probability, will give all the quantities of interest, including the number of clusters, their relative abundance levels and the sequences in each cluster. <xref ref-type="bibr" rid="B16">Richardson and Green (1997</xref>) and <xref ref-type="bibr" rid="B22">Stephens (2000</xref>) have proposed MCMC methods to study the mixture model with an unknown number of components. In this application, we used a Markov birthâdeath process to build the Markov Chain with appropriate stationary distribution, as proposed by <xref ref-type="bibr" rid="B22">Stephens (2000</xref>). That is, in each step, a new cluster would be created, or an existing one would be deleted, according to which operation is more likely to increase the posterior probability. To enhance computational efficiency, we further introduced a hierarchical approach by splitting the data into small blocks, running Bayesian Clustering on each block independently, and then later merging these clustering results. We also introduced several criteria to reduce the burden of calculating Gaussian density functions, thereby accelerating the MCMC process (<xref ref-type="sec" rid="SEC2">Section 2</xref>).</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Gaussian mixture model</title>
      <p>We apply a Gaussian mixture model to 16S rRNA sequence data in which sequences <bold><italic>x</italic></bold> = (<italic>x</italic><sub>1</sub>,â¦, <italic>x</italic><sub><italic>N</italic></sub>) are assumed to be independently drawn from a mixture density with <italic>k</italic> clusters, where <italic>k</italic> is an unknown parameter,
<disp-formula><graphic xlink:href="btq725um1"/></disp-formula>
where <bold>Î¼</bold> = (Î¼<sub>1</sub>,â¦, Î¼<sub><italic>k</italic></sub>) and <bold>Ï</bold><sup>2</sup> = (Ï<sub>1</sub><sup>2</sup>,â¦, Ï<sub><italic>k</italic></sub><sup>2</sup>) are parameters for the centers and the variances, respectively, Î¼<sub><italic>i</italic></sub> and Ï<sub><italic>i</italic></sub><sup>2</sup> are specific to cluster <italic>i</italic>, and <bold>Ï</bold> = (Ï<sub>1</sub>,â¦, Ï<sub><italic>k</italic></sub>) are the non-negative mixture proportions which sum up to 1.</p>
      <p>We introduce the missing data <bold><italic>z</italic></bold> = (<italic>z</italic><sub>1</sub>,â¦, <italic>z</italic><sub><italic>N</italic></sub>) in which <italic>z</italic><sub><italic>i</italic></sub> specifies a mixture cluster to the observation of <italic>x</italic><sub><italic>i</italic></sub>. Suppose that each <italic>z</italic><sub><italic>i</italic></sub> is a realization of a discrete random variable <italic>Z</italic><sub><italic>i</italic></sub> and that all <italic>Z</italic><sub><italic>i</italic></sub>s (<italic>i</italic> = 1,â¦, <italic>N</italic>) are independent and identically distributed with the following probability mass function (pmf),
<disp-formula><graphic xlink:href="btq725um2"/></disp-formula>
Conditional on the latent variable <bold><italic>Z</italic></bold> = (<italic>Z</italic><sub>1</sub>,â¦, <italic>Z</italic><sub><italic>N</italic></sub>) the data {<italic>x</italic><sub>1</sub>,â¦, <italic>x</italic><sub><italic>N</italic></sub>} are assumed to be independently observed from the density:
<disp-formula><graphic xlink:href="btq725um3"/></disp-formula>
In our studies, we consider the situation in which the density <italic>f</italic>(<italic>x</italic><sub><italic>i</italic></sub>; Î¼<sub><italic>j</italic></sub>, Ï<sub><italic>j</italic></sub><sup>2</sup>) is a modified univariate Gaussian probability density function (pdf) with Î¼<sub><italic>j</italic></sub> as the center of the cluster and Ï<sub><italic>j</italic></sub><sup>2</sup> as the variance:
<disp-formula><graphic xlink:href="btq725um4"/></disp-formula>
where <italic>D</italic>(<italic>x</italic><sub><italic>i</italic></sub>, Î¼<sub><italic>j</italic></sub>) denotes the distance between the sequence <italic>x</italic><sub><italic>i</italic></sub> and the center of the <italic>j</italic>-th cluster Î¼<sub><italic>j</italic></sub>. We follow common approaches to assume a hierarchical model for the priors (with standard conjugacy):
<disp-formula><graphic xlink:href="btq725um5"/></disp-formula>
<disp-formula><graphic xlink:href="btq725um6"/></disp-formula>
where Î¼<sub><italic>i</italic></sub> is chosen randomly from <italic>x</italic><sub>1</sub>,â¦, <italic>x</italic><sub><italic>N</italic></sub> without replacement. The final form of the prior probability is
<disp-formula><graphic xlink:href="btq725um7"/></disp-formula>
and that of the posterior probability is
<disp-formula><graphic xlink:href="btq725um8"/></disp-formula></p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 The birthâdeath process</title>
      <p>To compute the parameters (Ï, Î¼, Ï<sup>2</sup>) which maximize <italic>P</italic>(Ï, Î¼, Ï<sup>2</sup>|<italic>x</italic>), we apply the MCMC method to construct an ergodic Markov Chain with the posterior distribution <italic>P</italic>(Ï, Î¼, Ï<sup>2</sup>|<italic>x</italic>) as its stationary distribution. We design a Markov birthâdeath process as follows.</p>
      <p>When the process is at a certain step <italic>t</italic><sub><italic>i</italic></sub>, and the number of existing clusters is <italic>k</italic>, the next step may be a âbirthâ with a probability <italic>P</italic><sub><italic>B</italic></sub>/(<italic>P</italic><sub><italic>B</italic></sub>+<italic>P</italic><sub><italic>D</italic></sub>), or a âdeathâ with a probability <italic>P</italic><sub><italic>D</italic></sub>/(<italic>P</italic><sub><italic>B</italic></sub>+<italic>P</italic><sub><italic>D</italic></sub>), where <italic>P</italic><sub><italic>B</italic></sub> and <italic>P</italic><sub><italic>D</italic></sub> are the probability of a âbirthâ and a âdeathâ, respectively. <italic>P</italic><sub><italic>B</italic></sub> is given as a constant in our study, and <italic>P</italic><sub><italic>D</italic></sub> is defined as:
<disp-formula><graphic xlink:href="btq725um9"/></disp-formula>
where <italic>d</italic><sub><italic>i</italic></sub> is the probability for a cluster to âdieâ. The way to compute <italic>d</italic><sub><italic>i</italic></sub> is shown in a later section.</p>
      <p><italic>Births</italic>: the (<italic>k</italic>+1)-th cluster is born with a new center Î¼<sub><italic>k</italic>+1</sub> randomly chosen from <italic>x</italic><sub>1</sub>,â¦, <italic>x</italic><sub><italic>N</italic></sub> and Î¼<sub><italic>k</italic>+1</sub>â Î¼<sub><italic>i</italic></sub> (<italic>i</italic> = 1,â¦, <italic>k</italic>). The choice of Î¼<sub><italic>k</italic>+1</sub> is based on the density:
<disp-formula><graphic xlink:href="btq725um10"/></disp-formula>
where (Î¼<sub><italic>t</italic></sub>, Ï<sub><italic>t</italic></sub><sup>2</sup>) are the parameters of the cluster to which <italic>x</italic><sub><italic>i</italic></sub> is currently being assigned. Hence, Î¼<sub><italic>k</italic>+1</sub> is preferred over those <italic>x</italic><sub><italic>i</italic></sub>'s which are far away from the center of the cluster to which they currently belong. For other parameters of the new cluster, the priors are given as follows:
<disp-formula><graphic xlink:href="btq725um11"/></disp-formula>
<disp-formula><graphic xlink:href="btq725um12"/></disp-formula>
Then the existing parameters need to be updated (<italic>i</italic> = 1,â¦, <italic>k</italic>) by:
<disp-formula><graphic xlink:href="btq725um13"/></disp-formula>
<italic>Deaths</italic>: an existing cluster dies independently of others with a probability
<disp-formula><graphic xlink:href="btq725um14"/></disp-formula>
where <italic>L</italic><sub>â<italic>i</italic></sub> indicates the likelihood without the <italic>i</italic>-th cluster and <italic>L</italic> indicates the likelihood with the <italic>i</italic>-th cluster:
<disp-formula><graphic xlink:href="btq725um15"/></disp-formula>
<disp-formula><graphic xlink:href="btq725um16"/></disp-formula>
Let <italic>N</italic><sub><italic>c</italic></sub> be the number of clusters. We use the Poisson distribution as its prior to simplify the form of <italic>d</italic><sub><italic>i</italic></sub>, as suggested by <xref ref-type="bibr" rid="B22">Stephens (2000</xref>):
<disp-formula><graphic xlink:href="btq725um17"/></disp-formula>
Then we have a simplified form for the death probability <italic>d</italic><sub><italic>i</italic></sub> for each cluster:
<disp-formula><graphic xlink:href="btq725um18"/></disp-formula>
We update Ï<sub><italic>j</italic></sub> (<italic>j</italic> = 1,â¦, <italic>i</italic>â1, <italic>i</italic>+1,â¦, <italic>k</italic>) to reflect the death effect of the <italic>i</italic>-th cluster
<disp-formula><graphic xlink:href="btq725um19"/></disp-formula>
For more details about the birthâdeath process, refer to (<xref ref-type="bibr" rid="B22">Stephens, 2000</xref>).</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 MCMC sampling</title>
      <p>We update the parameters for the hierarchical mixture model in each step:
<list list-type="order"><list-item><p>Update <italic>z</italic> by
<disp-formula><graphic xlink:href="btq725um20"/></disp-formula></p></list-item><list-item><p>Update Ï by
<disp-formula><graphic xlink:href="btq725um21"/></disp-formula>
where (<italic>n</italic><sub>1</sub>,â¦, <italic>n</italic><sub><italic>k</italic></sub>) are the numbers of data points belonging to individual mixture clusters. In other words, for <italic>j</italic> = 1,â¦, <italic>k</italic>,
<disp-formula><graphic xlink:href="btq725um22"/></disp-formula></p></list-item><list-item><p>Update <bold>Ï</bold><sup>2</sup> using the general approach as follows:
<disp-formula><graphic xlink:href="btq725um23"/></disp-formula>
Richardson and Stephens suggested another hierarchical level over Î²
<disp-formula><graphic xlink:href="btq725um24"/></disp-formula>
where <italic>g</italic> and <italic>h</italic> are hyperparameters. However, as <xref ref-type="bibr" rid="B16">Richardson and Green (1997</xref>) mentioned, when applying the mixture model to the Bayesian classification, such update procedure would result in some clusters with a large variance, and its heavy tail would have a negative influence on the clustering result. This is because most methods assume that variances of clusters are similar to one another. Also, as mentioned before, restricting the variances is fundamental to obtain clustering results at different phylogenetic levels.</p><p>In our method, we nested Ï<sup>2</sup> by upper bound <italic>U</italic> and lower bound <italic>L</italic>. That is to say, if Ï<sub><italic>i</italic></sub><sup><italic>2</italic></sup> &lt; <italic>L</italic> or Ï<sub><italic>i</italic></sub><sup><italic>2</italic></sup> &gt; <italic>U</italic>, we would restart the updating procedure of Ï<sub><italic>j</italic></sub><sup>2</sup> as indicated below:
<disp-formula><graphic xlink:href="btq725um25"/></disp-formula>
where Î²<sup>â²</sup> is a given constant satisfying
<disp-formula><graphic xlink:href="btq725um26"/></disp-formula></p></list-item><list-item><p>Update <bold>Î¼</bold>:</p><p>Since <bold>Î¼</bold> is a vector of sequences chosen from data instead of a common numerical vector, we sample the center for each cluster in the following way.</p></list-item></list>
</p>
      <p>For the <italic>j</italic>-th cluster, there are <italic>n</italic><sub><italic>j</italic></sub> sequences. Each <italic>n</italic><sub><italic>j</italic></sub> sequence is a potential candidate to be the center of this cluster. Let these sequences be <italic>X</italic><sub><italic>j</italic></sub> = {<italic>x</italic><sub><italic>j</italic>1</sub>,â¦, <italic>x</italic><sub><italic>jnj</italic></sub>}. The likelihood of this cluster is defined as
<disp-formula><graphic xlink:href="btq725um27"/></disp-formula>
where Î¼<sub><italic>j</italic></sub> is the center of the cluster, Ï<sub><italic>j</italic></sub><sup>2</sup> is the variance, and <italic>f</italic> is the Gaussian probability density function. Thus, for two candidate centers Î¼<sub><italic>j</italic></sub> and Î¼<sub><italic>j</italic></sub><sup>â²</sup>, we have
<disp-formula><graphic xlink:href="btq725um28"/></disp-formula>
which suggests a brute force method to sample the center sequence. Assume that
<disp-formula><graphic xlink:href="btq725um29"/></disp-formula>
and then for each <italic>x</italic><sub><italic>ji</italic></sub> â <italic>X</italic><sub><italic>j</italic></sub>, let Î´<sub><italic>i</italic></sub> denote the probability of choosing <italic>x</italic><sub><italic>ji</italic></sub> as the new center of this cluster
<disp-formula><graphic xlink:href="btq725um30"/></disp-formula>
So we can define
<disp-formula><graphic xlink:href="btq725um31"/></disp-formula>
and then sample a new center for each cluster.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Prior setting</title>
      <p>Based on the priors suggested by <xref ref-type="bibr" rid="B16">Richardson and Green (1997</xref>) and <xref ref-type="bibr" rid="B22">Stephens (2000</xref>), with some minor modifications, we set
<disp-formula><graphic xlink:href="btq725um32"/></disp-formula>
where <italic>R</italic> = MaxâMin is the range of the data.</p>
      <p><italic>L</italic> and <italic>U</italic>, as the lower and upper bounds for variances, are determined by the different levels of accuracy to be achieved. For the dissimilarity threshold at roughly 3%, we suggest setting <italic>L</italic> = 1 and <italic>U</italic> = 2.25 (mentioned as clustering at â¼3% in later sections) so that the standard deviations of the Gaussian distributions in the mixture model will range from 1 to 1.5. For the threshold at 5%, we suggest setting <italic>L</italic> = 2.25 and <italic>U</italic> = 6.25 (mentioned as clustering at â¼5% in later sections) so that the standard deviations of Gaussian distributions in the mixture model will range from 1.5 to 2.5. It is the nature of Gaussian distribution that 95% of its density falls into the interval [Î¼ â 2Ï, Î¼ + 2Ï]. As such, the choice of <italic>U</italic>s, as noted above, virtually guarantees that at least 95% of the sequences in a given cluster will be &lt;3% (if <italic>U</italic> = 2.25) or 5% (if <italic>U</italic> = 6.25) dissimilar from the center sequence in the cluster. At the same time, the choice of <italic>L</italic>s, as noted above, helps to maintain the assumption that all Gaussian distributions in a mixture model will have similar variances. Under these circumstances, the settings suggested above for both <italic>L</italic>s and <italic>U</italic>s should give results comparable with those of conventional hierarchical clustering methods that used 3 and 5% dissimilarity cutoffs, respectively. Although our approach is still associated with previously mentioned controversial 3 and 5% thresholds, it produces clusters with different standard deviations and its probabilistic nature fits better with real data. The settings of <italic>L</italic>s and <italic>U</italic>s, as noted above, were used for all downstream analysis. Users can define their own <italic>L</italic>s and <italic>U</italic>s in CROP.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Pairwise alignment and distance</title>
      <p>The NeedlemanâWunsch algorithm (<xref ref-type="bibr" rid="B14">Needleman and Wunsch, 1970</xref>) was used for pairwise alignment. However, we do not perform the dynamic programming on the whole matrix, only on a band near the diagonal with a width of 5% of the sequence length at each side. By doing this, we mainly focus on those sequence pairs with &gt;90% similarity. The Quickdist algorithm (<xref ref-type="bibr" rid="B21">Sogin <italic>et al.</italic>, 2006</xref>), which considers consecutive gaps in an alignment as one gap, is used to calculate the pairwise distance from the alignment results. Every distance is calculated as a percentage number in our approach. That is to say, a distance of 5.2 indicates 5.2% dissimilarity.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Computation</title>
      <p>The most time-consuming part of Bayesian clustering is the pairwise alignment. The second most time-consuming part of the process involves updating centers, which is <italic>O</italic>(<italic>N</italic><sup>2</sup>/<italic>k</italic>) (where <italic>N</italic> is the number of sequences and <italic>k</italic> is the number of clusters), whereas calculating the Gaussian probability density functions for all iterations and sequences is also a costive step. In order to improve the computational efficiency of Bayesian clustering, we introduce three operations, as noted below:
<list list-type="order"><list-item><p>When the calculated dissimilarity <italic>D</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic><sub><italic>j</italic></sub>) between two sequences <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> is &gt;15%, we set the Gaussian probability density function involving this distance to be 0. That is to say, we consider
<disp-formula><graphic xlink:href="btq725um33"/></disp-formula>
if <italic>D</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic><sub><italic>j</italic></sub>)â¥ 15%.</p></list-item><list-item><p>If the standard deviation of a cluster is Ï<sub>(<italic>t</italic>)</sub> and in next iteration, the updated value Ï<sub>(<italic>t</italic>+1)</sub> satisfies 0.9Ï<sub>(<italic>t</italic>)</sub> â¤ Ï<sub>(<italic>t</italic>+1)</sub> â¤ 1.1Ï<sub>(<italic>t</italic>)</sub>, then for this cluster, we consider
<disp-formula><graphic xlink:href="btq725um34"/></disp-formula>
where Î¼ is the center of this cluster and <italic>x</italic> is a sequence in this cluster.</p></list-item><list-item><p>Update all cluster centers if the current iteration gives birth to a new cluster; otherwise, we do not update centers. In addition, we do not update cluster centers for those clusters consisting of fewer than five sequences.</p></list-item></list>
</p>
      <p>The first and second operations dramatically reduce the computational time for calculating the Gaussian pdfs, while the third operation avoids unnecessary updating of cluster centers. In practice, these operations do not compromise the accuracy of the results.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 CROP work flow</title>
      <p><xref ref-type="fig" rid="F1">Figure 1</xref> shows a flowchart of CROP. First, the dataset is randomly split into blocks of 100â1000 sequences each. Generally, a smaller block size is preferred for longer sequences, such as full-length 16S rRNA gene sequences, while a larger block size is preferred for shorter sequences, such as one single hyper-variable region. Then, an independent Bayesian clustering is applied to each block. A distance matrix is generated for each block using the pairwise alignment algorithm. We run 20*(block size) iterations of MCMC, considering the first 10*(block size) iterations as burn-in. From all the iterations after burn-in, we choose the one with the largest posterior probability and report it as our clustering result for this block.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>CROP workflow.</p></caption><graphic xlink:href="btq725f1"/></fig></p>
      <p>At the next level of the hierarchical approach, every cluster in each block is treated as one sequence with the center sequence as the representative, and all these center sequences are pooled and further split into blocks. However, a slightly different distance matrix is computed for each block. The matrix is a âcenter sequences against clustersâ matrix, in which the (<italic>i</italic>, <italic>j</italic>) entry indicates the distance between the <italic>i</italic>-th center sequence and the <italic>j</italic>-th cluster. We calculate this distance by the average distance between the <italic>i</italic>-th center sequence and <italic>C</italic> randomly chosen sequences from the <italic>j</italic>-th cluster (<italic>C</italic> = 20 is set for clusters with &gt;20 sequences):
<disp-formula><graphic xlink:href="btq725um35"/></disp-formula>
Finally, using this distance matrix, we apply a weighted Bayesian clustering on these clusters such that the weight is proportional to the size of the cluster, and this process will continue until one of the conditions noted below is satisfied.
<list list-type="order"><list-item><p>The number of the clusters is &gt;90% of the number of sequences. (This means most sequences are forming a cluster by themselves. Thus, split and merge process will not be able to reduce the dimension of the data efficiently any more.)</p></list-item><list-item><p>The number of the clusters is smaller than a predetermined threshold.</p></list-item><list-item><p>The process has been running for <italic>N</italic> times, where <italic>N</italic> is a predetermined threshold.</p></list-item></list>
After the previous process, we will run one more round of Bayesian clustering on all the remaining clusters, and this result will constitute the final report. However, as a probabilistic approach, CROP may get slightly different results in different runs. Thus, in later sections, 10 runs were performed for all experiments, and the result with the highest posterior probability was chosen if not specified.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Estimating the number of OTUs</title>
      <p>We first validated our method using a dataset described by <xref ref-type="bibr" rid="B8">Huse <italic>et al.</italic> (2007</xref>), which consisted of amplicons of V6 regions from 43 16S rRNA templates which were at least 3% different from each other. The sequenced reads were further categorized into two datasets. The first one (A) contained only those reads that were within 3% of one of the 43 templates, and the second dataset (B) contained all the reads. These two datasets consisted of 191 387 and 202 340 reads, respectively. To obtain the ground truth, we ran hierarchical clustering (using ESPRIT) on 43 template sequences. Then we compared CROP, ESPRIT and mothur (with and without the single linkage preclustering) using datasets (A) and (B) to obtain the number of OTUs. Default parameters were used for ESPRIT and mothur. For mothur, we used the same pairwise alignment program as implemented in ESPRIT to calculate a phylip format distance matrix and then specified the average linkage in clustering.</p>
      <p>We ran the three programs on dataset (A) and the results were compared in <xref ref-type="fig" rid="F2">Figure 2</xref>A. CROP identified 43 clusters when clustering at â¼3% (by using variance interval [1, 2.25], if unspecified). In 10 runs, CROP averaged 43.5Â±0.5 clusters, among which the result with 43 clusters gave the largest posterior probability. When clustering at â¼5% (by using variance interval [2.25, 6.25], if unspecified), CROP produced 42 clusters. In 10 runs, CROP averaged 43Â±0.8 clusters, among which the result with 42 clusters gave the largest posterior probability. Both results were in exact agreement with the ground truth.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Comparison of the number of OTUs predicted by CROP, ESPRIT and mothur (with and without single linkage preclustering) using two sequencing datasets generated from 43 16S rRNA templates (by <xref ref-type="bibr" rid="B8">Huse <italic>et al.</italic>, 2007</xref>). Dataset (<bold>A</bold>) contains reads that are within 3% of the templates, and Dataset (<bold>B</bold>) contains all the raw reads.</p></caption><graphic xlink:href="btq725f2"/></fig></p>
      <p>To judge the accuracy of the predicted clusters, we compared cluster center sequences with the template sequences and assigned the cluster center with its most similar template sequence. We found that each template sequences, both at 3 and 5% thresholds, was uniquely assigned by a cluster center in â¼3 and â¼5% results, respectively, indicating 100% accuracy.</p>
      <p>Then, we ran the three programs on the dataset (B). CROP identified 65 clusters when clustering at â¼3%. In 10 runs, CROP averaged 67.7Â±2.4 clusters. When clustering at â¼5%, the number of clusters decreased to 45, and averaged 45Â±1 in 10 runs. We also mapped the resulting center sequences to their nearest template sequences to access the accuracy of the results. In the â¼5% result, 43 out of 45 cluster centers were &lt;5% dissimilar from their nearest template sequences, while the remaining 2 cluster centers were &gt;10% dissimilar from their nearest templates. These two clusters were quite small, containing &lt; 10 sequences. Similar observations were found for the â¼3% results where 43 out of 65 cluster centers were &lt; 3% dissimilar from their nearest template sequences and each of the 43 template sequences is uniquely mapped by one of these 43 cluster centers, while the remaining 22 cluster centers were &gt; 7% from their nearest template sequences and all of them are small (with &lt; 10 sequences).</p>
      <p>In comparison, CROP outperformed both ESPRIT and mothur, both of which overestimated the number of OTUs. As expected, mothur did a better job than ESPRIT when using the average linkage algorithm and the single linkage preclustering significantly improved the performance of the hierarchical clustering. However, in general, CROP is still more robust in dealing with sequencing errors and produces more accurate clustering results.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Validation results using a dataset of 90 artificial bacteria clones</title>
      <p>We also obtained Quince's dataset (<xref ref-type="bibr" rid="B15">Quince <italic>et al.</italic>, 2009</xref>) that consisted of 34 308 reads (12 360 unique reads) sequenced from V5 and V6 regions of 90 different clones of bacteria. This dataset contains very similar species (&lt; 3% difference) and thus is appropriate for testing CROP's effectiveness on distinguishing closely related species. We applied CROP to this dataset using various intervals for the standard deviations of the Gaussian distributions. In addition to â¼3 and â¼5%, interval [0.2,0.5] was, for example, used to compare with the 1% dissimilarity threshold in hierarchical clustering, and interval [0.5,1] was, for example, used to compare with the 2% dissimilarity threshold in hierarchical clustering. The results were compared with the ground truth, as well as with those obtained from mothur (<xref ref-type="bibr" rid="B20">Schloss <italic>et al.</italic>, 2009</xref>) with and without the single linkage preclustering (only unique reads used), and PyroNoise (<xref ref-type="bibr" rid="B15">Quince <italic>et al.</italic>, 2009</xref>) followed by mothur. (The dataset was preprocessed with PyroNoise in order to reduce the noise in original data to improve the performance of hierarchical clustering in this case.) The input for mothur is the distance matrix we calculated using the pairwise alignment instead of the default multiple alignment. We chose the average linkage over the complete linkage in mothur, as the average linkage had been shown to produce better results by <xref ref-type="bibr" rid="B15">Quince <italic>et al.</italic> (2009</xref>).</p>
      <p>As shown in <xref ref-type="fig" rid="F3">Figure 3</xref>, mothur (preclustering) and PyroNoise (plus mothur) overestimated the number of OTUs. By mapping the cluster center sequences in CROP's result to the clusters in the result of PyroNoise's (plus mothur), we found that CROP achieved a result similar to that of PyroNoise's (plus mothur) at the regions with â¥ 2% dissimilarity in terms of the number of clusters and cluster contents detected. However, as the threshold decreased, especially at â¤1% dissimilarity regions, CROP did overestimate the number of OTUs because the sequencing error rate was around 1%. The single linkage preclustering slightly improved the performance of the hierarchical clustering. Although the improvement was not as significant as the previous case, it did reduce the number of sequences to be clustered from 12 360 to 5370, and thus could be still helpful in dealing with large datasets. In general, CROP achieved a performance similar to that of PyroNoise (plus mothur) at 5 and 3% and did so using significantly less computational time and without modeling the sequencing errors. PyroNoise alone used more than 1 day on cluster computers with 128 CPUs to process these datasets as reported by the study, while CROP completed the work within 3 h using a single CPU.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Comparison of the number of OTUs found by CROP, PyroNoise (plus mothur) and mothur, in which the results for CROP are shown both as a straight dashed line indicating the number of OTUs when using different parameters and as an approximated average lineage-through-time curve (CROP Assumption).</p></caption><graphic xlink:href="btq725f3"/></fig></p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Estimating abundance levels of clusters using the human skin microbiome dataset</title>
      <p>In this application, we applied CROP to the human skin microbiome data by <xref ref-type="bibr" rid="B7">Grice <italic>et al.</italic> (2009</xref>). We first chose a skin site, the axillary vault (AV) of patient HV5 consisting of 1130 nearly full-length 16S rRNA sequences. Then we used the ribosomal database project (RDP) classifier (<xref ref-type="bibr" rid="B2">Cole <italic>et al.</italic>, 2009</xref>) to infer the taxonomy for each sequence. These results were considered to be the ground truth in this experiment. According to this ground truth, we found that the original result (<xref ref-type="bibr" rid="B7">Grice <italic>et al.</italic>, 2009</xref>) underestimated the abundance of the genus <italic>Propionibacteria</italic>. Then we applied CROP to cluster this dataset at â¼5%. To compare our clustering results with the ground truth, we assigned genera to each cluster by searching the center sequence in the RDP database. CROP identified 34 clusters. <xref ref-type="fig" rid="F4">Figure 4</xref>A shows that our results are very similar to the ground truth and that among the 33 detected genera in the ground truth, 32 are uniquely mapped by 32 clusters in our results. The only difference between our results and the ground truth occurs in the class Actinobacteria, where four sequences belonging to the genus <italic>Williamsia</italic> are assigned to the genus <italic>Mycobacterium</italic> and <italic>Corynebacterium</italic> (<xref ref-type="fig" rid="F4">Fig. 4</xref>B). All three of these genera are in the same suborder Corynebacterineae. In comparison, mothur (using the average linkage) produces 47 clusters, overestimating the number of genera by 43%.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>The clustering results (by CROP) of the human microbial sequencing data at the AV skin location: (<bold>A</bold>) â¼5% results and the ground truth and (<bold>B</bold>) more detailed results inside the âOther Actinobacteriaâ.</p></caption><graphic xlink:href="btq725f4"/></fig></p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 Comparing different microbial communities using the human skin microbiome dataset</title>
      <p>Finally, we applied CROP to three human skin microbiome datasets: sebaceous (including glabella, alar crease, external auditory canal, occiput, manubirum and back), moist (including nare, AV, antecubital fossa, interdigital web space, inguinal crease, gluteal crease, popliteal fossa, plantar heel and umbilicus) and dry (including volar forearm, hypothenar palm and buttock). After clustering, every cluster center was searched against the RDP database to determine the taxonomy of this cluster. The results are shown in Supplementary <xref ref-type="fig" rid="F1">Figure 1</xref>. Betaproteobacteria is shown to dominate the dry locations, while Corynebacteria and <italic>Propionibacteria</italic>, both belonging to Actinobacteria, are shown to dominate the moist and sebaceous locations, respectively.</p>
      <p>To study the species similarity and difference between different skin locations, while also to validate CROP at species level using real environmental data, we merged all sequences, clustered them using CROP at â¼3%, and computed the Jaccard index value and the Theta index value (<xref ref-type="bibr" rid="B7">Grice <italic>et al.</italic>, 2009</xref>) to see if we got consistent species-level result with previous studies. The Jaccard index value measures the sample membership by the proportion of shared OTUs between the two samples. The Theta index value measures the sample structure by taking OTU abundance levels into consideration. Basically, the similarity of the two samples tends to increase as both Jaccard and Theta index values increase. These results show that the Jaccard index values of the two skin locations with the same environmental conditions (dry, moist or sebaceous) were not significantly different from those with different environmental conditions (<italic>P</italic> = 0.53, two-sided <italic>t</italic>-test); however, the Theta index values did show significant differences (<italic>P</italic> = 2.33 Ã 10<sup>â25</sup>, two-sided <italic>t</italic>-test). These results suggest that the environmental conditions might not significantly affect the composition of the bacterial communities located on the human skin, but they could instead affect the relative abundance levels. The pairwise Theta index values between skin locations are shown in <xref ref-type="fig" rid="F5">Figure 5</xref>B. Using these pairwise Theta index values as a distance measure, we clustered these 18 skin locations using hierarchical clustering (<xref ref-type="fig" rid="F5">Fig. 5</xref>A). The figure shows that skin locations are not clustered together strictly following their environmental conditions. For example, the antecubital fossa and the interdigital web space, both moist, are more similar to the volar forearm and the hypothenar palm, both dry, than to each other. Thus, it appears most likely that a spatial relationship dominates the environmental conditions in these cases, as all four skin locations are found on the human forearms. It might therefore be concluded that environments and locations on the human body co-determine the human microbiome distribution, a theory which agrees with what was found in another human skin microbiome study (<xref ref-type="bibr" rid="B3">Costello <italic>et al.</italic>, 2009</xref>).
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>The Theta index values and the phylogenetic tree constructed based on these values. (<bold>A</bold>) Phylogenetic tree of 18 human skin locations with their environmental conditions annotated in brackets. (<bold>B</bold>) Theta index values shown as a heatmap.</p></caption><graphic xlink:href="btq725f5"/></fig></p>
      <p>Rarefaction curves for each of the three types of skin locations are drawn in <xref ref-type="fig" rid="F6">Figure 6</xref>, showing that the sebaceous locations are less diverse than the moist or dry locations with respect to the number of OTUs. These conclusions are consistent with a previous study (<xref ref-type="bibr" rid="B7">Grice <italic>et al.</italic>, 2009</xref>). Results from mothur (with preclustering, pairwise alignment and the average linkage) are also shown in <xref ref-type="fig" rid="F6">Figure 6</xref> for comparison. Hierarchical clustering still overestimates the number of OTUs.
<fig id="F6" position="float"><label>Fig. 6.</label><caption><p>The rarefaction curves for all three human skin types.</p></caption><graphic xlink:href="btq725f6"/></fig></p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>CROP provides a clustering tool that automatically determines the best clustering result for 16S rRNA sequences at different phylogenetic levels. Yet, at the same time, it is able to manage large datasets and to overcome sequencing errors. Our study shows that CROP gives accurate clustering results, both in terms of the number of clusters and their abundance levels, for various types of 16S rRNA datasets. In contrast, the standard hierarchical clustering strategy, even with the preclustering process and the average linkage method, still frequently overestimates the number of OTUs in the presence of sequencing errors, resulting in an underestimation of the abundance level of the underlying OTUs. In addition, we demonstrate by using the human skin dataset that the results produced by CROP can provide compelling biological insights into different microbial communities.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_5_611__index.html"/>
      <media xlink:role="associated-file" mimetype="image" mime-subtype="tiff" xlink:href="supp_btq725_Fig5_8-26.tif"/>
      <media xlink:role="associated-file" mimetype="image" mime-subtype="tiff" xlink:href="supp_btq725_SuppFig1.tif"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We appreciate the editor and three reviewers for their comments and suggestions to revise this article.</p>
    <p><italic>Funding</italic>: <funding-source>National Institutes of Health</funding-source>; Center of Excellence in Genomic Sciences (CEGS) 2P50 HG002790-06; <funding-source>National Science Foundation of China</funding-source> (<award-id>60805010</award-id>).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>Efficient functional clustering of protein sequences using the Dirichlet process</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1765</fpage>
        <lpage>1771</lpage>
        <pub-id pub-id-type="pmid">18511467</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The ribosomal database project: improved alignments and new tools for rRNA analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D141</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="pmid">19004872</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bacterial community variation in human body habitats across space and time</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>1694</fpage>
        <lpage>1697</lpage>
        <pub-id pub-id-type="pmid">19892944</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
            <suffix>Jr</suffix>
          </name>
          <etal/>
        </person-group>
        <article-title>NAST: a multiple sequence alignment server for comparative analysis of 16S rRNA genes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>W394</fpage>
        <lpage>W399</lpage>
        <pub-id pub-id-type="pmid">16845035</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Environmental shotgun sequencing: its potential and challenges for studying the hidden world of microbes</article-title>
        <source>PLoS Biol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e82</fpage>
        <pub-id pub-id-type="pmid">17355177</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Enright</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An efficient algorithm for large-scale detection of protein families</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>1575</fpage>
        <lpage>1584</lpage>
        <pub-id pub-id-type="pmid">11917018</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grice</surname>
            <given-names>EA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topographical and temporal diversity of the human skin microbiome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <fpage>1190</fpage>
        <lpage>1192</lpage>
        <pub-id pub-id-type="pmid">19478181</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accuracy and quality of massively parallel DNA pyrosequencing</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R143</fpage>
        <pub-id pub-id-type="pmid">17659080</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ironing out the wrinkles in the rare biosphere through improved OTU clustering</article-title>
        <source>Environ. Microbiol.</source>
        <year>2010</year>
        <volume>12</volume>
        <fpage>1889</fpage>
        <lpage>1898</lpage>
        <pub-id pub-id-type="pmid">20236171</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical clustering schemes</article-title>
        <source>Psychometrika</source>
        <year>1967</year>
        <volume>32</volume>
        <fpage>241</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="pmid">5234703</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>511</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">15661851</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Marco</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Metagenomics: Theory, Methods and Applications</source>
        <year>2010</year>
        <publisher-loc>Norwich</publisher-loc>
        <publisher-name>Caister Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marttinen</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bayesian search of functionally divergent protein subgroups and their function specific residues</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2466</fpage>
        <lpage>2474</lpage>
        <pub-id pub-id-type="pmid">16870932</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J. Mol. Biol.</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate determination of microbial diversity from 454 pyrosequencing data</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>639</fpage>
        <lpage>641</lpage>
        <pub-id pub-id-type="pmid">19668203</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>On Bayesian analysis of mixtures with an unknown number of components</article-title>
        <source>J.R. Stat.Soc. Ser. B (Methodol.)</source>
        <year>1997</year>
        <volume>59</volume>
        <fpage>731</fpage>
        <lpage>792</lpage>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rothberg</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Leamon</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>The development and impact of 454 sequencing</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1117</fpage>
        <lpage>1124</lpage>
        <pub-id pub-id-type="pmid">18846085</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>The effects of alignment quality, distance calculation method, sequence filtering, and region on the analysis of 16S rRNA gene-based studies</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000844</fpage>
        <pub-id pub-id-type="pmid">20628621</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Introducing DOTUR, a computer program for defining operational taxonomic units and estimating species richness</article-title>
        <source>Appl. Environ. Microbiol.</source>
        <year>2005</year>
        <volume>71</volume>
        <fpage>1501</fpage>
        <lpage>1506</lpage>
        <pub-id pub-id-type="pmid">15746353</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Appl. Environ. Microbiol.</source>
        <year>2009</year>
        <volume>75</volume>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microbial diversity in the deep sea and the underexplored ârare biosphereâ</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2006</year>
        <volume>103</volume>
        <fpage>12115</fpage>
        <lpage>12120</lpage>
        <pub-id pub-id-type="pmid">16880384</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bayesian analysis of mixture models with an unknown number of components - an alternative to reversible jump methods</article-title>
        <source>Ann. Stat.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>40</fpage>
        <lpage>74</lpage>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ESPRIT: estimating species richness using large collections of 16S rRNA pyrosequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>e76</fpage>
        <pub-id pub-id-type="pmid">19417062</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
