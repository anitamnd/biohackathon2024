<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">mSystems</journal-id>
    <journal-id journal-id-type="iso-abbrev">mSystems</journal-id>
    <journal-id journal-id-type="publisher-id">msystems</journal-id>
    <journal-title-group>
      <journal-title>mSystems</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2379-5077</issn>
    <publisher>
      <publisher-name>American Society for Microbiology</publisher-name>
      <publisher-loc>1752 N St., N.W., Washington, DC</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8407386</article-id>
    <article-id pub-id-type="pmid">34402636</article-id>
    <article-id pub-id-type="publisher-id">mSystems00887-21</article-id>
    <article-id pub-id-type="doi">10.1128/mSystems.00887-21</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods and Protocols</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Refined Quantification of Infection Bottlenecks and Pathogen Dissemination with STAMPR</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-3064-2090</contrib-id>
        <name>
          <surname>Hullahalli</surname>
          <given-names>Karthik</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <email>hullahalli@g.harvard.edu</email>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pritchard</surname>
          <given-names>Justin R.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>d</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1843-7000</contrib-id>
        <name>
          <surname>Waldor</surname>
          <given-names>Matthew K.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <email>mwaldor@research.bwh.harvard.edu</email>
      </contrib>
      <aff id="aff1">
        <label>a</label>
        <addr-line>Department of Microbiology, <institution-wrap><institution>Harvard Medical School</institution><institution-id institution-id-type="grid">grid.471403.5</institution-id></institution-wrap>, Boston, Massachusetts, USA</addr-line>
      </aff>
      <aff id="aff2">
        <label>b</label>
        <addr-line>Division of Infectious Diseases, Brigham &amp; Women’s Hospital, Boston, Massachusetts, USA</addr-line>
      </aff>
      <aff id="aff3">
        <label>c</label>
        <addr-line>Department of Biomedical Engineering, Penn State University, University Park, Pennsylvania, USA</addr-line>
      </aff>
      <aff id="aff4">
        <label>d</label>
        <addr-line>Huck Institute for Life Sciences, University Park, Pennsylvania, USA</addr-line>
      </aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <role>Editor</role>
        <name>
          <surname>Garud</surname>
          <given-names>Nandita</given-names>
        </name>
        <aff>University of California, Los Angeles</aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn fn-type="other">
        <p><bold>Citation</bold> Hullahalli K, Pritchard JR, Waldor MK. 2021. Refined quantification of infection bottlenecks and pathogen dissemination with STAMPR. mSystems 6:e00887-21. <ext-link xlink:href="https://doi.org/10.1128/mSystems.00887-21" ext-link-type="uri">https://doi.org/10.1128/mSystems.00887-21</ext-link>.</p>
      </fn>
    </author-notes>
    <pub-date publication-format="electronic" date-type="pub">
      <day>17</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date publication-format="electronic" date-type="collection">
      <season>Jul-Aug</season>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>6</volume>
    <issue>4</issue>
    <elocation-id>e00887-21</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Hullahalli et al.</copyright-holder>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="msystems.00887-21.pdf"/>
    <self-uri content-type="reviewer_comments" xlink:href="reviewer-comments.pdf"/>
    <abstract>
      <title>ABSTRACT</title>
      <p>Pathogen population dynamics during infection are critical determinants of infection susceptibility and define patterns of dissemination. However, deciphering these dynamics, particularly founding population sizes in host organs and patterns of dissemination between organs, is difficult because measuring bacterial burden alone is insufficient to observe these patterns. Introduction of allelic diversity into otherwise identical bacteria using DNA barcodes enables sequencing-based measurements of these parameters, in a method known as STAMP (Sequence Tag-based Analysis of Microbial Populations). However, bacteria often undergo unequal expansion within host organs, resulting in marked differences in the frequencies of barcodes in input and output libraries. Here, we show that these differences confound STAMP-based analyses of founding population sizes and dissemination patterns. We present STAMPR, a successor to STAMP, which accounts for such population expansions. Using data from systemic infection of barcoded extraintestinal pathogenic <named-content content-type="genus-species">E. coli</named-content>, we show that this new framework, along with the metrics it yields, enhances the fidelity of measurements of bottlenecks and dissemination patterns. STAMPR was also validated on an independent barcoded <named-content content-type="genus-species">Pseudomonas aeruginosa</named-content> data set, uncovering new patterns of dissemination within the data. This framework (available at <ext-link xlink:href="https://github.com/hullahalli/stampr_rtisan" ext-link-type="uri">https://github.com/hullahalli/stampr_rtisan</ext-link>), when coupled with barcoded data sets, enables a more complete assessment of within-host bacterial population dynamics.</p>
      <p><bold>IMPORTANCE</bold> Barcoded bacteria are often employed to monitor pathogen population dynamics during infection. The accuracy of these measurements is diminished by unequal bacterial expansion rates. Here, we develop computational tools to circumvent this limitation and establish additional metrics that collectively enhance the fidelity of measuring within-host pathogen founding population sizes and dissemination patterns. These new tools will benefit future studies of the dynamics of pathogens and symbionts within their respective hosts and may have additional barcode-based applications beyond host-microbe interactions.</p>
    </abstract>
    <kwd-group>
      <title>KEYWORDS</title>
      <kwd>barcodes</kwd>
      <kwd>bottlenecks</kwd>
      <kwd>population dynamics</kwd>
    </kwd-group>
    <funding-group specific-use="FundRef">
      <award-group award-type="grant" id="award1">
        <funding-source id="GS1">
          <institution-wrap>
            <institution>HHS | National Institutes of Health (NIH)</institution>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>AI-R01-042347</award-id>
        <principal-award-recipient>
          <name>
            <surname>Waldor</surname>
            <given-names>Matthew K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group award-type="grant" id="award2">
        <funding-source id="GS2">
          <institution-wrap>
            <institution>Howard Hughes Medical Institute (HHMI)</institution>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000011</institution-id>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Waldor</surname>
            <given-names>Matthew K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group award-type="grant" id="award3">
        <funding-source id="GS3">
          <institution-wrap>
            <institution>National Science Foundation (NSF)</institution>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Hullahalli</surname>
            <given-names>Karthik</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <counts>
      <count count="9" count-type="supplementary-material"/>
      <fig-count count="6"/>
      <table-count count="0"/>
      <equation-count count="0"/>
      <ref-count count="33"/>
      <page-count count="16"/>
      <word-count count="10535"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>July/August 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>INTRODUCTION</title>
    <p>During infection, microbial pathogens encounter a variety of barriers that impede colonization and help prevent subsequent disease. These obstacles include innate and adaptive effectors of the immune system, the microbiota, and anatomical and chemical barriers, such as stomach acidity and physical niche availability (<xref rid="B1" ref-type="bibr">1</xref>). Collectively, these restrictions, which generally act to protect the host and reduce the size of the pathogen population postinoculation, are often referred to as a “bottleneck.” When bacteria in the inoculum contain multiple alleles, the allelic composition of the bacterial population found at sites of colonization will differ from that in the inoculum after passing through the bottleneck, a phenomenon more broadly referred to as genetic drift (<xref rid="B2" ref-type="bibr">2</xref>). In infection biology, bottlenecks are key determinants of whether a host becomes colonized by a pathogen, govern paths of dissemination within individual hosts, and influence transmission between hosts (<xref rid="B3" ref-type="bibr">3</xref><xref rid="B4" ref-type="bibr">–</xref><xref rid="B9" ref-type="bibr">9</xref>). However, the set of host mechanisms that govern bottlenecks remain incompletely understood. Genome-scale genetic screens in bacteria can be used to investigate host defense axes, but are themselves confounded by bottleneck effects that cause mutant strains in a population to be eliminated by the host by chance alone, rather than through selection (<xref rid="B10" ref-type="bibr">10</xref><xref rid="B11" ref-type="bibr">–</xref><xref rid="B16" ref-type="bibr">16</xref>).</p>
    <p>Infection bottlenecks are difficult to quantify if the experimental inoculum is composed of bacteria of uniform genotype. Several methods that introduce allelic diversity have been used to circumvent this issue and measure bottlenecks (<xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B17" ref-type="bibr">17</xref>). One approach involves the introduction of artificial and fitness-neutral short random sequence tags (barcodes) into otherwise identical cells. The comparison of barcode abundances before and after infection through high-throughput DNA sequencing then enables bottleneck quantification. Combining barcoding with deep sequencing is widely generalizable and can be applied in several different contexts, such as experimental evolution and cancer progression (<xref rid="B18" ref-type="bibr">18</xref>). Different analytical approaches and metrics for comparisons of barcode frequencies have been created (<xref rid="B19" ref-type="bibr">19</xref><xref rid="B20" ref-type="bibr">–</xref><xref rid="B21" ref-type="bibr">21</xref>), including Sequence Tag-based Analysis of Microbial Populations (STAMP), for analysis of infection bottlenecks (<xref rid="B22" ref-type="bibr">22</xref>). In STAMP, deep sequencing is used to determine the distribution of barcode frequencies in an inoculum (the input) and in various organs (the output). The changes in barcode distributions (i.e., allele frequencies) between input and output are used to quantify the magnitude of genetic drift, which approximates the magnitude of the bottleneck (<xref rid="B23" ref-type="bibr">23</xref>). Bottlenecks are measured as the size of the founding population (FP), i.e., the number of unique cells from the inoculum that give rise to the population in a sample. A small FP value is indicative of a “tight” bottleneck, whereas a large FP indicates a “wide” bottleneck. FP is estimated by an application of an equation from Krimbas and Tsakas, originally used to quantify genetic drift in insect populations (<xref rid="B23" ref-type="bibr">23</xref>). In STAMP, the estimate of FP is known as N<sub>b</sub>. We distinguish FP and N<sub>b</sub> to emphasize that FP is impossible to measure precisely, as it would require every cell in the inoculum to possess a different tag and infinite sequencing depth. N<sub>b</sub> calculation circumvents these limitations by quantifying the differences in barcode frequencies between a reference inoculum and output organ samples. STAMP has been used in several infection models across multiple anatomical sites to estimate FP and unveil host determinants of infection bottlenecks (<xref rid="B22" ref-type="bibr">22</xref>, <xref rid="B24" ref-type="bibr">24</xref><xref rid="B25" ref-type="bibr">–</xref><xref rid="B27" ref-type="bibr">27</xref>). Recent work has also enabled the use of STAMP to measure bacterial replication and death rates (<xref rid="B28" ref-type="bibr">28</xref>).</p>
    <p>Two key assumptions that underlie the calculation of N<sub>b</sub> are that (i) all sampled bacteria in the population have experienced a singular, identical bottleneck and that (ii) all cells grow at similar rates after passing through the bottleneck (<xref rid="B22" ref-type="bibr">22</xref>, <xref rid="B28" ref-type="bibr">28</xref>). These assumptions oversimplify conditions within the host, as bacteria within an organ are likely exposed to different environments depending on their suborgan localization. For example, variation in the immune state of diverse host cells can impose different pressures on bacteria (<xref rid="B29" ref-type="bibr">29</xref>). Furthermore, organ reseeding events can result in multiple populations of bacteria within an organ that have undergone distinct bottlenecks. Phenotypic heterogeneity in the pathogen population can also influence post-bottleneck expansion rates (<xref rid="B30" ref-type="bibr">30</xref>, <xref rid="B31" ref-type="bibr">31</xref>). These additional sources of variation in barcode frequencies result in a consistent underestimation of FP by N<sub>b,</sub> because calculation of N<sub>b</sub> relies on comparing the similarity of barcode frequencies between an output organ sample and a diverse input. The N<sub>b</sub> value of an output sample will be larger if the barcode frequency distribution in the organ sample more closely resembles the inoculum. As genetic drift or uneven growth rates cause the barcode frequency distribution in the output sample to vary, N<sub>b</sub> decreases. However, N<sub>b</sub> alone cannot distinguish between genetic drift or uneven growth, and since both are prevalent in biological data, additional metrics are warranted and would markedly improve data interpretation. For example, two organs may possess very similar FPs but one organ may be permissive to increased replication of a subpopulation. These organs would have different N<sub>b</sub> and would therefore be interpreted to differ in FP.</p>
    <p>We found that in biological data, uneven growth often manifests as the expansion of very few clones, which are evident as disproportionately abundant barcodes and lead to consistent underestimates of the true FP by N<sub>b</sub>. In infection contexts, uneven pathogen growth may arise from multiple causes, including local host permissiveness or phenotypic heterogeneity in the pathogen. Disproportionately abundant barcodes may suggest multiple distinct populations within an organ, but uneven growth may be present even within a single population. Here, we present STAMPR, a computational approach that overcomes these limitations of STAMP. STAMPR is a successor to STAMP that relies on an iterative barcode removal algorithm to account for the contribution of clonal expansion to bottlenecks. In addition, STAMPR employs additional metrics to evaluate dissemination patterns that characterize the extent to which individual barcodes contribute to bacterial spread. Using data from systemic infection of barcoded extraintestinal pathogenic <named-content content-type="genus-species">E. coli</named-content> (ExPEC) (<xref rid="B32" ref-type="bibr">32</xref>), we show that STAMPR enhances the fidelity of measurements of bottlenecks and dissemination patterns by accounting for every barcode. We use these tools to reanalyze an independently generated and published data set that explored <named-content content-type="genus-species">Pseudomonas aeruginosa</named-content> systemic spread (<xref rid="B24" ref-type="bibr">24</xref>). Our tools readily detected and quantified previously unappreciated instances of clonal expansion and dissemination in these data. STAMPR (freely available at <ext-link xlink:href="https://github.com/hullahalli/stampr_rtisan" ext-link-type="uri">https://github.com/hullahalli/stampr_rtisan</ext-link>) therefore enables a deeper and more complete understanding of within-host bacterial population dynamics.</p>
  </sec>
  <sec id="s2">
    <title>RESULTS AND DISCUSSION</title>
    <sec id="s2-1">
      <title>Highly abundant barcodes confound measurement of founding population sizes.</title>
      <p>Our motivation for questioning the fidelity of N<sub>b</sub> as a proxy for FP came from observations where N<sub>b</sub> values were often much smaller than the number of detected barcodes in sequencing data. This discrepancy became particularly clear in analyses of STAMP-based experiments investigating within-host ExPEC dissemination, the biological findings of which are described further in a companion manuscript (<xref rid="B32" ref-type="bibr">32</xref>). In the ExPEC systemic infection model, the pathogen is inoculated intravenously and samples are taken from different organs to monitor dissemination and expansion. In multiple organs, we found clonally expanded bacterial populations, intermixed with less abundant, more diverse bacterial populations. By introducing additional variance to output barcode frequencies, these highly abundant “outliers” confounded N<sub>b</sub>, as samples with hundreds of detectable tags yielded much lower N<sub>b</sub> values (occasionally &gt;10 fold). The discrepancy between N<sub>b</sub> (as a true measure of FP) and the number of barcodes is not biologically plausible; if 100 barcodes are detected, the founding population must be composed of at least 100 unique bacteria. While it is possible for an individual cell to possess two barcodes, it is highly unlikely. During library preparation, individual colonies are Sanger sequenced, confirming that the presence of multiple tags per cell is below detection. Furthermore, within-run sequencing controls (samples with known numbers of barcodes) serve to rule out that cross contamination or sequencing errors significantly influence the data.</p>
      <p>We sought to develop a computational approach that can recognize and account for disproportionately abundant barcodes. This approach would not only need to account for highly abundant tags, but be sufficiently unbiased to enable determination of FP when it is difficult to identify “outliers” by visual inspection of barcode frequency graphs. In an ideal system, every bacterium from the inoculum would be tagged with a single unique barcode, in which case counting the number of barcodes would yield a more accurate measure of FP than N<sub>b</sub>. However, creation of highly diverse libraries has been technically challenging, particularly for non-model organisms. An alternative approach to improve the accuracy of FP estimates leverages the power of computational resampling, which, unlike N<sub>b</sub>, is not affected by unequal growth rates. Simulations can be performed on the input at a variety of sampling depths to determine the sample depth N<sub>s</sub> that yields the same number of barcodes detected in the output sample. For example, if 100 barcodes are detected from an output sample derived from an input library of 1,000 barcodes, then N<sub>s</sub> represents the number of reads that were sampled from the input such that 100 barcodes are detected; this value will always be slightly larger than 100. Therefore, N<sub>s</sub>, unlike N<sub>b</sub>, is not skewed when there is increased variation in barcode frequencies between an output organ and the input.</p>
      <p>To demonstrate our methodology, we first artificially recreated a sample in which N<sub>b</sub> underestimates FP by using a series of barcode frequency distributions from known bottleneck sizes collected from <italic toggle="yes">in vitro</italic>-generated bottlenecks where FP sizes are known. Combining the barcode frequencies observed in an ∼1.4 × 10<sup>3</sup> CFU FP and an ∼1.4 × 10<sup>1</sup> CFU FP (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>) yielded distributions as shown in <xref rid="fig1" ref-type="fig">Fig. 1B</xref>. This mimics a sample where ∼14 cells have expanded faster than the other ∼1,400 after both populations have passed through the same, singular bottleneck. The true FP for this artificial population is close to 1.4 × 10<sup>3</sup>. However, the calculated N<sub>b</sub> is 150, ∼9-fold lower than the true FP, because the expanded population is viewed in STAMP calculations as substantial variation between input and output barcode frequencies, leading to a marked underestimate of FP. Experimental data from the ExPEC model revealed similar patterns, where calculated N<sub>b</sub> values were lower than the number of detected barcodes, therefore smaller than the true FP (<xref rid="fig2" ref-type="fig">Fig. 2</xref>).</p>
      <fig position="float" id="fig1">
        <label>FIG 1</label>
        <caption>
          <p>Overview of the resiliency algorithm. (A) Two barcode frequency distributions from known CFU dilutions (and thus known FPs) are shown, with calculated N<sub>b</sub> values. The raw read counts of each barcode in these samples are summed to give rise to the plot in B. This results in a computational sample that mimics a scenario where ∼14 cells have expanded at a much faster rate than the other ∼1,400, despite both populations having undergone the same bottleneck. From the data plotted in B, the resiliency algorithm is run to generate a resiliency plot (displayed in C) by iteratively removing the most abundant barcodes and calculating N<sub>b</sub> after each iteration. Breaks in the graph (red lines in C) are algorithmically identified and visually superimposed on the plot in B, resulting in the diagram shown in D. Breaks signify potentially discrete populations or noise, and the weight of each population is determined as a fraction of total reads. An initial noise assumption is set by the user and, in this example, was set to 1% of all reads. The largest log change in the weights determines a computationally defined threshold for noise. From this, a new resiliency plot is generated without noise and the greatest value among the original N<sub>b</sub> value, the new maximum N<sub>b</sub> from the second resiliency plot, or N<sub>s</sub> is used to determine N<sub>r</sub>. In this example, N<sub>s</sub> was the largest of these values, and is therefore the resulting value of N<sub>r</sub>.</p>
        </caption>
        <graphic xlink:href="msystems.00887-21-f001" position="anchor"/>
      </fig>
      <fig position="float" id="fig2">
        <label>FIG 2</label>
        <caption>
          <p>Variations in N<sub>r</sub> and N<sub>b.</sub> Barcode frequency distributions for six samples from ExPEC systemic infection (<xref rid="B32" ref-type="bibr">32</xref>) are shown. The <italic toggle="yes">y</italic> axes are displayed on a log scale to facilitate identification of noise. For each sample, a red line indicates the first break identified by the resiliency algorithm and delineates discrete subpopulations. The blue line indicates the threshold for noise. In each subpopulation, the fraction of total barcodes represented is displayed. N<sub>b</sub> and N<sub>r</sub> values are indicated.</p>
        </caption>
        <graphic xlink:href="msystems.00887-21-f002" position="anchor"/>
      </fig>
      <p>We developed an algorithm that provides a more complete estimate of FP (<xref rid="fig1" ref-type="fig">Fig. 1B</xref> to <xref rid="fig1" ref-type="fig">D</xref>, computational workflow described in the Materials and Methods section, and <xref rid="textS1" ref-type="supplementary-material">Text S1</xref> in the supplemental material). Our approach was developed on computational samples (such as in <xref rid="fig1" ref-type="fig">Fig. 1A</xref>) and our ExPEC experimental data sets, and yields more accurate estimates of FP. In brief, the algorithm iteratively removes barcodes from the output sample (from greatest to least abundant) and calculates N<sub>b</sub> after each iteration. A better estimation of FP for the artificial sample described above is equal to the N<sub>b</sub> after the first ∼10 most abundant barcodes are removed, which is ∼10<sup>3</sup>. Subsequent removal of barcodes does little to change N<sub>b</sub> (i.e., the y values plateau), and we refer to ∼10<sup>3</sup> as a more “resilient” estimate of FP. We refer to plots of N<sub>b</sub> versus iteration as “resiliency plots” (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>) and this algorithm as the “resiliency algorithm.” The resiliency plot can be used to define “breaks” that delineate discrete subpopulations within the sample (shown as red lines in <xref rid="fig1" ref-type="fig">Fig. 1C</xref> and <xref rid="fig1" ref-type="fig">D</xref>, separating high-abundance barcodes, low-abundance barcodes, and noise). Then, these subpopulations are weighted by the fractional abundance of barcodes within breaks, enabling determination of a noise threshold. Whenever samples are multiplexed, index hopping results in noise, where usually &lt;1% of reads are technical artifacts. Importantly, for most samples, noise represents a discrete subpopulation that can be detected by the resiliency algorithm. Removing noise is important because, in some cases, noise can comprise more barcodes than the true FP (e.g., <xref rid="fig1" ref-type="fig">Fig. 1A</xref>, sample with FP = 14).</p>
      <supplementary-material position="float" id="textS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.9</object-id>
        <label>TEXT S1</label>
        <p>Pseudocode for the resiliency algorithm. Download <inline-supplementary-material id="txS1" xlink:href="msystems.00887-21-s0001.docx" content-type="local-data">Text S1, DOCX file, 0.02 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>After removing noise, a second resiliency plot is generated. Using this graph, the algorithm then determines the maximum possible value for N<sub>b</sub>. In addition, the number of remaining barcodes is used to calculate N<sub>s</sub>. The final output of the resiliency algorithm is referred to as N<sub>r</sub>, which is set equal to the maximum value among (i) N<sub>s</sub>, (ii) the initial N<sub>b</sub> estimate, or (iii) the new maximum N<sub>b</sub> from the second resiliency plot. N<sub>s</sub> is used in this manner since it is completely independent of relative barcode abundances and considers only their presence or absence. For example, populations that have undergone significant uneven growth post-bottleneck will have low N<sub>b</sub> values, so N<sub>s</sub> would yield the greatest estimate of FP. Furthermore, this logic ensures that N<sub>r</sub> will always be equal to or greater than N<sub>b</sub>. By accounting for the presence of every barcode, this approach more accurately estimates FP regardless of the presence of disproportionately abundant barcodes in biological data (e.g., <xref rid="fig2" ref-type="fig">Fig. 2</xref>, <xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref>). The sensitivity of N<sub>b</sub> to highly abundant tags can further be exploited by measuring the ratio of N<sub>r</sub>/N<sub>b,</sub> which in effect quantifies unequal barcode distributions and can provide information about clonal expansion.</p>
      <supplementary-material position="float" id="figS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.1</object-id>
        <label>FIG S1</label>
        <p>Schematic of STAMP measurements. (A) Each barcode is represented as a colored marble. In the inoculum, each color is evenly represented. A specific number of marbles are removed from the inoculum and replicate in a separate bucket, in different scenarios depicted in schematics in B to E. (B to E) Representations of various output barcode frequencies are shown, each of which is present in biological data from reference <xref rid="B32" ref-type="bibr">32</xref>. N<sub>r</sub> and N<sub>b</sub> are indicated adjacent to each sample. GD, RD, and FRD between pairs of selected samples are shown. B is representative of a population that results from a large resampling (wide bottleneck) of the inoculum (A), where each color has replicated relatively evenly after sampling. C and D represent populations that resulted from a large resampling of the inoculum but where one color replicated at a much faster rate (red in C and black in D). E represents a population resulting from a very small resampling (tight bottleneck) of the inoculum, where the black marble has replicated much faster than the red marble. Download <inline-supplementary-material id="fS1" xlink:href="msystems.00887-21-sf001.pdf" content-type="local-data">FIG S1, PDF file, 0.04 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>Computationally combining additional samples (as in <xref rid="fig1" ref-type="fig">Fig. 1</xref>) further confirms that N<sub>r</sub> provides a more accurate assessment of FP than N<sub>b</sub> across most composite barcode distributions (<xref rid="figS2" ref-type="supplementary-material">Fig. S2</xref>). While N<sub>b</sub> is accurate for single populations generated from <italic toggle="yes">in vitro</italic> standards, it fails to accurately calculate FP for composite populations, which more closely resemble <italic toggle="yes">in vivo</italic> data. However, since several parameters could potentially influence the output of the resiliency algorithm, we additionally conducted a series of simulations on computational samples modeled after the skew of the ExPEC and <named-content content-type="genus-species">P. aeruginosa</named-content> libraries (<xref rid="figS3" ref-type="supplementary-material">Fig. S3</xref>). When a single population is present, increasing the variability in growth rates after a single uniform bottleneck leads to a large decrease in N<sub>b</sub>, while N<sub>r</sub> remains substantially closer to the true FP (<xref rid="figS4" ref-type="supplementary-material">Fig. S4A</xref>). In a similar manner, when a small subpopulation possesses a faster growth rate, N<sub>r</sub>, but not N<sub>b</sub>, remains accurate after several generations of exponential growth (<xref rid="figS4" ref-type="supplementary-material">Fig. S4B</xref>). Compared to N<sub>b</sub>, N<sub>r</sub> is also more resistant to changes in the FP of the more diverse, slow-growing population (<xref rid="figS4" ref-type="supplementary-material">Fig. S4C</xref>) or the less diverse, fast-growing population (<xref rid="figS4" ref-type="supplementary-material">Fig. S4D</xref>). These results are consistent in libraries containing 1,000 or 10,000 barcodes. Furthermore, N<sub>s</sub> more often defines N<sub>r</sub> than max(N<sub>b</sub>). Together these simulations reveal that N<sub>r</sub> provides a more robust estimate of FP than N<sub>b</sub>; in addition, they demonstrate that accuracy of N<sub>r</sub> at high FPs is greater in the 10,000-barcode library than in the 1,000-barcode library (<xref rid="figS4" ref-type="supplementary-material">Fig. S4C</xref>).</p>
      <supplementary-material position="float" id="figS2" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.2</object-id>
        <label>FIG S2</label>
        <p>Performance of the resiliency algorithm over a range of composite samples. N<sub>b</sub>, N<sub>s</sub>, max(N<sub>b</sub>), and CFU are shown for samples obtained from <italic toggle="yes">in vitro</italic> standards (first six groups, from reference <xref rid="B32" ref-type="bibr">32</xref>) or computational composite samples derived from these standards. CFU values represent the true FP values, the log10 approximation of which are the <italic toggle="yes">x</italic> axis labels. Composite samples are described by the approximate log10(FP) of their individual constituents; for example, “4 + 3” is the result of summing the reads from a sample with FP ∼10<sup>4</sup> and a sample with FP∼10<sup>3</sup>. N<sub>r</sub> is defined as the maximum of N<sub>b</sub>, N<sub>s</sub>, and max(N<sub>b</sub>). The largest of these values is most often N<sub>s</sub>, but max(N<sub>b</sub>) is larger for samples with very high FP (e.g., “5 + 2”); also, in most of the composite samples, N<sub>b</sub> substantially underestimates FP. Download <inline-supplementary-material id="fS2" xlink:href="msystems.00887-21-sf002.pdf" content-type="local-data">FIG S2, PDF file, 0.04 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <supplementary-material position="float" id="figS3" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.3</object-id>
        <label>FIG S3</label>
        <p>Schematic for simulations to model uneven and differential growth. (A) To obtain computational samples that model the skew of biological libraries, we sample N times from the density distributions of <italic toggle="yes">in vitro</italic> standards. These sampled populations serve as the reference, and N represents the number of barcodes in the library. (B) From this reference, p1 or p2 reads are sampled, resulting in population 1 (FP = p1) and/or population 2 (FP = p2). Each population is assigned a normal growth rate distribution with mean = m1 and standard deviation = s1 (for population 1) or mean = m2 and standard deviation = s2 (for population 2). Each barcode is assigned a growth rate <italic toggle="yes">r</italic> from a random sampling of these distributions and grown exponentially (2<sup>rt</sup>) for t generations. Population 1 and population 2 are then combined and resampled, after which N<sub>b</sub>, N<sub>s</sub>, and max(N<sub>b</sub>) are calculated. The results of simulations are presented in Fig. S4. Download <inline-supplementary-material id="fS3" xlink:href="msystems.00887-21-sf003.pdf" content-type="local-data">FIG S3, PDF file, 0.03 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <supplementary-material position="float" id="figS4" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.4</object-id>
        <label>FIG S4</label>
        <p>“Stress tests” of the resiliency algorithm. A series of simulations altering various parameters as described in <xref rid="figS3" ref-type="supplementary-material">Fig. S3</xref> are shown. Dotted lines denote the true FP value in each case. These simulations were performed with an initial noise correction of 0% and forced to account for at least 97% of all reads (even though these samples lack noise) (A) A single population with p1 = 10,000 is exponentially grown for t = 5 generations. Increasing the variability in growth rates of each barcode (s1) decreases N<sub>b</sub> and max(N<sub>b</sub>), and N<sub>s</sub> is closer to the true FP. These results demonstrate that N<sub>r</sub> (the maximum of N<sub>b</sub>, max(N<sub>b</sub>), and N<sub>s</sub>) is more resistant to variability in growth rates after a single bottleneck. (B) Two populations (p1 = 10,000, p2 = 10) are exponentially grown over time. Population 2 grows 3 times faster than population 1 (m2/m1 = 3), but growth rates within each population are relatively even (s1 = s2 = 0.1). As population 2 expands over time relative to population 1, N<sub>b</sub>, but not N<sub>r</sub>, significantly underestimates the true FP. (C) A slower-growing population 1 of varying FP values (p1) is grown exponentially with a faster-growing population 2 as in B (p2 = 10, m2/m1 = 3, s1 = s2 = 0.1) for 5 generations. N<sub>r</sub> is accurate up to 10<sup>4</sup> for the 1,000-barcode library and accurate up to 10<sup>5</sup> for the 10,000-barcode library. (D) Same as C, but where the FP of population 1 is constant (p1 = 10,000) but the FP of population 2 (p2) varies. The decrease in N<sub>r</sub> at high p2 values is because at t = 5 generations, population 2 is abundant enough to where population 1 is partially or entirely treated as noise. Download <inline-supplementary-material id="fS4" xlink:href="msystems.00887-21-sf004.pdf" content-type="local-data">FIG S4, PDF file, 0.6 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
    <sec id="s2-2">
      <title>Identifying, quantifying, and visualizing shared barcodes between samples.</title>
      <p>Barcoded libraries also permit analysis of inter-organ dissemination by analyzing the similarity of tag frequencies between organs. Previous STAMP analyses identified the Cavalli-Sforza chord distance (<xref rid="B33" ref-type="bibr">33</xref>) between samples to quantify the genetic distance (GD), although other methods to assess allelic similarity between populations can be employed (<xref rid="B20" ref-type="bibr">20</xref><xref rid="B21" ref-type="bibr">–</xref><xref rid="B22" ref-type="bibr">22</xref>, <xref rid="B25" ref-type="bibr">25</xref>, <xref rid="B26" ref-type="bibr">26</xref>). GD is high when two samples are dissimilar, and low when they are more similar. We leveraged iterative barcode removal to obtain a more granular understanding of the similarity between samples. Our motivation arose from the fact that GD values are influenced by the abundance of tags in samples, as well as the number of shared tags. Highly similar populations (low GD values) can result from the sharing of many barcodes or very few highly abundant ones. Furthermore, the expansion of different clones that overlay similar populations yields high GD values (<xref rid="figS5" ref-type="supplementary-material">Fig. S5A</xref>), whereas the sharing of dominant clones between two samples yields low GD values, even if the underlying populations are dissimilar (<xref rid="figS5" ref-type="supplementary-material">Fig. S5B</xref>). We reasoned that additional metrics generated by our iterative barcode removal strategy could, when coupled with GD, help to characterize dissemination patterns more completely.</p>
      <supplementary-material position="float" id="figS5" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.5</object-id>
        <label>FIG S5</label>
        <p>Examples of GD and RD. Three examples of GD and RD are shown. In each panel, barcode frequency distributions for two samples from reference <xref rid="B32" ref-type="bibr">32</xref> are displayed. The 10 most abundant barcodes on the left graphs in A to C are highlighted in red and identified on the middle graph in each panel. The right plot shows the transformation resulting from the RD algorithm. (A) In this example, separate clonal expansion events have occurred in two organs, but the underlying nonexpanded populations are still apparent. These samples are overall dissimilar, since GD is high. However, after removal of the clonally expanded barcodes, these samples become highly similar and remain so for the remainder of the iterations. (B) An example where two samples are highly similar but share only a few dominant barcodes is shown. After iterative removal of the most abundant barcodes, GD rapidly increases. (C) These two samples are both highly diverse and similar to the inoculum, so they are very similar and share many tags. Download <inline-supplementary-material id="fS5" xlink:href="msystems.00887-21-sf005.pdf" content-type="local-data">FIG S5, PDF file, 1.1 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>Similar to the approach taken with the resiliency algorithm for calculation of N<sub>r</sub>, we iteratively removed the most abundant barcodes in both samples and created a score quantifying the number of barcodes that contribute to genetic similarity between the samples (RD, “resilient” genetic distance) (<xref rid="fig3" ref-type="fig">Fig. 3</xref>, <xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref>). Low RD values indicate that the samples share relatively few barcodes. Samples with both low RD and low GD share only a few tags but are nevertheless highly similar; in this case, very few barcodes are shared, but they represent significant fractions of the total CFU in both samples (<xref rid="figS5" ref-type="supplementary-material">Fig. S5B</xref>). Samples with both high RD and GD share many tags, but the bulk of the population (in terms of CFU) are dissimilar; this can occur when different sets of bacteria expand in two samples, but both expansion events overlay relatively similar populations containing many barcodes (<xref rid="figS5" ref-type="supplementary-material">Fig. S5A</xref>). Samples with high RD and low GD are very similar and share many barcodes; this is typically observed in samples with high FP because they closely resemble the inoculum and therefore each other (e.g., early after infection) (<xref rid="figS5" ref-type="supplementary-material">Fig. S5C</xref>). Samples with low RD and high GD are completely dissimilar, suggesting they are unlikely to be related to each other either physically or temporally. Application of this approach to our ExPEC data proved valuable because it enabled us to distinguish between samples that were similar due to the dissemination of clones (low RD, low GD) versus when they were similar because they all closely resembled the inoculum (high RD, low GD, and high FP) (<xref rid="B32" ref-type="bibr">32</xref>).</p>
      <fig position="float" id="fig3">
        <label>FIG 3</label>
        <caption>
          <p>Workflow for RD calculation. (A and B) Barcode frequency distributions in two samples. The top 10 most abundant barcodes in the top sample (A) are highlighted in red and identified in the bottom sample (B). The RD algorithm iteratively removes the most abundant barcodes and calculates GD after each iteration to generate the plot in C. These samples are moderately related to each other, since they share the same dominant barcode, but their underlying populations are dissimilar. RD is defined as the number of points on the plot in B that are below 0.8.</p>
        </caption>
        <graphic xlink:href="msystems.00887-21-f003" position="anchor"/>
      </fig>
      <p>Note that in this framework, “low” and “high” RD values are relative to the number of barcodes in the library. We created an additional metric where RD values are log-normalized (plus one) to the total number of detectable barcodes in the sample (an output from the resiliency algorithm). We refer to this metric as a fractional RD (FRD), which represents the relative abundance of shared barcodes in a pair of samples. FRD essentially normalizes RD across all samples, and therefore permits comparisons between samples. Similar to how high N<sub>r</sub>/N<sub>b</sub> ratios signify the presence of expanded clones that overlay a diverse population, low FRD and low GD can signify the presence of abundant shared clones that overlay diverse dissimilar populations. The directionality of FRD calculations provides further information about similarity between populations. For example, consider a situation where organ A and organ B are similar samples (low GD) that resemble the data in <xref rid="figS5" ref-type="supplementary-material">Fig. S5B</xref>. If RD = 11 (i.e., 11 barcodes are shared between A and B), FRD<sub>A-B</sub> = log(11 + 1)/log(B<sub>B</sub> + 1), where B<sub>B</sub> is the number of barcodes in sample B, while FRD<sub>B-A</sub> = log(11 + 1)/log(B<sub>A</sub> + 1), where B<sub>A</sub> is the number of barcodes in sample A. High FRD<sub>A-B</sub> signifies that the barcodes that were shared between the two populations represent a large fraction of all the barcodes in sample B. Correspondingly, a low FRD<sub>B-A</sub> means that the barcodes that are shared between A and B only represent a small fraction of the barcodes detected in sample A. The difference between FRD<sub>A-B</sub> and FRD<sub>B-A</sub> implies the existence of a larger, more diverse and dissimilar underlying population in sample A but not sample B. In this example, we can conclude that (i) samples A and B are similar (low GD); (ii) the similarity is driven by only a few barcodes (low RD); and (iii) these few barcodes represent a large population of sample B but overlay a more diverse resident population in sample A (high FRD<sub>A-B</sub>, low FRD<sub>B-A</sub>). Note that FRD is strictly a metric that uses the number of barcodes, not their abundance. Barcode abundance is considered in GD calculations, and therefore a combined approach using all of these metrics (GD, RD, and FRD) is superior to using any one metric individually.</p>
    </sec>
    <sec id="s2-3">
      <title>Reanalysis of <named-content content-type="genus-species">Pseudomonas aeruginosa</named-content> bacteremia.</title>
      <p>We built our tools using a systemic model of ExPEC infection (<xref rid="B32" ref-type="bibr">32</xref>). We further tested these tools and associated metrics by reanalyzing data published in a recent study examining the trafficking of a barcoded library of <named-content content-type="genus-species">P. aeruginosa</named-content> following its intravenous inoculation into mice (<xref rid="B24" ref-type="bibr">24</xref>). This study revealed that gallbladder seeding by <named-content content-type="genus-species">P. aeruginosa</named-content> allows the pathogen to disseminate to the intestines and ultimately to be shed in the feces (<xref rid="B24" ref-type="bibr">24</xref>). Our reanalysis buttresses these conclusions and uncovered unappreciated patterns of <named-content content-type="genus-species">P. aeruginosa</named-content> expansion and dissemination that were hidden in the data sets due to additional variation in barcode frequencies not captured by N<sub>b</sub>. In most of the samples, N<sub>r</sub> was greater than N<sub>b</sub> and, in many cases, the N<sub>r</sub>/N<sub>b</sub> ratio was &gt;10, particularly in the liver and lungs (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>), indicating that there were significant clonal expansions at these sites. Here, clonal expansion refers to markedly uneven tag distribution in the sequencing data. Importantly, the N<sub>r</sub>/N<sub>b</sub> ratio reveals the presence of clonal expansion, but not its biological source. For example, highly abundant barcodes could result from expansion that is confined to an organ or arise from transit from a different organ. This reanalysis also revealed marked heterogeneity in N<sub>r</sub> values within and between organs at 24 h postinfection, despite very similar N<sub>b</sub> values (Fig. 2C of reference <xref rid="B24" ref-type="bibr">24</xref>). The large variance in N<sub>r</sub> values, for example in the liver and lung (<xref rid="fig4" ref-type="fig">Fig. 4A</xref> to <xref rid="fig4" ref-type="fig">C</xref>), reveals considerable differences in the sizes of the bottlenecks in different animals that were not captured by N<sub>b</sub>. The barcode frequency distribution plots shown in <xref rid="fig4" ref-type="fig">Fig. 4B</xref> to <xref rid="fig4" ref-type="fig">G</xref> underscore that N<sub>b</sub> is extremely sensitive to highly abundant tags and therefore does not adequately capture and quantify the marked differences of pathogen population structure within and between organs. N<sub>b</sub> is more similar to N<sub>r</sub> when barcode frequencies are relatively even (compare <xref rid="fig4" ref-type="fig">Fig. 4D</xref> and <xref rid="fig4" ref-type="fig">E</xref>). Therefore, using N<sub>r</sub> in addition to N<sub>b</sub> enables a more complete understanding of the entire population structure in the host by accounting for less-abundant barcodes. These underlying populations are important to detect, as they may occupy distinct niches, contribute to persistent infections, or disseminate to other organs in the host.</p>
      <fig position="float" id="fig4">
        <label>FIG 4</label>
        <caption>
          <p>Reanalysis of <named-content content-type="genus-species">P. aeruginosa</named-content> systemic infection population dynamics. (A) N<sub>b</sub> values are displayed across organs from Fig. 2C of reference <xref rid="B24" ref-type="bibr">24</xref>, along with N<sub>r</sub> values determined here. (B to G) Barcode frequency distributions from individual samples B to G (as shown in A) are displayed to visualize the underlying distributions that give rise to N<sub>b</sub> and N<sub>r</sub> values. These distributions are prior to noise correction by the resiliency algorithm. These plots represent a wide range of barcode frequency distributions, even though N<sub>b</sub> is similar in all of them. N<sub>r,</sub> by accounting for all barcodes, more robustly captures and quantifies the differences between these samples.</p>
        </caption>
        <graphic xlink:href="msystems.00887-21-f004" position="anchor"/>
      </fig>
      <p>The potency of our approach is well illustrated by reanalysis of the data from single animals infected with <named-content content-type="genus-species">P. aeruginosa</named-content>. For example, in mouse 1 (<xref rid="fig5" ref-type="fig">Fig. 5</xref>), there is a 2.5 log difference between N<sub>b</sub> and N<sub>r</sub> in the lung, suggesting a large clonal expansion. The lung sample was somewhat similar to the liver (GD = 0.66, RD = 739) and spleen (GD = 0.56, RD = 523), but completely dissimilar to intestinal organs (small intestine, cecum, colon, and feces) and the gallbladder (GD &gt; 0.8, RD = 0) (<xref rid="fig5" ref-type="fig">Fig. 5</xref>), revealing that a set of dominant clones circulated systemically, but not enterically. However, the fact that these GD values are modest and not closer to 0 suggests that some dominant clones in each sample were not shared. Additionally, the relatively high RD values indicate that removal of a few dominant barcodes does not abolish genetic similarity. Therefore, the populations in these systemic samples consist of underlying subpopulations that are both similar and diverse. For example, the lung and liver do not share many highly abundant barcodes, but both samples have similar underlying populations (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>, blue brackets). Comparisons of N<sub>r</sub>/N<sub>b</sub> ratios in these organs also reveal that dominant clones are present in the lung, liver, and spleen (460, 165, and 24, respectively) (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>). These observations are consistent with a model where the liver, spleen, and lung each received a large portion of the inoculum and had distinct clonal expansion events, some of which spread systemically. Elsewhere in the animal, there was marked sharing of barcodes between the gallbladder and the intestines (GD &lt; 0.2) and these transferred barcodes comprised nearly all of the barcodes in the intestinal organs (FRD<sub>gallbladder-intestine</sub> &gt; 0.9). Consistent with N<sub>r</sub> values, the small number of barcodes transferred between the gallbladder and liver (GD = 0.74, RD = 28) comprised a large fraction of the gallbladder population (FRD<sub>liver-gallbladder</sub> = 0.8) but only a small fraction of the liver barcodes (FRD<sub>gallbladder-liver</sub> = 0.42). These FRD differences reveal that large subpopulations of liver-resident bacteria are distinct from those in the gallbladder. Inspection of the barcode frequency distributions confirms that most expanded clones in the liver are not derived from the gallbladder (<xref rid="fig5" ref-type="fig">Fig. 5D</xref>), consistent with their expansion within the liver, independently of transit to/from the gallbladder. These analyses illustrate how our tools enable high-resolution mapping of population dynamics in a single animal.</p>
      <fig position="float" id="fig5">
        <label>FIG 5</label>
        <caption>
          <p>Reanalysis of <named-content content-type="genus-species">P. aeruginosa</named-content> population dynamics in a single animal. (A and B) GD (A) and FRD (B) values were calculated for all organs in mouse 1 from Fig. 2C of reference <xref rid="B24" ref-type="bibr">24</xref>. (A) Since GD is the same for a pair of samples in either direction, GD heatmaps are symmetric along the diagonal. (B) The asymmetry of color along the diagonal in the FRD heatmap arises from the fact that only one of the axes (the column names) serves as the reference, while the row names are simply the other sample in the pair used to calculate RD. The liver and cecum are modestly similar samples as measured by genetic distance; however, FRD<sub>liver-cecum</sub> is greater than FRD<sub>cecum-liver</sub> (asterisks). This indicates that the shared barcodes between the liver and cecum represent smaller fractions of the total liver barcodes than the total cecum barcodes. Therefore, the liver, but not the cecum, has a larger resident nonshared population. (C) Barcode frequency distributions after noise removal are shown for the lung. The top 10 barcodes are highlighted in red and identified in the spleen and liver samples, demonstrating that these samples share some, but not all, dominant tags. This is reflected in GD values in A. N<sub>r</sub> and N<sub>b</sub> values are displayed for reference. Blue brackets indicate the diverse underlying population. (D) Same as C but the gallbladder (GB) serves as the reference for the top 10 barcodes and these barcodes are identified in the colon, cecum, and liver.</p>
        </caption>
        <graphic xlink:href="msystems.00887-21-f005" position="anchor"/>
      </fig>
      <p>In contrast to measuring multiple parameters in a single animal, comparing single metrics across animals enables detection of both consistent and heterogeneous facets of population dynamics. For example, FRD<sub>liver-gallbladder</sub> was significantly higher than FRD<sub>gallbladder-liver</sub>, indicating that the bacteria that are shared between the liver and gallbladder consistently represented a larger fraction of the population in the gallbladder than in the liver (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>). This contrasts to comparisons between the gallbladder and the feces, which have FRD values in both directions consistently near 1, suggesting that the fecal population is nearly entirely derived from the gallbladder (<xref rid="fig6" ref-type="fig">Fig. 6B</xref>). The underlying anatomy in this infection model likely explains these differences. As proposed by Batcha et al. (<xref rid="B24" ref-type="bibr">24</xref>), the liver first captures bacteria from blood and a small number of these cells then seed the gallbladder, where they subsequently replicate in bile. This model can explain why the liver often possesses its own resident population distinct from the gallbladder, and FRD enables robust quantification of this phenomenon. This pattern was observed in most animals, but mouse 9 was a clear exception (<xref rid="fig6" ref-type="fig">Fig. 6C</xref>). In this animal, the gallbladder population was one of the most diverse (high N<sub>r</sub>) observed. Furthermore, the gallbladder population in mouse 9 was nearly identical to all other organs (low GD). The gallbladder appears to account entirely for the population in the liver (FRD<sub>gallbladder-Liver</sub> = 1, contrasting with mouse 1 in <xref rid="fig5" ref-type="fig">Fig. 5</xref>) and the gastrointestinal (GI) organs. The gallbladder population also includes a set of nontransferred barcodes that are absent from the liver and gastrointestinal organs (FRD<sub>colon-gallbladder</sub> = FRD<sub>cecum-gallbladder</sub> = FRD<sub>SI-gallbladder</sub> = 0.6, while FRD<sub>gallbladder-colon</sub> ≈ FRD<sub>gallbladder-cecum</sub> ≈ FRD<sub>gallbladder-SI</sub> ≈ 1) (<xref rid="fig6" ref-type="fig">Fig. 6B</xref> and <xref rid="fig6" ref-type="fig">C</xref>). Thus, in mouse 9, the gallbladder seeded the intestines with only a fraction of its population.</p>
      <fig position="float" id="fig6">
        <label>FIG 6</label>
        <caption>
          <p>Gallbladder transmission dynamics. (A) FRD values are displayed for liver/gallbladder and feces/gallbladder pairs. There is no significant difference between FRD<sub>gallbladder-feces</sub> and FRD<sub>feces-gallbladder</sub>. In contrast, FRD<sub>gallbladder-liver</sub> is significantly less than FRD<sub>liver-gallbladder</sub> (two-tailed paired <italic toggle="yes">t</italic> test), indicating that shared tags typically represent a smaller fraction of tags in the liver than the gallbladder. The difference in FRD values indicate that the liver has a resident population that is not shared with the gallbladder. Asterisks represent an animal (mouse 9) that was a notable exception to this trend. The barcode frequency distribution (after noise removal by the resiliency algorithm) of the gallbladder of this animal is presented in B. The top 100 most abundant barcodes in the gallbladder are highlighted in red, and these barcodes are highlighted in other organs in C. In this animal, the gallbladder appeared to be more diverse and only shared a fraction of its population with other organs.</p>
        </caption>
        <graphic xlink:href="msystems.00887-21-f006" position="anchor"/>
      </fig>
      <p>By plotting the GD and FRD of each organ against all organs in the animal in a heatmap, we can rapidly detect consistent and variable spreading events. For example, examination of the heatmaps in <xref rid="fig5" ref-type="fig">Fig. 5</xref> and <xref rid="figS6" ref-type="supplementary-material">Fig. S6</xref> reveal two groups of animals that vary in the levels of systemic spread of gallbladder bacteria. In mice 1, 4, 5, 6, 7, and 10, the gallbladder appeared to be mostly dissimilar to the lungs and the spleen. In contrast, in mice 2, 3, 8, and 9, the gallbladder population was highly similar to that of the lungs and spleen. The variable magnitudes of the stochastic systemic spread of gallbladder bacteria, very likely via blood, potentially explain these distinct dissemination patterns. Therefore, the fate of bacteria that have seeded and replicated in bile can profoundly alter pathogen populations in distal organs. More broadly, the STAMPR framework developed here can rapidly uncover stochastic and more subtle patterns of dissemination.</p>
      <supplementary-material position="float" id="figS6" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.6</object-id>
        <label>FIG S6</label>
        <p>GD and FRD heatmap representations of data derived from Fig. 2C of reference <xref rid="B24" ref-type="bibr">24</xref>. GD (left) and RD (right) are displayed as heatmaps across all organs for each mouse. The column names represent the reference in RD heatmaps. Heatmaps for mouse 1 are shown in <xref rid="fig5" ref-type="fig">Fig. 5</xref>. SI and GB are abbreviations for the small intestine and gallbladder, respectively. Download <inline-supplementary-material id="fS6" xlink:href="msystems.00887-21-sf006.pdf" content-type="local-data">FIG S6, PDF file, 0.4 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
    <sec id="s2-4">
      <title>Summary and perspectives.</title>
      <p>Coupling barcoded bacteria with high-throughput DNA sequencing enables powerful investigations of bacterial population dynamics. In infection biology, comparisons of barcode abundances in an experimental inoculum with those found in various host organs (the output) at different times postinoculation enables inferences about the sizes of bottlenecks and patterns of pathogen dissemination. However, bacteria often undergo unequal expansion within an organ, resulting in marked differences in the frequencies of barcodes in the output library compared to the input. Here, we show that these differences confound calculations underlying quantification of founding population sizes and dissemination patterns. We created a new framework, called STAMPR, that provides a more comprehensive assessment of within-host population dynamics.</p>
      <p>Our approach accounts for unequal growth and highly abundant tags to provide a more complete assessment of infection population dynamics. Two metrics (N<sub>r</sub> and N<sub>b</sub>) define the number of organisms from the inoculum that give rise to the population in an organ. N<sub>b</sub> is highly sensitive to disproportionately abundant tags, while N<sub>r</sub> is more resistant to the presence of highly abundant barcodes. The N<sub>r</sub>/N<sub>b</sub> ratio measures the magnitude of unequal growth, which is often very large in samples where very few clones have expanded dramatically. Comparison of barcode frequencies between samples further enables assessment of bacterial dissemination, quantified by GD. We further refine GD to determine the precise number of barcodes that are transferred between samples, in a metric termed RD. Combining RD with founding population sizes results in a directional metric (FRD) that quantifies the relative abundance of shared bacteria within two samples. Taken together, we refine and establish eight metrics for a pair of samples (N<sub>b</sub> and N<sub>r</sub> for samples A and B, and GD, RD, FRD<sub>A-B</sub>, and FRD<sub>B-A</sub>) from which the entire underlying barcode frequency distributions can be summarized (<xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref>). Furthermore, when used across many organs, these metrics enable high-resolution analysis of population dynamics in a single animal.</p>
      <p>Reanalysis of previous infection data also highlights the power of our method to uncover previously unappreciated dissemination dynamics. Importantly, though our approach removes clonal expansions for more accurate calculation of the FP, it also identifies them. Analyses of these heterogenous expansion events in organs and across animals reveal that this previously unrecognized phenomenon is highly prevalent in infection contexts. Approaches to visualize and quantify such events will set the stage for future studies to characterize how host responses, spatial relationships, and interventions may govern these uneven replication dynamics. Future studies can provide further resolution by employing these metrics with repeated sampling over time, which would enable more precise determination of rates of population constriction and growth. We anticipate that applications of our new tools in future studies will deepen our understanding of within-host (and between-host) bacterial population dynamics. Finally, our strategy to account for unequal tag abundance will also have utility in studies beyond infection dynamics that rely on barcode frequency analysis, including lineage tracing, cancer progression, and experimental evolution (<xref rid="B18" ref-type="bibr">18</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="s3">
    <title>MATERIALS AND METHODS</title>
    <sec id="s3-1">
      <title>Processing of STAMP reads.</title>
      <p>Reads were first demultiplexed on Illumina BaseSpace via i7 and then further demultiplexed on CLC Genomics Workbench using the first 6 nucleotides. Trimming was performed using the default parameters and only reads between 18 and 22 nucleotides (nt) were kept. Trimmed reads were mapped to the list of 1,329 barcodes (obtained from reference <xref rid="B32" ref-type="bibr">32</xref>) using the default parameters in CLC and the mapping file was exported directly from CLC as a csv file containing barcodes and read counts.</p>
    </sec>
    <sec id="s3-2">
      <title>Calculation of N<sub>b</sub> and N<sub>r</sub>.</title>
      <p>Previous studies have “calibrated” N<sub>b</sub> values to a known standard curve and the calibrated values were referred to as N<sub>b</sub>’. However, this calibration is only meaningful when the biological data generally satisfies the assumptions of equal growth rates and uniform bottleneck that is used to generate the standard curve and was therefore omitted from the analyses presented here. Comparison of <xref rid="fig5" ref-type="fig">Fig. 5</xref> in this study (uncalibrated) and Fig. S2C from reference <xref rid="B24" ref-type="bibr">24</xref> (calibrated) shows the negligible impact of calibration on these data. To calculate N<sub>b</sub> and N<sub>r</sub>, metadata is first retrieved from a csv file containing the barcode frequencies of the references and samples and from a table of CFU for each sample. Replicates for reference vectors (i.e., values sequenced from the inoculum) are averaged. A bottleneck for the reference vector is then iteratively simulated by resampling the reference vector from a multivariate hypergeometric distribution. Each iteration is resampled to different depths, ranging from 1 read to 10 times the total number of barcodes in the sample in increments of 10. Therefore, a library with 1,000 barcodes is iteratively resampled 1,000 times from 1 read to 10,000 reads. This is typically sufficient to plateau the number of unique barcodes. At each iteration, the number of nonzero barcodes is calculated and plotted against the resampling size. This plot is referred to as the “reference resample plot.” The <italic toggle="yes">x</italic> axis value of this plot is referred to as N<sub>s</sub> and represents a bottleneck size that yields a desired number of barcodes. This plot is used later to identify the size of the computation-derived bottleneck (N<sub>s</sub>) that gives rise to the observed number of barcodes in the sample.</p>
      <p>A user-specified noise-filtering step is included to assist the resiliency algorithm in locating noise. In practice, this is estimated from control samples within a sequencing run for which the precise number of barcodes is known. Reads that map to other barcodes are therefore a result of noise, likely due to index hopping. Measuring the relative abundance of these reads enables a preliminary user-controlled noise filtering prior to the more unbiased steps in the algorithm, as described below. For the ExPEC study, noise was set to 0.5% (indicated by controls), while it was set to 1% for reanalysis of <named-content content-type="genus-species">P. aeruginosa</named-content> data (a conservative estimate). The desired number of reads is simulated on the reference vector with a multivariate hypergeometric distribution and subtracted from the output vector.</p>
      <p>Next, we determine the number of required iterations for barcode removal, which is set to a minimum value among the CFU of the sample (plus one) or the number of barcodes with more than 1 read. This ultimately helps speed computation of N<sub>r</sub> for low CFU samples, since it is not necessary to iterate for more than the number of unique cells contributing to DNA in the sample. The reference and output vectors are then matched and ordered by the output vector, and the first N<sub>b</sub> is calculated from the Krimbas and Tsakas equation. Next, the last row that contains the most abundant output barcode is removed, along with the corresponding input barcode. Note that at early iterations, this is essentially the same as setting the output barcode equal to the input barcode. After this removal, the second N<sub>b</sub> is calculated; this process is then iterated for the previously determined number of iterations to generate the first resiliency plot.</p>
      <p>A local minimum can arise in the resiliency plot when barcodes resulting from bacteria present in the sample (“real” barcodes) have been removed. This is due to the relatively similar sequence noise across all samples, which are multiplexed in &gt;50 samples per MiSeq lane. As the real barcodes have been removed, the “noise” resembles the inoculum and begins to raise the N<sub>b</sub> value. For example, if there are 100 “real” evenly distributed barcodes in the sample and 100 “noise” barcodes, removal of the 90 most abundant barcodes will yield a population that resembles one where there is no noise, but 10 highly abundant clones overlaying a more diverse population. This results in a low N<sub>b</sub> value. When the 100 more abundant barcodes are removed, there are no longer any highly abundant barcodes, so N<sub>b</sub> increases. Biological data, however, is rarely this clear, and therefore a goal of the algorithm is to identify all local minima, as they represent potential locations in which the barcode distribution could be approaching noise.</p>
      <p>To accomplish this, the algorithm starts at multiple “initiation sites” across the resiliency plot. The number of initiation sites is set equal to 1/15 the number of elements in the resiliency plot, which can be calibrated as needed but is practical for STAMP data with ∼10<sup>2</sup> to 10<sup>3</sup> barcodes. Each initiation site is an <italic toggle="yes">x</italic> coordinate on the resiliency plot. For each of these sites, the algorithm performs the following computation. A sample is drawn from a normal distribution with a mean equal to the position of the initiation site and standard deviation equation to 1/10 the number of elements in the resiliency plot. Decreasing the standard deviation decreases the “search space” and, therefore, increases the number of local minima that can potentially be found. If the standard deviation is too large, only the global minimum will be found. This sample is a “guess” for where to potentially move on the resiliency plot. Since this “guess” is another <italic toggle="yes">x</italic> coordinate on the resiliency plot, the corresponding <italic toggle="yes">y</italic> coordinate is determined. If this new <italic toggle="yes">y</italic> coordinate is less than the <italic toggle="yes">y</italic> coordinate of the initiation site, the mean of the next normal distribution is set to equal the guess. This process is repeated 1,000 times, where “guesses” are repeatedly drawn from a normal distribution and accepted only if they result in a lower <italic toggle="yes">y</italic> coordinate on the resiliency plot. In this manner, the initiation site settles to some value on the resiliency plot. The <italic toggle="yes">x</italic> coordinates where this process settles after 1,000 iterations and across all initiation sites are known as “breaks.” The location of the greatest log change in the resiliency plot is also determined and added to the breaks; a similar parameter was used to separate true and false barcodes in a previous approach (<xref rid="B19" ref-type="bibr">19</xref>). Collectively, each break represents some notable transition in the barcode frequencies of the output sample relative to the input.</p>
      <p>An “indices table” is then constructed around the breaks. For each break, fractional abundance for those barcodes in between is calculated (referred to as “weights”). For example, if two breaks are located at position 5 and 200 in the resiliency plot, then we calculate the fractional abundance of the first 5 barcodes and barcodes 6 to 200. Additionally, we identify the maximum N<sub>b</sub> up to each break. In this example, this would mean identifying the maximum N<sub>b</sub> in the first 5 values of the resiliency plot and the maximum N<sub>b</sub> in the first 200 values. The indices table combines the maximum N<sub>b</sub>, weight, and breaks.</p>
      <p>Next, noise is defined from the indices table as the greatest log change in weight; the breakpoint immediately prior to the greatest log change represents the iteration in the resiliency plot after which all real barcodes have been removed. Since the resiliency plot is derived from an ordered list of barcode frequencies, this iteration can be traced back to barcodes above and below a specific number of reads. A verification step is performed to ensure that all non-noise barcodes represent a set minimum of the total number of reads (97% in this study) and can be altered as needed. After noise is determined, all barcodes determined to be noise are set to 0 and a new resiliency plot is generated from this noiseless set of data.</p>
      <p>The final FP estimation from the resiliency algorithm, referred to as N<sub>r</sub>, is equal to the maximum value among (i) the maximum N<sub>b</sub> in this new second resiliency plot, (ii) the original N<sub>b</sub> estimate (i.e., the output of the first iteration), or (iii) the value of N<sub>s,</sub> which corresponds to the number of non-noise-derived barcodes derived from the reference resample plot using inverse interpolation. This ensures that N<sub>r</sub> will always be greater than or equal to N<sub>b</sub> and that N<sub>r</sub> will never be less than the observed number of counted barcodes. In this manner, this algorithm chooses the strategy that determines the FP that most adequately captures all barcodes. Very complex libraries (e.g., &gt;100,000 barcodes) would almost always derive N<sub>r</sub> values from the reference resample plot, while smaller libraries will more often use resiliency plots to find the maximum N<sub>b</sub> for large FPs. Similarly, if there is a substantial amount of variation in barcode frequency due to sources other than the bottleneck (such as phenotypic heterogeneity) such that N<sub>b</sub> is very low, N<sub>r</sub> will be equal to N<sub>s</sub>. An important implication of the use of N<sub>s</sub> by the resiliency algorithm is that the resolution limit of N<sub>s</sub> increases when there are more barcodes (<xref rid="figS4" ref-type="supplementary-material">Fig. S4B</xref>). For example, if the data is highly variable but all barcodes are present, N<sub>s</sub> will be greater for a library of 1,000 barcodes than for a library of 200 barcodes. Additionally, since N<sub>r</sub> relies on simulations, the precise value differs slightly each time the algorithm is run. One notable class of edge cases is samples with 1 CFU that can yield N<sub>r</sub> values of ∼2; these cases can easily be corrected <italic toggle="yes">post hoc</italic> and do not affect data interpretation.</p>
    </sec>
    <sec id="s3-3">
      <title>Calculation of GD and RD.</title>
      <p>Genetic distance (GD) is calculated by the Cavalli-Sforza chord distance as described (<xref rid="B22" ref-type="bibr">22</xref>, <xref rid="B33" ref-type="bibr">33</xref>). We analogize our approach for calculating N<sub>r</sub> to genetic distance and created a metric—RD—that measures the number of barcodes that contribute to “meaningful” relatedness between samples. Low values of RD imply that few barcodes are shared, whereas high values of RD imply that many barcodes are shared.</p>
      <p>RD is calculated in single script as follows. Barcode frequency vectors are obtained after running the resiliency algorithm after removal of noise. Both organs are paired and ordered by the geometric mean abundance of each barcode. GD is calculated iteratively and barcodes are removed as done in the resiliency algorithm. RD is equal to the number of barcodes that yield GD values below 0.8 on the graph of GD versus iteration. Figure S5 shows how this graph behaves for a variety of given inputs and how the RD value is derived from them. The value 0.8 approximates the GD of two unrelated biological samples (<xref rid="B24" ref-type="bibr">24</xref>), but this threshold can be adjusted depending on how the experimenter interprets “meaningful” relatedness. In Bachta et al., this threshold was determined by calculating inter-animal GD, where these samples are expected to be completely dissimilar. To assess the validity of this threshold without animals, we simulated a pair of random samples with varying FP values and calculated GD (<xref rid="figS7" ref-type="supplementary-material">Fig. S7</xref>). The resulting curve reveals that two random samples with higher FP values will also have lower GD values, since the odds of the same barcodes being present in a pair of samples increases with higher FPs. In both ExPEC and <named-content content-type="genus-species">P. aeruginosa</named-content> libraries, GD = 0.8 intersects the curves after the upper asymptote but before the steep decrease in the sigmoid. By plotting log<sub>10</sub>(FP) versus GD, future studies can verify that GD = 0.8 intersects this curve at a similar location.</p>
      <supplementary-material position="float" id="figS7" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.7</object-id>
        <label>FIG S7</label>
        <p>Determination of the GD threshold. First, pairs of samples were obtained with various resampling sizes (FP). Then, for each pair, GD was calculated and plotted against the FP. Error bars denote the standard deviation from 100 simulations. The GD threshold used for RD (GD = 0.8) intersects both curves at similar locations, just before the steep decrease in the sigmoid. The differences between the ExPEC and <named-content content-type="genus-species">P. aeruginosa</named-content> curves are likely the result of different barcode skew. These plots can be recreated in future studies to establish that GD = 0.8 is an appropriate threshold by determining if the intersection location is similar. Download <inline-supplementary-material id="fS7" xlink:href="msystems.00887-21-sf007.pdf" content-type="local-data">FIG S7, PDF file, 0.2 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>FRD is manually determined by dividing the log of each RD value (plus one) in each column of the output table (all pairwise comparisons) by the log of the maximum value in each column (plus one). The maximum value of each column is the RD value of the sample compared with itself, which defines the column.</p>
    </sec>
    <sec id="s3-4">
      <title>Data and code availability.</title>
      <p>All scripts used in this manuscript are available at <ext-link xlink:href="https://github.com/hullahalli/stampr_rtisan" ext-link-type="uri">https://github.com/hullahalli/stampr_rtisan</ext-link>. Barcode frequency counts for ExPEC STAMP experiments were experimentally derived from our companion manuscript (<xref rid="B32" ref-type="bibr">32</xref>) and are available at the above link to reproduce plots in <xref rid="fig2" ref-type="fig">Fig. 2</xref> and <xref rid="fig3" ref-type="fig">3</xref>, and <xref rid="figS5" ref-type="supplementary-material">Fig. S5</xref>. Barcode counts for <named-content content-type="genus-species">P. aeruginosa</named-content> STAMP experiments are provided in reference <xref rid="B24" ref-type="bibr">24</xref>.</p>
      <supplementary-material position="float" id="tabS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00887-21.8</object-id>
        <label>TABLE S1</label>
        <p>Variables used in this study <inline-supplementary-material id="tS1" xlink:href="msystems.00887-21-st001.docx" content-type="local-data">Table S1, DOCX file, 0.01 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Hullahalli et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Hullahalli et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-08-17"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="d96e173">
      <caption>
        <title>Reviewer comments</title>
      </caption>
      <media xlink:href="reviewer-comments.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>We thank members of the Waldor lab for providing valuable feedback on the manuscript. We are especially grateful to Michael Chao, Gabriel Billings, Brandon Sit, Ian Campbell, Sören Abel, and Pia Abel zur Wiesch for feedback on the manuscript.</p>
    <p>This work was supported by an NSF Graduate Research Fellowship (K.H.), the Howard Hughes Medical Institute (M.K.W.), and AI-RO1-042347 (M.K.W.).</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abel</surname><given-names>S</given-names></string-name>, <string-name><surname>Abel Zur Wiesch</surname><given-names>P</given-names></string-name>, <string-name><surname>Davis</surname><given-names>BM</given-names></string-name>, <string-name><surname>Waldor</surname><given-names>MK</given-names></string-name></person-group>. <year>2015</year>. <article-title>Analysis of bottlenecks in experimental models of infection</article-title>. <source>PLoS Pathog</source><volume>11</volume>:<elocation-id>e1004823</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1004823</pub-id>.<pub-id pub-id-type="pmid">26066486</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mahmutovic</surname><given-names>A</given-names></string-name>, <string-name><surname>Abel Zur Wiesch</surname><given-names>P</given-names></string-name>, <string-name><surname>Abel</surname><given-names>S</given-names></string-name></person-group>. <year>2020</year>. <article-title>Selection or drift: the population biology underlying transposon insertion sequencing experiments</article-title>. <source>Comput Struct Biotechnol J</source><volume>18</volume>:<fpage>791</fpage>–<lpage>804</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.csbj.2020.03.021</pub-id>.<pub-id pub-id-type="pmid">32280434</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kono</surname><given-names>M</given-names></string-name>, <string-name><surname>Zafar</surname><given-names>MA</given-names></string-name>, <string-name><surname>Zuniga</surname><given-names>M</given-names></string-name>, <string-name><surname>Roche</surname><given-names>AM</given-names></string-name>, <string-name><surname>Hamaguchi</surname><given-names>S</given-names></string-name>, <string-name><surname>Weiser</surname><given-names>JN</given-names></string-name></person-group>. <year>2016</year>. <article-title>Single cell bottlenecks in the pathogenesis of Streptococcus pneumoniae</article-title>. <source>PLoS Pathog</source><volume>12</volume>:<elocation-id>e1005887</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1005887</pub-id>.<pub-id pub-id-type="pmid">27732665</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bacigalupe</surname><given-names>R</given-names></string-name>, <string-name><surname>Tormo-Mas</surname><given-names>MÁ</given-names></string-name>, <string-name><surname>Penadés</surname><given-names>JR</given-names></string-name>, <string-name><surname>Ross Fitzgerald</surname><given-names>J</given-names></string-name></person-group>. <year>2019</year>. <article-title>A multihost bacterial pathogen overcomes continuous population bottlenecks to adapt to new host species</article-title>. <source>Sci Adv</source><volume>5</volume>:<elocation-id>eaax0063</elocation-id>. doi:<pub-id pub-id-type="doi">10.1126/sciadv.aax0063</pub-id>. <pub-id pub-id-type="pmid">31807698</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hibbing</surname><given-names>ME</given-names></string-name>, <string-name><surname>Dodson</surname><given-names>KW</given-names></string-name>, <string-name><surname>Kalas</surname><given-names>V</given-names></string-name>, <string-name><surname>Chen</surname><given-names>SL</given-names></string-name>, <string-name><surname>Hultgren</surname><given-names>SJ</given-names></string-name></person-group>. <year>2020</year>. <article-title>Adaptation of arginine synthesis among uropathogenic branches of the Escherichia coli phylogeny reveals adjustment to the urinary tract habitat</article-title>. <source>mBio</source><volume>11</volume>:<elocation-id>e02318-20</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/mBio.02318-20</pub-id>.<pub-id pub-id-type="pmid">32994329</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barnes</surname><given-names>PD</given-names></string-name>, <string-name><surname>Bergman</surname><given-names>MA</given-names></string-name>, <string-name><surname>Mecsas</surname><given-names>J</given-names></string-name>, <string-name><surname>Isberg</surname><given-names>RR</given-names></string-name></person-group>. <year>2006</year>. <article-title>Yersinia pseudotuberculosis disseminates directly from a replicating bacterial pool in the intestine</article-title>. <source>J Exp Med</source><volume>203</volume>:<fpage>1591</fpage>–<lpage>1601</lpage>. doi:<pub-id pub-id-type="doi">10.1084/jem.20060905</pub-id>.<pub-id pub-id-type="pmid">16754724</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grant</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Restif</surname><given-names>O</given-names></string-name>, <string-name><surname>McKinley</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Sheppard</surname><given-names>M</given-names></string-name>, <string-name><surname>Maskell</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Mastroeni</surname><given-names>P</given-names></string-name></person-group>. <year>2008</year>. <article-title>Modelling within-host spatiotemporal dynamics of invasive bacterial disease</article-title>. <source>PLoS Biol</source><volume>6</volume>:<elocation-id>e74</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pbio.0060074</pub-id>.<pub-id pub-id-type="pmid">18399718</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moxon</surname><given-names>R</given-names></string-name>, <string-name><surname>Kussell</surname><given-names>E</given-names></string-name></person-group>. <year>2017</year>. <article-title>The impact of bottlenecks on microbial survival, adaptation, and phenotypic switching in host–pathogen interactions</article-title>. <source>Evolution</source><volume>71</volume>:<fpage>2803</fpage>–<lpage>2816</lpage>. doi:<pub-id pub-id-type="doi">10.1111/evo.13370</pub-id>.<pub-id pub-id-type="pmid">28983912</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>CM</given-names></string-name>, <string-name><surname>Trzciński</surname><given-names>K</given-names></string-name>, <string-name><surname>Lipsitch</surname><given-names>M</given-names></string-name></person-group>. <year>2013</year>. <article-title>Within-host selection is limited by an effective population of Streptococcus pneumoniae during nasopharyngeal colonization</article-title>. <source>Infect Immun</source><volume>81</volume>:<fpage>4534</fpage>–<lpage>4543</lpage>. doi:<pub-id pub-id-type="doi">10.1128/IAI.00527-13</pub-id>.<pub-id pub-id-type="pmid">24082074</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Warr</surname><given-names>AR</given-names></string-name>, <string-name><surname>Hubbard</surname><given-names>TP</given-names></string-name>, <string-name><surname>Munera</surname><given-names>D</given-names></string-name>, <string-name><surname>Blondel</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Abel Zur Wiesch</surname><given-names>P</given-names></string-name>, <string-name><surname>Abel</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Davis</surname><given-names>BM</given-names></string-name>, <string-name><surname>Waldor</surname><given-names>MK</given-names></string-name></person-group>. <year>2019</year>. <article-title>Transposon-insertion sequencing screens unveil requirements for EHEC growth and intestinal colonization</article-title>. <source>PLoS Pathog</source><volume>15</volume>:<elocation-id>e1007652</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1007652</pub-id>.<pub-id pub-id-type="pmid">31404118</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubbard</surname><given-names>TP</given-names></string-name>, <string-name><surname>Billings</surname><given-names>G</given-names></string-name>, <string-name><surname>Dörr</surname><given-names>T</given-names></string-name>, <string-name><surname>Sit</surname><given-names>B</given-names></string-name>, <string-name><surname>Warr</surname><given-names>AR</given-names></string-name>, <string-name><surname>Kuehl</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Kim</surname><given-names>M</given-names></string-name>, <string-name><surname>Delgado</surname><given-names>F</given-names></string-name>, <string-name><surname>Mekalanos</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Lewnard</surname><given-names>JA</given-names></string-name>, <string-name><surname>Waldor</surname><given-names>MK</given-names></string-name></person-group>. <year>2018</year>. <article-title>A live vaccine rapidly protects against cholera in an infant rabbit model</article-title>. <source>Sci Transl Med</source><volume>10</volume>:<elocation-id>eaap8423</elocation-id>. doi:<pub-id pub-id-type="doi">10.1126/scitranslmed.aap8423</pub-id>.<pub-id pub-id-type="pmid">29899024</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Stabler</surname><given-names>RA</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>PW</given-names></string-name></person-group>. <year>2018</year>. <article-title>Genome-wide identification by transposon insertion sequencing of Escherichia coli K1 genes essential for in vitro growth, gastrointestinal colonizing capacity, and survival in serum</article-title>. <source>J Bacteriol</source><volume>200</volume>:<elocation-id>e00698-17</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/JB.00698-17</pub-id>.<pub-id pub-id-type="pmid">29339415</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paczosa</surname><given-names>MK</given-names></string-name>, <string-name><surname>Silver</surname><given-names>RJ</given-names></string-name>, <string-name><surname>McCabe</surname><given-names>AL</given-names></string-name>, <string-name><surname>Tai</surname><given-names>AK</given-names></string-name>, <string-name><surname>McLeish</surname><given-names>CH</given-names></string-name>, <string-name><surname>Lazinski</surname><given-names>DW</given-names></string-name>, <string-name><surname>Mecsas</surname><given-names>J</given-names></string-name></person-group>. <year>2020</year>. <article-title>Transposon mutagenesis screen of Klebsiella pneumoniae identifies multiple genes important for resisting antimicrobial activities of neutrophils in mice</article-title>. <source>Infect Immun</source><volume>88</volume>:<elocation-id>e00034-20</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/IAI.00034-20</pub-id>.<pub-id pub-id-type="pmid">31988174</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armbruster</surname><given-names>CE</given-names></string-name>, <string-name><surname>Forsyth</surname><given-names>VS</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>AO</given-names></string-name>, <string-name><surname>Smith</surname><given-names>SN</given-names></string-name>, <string-name><surname>White</surname><given-names>AN</given-names></string-name>, <string-name><surname>Brauer</surname><given-names>AL</given-names></string-name>, <string-name><surname>Learman</surname><given-names>BS</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>L</given-names></string-name>, <string-name><surname>Wu</surname><given-names>W</given-names></string-name>, <string-name><surname>Anderson</surname><given-names>MT</given-names></string-name>, <string-name><surname>Bachman</surname><given-names>MA</given-names></string-name>, <string-name><surname>Mobley</surname><given-names>HLT</given-names></string-name></person-group>. <year>2019</year>. <article-title>Twin arginine translocation, ammonia incorporation, and polyamine biosynthesis are crucial for Proteus mirabilis fitness during bloodstream infection</article-title>. <source>PLoS Pathog</source><volume>15</volume>:<elocation-id>e1007653</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1007653</pub-id>.<pub-id pub-id-type="pmid">31009518</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anderson</surname><given-names>MT</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>LA</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>L</given-names></string-name>, <string-name><surname>Mobley</surname><given-names>HLT</given-names></string-name></person-group>. <year>2018</year>. <article-title>Citrobacter freundii fitness during bloodstream infection</article-title>. <source>Sci Rep</source><volume>8</volume>:<fpage>11792</fpage>. doi:<pub-id pub-id-type="doi">10.1038/s41598-018-30196-0</pub-id>.<pub-id pub-id-type="pmid">30087402</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anderson</surname><given-names>MT</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>LA</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>L</given-names></string-name>, <string-name><surname>Mobley</surname><given-names>HLT</given-names></string-name></person-group>. <year>2017</year>. <article-title>Capsule production and glucose metabolism dictate fitness during Serratia marcescens bacteremia</article-title>. <source>mBio</source><volume>8</volume>:<elocation-id>e00740-17</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/mBio.00740-17</pub-id>.<pub-id pub-id-type="pmid">28536292</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Walters</surname><given-names>MS</given-names></string-name>, <string-name><surname>Chelsea Lane</surname><given-names>M</given-names></string-name>, <string-name><surname>Vigil</surname><given-names>PD</given-names></string-name>, <string-name><surname>Smith</surname><given-names>SN</given-names></string-name>, <string-name><surname>Walk</surname><given-names>ST</given-names></string-name>, <string-name><surname>Mobley</surname><given-names>HLT</given-names></string-name></person-group>. <year>2012</year>. <article-title>Kinetics of uropathogenic Escherichia coli metapopulation movement during urinary tract infection</article-title>. <source>mBio</source><volume>3</volume>:<elocation-id>e00303-11</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/mBio.00303-11</pub-id>.</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blundell</surname><given-names>JR</given-names></string-name>, <string-name><surname>Levy</surname><given-names>SF</given-names></string-name></person-group>. <year>2014</year>. <article-title>Beyond genome sequencing: lineage tracking with barcodes to study the dynamics of evolution, infection, and cancer</article-title>. <source>Genomics</source><volume>104</volume>:<fpage>417</fpage>–<lpage>430</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ygeno.2014.09.005</pub-id>.<pub-id pub-id-type="pmid">25260907</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Cadena</surname><given-names>AM</given-names></string-name>, <string-name><surname>Leung</surname><given-names>VW</given-names></string-name>, <string-name><surname>Lin</surname><given-names>PL</given-names></string-name>, <string-name><surname>Maiello</surname><given-names>P</given-names></string-name>, <string-name><surname>Hicks</surname><given-names>N</given-names></string-name>, <string-name><surname>Chase</surname><given-names>MR</given-names></string-name>, <string-name><surname>Flynn</surname><given-names>JAL</given-names></string-name>, <string-name><surname>Fortune</surname><given-names>SM</given-names></string-name></person-group>. <year>2017</year>. <article-title>Digitally barcoding Mycobacterium tuberculosis reveals in vivo infection dynamics in the macaque model of tuberculosis</article-title>. <source>mBio</source><volume>8</volume>:<elocation-id>e00312-17</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/mBio.00312-17</pub-id>.<pub-id pub-id-type="pmid">28487426</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fiebig</surname><given-names>A</given-names></string-name>, <string-name><surname>Vrentas</surname><given-names>CE</given-names></string-name>, <string-name><surname>Le</surname><given-names>T</given-names></string-name>, <string-name><surname>Huebner</surname><given-names>M</given-names></string-name>, <string-name><surname>Boggiatto</surname><given-names>PM</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>SC</given-names></string-name>, <string-name><surname>Crosson</surname><given-names>S</given-names></string-name></person-group>. <year>2020</year>. <article-title>Quantification of Brucella abortus population structure in a natural host</article-title>. <source>Proc Natl Acad Sci USA</source><volume>118</volume>:<elocation-id>e2023500118</elocation-id>. doi:<pub-id pub-id-type="doi">10.1073/pnas.2023500118</pub-id>.</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jasinska</surname><given-names>W</given-names></string-name>, <string-name><surname>Manhart</surname><given-names>M</given-names></string-name>, <string-name><surname>Lerner</surname><given-names>J</given-names></string-name>, <string-name><surname>Gauthier</surname><given-names>L</given-names></string-name>, <string-name><surname>Serohijos</surname><given-names>AWR</given-names></string-name>, <string-name><surname>Bershtein</surname><given-names>S</given-names></string-name></person-group>. <year>2020</year>. <article-title>Chromosomal barcoding of E. coli populations reveals lineage diversity dynamics at high resolution</article-title>. <source>Nat Ecol Evol</source><volume>4</volume>:<fpage>437</fpage>–<lpage>452</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41559-020-1103-z</pub-id>.<pub-id pub-id-type="pmid">32094541</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abel</surname><given-names>S</given-names></string-name>, <string-name><surname>Abel Zur Wiesch</surname><given-names>P</given-names></string-name>, <string-name><surname>Chang</surname><given-names>H-H</given-names></string-name>, <string-name><surname>Davis</surname><given-names>BM</given-names></string-name>, <string-name><surname>Lipsitch</surname><given-names>M</given-names></string-name>, <string-name><surname>Waldor</surname><given-names>MK</given-names></string-name></person-group>. <year>2015</year>. <article-title>Sequence tag-based analysis of microbial population dynamics</article-title>. <source>Nat Methods</source><volume>12</volume>:<fpage>223</fpage>–<lpage>226</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.3253</pub-id>.<pub-id pub-id-type="pmid">25599549</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krimbas</surname><given-names>CB</given-names></string-name>, <string-name><surname>Tsakas</surname><given-names>S</given-names></string-name></person-group>. <year>1971</year>. <article-title>The genetics of <italic toggle="yes">Dacus oleae.</italic> V. Changes of esterase polymorphism in a natural population following insecticide control—selection or drift?</article-title><source>Evolution</source><volume>25</volume>:<fpage>454</fpage>–<lpage>460</lpage>. doi:<pub-id pub-id-type="doi">10.2307/2407343</pub-id>.<pub-id pub-id-type="pmid">28565021</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bachta</surname><given-names>KER</given-names></string-name>, <string-name><surname>Allen</surname><given-names>JP</given-names></string-name>, <string-name><surname>Cheung</surname><given-names>BH</given-names></string-name>, <string-name><surname>Chiu</surname><given-names>C-H</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>AR</given-names></string-name></person-group>. <year>2020</year>. <article-title>Systemic infection facilitates transmission of Pseudomonas aeruginosa in mice</article-title>. <source>Nat Commun</source><volume>11</volume>:<fpage>543</fpage>. doi:<pub-id pub-id-type="doi">10.1038/s41467-020-14363-4</pub-id>.<pub-id pub-id-type="pmid">31992714</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>T</given-names></string-name>, <string-name><surname>Abel</surname><given-names>S</given-names></string-name>, <string-name><surname>Abel Zur Wiesch</surname><given-names>P</given-names></string-name>, <string-name><surname>Sasabe</surname><given-names>J</given-names></string-name>, <string-name><surname>Davis</surname><given-names>BM</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DE</given-names></string-name>, <string-name><surname>Waldor</surname><given-names>MK</given-names></string-name></person-group>. <year>2017</year>. <article-title>Deciphering the landscape of host barriers to Listeria monocytogenes infection</article-title>. <source>Proc Natl Acad Sci USA</source><volume>114</volume>:<fpage>6334</fpage>–<lpage>6339</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1702077114</pub-id>.<pub-id pub-id-type="pmid">28559314</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>T</given-names></string-name>, <string-name><surname>Sasabe</surname><given-names>J</given-names></string-name>, <string-name><surname>Hullahalli</surname><given-names>K</given-names></string-name>, <string-name><surname>Sit</surname><given-names>B</given-names></string-name>, <string-name><surname>Waldor</surname><given-names>MK</given-names></string-name></person-group>. <year>2021</year>. <article-title>Increased Listeria monocytogenes dissemination and altered population dynamics in Muc2-deficient mice</article-title>. <source>Infect Immun</source><volume>89</volume>:<elocation-id>e00667-20</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/IAI.00667-20</pub-id>.<pub-id pub-id-type="pmid">33431704</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Kimmey</surname><given-names>JM</given-names></string-name>, <string-name><surname>Matarazzo</surname><given-names>L</given-names></string-name>, <string-name><surname>de Bakker</surname><given-names>V</given-names></string-name>, <string-name><surname>Van Maele</surname><given-names>L</given-names></string-name>, <string-name><surname>Sirard</surname><given-names>JC</given-names></string-name>, <string-name><surname>Nizet</surname><given-names>V</given-names></string-name>, <string-name><surname>Veening</surname><given-names>JW</given-names></string-name></person-group>. <year>2021</year>. <article-title>Exploration of bacterial bottlenecks and Streptococcus pneumoniae pathogenesis by CRISPRi-Seq</article-title>. <source>Cell Host Microbe</source><volume>29</volume>:<fpage>107</fpage>–<lpage>120.e6</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.chom.2020.10.001</pub-id>.<pub-id pub-id-type="pmid">33120116</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mahmutovic</surname><given-names>A</given-names></string-name>, <string-name><surname>Gillman</surname><given-names>AN</given-names></string-name>, <string-name><surname>Lauksund</surname><given-names>S</given-names></string-name>, <string-name><surname>Robson Moe</surname><given-names>NA</given-names></string-name>, <string-name><surname>Manzi</surname><given-names>A</given-names></string-name>, <string-name><surname>Storflor</surname><given-names>M</given-names></string-name>, <string-name><surname>Abel Zur Wiesch</surname><given-names>P</given-names></string-name>, <string-name><surname>Abel</surname><given-names>S</given-names></string-name></person-group>. <year>2021</year>. <article-title>RESTAMP—rate estimates by sequence-tag analysis of microbial populations</article-title>. <source>Comput Struct Biotechnol J</source><volume>19</volume>:<fpage>1035</fpage>–<lpage>1051</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.csbj.2021.01.017</pub-id>.<pub-id pub-id-type="pmid">33613869</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Winter</surname><given-names>SE</given-names></string-name></person-group>. <year>2020</year>. <article-title>Salmonella finds a way: metabolic versatility of Salmonella enterica serovar Typhimurium in diverse host environments</article-title>. <source>PLoS Pathog</source><volume>16</volume>:<elocation-id>e1008540</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.ppat.1008540</pub-id>.<pub-id pub-id-type="pmid">32525928</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Helaine</surname><given-names>S</given-names></string-name>, <string-name><surname>Cheverton</surname><given-names>AM</given-names></string-name>, <string-name><surname>Watson</surname><given-names>KG</given-names></string-name>, <string-name><surname>Faure</surname><given-names>LM</given-names></string-name>, <string-name><surname>Matthews</surname><given-names>SA</given-names></string-name>, <string-name><surname>Holden</surname><given-names>DW</given-names></string-name></person-group>. <year>2014</year>. <article-title>Internalization of Salmonella by macrophages induces formation of nonreplicating persisters</article-title>. <source>Science</source><volume>343</volume>:<fpage>204</fpage>–<lpage>208</lpage>. doi:<pub-id pub-id-type="doi">10.1126/science.1244705</pub-id>.<pub-id pub-id-type="pmid">24408438</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hausmann</surname><given-names>A</given-names></string-name>, <string-name><surname>Hardt</surname><given-names>W</given-names></string-name></person-group>. <year>2021</year>. <article-title>Elucidating host-microbe interactions <italic toggle="yes">in vivo</italic> by studying population dynamics using neutral genetic tags</article-title>. <source>Immunology</source><volume>162</volume>:<fpage>341</fpage>–<lpage>356</lpage>. doi:<pub-id pub-id-type="doi">10.1111/imm.13266</pub-id>.<pub-id pub-id-type="pmid">32931019</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32</label>
      <mixed-citation publication-type="working-paper"><person-group person-group-type="author"><string-name><surname>Hullahalli</surname><given-names>K</given-names></string-name>, <string-name><surname>Waldor</surname><given-names>MK</given-names></string-name></person-group>. <year>2021</year>. <article-title>Pathogen clonal expansion underlies multiorgan dissemination and organ-specific outcomes during systemic infection</article-title>. <source>bioRxiv</source> doi:<pub-id pub-id-type="doi">10.1101/2021.05.17.444473</pub-id>.</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cavalli-Sforza</surname><given-names>LL</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>AW</given-names></string-name></person-group>. <year>1967</year>. <article-title>Phylogenetic analysis. Models and estimation procedures</article-title>. <source>Am J Hum Genet</source><volume>19</volume>:<fpage>233</fpage>–<lpage>257</lpage>. doi:<pub-id pub-id-type="doi">10.1111/j.1558-5646.1967.tb03411.x</pub-id>.<pub-id pub-id-type="pmid">6026583</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
