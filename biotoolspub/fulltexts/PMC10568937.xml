<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10568937</article-id>
    <article-id pub-id-type="pmid">37821827</article-id>
    <article-id pub-id-type="publisher-id">5512</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05512-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>cgMSI: pathogen detection within species from nanopore metagenomic sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhu</surname>
          <given-names>Xu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhao</surname>
          <given-names>Lili</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Huang</surname>
          <given-names>Lihong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Wenxian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Liansheng</given-names>
        </name>
        <address>
          <email>lswang@xmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Rongshan</given-names>
        </name>
        <address>
          <email>rsyu@xmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00mcjh785</institution-id><institution-id institution-id-type="GRID">grid.12955.3a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7233</institution-id><institution>School of Informatics, </institution><institution>Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00mcjh785</institution-id><institution-id institution-id-type="GRID">grid.12955.3a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7233</institution-id><institution>Women and Children’s Hospital, School of Medicine, </institution><institution>Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0006swh35</institution-id><institution-id institution-id-type="GRID">grid.412625.6</institution-id><institution>Computer Management Center, </institution><institution>The First Affiliated Hospital of Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
      <aff id="Aff4"><label>4</label>Aginome Scientific, Xiamen, Fujian China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00mcjh785</institution-id><institution-id institution-id-type="GRID">grid.12955.3a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7233</institution-id><institution>National Institute for Data Science in Health and Medicine, Informatics, </institution><institution>Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>387</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Metagenomic sequencing is an unbiased approach that can potentially detect all the known and unidentified strains in pathogen detection. Recently, nanopore sequencing has been emerging as a highly potential tool for rapid pathogen detection due to its fast turnaround time. However, identifying pathogen within species is nontrivial for nanopore sequencing data due to the high sequencing error rate.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed the core gene alleles metagenome strain identification (cgMSI) tool, which uses a two-stage maximum a posteriori probability estimation method to detect pathogens at strain level from nanopore metagenomic sequencing data at low computational cost. The cgMSI tool can accurately identify strains and estimate relative abundance at 1× coverage.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We developed cgMSI for nanopore metagenomic pathogen detection within species. cgMSI is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZHU-XU-xmu/cgMSI">https://github.com/ZHU-XU-xmu/cgMSI</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05512-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pathogen detection</kwd>
      <kwd>Strain identification</kwd>
      <kwd>Nanopore sequencing</kwd>
      <kwd>Metagenomic data</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Infectious disease is one of the leading causes of death worldwide. In many cases, timely and accurate identification of the exact types of pathogenic microbes is a prerequisite for effective clinical treatment. Traditional clinical pathogen detection relies on culture-based techniques, which are time-consuming and do not meet the need for rapid diagnosis. For this reason, more attention has been paid to the direct detection of pathogens from metagenomic samples recently [<xref ref-type="bibr" rid="CR1">1</xref>]. Rapid metagenomic testing has been recognized as a promising tool for the diagnosis of unknown infections from body fluids [<xref ref-type="bibr" rid="CR2">2</xref>]. Recent work showed that it is possible to detect bacterial of lower respiratory infection with high sensitivity on metagenomic samples in 6 h from sample to result based on nanopore sequencing [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par5">Genomes of different strains within species are highly similar [<xref ref-type="bibr" rid="CR4">4</xref>], but subtle differences in genes may manifest as important phenotypic differences relevant to human health. For example, <italic>Escherichia coli strain O57: H7</italic> is pathogenic, whereas <italic>Escherichia coli Nissle</italic> strain is probiotic. Many tools have been developed to identify the precise strain information from metagenomic data, which include three main categories. Assembly-based methods, e.g., BHap [<xref ref-type="bibr" rid="CR5">5</xref>], STRONG [<xref ref-type="bibr" rid="CR6">6</xref>] and inStrain [<xref ref-type="bibr" rid="CR7">7</xref>], can identify new isolates but require a high sequencing depth to ensure the assembly accuracy and are not suitable for low abundance cases. K-mer-based methods, including MetaOthello [<xref ref-type="bibr" rid="CR8">8</xref>], strainGE [<xref ref-type="bibr" rid="CR9">9</xref>], Kraken [<xref ref-type="bibr" rid="CR10">10</xref>] and Kraken2 [<xref ref-type="bibr" rid="CR11">11</xref>], pre-compute an index of k-mers for each reference genome to classify sequence reads for efficient searching. Mapping-based methods, including MIST [<xref ref-type="bibr" rid="CR12">12</xref>], snipe [<xref ref-type="bibr" rid="CR13">13</xref>] and Centrifuge [<xref ref-type="bibr" rid="CR14">14</xref>], identify specific strains by mapping the reads against an established reference genomic database and evaluate the alignment results.</p>
    <p id="Par6">Next generation sequencing (NGS) typically requires a run time of more than 16 h for most metagenomic studies. In contrast, nanopore sequencing (MinION sequencer by Oxford Nanopore Technologies) can detect microbes within minutes after sequencing starts and has a turnaround time of less than 6 h [<xref ref-type="bibr" rid="CR15">15</xref>]. Therefore, nanopore sequencing has been considered as a highly potential tool for genomic surveillance of emerging viruses [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Several tools have been used to analyze nanopore sequencing data, including ORI [<xref ref-type="bibr" rid="CR19">19</xref>], Centrifuge, MetaMaps [<xref ref-type="bibr" rid="CR20">20</xref>] and Kraken2. ORI identifies strains from whole genome sequencing (WGS) samples. It only requires a small sequencing depth and achieves good results on samples containing multiple strains. Centrifuge is a rapid and memory-efficient metagenomic reads classifier. It splices different parts of multiple genomes of the same species or genus to form a large genome to alleviate the alignment bias. Unfortunately, it is not able to perform strain level identification. MetaMaps is a reads classifier that identifies strains by mapping the reads to all the reference genomes and analyzing the mapping scores. Kraken2 is a k-mer based method that is not specifically designed for strain level classification. The classification results of Kraken2 rely on the NCBI classification tree. However, most of the genomes do not have independent taxonomy identifiers. Therefore, Kraken2 does not provide satisfactory results at strain level.</p>
    <p id="Par7">A critical step in mapping-based approaches is the alignment of the reads to an established reference genome database. A read may align to multiple reference genomes with a same alignment score due to the high similarity and duplications between strains. In such cases, mapping algorithms may randomly select one as the best result and the rest as secondary alignments [<xref ref-type="bibr" rid="CR21">21</xref>], which, may lead to incorrect statistical results. This problem is more challenging for nanopore sequencing data due to their high sequencing error rates. To overcome this issue, Bracken [<xref ref-type="bibr" rid="CR22">22</xref>] counts only the unique reads information of the alignment to improve the accuracy of species-level abundance estimation. Salmon [<xref ref-type="bibr" rid="CR23">23</xref>] uses the expectation maximization (EM) algorithm to estimate the sequencing level of homologous templates from mappings generated by traditional mappers. KMA [<xref ref-type="bibr" rid="CR24">24</xref>] is specifically designed for this type of multi-mapping situation. KMA uses k-mer to speed-up mapping and the Needleman–Wunsch algorithm to accurately align extensions from k-mer. Multi-mapping reads are resolved using a novel sorting scheme to ensure an accurate assignment. As metagenomic sequences of different strains from the same species are highly similar, sequencing errors could reduce the accuracy of low abundance pathogen detection from metagenomic samples. To the best of our knowledge, currently there is no tool available to accurately identify strains from nanopore metagenomic data with low sequencing depths, e.g., less than 5× coverage. In addition, mapping nanopore reads is challenging under limited computational resources due to their long read length. For example, MetaMaps requires a long processing time, e.g., over 10 h for 74,000 reads. For these reasons, clinical applications of nanopore sequencing in pathogen detection are still limited.</p>
    <p id="Par8">To overcome these limitations, we developed cgMSI that formulates strain identification as a maximum a posteriori (MAP) estimation problem to take both sequencing errors and genome similarity between different strains into consideration for accurate strain-typing at low abundance. To reduce the computational load, cgMSI adopted a two-stage approach. In the first stage, cgMSI uses the core genome, which is the set of gene alleles shared by all strains of a given species of prokaryotes [<xref ref-type="bibr" rid="CR25">25</xref>], as a substitute for the whole genomes to quickly identify candidate genomes. The full alignment on the whole genomes is only performed on the selected candidate genome in the second stage for the final strain calling result. We evaluated the performance of cgMSI on synthetic <italic>Klebsiella pneumoniae</italic> datasets and a real sequencing dataset. The results showed that cgMSI can perform accurate strain typing and abundance estimation even at 1× coverage.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Overview of cgMSI and evaluation datasets</title>
      <p id="Par9">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the workflow of cgMSI. cgMSI identifies the target strain by a two-stage MAP estimation method. Firstly, the input nanopore raw reads are mapped to a pool of core gene alleles from the target species to calculate the probability that a read originates from different strains per locus. The aligned reads are selected, and candidate strains are identified using the first-stage MAP estimation. Then, cgMSI maps the selected reads against the reference genomes of the candidate strains and obtains the final calling result in the second-stage MAP estimation. We used minimap2 [<xref ref-type="bibr" rid="CR26">26</xref>] as the default aligner in both stages. Finally, the abundance of the target strain is estimated using the Monte Carlo (MC) sampling method.<fig id="Fig1"><label>Fig. 1</label><caption><p>The cgMSI workflow for strain identification on nanopore metagenomic data using two-stage MAP estimation. cgMSI starts by mapping the core gene alleles of the target species to raw reads (using reads as reference) and selects candidate strains using MAP probability estimation. After that, cgMSI maps the aligned reads to the full reference genomes of the candidate strains and identifies the target strain using the second-stage MAP probability estimation. The Monte Carlo method is used to estimate the proportion of the target strain reads containing a complete allele of a core gene, which is further used to estimate the coverage of the target strain</p></caption><graphic xlink:href="12859_2023_5512_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par10">We evaluated cgMSI on both simulated and real nanopore metagenomic datasets. We first generated simulated samples with different levels of interference to pathogen detection. We randomly selected 100 strains from the 930 <italic>Klebsiella pneumoniae</italic> strains (available online at the National Center for Biotechnology Information (NCBI) RefSeq [<xref ref-type="bibr" rid="CR27">27</xref>]) as target strains for synthetic mNGS datasets. For each target strain, simulated reads were generated at different coverage levels (0.1×, 0.5×, 1× and 5×) using NanoSim (version 3.0) [<xref ref-type="bibr" rid="CR28">28</xref>] with sequencer error profile metagenome_ERR3152366_Log.tar.gz (simulating Flowcell chemistry R9.4) provided by NanoSim and genome mode (-min 1000 -k 6 -b guppy). The simulated reads from target strains were then mixed respectively with simulated reads from four background strains selected from different species under <italic>Klebsiella</italic> at different ratios (1:1 or 1:5) to create the testing samples (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Illustration of the generation of simulated samples with different levels of interference. Each sample contains a random <italic>Klebsiella pneumonia</italic> genome as the target strain and a decoy strain genome. A total of four decoy strains were selected from the <italic>Klebsiella</italic> genus. The pair ANI of the target strain and the background strain was divided into two levels: 85% and 95%. The coverage ratio of the target strain and the decoy strain was divided as 1:1 and 1:5. A total of 3200 samples were generated</p></caption><graphic xlink:href="12859_2023_5512_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par11">To simulate mNGS samples of different difficulty levels, we analyzed the genomic similarity of different species under the genus <italic>Klebsiella</italic> and selected four species (KA: <italic>Klebsiella aerogenes</italic>, KM: <italic>Klebsiella michiganensis</italic>, KQ: <italic>Klebsiella quasipneumoniae</italic>, KV: <italic>Klebsiella variicola</italic>) of different Average Nucleotide Identity (ANI) [<xref ref-type="bibr" rid="CR29">29</xref>] scores ranging from 85 to 95% to the <italic>K. pneumoniae</italic> strains in the database as our background strains. Note that a cut-off ANI score of &gt; 95% between a given pair of genomes is usually considered that they belong to the same species [<xref ref-type="bibr" rid="CR30">30</xref>]. All ANI values in this paper were obtained using the FastANI tool (version 1.33) [<xref ref-type="bibr" rid="CR31">31</xref>]. In addition, to evaluate the computational performance of cgMSI, we generated four simulated mNGS samples with different sizes range from 1 to 1000 MB. For each sample, we added one <italic>Klebsiella pneumoniae</italic> strain as the target strain and one <italic>Klebsiella quasipneumoniae</italic> strain as the background strain with the same target strain abundance (20%) for different sample sizes. Here, abundance is defined as the ratio of the number of reads from the target strain to the total number of reads.</p>
      <p id="Par12">To evaluate the performance of cgMSI on complex metagenomic samples, we downloaded 100 nanopore sequencing datasets (NCBI Project ID: PRJNA820119) sequenced from healthy human gut metagenomic samples, and generated simulated samples based on this data. Firstly, we mapped the obtained samples to the high-quality human gut microbiome reference set WIS [<xref ref-type="bibr" rid="CR32">32</xref>], and removed all reads that mapped to <italic>Klebsiella pneumoniae,</italic> since the human gut was an important reservoir of <italic>Klebsiella pneumoniae</italic>. After filtering, we obtained 100 negative samples. To obtain positive samples, we spiked simulated <italic>Klebsiella pneumoniae</italic> reads into these negative samples. From the available 930 reference genomes of <italic>Klebsiella pneumoniae</italic>, we randomly selected one strain (RefSeq Assembly Accession: GCA_000240185.1) as the target strain. The simulated reads were generated using NanoSim software (version 3.0) with the same settings as described above. To simulate pathogen strains at different sequencing depths, we spiked each negative sample with simulated reads at 0.1×, 1×, and 10×, and obtained a total of 300 simulated positive samples.</p>
      <p id="Par13">For the real dataset, we used the ZymoBIOMICS dataset [<xref ref-type="bibr" rid="CR33">33</xref>], which contains 8 bacteria and 2 yeasts with equal abundance and was generated on a GridION using the R9.4.1 chemistry for evaluation. Experiments were performed separately on 6 bacterial species with core genes available. For each of the 6 species, we constructed the pool of core gene alleles and reference genome databases, and the corresponding read data were downsampled to simulate coverage levels of 0.1×, 0.5×, 1× and 5× according to the given sequencing depths for each strain. Additional file <xref rid="MOESM2" ref-type="media">2</xref> provides more pathogens information used in simulated dataset.</p>
    </sec>
    <sec id="Sec4">
      <title>Sensitivity of the filtering operation of cgMSI</title>
      <p id="Par15">The first stage of the MAP estimation in cgMSI identifies the candidate strains using core gene alleles. In this filtering operation, we selected the top <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M2"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq1.gif"/></alternatives></inline-formula> strains with the maximum probability as candidate strains. Here, we evaluated the filtering performance with the number of candidate strains <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M4"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq2.gif"/></alternatives></inline-formula> ranging from 5 to 40 on samples with different difficulty levels separately.</p>
      <p id="Par16">Overall, cgMSI correctly identified candidate strains in its first-stage filtering operation in simulated datasets when <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M6"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq3.gif"/></alternatives></inline-formula> was 10 and above (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We noticed that the sensitivity of cgMSI is almost saturated when we identified 40 strains as candidate strains. For each <italic>K</italic> value, the sensitivity was also affected by the coverage, the ratio of the target strain to the background strain (hereafter referred to as the target-to-background ratio), and the difficulty level of the samples as measured by the genomic similarity between the target and the background strains (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>The sensitivity of cgMSI to identify candidate strains using synthetic mNGS datasets. cgMSI identified candidate strains at different coverage ratios ranging from 0.1× to 5×, four different background strains (KA: <italic>Klebsiella aerogenes</italic>, KM: <italic>Klebsiella michiganensis</italic>, KQ: <italic>Klebsiella quasipneumoniae</italic>, KV: <italic>Klebsiella variicola</italic>) and two ratios of target strain to background strain (1:1 and 1:5). Top 5 to Top 40 indicate different numbers of candidate strains identified by cgMSI in the filtration operation. Error bar indicates 95% CI. When the set of candidate strains contains the target strain in a sample, we consider the filtrating operation as correct</p></caption><graphic xlink:href="12859_2023_5512_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par17">For <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M8"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq4.gif"/></alternatives></inline-formula> greater than or equal to 10, cgMSI correctly identified all candidate strains in KA and KM samples when the target-to-background ratio was 1:1 and the coverage ratio was 1× and above. For more challenging samples (KQ, KV), cgMSI achieved a sensitivity greater than 95% when <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K \ge 10$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq5.gif"/></alternatives></inline-formula>, the target-to-background ratio was 1:1 and the coverage ratio was 1× and above. When the target-to-background ratio was 1:5, cgMSI achieved similar sensitivity performances at 1× and 5× coverage levels, and slightly lower sensitivities at lower coverage levels. However, in the worst case cgMSI still achieved a sensitivity greater than 80% for KQ at 0.1× coverage when identifying 10 or more candidate strains.</p>
    </sec>
    <sec id="Sec5">
      <title>cgMSI identifies strains in synthetic mNGS datasets with interference</title>
      <p id="Par18">We evaluated the strain-level pathogen detection performance using simulated dataset with different levels of interference. For comparison, we used minimap2 + ORI as a benchmark which provided strain-level results in a reasonable timeframe. More specifically, for each sample, we mapped the simulated reads to all <italic>K. pneumoniae</italic> genomes in the reference database by minimap2 to preliminarily filter the reads of the target species, and input these reads to ORI. When ORI outputs multiple predicted strains with corresponding probabilities, we selected the strain with the highest probability as its calling result. We also tried to include MetaMaps in our benchmark test but were not successful due to its slow computational speed at the “map” stage and execution errors at the “classify” stage. In the filtering operation stage, we identified 10 candidate strains which was the default value in cgMSI. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 provides more information on the software used in the performance comparison experiments.</p>
      <p id="Par19">Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the results of cgMSI and ORI for strain-level pathogen detection in synthetic mNGS datasets. Similar to the results for candidate strains identification, it can be seen that the strain typing sensitivity was also affected by the coverage, the target-to-background ratio, and the difficulty levels of the samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). Particularly, cgMSI achieved a sensitivity greater than 90% at 1× and 5× coverage when the target-to-background ratio was 1:1. In contrast, the strain typing result showed 40% sensitivity improvement over ORI for all test cases.<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance evaluation of pathogen identification using synthetic decoy mNGS datasets. <bold>A</bold> Identification results of cgMSI and ORI from 3200 simulated samples at different coverage ratios ranging from 0.1× to 5×, different background strains and two target-to-background ratios. Error bar indicates 95% CI. <bold>B</bold> The box plots show the pair ANI values of the actual target strain and the predicted strain corresponding to the samples in (<bold>A</bold>). The pair ANI value is used to further assess the accuracy of the prediction. A higher ANI value indicates a more accurate prediction. <bold>C</bold> Coverage estimated by cgMSI at four different coverage levels. Each dot represents a single sample. Colors represent different target strain coverage ratios in the samples</p></caption><graphic xlink:href="12859_2023_5512_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par20">For samples whose target strains were not accurately detected, we used the pair ANI value between the actual target strain and the predicted strain to further estimate the typing accuracy. A higher ANI value indicates more accurate strain identification. Note that all samples where target strains were not correctly detected were also typed as strains that were extremely close to the actual strains (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). cgMSI identified all samples with ANI values greater than 0.997. At coverage of 5×, cgMSI achieved an ANI value greater than 0.999. Although the pair ANI value from ORI improved with decreasing task difficulty, there were still some predicted strains far away from the actual target strains (pair ANI &lt; 0.99). The predicted coverage result demonstrated the effectiveness and accuracy of cgMSI for abundance estimation (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C).</p>
    </sec>
    <sec id="Sec6">
      <title>cgMSI identifies strains in synthetic human gut metagenomic sequencing data</title>
      <p id="Par21">cgMSI determines whether the target pathogen species is present in the sample by the maximum number of matched core genes among all strains in the first MAP stage, as described in the Methods section. The results showed that cgMSI had a high specificity of 95% for the detection of <italic>Klebsiella pneumoniae</italic> on simulated gut metagenomic samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). This indicates that it is more feasible to map sample reads to core gene alleles than to large reference genomes for pathogen identification. The sensitivity of cgMSI was much higher than that of ORI, and both algorithms are strongly influenced by the sequencing coverage of the pathogen strains in the samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). On the most challenging samples (coverage of 0.1×), cgMSI had a sensitivity of 77%, which was much higher than the result of ORI (28%). At coverage of 1×, the sensitivity of cgMSI reached 98%, which was close to saturation. For all simulated samples, the pair ANI values of predicted strains and actual strains from cgMSI were greater than 0.999 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C). Among these samples, we randomly selected ten of them to perform Salmonella detection using cgMSI. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2 shows that the maximum number of mapped loci in all samples is significantly below the threshold. Furthermore, there is no significant variation in the maximum number of mapped loci for detecting <italic>Salmonella enterica</italic> as the level of spiked-in <italic>Klebsiella pneumoniae</italic> increased.<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance of pathogen identification using synthetic human gut genome datasets. <bold>A</bold> Maximum number of loci mapped in all strains. If the number of loci is less than β times the total core locus number of the target species (2358 for <italic>K. pneumoniae</italic>), the sample is considered to be free of the target pathogen. Here, β uses the default value of 0.08. <bold>B</bold> Identification results of cgMSI and ORI from 300 simulated gut metagenomic positive samples at different coverage ranging from 0.1×, 1× and 10×. <bold>C</bold> The box plots show the pair ANI values of the actual target strain and the predicted strain corresponding to the samples in (<bold>B</bold>)</p></caption><graphic xlink:href="12859_2023_5512_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>cgMSI identifies strains in mock microbial community data</title>
      <p id="Par22">For all species, cgMSI performed well at 0.5×, 1× and 5× coverage ratios. The sensitivity of pathogen strain identification increased with increasing coverage (Table <xref rid="Tab1" ref-type="table">1</xref>). For all samples at coverage 0.5×, 1× and 5×, the average pair ANI of the actual strain and the predicted strain were higher than 0.999. Among the 6 species, cgMSI performed best on <italic>P. aeruginosa</italic> and identified target strains correctly for all samples.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance evaluation using down-sampled ZymoBIOMICS-EVEN dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Species</th><th align="left" colspan="4">Sensitivity</th><th align="left" colspan="4">Average pair ANI of target strain and predicted strain</th></tr><tr><th align="left">0.1×</th><th align="left">0.5×</th><th align="left">1×</th><th align="left">5×</th><th align="left">0.1×</th><th align="left">0.5×</th><th align="left">1×</th><th align="left">5×</th></tr></thead><tbody><tr><td align="left"><italic>E. coli</italic></td><td char="." align="char">0.7</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9986</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>E. faecalis</italic></td><td char="." align="char">0.6</td><td char="." align="char">0.8</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9995</td><td align="left">0.9999</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>L. monocytogen</italic></td><td char="." align="char">0.4</td><td char="." align="char">0.7</td><td char="." align="char">0.8</td><td char="." align="char">1.0</td><td align="left">0.9976</td><td align="left">0.9999</td><td align="left">0.9999</td><td align="left">1</td></tr><tr><td align="left"><italic>P. aeruginosa</italic></td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">1</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>S. aureus</italic></td><td char="." align="char">0.9</td><td char="." align="char">0.9</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9992</td><td align="left">0.9992</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>S. enterica</italic></td><td char="." align="char">0.8</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9984</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec8">
      <title>cgMSI reduces strain level pathogen detection time</title>
      <p id="Par23">We evaluated the computational performance of cgMSI, ORI, minimap2 and MetaMaps using four different simulated nanopore metagenomic samples of 1 Mb, 10 Mb, 100 Mb and 1000 Mb. For fairness, all tools used the same reference genomes. minimap2 outputs all secondary alignments by control parameter (–N 1000). For MetaMaps, we only counted the CPU time of the “map” stage due to the execution error of the “classify” stage.</p>
      <p id="Par24">Results show that cgMSI outperformed ORI, minimap2 and MetaMaps for all sample sizes range from 1 to 1000 Mb (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). MetaMaps took much longer CPU time than the other tools at each size level. When the sample size was 1000 Mb, the CPU time required for cgMSI was 1/2, 1/6 and 1/39 of ORI, minimap2 and MetaMaps, respectively. The fast detection speed mainly comes from the cgMSI strategy of using core genome to identify candidate strains. For the sample sizes of 1 M and 10 M, cgMSI, ORI and minimap2 run with similar time. With the increase of the sample size, the run time increment is much smaller for cgMSI compared to that of ORI, minimap2 and MeteMaps.<fig id="Fig6"><label>Fig. 6</label><caption><p>Runtime of different tools at different sample sizes. Runtime performance was evaluated on the simulated metagenomic datasets at different sample sizes with the same abundance of target strain spike-in. Note that the run time of cgMSI consists of three parts, namely, identifying candidate strains, MC sampling, and final result calling. Among them, the process of identifying candidate strains takes the most time. For ORI, we first mapped the samples to reference database using minimap2 to preliminarily filter the reads of the target species, and input these reads to ORI. Minimap2 outputs all secondary alignments by control parameter (–N 1000). For MetaMaps, we only counted the CPU time of the “map” stage due to the execution error of the “classify” stage</p></caption><graphic xlink:href="12859_2023_5512_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par25">We further compared the peak memory used by the four tools (Table <xref rid="Tab2" ref-type="table">2</xref>). cgMSI used the least peak memory for all sample sizes. The peak memory used by minimap2 (–N 1000) increased rapidly with sample size. In contrast, the peak memory used by MetaMaps did not change much file.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Peak memory consumption for four tools at different samples sizes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Tool</th><th align="left" colspan="4">Peak memory at different sample sizes (GB)</th></tr><tr><th align="left">1 M</th><th align="left">10 M</th><th align="left">100 M</th><th align="left">1000 M</th></tr></thead><tbody><tr><td align="left">cgMSI</td><td char="." align="char">2.14</td><td char="." align="char">3.45</td><td char="." align="char">9.54</td><td char="." align="char">37.14</td></tr><tr><td align="left">minimap2 + ORI</td><td char="." align="char">0.32</td><td char="." align="char">21.23</td><td char="." align="char">25.25</td><td char="." align="char">1.0</td></tr><tr><td align="left">minimap2 (–N 1000)</td><td char="." align="char">24.54</td><td char="." align="char">25.76</td><td char="." align="char">40.43</td><td char="." align="char">123.91</td></tr><tr><td align="left">MetaMaps</td><td char="." align="char">34.37</td><td char="." align="char">34.38</td><td char="." align="char">36.37</td><td char="." align="char">39.87</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par26">We presented cgMSI, an efficient method to identify low abundance strains in nanopore sequenced metagenomic data. cgMSI mitigate the problem of high sequencing error rate of nanopore data by formulate the strain identification as a MAP estimation problem to take full advantage of the information contained in a sample. Furthermore, cgMSI relies on the core genome of a species to filter the candidate genomes and the raw reads containing the core gene before performing full alignment to reduce the computational load of mapping-based strain-typing on nanopore read data. The performance of cgMSI was demonstrated on both synthetic and real datasets. cgMSI software can be used for strain identification withexisting cgMLST scheme, or customized cgMLST scheme generated using software tools such as SeqSphere + (<ext-link ext-link-type="uri" xlink:href="https://www.ridom.de/seqsphere/">https://www.ridom.de/seqsphere/</ext-link>). Based on its good strain identification performance and fast processing speed, cgMSI can be used to provide valuable reference information in a clinic setting for detecting and managing outbreaks, monitoring pathogen populations, informing treatment decisions, and guiding public health policies, etc. The source code of cgMSI is publicly available and can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/ZHU-XU-xmu/cgMSI">https://github.com/ZHU-XU-xmu/cgMSI</ext-link>.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Reference database preparation</title>
      <p id="Par27">We obtained the list of alleles for all the core genes of seven common pathogens from cgMLST.org Nomenclature Server (<ext-link ext-link-type="uri" xlink:href="https://www.cgmlst.org/ncs">https://www.cgmlst.org/ncs</ext-link>) to create an allele pool of the core genes for each species. The reference genomes for each species were downloaded from the National Center for Biotechnology Information (NCBI) RefSeq [<xref ref-type="bibr" rid="CR27">27</xref>] (retrieved in December 2021). All genomes are fully sequenced assemblies. More details of the data are given in Table <xref rid="Tab3" ref-type="table">3</xref>.<table-wrap id="Tab3"><label>Table 3</label><caption><p>The statistical information of the reference core genes and related genomes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Species name</th><th align="left">No. of core genes</th><th align="left">Ratio of core genes in the genome<sup>a</sup></th><th align="left">No. of genomes<sup>b</sup></th></tr></thead><tbody><tr><td align="left"><italic>K. pneumoniae</italic></td><td char="." align="char">2358</td><td char="." align="char">0.42</td><td char="." align="char">930</td></tr><tr><td align="left"><italic>E. coli</italic></td><td char="." align="char">2513</td><td char="." align="char">0.48</td><td char="." align="char">1858</td></tr><tr><td align="left"><italic>E. faecalis</italic></td><td char="." align="char">1972</td><td char="." align="char">0.47</td><td char="." align="char">68</td></tr><tr><td align="left"><italic>L. monocytogenes</italic></td><td char="." align="char">1701</td><td char="." align="char">0.52</td><td char="." align="char">262</td></tr><tr><td align="left"><italic>P. aeruginosa</italic></td><td char="." align="char">3867</td><td char="." align="char">0.54</td><td char="." align="char">345</td></tr><tr><td align="left"><italic>S. aureus</italic></td><td char="." align="char">1861</td><td char="." align="char">0.62</td><td char="." align="char">671</td></tr><tr><td align="left"><italic>S. enterica</italic></td><td char="." align="char">3002</td><td char="." align="char">0.59</td><td char="." align="char">1021</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Plasmid size is not considered when calculating the proportion of core genes in the genome</p><p><sup>b</sup>We downloaded all the complete genomes of a species from NCBI RefSeq as reference for cgMSI</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec12">
      <title>Select candidate strains by the first-stage MAP estimation</title>
      <p id="Par28">We mapped the allele pool of target species to raw reads of the sample under test using minimap2, and identified a set of reads (r) that can be successfully mapped. Then, the MAP probability of strain <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq6.gif"/></alternatives></inline-formula> is calculated as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {\mathop {argmax}\limits_{{S_{i} }} P\left( {S_{i} {|}r} \right) \propto \mathop {argmax}\limits_{{S_{i} }} \mathop \prod \limits_{{r_{j} }} P\left( {r_{j} {|}S_{i} } \right)P\left( {S_{i} } \right)} \\ \end{array}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par29">For read <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M16"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq7.gif"/></alternatives></inline-formula>, we can calculate the probability that it originates from strain <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i }$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq8.gif"/></alternatives></inline-formula> as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {P\left( {r_{j} {|}S_{i} } \right) = \mathop \prod \limits_{k = 1}^{K} P\left( {r_{j} {|}a_{ik} } \right).} \\ \end{array}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par30">Here <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {r_{j} {|}a_{ik} } \right)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq9.gif"/></alternatives></inline-formula> is the probability that read <italic>j</italic> originates from allele <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{ik}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq10.gif"/></alternatives></inline-formula>, calculated as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} { P\left( {r_{j} {|}a_{ik} } \right) = C_{{\left| {r_{j} } \right|}}^{{NM_{jik} }} e^{{NM_{jik} }} \left( {1 - e} \right)^{{\left| {r_{j} } \right| - NM_{jik} }} } \\ \end{array}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$NM_{jik}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq11.gif"/></alternatives></inline-formula> is the editing distance (NM score) of read <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M30"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq12.gif"/></alternatives></inline-formula> to allele <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{ik}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq13.gif"/></alternatives></inline-formula>, <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {r_{j} } \right|$$\end{document}</tex-math><mml:math id="M34"><mml:mfenced close="|" open="|"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq14.gif"/></alternatives></inline-formula> represents the length of read <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{j}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}</tex-math><mml:math id="M38"><mml:mi>e</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq16.gif"/></alternatives></inline-formula> denotes the sequencing error rate. Here, we selected the top <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M40"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq17.gif"/></alternatives></inline-formula> strains (default 10) with the maximum probability as candidate strains for further identification. During the first-stage MAP, the number of core loci matching the sample is counted for each strain. If the maximum number of core loci matched across all strains is less than β times the total number of core loci of the target species, the sample is considered to be free of the target pathogen. Here, β is a modifiable parameter and its default value is set to 0.08.</p>
    </sec>
    <sec id="Sec13">
      <title>Identify the target strain by the second-stage MAP estimation</title>
      <p id="Par31">Since the length of a nanopore read is typically much longer than the length of a core gene, we mapped the high-quality aligned reads from the previous stage to the complete genomes of the candidate strains using minimap2 to fully utilize the information contained in the reads. The second-stage MAP probability of candidate strains is calculated by<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {\mathop {argmax}\limits_{{C_{i} }} P\left( {C_{i} {|}r} \right) \propto \mathop {argmax}\limits_{{C_{i} }} \mathop \prod \limits_{{r_{j} }} P\left( {r_{j} {|}C_{i} } \right)P\left( {C_{i} } \right). } \\ \end{array}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par32">Here <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {r_{j} {|}C_{i} } \right)$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq18.gif"/></alternatives></inline-formula> is the probability of read <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M46"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq19.gif"/></alternatives></inline-formula> mapped to candidate strain <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{i}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq20.gif"/></alternatives></inline-formula>, which can be estimated by [<xref ref-type="bibr" rid="CR21">21</xref>]<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {P\left( {r_{j} {|}C_{i} } \right) = \frac{{\exp \left( {MapScore_{ij} } \right)}}{{\mathop \sum \nolimits_{i}^{m} \exp \left( {MapScore_{ij} } \right)}} ,} \\ \end{array}$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MapScore_{ij}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq21.gif"/></alternatives></inline-formula> is the alignment score (AS) given by minimap2 and <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M54"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq22.gif"/></alternatives></inline-formula> is the number of strains that read <inline-formula id="IEq23"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{j}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq23.gif"/></alternatives></inline-formula> can be mapped to. <inline-formula id="IEq24"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {C_{i} } \right)$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq24.gif"/></alternatives></inline-formula> is estimated using the posteriori probability of <inline-formula id="IEq25"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{i}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq25.gif"/></alternatives></inline-formula> obtained from the previous stage, i.e.,<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {P\left( {C_{i} } \right) = P\left( {S_{i} {|}r} \right). } \\ \end{array}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par33">The strain with the maximum probability is then identified as the target strain.</p>
    </sec>
    <sec id="Sec14">
      <title>Coverage estimated by MC</title>
      <p id="Par34">The coverage of the target strain in the sample is calculated as<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {Coverage = \frac{avgLength*N}{{p*L}}} \\ \end{array}$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$avgLength$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi mathvariant="italic">avgLength</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq26.gif"/></alternatives></inline-formula> denotes the average length of the sample reads and <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M68"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq27.gif"/></alternatives></inline-formula> denotes the genome length. The number of selected reads that mapped to the candidate strains is denoted as <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M70"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq28.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M72"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq29.gif"/></alternatives></inline-formula> is the probability of a read containing a complete core gene. We estimate <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M74"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq30.gif"/></alternatives></inline-formula> using the Monte Carlo method. In each trial, a simulated read is generated at a random position with a length randomly sampled from length of the raw reads. Let <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M76"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq31.gif"/></alternatives></inline-formula> be the total number of Monte Carlo trials and <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M78"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq32.gif"/></alternatives></inline-formula> be the number of trials where the simulated read covers a complete gene, <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M80"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq33.gif"/></alternatives></inline-formula> is then estimated by<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {p = \frac{C}{M}.} \\ \end{array}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>C</mml:mi><mml:mi>M</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec15">
      <title>Data preprocessing</title>
      <p id="Par35">Before the experiments, we performed a quality control on the samples. In this stage, we removed the reads with a length less than 2000 bp or a quality less than 7 using NanoFilt (version 2.6.0). Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 shows the results of the quality control, plotted using NanoPlot (version 1.24.0) [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5512_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1:</bold> contains a supplementary table on software information used in performance evaluation, and supplementary figures on quality control results for simulated samples, and the results of <italic>Salmonella enterica</italic> detection using cgMSI.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5512_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold> provides details of all pathogen reference genomes used in this study.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Xu Zhu, Lili Zhao and Lihong Huang contribute equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LZ, LH, LW, RY discussed and designed the study. LW and RY supervised the study. XZ and LZ implemented and conducted experiments. WY and LH verified the analysis results. XZ, WY, and RY wrote the manuscript. All the authors discussed and commented on the manuscript. All the authors have read and approved the study.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Publicly available datasets were analyzed in this study, which can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/LomanLab/mockcommunity#data-availability">https://github.com/LomanLab/mockcommunity#data-availability</ext-link>. Source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZHU-XU-xmu/cgMSI">https://github.com/ZHU-XU-xmu/cgMSI</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par36">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par37">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par38">RY and WY are shareholders of Aginome Scientific. The authors have no further financial or nonfinancial competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>CY</given-names>
          </name>
        </person-group>
        <article-title>Clinical metagenomic next-generation sequencing for pathogen detection</article-title>
        <source>Annu Rev Pathol Mech Dis</source>
        <year>2019</year>
        <volume>14</volume>
        <fpage>319</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-pathmechdis-012418-012751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid pathogen detection by metagenomic next-generation sequencing of infected body fluids</article-title>
        <source>Nat Med</source>
        <year>2021</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>115</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-1105-z</pub-id>
        <?supplied-pmid 33169017?>
        <pub-id pub-id-type="pmid">33169017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charalampous</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore metagenomics enables rapid clinical diagnosis of bacterial lower respiratory infection</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>783</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0156-5</pub-id>
        <?supplied-pmid 31235920?>
        <pub-id pub-id-type="pmid">31235920</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Rossum</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ferretti</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Maistrenko</surname>
            <given-names>OM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity within species: interpreting strains in microbiomes</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2020</year>
        <volume>18</volume>
        <issue>9</issue>
        <fpage>491</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-020-0368-1</pub-id>
        <?supplied-pmid 32499497?>
        <pub-id pub-id-type="pmid">32499497</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Saadat</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BHap: a novel approach for bacterial haplotype reconstruction</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>22</issue>
        <fpage>4624</fpage>
        <lpage>4631</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz280</pub-id>
        <?supplied-pmid 31004480?>
        <pub-id pub-id-type="pmid">31004480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raguideau</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STRONG: metagenomics strain resolution on assembly graphs</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>1</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02419-7</pub-id>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olm</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Crits-Christoph</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bouma-Gregson</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>inStrain profiles population microdiversity from metagenomic data and sensitively detects shared microbial strains</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>6</issue>
        <fpage>727</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-00797-0</pub-id>
        <?supplied-pmid 33462508?>
        <pub-id pub-id-type="pmid">33462508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel data structure to support ultra-fast taxonomic classification of metagenomic sequences with k-mer signatures</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>171</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx432</pub-id>
        <?supplied-pmid 29036588?>
        <pub-id pub-id-type="pmid">29036588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Dijk</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Straub</surname>
            <given-names>TJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>StrainGE: a toolkit to track and characterize low-abundance strains in complex microbial communities</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02630-0</pub-id>
        <?supplied-pmid 35255937?>
        <pub-id pub-id-type="pmid">35255937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Improved metagenomic analysis with Kraken 2</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1891-0</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward accurate diagnosis and surveillance of bacterial infections using enhanced strain-level metagenomic next-generation sequencing of infected body fluids</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>bbac004</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbac004</pub-id>
        <?supplied-pmid 35108376?>
        <pub-id pub-id-type="pmid">35108376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Snipe: highly sensitive pathogen detection from metagenomic sequencing data</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>5</issue>
        <fpage>bbab064</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab064</pub-id>
        <?supplied-pmid 33822895?>
        <pub-id pub-id-type="pmid">33822895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1721</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210641.116</pub-id>
        <?supplied-pmid 27852649?>
        <pub-id pub-id-type="pmid">27852649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mwaigwisya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Crossman</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of bacterial pathogens and antimicrobial resistance directly from clinical urines by nanopore-based metagenomic sequencing</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2016</year>
        <volume>72</volume>
        <issue>1</issue>
        <fpage>104</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dkw397</pub-id>
        <?supplied-pmid 27667325?>
        <pub-id pub-id-type="pmid">27667325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kafetzopoulou</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Pullan</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Lemey</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic sequencing at the epicenter of the Nigeria 2018 Lassa fever outbreak</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>363</volume>
        <issue>6422</issue>
        <fpage>74</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aau9343</pub-id>
        <?supplied-pmid 30606844?>
        <pub-id pub-id-type="pmid">30606844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Duraffour</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time, portable genome sequencing for Ebola surveillance</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>530</volume>
        <issue>7589</issue>
        <fpage>228</fpage>
        <lpage>232</lpage>
        <pub-id pub-id-type="doi">10.1038/nature16996</pub-id>
        <?supplied-pmid 26840485?>
        <pub-id pub-id-type="pmid">26840485</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Clinical metagenomics</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>6</issue>
        <fpage>341</fpage>
        <lpage>355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0113-7</pub-id>
        <?supplied-pmid 30918369?>
        <pub-id pub-id-type="pmid">30918369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siekaniec</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lemane</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of isolated or mixed strains from long reads: a challenge met on Streptococcus thermophilus using a MinION sequencer</article-title>
        <source>Microb Genom</source>
        <year>2021</year>
        <volume>7</volume>
        <issue>11</issue>
        <fpage>000654</fpage>
        <?supplied-pmid 34812718?>
        <pub-id pub-id-type="pmid">34812718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strain-level metagenomic assignment and compositional estimation for long reads with MetaMaps</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>3066</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10934-2</pub-id>
        <?supplied-pmid 31296857?>
        <pub-id pub-id-type="pmid">31296857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Manimaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PathoScope 2.0: a complete computational framework for strain identification in environmental or clinical sequencing samples</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-33</pub-id>
        <pub-id pub-id-type="pmid">24468033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Thielen</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bracken: estimating species abundance in metagenomics data</article-title>
        <source>PeerJ Comput Sci</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>e104</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>417</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>
        <?supplied-pmid 28263959?>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clausen</surname>
            <given-names>PTLC</given-names>
          </name>
          <name>
            <surname>Aarestrup</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Rapid and precise alignment of raw reads against redundant databases with KMA</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2336-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
          <name>
            <surname>Van Rensburg</surname>
            <given-names>MJJ</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MLST revisited: the gene-by-gene approach to bacterial genomics</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2013</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>728</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro3093</pub-id>
        <?supplied-pmid 23979428?>
        <pub-id pub-id-type="pmid">23979428</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucl Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>D1</issue>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <?supplied-pmid 26553804?>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NanoSim: nanopore sequence read simulator based on statistical characterization</article-title>
        <source>GigaScience</source>
        <year>2017</year>
        <volume>6</volume>
        <issue>4</issue>
        <fpage>gix010</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/gix010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goris</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Konstantinidis</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Klappenbach</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA–DNA hybridization values and their relationship to whole-genome sequence similarities</article-title>
        <source>Int J Syst Evol Microbiol</source>
        <year>2007</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>81</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1099/ijs.0.64483-0</pub-id>
        <?supplied-pmid 17220447?>
        <pub-id pub-id-type="pmid">17220447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosselló-Móra</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Shifting the genomic gold standard for the prokaryotic species definition</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>45</issue>
        <fpage>19126</fpage>
        <lpage>19131</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0906412106</pub-id>
        <?supplied-pmid 19855009?>
        <pub-id pub-id-type="pmid">19855009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rodriguez-R</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>5114</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07641-9</pub-id>
        <?supplied-pmid 30504855?>
        <pub-id pub-id-type="pmid">30504855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leviatan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shoer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rothschild</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An expanded reference map of the human gut microbiome reveals hundreds of previously unknown species</article-title>
        <source>Nat Commun</source>
        <year>2022</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>3863</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-31502-1</pub-id>
        <?supplied-pmid 35790781?>
        <pub-id pub-id-type="pmid">35790781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholls</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultra-deep, long-read nanopore sequencing of mock microbial community standards</article-title>
        <source>Gigascience</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>5</issue>
        <fpage>giz043</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giz043</pub-id>
        <?supplied-pmid 31089679?>
        <pub-id pub-id-type="pmid">31089679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Coster</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>D’hert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>DT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NanoPack: visualizing and processing long-read sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>15</issue>
        <fpage>2666</fpage>
        <lpage>2669</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty149</pub-id>
        <?supplied-pmid 29547981?>
        <pub-id pub-id-type="pmid">29547981</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10568937</article-id>
    <article-id pub-id-type="pmid">37821827</article-id>
    <article-id pub-id-type="publisher-id">5512</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05512-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>cgMSI: pathogen detection within species from nanopore metagenomic sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhu</surname>
          <given-names>Xu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhao</surname>
          <given-names>Lili</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Huang</surname>
          <given-names>Lihong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Wenxian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Liansheng</given-names>
        </name>
        <address>
          <email>lswang@xmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Rongshan</given-names>
        </name>
        <address>
          <email>rsyu@xmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00mcjh785</institution-id><institution-id institution-id-type="GRID">grid.12955.3a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7233</institution-id><institution>School of Informatics, </institution><institution>Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00mcjh785</institution-id><institution-id institution-id-type="GRID">grid.12955.3a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7233</institution-id><institution>Women and Children’s Hospital, School of Medicine, </institution><institution>Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0006swh35</institution-id><institution-id institution-id-type="GRID">grid.412625.6</institution-id><institution>Computer Management Center, </institution><institution>The First Affiliated Hospital of Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
      <aff id="Aff4"><label>4</label>Aginome Scientific, Xiamen, Fujian China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00mcjh785</institution-id><institution-id institution-id-type="GRID">grid.12955.3a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7233</institution-id><institution>National Institute for Data Science in Health and Medicine, Informatics, </institution><institution>Xiamen University, </institution></institution-wrap>Xiamen, Fujian China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>387</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Metagenomic sequencing is an unbiased approach that can potentially detect all the known and unidentified strains in pathogen detection. Recently, nanopore sequencing has been emerging as a highly potential tool for rapid pathogen detection due to its fast turnaround time. However, identifying pathogen within species is nontrivial for nanopore sequencing data due to the high sequencing error rate.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed the core gene alleles metagenome strain identification (cgMSI) tool, which uses a two-stage maximum a posteriori probability estimation method to detect pathogens at strain level from nanopore metagenomic sequencing data at low computational cost. The cgMSI tool can accurately identify strains and estimate relative abundance at 1× coverage.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We developed cgMSI for nanopore metagenomic pathogen detection within species. cgMSI is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZHU-XU-xmu/cgMSI">https://github.com/ZHU-XU-xmu/cgMSI</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05512-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pathogen detection</kwd>
      <kwd>Strain identification</kwd>
      <kwd>Nanopore sequencing</kwd>
      <kwd>Metagenomic data</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Infectious disease is one of the leading causes of death worldwide. In many cases, timely and accurate identification of the exact types of pathogenic microbes is a prerequisite for effective clinical treatment. Traditional clinical pathogen detection relies on culture-based techniques, which are time-consuming and do not meet the need for rapid diagnosis. For this reason, more attention has been paid to the direct detection of pathogens from metagenomic samples recently [<xref ref-type="bibr" rid="CR1">1</xref>]. Rapid metagenomic testing has been recognized as a promising tool for the diagnosis of unknown infections from body fluids [<xref ref-type="bibr" rid="CR2">2</xref>]. Recent work showed that it is possible to detect bacterial of lower respiratory infection with high sensitivity on metagenomic samples in 6 h from sample to result based on nanopore sequencing [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par5">Genomes of different strains within species are highly similar [<xref ref-type="bibr" rid="CR4">4</xref>], but subtle differences in genes may manifest as important phenotypic differences relevant to human health. For example, <italic>Escherichia coli strain O57: H7</italic> is pathogenic, whereas <italic>Escherichia coli Nissle</italic> strain is probiotic. Many tools have been developed to identify the precise strain information from metagenomic data, which include three main categories. Assembly-based methods, e.g., BHap [<xref ref-type="bibr" rid="CR5">5</xref>], STRONG [<xref ref-type="bibr" rid="CR6">6</xref>] and inStrain [<xref ref-type="bibr" rid="CR7">7</xref>], can identify new isolates but require a high sequencing depth to ensure the assembly accuracy and are not suitable for low abundance cases. K-mer-based methods, including MetaOthello [<xref ref-type="bibr" rid="CR8">8</xref>], strainGE [<xref ref-type="bibr" rid="CR9">9</xref>], Kraken [<xref ref-type="bibr" rid="CR10">10</xref>] and Kraken2 [<xref ref-type="bibr" rid="CR11">11</xref>], pre-compute an index of k-mers for each reference genome to classify sequence reads for efficient searching. Mapping-based methods, including MIST [<xref ref-type="bibr" rid="CR12">12</xref>], snipe [<xref ref-type="bibr" rid="CR13">13</xref>] and Centrifuge [<xref ref-type="bibr" rid="CR14">14</xref>], identify specific strains by mapping the reads against an established reference genomic database and evaluate the alignment results.</p>
    <p id="Par6">Next generation sequencing (NGS) typically requires a run time of more than 16 h for most metagenomic studies. In contrast, nanopore sequencing (MinION sequencer by Oxford Nanopore Technologies) can detect microbes within minutes after sequencing starts and has a turnaround time of less than 6 h [<xref ref-type="bibr" rid="CR15">15</xref>]. Therefore, nanopore sequencing has been considered as a highly potential tool for genomic surveillance of emerging viruses [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Several tools have been used to analyze nanopore sequencing data, including ORI [<xref ref-type="bibr" rid="CR19">19</xref>], Centrifuge, MetaMaps [<xref ref-type="bibr" rid="CR20">20</xref>] and Kraken2. ORI identifies strains from whole genome sequencing (WGS) samples. It only requires a small sequencing depth and achieves good results on samples containing multiple strains. Centrifuge is a rapid and memory-efficient metagenomic reads classifier. It splices different parts of multiple genomes of the same species or genus to form a large genome to alleviate the alignment bias. Unfortunately, it is not able to perform strain level identification. MetaMaps is a reads classifier that identifies strains by mapping the reads to all the reference genomes and analyzing the mapping scores. Kraken2 is a k-mer based method that is not specifically designed for strain level classification. The classification results of Kraken2 rely on the NCBI classification tree. However, most of the genomes do not have independent taxonomy identifiers. Therefore, Kraken2 does not provide satisfactory results at strain level.</p>
    <p id="Par7">A critical step in mapping-based approaches is the alignment of the reads to an established reference genome database. A read may align to multiple reference genomes with a same alignment score due to the high similarity and duplications between strains. In such cases, mapping algorithms may randomly select one as the best result and the rest as secondary alignments [<xref ref-type="bibr" rid="CR21">21</xref>], which, may lead to incorrect statistical results. This problem is more challenging for nanopore sequencing data due to their high sequencing error rates. To overcome this issue, Bracken [<xref ref-type="bibr" rid="CR22">22</xref>] counts only the unique reads information of the alignment to improve the accuracy of species-level abundance estimation. Salmon [<xref ref-type="bibr" rid="CR23">23</xref>] uses the expectation maximization (EM) algorithm to estimate the sequencing level of homologous templates from mappings generated by traditional mappers. KMA [<xref ref-type="bibr" rid="CR24">24</xref>] is specifically designed for this type of multi-mapping situation. KMA uses k-mer to speed-up mapping and the Needleman–Wunsch algorithm to accurately align extensions from k-mer. Multi-mapping reads are resolved using a novel sorting scheme to ensure an accurate assignment. As metagenomic sequences of different strains from the same species are highly similar, sequencing errors could reduce the accuracy of low abundance pathogen detection from metagenomic samples. To the best of our knowledge, currently there is no tool available to accurately identify strains from nanopore metagenomic data with low sequencing depths, e.g., less than 5× coverage. In addition, mapping nanopore reads is challenging under limited computational resources due to their long read length. For example, MetaMaps requires a long processing time, e.g., over 10 h for 74,000 reads. For these reasons, clinical applications of nanopore sequencing in pathogen detection are still limited.</p>
    <p id="Par8">To overcome these limitations, we developed cgMSI that formulates strain identification as a maximum a posteriori (MAP) estimation problem to take both sequencing errors and genome similarity between different strains into consideration for accurate strain-typing at low abundance. To reduce the computational load, cgMSI adopted a two-stage approach. In the first stage, cgMSI uses the core genome, which is the set of gene alleles shared by all strains of a given species of prokaryotes [<xref ref-type="bibr" rid="CR25">25</xref>], as a substitute for the whole genomes to quickly identify candidate genomes. The full alignment on the whole genomes is only performed on the selected candidate genome in the second stage for the final strain calling result. We evaluated the performance of cgMSI on synthetic <italic>Klebsiella pneumoniae</italic> datasets and a real sequencing dataset. The results showed that cgMSI can perform accurate strain typing and abundance estimation even at 1× coverage.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Overview of cgMSI and evaluation datasets</title>
      <p id="Par9">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the workflow of cgMSI. cgMSI identifies the target strain by a two-stage MAP estimation method. Firstly, the input nanopore raw reads are mapped to a pool of core gene alleles from the target species to calculate the probability that a read originates from different strains per locus. The aligned reads are selected, and candidate strains are identified using the first-stage MAP estimation. Then, cgMSI maps the selected reads against the reference genomes of the candidate strains and obtains the final calling result in the second-stage MAP estimation. We used minimap2 [<xref ref-type="bibr" rid="CR26">26</xref>] as the default aligner in both stages. Finally, the abundance of the target strain is estimated using the Monte Carlo (MC) sampling method.<fig id="Fig1"><label>Fig. 1</label><caption><p>The cgMSI workflow for strain identification on nanopore metagenomic data using two-stage MAP estimation. cgMSI starts by mapping the core gene alleles of the target species to raw reads (using reads as reference) and selects candidate strains using MAP probability estimation. After that, cgMSI maps the aligned reads to the full reference genomes of the candidate strains and identifies the target strain using the second-stage MAP probability estimation. The Monte Carlo method is used to estimate the proportion of the target strain reads containing a complete allele of a core gene, which is further used to estimate the coverage of the target strain</p></caption><graphic xlink:href="12859_2023_5512_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par10">We evaluated cgMSI on both simulated and real nanopore metagenomic datasets. We first generated simulated samples with different levels of interference to pathogen detection. We randomly selected 100 strains from the 930 <italic>Klebsiella pneumoniae</italic> strains (available online at the National Center for Biotechnology Information (NCBI) RefSeq [<xref ref-type="bibr" rid="CR27">27</xref>]) as target strains for synthetic mNGS datasets. For each target strain, simulated reads were generated at different coverage levels (0.1×, 0.5×, 1× and 5×) using NanoSim (version 3.0) [<xref ref-type="bibr" rid="CR28">28</xref>] with sequencer error profile metagenome_ERR3152366_Log.tar.gz (simulating Flowcell chemistry R9.4) provided by NanoSim and genome mode (-min 1000 -k 6 -b guppy). The simulated reads from target strains were then mixed respectively with simulated reads from four background strains selected from different species under <italic>Klebsiella</italic> at different ratios (1:1 or 1:5) to create the testing samples (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Illustration of the generation of simulated samples with different levels of interference. Each sample contains a random <italic>Klebsiella pneumonia</italic> genome as the target strain and a decoy strain genome. A total of four decoy strains were selected from the <italic>Klebsiella</italic> genus. The pair ANI of the target strain and the background strain was divided into two levels: 85% and 95%. The coverage ratio of the target strain and the decoy strain was divided as 1:1 and 1:5. A total of 3200 samples were generated</p></caption><graphic xlink:href="12859_2023_5512_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par11">To simulate mNGS samples of different difficulty levels, we analyzed the genomic similarity of different species under the genus <italic>Klebsiella</italic> and selected four species (KA: <italic>Klebsiella aerogenes</italic>, KM: <italic>Klebsiella michiganensis</italic>, KQ: <italic>Klebsiella quasipneumoniae</italic>, KV: <italic>Klebsiella variicola</italic>) of different Average Nucleotide Identity (ANI) [<xref ref-type="bibr" rid="CR29">29</xref>] scores ranging from 85 to 95% to the <italic>K. pneumoniae</italic> strains in the database as our background strains. Note that a cut-off ANI score of &gt; 95% between a given pair of genomes is usually considered that they belong to the same species [<xref ref-type="bibr" rid="CR30">30</xref>]. All ANI values in this paper were obtained using the FastANI tool (version 1.33) [<xref ref-type="bibr" rid="CR31">31</xref>]. In addition, to evaluate the computational performance of cgMSI, we generated four simulated mNGS samples with different sizes range from 1 to 1000 MB. For each sample, we added one <italic>Klebsiella pneumoniae</italic> strain as the target strain and one <italic>Klebsiella quasipneumoniae</italic> strain as the background strain with the same target strain abundance (20%) for different sample sizes. Here, abundance is defined as the ratio of the number of reads from the target strain to the total number of reads.</p>
      <p id="Par12">To evaluate the performance of cgMSI on complex metagenomic samples, we downloaded 100 nanopore sequencing datasets (NCBI Project ID: PRJNA820119) sequenced from healthy human gut metagenomic samples, and generated simulated samples based on this data. Firstly, we mapped the obtained samples to the high-quality human gut microbiome reference set WIS [<xref ref-type="bibr" rid="CR32">32</xref>], and removed all reads that mapped to <italic>Klebsiella pneumoniae,</italic> since the human gut was an important reservoir of <italic>Klebsiella pneumoniae</italic>. After filtering, we obtained 100 negative samples. To obtain positive samples, we spiked simulated <italic>Klebsiella pneumoniae</italic> reads into these negative samples. From the available 930 reference genomes of <italic>Klebsiella pneumoniae</italic>, we randomly selected one strain (RefSeq Assembly Accession: GCA_000240185.1) as the target strain. The simulated reads were generated using NanoSim software (version 3.0) with the same settings as described above. To simulate pathogen strains at different sequencing depths, we spiked each negative sample with simulated reads at 0.1×, 1×, and 10×, and obtained a total of 300 simulated positive samples.</p>
      <p id="Par13">For the real dataset, we used the ZymoBIOMICS dataset [<xref ref-type="bibr" rid="CR33">33</xref>], which contains 8 bacteria and 2 yeasts with equal abundance and was generated on a GridION using the R9.4.1 chemistry for evaluation. Experiments were performed separately on 6 bacterial species with core genes available. For each of the 6 species, we constructed the pool of core gene alleles and reference genome databases, and the corresponding read data were downsampled to simulate coverage levels of 0.1×, 0.5×, 1× and 5× according to the given sequencing depths for each strain. Additional file <xref rid="MOESM2" ref-type="media">2</xref> provides more pathogens information used in simulated dataset.</p>
    </sec>
    <sec id="Sec4">
      <title>Sensitivity of the filtering operation of cgMSI</title>
      <p id="Par15">The first stage of the MAP estimation in cgMSI identifies the candidate strains using core gene alleles. In this filtering operation, we selected the top <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M2"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq1.gif"/></alternatives></inline-formula> strains with the maximum probability as candidate strains. Here, we evaluated the filtering performance with the number of candidate strains <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M4"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq2.gif"/></alternatives></inline-formula> ranging from 5 to 40 on samples with different difficulty levels separately.</p>
      <p id="Par16">Overall, cgMSI correctly identified candidate strains in its first-stage filtering operation in simulated datasets when <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M6"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq3.gif"/></alternatives></inline-formula> was 10 and above (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We noticed that the sensitivity of cgMSI is almost saturated when we identified 40 strains as candidate strains. For each <italic>K</italic> value, the sensitivity was also affected by the coverage, the ratio of the target strain to the background strain (hereafter referred to as the target-to-background ratio), and the difficulty level of the samples as measured by the genomic similarity between the target and the background strains (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>The sensitivity of cgMSI to identify candidate strains using synthetic mNGS datasets. cgMSI identified candidate strains at different coverage ratios ranging from 0.1× to 5×, four different background strains (KA: <italic>Klebsiella aerogenes</italic>, KM: <italic>Klebsiella michiganensis</italic>, KQ: <italic>Klebsiella quasipneumoniae</italic>, KV: <italic>Klebsiella variicola</italic>) and two ratios of target strain to background strain (1:1 and 1:5). Top 5 to Top 40 indicate different numbers of candidate strains identified by cgMSI in the filtration operation. Error bar indicates 95% CI. When the set of candidate strains contains the target strain in a sample, we consider the filtrating operation as correct</p></caption><graphic xlink:href="12859_2023_5512_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par17">For <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M8"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq4.gif"/></alternatives></inline-formula> greater than or equal to 10, cgMSI correctly identified all candidate strains in KA and KM samples when the target-to-background ratio was 1:1 and the coverage ratio was 1× and above. For more challenging samples (KQ, KV), cgMSI achieved a sensitivity greater than 95% when <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K \ge 10$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq5.gif"/></alternatives></inline-formula>, the target-to-background ratio was 1:1 and the coverage ratio was 1× and above. When the target-to-background ratio was 1:5, cgMSI achieved similar sensitivity performances at 1× and 5× coverage levels, and slightly lower sensitivities at lower coverage levels. However, in the worst case cgMSI still achieved a sensitivity greater than 80% for KQ at 0.1× coverage when identifying 10 or more candidate strains.</p>
    </sec>
    <sec id="Sec5">
      <title>cgMSI identifies strains in synthetic mNGS datasets with interference</title>
      <p id="Par18">We evaluated the strain-level pathogen detection performance using simulated dataset with different levels of interference. For comparison, we used minimap2 + ORI as a benchmark which provided strain-level results in a reasonable timeframe. More specifically, for each sample, we mapped the simulated reads to all <italic>K. pneumoniae</italic> genomes in the reference database by minimap2 to preliminarily filter the reads of the target species, and input these reads to ORI. When ORI outputs multiple predicted strains with corresponding probabilities, we selected the strain with the highest probability as its calling result. We also tried to include MetaMaps in our benchmark test but were not successful due to its slow computational speed at the “map” stage and execution errors at the “classify” stage. In the filtering operation stage, we identified 10 candidate strains which was the default value in cgMSI. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 provides more information on the software used in the performance comparison experiments.</p>
      <p id="Par19">Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the results of cgMSI and ORI for strain-level pathogen detection in synthetic mNGS datasets. Similar to the results for candidate strains identification, it can be seen that the strain typing sensitivity was also affected by the coverage, the target-to-background ratio, and the difficulty levels of the samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). Particularly, cgMSI achieved a sensitivity greater than 90% at 1× and 5× coverage when the target-to-background ratio was 1:1. In contrast, the strain typing result showed 40% sensitivity improvement over ORI for all test cases.<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance evaluation of pathogen identification using synthetic decoy mNGS datasets. <bold>A</bold> Identification results of cgMSI and ORI from 3200 simulated samples at different coverage ratios ranging from 0.1× to 5×, different background strains and two target-to-background ratios. Error bar indicates 95% CI. <bold>B</bold> The box plots show the pair ANI values of the actual target strain and the predicted strain corresponding to the samples in (<bold>A</bold>). The pair ANI value is used to further assess the accuracy of the prediction. A higher ANI value indicates a more accurate prediction. <bold>C</bold> Coverage estimated by cgMSI at four different coverage levels. Each dot represents a single sample. Colors represent different target strain coverage ratios in the samples</p></caption><graphic xlink:href="12859_2023_5512_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par20">For samples whose target strains were not accurately detected, we used the pair ANI value between the actual target strain and the predicted strain to further estimate the typing accuracy. A higher ANI value indicates more accurate strain identification. Note that all samples where target strains were not correctly detected were also typed as strains that were extremely close to the actual strains (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). cgMSI identified all samples with ANI values greater than 0.997. At coverage of 5×, cgMSI achieved an ANI value greater than 0.999. Although the pair ANI value from ORI improved with decreasing task difficulty, there were still some predicted strains far away from the actual target strains (pair ANI &lt; 0.99). The predicted coverage result demonstrated the effectiveness and accuracy of cgMSI for abundance estimation (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C).</p>
    </sec>
    <sec id="Sec6">
      <title>cgMSI identifies strains in synthetic human gut metagenomic sequencing data</title>
      <p id="Par21">cgMSI determines whether the target pathogen species is present in the sample by the maximum number of matched core genes among all strains in the first MAP stage, as described in the Methods section. The results showed that cgMSI had a high specificity of 95% for the detection of <italic>Klebsiella pneumoniae</italic> on simulated gut metagenomic samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). This indicates that it is more feasible to map sample reads to core gene alleles than to large reference genomes for pathogen identification. The sensitivity of cgMSI was much higher than that of ORI, and both algorithms are strongly influenced by the sequencing coverage of the pathogen strains in the samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). On the most challenging samples (coverage of 0.1×), cgMSI had a sensitivity of 77%, which was much higher than the result of ORI (28%). At coverage of 1×, the sensitivity of cgMSI reached 98%, which was close to saturation. For all simulated samples, the pair ANI values of predicted strains and actual strains from cgMSI were greater than 0.999 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C). Among these samples, we randomly selected ten of them to perform Salmonella detection using cgMSI. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2 shows that the maximum number of mapped loci in all samples is significantly below the threshold. Furthermore, there is no significant variation in the maximum number of mapped loci for detecting <italic>Salmonella enterica</italic> as the level of spiked-in <italic>Klebsiella pneumoniae</italic> increased.<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance of pathogen identification using synthetic human gut genome datasets. <bold>A</bold> Maximum number of loci mapped in all strains. If the number of loci is less than β times the total core locus number of the target species (2358 for <italic>K. pneumoniae</italic>), the sample is considered to be free of the target pathogen. Here, β uses the default value of 0.08. <bold>B</bold> Identification results of cgMSI and ORI from 300 simulated gut metagenomic positive samples at different coverage ranging from 0.1×, 1× and 10×. <bold>C</bold> The box plots show the pair ANI values of the actual target strain and the predicted strain corresponding to the samples in (<bold>B</bold>)</p></caption><graphic xlink:href="12859_2023_5512_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>cgMSI identifies strains in mock microbial community data</title>
      <p id="Par22">For all species, cgMSI performed well at 0.5×, 1× and 5× coverage ratios. The sensitivity of pathogen strain identification increased with increasing coverage (Table <xref rid="Tab1" ref-type="table">1</xref>). For all samples at coverage 0.5×, 1× and 5×, the average pair ANI of the actual strain and the predicted strain were higher than 0.999. Among the 6 species, cgMSI performed best on <italic>P. aeruginosa</italic> and identified target strains correctly for all samples.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance evaluation using down-sampled ZymoBIOMICS-EVEN dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Species</th><th align="left" colspan="4">Sensitivity</th><th align="left" colspan="4">Average pair ANI of target strain and predicted strain</th></tr><tr><th align="left">0.1×</th><th align="left">0.5×</th><th align="left">1×</th><th align="left">5×</th><th align="left">0.1×</th><th align="left">0.5×</th><th align="left">1×</th><th align="left">5×</th></tr></thead><tbody><tr><td align="left"><italic>E. coli</italic></td><td char="." align="char">0.7</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9986</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>E. faecalis</italic></td><td char="." align="char">0.6</td><td char="." align="char">0.8</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9995</td><td align="left">0.9999</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>L. monocytogen</italic></td><td char="." align="char">0.4</td><td char="." align="char">0.7</td><td char="." align="char">0.8</td><td char="." align="char">1.0</td><td align="left">0.9976</td><td align="left">0.9999</td><td align="left">0.9999</td><td align="left">1</td></tr><tr><td align="left"><italic>P. aeruginosa</italic></td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">1</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>S. aureus</italic></td><td char="." align="char">0.9</td><td char="." align="char">0.9</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9992</td><td align="left">0.9992</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>S. enterica</italic></td><td char="." align="char">0.8</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td char="." align="char">1.0</td><td align="left">0.9984</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec8">
      <title>cgMSI reduces strain level pathogen detection time</title>
      <p id="Par23">We evaluated the computational performance of cgMSI, ORI, minimap2 and MetaMaps using four different simulated nanopore metagenomic samples of 1 Mb, 10 Mb, 100 Mb and 1000 Mb. For fairness, all tools used the same reference genomes. minimap2 outputs all secondary alignments by control parameter (–N 1000). For MetaMaps, we only counted the CPU time of the “map” stage due to the execution error of the “classify” stage.</p>
      <p id="Par24">Results show that cgMSI outperformed ORI, minimap2 and MetaMaps for all sample sizes range from 1 to 1000 Mb (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). MetaMaps took much longer CPU time than the other tools at each size level. When the sample size was 1000 Mb, the CPU time required for cgMSI was 1/2, 1/6 and 1/39 of ORI, minimap2 and MetaMaps, respectively. The fast detection speed mainly comes from the cgMSI strategy of using core genome to identify candidate strains. For the sample sizes of 1 M and 10 M, cgMSI, ORI and minimap2 run with similar time. With the increase of the sample size, the run time increment is much smaller for cgMSI compared to that of ORI, minimap2 and MeteMaps.<fig id="Fig6"><label>Fig. 6</label><caption><p>Runtime of different tools at different sample sizes. Runtime performance was evaluated on the simulated metagenomic datasets at different sample sizes with the same abundance of target strain spike-in. Note that the run time of cgMSI consists of three parts, namely, identifying candidate strains, MC sampling, and final result calling. Among them, the process of identifying candidate strains takes the most time. For ORI, we first mapped the samples to reference database using minimap2 to preliminarily filter the reads of the target species, and input these reads to ORI. Minimap2 outputs all secondary alignments by control parameter (–N 1000). For MetaMaps, we only counted the CPU time of the “map” stage due to the execution error of the “classify” stage</p></caption><graphic xlink:href="12859_2023_5512_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par25">We further compared the peak memory used by the four tools (Table <xref rid="Tab2" ref-type="table">2</xref>). cgMSI used the least peak memory for all sample sizes. The peak memory used by minimap2 (–N 1000) increased rapidly with sample size. In contrast, the peak memory used by MetaMaps did not change much file.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Peak memory consumption for four tools at different samples sizes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Tool</th><th align="left" colspan="4">Peak memory at different sample sizes (GB)</th></tr><tr><th align="left">1 M</th><th align="left">10 M</th><th align="left">100 M</th><th align="left">1000 M</th></tr></thead><tbody><tr><td align="left">cgMSI</td><td char="." align="char">2.14</td><td char="." align="char">3.45</td><td char="." align="char">9.54</td><td char="." align="char">37.14</td></tr><tr><td align="left">minimap2 + ORI</td><td char="." align="char">0.32</td><td char="." align="char">21.23</td><td char="." align="char">25.25</td><td char="." align="char">1.0</td></tr><tr><td align="left">minimap2 (–N 1000)</td><td char="." align="char">24.54</td><td char="." align="char">25.76</td><td char="." align="char">40.43</td><td char="." align="char">123.91</td></tr><tr><td align="left">MetaMaps</td><td char="." align="char">34.37</td><td char="." align="char">34.38</td><td char="." align="char">36.37</td><td char="." align="char">39.87</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par26">We presented cgMSI, an efficient method to identify low abundance strains in nanopore sequenced metagenomic data. cgMSI mitigate the problem of high sequencing error rate of nanopore data by formulate the strain identification as a MAP estimation problem to take full advantage of the information contained in a sample. Furthermore, cgMSI relies on the core genome of a species to filter the candidate genomes and the raw reads containing the core gene before performing full alignment to reduce the computational load of mapping-based strain-typing on nanopore read data. The performance of cgMSI was demonstrated on both synthetic and real datasets. cgMSI software can be used for strain identification withexisting cgMLST scheme, or customized cgMLST scheme generated using software tools such as SeqSphere + (<ext-link ext-link-type="uri" xlink:href="https://www.ridom.de/seqsphere/">https://www.ridom.de/seqsphere/</ext-link>). Based on its good strain identification performance and fast processing speed, cgMSI can be used to provide valuable reference information in a clinic setting for detecting and managing outbreaks, monitoring pathogen populations, informing treatment decisions, and guiding public health policies, etc. The source code of cgMSI is publicly available and can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/ZHU-XU-xmu/cgMSI">https://github.com/ZHU-XU-xmu/cgMSI</ext-link>.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Reference database preparation</title>
      <p id="Par27">We obtained the list of alleles for all the core genes of seven common pathogens from cgMLST.org Nomenclature Server (<ext-link ext-link-type="uri" xlink:href="https://www.cgmlst.org/ncs">https://www.cgmlst.org/ncs</ext-link>) to create an allele pool of the core genes for each species. The reference genomes for each species were downloaded from the National Center for Biotechnology Information (NCBI) RefSeq [<xref ref-type="bibr" rid="CR27">27</xref>] (retrieved in December 2021). All genomes are fully sequenced assemblies. More details of the data are given in Table <xref rid="Tab3" ref-type="table">3</xref>.<table-wrap id="Tab3"><label>Table 3</label><caption><p>The statistical information of the reference core genes and related genomes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Species name</th><th align="left">No. of core genes</th><th align="left">Ratio of core genes in the genome<sup>a</sup></th><th align="left">No. of genomes<sup>b</sup></th></tr></thead><tbody><tr><td align="left"><italic>K. pneumoniae</italic></td><td char="." align="char">2358</td><td char="." align="char">0.42</td><td char="." align="char">930</td></tr><tr><td align="left"><italic>E. coli</italic></td><td char="." align="char">2513</td><td char="." align="char">0.48</td><td char="." align="char">1858</td></tr><tr><td align="left"><italic>E. faecalis</italic></td><td char="." align="char">1972</td><td char="." align="char">0.47</td><td char="." align="char">68</td></tr><tr><td align="left"><italic>L. monocytogenes</italic></td><td char="." align="char">1701</td><td char="." align="char">0.52</td><td char="." align="char">262</td></tr><tr><td align="left"><italic>P. aeruginosa</italic></td><td char="." align="char">3867</td><td char="." align="char">0.54</td><td char="." align="char">345</td></tr><tr><td align="left"><italic>S. aureus</italic></td><td char="." align="char">1861</td><td char="." align="char">0.62</td><td char="." align="char">671</td></tr><tr><td align="left"><italic>S. enterica</italic></td><td char="." align="char">3002</td><td char="." align="char">0.59</td><td char="." align="char">1021</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Plasmid size is not considered when calculating the proportion of core genes in the genome</p><p><sup>b</sup>We downloaded all the complete genomes of a species from NCBI RefSeq as reference for cgMSI</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec12">
      <title>Select candidate strains by the first-stage MAP estimation</title>
      <p id="Par28">We mapped the allele pool of target species to raw reads of the sample under test using minimap2, and identified a set of reads (r) that can be successfully mapped. Then, the MAP probability of strain <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq6.gif"/></alternatives></inline-formula> is calculated as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {\mathop {argmax}\limits_{{S_{i} }} P\left( {S_{i} {|}r} \right) \propto \mathop {argmax}\limits_{{S_{i} }} \mathop \prod \limits_{{r_{j} }} P\left( {r_{j} {|}S_{i} } \right)P\left( {S_{i} } \right)} \\ \end{array}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par29">For read <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M16"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq7.gif"/></alternatives></inline-formula>, we can calculate the probability that it originates from strain <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i }$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq8.gif"/></alternatives></inline-formula> as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {P\left( {r_{j} {|}S_{i} } \right) = \mathop \prod \limits_{k = 1}^{K} P\left( {r_{j} {|}a_{ik} } \right).} \\ \end{array}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par30">Here <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {r_{j} {|}a_{ik} } \right)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq9.gif"/></alternatives></inline-formula> is the probability that read <italic>j</italic> originates from allele <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{ik}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq10.gif"/></alternatives></inline-formula>, calculated as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} { P\left( {r_{j} {|}a_{ik} } \right) = C_{{\left| {r_{j} } \right|}}^{{NM_{jik} }} e^{{NM_{jik} }} \left( {1 - e} \right)^{{\left| {r_{j} } \right| - NM_{jik} }} } \\ \end{array}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$NM_{jik}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq11.gif"/></alternatives></inline-formula> is the editing distance (NM score) of read <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M30"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq12.gif"/></alternatives></inline-formula> to allele <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{ik}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq13.gif"/></alternatives></inline-formula>, <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {r_{j} } \right|$$\end{document}</tex-math><mml:math id="M34"><mml:mfenced close="|" open="|"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq14.gif"/></alternatives></inline-formula> represents the length of read <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{j}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}</tex-math><mml:math id="M38"><mml:mi>e</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq16.gif"/></alternatives></inline-formula> denotes the sequencing error rate. Here, we selected the top <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M40"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq17.gif"/></alternatives></inline-formula> strains (default 10) with the maximum probability as candidate strains for further identification. During the first-stage MAP, the number of core loci matching the sample is counted for each strain. If the maximum number of core loci matched across all strains is less than β times the total number of core loci of the target species, the sample is considered to be free of the target pathogen. Here, β is a modifiable parameter and its default value is set to 0.08.</p>
    </sec>
    <sec id="Sec13">
      <title>Identify the target strain by the second-stage MAP estimation</title>
      <p id="Par31">Since the length of a nanopore read is typically much longer than the length of a core gene, we mapped the high-quality aligned reads from the previous stage to the complete genomes of the candidate strains using minimap2 to fully utilize the information contained in the reads. The second-stage MAP probability of candidate strains is calculated by<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {\mathop {argmax}\limits_{{C_{i} }} P\left( {C_{i} {|}r} \right) \propto \mathop {argmax}\limits_{{C_{i} }} \mathop \prod \limits_{{r_{j} }} P\left( {r_{j} {|}C_{i} } \right)P\left( {C_{i} } \right). } \\ \end{array}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="italic">argmax</mml:mi></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par32">Here <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {r_{j} {|}C_{i} } \right)$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq18.gif"/></alternatives></inline-formula> is the probability of read <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M46"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq19.gif"/></alternatives></inline-formula> mapped to candidate strain <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{i}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq20.gif"/></alternatives></inline-formula>, which can be estimated by [<xref ref-type="bibr" rid="CR21">21</xref>]<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {P\left( {r_{j} {|}C_{i} } \right) = \frac{{\exp \left( {MapScore_{ij} } \right)}}{{\mathop \sum \nolimits_{i}^{m} \exp \left( {MapScore_{ij} } \right)}} ,} \\ \end{array}$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MapScore_{ij}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq21.gif"/></alternatives></inline-formula> is the alignment score (AS) given by minimap2 and <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M54"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq22.gif"/></alternatives></inline-formula> is the number of strains that read <inline-formula id="IEq23"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{j}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq23.gif"/></alternatives></inline-formula> can be mapped to. <inline-formula id="IEq24"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {C_{i} } \right)$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq24.gif"/></alternatives></inline-formula> is estimated using the posteriori probability of <inline-formula id="IEq25"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{i}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq25.gif"/></alternatives></inline-formula> obtained from the previous stage, i.e.,<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {P\left( {C_{i} } \right) = P\left( {S_{i} {|}r} \right). } \\ \end{array}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par33">The strain with the maximum probability is then identified as the target strain.</p>
    </sec>
    <sec id="Sec14">
      <title>Coverage estimated by MC</title>
      <p id="Par34">The coverage of the target strain in the sample is calculated as<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {Coverage = \frac{avgLength*N}{{p*L}}} \\ \end{array}$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$avgLength$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi mathvariant="italic">avgLength</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq26.gif"/></alternatives></inline-formula> denotes the average length of the sample reads and <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M68"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq27.gif"/></alternatives></inline-formula> denotes the genome length. The number of selected reads that mapped to the candidate strains is denoted as <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M70"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq28.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M72"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq29.gif"/></alternatives></inline-formula> is the probability of a read containing a complete core gene. We estimate <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M74"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq30.gif"/></alternatives></inline-formula> using the Monte Carlo method. In each trial, a simulated read is generated at a random position with a length randomly sampled from length of the raw reads. Let <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M76"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq31.gif"/></alternatives></inline-formula> be the total number of Monte Carlo trials and <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M78"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq32.gif"/></alternatives></inline-formula> be the number of trials where the simulated read covers a complete gene, <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M80"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5512_Article_IEq33.gif"/></alternatives></inline-formula> is then estimated by<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {p = \frac{C}{M}.} \\ \end{array}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>C</mml:mi><mml:mi>M</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5512_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec15">
      <title>Data preprocessing</title>
      <p id="Par35">Before the experiments, we performed a quality control on the samples. In this stage, we removed the reads with a length less than 2000 bp or a quality less than 7 using NanoFilt (version 2.6.0). Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 shows the results of the quality control, plotted using NanoPlot (version 1.24.0) [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5512_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1:</bold> contains a supplementary table on software information used in performance evaluation, and supplementary figures on quality control results for simulated samples, and the results of <italic>Salmonella enterica</italic> detection using cgMSI.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5512_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold> provides details of all pathogen reference genomes used in this study.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Xu Zhu, Lili Zhao and Lihong Huang contribute equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LZ, LH, LW, RY discussed and designed the study. LW and RY supervised the study. XZ and LZ implemented and conducted experiments. WY and LH verified the analysis results. XZ, WY, and RY wrote the manuscript. All the authors discussed and commented on the manuscript. All the authors have read and approved the study.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Publicly available datasets were analyzed in this study, which can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/LomanLab/mockcommunity#data-availability">https://github.com/LomanLab/mockcommunity#data-availability</ext-link>. Source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZHU-XU-xmu/cgMSI">https://github.com/ZHU-XU-xmu/cgMSI</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par36">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par37">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par38">RY and WY are shareholders of Aginome Scientific. The authors have no further financial or nonfinancial competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>CY</given-names>
          </name>
        </person-group>
        <article-title>Clinical metagenomic next-generation sequencing for pathogen detection</article-title>
        <source>Annu Rev Pathol Mech Dis</source>
        <year>2019</year>
        <volume>14</volume>
        <fpage>319</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-pathmechdis-012418-012751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid pathogen detection by metagenomic next-generation sequencing of infected body fluids</article-title>
        <source>Nat Med</source>
        <year>2021</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>115</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-1105-z</pub-id>
        <?supplied-pmid 33169017?>
        <pub-id pub-id-type="pmid">33169017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charalampous</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore metagenomics enables rapid clinical diagnosis of bacterial lower respiratory infection</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>783</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0156-5</pub-id>
        <?supplied-pmid 31235920?>
        <pub-id pub-id-type="pmid">31235920</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Rossum</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ferretti</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Maistrenko</surname>
            <given-names>OM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity within species: interpreting strains in microbiomes</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2020</year>
        <volume>18</volume>
        <issue>9</issue>
        <fpage>491</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-020-0368-1</pub-id>
        <?supplied-pmid 32499497?>
        <pub-id pub-id-type="pmid">32499497</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Saadat</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BHap: a novel approach for bacterial haplotype reconstruction</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>22</issue>
        <fpage>4624</fpage>
        <lpage>4631</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz280</pub-id>
        <?supplied-pmid 31004480?>
        <pub-id pub-id-type="pmid">31004480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raguideau</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STRONG: metagenomics strain resolution on assembly graphs</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>1</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02419-7</pub-id>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olm</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Crits-Christoph</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bouma-Gregson</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>inStrain profiles population microdiversity from metagenomic data and sensitively detects shared microbial strains</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>6</issue>
        <fpage>727</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-00797-0</pub-id>
        <?supplied-pmid 33462508?>
        <pub-id pub-id-type="pmid">33462508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel data structure to support ultra-fast taxonomic classification of metagenomic sequences with k-mer signatures</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>171</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx432</pub-id>
        <?supplied-pmid 29036588?>
        <pub-id pub-id-type="pmid">29036588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Dijk</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Straub</surname>
            <given-names>TJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>StrainGE: a toolkit to track and characterize low-abundance strains in complex microbial communities</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02630-0</pub-id>
        <?supplied-pmid 35255937?>
        <pub-id pub-id-type="pmid">35255937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Improved metagenomic analysis with Kraken 2</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1891-0</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward accurate diagnosis and surveillance of bacterial infections using enhanced strain-level metagenomic next-generation sequencing of infected body fluids</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>bbac004</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbac004</pub-id>
        <?supplied-pmid 35108376?>
        <pub-id pub-id-type="pmid">35108376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Snipe: highly sensitive pathogen detection from metagenomic sequencing data</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>5</issue>
        <fpage>bbab064</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab064</pub-id>
        <?supplied-pmid 33822895?>
        <pub-id pub-id-type="pmid">33822895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1721</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210641.116</pub-id>
        <?supplied-pmid 27852649?>
        <pub-id pub-id-type="pmid">27852649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mwaigwisya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Crossman</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of bacterial pathogens and antimicrobial resistance directly from clinical urines by nanopore-based metagenomic sequencing</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2016</year>
        <volume>72</volume>
        <issue>1</issue>
        <fpage>104</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dkw397</pub-id>
        <?supplied-pmid 27667325?>
        <pub-id pub-id-type="pmid">27667325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kafetzopoulou</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Pullan</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Lemey</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic sequencing at the epicenter of the Nigeria 2018 Lassa fever outbreak</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>363</volume>
        <issue>6422</issue>
        <fpage>74</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aau9343</pub-id>
        <?supplied-pmid 30606844?>
        <pub-id pub-id-type="pmid">30606844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Duraffour</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time, portable genome sequencing for Ebola surveillance</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>530</volume>
        <issue>7589</issue>
        <fpage>228</fpage>
        <lpage>232</lpage>
        <pub-id pub-id-type="doi">10.1038/nature16996</pub-id>
        <?supplied-pmid 26840485?>
        <pub-id pub-id-type="pmid">26840485</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Clinical metagenomics</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>6</issue>
        <fpage>341</fpage>
        <lpage>355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0113-7</pub-id>
        <?supplied-pmid 30918369?>
        <pub-id pub-id-type="pmid">30918369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siekaniec</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lemane</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of isolated or mixed strains from long reads: a challenge met on Streptococcus thermophilus using a MinION sequencer</article-title>
        <source>Microb Genom</source>
        <year>2021</year>
        <volume>7</volume>
        <issue>11</issue>
        <fpage>000654</fpage>
        <?supplied-pmid 34812718?>
        <pub-id pub-id-type="pmid">34812718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strain-level metagenomic assignment and compositional estimation for long reads with MetaMaps</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>3066</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10934-2</pub-id>
        <?supplied-pmid 31296857?>
        <pub-id pub-id-type="pmid">31296857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Manimaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PathoScope 2.0: a complete computational framework for strain identification in environmental or clinical sequencing samples</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-33</pub-id>
        <pub-id pub-id-type="pmid">24468033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Thielen</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bracken: estimating species abundance in metagenomics data</article-title>
        <source>PeerJ Comput Sci</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>e104</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>417</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>
        <?supplied-pmid 28263959?>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clausen</surname>
            <given-names>PTLC</given-names>
          </name>
          <name>
            <surname>Aarestrup</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Rapid and precise alignment of raw reads against redundant databases with KMA</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2336-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
          <name>
            <surname>Van Rensburg</surname>
            <given-names>MJJ</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MLST revisited: the gene-by-gene approach to bacterial genomics</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2013</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>728</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro3093</pub-id>
        <?supplied-pmid 23979428?>
        <pub-id pub-id-type="pmid">23979428</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucl Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>D1</issue>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <?supplied-pmid 26553804?>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NanoSim: nanopore sequence read simulator based on statistical characterization</article-title>
        <source>GigaScience</source>
        <year>2017</year>
        <volume>6</volume>
        <issue>4</issue>
        <fpage>gix010</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/gix010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goris</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Konstantinidis</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Klappenbach</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA–DNA hybridization values and their relationship to whole-genome sequence similarities</article-title>
        <source>Int J Syst Evol Microbiol</source>
        <year>2007</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>81</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1099/ijs.0.64483-0</pub-id>
        <?supplied-pmid 17220447?>
        <pub-id pub-id-type="pmid">17220447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosselló-Móra</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Shifting the genomic gold standard for the prokaryotic species definition</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>45</issue>
        <fpage>19126</fpage>
        <lpage>19131</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0906412106</pub-id>
        <?supplied-pmid 19855009?>
        <pub-id pub-id-type="pmid">19855009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rodriguez-R</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>5114</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07641-9</pub-id>
        <?supplied-pmid 30504855?>
        <pub-id pub-id-type="pmid">30504855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leviatan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shoer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rothschild</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An expanded reference map of the human gut microbiome reveals hundreds of previously unknown species</article-title>
        <source>Nat Commun</source>
        <year>2022</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>3863</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-31502-1</pub-id>
        <?supplied-pmid 35790781?>
        <pub-id pub-id-type="pmid">35790781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholls</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultra-deep, long-read nanopore sequencing of mock microbial community standards</article-title>
        <source>Gigascience</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>5</issue>
        <fpage>giz043</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giz043</pub-id>
        <?supplied-pmid 31089679?>
        <pub-id pub-id-type="pmid">31089679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Coster</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>D’hert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>DT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NanoPack: visualizing and processing long-read sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>15</issue>
        <fpage>2666</fpage>
        <lpage>2669</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty149</pub-id>
        <?supplied-pmid 29547981?>
        <pub-id pub-id-type="pmid">29547981</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
