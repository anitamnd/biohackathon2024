<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat Commun?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 1045?>
<?submitter-authority publisher?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group (obsolete)?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101528555</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">37539</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5036525</article-id>
    <article-id pub-id-type="pmid">25358478</article-id>
    <article-id pub-id-type="doi">10.1038/ncomms6277</article-id>
    <article-id pub-id-type="manuscript">nihpa629163</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Universal database search tool for proteomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Sangtae</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pevzner</surname>
          <given-names>Pavel A.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Computer Science and Engineering, University of California San Diego, La Jolla 92093, USA</aff>
    <author-notes>
      <corresp id="FN1">Corresponding author: Pavel A. Pevzner, EBU3b 4236 9500 Gilman Drive La Jolla, CA 92093, <email>ppevzner@eng.ucsd.edu</email></corresp>
      <fn id="FN2">
        <p><bold>Addresses:</bold> Sangtae Kim, 3335 Innovation Blvd, Richland, WA 99354</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>25</day>
      <month>8</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>9</month>
      <year>2016</year>
    </pub-date>
    <volume>5</volume>
    <fpage>5277</fpage>
    <lpage>5277</lpage>
    <!--elocation-id from pubmed: 10.1038/ncomms6277-->
    <permissions>
      <license xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Mass spectrometry (MS) instruments and experimental protocols are rapidly advancing, but the software tools to analyze tandem mass spectra are lagging behind. We present a database search tool MS-GF+ that is sensitive (it identifies more peptides than most other database search tools) and universal (it works well for diverse types of spectra, different configurations of MS instruments and different experimental protocols). We benchmark MS-GF+ using diverse spectral datasets: (i) spectra of varying fragmentation methods; (ii) spectra of multiple enzyme digests; (iii) spectra of phosphorylated peptides; (iv) spectra of peptides with unusual fragmentation propensities produced by a novel alpha-lytic protease. For all these datasets, MS-GF+ significantly increases the number of identified peptides compared to commonly used methods for peptide identifications. We emphasize that while MS-GF+ is not specifically designed for any particular experimental set-up, it improves upon the performance of tools specifically designed for these applications (e.g., specialized tools for phosphoproteomics).</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>Introduction</title>
    <p id="P2">Mass spectrometry (MS) instruments and experimental protocols have greatly advanced over the last decade. New fragmentation technologies have emerged and high-precision mass spectrometers like Orbitrap have become widely available. While trypsin remains a dominant protease in proteomics studies, digesting proteins with diverse proteases is becoming popular [<xref rid="R1" ref-type="bibr">1</xref>]. Empowered by these changes, MS researchers now have diverse choices with respect to the questions: “what fragmentation method to use?”, “how accurate should be the measurements of the mass-to-charge (m/z) ratios?”, “what proteases to use?”, and “what post-translational modification (PTM) to focus on (e.g. phosphorylation)?”. Depending on these choices, the resulting tandem mass (MS/MS) spectra vary in fragmentation propensities and precision. Therefore, unlike in the past when low-precision Collision Induced Dissociation (CID) spectra of tryptic peptides dominated the field, spectral datasets generated today are very diverse. Unfortunately, the popular MS/MS database search tools such as SEQUEST [<xref rid="R2" ref-type="bibr">2</xref>] and Mascot [<xref rid="R3" ref-type="bibr">3</xref>] have not kept pace with the increased diversity of the data. While several new MS/MS database search engines were recently developed including Andromeda [<xref rid="R4" ref-type="bibr">4</xref>], Morpheus [<xref rid="R5" ref-type="bibr">5</xref>], and MS Amanda [<xref rid="R6" ref-type="bibr">6</xref>]), they have resulted in only minor improvements as compared to SEQUEST and Mascot.</p>
    <p id="P3">Many efforts have been invested into making existing MS/MS search tools compatible with new types of data. For example, several pre- or post-processing strategies have been proposed [<xref rid="R7" ref-type="bibr">7</xref>, <xref rid="R8" ref-type="bibr">8</xref>], resulting in small improvement in the performance of database search tools. To further boost the performance, MS/MS database search tools are combined with statistical modeling tools like PeptideProphet [<xref rid="R9" ref-type="bibr">9</xref>], Percolator [<xref rid="R10" ref-type="bibr">10</xref>], and IDPicker [<xref rid="R11" ref-type="bibr">11</xref>]. These tools do not find new Peptide-Spectrum Matches (PSMs), but rather re-score PSMs reported by a database search tool using more complex scoring and output high-scoring PSMs. While they often improve the performance of a database search tool, their performance is negatively affected when the database search tool fails to find correct PSMs [<xref rid="R12" ref-type="bibr">12</xref>]. Another downside of the pre- or post-processing strategies and statistical modeling tools is that, since they are often not integrated into database search tools, using them complicates the analysis of MS/MS spectra. Moreover, since different laboratories employ different combinations of tools (see <xref rid="F1" ref-type="fig">Figure 1</xref>), even for the same data, capabilities of analyzing the data vary widely and results obtained in one laboratory are often difficult to reproduce in another laboratory [<xref rid="R13" ref-type="bibr">13</xref>].</p>
    <p id="P4">In a recent review, Noble and MacCoss pointed out that “the field (of MS) is still missing a generic analysis platform that can be adapted automatically and in a principled fashion to handle spectra produced by any given fragmentation protocol” [<xref rid="R14" ref-type="bibr">14</xref>]. Our MS-GF+ is a step towards achieving this goal, representing a <italic>universal</italic> database search tool that performs well for diverse types of spectral datasets. MS-GF+ works well (i.e., identifies more peptides than other MS/MS tools that we tested) for spectra generated using diverse configurations of MS instruments and experimental protocols. But the main contribution of the paper is not the increase in the number of identifications for dozens of various fragmentation methods and experimental protocols but rather the fact that it represents the first truly universal MS/MS database search tool. We emphasize that MS-GF+ is not customized for specific spectral datasets but rather uses a robust probabilistic model that works well across all datasets.</p>
    <p id="P5">MS-GF+ is universal because it automatically derives scoring parameters from thousand PSMs without prior knowledge of the type of the spectra [<xref rid="R12" ref-type="bibr">12</xref>]. We represent various types of spectra as a graph where paths represent <italic>spectral types</italic> (<xref rid="F1" ref-type="fig">Figure 1</xref>). For each spectral type, MS-GF+ learns scoring parameters separately and scores a PSM using a different set of scoring parameters depending on the spectral type. MS-GF+ can train scoring parameters for any spectral type (including spectral types not specified in <xref rid="F1" ref-type="fig">Figure 1</xref>) or use pre-trained scoring parameters. It takes over the authority to train scoring parameters to the users and makes the training easy.</p>
    <p id="P6">The key advantage of MS-GF+ over existing approaches is its ability to compute rigorous E-values (using the generating function approach [<xref rid="R15" ref-type="bibr">15</xref>]) and thus to boost the number of peptide identifications. While the generating function approach from [<xref rid="R15" ref-type="bibr">15</xref>] worked well in a variety of studies [<xref rid="R16" ref-type="bibr">16</xref>, <xref rid="R17" ref-type="bibr">17</xref>, <xref rid="R18" ref-type="bibr">18</xref>, <xref rid="R19" ref-type="bibr">19</xref>], the question of applying it to modified peptides and to high-precision MS/MS spectra remains open. In this paper, we address these issues, thus making the generating function approach applicable to all types of spectra.</p>
    <p id="P7">We demonstrate the performance of MS-GF+ using various previously studied datasets [<xref rid="R1" ref-type="bibr">1</xref>, <xref rid="R20" ref-type="bibr">20</xref>, <xref rid="R21" ref-type="bibr">21</xref>, <xref rid="R22" ref-type="bibr">22</xref>, <xref rid="R23" ref-type="bibr">23</xref>]: spectra of tryptic peptides generated using CID, Higher-energy Collisional Dissociation (HCD) and Electron Transfer Dissociation (ETD) in combination with either linear ion trap or Orbitrap readout; spectra of multiple enzyme digests; spectra of phosphopeptides; and spectra or a novel protease alpha-lytic protease (<italic>α</italic>LP). For all these datasets, we show that MS-GF+ outperforms popular tools for peptide identification such as Mascot+Percolator.</p>
  </sec>
  <sec sec-type="results" id="S2">
    <title>Results</title>
    <sec id="S3">
      <title>MS-GF+ scoring</title>
      <p id="P8">Database search tools use a scoring function Score(<italic>P, S</italic>) to evaluate a PSM of a peptide <italic>P</italic> and a spectrum <italic>S</italic>, and further compute statistical significance of the resulting PSMs. In this paper, we use E-values to evaluate statistical significance of individual PSMs (referred as spectral E-values) and the target-decoy approach to estimate FDRs. See Gupta et al., 2011 [<xref rid="R24" ref-type="bibr">24</xref>] for the details of our probabilistic framework.</p>
      <p id="P9">Let <italic>P<sub>S</sub></italic> be a peptide that generated <italic>S</italic>. A scoring function is <italic>adequate</italic> for <italic>S</italic> (with respect to a protein database <italic>ProteinDB</italic>) if the correct peptide attains the maximal score in the database, i.e., max<italic><sub>P∈ProteinDB</sub></italic> Score(<italic>P, S</italic>) = Score(<italic>P<sub>S</sub>, S</italic>). A “good” scoring function should satisfy the following three conditions. First, it should be adequate for the great majority of spectra. Second, the algorithm for PSM scoring should be fast. Third, the algorithm for computing statistical significance (e.g. E-values) of PSMs should be fast and accurate.</p>
      <p id="P10">MS-GF+ uses a very simple dot-product scoring <italic>Score</italic>(<italic>P, S</italic>) = <italic>P* · S*</italic> after converting peptide <italic>P</italic> and spectrum <italic>S</italic> into <italic>peptide vector P*</italic> and <italic>spectral vector S*</italic> (the spectral vector was called the prefix-residue-mass spectrum in the previous publications [<xref rid="R12" ref-type="bibr">12</xref>, <xref rid="R25" ref-type="bibr">25</xref>]). Conversion of a spectrum <italic>S</italic> into a spectral vector <italic>S*</italic> uses a probabilistic model that ensures that the resulting dot-product scoring is adequate [<xref rid="R26" ref-type="bibr">26</xref>] (first condition). At the same time, it makes scoring and computing accurate E-values fast [<xref rid="R15" ref-type="bibr">15</xref>] (second and third condition). This simple “dot-product” scoring model contrasts with many other database search [<xref rid="R2" ref-type="bibr">2</xref>, <xref rid="R4" ref-type="bibr">4</xref>, <xref rid="R27" ref-type="bibr">27</xref>, <xref rid="R28" ref-type="bibr">28</xref>] and re-scoring [<xref rid="R9" ref-type="bibr">9</xref>, <xref rid="R10" ref-type="bibr">10</xref>] tools, using sophisticated scoring functions that often make it difficult to satisfy the third condition.</p>
    </sec>
    <sec id="S4">
      <title>MS-GF+ workflow</title>
      <p id="P11">MS-GF+ takes a spectral dataset <italic>Spectra</italic> and a protein database <italic>ProteinDB</italic> as an input and outputs a set of scored PSMs along with E-value estimates. It uses open source application programming interfaces jmzML [<xref rid="R29" ref-type="bibr">29</xref>], jmzReader [<xref rid="R30" ref-type="bibr">30</xref>], and jmzIdentML [<xref rid="R31" ref-type="bibr">31</xref>], and supports the HUPO Proteomics Standard Initiative standard file formats – mzML [<xref rid="R32" ref-type="bibr">32</xref>] and mzIdentML [<xref rid="R33" ref-type="bibr">33</xref>]. Due to these developments, MS-GF+ has been already adopted in many proteomics pipelines and post-processing tools.</p>
      <p id="P12">The workflow of MS-GF+ comprises the following 4 steps: generating spectral vectors, searching a protein database, computing E-values of PSMs, and estimating FDRs. Below, we describe each step as well as how MS-GF+ takes advantage of high precision spectra.</p>
    </sec>
    <sec id="S5">
      <title>Generating spectral vectors</title>
      <p id="P13">A (non-modified) <italic>peptide</italic> is defined as a string over the alphabet 
<inline-formula><mml:math id="M1" display="inline" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> of 20 standard amino acids. Let 
<inline-formula><mml:math id="M2" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula> be an <italic>extended</italic> amino acid set containing both unmodified and modified amino acids. For an (unmodified) amino acid 
<inline-formula><mml:math id="M3" display="inline" overflow="scroll"><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>, let Mod(<italic>a</italic>) 
<inline-formula><mml:math id="M4" display="inline" overflow="scroll"><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula> be the <italic>set</italic> that contains <italic>a</italic> and all its modified amino acids. For example, if <italic>T</italic> (Thr) and <italic>T*</italic> (phosphorylated Thr) are in 
<inline-formula><mml:math id="M5" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>, Mod(<italic>T</italic>) = {<italic>T,T</italic>*}. Given a peptide <italic>P</italic> = <italic>a</italic><sub>1</sub><italic>…a<sub>k</sub></italic>, define <italic>PV</italic> = <italic>pv</italic><sub>1</sub>
<italic>…pv<sub>k</sub></italic> as a <italic>variant</italic> of <italic>P</italic> if <italic>pv<sub>i</sub></italic> ∈ Mod(<italic>a<sub>i</sub></italic>) for all <italic>i</italic> (1 <italic>≤ i ≤ k</italic>).</p>
      <p id="P14">MS-GF+ converts spectra into <italic>spectral vectors</italic> [<xref rid="R12" ref-type="bibr">12</xref>, <xref rid="R25" ref-type="bibr">25</xref>]. A spectral vector of a spectrum <italic>S</italic> is an <italic>M</italic>-dimensional vector with integer values, where <italic>M</italic> = PrecursorMass(<italic>S</italic>) is the nominal precursor mass of <italic>S</italic>. Here, we consider nominal precursor masses representing the sum of nominal masses of amino acids of the peptide generated the spectrum. Since in many cases, the precise nominal precursor mass is unknown (e.g. MS instruments often choose 2nd or 3rd isotope peak instead of mono-isotope peak from MS1 spectrum), multiple spectral vectors are generated separately for each possible nominal precursor mass, and the score of a peptide of mass <italic>M</italic> is computed from the spectral vector of precursor mass <italic>M</italic>.</p>
      <p id="P15">The conversion from an experimental spectrum to a spectral vector proceeds as follows. A <italic>spectrum S</italic> = {(<italic>mz</italic><sub>1</sub><italic>, rank</italic><sub>1</sub>),…, (<italic>mz<sub>l</sub>, rank<sub>l</sub></italic>)} is represented as a set of <italic>ranked</italic> peaks where the <italic>i</italic>th highest intensity peak gets rank <italic>i</italic> (<italic>mz<sub>j</sub></italic> and <italic>rank<sub>j</sub></italic> represent m/z and rank of <italic>j</italic>th peak, respectively). An <italic>ion type</italic> is represented as a triplet of integers <italic>charge, of f set</italic>, and <italic>sign</italic>, where sign represents whether the ion type is a prefix ion (<italic>sign</italic> = 1) or a suffix ion (<italic>sign</italic> = <italic>−</italic>1). For example, singly-charged b-ions and y-ions correspond to ion types (1, 1, 1) and (1, 19, −1), respectively. Neutral losses and hydrogen transfers are also considered as ion types, e.g. singly charged z<italic>·</italic> ions corresponds to (1, 3, −1). Given an ion type <italic>ion</italic> = (<italic>charge, of f set, sign</italic>), one can turn a spectrum <italic>S</italic> into <italic>S<sub>ion</sub></italic> = {(<italic>mass</italic><sub>1</sub><italic>, rs</italic><sub>1</sub>),…, (<italic>mass<sub>l</sub>, rs<sub>l</sub></italic>)} using the following transformation: 
<disp-formula id="FD1"><mml:math id="M6" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mtext mathvariant="italic">mass</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi mathvariant="italic">mz</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mtext mathvariant="italic">charge</mml:mtext><mml:mo>⋅</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>9995</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mspace width="0.2em"/><mml:mo>−</mml:mo><mml:mspace width="0.2em"/><mml:mi mathvariant="italic">of</mml:mi><mml:mspace width="0.2em"/><mml:mi>f</mml:mi><mml:mspace width="0.2em"/><mml:mi mathvariant="italic">set</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mtext>if</mml:mtext></mml:mtd><mml:mtd columnalign="left"><mml:mtext mathvariant="italic">sign</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mtext>PrecursorMass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi mathvariant="italic">mz</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mtext mathvariant="italic">charge</mml:mtext><mml:mo>⋅</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>9995</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="italic">of</mml:mi><mml:mspace width="0.2em"/><mml:mi>f</mml:mi><mml:mspace width="0.2em"/><mml:mi mathvariant="italic">set</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mtext>if</mml:mtext></mml:mtd><mml:mtd columnalign="left"><mml:mtext mathvariant="italic">sign</mml:mtext><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="italic">rs</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>RankScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="italic">ion</mml:mtext><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="italic">rank</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where [<italic>x</italic>] represents the closest integer to <italic>x</italic>, and RankScore(<italic>ion, rank</italic>) is a pre-computed function that takes an ion type <italic>ion</italic> and an integer <italic>rank</italic> and returns a probabilistic log-likelihood score defined in [<xref rid="R12" ref-type="bibr">12</xref>, <xref rid="R26" ref-type="bibr">26</xref>]. Note that 0.9995 is a rescaling constant for minimizing rounding errors (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>). In practice, RankScore(<italic>ion, rank</italic>) also accounts for the location of the observed peak and the precursor charge and mass of the spectrum, which are omitted here for simplification. Ion types contributing to scoring are selected from the training set as described in Kim et al., 2010 [<xref rid="R12" ref-type="bibr">12</xref>] Assume that ℐ is a set of ion types that are selected. The spectral vector of <italic>S</italic> (denoted by <bold>S</bold> = (<italic>s</italic><sub>1</sub><italic>,…, s<sub>M</sub></italic>) is computed as follows: 
<disp-formula id="FD2"><mml:math id="M7" display="block" overflow="scroll"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="italic">ion</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">ℐ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="italic">rs</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="italic">mass</mml:mtext><mml:mo>,</mml:mo><mml:mi mathvariant="italic">rs</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mo>∈</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mi>S</mml:mi><mml:mtext mathvariant="italic">ion</mml:mtext></mml:msub><mml:mspace width="0.2em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.2em"/><mml:mtext mathvariant="italic">mass</mml:mtext><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mspace width="0.2em"/><mml:mo>∪</mml:mo><mml:mspace width="0.2em"/><mml:mtext>RankScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="italic">ion</mml:mtext><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula> where RankScore(<italic>ion, ∞</italic>) represents the score given when <italic>ion</italic> is missing.</p>
      <p id="P16">We also define a peptide vector of a variant as follows. Let Mass(<italic>a</italic>) be the nominal mass of a (possibly modified) amino acid <italic>a</italic>. For example, Mass(<italic>T</italic>) = 101 and the mass of phosphorylated Thr is Mass(<italic>T*</italic>) = 181. Given a variant <italic>PV</italic> = <italic>pv</italic><sub>1</sub>
<italic>… pv<sub>k</sub></italic>, define the mass of <italic>PV</italic> as 
<inline-formula><mml:math id="M8" display="inline" overflow="scroll"><mml:mtext>Mass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="italic">PV</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:mtext>Mass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext mathvariant="italic">pv</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Given a variant <italic>PV</italic> = <italic>pv</italic><sub>1</sub>
<italic>… pv<sub>k</sub></italic> of mass <italic>M</italic>, we define its peptide vector (denoted by <bold>PV</bold>) as a 0–1 vector (<italic>m</italic><sub>1</sub><italic>, …, m<sub>M</sub></italic>) with (<italic>n −</italic> 1) 1s, such that <italic>m<sub>i</sub></italic> = 1 if <italic>i</italic> equals to Mass(<italic>pv</italic><sub>1</sub>) + <italic>…</italic> + <italic>Mass</italic>(<italic>pv<sub>j</sub></italic>) (1 <italic>≤ j ≤ k</italic>).</p>
      <p id="P17">The <italic>MS-GF+ score</italic> of a PSM (<italic>PV, S</italic>) is defined as 
<inline-formula><mml:math id="M9" display="inline" overflow="scroll"><mml:mtext>MSGFScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold">PV</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="italic">pv</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mstyle></mml:math></inline-formula> if Mass(<italic>PV</italic>) = PrecursorMass(<italic>S</italic>) and <italic>−∞</italic> otherwise. The MS-GF+ score represents the log likelihood ratio described in [<xref rid="R26" ref-type="bibr">26</xref>].</p>
    </sec>
    <sec id="S6">
      <title>Searching a protein database</title>
      <p id="P18">We define <italic>ProteinDB</italic><sup>+</sup> as the set of all variants (with respect to an extended amino acid set 
<inline-formula><mml:math id="M10" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>) derived from <italic>ProteinDB</italic>. The goal of MS-GF+ database search is to solve the following problem: Given a spectral dataset <italic>Spectra</italic> and a protein database <italic>ProteinDB</italic>, for each spectrum <italic>S</italic> ∈ <italic>Spectra</italic> find a variant <italic>PV<sub>S,ProteinDB</sub></italic> such that
<disp-formula id="FD3"><mml:math id="M11" display="block" overflow="scroll"><mml:msub><mml:mi mathvariant="italic">PV</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">ProteinDB</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mtext mathvariant="italic">ProteinDB</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mspace width="0.5em"/><mml:mtext>MSGFScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p id="P19">In contrast to a traditional spectrum-based MS/MS database search approach that compares each spectrum against all peptides, MS-GF+ uses an alternative peptide-based approach that computes the suffix array to compare each peptide against all spectra with the same precursor mass. See <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 1</xref> for the details of MS-GF+ approach to the database search.</p>
    </sec>
    <sec id="S7">
      <title>Computing E-values of PSMs</title>
      <p id="P20">The scores of PSMs reported by existing MS/MS database search tools are often poorly correlated with their E-values [<xref rid="R34" ref-type="bibr">34</xref>]. It is important to rank PSMs based on their E-values, because such ranking (rather than ranking based on “raw scores”) often dramatically increases the number of identified spectra under a given FDR [<xref rid="R15" ref-type="bibr">15</xref>, <xref rid="R35" ref-type="bibr">35</xref>]. Many database search tools estimate an E-value of a PSM based on an approximation of a tail of the score distribution specific to the spectrum using <italic>peptides in the database</italic> [<xref rid="R27" ref-type="bibr">27</xref>, <xref rid="R28" ref-type="bibr">28</xref>]. Since this approach is known to result in biased estimates of E-values [<xref rid="R15" ref-type="bibr">15</xref>], MS-GF+ adopted the generating function approach to rigorously compute E-values of PSMs using the score distribution of <italic>all peptides</italic> [<xref rid="R15" ref-type="bibr">15</xref>]. Our scoring model is essential here, because the generating function approach is easily applicable to the scoring functions that can be represented as a dot-product of vectors [<xref rid="R24" ref-type="bibr">24</xref>]. Adopting the generating function approach improves the accuracy of E-value estimates and increases the number of identified peptides as was recently confirmed by an independent work on applying it to the XCorr score in SEQUEST [<xref rid="R35" ref-type="bibr">35</xref>].</p>
      <p id="P21">Given a spectrum <italic>S</italic>, a score threshold <italic>t</italic>, an extended set of amino acids 
<inline-formula><mml:math id="M12" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>, and a database size <italic>N</italic>, we define E-value(<italic>S</italic>, 
<inline-formula><mml:math id="M13" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula><italic>, t, N</italic>) as the expected number of variants <italic>PV</italic> (as defined by 
<inline-formula><mml:math id="M14" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>) with MSGFScore(<italic>PV, S</italic>) <italic>≥ t</italic> in a random protein database of size <italic>N</italic>. To compute E-value(<italic>S</italic>, 
<inline-formula><mml:math id="M15" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula><italic>, t, N</italic>), we first compute <italic>spectral E-value</italic> E-value(<italic>S</italic>, 
<inline-formula><mml:math id="M16" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula><italic>, t</italic>), the expected number of variants <italic>PV</italic> with MSGFScore(<italic>PV, S</italic>) <italic>≥ t</italic> given a <italic>single random peptide</italic>. A single random peptide models a random peptide starting at a fixed position in a random protein database.</p>
      <p id="P22">We consider a set of all possible (unmodified) peptides of length <italic>k</italic> (where <italic>k</italic> is a large number) and select a random peptide uniformly from this set (i.e. the probability of selecting a peptide is 
<inline-formula><mml:math id="M17" display="inline" overflow="scroll"><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mn>20</mml:mn><mml:mi>k</mml:mi></mml:msup></mml:mfrac></mml:math></inline-formula>). In practice, to reflect different frequencies of amino acids in a database (e.g. Leu is usually more common than Trp), we define the probability of a peptide <italic>P</italic> = <italic>a</italic><sub>1</sub>
<italic>… a<sub>k</sub></italic> as 
<inline-formula><mml:math id="M18" display="inline" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, where Prob(a) is the frequency of amino acid <italic>a</italic> in a protein database. Note that this does not change the algorithm to compute the spectral E-values. We say that a peptide <italic>P produces</italic> a variant <italic>PV</italic> if <italic>PV</italic> is a variant of a prefix of <italic>P</italic>. For example, <italic>PEPT<sup>*</sup></italic> and <italic>PEPTI</italic> are produced by <italic>PEPTIDE</italic>. Given a spectrum <italic>S</italic>, let 
<inline-formula><mml:math id="M19" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> be the set of all variants <italic>PV</italic> with MSGFScore(<italic>PV, S</italic>) <italic>≥ t</italic>. For every variant <italic>PV</italic>, there are 20<italic><sup>k−|PV|</sup></italic> peptides of length <italic>k</italic> producing a variant <italic>PV</italic> (|<italic>PV</italic>| stands for the number of amino acids in <italic>PV</italic>). Therefore, expected number of variants per random peptide with a score equal or better than <italic>t</italic> is
<disp-formula id="FD4"><mml:math id="M20" display="block" overflow="scroll"><mml:mtext>E-value</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:msup><mml:mn>20</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mn>20</mml:mn><mml:mi>k</mml:mi></mml:msup></mml:mfrac><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mn>20</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msup></mml:mstyle><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula>Since a variant is a string over the alphabet 
<inline-formula><mml:math id="M21" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>, this expression can be computed using the generating function approach [<xref rid="R15" ref-type="bibr">15</xref>]. Given a spectrum <italic>S</italic> with <bold>S</bold> = <italic>s</italic><sub>1</sub>
<italic>… s<sub>M</sub></italic>, consider a directed acyclic graph called an <italic>amino acid graph G</italic>(<italic>V, E</italic>, 
<inline-formula><mml:math id="M22" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>) with <italic>V</italic> = {0<italic>, …, M</italic>} and <italic>E</italic> = {(<italic>i, j</italic>)|<italic>j − i</italic> ∈ Mass(<italic>a</italic>) for <italic>a</italic> ∈ 
<inline-formula><mml:math id="M23" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>}, where the <italic>score</italic> of a vertex <italic>i</italic> is defined as <italic>s<sub>i</sub></italic>, the <italic>probability</italic> of an edge is defined as 
<inline-formula><mml:math id="M24" display="inline" overflow="scroll"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>20</mml:mn></mml:mfrac></mml:math></inline-formula>, the score of a path is defined as the sum of scores of its vertices, and the <italic>probability</italic> of a path is defined as the product of probabilities of its edges. A path in an amino acid graph represents a variant. Therefore, E-value(<italic>S</italic>, 
<inline-formula><mml:math id="M25" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula><italic>, t</italic>) equals to the sum of probabilities of all paths from 0 to <italic>M</italic> with scores equal or better than <italic>t</italic>, and can be computed using parametric dynamic programming [<xref rid="R15" ref-type="bibr">15</xref>, <xref rid="R26" ref-type="bibr">26</xref>, <xref rid="R36" ref-type="bibr">36</xref>].</p>
      <p id="P23">While spectral E-values are useful for evaluating statistical significance of individual PSMs (independently of the database), they need to be transformed into E-value(<italic>S</italic>, 
<inline-formula><mml:math id="M26" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula><italic>, t, N</italic>) to take into account the fact that the database search represents “multiple testing” where multiple variants (arising from different database peptides) are scored against a spectrum [<xref rid="R37" ref-type="bibr">37</xref>]. E-values can be approximated as follows:
<disp-formula id="FD5"><mml:math id="M27" display="block" overflow="scroll"><mml:mtext>E-value</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mtext>E-value</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mo>·</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>N</italic> is the size of the database. Note that since protein databases contain many repeated peptides, it is important to reflect the <italic>effective</italic> size of the database that is estimated as the number of unique peptides of certain length.</p>
    </sec>
    <sec id="S8">
      <title>Estimating FDRs</title>
      <p id="P24">MS-GF+ estimates FDRs using the target decoy approach [<xref rid="R38" ref-type="bibr">38</xref>, <xref rid="R39" ref-type="bibr">39</xref>]. See <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 2</xref> for details.</p>
    </sec>
    <sec id="S9">
      <title>From low-precision to high-precision MS/MS spectra</title>
      <p id="P25">Mass spectrometers are usually divided into High-precision (denoted by H) and Low-precision (denoted by L) instruments. Depending on whether the precursor and product ions are measured with Low or High-precision, the spectra are divided into LL, LH, HL, and HH spectra (LH spectra are hardly ever used in proteomics studies). While it may appear that extending the generating function approach from LL (as defined in [<xref rid="R15" ref-type="bibr">15</xref>]) to HL and HH spectra is a simple matter of tuning parameters that control the error tolerance, the situation is more complex. Here we explain how MS-GF+ takes advantage of high-precision product ion peaks.</p>
      <p id="P26">Let RMass(<italic>a</italic>) be the real mass of an amino acid <italic>a</italic>. For a variant <italic>PV</italic> = <italic>pv</italic><sub>1</sub>
<italic>… pv<sub>k</sub></italic>, let 
<inline-formula><mml:math id="M28" display="inline" overflow="scroll"><mml:mtext>RMass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mtext>RMass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="italic">pv</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, RMass(<italic>pv<sub>i</sub></italic>), and RPrecursorMass(<italic>S</italic>) be the real precursor mass of a spectrum <italic>S</italic>. We previously assumed that Mass(<italic>PV</italic>) and PrecursorMass(<italic>S</italic>) are integers and defined MSGFScore(<italic>PV, S</italic>) = <bold>PV<italic>·</italic> S</bold> if Mass(<italic>PV</italic>) = PrecursorMass(<italic>S</italic>) and <italic>−∞</italic> otherwise. Note that this condition, while appropriate for LL spectra, is weak for HL and HH spectra, because it may be satisfied even when the real mass RMass(<italic>PV</italic>) significantly deviates (e.g. up to 0.5 Da) from RPrecursorMass(<italic>S</italic>). Let 
<inline-formula><mml:math id="M29" display="inline" overflow="scroll"><mml:mi>a</mml:mi><mml:mover><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:math></inline-formula> represent the condition |<italic>a</italic> − <italic>b</italic>| &lt; Δ. To take advantage of accurate precursor masses in HL and HH spectra, the condition Mass(<italic>PV</italic>) = PrecursorMass(<italic>S</italic>) has to be redefined to 
<inline-formula><mml:math id="M30" display="inline" overflow="scroll"><mml:mtext>RMass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mover><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo></mml:mover><mml:mtext>RPrecursorMass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, where Δ is the precursor mass tolerance. The database search problem with this modified definition of MSGFScore, is now described by the following equation: 
<disp-formula id="FD6"><label>(1)</label><mml:math id="M31" display="block" overflow="scroll"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mtext mathvariant="italic">Spectra</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="italic">Spectra</mml:mtext></mml:mrow></mml:munder><mml:mspace width="0.2em"/><mml:mtext>MSGFScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mtext mathvariant="italic">Spectra</mml:mtext><mml:mrow><mml:mtext>RMass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mtext>MSGFScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>Spectra</italic><sub>RMass(</sub><italic><sub>PV</sub></italic><sub>)</sub> represents the set of spectra <italic>S</italic> ∈ <italic>Spectra</italic> satisfying 
<inline-formula><mml:math id="M32" display="inline" overflow="scroll"><mml:mtext>RPrecursorMass</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="italic">PV</mml:mi><mml:mo>)</mml:mo><mml:mover><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo></mml:mover><mml:mtext>RMass</mml:mtext><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>.</p>
      <p id="P27">The key part of the generating function approach is the assumption that amino acids have integer masses (otherwise the parametric dynamic programming is difficult to implement). However, rounding amino acid masses to integers introduces errors. These rounding errors reduce after rescaling by 0.9995, making them appropriate for LL and HL spectra. However, for HH spectra, the rounding errors remain too large even after rescaling, prohibiting MS-GF+ from benefiting from precise product ion peaks. A larger rescaling constant could better accommodate the mass accuracy, e.g. the rescaling constant 274.335215 allows one to model spectra with 2.5 ppm accuracy [<xref rid="R40" ref-type="bibr">40</xref>]. However, since the time complexity of the generating function algorithm is proportional to the rescaling constant, this rescaling makes computing E-values prohibitively slow.</p>
      <p id="P28">Here we present a new scoring algorithm taking advantage of the accurate product ion masses while not substantially increasing the running time of MS-GF+. In [<xref rid="R26" ref-type="bibr">26</xref>], we introduced an abstract model (seemingly unrelated to mass spectrometry) that described a probabilistic process of transforming a Boolean string (peptide vector) into another Boolean string (spectral vector). This model, while adequate for low-precision spectra, needs to be modified for high-precision spectra. Here we model a peptide as a Boolean string (as before) but model a spectrum as a directed acyclic graph (DAG) and further apply a transformation of a Boolean string into a DAG for scoring real PSMs (see Methods for details).</p>
      <p id="P29">Our new idea behind the DAG modeling is as follows. Consider peaks at masses 100.01 and 157.4 that will be transformed into integer bins 100 and 157 in the Boolean string representation of the spectrum. After this transformation, we lose information about the exact difference between these two masses. However, in our new spectral DAG model, this information is retained in <italic>edges</italic> of the spectral DAG and used in the scoring.</p>
    </sec>
    <sec id="S10">
      <title>Datasets</title>
      <p id="P30">Overall, we used 19 datasets (<italic>≈</italic> 2.83 million spectra from human, yeast, mouse, and <italic>Schizosaccharomyces pombe</italic>) reflecting the diversity of MS data, corresponding to 17 distinct spectral types shown in <xref rid="F1" ref-type="fig">Figure 1</xref> (see Methods for details on the datasets). For all these datasets, we benchmarked MS-GF+ against popular tools for peptide identification such as Mascot+Percolator.</p>
    </sec>
    <sec id="S11">
      <title>Comparison of MS-GF + with Mascot+Percolator</title>
      <p id="P31">We compared the numbers of identified PSMs at 1% FDR for MS-GF+ and Mascot+Percolator (i.e., PSMs reported by Mascot and re-scored by Percolator). Mascot+Percolator (Mascot version 2.3.02 integrating Percolator) was used for the comparison because it represents a popular choice for peptide identification. We also tested several other tools like SEQUEST, InsPecT [<xref rid="R25" ref-type="bibr">25</xref>] and OMSSA but do not report their results because they identified significantly fewer PSMs as compared to Mascot+Percolator. See <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref> for database search parameters.</p>
      <p id="P32">For all the 19 datasets, MS-GF+ identified significantly more PSMs compared to Mascot+Percolator (<xref rid="F2" ref-type="fig">Figure 2</xref>). <xref rid="F3" ref-type="fig">Figure 3</xref> (a) shows the benchmarking results for the five human datasets generated with varying fragmentations and instruments [<xref rid="R20" ref-type="bibr">20</xref>]. Percolator greatly increased the number of identifications as compared to Mascot, but for all these datasets, MS-GF+ identified significantly more PSMs (17–38%) than Mascot+Percolator (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref> for Venn diagrams of MS-GF+ and Mascot+Percolator identifications). We also compared the number of identifications reported by the original study [<xref rid="R20" ref-type="bibr">20</xref>] which also used Mascot+Percolator along with in-house pre- and post-processing tools. In this comparison, MS-GF+ also showed an improved performance (identifying 16–55% more PSMs).</p>
      <p id="P33">To figure out how each tool benefits from high-precision product ion peaks, for the 3 out of 5 human datasets representing HH spectra, we ran MS-GF+, Mascot+Percolator, and Mascot using the parameters for HL spectra, i.e., using 0.6 Da fragment mass tolerance for Mascot and Mascot+Percolator, and using the scoring model for low-precision spectra for MS-GF+. For every tool, the number of identifications was higher when the parameters for HH spectra were used, but the difference varied depending on the dataset (<xref rid="F3" ref-type="fig">Figure 3 (b)</xref>), and was negligible for ETD spectra.</p>
      <p id="P34"><xref rid="F3" ref-type="fig">Figure 3 (c)</xref> shows the comparison for the ten yeast datasets generated with varying fragmentations (CID or ETD) and enzymes (Trypsin, LysC, ArgC, GluC, or AspN) [<xref rid="R1" ref-type="bibr">1</xref>]. Again, for all these datasets, MS-GF+ identified significantly more PSMs (34–168%) than Mascot+Percolator (<xref rid="F3" ref-type="fig">Figure 3</xref> (c)). In [<xref rid="R1" ref-type="bibr">1</xref>], using OMSSA (and in-house tools for pre- and post-processing), the authors reported the number of identified peptides at 1% peptide-level FDR that are matched to proteins identified at 1% protein-level FDR. We compared these numbers with the numbers of identified peptides at 1% peptide-level FDR using MS-GF+ (<xref rid="F3" ref-type="fig">Figure 3 (d)</xref>). Note that this comparison is unfair because peptide identifications by MS-GF+ were not filtered out according to the protein that they are matched to. However, even after considering that, the results show that for most of the datasets, MS-GF+ identified many more peptides than the original report.</p>
      <p id="P35">To see whether our scoring model can capture the fragmentation propensities specific to phosphopeptides, we generated a scoring parameter set for (CID, Low, Phosphorylation, Trypsin). For the mouse dataset corresponding to (CID, Low, Phosphorylation, Trypsin), we compared the numbers of identified PSMs for MS-GF+ with and without using the phosphorylation-specific parameter set, Mascot+Percolator, and InsPecT equipped with a dedicated scoring model for (CID, Low, Phosphorylation, Trypsin) [<xref rid="R41" ref-type="bibr">41</xref>] (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2 (a)</xref>). Interestingly, without phosphorylation-specific scoring parameters, MS-GF+ outperformed both tools, identifying 37% and 44% more PSMs than Mascot+Percolator and InsPecT, respectively. With phosphorylation-specific parameters, MS-GF+ identified 9% more PSMs (and 12% more PSMs of phosphopeptides), confirming that our scoring model successfully captures phosphorylation-specific fragmentation propensities.</p>
      <p id="P36">A similar result was obtained for a (CID, Low, Ubiquitination, Trypsin) dataset (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 3</xref>). We emphasize that MS-GF+ does not “know” anything about the peculiarities of the phosphorylation or ubiquitination, and simply trains the scoring parameters in exactly the same way it does for other spectral types. This ability to easily train modification-specific scoring parameters for any modification will greatly benefit MS researchers studying post-translational modifications.</p>
    </sec>
    <sec id="S12">
      <title>MS-GF+ for identifying peptides produced by a new protease</title>
      <p id="P37"><italic>α</italic>LP is a new protease with cleavage specificities somewhat “orthogonal” to trypsin [<xref rid="R23" ref-type="bibr">23</xref>]. MS-GF+ was applied to the study of <italic>α</italic>LP using two <italic>S. pombe</italic> datasets corresponding to (CID, Low, Standard, <italic>α</italic>LP) and (ETD, Low, Standard, <italic>α</italic>LP). We ran Mascot+Percolator, OMSSA, and MS-GF+ by specifying ‘None’ as an enzyme. Since <italic>α</italic>LP produces peptides with different fragmentation propensities than tryptic peptides, Mascot+Percolator and OMSSA performed very poorly for this novel spectral type. In contrast, MS-GF+ identified 3,535 and 2,829 PSMs from the (CID, Low, Standard, <italic>α</italic>LP) and (ETD, Low, Standard, <italic>α</italic>LP) dataset using the scoring parameters for (CID, Low, Standard, Trypsin) and (ETD, Low, Standard, Trypsin), respectively (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2 (b)</xref>). The superior performance of MS-GF+ over Mascot+Percolator and OMSSA is because its scoring function is adequate for <italic>α</italic>LP peptides (correct peptide attains the maximal score) for a large portion of the spectra even when the search space is large (i.e. no enzyme is specified). In fact, for the human dataset corresponding to (ETD, Low, Standard, Trypsin), when no enzyme was specified and precursor mass tolerance 2.5Da was used, MS-GF+ identified 10,937 PSMs, only 34% less as compared to the fully-tryptic search with 7 ppm precursor mass tolerance.</p>
      <p id="P38">Using the identified PSMs by MS-GF+, we trained scoring parameters for (CID, Low, Standard, <italic>α</italic>LP) and (ETD, Low, Standard, <italic>α</italic>LP). When these <italic>α</italic>LP-specific scoring parameters were used, the number of identified PSMs further increased to 4,788 (+35%) and 3,313 (+17%) for (CID, Low, Standard, <italic>α</italic>LP) and (ETD, Low, Standard, <italic>α</italic>LP), respectively, showing the usefulness of MS-GF+ for studies of new proteases.</p>
      <p id="P39">Thus, <italic>α</italic>LP represents a new alternative to trypsin, greatly increasing the PTM and protein sequence coverages, but generating spectra with unusual fragmentation propensities. We emphasize that the capabilities of <italic>α</italic>LP are not obvious when Mascot+Percolator or another tool is used, because it fails to identify <italic>α</italic>LP peptides. The details on <italic>α</italic>LP protease have been discussed in a separate paper [<xref rid="R23" ref-type="bibr">23</xref>].</p>
    </sec>
    <sec id="S13">
      <title>Running time of MS-GF+</title>
      <p id="P40">We measured the running time of MS-GF+ and Mascot+Percolator for LL, HL, and HH spectra for various spectral types. For all the searches, MS-GF+ and Mascot+Percolator showed similar running times (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2 (c,d)</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S14">
    <title>Discussion</title>
    <p id="P41">Our analysis and recent independent studies [<xref rid="R42" ref-type="bibr">42</xref>, <xref rid="R43" ref-type="bibr">43</xref>, <xref rid="R44" ref-type="bibr">44</xref>, <xref rid="R35" ref-type="bibr">35</xref>] showed that for diverse types of spectral datasets, MS-GF+ identifies more PSMs as compared to existing database search tools like Mascot, X!Tandem, OMSSA, Crux, Comet, and InsPecT, and statistical modeling tools like Percolator. We emphasize that the generating function approach for accurately computing E-values significantly contributes to the improved performance of MS-GF+. For example, when E-values instead of MS-GF scores were used to cut-off the results, the number of identified PSMs increased approximately by 70%, 50%, and 20% for LL, HL, and HH spectra, respectively.</p>
    <p id="P42">While we focused on demonstrating MS-GF+ as a stand-alone tool, we emphasize that MS-GF+ can be combined with various other proteomics analysis tools. Since we have decided to release MS-GF+ in 2012 well before this paper was prepared for a journal submission, MS-GF+ has already been integrated into the following pipelines and statistical modeling tools: Trans-Proteomics Pipeline [<xref rid="R45" ref-type="bibr">45</xref>], Galaxy-P [<xref rid="R46" ref-type="bibr">46</xref>], ProteoSuite [<xref rid="R47" ref-type="bibr">47</xref>], IDPicker [<xref rid="R11" ref-type="bibr">11</xref>], SearchGUI [<xref rid="R48" ref-type="bibr">48</xref>], Scaffold [<xref rid="R48" ref-type="bibr">48</xref>], ProteoSAFe, Skyline [<xref rid="R49" ref-type="bibr">49</xref>], and Percolator [<xref rid="R10" ref-type="bibr">10</xref>, <xref rid="R50" ref-type="bibr">50</xref>]. Peptide identification tools that combine the results of multiple database search tools such as MSblender [<xref rid="R51" ref-type="bibr">51</xref>], Peptide-Shaker [<xref rid="R52" ref-type="bibr">52</xref>], and PepArML [<xref rid="R53" ref-type="bibr">53</xref>] also currently support MS-GF+. MS-GF+ is freely available at <ext-link ext-link-type="uri" xlink:href="http://proteomics.ucsd.edu">http://proteomics.ucsd.edu</ext-link>.</p>
  </sec>
  <sec sec-type="methods" id="S15">
    <title>Methods</title>
    <sec id="S16">
      <title>Spectral DAG model</title>
      <p id="P43">Given an extended alphabet 
<inline-formula><mml:math id="M33" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>, we first explain how to convert a spectrum <italic>S</italic> into a labeled DAG <italic>G. G</italic> = (<italic>V, E</italic>) has a vertex set <italic>V</italic> = {0<italic>, …, M</italic> = PrecursorMass(<italic>S</italic>)} and an edge set 
<inline-formula><mml:math id="M34" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mi>∈</mml:mi><mml:mtext>Mass</mml:mtext><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.2em"/><mml:mi>for</mml:mi><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>}</mml:mo></mml:math></inline-formula>. For simplicity, suppose that the set of ion types ℐ = {(1, 0, 1)} (i.e. only singly charged prefix ions with an of f set zero contribute to the scoring). Given a constant <italic>δ</italic> called a <italic>fragment mass tolerance</italic>, two peaks of <italic>S</italic> with m/z <italic>x</italic> and <italic>y</italic> form a <italic>duo</italic> if <italic>y − x</italic> is approximately equal to a mass of an amino acid, i.e., 
<inline-formula><mml:math id="M35" display="inline" overflow="scroll"><mml:mtext>RMass</mml:mtext><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mover><mml:mo>=</mml:mo><mml:mi>δ</mml:mi></mml:mover><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mspace width="0.2em"/><mml:mi>for</mml:mi><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula>. The vertex label <italic>s<sub>i</sub></italic> and the edge label <italic>s<sub>i,j</sub></italic> of <italic>G</italic> are defined as follows: <italic>s<sub>i</sub></italic> = 1 if there exists a peak of mass <italic>x</italic> satisfying [0.9995 <italic>· x</italic>] = <italic>i</italic> and <italic>s<sub>i</sub></italic> = 0 otherwise; <italic>s<sub>i,j</sub></italic> = 1, if there exists a duo of peaks with masses <italic>x</italic> and <italic>y</italic> such that [0.9995 <italic>· x</italic>] = <italic>i</italic> and [0.9995 <italic>· y</italic>] = <italic>j</italic>, and <italic>s<sub>i,j</sub></italic> = 0 otherwise (see <xref rid="F4" ref-type="fig">Figure 4</xref> for an example).</p>
      <p id="P44">Let <italic>P</italic> = <italic>p</italic><sub>1</sub> … <italic>p<sub>M</sub></italic> be a Boolean string representing a <italic>peptide</italic>. Similar to Kim et al., 2009 [<xref rid="R26" ref-type="bibr">26</xref>] where a peptide string generates a spectrum string, we now assume that a peptide string generates a DAG. The probability of a peptide <italic>P</italic> generating a DAG <italic>G</italic> is defined as follows: 
<disp-formula id="FD7"><mml:math id="M36" display="block" overflow="scroll"><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:munder><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle><mml:mo>⋅</mml:mo><mml:mspace width="0.7em"/><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle><mml:mo>,</mml:mo></mml:math></disp-formula> where Prob(<italic>x</italic>|<italic>y</italic>) is a 2 <italic>×</italic> 2 matrix representing the probability of a peptide character <italic>y</italic> (0 or 1) generating a vertex label <italic>x</italic>, and Prob(<italic>x</italic>|<italic>y</italic>, <italic>z</italic>) is a 2 <italic>×</italic> 4 matrix representing the probability of a pair of peptide characters <italic>y</italic> and <italic>z</italic> generating an edge label <italic>x</italic> (<xref rid="T1" ref-type="table">Table 1</xref>). In practice, <italic>β</italic><sub>1</sub>
<italic>≈ β</italic><sub>2</sub>
<italic>≈ β</italic><sub>3</sub> (see <xref rid="T1" ref-type="table">Table 1 (b)</xref>).</p>
      <p id="P45">When applying this model for scoring a peptide <italic>P</italic> and a DAG <italic>G</italic>, we consider a test comparing two hypotheses: one assuming <italic>G</italic> is generated by <italic>P</italic> and the other assuming <italic>G</italic> is generated by an “empty” string consisting of all zeros (denoted by <italic>O</italic>). The log-likelihood score of (<italic>P, G</italic>) (denoted Score(<italic>P, G</italic>)) is defined as follows (see <xref rid="F5" ref-type="fig">Figure 5</xref> for an example): 
<disp-formula id="FD8"><label>(2)</label><mml:math id="M37" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>Score</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mfrac><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="5.1em"/><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mfrac><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mstyle><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mstyle></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="5.1em"/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:munder><mml:mtext>log</mml:mtext><mml:mfrac><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mtext>log</mml:mtext><mml:mfrac><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="5.1em"/><mml:mo>≈</mml:mo><mml:munder><mml:munder><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:munder><mml:mrow><mml:mtext>log</mml:mtext><mml:mfrac><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>VertexScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder></mml:mstyle><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>vertex</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>scoring</mml:mtext></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:munder><mml:mrow><mml:mtext>log</mml:mtext><mml:mfrac><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Prob</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>EdgeScore</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder></mml:mstyle><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mtext>edge scoring</mml:mtext></mml:munder></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>Note that the last equation assumes that only the edges (<italic>i, j</italic>) with <italic>p<sub>i</sub></italic> = <italic>p<sub>j</sub></italic> = 1 contribute to the edge scoring because <italic>β</italic><sub>1</sub>
<italic>≈ β</italic><sub>2</sub>
<italic>≈ β</italic><sub>3</sub>.</p>
      <p id="P46">In practice, we generate multiple DAGs for a single spectrum, one for each <italic>ion</italic> ∈ ℐ. To generate an <italic>ion DAG</italic> for <italic>ion</italic> = (<italic>charge, of f set, sign</italic>) with a real of f set <italic>r of f set</italic>, (e.g. real of f set of the singly-charged b-ion is 1.008), we first convert <italic>S</italic> = {(<italic>mz</italic><sub>1</sub><italic>, rank</italic><sub>1</sub>)<italic>, …</italic>, (<italic>mz<sub>l</sub>, rank<sub>l</sub></italic>)} into <italic>S<sup>′</sup></italic> = {(<italic>mass</italic><sub>1</sub><italic>, rank</italic><sub>1</sub>)<italic>, …</italic>, (<italic>mass<sub>l</sub>, rank<sub>l</sub></italic>)} using the following transformation: 
<disp-formula id="FD9"><mml:math id="M38" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mtext mathvariant="italic">mass</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:msub><mml:mi mathvariant="italic">mz</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mtext mathvariant="italic">charge</mml:mtext><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.2em"/><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">set</mml:mtext></mml:mtd><mml:mtd columnalign="left"><mml:mtext>if</mml:mtext></mml:mtd><mml:mtd columnalign="left"><mml:mtext mathvariant="italic">sign</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mtext>RPrecursorMass</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="italic">mz</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mtext mathvariant="italic">charge</mml:mtext><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.2em"/><mml:mi>f</mml:mi><mml:mspace width="0.2em"/><mml:mtext mathvariant="italic">set</mml:mtext><mml:mo>)</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mtext>if</mml:mtext></mml:mtd><mml:mtd columnalign="left"><mml:mtext mathvariant="italic">sign</mml:mtext><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>Each peak of <italic>S</italic> representing <italic>ion</italic> corresponds to a peak of this <italic>converted spectrum S<sup>′</sup></italic> representing an ion type (1, 0, 1). Therefore, the vertex and edge labels of the ion DAG for <italic>ion</italic> are defined as outlined before, but using <italic>S′</italic> instead of <italic>S</italic> (<xref rid="F4" ref-type="fig">Figure 4</xref>).</p>
      <p id="P47">In reality, vertex and edge labels in the ion DAGs are integers rather than Boolean values. Given a converted spectrum <italic>S<sup>′</sup></italic>, we first remove all peaks (<italic>x, rank</italic>) if there exists another peak (<italic>x<sup>′</sup>, rank<sup>′</sup></italic>) where [0.9995 <italic>· x</italic>] = [0.9995 <italic>· x<sup>′</sup></italic>] and <italic>rank &gt; rank<sup>′</sup></italic>. The vertex label <italic>s<sub>i</sub></italic> is defined as follows: <italic>s<sub>i</sub></italic> = <italic>rank</italic> if there exists a peak (<italic>x, rank</italic>) satisfying [0.9995 <italic>· x</italic>] = <italic>i</italic> and <italic>s<sub>i</sub></italic> = 0 otherwise. For an integer <italic>m</italic>, let AminoAcid(<italic>m</italic>) be the set of amino acids 
<inline-formula><mml:math id="M39" display="inline" overflow="scroll"><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:math></inline-formula> satisfying Mass(<italic>a</italic>) = <italic>m</italic> (e.g. AminoAcid(128) = {Gln, Lys}). The edge label <italic>s<sub>i,j</sub></italic> is defined as follows: <italic>s<sub>i,j</sub></italic> = [100 <italic>·</italic> min<italic><sub>a</sub></italic><sub>∈AminoAcid(</sub><italic><sub>j−i</sub></italic><sub>)</sub>(<italic>y − x −</italic> RMass(<italic>a</italic>))] if there exists a duo of peaks with masses <italic>x</italic> and <italic>y</italic> such that [0.9995 <italic>· x</italic>] = <italic>i</italic> and [0.9995 <italic>· y</italic>] = <italic>j</italic>, and <italic>s<sub>i,j</sub></italic> = <italic>∞</italic> otherwise. The constant 100 is multiplied to discretize the real-valued errors into bins of size 0.01 Da.</p>
      <p id="P48">In this ion DAG representation, vertex labels encode the information on the <italic>intensities</italic> of individual peaks, and the edge labels encode the information on the <italic>mass errors</italic> of pairs of peaks assuming they represent consecutive peaks of the same ion type. Note that edge labels take into account the spacing between peaks but do not take into account the peak intensities.</p>
      <p id="P49"><xref ref-type="supplementary-material" rid="SD1">Supplementary Note 3</xref> describes how to integrate information from various ion DAGs into a single <italic>spectral DAG</italic>.</p>
    </sec>
    <sec id="S17">
      <title>Human datasets with varying fragmentations and instruments</title>
      <p id="P50">Five human datasets corresponding to the spectral types (<bold>CID</bold>, <bold>Low</bold>, Standard, Trypsin), (<bold>CID</bold>, <bold>High</bold>, Standard, Trypsin), (<bold>ETD</bold>, <bold>Low</bold>, Standard, Trypsin), (<bold>ETD</bold>, <bold>High</bold>, Standard, Trypsin), and (<bold>HCD</bold>, <bold>High</bold>, Standard, Trypsin) contain 38,401, 33,586, 30,451, 25,734, and 37,810 spectra respectively. These datasets are generated in the Heck laboratory (Utrecht University). HEK293 whole cell lysates were digested by trypsin and analyzed by LTQ-Orbitrap Velos (Thermo Fisher Scientific, Bremen), using combinations of one of the 3 fragmentation modes CID, ETD, and HCD, and either ion trap or Orbitrap readout for product ion m/z. The detailed experimental procedures are described in [<xref rid="R20" ref-type="bibr">20</xref>].</p>
    </sec>
    <sec id="S18">
      <title>Yeast datasets with varying enzymes</title>
      <p id="P51">Ten yeast datasets corresponding to the spectral types (<bold>CID</bold>, Low, Standard, Trypsin), (<bold>CID</bold>, Low, Standard, <bold>LysC</bold>), (<bold>CID</bold>, Low, Standard, <bold>ArgC</bold>), (<bold>CID</bold>, Low, Standard, <bold>GluC</bold>), (<bold>CID</bold>, Low, Standard, <bold>AspN</bold>), (<bold>ETD</bold>, Low, Standard, <bold>Trypsin</bold>), (<bold>ETD</bold>, Low, Standard, <bold>LysC</bold>), (<bold>ETD</bold>, Low, Standard, <bold>ArgC</bold>), (<bold>ETD</bold>, Low, Standard, <bold>GluC</bold>), and (<bold>ETD</bold>, Low, Standard, <bold>AspN</bold>), contain 333,203, 278,336, 114,351, 81,669, 251,974, 72,463, 246,428, 204,860, 88,403, and 262,635 spectra, respectively. These datasets were generated in the Coon laboratory (University of Wisconsin Madison). Yeast whole cell lysates were digested separately, with either trypsin, LysC, ArgC, GluC, or AspN, separated into 12 fractions via strong cation exchange (SCX) chromatography and analyzed in triplicate with an ETD-enabled LTQ-Orbitrap mass spectrometer, where peptide fragmentation was accomplished either with CID or ETD using the decision-tree acquisition mode [<xref rid="R54" ref-type="bibr">54</xref>]. We downloaded 180 (5 enzymes <italic>×</italic> 12 fractions <italic>×</italic> 3 replicates) spectrum files (Thermo RAW format) and converted each raw file into two mgf files one containing CID and the other containing ETD spectra using “msconvert” in ProteoWizard [<xref rid="R55" ref-type="bibr">55</xref>] with “no filtering” option. The conversion was unsuccessful for 6 out of 180 files (5 from Arg-C and 1 from Glu-C digests). These 6 files were removed in the further analyses. The detailed experimental procedures are described in [<xref rid="R1" ref-type="bibr">1</xref>].</p>
    </sec>
    <sec id="S19">
      <title>Mouse dataset of phosphopeptides</title>
      <p id="P52">A mouse dataset corresponding to the spectral type (CID, Low, <bold>Phosphorylation</bold>, Trypsin) contains 181,093 spectra. This dataset was generated from the Gygi laboratory (Harvard Medical School). Nine mouse organ proteins were digested with trypsin and the resulting peptides were fractionated via SCX. Phosphopeptides were enriched via immobilized metal affinity chromatography and analyzed in duplicates via LC-MS/MS on an LTQ-Orbitrap mass spectrometer. Out of 9 organ tissues analyzed, we used the spectra generated from the brain tissue. The detailed experimental procedures are described in [<xref rid="R21" ref-type="bibr">21</xref>].</p>
    </sec>
    <sec id="S20">
      <title>S. Pombe datasets with <italic>α</italic>LP digest</title>
      <p id="P53">Two datasets corresponding to the spectral type (<bold>CID</bold>, Low, Standard, <italic>α</italic><bold>LP</bold>) and (<bold>ETD</bold>, Low, Standard, <italic>α</italic><bold>LP</bold>) contain 49,167 spectra each. These datasets were generated in the Komives laboratory (University of California, San Diego). The detailed experimental procedures to generate these datasets are as follows. Wild-type <italic>S. pombe</italic> cells were lysed in: 50mM Tris-HCl pH: 8.0; 150mM NaCl; 5mM EDTA; 10% Glycerol; 50mM NaF; 0.1mM Na3VO4; 0.2% NP40 and stored at <italic>−</italic>80°C. The debris was pelleted and then the supernatant was collected. The pellet was extracted according to [<xref rid="R56" ref-type="bibr">56</xref>]. Briefly, the pellet was resuspended in 200 ul of 0.1 M NaOH, 0.05 M ETDA, 2% SDS, and 2% beta-mercaptoethanol and incubated at 90°C for 10 minutes. Acetic acid was added to 0.1M and vortexed followed by an additional incubation at 90<italic><sup>°</sup></italic>C for 10 minutes before clarification by centrifugation and Methanol/chloroform extraction. The pellet was resuspended in 100 mM Tris containing 0.1% sodium deoxycholate with TCEP at 5 mM. Free thiols were capped with n-ethylmaleimide. Excess reagent was removed by ultrafiltration with amicon-4 10 kDa centrifugal devices. The protein was then quantified and exchanged into 6M guanidine for digestion overnight by <italic>α</italic>LP. The digests were quenched by the addition of formic acid to 1%, followed by desalting by sep-pak (Waters, Milford, MA). Peptides were then fractionated with Electrostatic Repulsion-Hydrophilic Interaction Chromatography [<xref rid="R57" ref-type="bibr">57</xref>]. Fractions were assayed for protein concentration using a BCA assay and pooled into 18 fractions of equal protein concentration, evaporated to dryness and resuspended in 100 uL of 0.2% FA. Nano liquid chromatography tandem mass spectrometry (nLC-MS/MS) was performed with a LTQ XL mass spectrometer equipped with ETD. 10 ul of each fraction (<italic>≈</italic> 1 ug) was injected onto a 12 cm <italic>×</italic> 75 um I.D.C18 column prepared in house and eluted in 0.2% FA with a gradient of 5% to 40% ACN over 60 min followed by wash and re-equilibration totaling 90 minutes of MS data per run. The flow was split about 1:500 to a flow rate of about 250 nL/min. A survey scan was followed by data dependent fragmentation of the 4 most abundant ions with both CID and ETD with supplemental activation. The maximum MS/MS ion accumulation time was set to 100 ms. Fragmented precursors were dynamically excluded for 45 seconds with one repeat allowed.</p>
    </sec>
    <sec id="S21">
      <title>Training scoring parameters</title>
      <p id="P54">At the beginning of this study, we had 5 scoring parameter sets used in [<xref rid="R12" ref-type="bibr">12</xref>] for the following 5 spectral types: (CID, Low, Standard, Trypsin), (CID, Low, Standard, LysN), (ETD, Low, Standard, Trypsin), (ETD, Low, Standard, LysN), and (ETD, Low, Standard, LysC). For this study, we constructed 20 new parameter sets using these 5 parameter sets as a starting point using a newly developed program called ScoringParamGen within the MS-GF+ package. To train scoring parameters for a new spectral type, MS-GF+ was run with an existing parameter set to identify PSMs at 1% FDR threshold, and using the identified PSMs as a training set, a new parameter set was constructed. <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 4</xref> shows the scoring parameter sets contained in MS-GF+ and how they were constructed. We also tried to construct another generation of parameter sets using the existing parameter sets for the same spectral types, but this “iterative training” hardly changed the number of identified PSMs.</p>
      <p id="P55">For some datasets, the same dataset was used for both training and testing of the performance, raising concerns about over-fitting. However, as shown in [<xref rid="R12" ref-type="bibr">12</xref>], MS-GF+ scoring parameter set characterizes a particular spectral type and is rather stable with respect to specific data sets. For example, for the Human (CID, Low, Standard, Trypsin) dataset, when the scoring parameter set trained from the same dataset was used instead of the dataset used in [<xref rid="R12" ref-type="bibr">12</xref>], the number of identified PSMs hardly changed.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="S22">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS629163-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d37e3915" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S23">
    <p>We thank Jesse Meyer and Elizabeth Komives for providing the <italic>α</italic>LP datasets, Nuno Bandeira, Matthew Monroe, and Taejoon Kwon for providing feedback to improve MS-GF+. This work was supported by US National Institutes of Health grant 1-P41-RR024851 from the National Center for Research Resources.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN3">
      <p>
        <bold>Contributions</bold>
      </p>
      <p>S.K. and P.P. designed the algorithms and the experiments and wrote the manuscript. S.K. implemented the algorithms and performed the data analysis. The authors declare no conflict of interest.</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swaney</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Wenger</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Coon</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Value of using multiple proteases for large-scale mass spectrometry-based proteomics</article-title>
        <source>J Proteome Res</source>
        <volume>9</volume>
        <fpage>1323</fpage>
        <lpage>9</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20113005</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McCormack</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An approach to correlate tandem mass spectral data of peptides with amino acid sequences in a protein database</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <volume>5</volume>
        <fpage>976</fpage>
        <lpage>89</lpage>
        <year>1994</year>
        <pub-id pub-id-type="pmid">24226387</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perkins</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pappin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cottrell</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Probability-based protein identification by searching sequence databases using mass spectrometry data</article-title>
        <source>Electrophoresis</source>
        <volume>20</volume>
        <fpage>3551</fpage>
        <lpage>67</lpage>
        <year>1999</year>
        <pub-id pub-id-type="pmid">10612281</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Andromeda: A peptide search engine integrated into the maxquant environment</article-title>
        <source>J Proteome Res</source>
        <volume>10</volume>
        <fpage>1794</fpage>
        <lpage>805</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21254760</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wenger</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Coon</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>A proteomics search algorithm specifically designed for high-resolution tandem mass spectra</article-title>
        <source>Journal of proteome research</source>
        <volume>12</volume>
        <fpage>1377</fpage>
        <lpage>86</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">23323968</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dorfer</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ms amanda, a universal identification algorithm optimized for high accuracy tandem mass spectra</article-title>
        <source>Journal of proteome research</source>
        <volume>13</volume>
        <fpage>3679</fpage>
        <lpage>84</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24909410</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sweet</surname>
            <given-names>SMM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Database search strategies for proteomic data sets generated by electron capture dissociation mass spectrometry</article-title>
        <source>J Proteome Res</source>
        <volume>8</volume>
        <fpage>5475</fpage>
        <lpage>84</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19821632</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsieh</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Hoopmann</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Maclean</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Maccoss</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Comparison of database search strategies for high precursor mass accuracy ms/ms data</article-title>
        <source>J Proteome Res</source>
        <volume>9</volume>
        <fpage>1138</fpage>
        <lpage>43</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19938873</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kolker</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Empirical statistical model to estimate the accuracy of peptide identifications made by ms/ms and database search</article-title>
        <source>Anal Chem</source>
        <volume>74</volume>
        <fpage>5383</fpage>
        <lpage>92</lpage>
        <year>2002</year>
        <pub-id pub-id-type="pmid">12403597</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Käll</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Canterbury</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Maccoss</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Semi-supervised learning for peptide identification from shotgun proteomics datasets</article-title>
        <source>Nat Methods</source>
        <volume>4</volume>
        <fpage>923</fpage>
        <lpage>5</lpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17952086</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>ZQ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Idpicker 2.0: Improved protein assembly with high discrimination peptide identification filtering</article-title>
        <source>Journal of proteome research</source>
        <volume>8</volume>
        <fpage>3872</fpage>
        <lpage>81</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19522537</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The generating function of cid, etd, and cid/etd pairs of tandem mass spectra: Applications to database search</article-title>
        <source>Mol Cell Proteomics</source>
        <volume>9</volume>
        <fpage>2840</fpage>
        <lpage>52</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20829449</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yates</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward objective evaluation of proteomic algorithms</article-title>
        <source>Nat Methods</source>
        <volume>9</volume>
        <fpage>455</fpage>
        <lpage>6</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22543378</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Maccoss</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Computational and statistical analysis of protein mass spectrometry data</article-title>
        <source>PLoS Comput Biol</source>
        <volume>8</volume>
        <fpage>e1002296</fpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22291580</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Spectral probabilities and generating functions of tandem mass spectra: A strike against decoy databases</article-title>
        <source>J Proteome Res</source>
        <volume>7</volume>
        <fpage>3354</fpage>
        <lpage>63</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18597511</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>J-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple sodium dodecyl sulfate-assisted sample preparation method for lc-ms-based proteomics applications</article-title>
        <source>Anal Chem</source>
        <volume>84</volume>
        <fpage>2862</fpage>
        <lpage>7</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22339560</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dresang</surname>
            <given-names>LR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Coupled transcriptome and proteome analysis of human lymphotropic tumor viruses: insights on the detection and discovery of viral genes</article-title>
        <source>BMC Genomics</source>
        <volume>12</volume>
        <fpage>625</fpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">22185355</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping n-linked glycosylation sites in the secretome and whole cells of aspergillus niger using hydrazide chemistry and mass spectrometry</article-title>
        <source>J Proteome Res</source>
        <volume>11</volume>
        <fpage>143</fpage>
        <lpage>56</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22136231</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wrighton</surname>
            <given-names>KC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fermentation, hydrogen, and sulfur metabolism in multiple uncultivated bacterial phyla</article-title>
        <source>Science</source>
        <volume>337</volume>
        <fpage>1661</fpage>
        <lpage>5</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">23019650</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frese</surname>
            <given-names>CK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved peptide identification by targeted fragmentation using cid, hcd and etd on an ltq-orbitrap velos</article-title>
        <source>J Proteome Res</source>
        <volume>10</volume>
        <fpage>2377</fpage>
        <lpage>88</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21413819</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huttlin</surname>
            <given-names>EL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A tissue-specific atlas of mouse protein phosphorylation and expression</article-title>
        <source>Cell</source>
        <volume>143</volume>
        <fpage>1174</fpage>
        <lpage>89</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">21183079</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Starita</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>von Haller</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Sites of ubiquitin attachment in saccharomyces cerevisiae</article-title>
        <source>Proteomics</source>
        <volume>12</volume>
        <fpage>236</fpage>
        <lpage>40</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22106047</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expanding proteome coverage with orthogonal-specificity-lytic proteases</article-title>
        <source>Molecular &amp; cellular proteomics: MCP</source>
        <volume>13</volume>
        <fpage>823</fpage>
        <lpage>35</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24425750</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bandeira</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Keich</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Target-decoy approach and false discovery rate: when things may go wrong</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <volume>22</volume>
        <fpage>1111</fpage>
        <lpage>20</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21953092</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanner</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inspect: identification of posttranslationally modified peptides from tandem mass spectra</article-title>
        <source>Anal Chem</source>
        <volume>77</volume>
        <fpage>4626</fpage>
        <lpage>39</lpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">16013882</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bandeira</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Spectral dictionaries: Integrating de novo peptide sequencing with database search of tandem mass spectra</article-title>
        <source>Mol Cell Proteomics</source>
        <volume>8</volume>
        <fpage>53</fpage>
        <lpage>69</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">18703573</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geer</surname>
            <given-names>LY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Open mass spectrometry search algorithm</article-title>
        <source>J Proteome Res</source>
        <volume>3</volume>
        <fpage>958</fpage>
        <lpage>64</lpage>
        <year>2004</year>
        <pub-id pub-id-type="pmid">15473683</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Craig</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Beavis</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Tandem: matching proteins with tandem mass spectra</article-title>
        <source>Bioinformatics</source>
        <volume>20</volume>
        <fpage>1466</fpage>
        <lpage>7</lpage>
        <year>2004</year>
        <pub-id pub-id-type="pmid">14976030</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Côté</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Reisinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>jmzml, an open-source java api for mzml, the psi standard for ms data</article-title>
        <source>Proteomics</source>
        <volume>10</volume>
        <fpage>1332</fpage>
        <lpage>5</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20127693</pub-id>
      </element-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griss</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reisinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hermjakob</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vizcaíno</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A jmzreader: A java parser library to process and visualize multiple text and xml-based mass spectrometry data formats</article-title>
        <source>Proteomics</source>
        <volume>12</volume>
        <fpage>795</fpage>
        <lpage>8</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22539430</pub-id>
      </element-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reisinger</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>jmzidentml api: A java interface to the mzidentml standard for peptide and protein identification data</article-title>
        <source>Proteomics</source>
        <volume>12</volume>
        <fpage>790</fpage>
        <lpage>4</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22539429</pub-id>
      </element-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mzml - a community standard for mass spectrometry data</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>AR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The mzidentml data standard for mass spectrometry-based proteomics results</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Granholm</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Käll</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>On using samples of known protein content to assess the statistical calibration of scores assigned to peptide-spectrum matches in shotgun proteomics</article-title>
        <source>J Proteome Res</source>
        <volume>10</volume>
        <fpage>2671</fpage>
        <lpage>8</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21391616</pub-id>
      </element-citation>
    </ref>
    <ref id="R35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Howbert</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Computing exact p-values for a cross-correlation shotgun proteomics score function</article-title>
        <source>Molecular &amp; cellular proteomics: MCP</source>
        <volume>13</volume>
        <fpage>2467</fpage>
        <lpage>79</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24895379</pub-id>
      </element-citation>
    </ref>
    <ref id="R36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bandeira</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Gapped spectral dictionaries and their applications for database searches of tandem mass spectra</article-title>
        <source>Mol Cell Proteomics</source>
        <volume>10</volume>
        <fpage>M110.002220</fpage>
        <year>2011</year>
      </element-citation>
    </ref>
    <ref id="R37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>How does multiple testing correction work?</article-title>
        <source>Nat Biotechnol</source>
        <volume>27</volume>
        <fpage>1135</fpage>
        <lpage>7</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">20010596</pub-id>
      </element-citation>
    </ref>
    <ref id="R38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elias</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Gygi</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Target-decoy search strategy for increased confidence in large-scale protein identifications by mass spectrometry</article-title>
        <source>Nat Methods</source>
        <volume>4</volume>
        <fpage>207</fpage>
        <lpage>14</lpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17327847</pub-id>
      </element-citation>
    </ref>
    <ref id="R39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bandeira</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>False discovery rates in spectral identification</article-title>
        <source>BMC Bioinformatics</source>
        <volume>13</volume>
        <issue>Suppl 16</issue>
        <fpage>S2</fpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">23176207</pub-id>
      </element-citation>
    </ref>
    <ref id="R40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Segar</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Spectral probabilities of top-down tandem mass spectra</article-title>
        <source>BMC Genomics</source>
        <volume>15</volume>
        <issue>Suppl 1</issue>
        <fpage>S9</fpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24564718</pub-id>
      </element-citation>
    </ref>
    <ref id="R41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Payne</surname>
            <given-names>SH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phosphorylation-specific ms/ms scoring for rapid and accurate phosphoproteome analysis</article-title>
        <source>J Proteome Res</source>
        <volume>7</volume>
        <fpage>3373</fpage>
        <lpage>81</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18563926</pub-id>
      </element-citation>
    </ref>
    <ref id="R42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stekhoven</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Omasits</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Quebatte</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dehio</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ahrens</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>Proteome-wide identification of predominant subcellular protein localizations in a bacterial model organism</article-title>
        <source>J Proteomics</source>
        <volume>99</volume>
        <fpage>123</fpage>
        <lpage>37</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24486812</pub-id>
      </element-citation>
    </ref>
    <ref id="R43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risk</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Giddings</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>A peptide-spectrum scoring system based on ion alignment, intensity, and pair probabilities</article-title>
        <source>Journal of proteome research</source>
        <volume>12</volume>
        <fpage>4240</fpage>
        <lpage>7</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">23875887</pub-id>
      </element-citation>
    </ref>
    <ref id="R44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lange</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Huesgen</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Overall</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Annotating n termini for the human proteome project: N termini and n-acetylation status differentiate stable cleaved protein species from degradation remnants in the human erythrocyte proteome</article-title>
        <source>Journal of proteome research</source>
        <volume>13</volume>
        <fpage>2028</fpage>
        <lpage>44</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24555563</pub-id>
      </element-citation>
    </ref>
    <ref id="R45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A guided tour of the trans-proteomic pipeline</article-title>
        <source>Proteomics</source>
        <volume>10</volume>
        <fpage>1150</fpage>
        <lpage>9</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20101611</pub-id>
      </element-citation>
    </ref>
    <ref id="R46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goecks</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nekrutenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Team</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>
        <source>Genome Biol</source>
        <volume>11</volume>
        <fpage>R86</fpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20738864</pub-id>
      </element-citation>
    </ref>
    <ref id="R47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gonzalez-Galarza</surname>
            <given-names>FF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A critical appraisal of techniques, software packages, and standards for quantitative proteomic analysis</article-title>
        <source>OMICS</source>
        <volume>16</volume>
        <fpage>431</fpage>
        <lpage>42</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22804616</pub-id>
      </element-citation>
    </ref>
    <ref id="R48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaudel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barsnes</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Berven</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Sickmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Searchgui: An open-source graphical user interface for simultaneous omssa and x!tandem searches</article-title>
        <source>Proteomics</source>
        <volume>11</volume>
        <fpage>996</fpage>
        <lpage>9</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21337703</pub-id>
      </element-citation>
    </ref>
    <ref id="R49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacLean</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Skyline: an open source document editor for creating and analyzing targeted proteomics experiments</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <fpage>966</fpage>
        <lpage>8</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20147306</pub-id>
      </element-citation>
    </ref>
    <ref id="R50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Granholm</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast and accurate database searches with ms-gf+percolator</article-title>
        <source>Journal of proteome research</source>
        <volume>13</volume>
        <fpage>890</fpage>
        <lpage>7</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24344789</pub-id>
      </element-citation>
    </ref>
    <ref id="R51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwon</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vogel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Msblender: A probabilistic approach for integrating peptide identifications from multiple database search engines</article-title>
        <source>J Proteome Res</source>
        <volume>10</volume>
        <fpage>2949</fpage>
        <lpage>58</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21488652</pub-id>
      </element-citation>
    </ref>
    <ref id="R52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kroksveen</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cerebrospinal fluid proteome comparison between multiple sclerosis patients and controls</article-title>
        <source>Acta Neurol Scand, Supplc</source>
        <fpage>90</fpage>
        <lpage>6</lpage>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="R53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Peparml: A meta-search peptide identification platform for tandem mass spectra</article-title>
        <source>Current Protocols in Bioinformatics</source>
        <fpage>13.23.1</fpage>
        <lpage>13.23.23</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">25663956</pub-id>
      </element-citation>
    </ref>
    <ref id="R54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swaney</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>McAlister</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Coon</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Decision tree-driven tandem mass spectrometry for shotgun proteomics</article-title>
        <source>Nat Methods</source>
        <volume>5</volume>
        <fpage>959</fpage>
        <lpage>64</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18931669</pub-id>
      </element-citation>
    </ref>
    <ref id="R55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kessner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Agus</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Proteowizard: open source software for rapid proteomics tools development</article-title>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <fpage>2534</fpage>
        <lpage>6</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18606607</pub-id>
      </element-citation>
    </ref>
    <ref id="R56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von der Haar</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Optimized protein extraction for quantitative proteomics of yeasts</article-title>
        <source>PLoS ONE</source>
        <volume>2</volume>
        <fpage>e1078</fpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17957260</pub-id>
      </element-citation>
    </ref>
    <ref id="R57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Novel application of electrostatic repulsion-hydrophilic interaction chromatography (erlic) in shotgun proteomics: comprehensive profiling of rat kidney proteome</article-title>
        <source>J Proteome Res</source>
        <volume>9</volume>
        <fpage>3520</fpage>
        <lpage>6</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20450224</pub-id>
      </element-citation>
    </ref>
    <ref id="R58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van den Toorn</surname>
            <given-names>HWP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rockerbox: analysis and filtering of massive proteomics search results</article-title>
        <source>J Proteome Res</source>
        <volume>10</volume>
        <fpage>1420</fpage>
        <lpage>4</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21184612</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Various spectral types. Spectral types are represented as paths in the graph representing possible choices of the fragment method (Fragmentation), the instrument measuring product ion m/z (Instrument), the protocol used to prepare a sample (Protocol), and the enzyme used to digest proteins (Enzyme). ‘Low’ in Instrument indicates low-resolution instruments (e.g. linear ion-trap), ‘High’ indicates high-resolution instruments (e.g. Orbitrap), and ‘TOF’ indicates time-of-flight instruments. ‘Phosphorylation’ and ‘Ubiquitination’ in Protocol indicate that spectra are generated from phosphopeptides and ubiquitinated peptides, respectively. A path in the graph represents a spectral type. For example, the green path (CID, Low, Phosphorylation, Trypsin) represents low-precision CID spectra of trypsin digests generated from a sample enriched for phosphopeptides. The blue, red, green, and magenta paths represent spectral types of the datasets used in recent studies by Frese et al. [<xref rid="R20" ref-type="bibr">20</xref>], Swaney et al. [<xref rid="R1" ref-type="bibr">1</xref>], Huttlin et al. [<xref rid="R21" ref-type="bibr">21</xref>], and Starita et al. [<xref rid="R22" ref-type="bibr">22</xref>], respectively. Different combinations of analysis tools were used for different studies. Frese et al. used an in-house tool for peak filtering, de-isotoping, and charge deconvolution, Mascot for database search, Percolator for re-scoring, and RockerBox [<xref rid="R58" ref-type="bibr">58</xref>] for peptide-level FDR control. Swaney et al. used an in-house tool for peak filtering, OMSSA [<xref rid="R27" ref-type="bibr">27</xref>] for database search, and an in-house tool for both peptide- and protein-level FDR control. Huttlin et al. used an in-house tool for re-calibrating peak masses, SEQUEST for database search, an in-house tool for re-scoring, and peptide- and protein-level FDR control. Starita et al. used the Trans-Proteomics Pipeline [<xref rid="R45" ref-type="bibr">45</xref>] along with SEQUEST for database search. The same datasets were analyzed by MS-GF+ without using any additional tool with scoring parameters trained separately for different spectral types.</p>
    </caption>
    <graphic xlink:href="nihms629163f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Benchmarking MS-GF+ against Mascot+Percolator. Percent increases in the number of identified PSMs for MS-GF+ compared to Mascot+Percolator for all 19 datasets. Each bar represents a spectral dataset of a specified spectral type. For (CID, Low, Standard, Trypsin) and (ETD, Low, Standard, Trypsin), there are two corresponding datasets, one from human and the other from yeast. We distinguish them by adding ‘*’ to the yeast datasets. For the (CID, Low, Phosphorylation, Trypsin) and (CID, Low, Ubiquitination, Trypsin) datasets, the number of phosphorylated and ubiquitinated PSMs were counted instead of the number of all identified PSMs. For the (ETD,Low,Standard,<italic>α</italic>LP) dataset, Mascot+Percolator identified no PSM.</p>
    </caption>
    <graphic xlink:href="nihms629163f2"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Comparison of MS-GF+ and other tools for diverse spectral types. The numbers of identified PSMs (a–c) or peptides (d) at 1% FDR are shown. Numbers above bars represent the percentages of increase in the number of identifications for MS-GF+ compared to other tools. (a) Results for the human datasets with varying fragmentations and instruments. MS-GF+, Mascot+Percolator, and Mascot results are shown along with the results in [<xref rid="R20" ref-type="bibr">20</xref>]. Percolator greatly increased the number of identifications as compared to Mascot, but MS-GF+ outperformed Mascot+Percolator for all the datasets. (b) Increase in the number of identifications due to the availability of high-precision product ion peaks. For the three human datasets representing HH spectra, MS-GF+, Mascot+Percolator, and Mascot were run using search parameters for HL spectra. The results of these searches (denoted by HL) are compared with the numbers of identifications for the regular searches (denoted by HH). HH searches identified more PSMs than HL searches for every tool and every dataset. The difference was larger for CID and HCD than ETD spectra. (c) Results for the yeast datasets with varying fragmentations and enzymes. MS-GF+ and Mascot+Percolator results are shown. MS-GF+ outperformed Mascot+Percolator for all these datasets. (d) Comparison of MS-GF+ and the results in [<xref rid="R1" ref-type="bibr">1</xref>] that used OMSSA along with in-house post-processing tools for the yeast datasets. The numbers of (unique) peptides at the peptide-level 1% are shown. In [<xref rid="R1" ref-type="bibr">1</xref>], only the number of identified peptides matched to proteins identified at 1% protein-level FDR was counted while for MS-GF+, the number of identified peptides was counted regardless of their matched proteins.</p>
    </caption>
    <graphic xlink:href="nihms629163f3a"/>
    <graphic xlink:href="nihms629163f3b"/>
    <graphic xlink:href="nihms629163f3c"/>
    <graphic xlink:href="nihms629163f3d"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Constructing a Directed Acyclic Graph (DAG) in the case of two “amino acids” with real masses 2.012 and 2.996. Assume that only singly-charged b-ion with a real of f set 1.008 contributes to the scoring. The spectrum <italic>S</italic> is converted into <italic>S<sup>′</sup></italic> by shifting each peak by 1.008 to the left. Each arrowed line in <italic>S<sup>′</sup></italic> represents a pair of peaks separated approximately by 2 Da (blue) or 3 Da (red) that form a duo (solid) or does not form a duo (dashed) for a fragment mass tolerance 0.01 Da. A DAG <italic>G</italic> is constructed from <italic>S<sup>′</sup></italic>. The number in the vertex represents its label. The color of the edge represents its label (0 for dashed grey and 1 for solid black).</p>
    </caption>
    <graphic xlink:href="nihms629163f4"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Illustration of the MS-GF+ Directed Acyclic Graph (DAG) scoring. The peptide ABAA is converted into its Boolean string <italic>P</italic> = 010010101 and the spectrum <italic>S</italic> is converted into a labeled DAG <italic>G</italic> as described in the text. The number in the vertex represents its label. The color of the edge represents its label (0 for grey and 1 for black). The vertex <italic>i</italic> is colored depending on the peptide character <italic>i</italic> (white for 0 and black for 1). We also color vertex 0 as black. The procedure to compute Score(<italic>P, G</italic>) is illustrated. All edges are partitioned into 8 classes depending on <italic>s<sub>i,j</sub></italic>, <italic>p<sub>i</sub></italic>, and <italic>p<sub>j</sub></italic>. For example, there are 5 edges with <italic>s<sub>i,j</sub></italic> = <italic>p<sub>i</sub></italic> = <italic>p<sub>j</sub></italic> = 0.</p>
    </caption>
    <graphic xlink:href="nihms629163f5"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <label>Table 1</label>
    <table frame="void" rules="none">
      <tbody>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">
            <graphic xlink:href="nihms629163f6"/>
          </td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="TFN1">
        <p>Probability table for generating directed acyclic graphs. (a) Probability Prob(<italic>x</italic>|<italic>y</italic>) of a peptide character <italic>y</italic> generating a vertex lavel <italic>x</italic>. (b) Probability Prob(<italic>x</italic>|<italic>y</italic>, <italic>z</italic>) of peptide characters generating an edge label <italic>x</italic>.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
