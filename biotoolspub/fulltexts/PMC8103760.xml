<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8103760</article-id>
    <article-id pub-id-type="publisher-id">2364</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02364-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scSNV: accurate dscRNA-seq SNV co-expression analysis using duplicate tag collapsing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wilson</surname>
          <given-names>Gavin W.</given-names>
        </name>
        <address>
          <email>gavin.wilson@uhnresearch.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Derouet</surname>
          <given-names>Mathieu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Darling</surname>
          <given-names>Gail E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yeung</surname>
          <given-names>Jonathan C.</given-names>
        </name>
        <address>
          <email>jonathan.yeung@uhn.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.231844.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0474 0428</institution-id><institution>Latner Thoracic Surgery Research Laboratories, </institution><institution>University Health Network, </institution></institution-wrap>101 College St., 2-501, Toronto, ON M5G 2C4 Canada </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.17063.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2157 2938</institution-id><institution>Division of Thoracic Surgery, Department of Surgery, </institution><institution>University of Toronto, </institution></institution-wrap>Toronto, M5G 2C4 Canada </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.417184.f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0661 1177</institution-id><institution>Toronto General Hospital, </institution></institution-wrap>200 Elizabeth St, 9N-983, Toronto, ON M5G 2C4 Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>144</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identifying single nucleotide variants has become common practice for droplet-based single-cell RNA-seq experiments; however, presently, a pipeline does not exist to maximize variant calling accuracy. Furthermore, molecular duplicates generated in these experiments have not been utilized to optimally detect variant co-expression. Herein, we introduce scSNV designed from the ground up to “collapse” molecular duplicates and accurately identify variants and their co-expression. We demonstrate that scSNV is fast, with a reduced false-positive variant call rate, and enables the co-detection of genetic variants and A&gt;G RNA edits across twenty-two samples.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02364-5.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA-seq</kwd>
      <kwd>Genetic variation</kwd>
      <kwd>Alignment</kwd>
      <kwd>Variant calling</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010261</institution-id>
            <institution>Thoracic Surgery Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Droplet-based single-cell RNA-seq (dscRNA-seq) has become a powerful tool to profile the transcriptome of thousands of single cells in an experiment. Currently, methods to fully exploit the potential of dscRNA-seq data and gain additional biological insights continue to be developed. One such method is the integration of single nucleotide variation (SNV) data to facilitate the study of genetic subpopulations at the transcriptional level [<xref ref-type="bibr" rid="CR1">1</xref>], the demultiplexing of pooled samples using natural genetic variation between samples [<xref ref-type="bibr" rid="CR2">2</xref>], and the exploration of expression quantitative trait loci [<xref ref-type="bibr" rid="CR3">3</xref>]. However, these methods require the accurate and efficient identification of single nucleotide variants (SNVs) from dscRNA-seq data.</p>
    <p id="Par3">A key innovation of dscRNA-seq experiments is the use of three molecular identifiers: (1) the cellular barcode (CB), which is unique to each droplet; (2) the unique molecular identifier (UMI) that is unique to each molecule within a droplet; and (3) the mRNA tag (used interchangeably with read) used to identify the molecules originating transcript [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. dscRNA-seq library generation consists of four major steps: (1) within droplet reverse transcription and template switching, which integrates the CB and UMI and generates full-length cDNA molecules; (2) full-length cDNA amplification; (3) random fragmentation, size selection, and adapter ligation; and (4) library amplification and sequencing (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The critical observation with the design of these libraries is that random fragmentation occurs after the first round of PCR amplification, which generates sets of cDNA molecules with identical CBs, UMIs, and originating transcripts, but the read sequences can map to multiple unique positions within the transcript (or gene). Subsequently, these fragmented cDNA molecules are amplified a second time leading to a subset of molecules having the same CB, UMI, originating transcript, and mapping position. The resulting fragments are sets of molecular duplicates (identical CB, UMI, originating transcript), but the variability in the reads from the first round of amplification leads to the potential to cover additional bases and SNVs within the originating transcript. The subset of PCR duplicates from the second round of amplification will instead always cover the same bases per read. In practice, the additional bases covered are limited by the size selection step prior to the second PCR round. Nonetheless, this leads to the novel idea to “collapse” molecular duplicates into longer consensus molecules that will provide additional information, such as SNV co-expression.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic representing two extreme scenarios for tagged reads generated from the same molecule without any PCR duplicates (left) and with PCR duplicates (right). Row 1: the full cDNA sequence after reverse transcription; row 2: the cDNA molecules after the first round of PCR amplification, fragmentation, and adapter ligation; row 3: the fragmented products after a second round of PCR with arrows indicating the mRNA tags and CB + UMI reads; row 4: the sequencing reads after alignment; and row 5: collapsing of the aligned mRNA tags into long collapsed molecules. Each colored arrow represents the sequencing tag and the cell barcode</p></caption><graphic xlink:href="13059_2021_2364_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par4">The molecular duplicate rate is commonly referred to as the sequencing saturation and is calculated by dividing the number of molecular duplicates by the total number of countable reads. Sequencing saturation is an important metric for determining if a dscRNA-seq library has been sequenced to sufficient depth as a high saturation rate implies that additional sequencing will yield fewer new CB, UMI, and read combinations but will instead lead to additional molecular duplicates. Furthermore, it would be beneficial to explore PCR duplicate rate as a metric to assess the quality of a dscRNA-seq library as a high PCR duplicate rate may limit the base coverage of each cell and indicate that the experimental protocol needs optimization, or the sample library complexity was low.</p>
    <p id="Par5">RNA-seq and by extension dscRNA-seq experiments will contain germline SNVs, A&gt;G edits, and technical errors from library generation, sequencing, and alignment [<xref ref-type="bibr" rid="CR6">6</xref>]. Current dscRNA-seq alignment pipelines, such as Cell Ranger [<xref ref-type="bibr" rid="CR5">5</xref>], STARsolo (unpublished), Alevin [<xref ref-type="bibr" rid="CR7">7</xref>], and Kallisto BUStools [<xref ref-type="bibr" rid="CR8">8</xref>], have focused on gene expression quantification. Kallisto BUStools and Alevin are magnitudes faster than Cell Ranger; however, the aforementioned tools do not produce the full read alignments necessary for SNV calling (Alevin and Kallisto BUStools) or have not been designed to mitigate common sources of false-positive SNVs (Cell Ranger, STARsolo). Unlike low-throughput scRNA-seq methods such as SMART-seq2, which can generate millions of reads per cell, dscRNA-seq data is sparse and has only thousands to tens of thousands of molecules per cell (after duplicate removal) [<xref ref-type="bibr" rid="CR9">9</xref>]. Due to this issue, SNVs for dscRNA-seq data are typically called on pseudo-bulk samples and quantified in the individual cells [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. However, this method limits the detection of subclonal SNVs as they will have low minor allele fractions compared to clonal SNVs. Thus, while minimal filtering is necessary when calling SNVs to identify these rare SNVs, it is also likely to increase the false-positive rate. Finally, there is a need for a fast and carefully benchmarked tool to pileup dscRNA-seq data using the cell barcode and duplicate data.</p>
    <p id="Par6">In this work, we present a new dscRNA-seq alignment tool, scSNV, that is designed from the ground up to take advantage of the molecular duplicates produced by dscRNA-seq data by collapsing duplicate reads into longer molecules post-alignment, facilitates the accurate identification of SNVs from dscRNA-seq data, and extracts the co-expression of SNVs present within collapsed molecules. Furthermore, scSNV emits rich metrics for each cellular barcode including the read alignment rates, saturation, PCR duplicate rates, and the other useful metrics to determine the cell barcodes, which are likely to represent cells. For read alignment, we benchmark scSNV against Cell Ranger, the most popular tool used for the analysis of 10X Chromium dscRNA-seq data, and STARsolo, an unpublished alternative to Cell Ranger. For SNV calling, we used a SNV caller built into scSNV, “scSNV Pileup,” and two published SNV callers Strelka2 [<xref ref-type="bibr" rid="CR12">12</xref>] and samtools/bcftools [<xref ref-type="bibr" rid="CR13">13</xref>]. We utilized a set of 22 samples (17 public and 5 produced for this study, nine with matched whole genome sequencing and two with matched exome sequencing, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 to validate the accuracy of scSNV). Furthermore, we demonstrate that the true-positive rate in single cells is adversely affected by the sparsity of dscRNA-seq experiments using WGS matched scRNA-seq data and simulated data. Overall, we demonstrate that our alignment strategy, duplicate read collapsing, and SNV calling tools reduce the false-positive rate of SNV calling for dscRNA-seq data and that the collapsing strategy permits the identification of multiple edits and/or SNVs in a single molecule.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Design of scSNV: a pipeline for molecular duplicate collapsing and SNV calling from dscRNA-seq data</title>
      <p id="Par7">We designed scSNV to facilitate the accurate identification of SNVs from dscRNA-seq data. The current gold standard alignment method for 10X dscRNA-seq data is Cell Ranger [<xref ref-type="bibr" rid="CR5">5</xref>] using STAR [<xref ref-type="bibr" rid="CR14">14</xref>] for its underlying alignment, which has a high false-positive mismatch rate [<xref ref-type="bibr" rid="CR15">15</xref>]. Recently, STAR has added its own unpublished support for dscRNA-seq processing named STARsolo, which is designed to be a faster alternative to Cell Ranger with an almost similar identical output. We chose not to compare our method to pseudoalignment-based tools such as Alevin, as these do not produce full alignments for SNV calling and their quantification estimates have been shown to be identical to Cell Ranger [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
      <p id="Par8">We pre-filtered each alignment read to remove those with low sequence complexity and used BWA-mem [<xref ref-type="bibr" rid="CR16">16</xref>] to map each read to the genome to identify intergenic and unspliced reads and to the transcriptome to identify spliced reads (see “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). The transcript alignments are projected to genomic coordinates, and the alignments from both are trimmed to eliminate alignment artifacts from incorrectly mapped reads containing exon-exon junctions, which have previously been shown to generate false-positive SNVs [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. We were stringent with the identification of multi-mapped reads by including both intergenic and genic alignments, which differs from Cell Ranger, which ignores intergenic alignments if one of the alternative alignments map to a genic region. The transcript and genomic alignments are merged to identify the highest scoring alignments, which are retained for further analyses. These alignments are deduplicated using the directional UMI algorithm, where spliced and unspliced molecular counts are calculated.</p>
    </sec>
    <sec id="Sec4">
      <title>Benchmarking the run time of scSNV and quantification accuracy versus Cell Ranger and STARsolo</title>
      <p id="Par9">We used twenty-two publicly available datasets including 9 normal tissue samples [<xref ref-type="bibr" rid="CR18">18</xref>], 3 blood-derived samples (10X Genomics), 5 pancreatic ductal adenocarcinoma (PDAC) samples [<xref ref-type="bibr" rid="CR19">19</xref>] for benchmarking, and an additional 5 esophageal adenocarcinoma organoid (EAC) samples we generated for this study (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The normal tissues have matched whole genomes and two of the EAC samples have matched exomes. For each of the twenty-two samples included in this study, we processed the raw sequencing data with scSNV, Cell Ranger, and STARsolo. First, we explored the run time of scSNV (including read collapsing) to Cell Ranger and found that scSNV was 2.68±0.89 times faster than Cell Ranger, STARsolo was 3.98 ±1.53 times faster than scSNV, and STARsolo was 10.25±4.46 times faster than Cell Ranger (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1). The low performance of Cell Ranger is likely due to splitting reads by barcode, multiple file passes, and parts of its code being implemented in Python. Both scSNV and STARsolo are implemented in C++ and minimize the amount of data written to disk and the number of times files are processed. The reason STARsolo was faster than scSNV was likely due to STAR being faster than BWA-mem and the additional read collapsing step (8.07 ± 2.56% of runtime) implemented as part of scSNV requiring a second pass of the bam file and writing an additional bam file to disk.</p>
      <p id="Par10">To validate that our alignment scheme produces similar spliced and unspliced molecular counts as Cell Ranger with velocyto, we used eleven of our samples and found similar total spliced molecules and a high Spearman correlation for the spliced and unspliced counts for each barcode (average median for spliced = 0.856 ± 0.012 and unspliced = 0.875 ± 0.022) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2). However, for unspliced molecular counts, we observed a drop in the Spearman correlation for cells with low intronic molecular counts. This may be due to our high stringency for the detection of multi-mapped reads and our inclusion of additional gene biotypes that are not included in Cell Ranger’s reference. We did not compare our results to STARsolo as its spliced and unspliced read quantification is still in development but it is designed to emit similar counts as Cell Ranger and velocyto. We have demonstrated that despite our stringent alignment steps, which involved the removal of common sources of false-positive SNVs, we emit similar quantification values that can be used as an alternative to Cell Ranger and STARsolo.</p>
    </sec>
    <sec id="Sec5">
      <title>Collapsing molecular and PCR duplicates yields longer molecules</title>
      <p id="Par11">In the majority of 10X dscRNA-seq experiments, the read/mRNA tag is sequenced to 98 bp; however, the existence of molecular duplicates in each dataset permits the “collapsing” of these reads into consensus sequences which produces longer collapsed molecules (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). To do this, we developed a method that will merge the alignments into longer consensus sequences from countable reads, i.e., those confidently mapped to spliced or unspliced regions. These collapsed molecules are emitted as standard BAM files that can be used for downstream analyses. Next, we sought to explore the number of mapped bases in each collapsed molecule in relation to the samples’ overall sequencing saturation and PCR duplicate rate and to the number of underlying duplicate reads used to generate the collapsed molecule. Due to the size selection step after the full-length cDNA is fragmented, we expected that the collapsed molecules would be limited to sizes in the range of 300–600 bp (118 to 418 bp of cDNA). We observed an expected peak at 98 bp that represents collapsed molecules consisting of a single unique read (average 32.91 ± 18.25% of molecules) and that the number of mapped bases in each collapsed molecule was generally limited to &lt;400 bp (average 98.51 ± 2.90% of collapsed molecules) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, S3). In general, the maximum number of collapsed bases in a molecule was limited by the number of duplicate reads in the molecule; for example, with three reads, the maximum size was 296 bp (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S3). We also observed that the number of collapsed bases in a molecule was dependent on the sample’s sequencing saturation, where a higher sequencing saturation led to more collapsed bases (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). The effect of increased saturation was limited by the PCR duplication rate, where a high PCR duplicate rate negated the effect for increased saturation by decreasing the collapsed molecule sizes compared to samples with similar saturations. Thus, we have demonstrated that the information gained from collapsing duplicate reads is useful to glean more information from a dscRNA-seq experiment and dependent on both sequencing saturation and PCR duplicate rate.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The effect of sequencing saturation and the PCR duplicate rate on mRNA tag collapsing. <bold>a</bold> Collapsed molecule lengths from each sample ordered by their sequencing saturation (lowest to highest). For each sample, the collapsed read lengths were binned by their length and the resultant distributions were each down-sampled to 20,000 observations, smoothed using Gaussian kernel density estimation, and then scaled so the minimum and maximum value ranged from 0 to 1. The density values are indicated by the color bar. <bold>b</bold> The sequencing saturation (red) and PCR duplicate rates (blue) for each sample. <bold>c</bold> The percent of molecules in each of the collapsed base ranges as indicated by the legend</p></caption><graphic xlink:href="13059_2021_2364_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>scSNV has fewer false-positive SNV calls than Cell Ranger and STARsolo when using pseudo-bulk samples</title>
      <p id="Par12">SNVs identified from dscRNA-seq data have been used to identify genetic [<xref ref-type="bibr" rid="CR1">1</xref>] or to demultiplex pooled samples by the natural genetic variation between samples [<xref ref-type="bibr" rid="CR2">2</xref>]. Previous evaluation of SNV calling has focused on low-throughput (plate based) single-cell RNA-seq methods such as SMART-seq2 [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] or the Fluidigm C1 instrument [<xref ref-type="bibr" rid="CR21">21</xref>]. The aforementioned methods sequence the whole transcriptome from hundreds of cells with millions of paired-end reads per cell, which permits SNV calling for each cell independently. The aforementioned studies have not extensively profiled droplet-based scRNA-seq datasets, performed a detailed comparison between the effects of dscRNA-seq alignment algorithms on SNV calling accuracy, examined RNA editing events, nor assessed the effect of dscRNA-seq sparsity on the number of SNVs detected at the single-cell level.</p>
      <p id="Par13">For dscRNA-seq libraries, 3′-tagged (or 5′-tagged) molecules are sequenced from thousands to tens of thousands of cells with tens of thousands of single-end reads per cell (hundreds to thousands of molecules per cell after deduplication). SNVs are then called across the pooled cells by treating their alignments as a “pseudo-bulk” sample since the read coverage in an individual cell is too sparse for accurate SNV calling. Therefore, methods to call rare SNVs (low alternative allele counts in a pseudo-bulk sample) are essential to identify SNVs unique to a given cell type or population, for example, tumor cells in a mixed tumor/normal sample or to deconvolute pooled experiments consisting of multiple unique individuals.</p>
      <p id="Par14">Current standard SNV calling methods are not designed to utilize the strand-specificity and UMI duplicates in dscRNA-seq data and do not extract per-cell barcode allele counts. To overcome these issues, we developed a pileup method available with the scSNV package that filters based on the number of barcodes with coverage, the number of barcodes with an alternative allele at a given base, a minor allele fraction cutoff (to eliminate very rare SNVs), and basic filtering to remove common sources of false positives such as mis-spliced reads (see the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). Our pileup method emits sparse SNV count matrices to minimize disk and memory usage and can be used with a pre-existing set of known SNVs to quantify strand-specific and per-barcode SNV counts (per cell).</p>
      <p id="Par15">Our first aim was to determine if scSNV alignment with read collapsing has an effect on SNV calling accuracy compared to Cell Ranger and STARsolo. Currently, a protocol does not exist to simulate dscRNA-seq data with sequencing errors, UMI and PCR duplicates, and alignment artifacts. Therefore, as an alternative, we used nine normal samples (3 lung, 3 spleen, and 3 esophagus) with matched whole genome data and two esophageal cancer organoids with matched exome data. We constrained our analyses to regions covered in the genome sequencing data, and for the two EAC organoids with matched exome data, we further limited our analyses to regions captured by the exome array plus 100 bp of flanking sequences. By limiting our analysis to well-covered regions in the matched DNA sequencing data, we can define true positives (identified in the dscRNA-seq sample and genome data), false positives (called in a dscRNA-seq sample and covered in the genome data with less than 2 alternative base counts), and false negatives (called in the genome and at least one dscRNA-seq samples but missed in another) (see the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section).</p>
      <p id="Par16">For each dscRNA-seq sample, we used our pileup on the pooled alignments produced by scSNV with collapsing (“scSNV Collapsed”) and without (“scSNV Tags”), Cell Ranger, and STARsolo to identify SNVs. As an additional comparison, we called SNVs for each of the four alignment methods using the two SNV callers recommended by Liu et al. [<xref ref-type="bibr" rid="CR20">20</xref>]: samtools/bcftools [<xref ref-type="bibr" rid="CR13">13</xref>] and Strelka2 [<xref ref-type="bibr" rid="CR12">12</xref>]. When calling scSNV from Cell Ranger and STARsolo, we used all reads marked as duplicates as these include both UMI and PCR duplicates and discarding these negatively affected SNV calling performance (data not shown). When calling SNVs on alignments from scSNV without read collapsing, we properly mark and discard PCR duplicates while retaining UMI duplicates. It should be noted that Strelka2 does not provide an option to include reads marked as PCR duplicates. Cell- and strand-specific data was extracted using our pileup method with filtering disabled to extract strand- and barcode-specific allele counts for barcodes that were marked as cells by scSNV and to select for bi-allelic and strand-specific SNVs (see the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). Finally, we applied minimal filtering to all of the SNV calls by requiring coverage by 5 or more barcodes and 2 barcodes with the alternative allele to remove SNVs called from reads that were not marked as cells.</p>
      <p id="Par17">To begin, we examined the true-positive rate (TPR), false discovery rate (FDR), and F1 score. For these analyses, we identified potential A&gt;G edits as strand-specific A&gt;G SNVs found in the REDIportal database or within Alu [<xref ref-type="bibr" rid="CR22">22</xref>]; we then separated these sites from the other SNVs and examined them separately. First, we observed that the TPR was highest using scSNV pileup with all four alignment methods with a TPR ranging from 0.918 to 0.954 (Table <xref rid="Tab1" ref-type="table">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2), followed by samtools/bcftools with a range of 0.778–0.870, and Strelka2 with a range of 0.021 to 0.143. We further observed that Strelka2 had a low FDR among all of the samples (&lt;0.05) and F1 score (&lt;0.205).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Accuracy metric summaries for alignment and SNV calling algorithms</p></caption><table frame="hsides" rules="groups"><thead><tr><th>SNV caller</th><th>Metric</th><th>scSNV Collapsed</th><th>scSNV Tags</th><th>Cell Ranger</th><th>STARsolo</th></tr></thead><tbody><tr><td><bold>scSNV Pileup</bold></td><td>TPR</td><td>0.954 ± 0.005</td><td>0.953 ± 0.005</td><td>0.94 ± 0.011</td><td>0.955 ± 0.005</td></tr><tr><td><bold>scSNV Pileup + AF cutoff</bold></td><td>TPR</td><td>0.934 ± 0.009</td><td>0.918 ± 0.016</td><td>0.899 ± 0.012</td><td>0.912 ± 0.013</td></tr><tr><td><bold>samtools/bcftools</bold></td><td>TPR</td><td>0.819 ± 0.031</td><td>0.819 ± 0.03</td><td>0.81 ± 0.023</td><td>0.821 ± 0.028</td></tr><tr><td><bold>Strelka2</bold></td><td>TPR</td><td>0.037 ± 0.014</td><td>0.115 ± 0.025</td><td>0.11 ± 0.019</td><td>0.110 ± 0.02</td></tr><tr><td><bold>scSNV Pileup</bold></td><td>FDR</td><td>0.430 ± 0.052</td><td>0.547 ± 0.041</td><td>0.734 ± 0.055</td><td>0.729 ± 0.057</td></tr><tr><td><bold>scSNV Pileup + AF cutoff</bold></td><td>FDR</td><td>0.108 ± 0.029</td><td>0.109 ± 0.031</td><td>0.331 ± 0.038</td><td>0.322 ± 0.044</td></tr><tr><td><bold>samtools/bcftools</bold></td><td>FDR</td><td>0.049 ± 0.015</td><td>0.048 ± 0.014</td><td>0.178 ± 0.035</td><td>0.152 ± 0.027</td></tr><tr><td><bold>Strelka2</bold></td><td>FDR</td><td>0.039 ± 0.019</td><td>0.032 ± 0.015</td><td>0.052 ± 0.02</td><td>0.053 ± 0.018</td></tr><tr><td><bold>scSNV Pileup</bold></td><td>F1</td><td>0.713 ± 0.04</td><td>0.613 ± 0.038</td><td>0.412 ± 0.067</td><td>0.419 ± 0.07</td></tr><tr><td><bold>scSNV Pileup + AF cutoff</bold></td><td>F1</td><td>0.912 ± 0.017</td><td>0.904 ± 0.021</td><td>0.767 ± 0.028</td><td>0.777 ± 0.03</td></tr><tr><td><bold>samtools/bcftools</bold></td><td>F1</td><td>0.880 ± 0.021</td><td>0.880 ± 0.020</td><td>0.816 ± 0.025</td><td>0.834 ± 0.021</td></tr><tr><td><bold>Strelka2</bold></td><td>F1</td><td>0.071 ± 0.026</td><td>0.204 ± 0.041</td><td>0.197 ± 0.031</td><td>0.196 ± 0.032</td></tr></tbody></table></table-wrap></p>
      <p id="Par18">As demonstrated above, our Strelka2 results using pseudo-bulk samples were inconsistent with the findings of Liu et al. [<xref ref-type="bibr" rid="CR20">20</xref>] where they observed reasonable accuracy for Strelka2 compared to samtools/bcftools when calling simulated homozygous SNVs on individual cells from a single 10X dscRNA-seq experiment. Moreover, we examined the SNV calls that failed Strelka2’s default filtering parameters and observed that 3.66 ± 1.28% of the filtered calls were true positives from our whole genome sequencing data and 91.2% of those were filtered due to a low GQX score. This GQX score is derived from a random-forest classifier trained on features extracted from SNVs called on full-length paired-end RNA-seq data; however, in contrast, dscRNA-seq data is 3′-end biased, strand-specific, and single-end [<xref ref-type="bibr" rid="CR12">12</xref>]. Therefore, Strelka2 is not ideal for SNV calling on pseudo-bulk dscRNA-seq samples.</p>
      <p id="Par19">For the remainder of this section, we focus on the TPR and FDR for SNVs called with scSNV pileup and samtools/bcftools. We observed that SNVs called with scSNV pileup had a higher FDR than SNVs called using samtools/bcftools; however, for each sample alignment, Cell Ranger had the highest FDR, followed by STAR, scSNV Tags, and scSNV Collapsed (Table <xref rid="Tab1" ref-type="table">1</xref>). Finally, we found that for scSNV Collapsed and scSNV Tags, Cell Ranger and STARsolo identified similar numbers of A&gt;G edits with scSNV Pileup (&gt;80% of the union of all A&gt;G edits detected in a given sample by each of the alignment and SNV calling methods) and identified many fewer edits using samtools/bcftools (&lt;25% of detected edits). From this, we can conclude that alignments with scSNV with or without collapsing elicits a reduction in the FDR using both SNV calling methods and that there appears to be a trade-off for the TPR and FDR and for A&gt;G edit identification when calling SNVs using samtools/bcftools.</p>
    </sec>
    <sec id="Sec7">
      <title>The majority of false positives detected by scSNV have low minor allele fractions</title>
      <p id="Par20">Since we observed that the FDR is high for SNVs called using scSNV Pileup versus samtools/bcftools, we sought to explore if additional filtering could reduce the FDR as we only applied minimal filtering when calling SNVs. Therefore, we investigated the effect of overall minor allele fraction cutoffs (total alternative bases/total bases summed from all of the cells) using each of the alignment tools. We observed that the FDR dropped substantially, the F1 score peaked, and the TPR had a small reduction for all three alignment methods when a minor allele fraction cutoff of &gt;0.25 was used (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4). This is in contrast to samtools/bcftools where the FDR did not decrease with increased allele fraction cutoff. When the TPR is compared to the FDR, we observe an “elbow” where the FDR is substantially decreased for each alignment tool, while the TPR remains nearly the same (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5). For A&gt;G edits, this was not the case and the number of edits was substantially reduced with increased allele fraction cutoffs; therefore, for analyses pertaining A&gt;G edits, we do not recommend any additional SNV filtering (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S6). For each sample, we identified the “elbow” of the TPR vs FDR plots: 0.269 ± 0.037 for scSNV Collapsed, 0.243 ± 0.025 for scSNV Tags, 0.267 ± 0.176 for Cell Ranger, and 0.274 ± 0.024 for STARsolo (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5). Therefore, we applied an allele fraction cutoff of 0.25 to the SNVs called using scSNV Pileup and found this substantially reduced FDR with a minor decrease in TPR for each alignment method, scSNV Collapsed (−0.033±0.013 TPR and −0.334 ± 0.56 FDR), scSNV Tags (−0.036 ± 0.015 TPR and −0.441 ± 0.036 FDR), Cell Ranger (−0.053 ± 0.016 TPR and −0.419 ± 0.036 FDR), and STARsolo (−0.057 ± 0.013 TPR and −0.427 ± 0.037 FDR) (Table <xref rid="Tab1" ref-type="table">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). We also observed that the TPR and FDR scores were similar for samples constrained to the whole genome sequencing data and the two samples constrained to regions captured by the exome data (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of SNV calling performance using four alignment methods and three SNV calling methods. <bold>a</bold> The median TPR and FDR rates stratified by increasing minor allele fraction cutoffs estimated using matched DNA sequencing. The color indicates the alignment method and line style indicates the SNV calling method as per the legend. The dots on the lines using scSNV Pileup indicate the position of our recommended minor allele fraction of 0.25. <bold>b</bold> The number of A&gt;G edits detected with increasing minor allele fraction cutoffs using the same methods as <bold>a</bold>. <bold>c</bold> The number of SNV calls (in thousands) for SNVs overlapping 1000 Genomes common SNVs (first row), predicted to be A&gt;G edits (second row), or SNVs without an overlapping annotation (third row) for SNVs identified using scSNV Collapse with scSNV Pileup (solid) or samtools/bcftools (dashed) across twenty-two samples. For samples with matched DNA sequencing data, the number of SNVs found within the germline calls for each method is indicated in blue, while those not found in the germline calls are indicated in red</p></caption><graphic xlink:href="13059_2021_2364_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par21">Finally, with our newly adopted minor allele fraction cutoff, we sought to explore the effect of relaxing our genomic coverage constraint and using all twenty-two of our samples. For these, we only used scSNV collapsed alignments as we have previously demonstrated a reduction in the number of false-positive SNV calls. Since we cannot identify germline SNVs, we instead used common SNVs identified from 1000 Genomes [<xref ref-type="bibr" rid="CR23">23</xref>]. Again, we separated SNVs into three categories, found in 1000 Genomes, A&gt;G edits, and other changes not found in the two previous categories. For comparison, we included the proportion of SNVs identified in the matched exome or whole genome sequencing for the eleven samples with matched data. First, we observed that the majority of SNVs called in matched genome sequencing was found in 1000 Genomes (98.86 ± 0.30 scSNV Pileup and 99.17 ± 0.40 samtools/bcftools). Consistent with our previous observations, we found significantly more SNVs using scSNV Pileup compared to samtools/bcftools in 1000 Genomes, average log<sub>2</sub> fold change 0.186 ± 0.040, A&gt;G edits, average log<sub>2</sub> fold change 2.818 ± 0.381, and other SNVs, average log<sub>2</sub> fold change 0.4 ± 0.053 (<italic>P</italic> &lt; 0.001 for all comparisons using a one-sided Wilcoxon signed-rank test) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). Interestingly, a large proportion of the other SNVs were found in the matched whole genome sequencing data: 73.72 ± 3.30% with scSNV Pileup and 87.13 ± 2.28% with samtools/bcftools, which suggests that constraining our analyses to SNVs found in 1000 Genomes alone would cause a large reduction in the number of detected germline SNVs. Overall, these results are consistent with our previous accuracy analyses using regions constrained to the whole genome.</p>
      <p id="Par22">In conclusion, we observed that collapsing reads led to a small increase in TPR and decrease in FDR after filtering using scSNV Pileup but had little benefit when using samtools/bcftools. We also observed that the trade-off of using samtools/bcftools compared to scSNV was a reduction in TPR and FDR when Pileup leading to slightly higher F1 scores for alignments with scSNV and slightly lower F1 scores for alignments with STARsolo and Cell Ranger. However, when using samtools/bcftools, the majority of A&gt;G edits are lost. STARsolo also had slightly better performance than Cell Ranger which may partially be due to STARsolo’s inclusion of more genome annotations by default than Cell Ranger, which discards genes of various biotypes. We also observed that scSNV performed better than Cell Ranger and STARsolo due to a substantial reduction in the FDR while maintaining similar TPR’s and numbers of A&gt;G edit calls.</p>
    </sec>
    <sec id="Sec8">
      <title>Profiling the SNV calling accuracy in single cells</title>
      <p id="Par23">Due to the sparsity of dscRNA-seq data, calling SNVs in dscRNA-seq pseudo-bulk samples is currently the only practical way to call SNVs from dscRNA-seq samples. We used scSNV Pileup to quantify strand- and single-cell-specific SNV expression with filtering (see the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section) for calling with scSNV Pileup and without filtering for callers designed for bulk sample(s), i.e., samtools/bcftools. We define “cell/SNV” as a cell and SNV loci combination for a given cell and SNV loci. For the next three sections, we briefly describe our methodology to profile SNV calling accuracy in single cells. For the analyses, we used the nine samples with matched WGS data and excluded the two samples with matched exome data as they are limited to a constrained region of the genome, which limits the number of true-positive SNVs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). We limited our benchmarking to alignments with scSNV with collapsing and STARsolo as they produced similar pseudo-bulk SNV calling rates as scSNV without collapsing and Cell Ranger, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Furthermore, we only used scSNV Pileup and samtools/bcftools for SNV calling as Strelka2 performed poorly in the pseudo-bulk analyses. For each cell from each of the nine samples, we calculated per-cell accuracy metrics including TPR, FDR, and the number of A&gt;G edits using the SNV calls from their respective pseudo-bulk samples. We aggregated the results from all nine samples yielding 36,370 total cells.</p>
    </sec>
    <sec id="Sec9">
      <title>Profiling the TPR in single cells using matched WGS and simulated dscRNA-seq data</title>
      <p id="Par24">When profiling the TPR in single cells, two different false-negative (FN) values were calculated for each cell: (1) FN[bulk] a true-positive SNV detected in the pseudo-bulk but with only reference counts or no coverage in a given cell and (2) FN[cell] a true-positive cell/SNV loci with only reference counts (at least 1X coverage). The former is used to demonstrate that dscRNA-seq is sparse and that a given cell will only express a fraction of the SNVs detected in the pseudo-bulk sample, while the second is a subset of the former and the biologically relevant false-negative count that represents SNV loci that are expressed without any detectable alternative allele counts in a given cell. A TP was defined as a cell/SNV with at least one reads/molecule supporting the alternative allele in a given cell. As expected, the median per-cell TPR calculated using FN[bulk] was very low (~0.04 all four tool combinations) compared to the median TPR with FN[cell] (scSNV alignments, 0.808 for scSNV Pileup and 0.794 with samtools/bcftools, and STARsolo alignments, 0.808 for scSNV Pileup and 0.792 samtools/bcftools) and reinforces the sparsity issue of dscRNA-seq data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). The median TPR for each combination was very similar between alignment tools and was slightly higher using scSNV Pileup. Nonetheless, each comparison between the tool combinations was significantly different (<italic>P</italic> &lt; 0.01 two-sided Wilcoxon signed-rank test) despite a high Pearson <italic>R</italic><sup>2</sup> value between each combination (&gt;0.92 <italic>P</italic> &lt; 0.01). Finally, we sought to explore the relationship between the number of true-positive (TP) SNVs and the total molecules assigned to each cell and found a high <italic>R</italic><sup>2</sup> correlation (0.85 ± 0.05) across all nine samples using the TP determined by scSNV + scSNV Pileup and the total spliced + unspliced molecules by scSNV (ordinary least squares regression) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c for an example sample).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Assessing true-positive detection for single cells using the nine normal tissue samples (<italic>N</italic> = 36,581 cells) with matched WGS data. <bold>a</bold>, <bold>b</bold> The per-cell TPR rate using FN[bulk] (<bold>a</bold>) and FN[cell] (<bold>b</bold>) (see the “<xref rid="Sec2" ref-type="sec">Results</xref>” section for description). Each aligner/SNV caller is indicated as per the legend and the horizontal lines above the plot indicate the results of a two-sided Wilcoxon signed-rank test (<italic>P</italic> &lt; 0.001 blue otherwise red). <bold>c</bold> Representative comparison of the number of true-positive SNVs versus the number of spliced + unspliced molecules in the cells from Eso_325_T0, the <italic>R</italic><sup>2</sup> value and line of best fit as determined by ordinary least squares regression are indicated on the plot (<italic>P</italic>&lt;0.001). <bold>d</bold>, <bold>e</bold> Heatmaps of the average TPR (<bold>d</bold>) and percent of the true positives detected in each cell (<bold>e</bold>) across the cells from all nine samples after applying increasing coverage cutoffs (<italic>y</italic>-axis) and average minor allele fraction cutoffs across the cells from each sample (<italic>x</italic>-axis) for alignments with scSNV and SNV calls using scSNV Pileup (for other tool combinations, see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7). <bold>f</bold>, <bold>g</bold> The log10 number of true-positive SNVs (<bold>f</bold>) and the TPR (<bold>g</bold>) for the aggregated data from all three simulation experiments, where 25,000 homozygous SNVs were simulated; significant comparisons are indicated as in <bold>a</bold>. The boxplots for <bold>a</bold>, <bold>b</bold>, <bold>f</bold>, and <bold>g</bold> indicate the 25th, 50th, and 75th percentiles and the whiskers are 1.5 times the interquartile range</p></caption><graphic xlink:href="13059_2021_2364_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par25">This demonstrates that germline (TP) SNVs can indeed be profiled at the single-cell level in dscRNA-seq samples; however, a given cell only expresses a very low fraction of the total SNVs detected in a pseudo-bulk sample due to the sparsity of dscRNA-seq data.</p>
      <p id="Par26">Despite the reasonable TPR when using false negative (FN)[cell], the results were still lower than the SNV calling results suggesting that a large number of SNVs are missed at the single-cell level. We reasoned that this lower TPR rate is due to a combination of the low per-cell coverage of dscRNA-seq data and the presence of heterozygous SNVs in the genome. For example, a heterozygous SNV with a coverage of one in a given cell could support the alternative allele (TP) or the reference allele (FN). Therefore, we profiled the average TPR from all of the cells using multiple combinations of minor allele fraction (average minor allele fraction across all of the cells from a given sample) and coverage cutoffs. We observed that the average TPR approaches 1.0 as the allele fraction approaches 1.0 (homozygous SNVs) or the coverage approaches 10 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d, e, Fig S7). Moreover, we observed that the coverage cutoff was shifted to higher numbers for alignments with STARsolo. We suspected that this was due to the inclusion of molecular and PCR duplicates for STARsolo SNV calling. Indeed, when we compared the log2 fold change in the coverage of each cell/SNV combination versus the saturation for SNVs with at least 5X coverage (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S8), we observed that the average log2 fold change increased with saturation (0.55 ± 0.42 for Eso_325_T0, saturation 29.2%) and (1.97 ± 0.78 for Spleen_325_T0, saturation 91.9%) and for each sample the difference in coverage was significant (<italic>P</italic> &lt; 0.001 two-sided Wilcoxon signed-rank test). In conclusion, this data suggests that the reduction in TPR at the single-cell level is due to heterozygous SNVs and low coverage.</p>
      <p id="Par27">We have now demonstrated that the TPR is reduced due to the sparsity of dscRNA-seq data and the presence of heterozygous SNVs. Since we cannot distinguish whether a TP cell/SNV is missed due to an alignment or SNV calling issue or due to the sparsity of dscRNA-seq data, a simulation is necessary to further validate each of the benchmarked methods’ accuracy. As a method to simulate dscRNA-seq reads with UMIs, 3′-end bias, etc. does not currently exist, we adopted a modified reference genome-based simulation method for three of the nine WGS matched dscRNA-seq samples similar to the method used to profile the SMART-seq2 data [<xref ref-type="bibr" rid="CR20">20</xref>]. For each of the three samples, we randomly generated 25,000 base substitutions in the reference genome sequence at positions with at least 5X coverage from scSNV or STARsolo in the unmodified genome (see the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). Each of these simulated SNVs will be homozygous, and their detection will no longer be dependent on their minor allele fraction or coverage. In other words, if there is coverage at a given cell/SNV, it should be detected unless there are alignment errors, or the site is missed by the SNV caller. When calculating FN’s, we used both the coverage from the modified genome and the unmodified genome to capture cases where coverage at a particular cell/SNV was lost due to alignment errors from the simulation. For example, if the simulated SNV is the end of a read, it may be partially mapped by the aligner in the modified genome, but completely mapped across the SNV loci in the unmodified genome.</p>
      <p id="Par28">We detected 94.2–96.8% of the 25,000 simulated SNVs with scSNV alignments and 91.0–96.6% of the SNVs with STARsolo alignments for the pseudo-bulks of all three samples. As expected, we observed that each cell only expressed a fraction of the simulated SNVs (median of 113–115 SNV’s per cell for each tool combination) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f). However, the median TPR was very high (scSNV alignments with 0.969 scSNV Pileup, samtools/bcftools 0.966; STARsolo alignments with scSNV Pileup 0.942 and samtools/bcftools 0.943) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>g). Despite the very similar results, each of the comparisons was significantly different (<italic>P</italic> &lt; 0.01 two-sided Wilcoxon signed-rank test). The TPR was slightly higher for SNVs called with scSNV for alignment and very similar between SNV calling methods. This simulation study validates that all four of the tool combinations have sensitive detection of homozygous SNVs within single-cells when called from a pseudo-bulk analyses, i.e., if a cell expresses a homozygous SNV, they are likely to be detected by all of the benchmarked methods.</p>
      <p id="Par29">Collectively, we have demonstrated that each aligner/SNV caller combination performed well for the detection of true-positive (germline or simulated) SNVs from pseudo-bulk samples; however, the sparsity (low coverage) of dscRNA-seq data limits the detection of non-homozygous SNVs such as heterozygous SNVs in single cells. Finally, scSNV alignments have a slightly higher true-positive SNV detection rate compared to STARsolo and SNV calling between scSNV Pileup and samtools/bcftools is very similar.</p>
    </sec>
    <sec id="Sec10">
      <title>Alignments with scSNV have a reduced FDR compared to STARsolo in single cells</title>
      <p id="Par30">In our previous pseudo-bulk analyses, we demonstrated that alignments with STARsolo had an increased FDR (non-germline, non-A&gt;G edit SNVs) compared to alignments with scSNV. Moreover, SNV calling with scSNV Pileup had a higher FDR than calling with samtools/bcftools regardless of the alignment method. Next, we sought to explore if these differences are reflected at the single-cell level. We calculated the per-cell FDR and FP rates using the pseudo-bulk samples and as expected our FDR results were consistent with our pseudo-bulk analyses (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We observed that alignments with STARsolo had a much higher median FDR (0.268 with scSNV Pileup and 0.128 with samtools/bcftools) compared to alignments with scSNV (0.049 with scSNV Pileup and 0.029 with samtools/bcftools). In this case, each of the tool comparisons yielded a significant difference (<italic>P</italic> &lt; 0.001, two-sided Wilcoxon signed-rank test) and a lower Pearson <italic>R</italic><sup>2</sup> correlation (~0.3–0.4 between alignment methods and ~0.8 using the same alignment methods, <italic>P</italic> &lt;0.001). Moreover, we observed that samtools/bcftools generally had a lower FDR. Interestingly, we observed a low <italic>R</italic><sup>2</sup> (average 0.606 ± 0.091 across the nine samples <italic>P</italic> &lt;0.001 ordinary least squares regression) when comparing the total false positives versus the spliced + unspliced molecules in each cell (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Assessing false-positive and A&gt;G edit detection for single cells using the nine normal tissue samples (<italic>N</italic> = 36,581 cells) with matched WGS data. <bold>a</bold>, <bold>c</bold> The per-cell FDR (<bold>a</bold>) and log10(A&gt;G Edit Count). Each aligner/SNV caller is indicated as per the legend, and the horizontal lines above the plot indicate the results of a two-sided Wilcoxon signed-rank test (<italic>P</italic> &lt; 0.001 blue otherwise red). <bold>b</bold>, <bold>d</bold> Representative comparison of the number of false-positive SNVs (<bold>b</bold>) and A&gt;G Edits (<bold>d</bold>) versus the number of spliced + unspliced molecules in the cells from Eso_325_T0, the <italic>R</italic><sup>2</sup> value and line of best fit as determined by ordinary least squares regression are indicated on the plot (<italic>P</italic>&lt;0.001). The boxplots for <bold>a</bold> and <bold>c</bold> indicate the 25th, 50th, and 75th percentiles and the whiskers are 1.5 times the interquartile range</p></caption><graphic xlink:href="13059_2021_2364_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>SNV calling with scSNV Pileup detects more A&gt;G edits per cell than samtools/bcftools</title>
      <p id="Par31">We sought to compare the A&gt;G edit detection rate in single cells across the nine samples with matched WGS data in single cells. As we previously observed, SNV calling with scSNV Pileup yielded more A&gt;G edit calls than with samtools/bcftools and similar rates between alignment methods. As expected, in single cells, we observed a much larger median number of A&gt;G edits per cell for SNVs called with scSNV Pileup (281 with scSNV and 282 with STARsolo) compared to samtools/bcftools (16 with scSNV and 22 with samtools/bcftools). The differences between each of the methods were significant (<italic>P</italic> &lt; 0.001, two-sided Wilcoxon signed-rank test) and the Pearson <italic>R</italic><sup>2</sup> correlation was high (&gt;0.9, <italic>P</italic> &lt; 0.001) using the same SNV caller and lower between SNV callers (~0.8, <italic>P</italic> &lt; 0.001).</p>
      <p id="Par32">The results from the last two sections are consistent with our pseudo-bulk analyses where there was a trade-off between scSNV Pileup and samtools/bcftools in terms of detecting SNVs with lower minor allele fractions such as A&gt;G edits and an increased false discovery rate.</p>
    </sec>
    <sec id="Sec12">
      <title>Collapsed molecules improve the identification of co-expressed SNVs</title>
      <p id="Par33">We further sought to explore the utility of collapsed molecules for the detection of SNVs co-expressed within the same molecule and the functionality of scSNV to efficiently extract per-cell SNV co-expression data. In this section, we defined an SNV as germline if it was in the matched DNA sequencing data (if available) or 1000 Genomes. For each sample, we examined SNV co-expression using SNVs called with scSNV Pileup as samtools/bcftools misses the majority of A&gt;G edits. We only used alignments emitted by scSNV because and Cell Ranger and STAR are limited by default to 10 mismatches in a 96-bp read. As a comparison to demonstrate the increase in SNV co-expression detection, we compared the collapsed molecules from scSNV to the reads alignments without collapsing. We determined the unique sets of co-expressed SNVs for all twenty-two samples that had at least five co-expressed SNVs and a dominant SNV type, i.e., more than half of the SNVs (83.2 ± 4.34% of co-expressed SNV sets per sample). First, we observed that individual tag alignments are limited to detecting 31 SNVs, while collapsing identified up to 68 SNVs in a single molecule (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). With scSNV, we could detect up to 32 germline SNVs compared to 17 for tags, 50 A&gt;G edits compared to 28 for tags, and 45 unknown SNVs compared to 24 for tags. Next, we examined the purity of the dominant SNV type, i.e., the percentage of the SNVs in the set that were the dominant type, and found similar average purities for each SNV type between scSNV and Cell Ranger. For the germline SNV sets of 69.86 ± 13.40% for collapsing and 69.01 ± 12.58% for tags, for the A&gt;G edit sets of 82.17 ± 15.32% for collapsing and 82.72 ± 15.33% for tags, and for the unknown SNVs of 73.31 ± 15.08% for collapsing and 76.12 ± 15.58% for tags. The high purity of A&gt;G edits is expected as these are commonly found in regions of hyper-editing but may also indicate that using SNV co-expression may be a method to identify further edits that are co-expressed with known sites [<xref ref-type="bibr" rid="CR24">24</xref>]. Finally, we observed a significant difference between the number of SNV’s detected per molecule (<italic>P</italic> &lt; 0.001 two-sided Wilcoxon signed-rank test) for each comparison between scSNV with and without collapsing. Collectively, this demonstrates that collapsing molecular reads provides additional SNV co-expression information than examining SNVs using individual reads alone.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparing molecules (scSNV collapse) or tags (scSNV tags) with at least five co-expressed SNVs. For each sample, we identified the unique sets of SNVs detected by at least one molecule/read and we counted the number of germline SNVs, A&gt;G edits, and unknown changes. For each set where the count of the maximal SNV type was more than half the total count, we assigned it as having a dominant SNV type. We then merged all of the sample sets together without removing duplicate entries. We calculated values for SNV data from scSNV (<bold>a</bold>, <bold>c</bold>, <bold>e</bold>) and Cell Ranger (<bold>b</bold>, <bold>d</bold>, <bold>f</bold>) and plotted 2D-histograms of dominant SNV type count versus the total number of SNVs in the molecule for SNVs overlapping germline (if available) and 1000 Genomes calls (<bold>a</bold>, <bold>b</bold>), A&gt;G edits (<bold>c</bold>, <bold>d</bold>), and unknown SNVs (<bold>e</bold>, <bold>f</bold>). The log counts for each 2D bin are indicated by the color bars beside each heatmap</p></caption><graphic xlink:href="13059_2021_2364_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Conclusion</title>
    <p id="Par34">Herein, we present scSNV, a novel pipeline to facilitate the accurate identification of SNVs and to explore their co-expression from dscRNA-seq data. One of the key innovations of scSNV is the collapsing of duplicate reads into consensus molecules we have called “collapsed molecules.” These collapsed molecules can be 400 bp or more in length with their size being limited to the size selection step during library generation. Furthermore, we demonstrated that the size distribution of these collapsed molecules is dependent on the sequencing saturation and PCR duplicate rate. A high saturation indicates that the sample has been sequenced to sufficient depth, while a high PCR duplicate rate may indicate problems with the complexity of the sample or that the sample was overamplified during the second library amplification step. Finally, we demonstrated that these collapsed molecules are useful to explore the co-expression of SNVs in single molecules. For example, we demonstrated that we can find regions of A&gt;G hyper-editing with upwards of 50 edits in our samples. One limitation of our analyses is that we did not attempt to identify additional A&gt;G edits by looking for A&gt;G changes that were not identified as edits that are co-expressed with an annotated edit. This may be worth exploring in the future as a method to identify additional A&gt;G RNA editing using co-expression data.</p>
    <p id="Par35">We have demonstrated that scSNV alignments with and without read collapsing have similar TPR and A&gt;G identification rates as Cell Ranger and STARsolo, albeit a reduced FDR. The effect of collapsing on SNV calling is minor; however, collapsing reads negates count overinflation due to molecular and PCR duplicates. These results were consistent when using two different SNV calling methods, scSNV Pileup and samtools/bcftools. We explored the trade-off between the TPR, A&gt;G edit calling rate, and FDR when using scSNV Pileup versus samtools/bcftools. The choice between the methods will depend on the user’s goal; for example, samtools/bcftools would be ideal if a user desires to minimize the FDR and is only interested in SNVs with a high allele fraction (&gt;~0.20). However, if a user desires low allele fraction SNVs or A-to-G RNA edit calls, then scSNV Pileup would be more suitable despite the small increase to the FDR. We have demonstrated that a minor allele fraction cutoff of 0.25 reduced the FDR for scSNV Pileup calls with a minor reduction in TPR; however, when analyzing a sample consisting of 5 different pooled individuals, this cutoff would result in the loss of the majority of SNVs that are unique to each individual. In this case, minimal SNV filtering has been proven effective by two different genotype-based single-cell deconvolution methods and it may be worth exploring if alignments with scSNV with read collapsing offer an accuracy improvement compared to alignments with Cell Ranger [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par36">We evaluated a third SNV caller, Strelka2, which we found to have poor performance on pseudo-bulk dscRNA-seq data despite being recommended by a previous study [<xref ref-type="bibr" rid="CR20">20</xref>]. However, the latter study focused on full-length plate-based scRNA-seq samples where each cell has higher coverage compared to dscRNA-seq tag-based methods and only examined simulated homozygous SNVs called individually on a random subset of the cells from a single dscRNA-seq library, which is different than the pseudo-bulk approach commonly used with dscRNA-seq data. Nonetheless, our simulated results with samtools/bcftools results were similar to their single dscRNA-seq library benchmarking, which suggests that Strelka2’s performance is not ideal for dscRNA-seq data samples. It should be noted that we did not evaluate the efficacy of calling SNVs by treating each individual cell from dscRNA-seq as a bulk sample, as this would be computationally challenging to manage (generating and calling SNVs on thousands to tens of thousands of alignment files) and unlikely to increase the true-positive rate and may increase the false discovery rate. Nonetheless, a modified version of this approach may increase the sensitivity of SNV callers that do not detect rare SNVs by default such as samtools/bcftools, where multiple subsets of the bulk sample (such as cell clusters) could be extracted and SNVs called on their aggregated alignments. This approach would be less useful for our scSNV Pileup method where a low allele fraction is used by default for our pileup, which can be revised later depending on the sample, for example, using the 0.25 cutoff we found to be effective on our benchmarked samples.</p>
    <p id="Par37">We also demonstrated that the sparsity of dscRNA-seq data led to each cell only expressing a small subset of the total true-positive SNVs detected in a pseudo-bulk sample and the low coverage of heterozygous SNVs in many of the cells leads to a reduced TPR for individual cells. To further validate that the per-cell reduction in TPR was due to the aforementioned heterozygous SNVs, we demonstrated that the per-cell TPR reaches an average of one as we selected for homozygous SNVs by increasing the average minor allele fraction cutoffs applied to the SNV calls within each cell. Furthermore, simulation of 25,000 homozygous SNVs in three of the biological samples also yielded a high TPR (&gt;0.94), which is consistent with our matched WGS benchmarking approach when our analyses were limited to homozygous SNVs or SNVs with high coverage.</p>
    <p id="Par38">Collectively, our benchmarking of dscRNA-seq alignment and SNV calling methods validates that true-positive germline (and somatic) SNVs can be accurately called from dscRNA-seq pseudo-bulk samples and quantified in single cells. The reduction in false-positive SNV calls using scSNV compared to Cell Ranger and STARsolo will also be desirable when looking for subclonal SNVs. Furthermore, the sparsity of dscRNA-seq data limits the accurate quantification of heterozygous SNVs in single cells from regions of low coverage.</p>
    <p id="Par39">The compute time for STARsolo was much lower compared to scSNV and Cell Ranger, with similar TPR rates, which would make STARsolo a desirable option if a user is only interested in quantifying a known set of germline or somatic SNVs. In the future, it may be worth integrating some of our alignment processing steps to improve the FDR for STARsolo leading to a rapid method for SNV identification in dscRNA-seq data. It would also be worth exploring if our read collapsing strategy could be applied to STARsolo alignments; however, some pre-processing of the alignments may be necessary to avoid issues where the mRNA tag alignments from a given molecule are not compatible, for example, if a portion of the reads have a false-positive novel splice junction instead of an insertion or deletion. Finally, the properties of false-positive SNVs from each of the alignment methods could be explored to develop a classifier to better identify false-positive SNVs from collapsed molecules.</p>
    <p id="Par40">In the future, SNV co-expression and tag collapsing may improve the accuracy of demultiplexing dscRNA-seq samples [<xref ref-type="bibr" rid="CR2">2</xref>] since germline SNVs unique to each pooled genotype should not be co-expressed within the same collapsed molecule. Moreover, co-expression data may be useful when integrating dscRNA-seq with matched single-cell DNA copy number data where both datasets are sparse and therefore maximizing SNV information to infer subclones is essential. Finally, the idea of collapsing SNVs could be implemented using tag assembly from their sequences rather than their alignments. The mRNA tags could be grouped by their cell barcode and UMI and followed by de novo assembly. The assembled longer reads could be mapped to the genome/transcriptome, which could facilitate the identification of large insertions, deletions, and gene fusions. However, this may be technically challenging to implement as the tags from a UMI duplicate may not overlap but should still cover ~100–500 bp of transcript sequence depending on the number of UMI duplicates in the molecule.</p>
    <p id="Par41">In conclusion, scSNV represents an accurate dscRNA-seq pipeline that minimizes SNV false-positive calls and facilitates the analysis of SNV co-expression at the cellular and molecular levels.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>Genome build information</title>
      <p id="Par42">GRCh38 human genome annotations from Ensembl build 94 [<xref ref-type="bibr" rid="CR25">25</xref>] were downloaded and used for all of the analyses. 1000 Genomes [<xref ref-type="bibr" rid="CR23">23</xref>] phase 3 common SNPs were downloaded from Ensembl, and mitochondrial mutations were downloaded from the 1000 Genomes site. The two VCF files were merged and filtered with bcftools to select bi-allelic variants with a frequency greater than 0.01. Known RNA edits were downloaded from REDIportal [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    </sec>
    <sec id="Sec16">
      <title>Previously published samples</title>
      <p id="Par43">Three T0 sets of dscRNA-seq samples from lung, spleen, and esophagus samples with matched whole genome sequencing were retrieved from the HCA data access portal [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The PBMC 4k and T-cell samples were retrieved from the 10X Genomics website. The five pancreatic ductal adenocarcinoma samples were downloaded from the genome sequencing archive (accession CRP000653) [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    </sec>
    <sec id="Sec17">
      <title>Processing of whole genome samples</title>
      <p id="Par44">Paired-end reads for each sample were individually mapped with BWA-mem v0.7.17-r1188 [<xref ref-type="bibr" rid="CR16">16</xref>], sorted with samtools [<xref ref-type="bibr" rid="CR28">28</xref>] v1.9, and had duplicates marked with picard 2.18.20-1 (<ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard">http://broadinstitute.github.io/picard</ext-link>). Bi-allelic SNVs were called with Strelka2 [<xref ref-type="bibr" rid="CR12">12</xref>] with the default options.</p>
    </sec>
    <sec id="Sec18">
      <title>Overview of scSNV</title>
      <p id="Par45">scSNV consists of 5 alignment steps: (1) index generation (only needed once), (2) barcode counting, (3) QA and read mapping, (4) UMI collapsing, and (5) collapsed BAM file generation. Additionally, the code to generate simulated mixture data and the auxiliary scripts used to process and annotate the data are included with the package.</p>
    </sec>
    <sec id="Sec19">
      <title>Full-length transcript index construction</title>
      <p id="Par46">scSNV generates a full-length transcript index from a GTF and genome fasta file. By default, transcripts annotated as retained_intron, nonsense_mediated_decay, non_stop_decay, and transcripts with a length less than 100 bp are not included. The transcript fasta file is indexed using BWA-mem [<xref ref-type="bibr" rid="CR16">16</xref>] with default parameters.</p>
    </sec>
    <sec id="Sec20">
      <title>Read QA, mapping, and barcode correction</title>
      <p id="Par47">We have adopted a similar cell barcode counting and correction scheme as Cell Ranger [<xref ref-type="bibr" rid="CR5">5</xref>]. In brief, all of the cell barcodes that match a known barcode are counted. During the mapping step, if a barcode does not match a known barcode but is one mismatch away from one or more known barcode(s), it is assigned to the known barcode with the highest count.</p>
      <p id="Par48">To remove low-quality reads prior to alignment, we apply the following QA steps: (1) The cell barcode must match a known barcode after correction and must not contain any ambiguous bases. (2) The UMI must not contain any ambiguous bases. (3) Poly(A) sequences are trimmed off of the read tag ends and the sequence remaining after trimming must be at least half the reads length; otherwise, the read is discarded. (4) An optional DUST score [<xref ref-type="bibr" rid="CR29">29</xref>] is calculated for the remaining read tag and reads with a DUST score greater than a user-defined threshold are discarded. Reads that pass all of the QA steps are processed for alignment tag mapping.</p>
      <p id="Par49">The alignment tag for each read is mapped independently to a full genome index and full-length transcript index using BWA-mem [<xref ref-type="bibr" rid="CR16">16</xref>] C API with the default alignment scoring options. Each transcript alignment is projected to genomic coordinates. A minimum BWA-mem alignment score cutoffs of 45 is used. To mitigate a common source of false-positive mismatches, alignments that pass the scoring threshold are trimmed back if they overhang a splice site by less than or equal to 5 base pairs [<xref ref-type="bibr" rid="CR15">15</xref>]. To identify multi-mapped reads, a minimum alignment score of |maximum alignment score - 3| is calculated. All alignments with scores greater than or equal to the minimum alignment score are retained. Each alignment from a single read tag is then given an alignment type based on the following schema:
<list list-type="order"><list-item><p id="Par50">Unmapped: no alignments present</p></list-item><list-item><p id="Par51">Antisense: the read is derived from the antisense strand of an annotated gene</p></list-item><list-item><p id="Par52">3) Exonic: all full-length transcript alignments and genomic alignments with more than 25 base pairs of the read overlapping an annotated exon from a single gene</p></list-item><list-item><p id="Par53">Intronic: more than 5 base pairs of the read overlap an annotated intron (i.e., no overlap with an exon) from a single gene</p></list-item><list-item><p id="Par54">Intergenic: a genomic alignment that is not annotated as antisense, exonic, ambiguous, or intronic</p></list-item><list-item><p id="Par55">Ambiguous: genomic alignments where the read overlaps more than one gene</p></list-item></list></p>
      <p id="Par56">Finally, the set of alignments for a given tag are annotated as follows:
<list list-type="order"><list-item><p id="Par57">Multi-mapped: the read maps to more than one location, for example, two different genes or one gene and an intergenic region</p></list-item><list-item><p id="Par58">Antisense: all of the reads alignments are antisense to a gene</p></list-item><list-item><p id="Par59">Ambiguous: all of the reads alignments are ambiguous or the read has both an intronic and exonic alignment within the same gene</p></list-item><list-item><p id="Par60">Exonic (spliced): all of the reads alignments map to exonic regions of the same gene</p></list-item><list-item><p id="Par61">Intronic (unspliced): there is a unique intronic alignment to a single gene</p></list-item></list></p>
      <p id="Par62">Only intronic and exonic alignments are used for UMI collapsing and quantification. Finally, this step emits position-sorted BAM files for reads that map to exonic and intronic regions that can be merged after UMI deduplication to produce deduplicated and collapsed BAM files (see below).</p>
    </sec>
    <sec id="Sec21">
      <title>Spliced and unspliced alignment collapsing and counting</title>
      <p id="Par63">A UMI group is defined as a set of reads with a matching gene ID, cell barcode, and UMI; these reads are expected to be derived from the same molecule. It is worth noting that these reads do not have to have the same mapping position to be considered duplicates. To extend groups to handle mismatches within the UMI, we apply the directionality collapsing algorithm [<xref ref-type="bibr" rid="CR30">30</xref>] to all of the UMIs from the same gene ID and barcode. A UMI group is annotated as unspliced/intronic if at least one of the reads in the group was annotated as an intronic alignment the read is annotated as spliced/exonic otherwise. We have extended the UMI collapsing algorithm to count PCR duplicates, which are read alignments in a UMI group that have the same mapping position. Finally, after UMI collapsing, we implement a method similar to Cell Ranger, where the same corrected UMIs from a given barcode are grouped together, and if the same UMI maps to multiple genes, the one with the highest supporting reads is retained and the others are discarded as these reads are likely to represent mapping errors.</p>
      <p id="Par64">For each cellular barcode, we output a list of alignment statistics including the number of alignments from each alignment type defined in the mapping step, the number of unique exonic and intronic molecules, the PCR duplicate rate, the UMI duplicate rate, and an option to count the number of unique molecules from user-defined lists of genes, for example, mitochondrial genes. The molecule count data, alignment statistics, and other information are written to an HDF5 (<ext-link ext-link-type="uri" xlink:href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</ext-link>) file to permit easy access to the data in any programming language that has an HDF5 library.</p>
      <p id="Par65">After the UMIs are deduplicated, the sorted BAM file(s) are merged and deduplicated where PCR duplicates and UMI duplicates are annotated. Reads from the same UMI group are then collapsed to generate a BAM file where all of the reads in a UMI group are merged into a consensus sequence. For each aligned base that has more than one overlapping read, we determine a consensus base where at least 60% of the reads have the same base; otherwise, the consensus base is set to ambiguous (<italic>N</italic>). We set the quality of the base to the maximum base quality supporting the consensus base. For insertions and deletions (indels), we require at least 60% of the reads overlapping the indels position to have the exact same sequence.</p>
      <p id="Par66">One minor limitation of our implementation is that if all of the UMI groups do not map linearly across the genome, the group is not collapsed. In our experience, this happens to a small fraction (typically &lt;0.01%) of the reads.</p>
    </sec>
    <sec id="Sec22">
      <title>Identifying cells</title>
      <p id="Par67">First, we only examine cell barcodes with at least one spliced molecule and we determine a rough estimate of the number of cells using the “elbow” approach previously described. Next, while exploring the data, we observed that samples tend to have outlier barcodes with high proportions of mitochondrial (MT) molecules, low sequencing saturation or PCR duplicate rates, or a high proportion of reads that were barcode corrected (see the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section above). In each of these cases, we applied a median absolute deviation (MAD) filter with the following parameters:
<list list-type="order"><list-item><p id="Par68">For MT DNA percent, we used the median + min(5 × MAD, 20) as a maximum cutoffs</p></list-item><list-item><p id="Par69">For saturation and PCR duplicates, we used the median − min(3 × MAD, 10) as the minimum cutoffs</p></list-item><list-item><p id="Par70">For the percent of barcode corrected reads, we used the median + max(10 × MAD, 1.5) as the maximum cutoffs</p></list-item></list></p>
      <p id="Par71">We include an example script that implements our cell determination algorithm that can output the data as a python hdf5 file and anndata [<xref ref-type="bibr" rid="CR31">31</xref>] file. The latter can be used with tools such as scanpy [<xref ref-type="bibr" rid="CR31">31</xref>] and Seurat [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    </sec>
    <sec id="Sec23">
      <title>Benchmarking scRNA-seq alignment methods</title>
      <p id="Par72">All alignments were run on a custom genome build using Ensembl 94. In brief, STARsolo from STAR package v2.7.5c [<xref ref-type="bibr" rid="CR14">14</xref>] and Cell Ranger v2.1.1 and scSNV were limited to at most 24 threads. Cell Ranger was run with the --nosecondary flag to disable secondary analysis as this increases the runtime calculations for Cell Ranger. STARsolo was indexed without pre-filtering the genome annotations, which is a slight deviation from Cell Ranger and run with the following arguments:</p>
      <p id="Par73">
        <italic>--limitBAMsortRAM 41995186164 --soloType CB_UMI_Simple --soloCBwhitelist 737K-august-2016.txt --soloUMIfiltering MultiGeneUMI -soloUMIfiltering MultiGeneUMI --soloCBmatchWLtype 1MM_multi_pseudocounts --outSAMattributes NH HI nM AS CR UR CB UB GX GN --outSAMtype BAM SortedByCoordinate</italic>
      </p>
      <p id="Par74">The 737K-august-2016.txt is the white list of barcodes for V2 dscRNA-seq libraries provided by 10X Genomics and is mirrored in the scSNV github repository.</p>
      <p id="Par75">To quantify unspliced molecular counts for a subset of samples between scSNV and Cell Ranger, the velocyto [<xref ref-type="bibr" rid="CR33">33</xref>] python package v0.17.17 was used without repeat filtering. The filtered output matrices from Cell Ranger were rederived using the raw output matrices and the barcodes identified using scSNV to simplify comparisons with scSNV.</p>
      <p id="Par76">For reproducibility, we have mirrored the source code for Cell Ranger v2.1.1 at:</p>
      <p id="Par77"><ext-link ext-link-type="uri" xlink:href="https://github.com/GWW/cellranger_211_mirror">https://github.com/GWW/cellranger_211_mirror</ext-link>.</p>
    </sec>
    <sec id="Sec24">
      <title>SNV calling from single-cell data</title>
      <p id="Par78">We developed a pileup tool to take into account the strand-specific nature of 10X Single Cell libraries and to quantify the number of supporting barcodes, molecule counts for each strand, and the maximum distance from SNV to the closest read 5′- or 3′-end. For collapsed molecules, we extend the idea of a mismatch being near a read-end to include internal read-ends. For example, a collapsed molecule could consist of three reads that do not overlap and the reads-ends internal to the read could have false-positive SNVs at one of its ends due to a mis-spliced read. The program works on both the collapsed and mRNA tag-aligned BAM files to facilitate comparison with Cell Ranger. We set default filtering conditions for SNV sites to only count reads at a given position if it has a minimum base quality of 20 and for the read to be derived from. For Cell Ranger and STARsolo, we implemented additional read filtering to select for reads that were mapped uniquely (mapping quality 255, tags: MM:1, RE: E/N) to intronic (mapping to a single gene) or exonic regions. It should be noted that for Cell Ranger we did not remove reads that were marked as duplicates as we observed that this substantially reduced the number of SNVs identified by Cell Ranger.</p>
      <p id="Par79">We chose our filtering parameters to maximize the detection of mutations that may be important to genotype rare populations. For example, filtering by allele fractions may cause us to filter out mutations that may be informative for genotyping. Instead, we require that each potential SNV be covered by at least 5 unique cell barcodes, at least 2 unique barcodes supporting the alternative allele, a minor allele fraction of at least 0.01, and have at least one read with a supporting mismatch outside of the first and last 5 base pairs of the read. All of the data is emitted from scSNV’s pileup command into a HDF5 file for easy loading into a programming language that has an HDF5 library.</p>
      <p id="Par80">To call SNVs with samtools/bcftools [<xref ref-type="bibr" rid="CR13">13</xref>], we used the following flags with Cell Ranger and STARsolo to process all reads including PCR duplicates as excluding these caused a huge false-negative rate: --ff 2820 -Q 30 -A -x and for scSNV we used the following: -Q 30 -A -x. To call SNVs with Strelka2, we used the default options but included the --rna tag to enable RNA-seq filtering parameters.</p>
    </sec>
    <sec id="Sec25">
      <title>Annotating SNVs from single-cell RNA-seq data</title>
      <p id="Par81">We developed a custom python script to annotate each SNV (available in the scSNV code repository). First, we refined the list of passed SNVs by requiring that 95% of the reads supporting the SNV consist of the reference and alternative allele, and since 10X single-cell libraries are strand-specific, we inferred the strand for each potential SNV by requiring that at least 90% of the reads covering the SNV be derived from the same strand; otherwise, the strand was marked as unknown. This filtering step tends to retain ~98% of the SNVs. We annotated each SNV with overlap to RepeatMasker annotations downloaded from UCSC GRCh38 [<xref ref-type="bibr" rid="CR34">34</xref>] and known A-to-I RNA edits from REDIportal [<xref ref-type="bibr" rid="CR26">26</xref>] (both retrieved on November 22, 2019). The REDIportal annotations were transformed from hg19 to GRCh38 using UCSC’s liftOver [<xref ref-type="bibr" rid="CR35">35</xref>] tool. An SNV was considered a potential A-to-I RNA edit if it was an A-to-G change, found in REDIportal, or overlapped an Alu element. Each SNV was further annotated if it matched a SNV found matched whole genome sequencing data (if available) and/or if it was found in 1000 Genomes common SNPs.</p>
    </sec>
    <sec id="Sec26">
      <title>Benchmarking SNV calling using matched genome sequencing data</title>
      <p id="Par82">We only used SNVs called as bi-allelic and strand-specific that were consistent across every method that called the SNV, i.e., the same alternative allele and inferred strand. We limited our analyses to regions that had at least 1X coverage with a base quality ≥ 20 by one of the alignment methods in a given dscRNA-seq sample and at least 15X coverage from reads with a mapping quality ≥ 20 and base quality ≥ 20 in the matched exome or WGS data. We called an SNV as identified in the matched DNA sequencing data if there were and 2 alternative bases with a mapping quality ≥ 20 and base quality ≥ 20. This includes SNVs that were not called by Strelka2 in the genome data as we wanted to be sure there was no evidence of an SNV at that position. We identified SNVs as true positives if they were called in the DNA sequencing data and the dscRNA-seq data as false positives if they were covered in the genome sequencing data without a call but called in the dscRNA-seq data, and false negatives if they were called in the genome data and had at least 5 barcodes covering the position with base quality ≥20.</p>
    </sec>
    <sec id="Sec27">
      <title>Simulation homozygous SNVs in biological dscRNA-seq samples</title>
      <p id="Par83">We simulated 25,000 homozygous SNVs for each of three different samples (Eso_325_T0, Lung_367_T0, and Spleen_325_T0), by randomly substituting positions in the reference genome with the following constraints: (1) the SNV must be at least 10 bp away from a SNV call from scSNV or STARsolo alignments using scSNV Pileup or samtools/bcftools and (2) at least 5X coverage in one of the samples (to avoid simulating the majority of SNVs in regions with 1X coverage). The modified genome was indexed and the reads were mapped with scSNV and STARsolo and SNVs called using scSNV Pileup and samtools/bcftools as described in the previous section. We classified a SNV as a true positive if there was at least one alternative allele expressed in a given SNV/cell pair and a false negative if the loci had no alternative allele expression but had detectable coverage in the modified genome alignment or the original unmodified genome. The latter constraint was included as alignments to the modified genome may affect the coverage of a given SNV in a particular cell, for example, if the SNV was near a read-end and the alignment tool soft clipped the read instead of emitting a mismatch.</p>
    </sec>
    <sec id="Sec28">
      <title>Esophageal adenocarcinoma sample collection and organoid growth</title>
      <p id="Par84">Patient blood samples were used for germline exome calls. Similarly, 2 pieces of endoscopic biopsy or resected tumor were snap frozen and stored at −80°C. The samples were thawed and used for DNA extraction with the Qiagen DNeasy Blood and Tissue Kit (Qiagen Inc, Venlo, NL). The somatic and germline exomes for EAC_46 and EAC_92 were sequenced as part of another study that is currently under revisions. Finally, all methods were performed in accordance with relevant guidelines and regulations. Exome sequencing data and organoid growth protocols were previously published by Derouet et al. [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
    </sec>
    <sec id="Sec29">
      <title>Preparation of single-cell suspension from EAC organoids and scRNA-seq</title>
      <p id="Par85">Organoid samples were dissociated using TrypLE for 10 min at 37°C. The melted suspension was then transferred to a non-adherent 6-well plate and visualized using a bright field microscope. Single organoids were then picked using a pipet and transferred to a 96-well plate. Two hundred microliters of TrypLE was added to each well containing a single organoid and incubated for 20 min at 37°C. Then, 200μL of cold fresh Advanced DMEM/ F12 medium was added and then the plate was spun down at 4°C. The 96-well plate was then placed on ice and each pellet was resuspended in 100 μL cold fresh Advanced DMEM/F12 containing 10 μM of ROCK inhibitor (R&amp;D Systems, USA). The cell suspension was then filtered through a 40-μm cell strainer and stored on ice. Samples were processed using the 10X genomics Chromium V2 3′-dscRNA-seq kit as per the manufacturer’s instructions using an input of 5000 cells. The 10X libraries were sequenced using an Illumina HiSeq 2500 or NextSeq sequencing machine following the manufacturer’s directions.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec30">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2364_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: Supplementary tables</bold>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2364_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Supplementary figures</bold>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2021_2364_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Sangeetha N Kalimuthu for feedback regarding the paper. We would also like to thank the Princess Margaret Cancer Center Genomics Core where dscRNA-seq samples were processed.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par86">The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par87">Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Conception and design of the study: GWW and JCY; design and implementation of scSNV: GWW; computational analysis of the manuscript data: GWW; manuscript drafting: GWW and JCY; esophageal adenocarcinoma sample collection: JCY and GED; and esophageal adenocarcinoma sample processing, organoid growth, and scRNA-seq sample processing: MD. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study was partially funded by a Thoracic Surgery Foundation Research Award to JCY.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>scSNV is open source, multithreaded and implemented in C++ and available under the MIT license on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/GWW/scsnv">https://github.com/GWW/scsnv</ext-link> [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    <p>The exact version of the source code used in this manuscript is available at 10.5281/zenodo.4458260 [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
    <p>Seventeen of the samples analyzed in this study are publicly available. Nine with matched WGS data through the Human Cell Atlas Data Coordination Platform and NCBI BIOPROJECT access code PRJEB31843 [<xref ref-type="bibr" rid="CR18">18</xref>], three from the 10X genomics website [<xref ref-type="bibr" rid="CR39">39</xref>], and five from the Genome Sequence Archive project PRJCA001063 [<xref ref-type="bibr" rid="CR19">19</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 for specific sample IDs). The five esophageal adenocarcinoma organoid dscRNA-seq samples generated for this analysis and previously published matched exome sequencing data are available through EGA at EGAD00001007525 [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par88">The study was approved by the University Health Network Ethics Board (REB#36616 and CAPCR#14-8514.5). Endoscopic and resected samples were collected from consenting EAC patients. Written informed consent was obtained from all participants at enrollment. Finally, all experimental methods were in accordance with the Helsinki Declaration.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par89">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poirion</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ching</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Garmire</surname>
            <given-names>LX</given-names>
          </name>
        </person-group>
        <article-title>Using single nucleotide variations in single-cell RNA-seq to identify subpopulations and genotype-phenotype linkage</article-title>
        <source>Nat Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>4892</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07170-5</pub-id>
        <?supplied-pmid 30459309?>
        <pub-id pub-id-type="pmid">30459309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Subramaniam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Targ</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maliskova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>
        <source>Nat Biotechnol.</source>
        <year>2017</year>
        <volume>36</volume>
        <issue>1</issue>
        <fpage>89</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4042</pub-id>
        <pub-id pub-id-type="pmid">29227470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Wijst</surname>
            <given-names>MGP</given-names>
          </name>
          <name>
            <surname>Brugge</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>de Vries</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Deelen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Swertz</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Franke</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing identifies celltype-specific cis-eQTLs and co-expression QTLs</article-title>
        <source>Nat Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>4</issue>
        <fpage>493</fpage>
        <lpage>497</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0089-9</pub-id>
        <?supplied-pmid 29610479?>
        <pub-id pub-id-type="pmid">29610479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sanes</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell.</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-016-0009-6</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A review of somatic single nucleotide variant calling algorithms for next-generation sequencing data</article-title>
        <source>Comput Struct Biotechnol J.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>15</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2018.01.003</pub-id>
        <?supplied-pmid 29552334?>
        <pub-id pub-id-type="pmid">29552334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sudbery</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Alevin efficiently estimates accurate gene abundances from dscRNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>65</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1670-y</pub-id>
        <?supplied-pmid 30917859?>
        <pub-id pub-id-type="pmid">30917859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Melsted P, Booeshaghi AS, Liu L, Gao F, Lu L, Min KH (Joseph), et al. Modular, efficient and constant-memory single-cell RNA-seq preprocessing. Nat Biotechnol. 2021. p. 1–6.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>ÅK</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Full-length RNA-seq from single cells using Smart-seq2</article-title>
        <source>Nat Protoc.</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>171</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2014.006</pub-id>
        <?supplied-pmid 24385147?>
        <pub-id pub-id-type="pmid">24385147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Huang Y, McCarthy DJ, Stegle O. Vireo: Bayesian demultiplexing of pooled single-cell RNA-seq data without genotype reference. Genome Biol. 2019;20(1):273.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Heaton H, Talman AM, Knights A, Imaz M, Gaffney DJ, Durbin R, et al. Souporcell: robust clustering of single-cell RNA-seq data by genotype without reference genotypes. Nat Methods. 2020;17(6):615–20.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scheffler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Bekritsky</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Beyter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>
        <source>Nat Methods.</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>8</issue>
        <fpage>591</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0051-x</pub-id>
        <?supplied-pmid 30013048?>
        <pub-id pub-id-type="pmid">30013048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>
        <source>Bioinformatics.</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>21</issue>
        <fpage>2987</fpage>
        <lpage>2993</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id>
        <?supplied-pmid 3198575?>
        <pub-id pub-id-type="pmid">21903627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics.</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
        </person-group>
        <article-title>RNASequel: accurate and repeat tolerant realignment of RNA-seq reads</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>18</issue>
        <fpage>e122</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv594</pub-id>
        <?supplied-pmid 26082497?>
        <pub-id pub-id-type="pmid">26082497</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv:13033997 [q-bio]. 2013; Available from: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1303.3997">http://arxiv.org/abs/1303.3997</ext-link>. [cited 2020 Apr 5]</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piskol</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Lack of evidence for existence of noncanonical RNA editing</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>19</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2472</pub-id>
        <?supplied-pmid 23302925?>
        <pub-id pub-id-type="pmid">23302925</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Madissoon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wilbrey-Clark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miragaia</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Saeb-Parsy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mahbubani</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Georgakopoulos</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scRNA-seq assessment of the human lung, spleen, and esophagus tissue stability after cold preservation</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1906-x</pub-id>
        <pub-id pub-id-type="pmid">31892341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>B-F</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J-Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>YL</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>YG</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intra-tumoral heterogeneity and malignant progression in pancreatic ductal adenocarcinoma</article-title>
        <source>Cell Res.</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>9</issue>
        <fpage>725</fpage>
        <lpage>738</lpage>
        <pub-id pub-id-type="doi">10.1038/s41422-019-0195-y</pub-id>
        <?supplied-pmid 31273297?>
        <pub-id pub-id-type="pmid">31273297</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1863-4</pub-id>
        <?supplied-pmid 31744515?>
        <pub-id pub-id-type="pmid">31744515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schnepp</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>SNV identification from single-cell RNA sequencing data</article-title>
        <source>Hum Mol Genet.</source>
        <year>2019</year>
        <volume>28</volume>
        <issue>21</issue>
        <fpage>3569</fpage>
        <lpage>3583</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddz207</pub-id>
        <?supplied-pmid 31504520?>
        <pub-id pub-id-type="pmid">31504520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramaswami</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Piskol</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Accurate identification of human Alu and non-Alu RNA editing sites</article-title>
        <source>Nat Methods.</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>6</issue>
        <fpage>579</fpage>
        <lpage>581</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1982</pub-id>
        <?supplied-pmid 22484847?>
        <pub-id pub-id-type="pmid">22484847</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Auton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global reference for human genetic variation</article-title>
        <source>Nature.</source>
        <year>2015</year>
        <volume>526</volume>
        <issue>7571</issue>
        <fpage>68</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature15393</pub-id>
        <?supplied-pmid 26432245?>
        <pub-id pub-id-type="pmid">26432245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Porath</surname>
            <given-names>HT</given-names>
          </name>
          <name>
            <surname>Carmi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Levanon</surname>
            <given-names>EY</given-names>
          </name>
        </person-group>
        <article-title>A genome-wide map of hyper-edited RNA reveals numerous new sites</article-title>
        <source>Nature Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>4726</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms5726</pub-id>
        <pub-id pub-id-type="pmid">25158696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Achuthan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Akanni</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Armean</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bhai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Billis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Boddu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cummins</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dodiya</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Gall</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Girón</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Grego</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Haggerty</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Haskell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hourlier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Izuogu</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Janacek</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Juettemann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Lavidas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Loveland</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Marugán</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Maurel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Morales</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mudge</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Nuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ogeh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Patricio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Abdul Salam</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Schuilenburg</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sheppard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sparrow</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stapleton</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Szuba</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Threadgold</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Thormann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vullo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walts</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Winterbottom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zadissa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chakiachvili</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Kostadima</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Langridge</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Muffato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ruffier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Staines</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Trevanion</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Ensembl 2019</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D745</fpage>
        <lpage>D751</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1113</pub-id>
        <?supplied-pmid 30407521?>
        <pub-id pub-id-type="pmid">30407521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picardi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>D’Erchia</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lo Giudice</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pesole</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>REDIportal: a comprehensive database of A-to-I RNA editing events in humans</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>Database issue</issue>
        <fpage>D750</fpage>
        <lpage>D757</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw767</pub-id>
        <?supplied-pmid 27587585?>
        <pub-id pub-id-type="pmid">27587585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Science Forum: The Human Cell Atlas | eLife. Available from: <ext-link ext-link-type="uri" xlink:href="https://elifesciences.org/articles/27041">https://elifesciences.org/articles/27041</ext-link>. [cited 2020 Apr 5]</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <collab>1000 Genome Project Data Processing Subgroup</collab>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics.</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 2723002?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgulis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Schäffer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Agarwala</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A fast and symmetric DUST implementation to mask low-complexity DNA sequences</article-title>
        <source>J Comput Biol.</source>
        <year>2006</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>1028</fpage>
        <lpage>1040</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2006.13.1028</pub-id>
        <?supplied-pmid 16796549?>
        <pub-id pub-id-type="pmid">16796549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sudbery</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>UMI-tools: modeling sequencing errors in Unique Molecular Identifiers to improve quantification accuracy</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>491</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.209601.116</pub-id>
        <?supplied-pmid 28100584?>
        <pub-id pub-id-type="pmid">28100584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <?supplied-pmid 29409532?>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Soldatov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hochgerner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Petukhov</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA velocity of single cells</article-title>
        <source>Nature.</source>
        <year>2018</year>
        <volume>560</volume>
        <issue>7719</issue>
        <fpage>494</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id>
        <?supplied-pmid 30089906?>
        <pub-id pub-id-type="pmid">30089906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">The Human Genome Browser at UCSC. Available from: <ext-link ext-link-type="uri" xlink:href="https://genome.cshlp.org/content/12/6/996.abstract">https://genome.cshlp.org/content/12/6/996.abstract</ext-link>. [cited 2020 Apr 5]</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>The UCSC genome browser and associated tools</article-title>
        <source>Brief Bioinform.</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>144</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs038</pub-id>
        <?supplied-pmid 22908213?>
        <pub-id pub-id-type="pmid">22908213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Derouet</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Radulovich</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kalimuthu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tsao</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Yeung</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Towards personalized induction therapy for esophageal adenocarcinoma: organoids derived from endoscopic biopsy recapitulate the pre-treatment tumor</article-title>
        <source>Sci Rep.</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>14514</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-71589-4</pub-id>
        <?supplied-pmid 32884042?>
        <pub-id pub-id-type="pmid">32884042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Wilson GW, Yeung JC. scSNV source code GitHub repository. Github. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/gww/scsnv/">https://github.com/gww/scsnv/</ext-link>. Accessed 2020.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Wilson GW, Yeung JC. scSNV source code used for the manuscript. Zenodo. doi: 10.5281/zenodo.4458260</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">10X Genomics Publically Available Datasets. 10X Genomics Datasets. Available from: <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>. Accessed 2020.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Yeung</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <source>Datasets. European Genome-Phenome Archive</source>
        <year>2021</year>
      </element-citation>
    </ref>
  </ref-list>
</back>
