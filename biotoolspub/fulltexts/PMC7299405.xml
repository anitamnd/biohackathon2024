<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7299405</article-id>
    <article-id pub-id-type="pmid">32502143</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007925</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-02090</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Survey Research</subject>
            <subj-group>
              <subject>Census</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>RNA processing</subject>
              <subj-group>
                <subject>Alternative Splicing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA processing</subject>
                <subj-group>
                  <subject>Alternative Splicing</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Gene Mapping</subject>
              <subj-group>
                <subject>Exon Mapping</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Gene Mapping</subject>
            <subj-group>
              <subject>Exon Mapping</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Assessment</subject>
          <subj-group>
            <subject>Research Errors</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
                <subj-group>
                  <subject>Ganglion Cells</subject>
                  <subj-group>
                    <subject>Pyramidal Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
              <subj-group>
                <subject>Ganglion Cells</subject>
                <subj-group>
                  <subject>Pyramidal Cells</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Detecting differential alternative splicing events in scRNA-seq with or without Unique Molecular Identifiers</article-title>
      <alt-title alt-title-type="running-head">Detecting differential alternative splicing events in scRNA-seq</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4163-7166</contrib-id>
        <name>
          <surname>Hu</surname>
          <given-names>Yu</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5585-982X</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Kai</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8180-0621</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Mingyao</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Biostatistics, Epidemiology and Informatics, University of Pennsylvania Perelman School of Medicine, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Center for Cellular and Molecular Therapeutics, Children’s Hospital of Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Pathology and Laboratory Medicine, University of Pennsylvania, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Carnegie Mellon University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>mingyao@pennmedicine.upenn.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>6</issue>
    <elocation-id>e1007925</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>5</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Hu et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Hu et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007925.pdf"/>
    <abstract>
      <p>The emergence of single-cell RNA-seq (scRNA-seq) technology has made it possible to measure gene expression variations at cellular level. This breakthrough enables the investigation of a wider range of problems including analysis of splicing heterogeneity among individual cells. However, compared to bulk RNA-seq, scRNA-seq data are much noisier due to high technical variability and low sequencing depth. Here we propose SCATS (Single-Cell Analysis of Transcript Splicing) for differential splicing analysis in scRNA-seq, which achieves high sensitivity at low coverage by accounting for technical noise. SCATS models scRNA-seq data either with or without Unique Molecular Identifiers (UMIs). For non-UMI data, SCATS explicitly models technical noise by accounting for capture efficiency and amplification bias through the use of external spike-ins; for UMI data, SCATS models capture efficiency and further accounts for transcriptional burstiness. A key aspect of SCATS lies in its ability to group “exons” that originate from the same isoform(s). Grouping exons is essential in splicing analysis of scRNA-seq data as it naturally aggregates spliced reads across different exons, making it possible to detect splicing events even when sequencing depth is low. To evaluate the performance of SCATS, we analyzed both simulated and real scRNA-seq datasets and compared with existing methods including Census and DEXSeq. We show that SCATS has well controlled type I error rate, and is more powerful than existing methods, especially when splicing difference is small. In contrast, Census suffers from severe type I error inflation, whereas DEXSeq is more conservative. When applied to mouse brain scRNA-seq datasets, SCATS identified more differential splicing events with subtle difference across cell types compared to Census and DEXSeq. With the increasing adoption of scRNA-seq, we believe SCATS will be well-suited for various splicing studies. The implementation of SCATS can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/huyustats/SCATS">https://github.com/huyustats/SCATS</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Alternative splicing is a major mechanism for generating transcriptome diversity. However, few published scRNA-seq studies have investigated alternative splicing, and even when studied, methods developed for bulk RNA-seq were utilized. Compared to bulk RNA-seq, scRNA-seq data are much noisier due to high technical variability and low sequencing depth. Methods developed for bulk RNA-seq may not be optimal when analyzing data generated from scRNA-seq experiments. To fill in this gap, we developed SCATS, an open-source software package, which allows analysis of scRNA-seq data with or without Unique Molecular Identifiers (UMIs). SCATS is able to detect splicing events even when sequencing depth is low. When applied to mouse brain scRNA-seq datasets, SCATS identified more differential splicing events with subtle differences across cortical cell types than Census and DEXSeq. Additionally, SCATS accurately characterized splicing heterogeneity across cortical cell types, which was further confirmed by qRT-PCR measurements. Our study highlights the benefit of SCATS for elucidating splicing heterogeneity across cells in scRNA-seq data.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NIH R01GM108600</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8180-0621</contrib-id>
          <name>
            <surname>Li</surname>
            <given-names>Mingyao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM125301</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8180-0621</contrib-id>
          <name>
            <surname>Li</surname>
            <given-names>Mingyao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HL113147</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8180-0621</contrib-id>
          <name>
            <surname>Li</surname>
            <given-names>Mingyao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01EY030192</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8180-0621</contrib-id>
          <name>
            <surname>Li</surname>
            <given-names>Mingyao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by the following grants: NIH R01GM108600, R01GM125301, R01HL113147, R01HL150359, and R01EY030192 (to M.L.). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="0"/>
      <page-count count="19"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-06-17</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data are available from the GEO database under the following accession numbers: GSE71585: Adult mouse cortical cell taxonomy by single cell transcriptomics (Tasic et al. 2016 Nature Neuroscience) Link: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585</ext-link> Description: The adult mouse brain scRNA-seq data were acquired from Tasic et al. This data set includes 1,679 cells from 49 cell types (23 GABAergic, 19 glutamatergic and 7 non-neuronal types). GSE60361: Single-cell RNA-seq of mouse cerebral cortex Link: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60361">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60361</ext-link> Description: The adult mouse brain scRNA-seq data were generated from two regions of the mouse cerebral cortex: the somatosensory cortex and hippocampus CA1 by Zeisel et al. This data set includes 3,005 cells from 9 cell types.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data are available from the GEO database under the following accession numbers: GSE71585: Adult mouse cortical cell taxonomy by single cell transcriptomics (Tasic et al. 2016 Nature Neuroscience) Link: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585</ext-link> Description: The adult mouse brain scRNA-seq data were acquired from Tasic et al. This data set includes 1,679 cells from 49 cell types (23 GABAergic, 19 glutamatergic and 7 non-neuronal types). GSE60361: Single-cell RNA-seq of mouse cerebral cortex Link: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60361">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60361</ext-link> Description: The adult mouse brain scRNA-seq data were generated from two regions of the mouse cerebral cortex: the somatosensory cortex and hippocampus CA1 by Zeisel et al. This data set includes 3,005 cells from 9 cell types.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The emergence of scRNA-seq technology has made it possible to measure gene expression variations at cellular level. This breakthrough enables the investigation of a wide range of problems including analysis of splicing heterogeneity among individual cells. However, compared to bulk RNA-seq, scRNA-seq data are much noisier due to high technical variability, low sequencing depth, and the lack of full-length transcript sequencing for droplet-based protocols. Despite the growing popularity of scRNA-seq, few published studies have investigated alternative splicing, and even when studied, methods developed for bulk RNA-seq were utilized [<xref rid="pcbi.1007925.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1007925.ref003" ref-type="bibr">3</xref>], which may not be optimal for scRNA-seq data.</p>
    <p>Methods designed specifically for splicing analysis in non-UMI based scRNA-seq data only started to emerge recently [<xref rid="pcbi.1007925.ref004" ref-type="bibr">4</xref>]. Huang <italic>et al</italic>. [<xref rid="pcbi.1007925.ref005" ref-type="bibr">5</xref>] detects differential exon-usage by performing a pairwise comparison between every two cells, which becomes computationally infeasible when large number of cells are generated from droplet-based protocols [<xref rid="pcbi.1007925.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1007925.ref008" ref-type="bibr">8</xref>]. Song <italic>et al</italic>.[<xref rid="pcbi.1007925.ref009" ref-type="bibr">9</xref>] quantifies exon-inclusion levels based on junction-spanning reads for non-UMI based scRNA-seq data. However, these estimations are unreliable due to sparse read counts that span exon-exon junctions and technical noise of scRNA-seq data, leading to limited power in detecting DAS events. Qiu <italic>et al</italic>. [<xref rid="pcbi.1007925.ref010" ref-type="bibr">10</xref>] and Ntranos <italic>et al</italic>. [<xref rid="pcbi.1007925.ref011" ref-type="bibr">11</xref>] developed approaches to detect differential transcript usage based on pre-estimated cell-specific isoform expressions or transcript compatibility counts. Although encouraging, the feasibility of estimating isoform usage at single-cell level still remains questionable due to limited informative reads for splicing in scRNA-seq.</p>
    <p>Here we present SCATS, which achieves high sensitivity to detect DAS events in scRNA-seq by accounting for technical noise and low sequencing depth through an exon-grouping approach originally developed in PennDiff [<xref rid="pcbi.1007925.ref012" ref-type="bibr">12</xref>]. Given annotated transcript information, sequencing reads aligned to exons originated from the same isoform(s) are first grouped together (<bold><xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1A</xref></bold>). This grouping step is essential in splicing analysis of scRNA-seq data as it naturally aggregates spliced reads across different exons, making it possible to detect DAS events even for genes with low sequencing depth (<bold><xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1B</xref>, <xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1C</xref>, <xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1D</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s001">S1 Fig</xref></bold>). Moreover, SCATS can be applied to scRNA-seq data either with or without UMIs. For non-UMI data, SCATS explicitly models technical noise by accounting for capture efficiency, amplification bias and dropout events through the use of external spike-ins; for UMI data, SCATS models capture efficiency and further accounts for transcriptional burstiness in detecting DAS events between groups of cells.</p>
    <fig id="pcbi.1007925.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007925.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Workflow of SCATS.</title>
        <p><bold>(A)</bold> Exons were first divided into groups based on their isoform origin. Those exons that originate from the same isoform(s) share the same exon-inclusion level and are thus grouped together. Group 1 (blue) and group 2 (green) are informative for alternative splicing, while uninformative group (grey) is not. Within each exon group, exons were further classified to included (inclusion level = <italic>ψ</italic>) and excluded (inclusion level = 1−<italic>ψ</italic>) region. Dark blue and dark green represent included regions. Light blue and light green represent excluded regions. <bold>(B)</bold> Flow chart of exon grouping and informative read grouping algorithm. <bold>(C)</bold> Observed read counts of scRNA-seq. Gene-level read count matrix (left) and group-level informative read count matrices (right) are summarized from aligned scRNA-seq data in BAM format. <bold>(D)</bold> Given gene-level read count matrix, cell-specific technical noises and population level gene expressions are quantified using TASC [<xref rid="pcbi.1007925.ref017" ref-type="bibr">17</xref>]. Given technical parameter estimates from <bold>(C)</bold>, for each alternative spliced exon group, the statistical inference (exon-inclusion level estimation and inclusion level difference testing) on exon-inclusion levels was made based on a hierarchical model that accounts for technical noise.</p>
      </caption>
      <graphic xlink:href="pcbi.1007925.g001"/>
    </fig>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Estimation of exon-inclusion level</title>
      <p>Exon-inclusion level, which measures the relative usage of an exon, is a commonly used measure to quantify the process of alternative splicing. A critical step in DAS detection is to reliably estimate exon-inclusion levels for exons that originate from the same isoform(s). For an alternatively spliced exon <italic>e</italic>, its exon-inclusion level, <italic>x</italic><sub><italic>e</italic></sub>, is defined as the percentage of transcripts that have exon <italic>e</italic> included. Mathematically, it can be written as <inline-formula id="pcbi.1007925.e001"><alternatives><graphic xlink:href="pcbi.1007925.e001.jpg" id="pcbi.1007925.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>I</italic><sub><italic>e</italic></sub> represents the set of isoforms that have exon e included, and <italic>θ</italic><sub><italic>j</italic></sub> represents the relative abundance of isoform <italic>j</italic>. Although one can estimate the relative abundance of each inclusion isoform and then sum over the relative abundances of all inclusion isoforms to estimate <italic>x</italic><sub><italic>e</italic></sub>, this approach is inaccurate due to the extreme sparsity of scRNA-seq data. To get a more reliable estimate of <italic>x</italic><sub><italic>e</italic></sub>, we utilize splicing informative reads at the alternatively spliced exon <italic>e</italic> and those exons that are in the same exon group as exon <italic>e</italic>. This approach is more robust than estimating isoform relative abundances directly as it naturally aggregates splicing informative reads that originate from the same isoform(s) together. As shown in <bold><xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1A</xref></bold>, for each gene, alternatively spliced exons are grouped if they originate from the same isoform(s) or complementary isoform(s) (i.e. exons share the same inclusion levels or complementary inclusion levels). <bold><xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1B</xref></bold> illustrates the detailed procedure of exon grouping and the identification of informative reads for splicing.</p>
    </sec>
    <sec id="sec004">
      <title>Evaluation on simulated data</title>
      <p>To evaluate the effectiveness of exon grouping for exon-inclusion level estimation, we simulated data from a generative model (see <bold><xref ref-type="sec" rid="sec008">Material and Methods</xref></bold> for details). Our simulations indicate that SCATS’s estimates are strongly correlated with the true levels (R = 0.83), whereas naïve estimation that ignores technical noise in scRNA-seq only leads to a correlation of 0.66 (<bold><xref ref-type="fig" rid="pcbi.1007925.g002">Fig 2A</xref></bold>). We further assessed the performance of SCATS in detecting DAS events, and compared with two other state-of-the-art methods: Census [<xref rid="pcbi.1007925.ref010" ref-type="bibr">10</xref>], an algorithm designed to preprocess raw read counts by removing technical noise, and DEXSeq [<xref rid="pcbi.1007925.ref013" ref-type="bibr">13</xref>], a popular method for bulk RNA-seq splicing analysis. Specifically, Census estimates isoform expression levels first and converts them into Census RNA counts, and then fits a Dirichlet multinomial mixture model to detect differential splicing events. DEXSeq identifies differential exon usage by fitting exonic counts with a log linear regression model in which exonic counts are obtained by counting the number reads aligned to a virtual exon. Our results indicate that SCATS has well controlled type I error rates (<bold><xref ref-type="fig" rid="pcbi.1007925.g002">Fig 2B</xref>, <xref ref-type="fig" rid="pcbi.1007925.g002">Fig 2C</xref></bold>), whereas Census tends to yield false positive results with enrichment of p-values near zero, and DEXSeq is overly conservative with enrichment of p-values near one. SCATS is also more powerful than Census and DEXSeq (<bold><xref ref-type="fig" rid="pcbi.1007925.g002">Fig 2D</xref></bold>), although Census has severely inflated type I error rates. Compared to DEXSeq, SCATS performs consistently better, especially when the true exon-inclusion level difference is small. This indicates that SCATS is robust in detecting subtle splicing difference, thanks to the accurate exon inclusion-level estimation due to exon grouping and technical noise modeling.</p>
      <fig id="pcbi.1007925.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007925.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Exon-inclusion level estimation, false positive rate comparison and power comparison of simulation study.</title>
          <p>Informative read counts of 1,000 exon groups for 600 cells (300 vs 300) were simulated using a generative model shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s001">S1 Fig</xref></bold> with cell-specific technical parameters estimated from CA1 pyramidal cells in the scRNA-seq data generated by Zeisel et al. [<xref rid="pcbi.1007925.ref016" ref-type="bibr">16</xref>]. To simulate data that resemble real scRNA-seq data, one CA1 pyramidal cell was randomly selected and read coverage for each gene in that cell was used to obtain true gene concentration at the population level (<inline-formula id="pcbi.1007925.e002"><alternatives><graphic id="pcbi.1007925.e002g" xlink:href="pcbi.1007925.e002"/><mml:math id="M2"><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:mn>100,000</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>). Based on the generative model accounting for technical noise, we generated 6,000 reads on average for each cell. <bold>(A)</bold> Scatter plots of 1,842 true exon-inclusion levels, estimated by percent spliced in (PSI) for a given exon, against estimates from SCATS and a naïve method that ignores technical noise. SCATS models technical noise to quantify usage of an alternatively spliced exon while the naïve method simply estimates the inclusion level by <inline-formula id="pcbi.1007925.e003"><alternatives><graphic id="pcbi.1007925.e003g" xlink:href="pcbi.1007925.e003"/><mml:math id="M3"><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, where <italic>Y</italic><sub>+</sub> and <italic>Y</italic><sub>−</sub> are the informative read counts of the “+” and “-” exon groups across cells. SCATS estimates are closer to the ground truth. <bold>(B)</bold> Quantile-quantile plots of the p-values from SCATS, Census and DEXSeq under the null hypothesis (Δ = 0). X-axis represents uniform theoretical quantiles between 0 and 1 in –log<sub>10</sub> scale. Y-axis represents observed p-value quantile in –log<sub>10</sub> scale. Uniformly distributed data should follow the red dashed line. P-values of SCATS are more uniformly distributed while those from Census are right-skewed and those from DEXSeq are left-skewed. <bold>(C)</bold> Type I error comparison of SCATS, Census and DEXSeq with different significance levels (α = 0.05, 0.01, 0.005). Similar to <bold>(B)</bold>, SCATS has better type I error control than Census and DEXSeq. <bold>(D)</bold> Power comparison of SCATS, Census and DEXSeq. Barplots show the estimated power under different effect sizes (Δ = 0.1,0.2,0.3,0.4), where significance was evaluated at 0.05, 0.01, and 0.005 levels, respectively. Colors indicate different methods. SCATS outperformed Census and DEXSeq across all effect sizes, especially when Δ = 0.1. DEXSeq is conservative in detecting DAS events.</p>
        </caption>
        <graphic xlink:href="pcbi.1007925.g002"/>
      </fig>
      <p>The above simulations generated data assuming the same model underlying SCATS. To make a fair comparison, we designed a new simulator to generate an <italic>in silico</italic> library for a single cell (see <bold><xref ref-type="sec" rid="sec008">Material and Methods</xref></bold> for details). This simulator does not make any parametric assumptions on gene expression across cells. Results for data generated from this new simulation scheme are shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s002">S2 Fig</xref></bold>, which indicate that SCATS has well controlled type I error rates (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s002">S2A Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007925.s002">S2B Fig</xref></bold>), whereas Census tends to yield false positive results with enrichment of p-values near zero, and DEXSeq is overly conservative with enrichment of p-values near one. SCATS is also more powerful than Census and DEXSeq (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s002">S2C Fig</xref></bold>). These results are consistent with what we observed in the original parametric simulation scheme.</p>
      <p>To evaluate the impact of novel isoforms, we conducted a simulation study to test the robustness of SCATS to under-annotation, that is, some of the novel isoforms are not included in the annotation. Specifically, we simulated scRNA-seq read counts based on 100% Ensembl annotated isoforms and analyzed the data with SCATS using 100%, 75% and 50% of the annotated isoforms. <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s003">S3 Fig</xref></bold> shows the power comparison results under different degrees of under-annotation across different significance levels and effect sizes. SCATS is robust to under-annotation in all scenarios especially when effect size was large. Compared to full annotation, when only using 50% of the annotated isoforms in analysis, the power of SCATS only decreased by 4% on average across different significance levels. These results indicate the robustness of SCATS to isoform annotation. Similarly, we evaluated the impact of exon group length on SCATS. As shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s004">S4 Fig</xref></bold>, all different length groups have well controlled type-I error rate when effect size equals to 0 and SCATS is more powerful as exon group length increased. This matches our expectation and demonstrates the improved performance of SCATS by grouping exons to account for read sparsity in scRNA-seq.</p>
      <p>Moreover, we conducted a pseudo-bulk simulation by pooling scRNA-seq data from 300 cells in each group to compare this pseudo-bulk approach with SCATS. Since there is only one sample in each condition in the pseudo-bulk data, we cannot perform statistical tests. Therefore, we examined differential splicing by fold change (FC). We considered two significance thresholds of average fold change for analysis based on the pseudo-bulk data: FC&gt;1.2 and FC&gt;1.5. For the pseudo-bulk approach, the power is calculated as the proportion of exon groups with FC&gt;1.2 or 1.5 among exon groups with differential splicing and the type-I error is calculated as the proportion of exon groups with FC&gt;1.2 or 1.5 among exon groups with no splicing difference. As shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s005">S5 Fig</xref></bold>, SCATS has higher power for FC&gt;1.5 across all scenarios, especially when effect sizes are relatively small. SCATS and FC&gt;1.5 both have well controlled type-I error rate. When effect size is greater than 0.2, FC&gt;1.2 is more powerful than SCATS. However, FC&gt;1.2 has severely inflated type-I error rate. These results demonstrate the benefit of SCATS over pseudo-bulk approach in detecting inclusion-level difference of scRNA-seq data.</p>
    </sec>
    <sec id="sec005">
      <title>Application to Tasic <italic>et al</italic>. data</title>
      <p>Next, we applied SCATS to a scRNA-seq dataset generated from adult mouse brains, which includes 1,679 cells generated using the SMART-seq protocol (Tasic <italic>et al</italic>. dataset [<xref rid="pcbi.1007925.ref003" ref-type="bibr">3</xref>]) (see details in <bold><xref ref-type="sec" rid="sec008">Methods</xref></bold>). This dataset includes three major cell classes and 49 sub-cell types (23 GABAergic cell types, 19 glutamatergic cell types, and seven non-neuronal cell types). Major cell classes and sub cell types reported in the original publication were treated as ground truth to evaluate SCATS in characterizing splicing heterogeneity across cells. This dataset is non-UMI based but read counts from 92 ERCC spike-ins are available, which allow us to quantify technical variations. To assess the accuracy of exon-inclusion level estimation of SCATS, we selected two consecutive alternatively spliced exons (flip-flop exons [<xref rid="pcbi.1007925.ref014" ref-type="bibr">14</xref>]) from two Glutamate receptor genes <italic>Gria1</italic> and <italic>Gria2</italic> (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s006">S6A Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007925.s006">S6B Fig</xref></bold>), which have been reported to display a highly variable splicing pattern across cell types [<xref rid="pcbi.1007925.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1007925.ref014" ref-type="bibr">14</xref>]. These flip-flop exons are complementary with each other, and each single one is included in a different mature RNA. Sommer <italic>et al</italic>. [<xref rid="pcbi.1007925.ref014" ref-type="bibr">14</xref>] measured the expression levels of the flip and flop exons, respectively, with RNA <italic>in situ</italic> hybridization (ISH). Their findings showed that the flip exon was preferentially utilized in layer II/III of neocortex as compared to the flop exon, whereas both exons were equally expressed in layer VI of neocortex. To evaluate the exon usage quantification of SCATS, we estimated cell type-specific exon-inclusion level of the flip exon. As shown in <bold><xref ref-type="fig" rid="pcbi.1007925.g003">Fig 3A</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1007925.g003">Fig 3B</xref></bold>, the estimated exon-inclusion levels of the flip exon in cell types L2-Ngb (layer II) and L2/3-Ptgs2 (layer II/III) are over 80%, whereas the estimates are around 50% in cell type L6a (layer VI) (<italic>Gria1</italic>: <inline-formula id="pcbi.1007925.e004"><alternatives><graphic xlink:href="pcbi.1007925.e004.jpg" id="pcbi.1007925.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></alternatives></inline-formula> and <italic>Gria2</italic>: <inline-formula id="pcbi.1007925.e005"><alternatives><graphic xlink:href="pcbi.1007925.e005.jpg" id="pcbi.1007925.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.46</mml:mn></mml:math></alternatives></inline-formula>). These results are consistent with RNA ISH measurements in Sommer <italic>et al</italic>. [<xref rid="pcbi.1007925.ref014" ref-type="bibr">14</xref>].</p>
      <fig id="pcbi.1007925.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007925.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>DAS analysis results of the Tasic <italic>et al</italic>. data.</title>
          <p><bold>(A,B)</bold> Exon-inclusion level quantification of flip and flop exons from gene <italic>Gria1</italic> and <italic>Gria2</italic> using SCATS. Barplots show exon-inclusion level estimates of the flip exon from gene <italic>Gria1</italic>
<bold>(A)</bold> and <italic>Gria2</italic>
<bold>(B)</bold> across different cell types. Colors indicate different cell types. These estimates agree well with low-resolution RNA ISH data. <bold>(C-E)</bold> Pairwise DAS comparison across GABAergic cell types from mouse cortex using SCATS <bold>(C)</bold>, Census <bold>(D)</bold> and DEXSeq <bold>(E)</bold>. Colors indicate different GABAergic cell types, and purple, yellow, and red indicate three sub cell classes. Heatmaps show the proportion of detected DAS exon groups (SCATS) or DAS exons (Census and DEXSeq) for each pairwise comparison between cell types based on 296 genes identified by Tasic <italic>et al</italic>. using MISO. Dendrograms show cell classification results of the 17 GABAergic cell types. The distance metric between two cell types is the proportion of detected DAS exon groups by SCATS <bold>(A)</bold>, DAS exons by Census <bold>(B)</bold> and DEXSeq <bold>(C)</bold>. SCATS outperformed Census and DEXSeq in detecting splicing heterogeneity across different cell types, while controlling false positive rate.</p>
        </caption>
        <graphic xlink:href="pcbi.1007925.g003"/>
      </fig>
      <p>Encouraged by the accurate exon-inclusion estimates, we next conducted a pairwise DAS analysis across all 49 sub-cell types based on 296 most differentially spliced genes (with 966 exon groups) selected by Tasic <italic>et al</italic>. using MISO [<xref rid="pcbi.1007925.ref015" ref-type="bibr">15</xref>], a popular method developed for splicing analysis in bulk RNA-seq data. <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s007">S7 Fig</xref></bold> shows the quantile-quantile (QQ) plots of the log-transformed p-values from pairwise comparisons of different sub-cell types, which include sub-cell type comparisons both within major cell classes and cross major cell classes. For tests within GABAergic, glutamatergic and non-neurons, the p-values from SCATS are distributed slightly below the red diagonal line until when the significance level <italic>α</italic> reaches to 0.01. This pattern is consistent with the QQ plot shown in the simulations <bold>(<xref ref-type="fig" rid="pcbi.1007925.g002">Fig 2B</xref>)</bold>. In contrast, there is a sharp deviation from the diagonal line at <italic>α</italic> = 10<sup>−1.5</sup> for all three cross-major cell class subsets, indicating that more DAS events were detected at less stringent significance thresholds. This is not surprising because more DAS exons are expected to be detected between sub-cell types from different major cell classes compared to sub-cell types that originate from the same major cell class. <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s008">S8A Fig</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s008">S8B Fig</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s012">S12 Fig</xref></bold> show DAS heterogeneity revealed by SCATS across the 49 sub-cell types based on the 966 exon groups in these 296 genes. The heatmap shows three clusters, consistent with the three labeled major cell classes: GABAergic, glutamatergic, and non-neuronal. Although this pattern was also revealed by MISO analysis in Tasic <italic>et al</italic>., SCATS results revealed more heterogeneous splicing patterns within each major cell class than MISO, demonstrating its higher sensitivity in detecting splicing heterogeneity.</p>
      <p>For GABAergic cells, Tasic <italic>et al</italic>. conducted a hierarchical clustering analysis based on qRT-PCR measurements obtained from 79 marker genes for GABAergic sub-cell types. These cells were classified into three sub-clusters. To further assess the accuracy of SCATS in profiling splicing heterogeneity, we treated these qRT-PCR based clustering result as ground truth and asked whether SCATS can reveal this sub-clustering structure from its detected DAS events. MISO results in Tasic <italic>et al</italic>. showed homogenous DAS pattern across GABAergic cells with no cell subpopulations being clustered together. Heatmaps in <bold><xref ref-type="fig" rid="pcbi.1007925.g003">Fig 3C</xref></bold>, <bold><xref ref-type="fig" rid="pcbi.1007925.g003">Fig 3D</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1007925.g003">Fig 3E</xref></bold> show DAS analysis results of the 480 GABAergic cells using SCATS, Census and DEXSeq, respectively. The three sub-clusters (purple, orange, red) were identified by SCATS but missed by Census and DEXSeq. Specifically, SCATS clearly revealed different cell types in the heatmap (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s008">S8A Fig</xref></bold>). However, Census suffers from severely inflated type I error rate in which most of the pairwise DAS proportions are greater than 40% in <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s008">S8C Fig</xref></bold>, which agrees with simulation results shown in <bold><xref ref-type="fig" rid="pcbi.1007925.g002">Fig 2</xref></bold>. Moreover, the dendrogram of SCATS shows that the purple cell types were separated from yellow and red cell types at the first level of the hierarchical clustering tree, whereas the yellow and red cell types were grouped together at the first level of the tree, indicating that the yellow and red cell types are more similar to each other than to the purple cell types. This pattern is consistent with the hierarchical clustering analysis based on the qRT-PCR measurements by Tasic <italic>et al</italic>. These results demonstrate the high sensitivity of SCATS in detecting DAS among closely related cells from the same major cell class. Additionally, we generated a sashimi plot using IGV to validate the detected DAS exons by SCATS. <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s009">S9 Fig</xref></bold> shows the empirical evidence of a DAS event at the flip-flop exons between Sst-Cdk6 and Sst-Cbln4 for gene <italic>Gria1</italic>, which is consistent with SCATS (<italic>P</italic> = 0.018).</p>
      <p>We also analyzed a larger dataset that includes 6,275 genes with 12,073 exon groups that met the analysis criteria. The patterns are overall similar to what we observed for the 296 most differentially spliced genes selected by Tasic <italic>et al</italic>. using MISO (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s010">S10 Fig</xref></bold>).</p>
    </sec>
    <sec id="sec006">
      <title>Application to Zeisel <italic>et al</italic>. data</title>
      <p>Although designed primarily to detect DAS events in full-length transcript scRNA-seq data, SCATS can also detect DAS events for UMI data, which typically only contain sequences from the 3’ or 5’ end of a transcript. Due to the sparsity of splicing informative UMI counts, few methods are able to detect DAS events in UMI-based scRNA-seq data. To evaluate the performance of SCATS when full-length transcript information is not available, we analyzed the Zeisel <italic>et al</italic>. dataset [<xref rid="pcbi.1007925.ref016" ref-type="bibr">16</xref>], which are UMI-based data generated from 3,005 cells in mouse cortex. This dataset includes nine major cell classes and 47 sub-cell types. We performed DAS analysis on 1,826 marker genes (3,542 exon groups) for these nine major cell classes across the 47 sub-cell types in this dataset. Since UMI counts were consolidated from non-UMI reads, we compared read count distributions between UMI and non-UMI data. Not surprisingly, splicing informative read counts in UMI data are much sparser than non-UMI data (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s011">S11A Fig</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s011">S11B Fig</xref></bold>), making it challenging to detect DAS in UMI data. However, by exon grouping and appropriate statistical modeling, SCATS is able to detect DAS even with such sparse data. <bold><xref ref-type="fig" rid="pcbi.1007925.g004">Fig 4A</xref></bold> (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s013">S13 Fig</xref></bold>) shows the heatmap of the proportions of the detected DAS events for each pairwise comparison by SCATS. Neuronal cells are clearly differentiated from non-neuronal cells, although some major cell classes (marked by single colors) cannot be discerned from this heatmap. To better understand these results, we treated the proportions of significant DAS exons for each pairwise comparison as a similarity metric and performed hierarchical clustering analysis as shown in <bold><xref ref-type="fig" rid="pcbi.1007925.g004">Fig 4B</xref></bold>. For SCATS, the separation in neuron cells agrees well with labeled cell types, with only one CA1 Pyramidal cell type (ClauPyr) misclassified as Interneurons. For non-neuronal cells, SCATS clearly separated the Oligodendrocytes and Astrocytes cell classes from others, with four labels in Ependyma, Microglia and Mural misclassified. These clustering results demonstrate the reliability of DAS detections across cell types using SCATS even when splicing informative read counts are sparse. We also conducted similar analyses using MISO, Census and DEXSeq. Census may yield more false positive results because it detected more than 40% DAS events across most pairwise comparisons, even for those comparisons within major cell classes (<bold><xref ref-type="fig" rid="pcbi.1007925.g004">Fig 4C</xref></bold>, <bold><xref ref-type="fig" rid="pcbi.1007925.g004">Fig 4D</xref></bold>). In contrast, DEXSeq and MISO missed most of the DAS events and the hierarchical clustering analysis failed to separate different major cell classes for both neurons and non-neurons (<bold><xref ref-type="fig" rid="pcbi.1007925.g004">Fig 4E</xref></bold>, <bold><xref ref-type="fig" rid="pcbi.1007925.g004">Fig 4F</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s011">S11C Fig</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s011">S11D Fig</xref></bold>). This is not surprising as splicing informative molecule counts in UMI-based scRNA-seq data are extremely sparse, and methods developed for bulk RNA-seq data are not optimal when analyzing such data. It is worth noting that splicing quantification offers higher resolution of cellular heterogeneity than total gene expression. As shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s011">S11E Fig</xref></bold>, exon-inclusion levels showed more distinct patterns across cell types for gene <italic>Gria1</italic> than total gene expression.</p>
      <fig id="pcbi.1007925.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007925.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>DAS analysis results of the Zeisel <italic>et al</italic>. data.</title>
          <p><bold>(A-F)</bold> Pairwise DAS comparison across 3,005 cells (nine major cell types) from mouse cortex and hippocampus using SCATS <bold>(A,B)</bold>, Census <bold>(C,D)</bold> and DEXSeq <bold>(E,F)</bold>. Colors indicate nine major cell types. <bold>(A,C,E)</bold> Heatmaps showing the proportion of detected DAS events from 1,826 genes for each pairwise comparison between cell types. <bold>(B,D,F)</bold> Dendrograms showing cell classification results of the 47 sub cell types. The distance metric between two cell types is the proportion of detected DAS exons groups for SCATS <bold>(B)</bold>, and DAS exons for Census <bold>(D)</bold> and DEXSeq <bold>(F)</bold>. This dataset shows highly cell type-specific alternative splicing pattern.</p>
        </caption>
        <graphic xlink:href="pcbi.1007925.g004"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec007">
    <title>Discussion</title>
    <p>Detection of mis-regulated alternative splicing events is a critical step towards the understanding of association between isoform variations and disease. scRNA-seq data offer new insights into alternative splicing at cellular level, which helps us to understand cellular heterogeneity with higher resolution as compared to bulk RNA-seq. However, low sequencing depth and technical noise have precluded the investigation of splicing heterogeneity in most scRNA-seq studies. Several approaches have been developed to detect differential alternative splicing for scRNA-seq data. However, these methods either ignore technical noise or perform statistical tests based on unreliable isoform/exon usage estimates. To fill in such knowledge gap, we developed SCATS, which utilizes informative read counts at exon group level to achieve high sensitivity in DAS detection. By grouping exons that originate from the same isoform(s) and modeling of technical noise, SCATS aggregates spliced reads across different exons, making it possible to detect splicing events in scRNA-seq. Through simulations, we have shown that SCATS yields more accurate quantification of exon-inclusion levels than a method that utilizes empirical junction reads directly and is more powerful in detecting DAS events compared to existing methods.</p>
    <p>Accurate quantification of exon-inclusion levels is critical for DAS detection. To estimate exon-inclusion levels more accurately, SCATS corrects local heterogeneity of read coverage to improve DAS detection accuracy. In particular, 3’ bias of UMI-based scRNA-seq data leads to most reads being distributed to the 3’ end of an isoform, which complicates exon-inclusion level quantification and detection of DAS events for exons that are far away from the 3’ end. SCATS models this non-uniform read distribution in a non-parametric manner, which upweights 3’ end in the model to remove 3’ sequencing bias of UMI-based scRNA-seq data. This bias correction together with exon grouping in SCATS makes it possible to detect DAS events at the 5’ end even when few reads are mapped to that region.</p>
    <p>Although SCATS showed promising performance compared to existing methods, we note that SCATS cannot be applied to estimate isoform expression at cellular level because most next-generation sequencing (NGS) reads are too short to capture unique sequences for each isoform. In a typical scRNA-seq dataset generated using NGS, the number of splicing informative reads in each cell is extremely small, and in many situations is even less than the number of isoforms in Ensembl or Gencode annotation. The extreme sparsity of data and the lack of reads capturing an entire transcript prohibit the estimation of isoform-specific gene expression in a single cell. To address this issue, we are currently exploring scRNA-seq data generated using long-read sequencing technologies such as Nanopore and PacBio, to estimate isoform expression in each cell and to detect differential usage of isoforms.</p>
    <p>In summary, we have developed a robust approach to detect DAS events by accounting for both technical noise and biological variations such as transcriptional bursting across single cells. Through simulation studies and real data analyses, we showed that SCATS outperformed existing methods in detecting DAS events for both UMI and non-UMI scRNA-seq data. With the increasing adoption of scRNA-seq, we believe SCATS will be well-suited for various splicing studies and offer additional insights beyond total gene expression analysis.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec008">
    <title>Materials and methods</title>
    <sec id="sec009">
      <title>Splicing informative read counts based on exon grouping</title>
      <p>To get informative reads for DAS analysis, we pre-process sorted isoform annotation file in GTF format and sorted aligned scRNA-seq data in SAM format. For each gene, alternatively spliced exons are grouped if they originate from the same isoform(s) or complementary isoform(s) (i.e. exons share the same inclusion levels or complementary inclusion levels). Suppose the gene under consideration has <italic>M</italic> exon groups, then all reads mapped to this gene can be grouped into 2<italic>M</italic>+1 categories: 1) uninformative reads: reads that map to exons shared by all isoforms of the gene; 2) included (+) informative reads of exon group <italic>j</italic>: reads mapped to alternatively spliced (AS) exons that are included in exon group <italic>j</italic> (1≤<italic>j</italic>≤<italic>M</italic>); and 3) excluded (-) informative reads of exon group <italic>j</italic>: reads mapped to AS exons that are excluded from exon group <italic>j</italic> (1≤<italic>j</italic>≤<italic>M</italic>).</p>
      <p>Let <bold><italic>Y</italic></bold><sub><bold><italic>i</italic></bold></sub> = (<italic>Y</italic><sub><italic>i</italic>0</sub>,<italic>Y</italic><sub>+<italic>i</italic>1</sub>,…,<italic>Y</italic><sub>+<italic>iM</italic></sub>,<italic>Y</italic><sub><italic>−i</italic>1</sub>,…,<italic>Y</italic><sub><italic>−iM</italic></sub>) be the observed read counts in cell <italic>i</italic> for the gene, where <italic>Y</italic><sub><italic>i</italic>0</sub> denotes uninformative read count, <italic>Y</italic><sub>+<italic>ij</italic></sub> denotes included informative read count of exon group <italic>j</italic>, and <italic>Y</italic><sub>−<italic>ij</italic></sub> denotes excluded informative read count of exon group <italic>j</italic>. <bold><xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1A</xref></bold> shows an example of how exons are grouped and informative reads are counted. For this hypothetical gene, there are three isoforms constructed by five exons, where three of them are alternatively spliced and grouped into two groups (blue and green). Among the seven mapped reads, reads 1 and 6 are uninformative reads (<italic>Y</italic><sub>+<italic>i</italic>0</sub> = 2), read 2 is an informative read included in exon group 1 (<italic>Y</italic><sub>+<italic>i</italic>1</sub> = 1), reads 3 and 4 are informative reads excluded from group 1 (<italic>Y</italic><sub>+<italic>i</italic>0</sub> = 2), read 5 is an informative read included in exon group 2 (<italic>Y</italic><sub>+<italic>i</italic>2</sub> = 1), and read 7 is an informative read excluded from group 2 (<italic>Y</italic><sub>−<italic>i</italic>2</sub> = 1). <bold><xref ref-type="fig" rid="pcbi.1007925.g001">Fig 1B</xref></bold> shows a workflow that describes how exon grouping and informative read extraction are implemented in SCATS.</p>
    </sec>
    <sec id="sec010">
      <title>Modeling splicing informative UMI and non-UMI counts</title>
      <p>SCATS is designed to detect DAS events at exon group level. For the ease of notation, we drop the exon group index. For a given exon group of interest, let <italic>ψ</italic> be the inclusion level of an included (+) exon group and <italic>θ</italic><sub><italic>g</italic></sub> be the mean expression of gene <italic>g</italic>. To account for cell-specific technical noise, we model splicing informative read counts <italic>Y</italic><sub>+<italic>i</italic></sub> and <italic>Y</italic><sub>−<italic>i</italic></sub> using a hierarchical model (<bold><xref ref-type="supplementary-material" rid="pcbi.1007925.s001">S1 Fig</xref></bold>). We assume cell-specific true expression level of the included/excluded exon group <italic>μ</italic><sub>+<italic>i</italic></sub>/<italic>μ</italic><sub>−<italic>i</italic></sub> follows a log-normal distribution:
<disp-formula id="pcbi.1007925.e006"><alternatives><graphic xlink:href="pcbi.1007925.e006.jpg" id="pcbi.1007925.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mi>ψ</mml:mi><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007925.e007"><alternatives><graphic xlink:href="pcbi.1007925.e007.jpg" id="pcbi.1007925.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:mo>)</mml:mo><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where <italic>h</italic><sub>+</sub>/<italic>h</italic><sub>−</sub> represents the probability of included/excluded reads being informative and <inline-formula id="pcbi.1007925.e008"><alternatives><graphic xlink:href="pcbi.1007925.e008.jpg" id="pcbi.1007925.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is variance of expression level in log scale.</p>
      <p>For non-UMI count, amplification bias and low capture efficiency in scRNA-seq are quantified by a linear model. Specifically, for cell <italic>i</italic>, the expected value of the informative read count <italic>λ</italic><sub>+<italic>i</italic></sub>/<italic>λ</italic><sub>−<italic>i</italic></sub> is modeled as
<disp-formula id="pcbi.1007925.e009"><alternatives><graphic xlink:href="pcbi.1007925.e009.jpg" id="pcbi.1007925.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007925.e010"><alternatives><graphic xlink:href="pcbi.1007925.e010.jpg" id="pcbi.1007925.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>α</italic><sub><italic>i</italic></sub> and <italic>β</italic><sub><italic>i</italic></sub> are cell-specific technical parameters designed to model capture efficiency and amplification bias, respectively. These technical parameters can be quantified with TASC[<xref rid="pcbi.1007925.ref017" ref-type="bibr">17</xref>] when ERCC spike-ins are provided.</p>
      <p>For UMI count, cell-specific parameter <italic>β</italic><sub><italic>i</italic></sub> is equal to 1 as amplification bias can be alleviated by UMI. Therefore, the expected informative UMI count <italic>λ</italic><sub>+<italic>i</italic></sub>/<italic>λ</italic><sub>−<italic>i</italic></sub> is proportional to true expression of the included/excluded exon group:
<disp-formula id="pcbi.1007925.e011"><alternatives><graphic xlink:href="pcbi.1007925.e011.jpg" id="pcbi.1007925.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula></p>
      <p>Moreover, we account for inflated zeros of scRNA-seq which are primarily sourced from two contributing factors: technical dropout and transcriptional bursting. Dropout happens when a particular transcript is lost in scRNA-seq experimental steps while the gene is expressed in the cell. Also, excessive zero counts can be introduced when significant bursting genes are in “off” state due to transcriptional heterogeneity. Previous studies have shown that the modeling of dropout in UMI data is unnecessary[<xref rid="pcbi.1007925.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1007925.ref019" ref-type="bibr">19</xref>]. Therefore, to model zero inflation, for a given gene, we let <italic>Z</italic><sub><italic>i</italic></sub> be the indicator that the gene in cell <italic>i</italic> is captured in the library (dropout does not happen) and it is in the “on” state. The probability of <italic>Z</italic><sub><italic>i</italic></sub> = 1 is <italic>π</italic><sub><italic>i</italic></sub>. Therefore, given <italic>λ</italic><sub>+<italic>i</italic></sub> and <italic>λ</italic><sub>−<italic>i</italic></sub>, the distribution of the observed informative UMI count <italic>Y</italic><sub>+<italic>i</italic></sub>/<italic>Y</italic><sub>−<italic>i</italic></sub> is
<disp-formula id="pcbi.1007925.e012"><alternatives><graphic xlink:href="pcbi.1007925.e012.jpg" id="pcbi.1007925.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">Poisson</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="0.12em"/><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="5.25em"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="0.12em"/><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
and
<disp-formula id="pcbi.1007925.e013"><alternatives><graphic xlink:href="pcbi.1007925.e013.jpg" id="pcbi.1007925.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">Poisson</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.12em"/><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="5.25em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.12em"/><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
where Poisson distribution has been reported to approximate the UMI sampling process well after zero inflation being removed[<xref rid="pcbi.1007925.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1007925.ref019" ref-type="bibr">19</xref>].</p>
    </sec>
    <sec id="sec011">
      <title>Probability of included/excluded reads being informative</title>
      <p>Another key part of SCATS is to estimate <italic>h</italic><sub>+</sub>/<italic>h</italic><sub>−</sub>, the probability of included/excluded reads being splicing informative. From the isoform structure of gene <italic>g</italic>, we can determine the origin (exon group) of a read (being informative read) only when it is mapped to exon-exon junction or an alternatively spliced exon. Thus, a natural way to estimate the probability that a read being mapped to this region is to calculate the ratio between weighted length of the informative region and the whole region. Due to low sequencing depth of scRNA-seq data, we assume the exon group shares the same <italic>h</italic><sub>+</sub>/<italic>h</italic><sub>−</sub> across cells instead of estimating cell-specific parameters:
<disp-formula id="pcbi.1007925.e014"><alternatives><graphic xlink:href="pcbi.1007925.e014.jpg" id="pcbi.1007925.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007925.e015"><alternatives><graphic xlink:href="pcbi.1007925.e015.jpg" id="pcbi.1007925.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula>
where <italic>I</italic><sub>+</sub> and <italic>I</italic><sub>−</sub> denote the set of isoforms in the included and excluded group, respectively, <italic>I</italic> denotes the set of all isoforms in gene <italic>g</italic>, <inline-formula id="pcbi.1007925.e016"><alternatives><graphic xlink:href="pcbi.1007925.e016.jpg" id="pcbi.1007925.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denotes the set of informative base pair positions of isoform <italic>d</italic>, and <italic>S</italic><sub><italic>d</italic></sub> denotes the set of all base pair positions of isoform <italic>d</italic>. To calculate weighted lengths of the region, we utilize observed read coverage <italic>w</italic><sub><italic>s</italic></sub> at base pair position <italic>s</italic> and relative abundance <italic>θ</italic><sub><italic>d</italic></sub> of isoform <italic>d</italic> which is estimated based on informative reads. Therefore, the numerator represents the weighted length of informative region for included exon group (+) and excluded exon group (-), respectively, and the denominator represents the weighted length of whole region in gene <italic>g</italic>.</p>
    </sec>
    <sec id="sec012">
      <title>Detection of differential alternative splicing exon group</title>
      <p>Exon-inclusion level, which measures the relative usage of an exon, is a commonly used measure to quantify the alternative splicing process. To detect DAS exons, we can examine if the inclusion level of exon group (<italic>ψ</italic>) is significantly different between two groups of cells. To make accurate inference on the inclusion level difference, technical parameters (<italic>α</italic><sub><italic>i</italic></sub>, <italic>β</italic><sub><italic>i</italic></sub>) for each cell <italic>i</italic> and population mean expression <italic>θ</italic><sub><italic>g</italic></sub> of gene <italic>g</italic> are first calculated during data pre-processing, using software TASC[<xref rid="pcbi.1007925.ref017" ref-type="bibr">17</xref>]. This allows us to eliminate bias due to technical variations in scRNA-seq data. Given an exon-group of interest, the informative read counts <italic>Y</italic><sub>+<italic>i</italic></sub>/<italic>Y</italic><sub>−<italic>i</italic></sub> are fitted to the hierarchical model described above, with likelihood function calculated as
<disp-formula id="pcbi.1007925.e017"><alternatives><graphic xlink:href="pcbi.1007925.e017.jpg" id="pcbi.1007925.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007925.e018"><alternatives><graphic xlink:href="pcbi.1007925.e018.jpg" id="pcbi.1007925.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The joint distribution of cell-specific observed informative read counts and their true expression levels is
<disp-formula id="pcbi.1007925.e019"><alternatives><graphic xlink:href="pcbi.1007925.e019.jpg" id="pcbi.1007925.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>ψ</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>ψ</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="9.5em"/><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>ψ</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and similarly
<disp-formula id="pcbi.1007925.e020"><alternatives><graphic xlink:href="pcbi.1007925.e020.jpg" id="pcbi.1007925.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:mo>)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:mo>)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="12.25em"/><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:mo>)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
where the probability distribution function of log-normal distribution <inline-formula id="pcbi.1007925.e021"><alternatives><graphic xlink:href="pcbi.1007925.e021.jpg" id="pcbi.1007925.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>σ</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></alternatives></inline-formula></p>
      <p>To detect exons with DAS, we test whether there is significant difference in inclusion level <italic>ψ</italic> between two group of cells, denoted by A and B, i.e., <italic>H</italic><sub>0</sub>:<italic>ψ</italic><sub><italic>A</italic></sub> = <italic>ψ</italic><sub><italic>B</italic></sub> vs. <italic>H</italic><sub>1</sub>:<italic>ψ</italic><sub><italic>A</italic></sub> ≠ <italic>ψ</italic><sub><italic>B</italic></sub>. A likelihood ratio test with test statistic <inline-formula id="pcbi.1007925.e022"><alternatives><graphic xlink:href="pcbi.1007925.e022.jpg" id="pcbi.1007925.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mspace width="0.12em"/><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mspace width="0.12em"/><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:math></alternatives></inline-formula> is employed to test this hypothesis, where <inline-formula id="pcbi.1007925.e023"><alternatives><graphic xlink:href="pcbi.1007925.e023.jpg" id="pcbi.1007925.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> are maximized under the null hypothesis <italic>H</italic><sub>0</sub> and alternative hypothesis <italic>H</italic><sub>1</sub>, respectively. Asymptotically, <italic>T</italic> follows a chi-square distribution with one degree of freedom.</p>
    </sec>
    <sec id="sec013">
      <title>Datasets and evaluations</title>
      <p>We first conducted a simulation study to benchmark the performance of SCATS and compared it with other existing DAS methods, including Census[<xref rid="pcbi.1007925.ref010" ref-type="bibr">10</xref>] and DEXSeq[<xref rid="pcbi.1007925.ref013" ref-type="bibr">13</xref>]. To simulate realistic datasets, the average gene expressions (<italic>θ</italic><sub><italic>g</italic></sub>) for each cell group were assigned based on measurements of CA1 pyramidal cells in the scRNA-seq data generated by Zeisel <italic>et al</italic>.[<xref rid="pcbi.1007925.ref016" ref-type="bibr">16</xref>]. The exon start and end positions were based on Ensembl annotation and downloaded in GTF format from UCSC Genome Browser (<ext-link ext-link-type="uri" xlink:href="https://genome.ucsc.edu/">https://genome.ucsc.edu/</ext-link>). The cell-specific technical parameters (<italic>α</italic>,<italic>β</italic>,<italic>κ</italic>,<italic>τ</italic>) were estimated based on measurements from CA1 pyramidal cells in scRNA-seq data from Zeisel <italic>et al</italic>.[<xref rid="pcbi.1007925.ref016" ref-type="bibr">16</xref>]. Given these abundances and technical parameters, we then parameterized the generative model described previously, which allows us to simulate exon-level informative read count (<italic>Y</italic><sub>+<italic>ij</italic></sub>,<italic>Y</italic><sub>−<italic>ij</italic></sub>) mimicking the scRNA-seq data generation process. Following this procedure, we simulated 1,000 exon groups with 6,000 total reads per cell for 600 cells (300 in condition A, and 300 in condition B) for five scenarios (Δ = |<italic>ψ</italic><sub><italic>A</italic></sub>−<italic>ψ</italic><sub><italic>B</italic></sub>| = 0, 0.1, 0.2, 0.3, 0.4) to evaluate type I error rate and power for SCATS, Census and DEXSeq.</p>
      <p>In addition, we designed a non-parametric scRMA-seq simulator without assuming the same model underlying SCATS. First, for each gene, gene-level read count <italic>Y</italic> was assigned based on measurements of CA1 pyramidal cells in the scRNA-seq data generated by Zeisel <italic>et al</italic>. Next, we generated total exon-level informative read counts (<italic>Y</italic><sub>+</sub>,<italic>Y</italic><sub>−</sub>) for each condition (A vs B), where <italic>Y</italic><sub>+</sub> = <italic>Y</italic>×<italic>ψ</italic>, <italic>Y</italic><sub>−</sub> = <italic>Y</italic>×(1−<italic>ψ</italic>). We considered five scenarios (Δ = |<italic>ψ</italic><sub><italic>A</italic></sub>−<italic>ψ</italic><sub><italic>B</italic></sub>| = 0, 0.1, 0.2, 0.3, 0.4). Given total informative read counts (<italic>Y</italic><sub>+</sub>,<italic>Y</italic><sub>−</sub>), we then simulated cell-specific informative read counts (<italic>Y</italic><sub>+i</sub>,<italic>Y</italic><sub>−i</sub>) non-parametrically. Specifically, for each single cell <italic>i</italic>, the informative read counts (<italic>Y</italic><sub>+i</sub>,<italic>Y</italic><sub>−i</sub>) were generated from multinomial distributions: <italic>Y</italic><sub>+<italic>i</italic></sub>~multinomial(<italic>Y</italic><sub>+</sub>,<bold><italic>p</italic></bold>) and <italic>Y</italic><sub>−<italic>i</italic></sub>~multinomial(<italic>Y</italic><sub>−</sub>,<bold><italic>p</italic></bold>), where <bold><italic>p</italic></bold>~<italic>Dirichlet</italic>(<bold><italic>α</italic></bold>) and <bold><italic>α</italic></bold> = (<italic>α</italic><sub>1</sub>,…,<italic>α</italic><sub>300</sub>) = (10,…,10).</p>
      <p>Next, we evaluated different DAS detection methods using mouse cortical dataset generated by Tasic <italic>et al</italic>.[<xref rid="pcbi.1007925.ref003" ref-type="bibr">3</xref>], which includes 1,679 cells from 49 sub-cell types in three major cell classes (23 GABAergic cell types, 19 glutamatergic cell types, and seven non-neuronal cell types). Among these cells, the average sequencing depth is 3 million. We directly downloaded the aligned data in BAM format from NCBI Gene Expression Omnibus (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE71585">GSE71585</ext-link>). Given read counts of 6,275 endogenous RefSeq genes with at least two annotated isoforms and 92 ERCC spike-ins across cells, we applied TASC to quantify technical variations, yielding accurate estimation of average gene concentrations in each sub-cell type. Similarly, informative reads in each exon group were counted using SCATS based on the 6,275 genes with 12,073 exon groups. On average, 4,311 exon groups were covered by at least one splicing informative read in each cell. We treat an exon group as qualified for analysis when at least three cells have at least one informative read in each condition. Pairwise DAS comparison was conducted between these 49 sub-cell types with 985 qualified exon groups on average for each comparison.</p>
      <p>Another adult mouse brain data used for evaluation was acquired from Zeisel <italic>et al</italic>.[<xref rid="pcbi.1007925.ref016" ref-type="bibr">16</xref>], which includes sequencing data of 3,005 cells from various regions of mouse brain. These cells were classified into nine major cell classes and 47 sub-cell types with sub-cell types from the same major cell class considered to be relatively homogenous. In this study, raw data in FASTQ format were downloaded from NCBI Gene Expression Omnibus (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60361">GSE60361</ext-link>) and aligned to mm10 reference genome with Ensembl gene annotation using STAR[<xref rid="pcbi.1007925.ref020" ref-type="bibr">20</xref>]. For each cell, we processed the BAM file and counted splicing informative reads using SCATS for 1,826 marker genes (with at least two annotated isoforms by Ensembl) with 3,542 exon groups of the nine major cell classes. For each cell, there are 465 exon groups on average covered by at least one splicing informative UMI read. Given these informative counts, DAS analysis between each pair of the 47 sub-cell types was conducted. To compare the ability of DAS detection, we also performed pairwise DAS analysis across sub-cell types using DEXSeq and Census. For each comparison, we required at least three cells having at least one informative UMI in each condition, leading to 568 qualified exon groups on average for each DAS comparison.</p>
    </sec>
    <sec id="sec014">
      <title>Software availability</title>
      <p>An open-source implementation of the SCATS algorithm can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/huyustats/SCATS">https://github.com/huyustats/SCATS</ext-link>.</p>
    </sec>
    <sec id="sec015">
      <title>Life sciences reporting summary</title>
      <p>Further information on experimental design is available in the Life Sciences Reporting Summary.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec016">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Schematic of the SCATS model.</title>
        <p>An alternatively spliced exon is included in the “+” exon group (blue) and excluded from the “-” group (white). <italic>μ</italic><sub>+<italic>i</italic></sub> and <italic>μ<sub>−i</sub></italic> represent true expression levels of the “+” and “-” exon groups, respectively, in cell <italic>i</italic>. <italic>λ</italic><sub>+<italic>i</italic></sub> and <italic>λ</italic><sub>−<italic>i</italic></sub> are intermediate variables that model amplification bias, capture efficiency, and sequencing bias in cell <italic>i</italic> for the “+” and “-”exon groups. <italic>Z</italic><sub><italic>i</italic></sub> models transcriptional bursting and dropout event of the gene in cell <italic>i</italic>. <italic>Y</italic><sub>+<italic>i</italic></sub> and <italic>Y</italic><sub>−<italic>i</italic></sub> represent observed informative read counts of the “+” and “-” exon groups in cell <italic>i</italic>. SCATS utilizes a hierarchical model to detect differential alternative splicing (DAS) events between cell groups by accounting for technical noise from scRNA-seq data.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Results from a simulation study based on nonparametric scRNA-seq simulator.</title>
        <p><bold>(A)</bold> Quantile-quantile plots of the p-values from SCATS, Census and DEXSeq under the null hypothesis (Δ = 0). X-axis represents uniform theoretical quantiles between 0 and 1 in −log<sub>10</sub> scale. Y-axis represents observed p-value quantile in –log<sub>10</sub> scale. Uniformly distributed data should follow the red dashed line. P-values of SCATS are more uniformly distributed while those from Census are right-skewed and those from DEXSeq are left-skewed. <bold>(B)</bold> Type I error comparison of SCATS, Census and DEXSeq with different significance levels (α = 0.05, 0.01, 0.005). Consistent with <bold>(B)</bold>, SCATS has better type I error control than Census and DEXSeq. <bold>(C)</bold> Barplots show the estimated power under different effect sizes (Δ = 0.1, 0.2, 0.3, 0.4). Significance was evaluated at 0.05, 0.01, and 0.005 levels, respectively. SCATS outperformed Census and DEXSeq across all effect sizes, especially when Δ = 0.4. DEXSeq is conservative in detecting DAS events.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Impact of isoform under-annotation on SCATS.</title>
        <p>Simulated scRNA-seq read counts were based on 100% Ensembl annotated isoforms, but analyzed with SCATS using 100%, 75% and 50% of the annotated isoforms. Barplots show the estimated power under different effect sizes (Δ = 0.1, 0.2, 0.3, 0.4). Significance was evaluated at 0.05, 0.01, and 0.005 levels, respectively. The performance of SCATS is robust to under-annotation of isoform.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s004">
      <label>S4 Fig</label>
      <caption>
        <title>Impact of exon group length on SCATS.</title>
        <p>Exon groups were divided into three groups: length&lt;130bp, 130bp≤length&lt;388bp, and length≥388bp. Barplots show the estimated power of SCATS under different effect sizes (Δ = 0.1, 0.2, 0.3, 0.4). Significance was evaluated at the 0.05, 0.01, and 0.005 levels.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Comparison between SCATS and pseudo-bulk approach based on data simulated from the generative model.</title>
        <p>Barplots show the estimated power of SCATS and pseudo-bulk approach under different effect sizes (Δ = 0.1, 0.2, 0.3, 0.4). Significance was evaluated at the 0.05 level for SCATS. For the pseudo-bulk data, since there is only one sample per condition, we cannot perform a statistical test. To evaluate its performance, we declared an event to be significant if the fold change (FC) of exon-inclusion level is greater than 1.2 (FC&gt;1.2)</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s006">
      <label>S6 Fig</label>
      <caption>
        <title>DAS analysis of the AMPA receptor genes, <italic>Gria1</italic> and <italic>Gria2</italic> using Tasic <italic>et al</italic>. dataset.</title>
        <p><bold>(A,B)</bold> Flip-flop exons of genes <italic>Gria1</italic>
<bold>(A)</bold> and <italic>Gria2</italic>
<bold>(B)</bold>. <bold>(C,D)</bold> Heatmaps show the p-values of pairwise DAS tests for the flop exon for <italic>Gria1</italic>
<bold>(C)</bold> and <italic>Gria2</italic>
<bold>(D)</bold> across 16 cell types (8 GABAergic, 7 Glutamatergic, 1 non-neuronal) using SCATS. These 16 cell types were selected by Tasic <italic>et al</italic>. in which they found highly cell type-specific splicing patterns across these cell types. As expected, SCATS results also showed highly cell type-specific splicing pattern of the <italic>Gria</italic> genes.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Quantile-quantile plots of p-values from SCATS, DEXSeq and Census using the Tasic <italic>et al</italic>. dataset.</title>
        <p>Pairwise DAS comparison across 49 sub-cell types in three major cell classes was performed using SCATS. DAS comparisons were classified into two groups: comparison for cell types within major cell classes <bold>(A, C, E)</bold>, and comparison for cell types across major cell classes <bold>(B, D, F)</bold>. X-axis represents uniform theoretical quantiles between 0 and 1 in −log<sub>10</sub> scale. Y-axis represents observed p-value quantile in −log<sub>10</sub> scale. Uniformly distributed data should follow the red dashed line. Q-Q plots of p-values from within major cell class comparisons (GABAergic, Glutamatergic, Non-neuronal) are similar to the plot under the null hypothesis in our simulation study. This matched our expectation because most exons should not be differentially spliced between sub-cell types within the same major cell class. In contrast, the distribution of p-values is highly right-skewed starting from X = 10<sup>−1.5</sup> for cross-major cell class comparisons (GABAergic vs. Glutamatergic, GABAergic vs. Non-neuronal, Glutamatergic vs. Non-neuronal), indicating that more DAS events were detected.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s008">
      <label>S8 Fig</label>
      <caption>
        <title>DAS analysis results of the Tasic <italic>et al</italic>. data based on 296 genes with 966 exon groups.</title>
        <p>The 296 genes were detected as the most differentially spliced genes by Tasic <italic>et al</italic>. based on MISO analysis. <bold>(A-F)</bold> Pairwise DAS comparison across 49 sub-cell types from three major cell classes: GABAergic, Glutamatergic, and Non-neuronal from mouse cortex using SCATS <bold>(A,B)</bold>, Census <bold>(C,D)</bold> and DEXSeq <bold>(E,F)</bold>. Colors indicate different sub-cell types. <bold>(A,C,E)</bold> Heatmaps showing the proportion of detected DAS exon groups for each pairwise comparison between sub-cell types. <bold>(B,D,F)</bold> Dendrograms depicting cell classification results of the 49 sub-cell types. Each sub-cell type was marked by the corresponding major cell class: GABAergic (red), Glutamatergic (blue) and Non-neuronal (grey). The distance metric between two sub-cell types is the proportion of detected DAS exon groups for SCATS <bold>(B)</bold>, and DAS exons for Census <bold>(D)</bold> and DEXSeq <bold>(F)</bold>.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s009">
      <label>S9 Fig</label>
      <caption>
        <title>Informative read coverage of flip-flop exons of <italic>Gria1</italic> based on Tasic <italic>et al</italic>. data.</title>
        <p><bold>(A)</bold> IGV sashimi plot of the flip-flop exons between cell types Sst Cdk6 and Sst Cbln4. These differentially spliced flip-flop exons were identified by SCATS but missed by Census and DEXSeq. Each row represents one single cell. Six cells were randomly selected from the 68 Sst Cbln4 cell, and another six cells were randomly selected from the 19 Sst Cdk6 cells. <bold>(B)</bold> Scatter plot of the flip exon coverage against the flop exon coverage across all 87 cells. Black dashed line is identical line. The read coverage showed a significant difference in flip-flop exon usage between cell types Sst Cdk6 and Sst Cbln4.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s010">
      <label>S10 Fig</label>
      <caption>
        <title>DAS analysis results of 6,275 genes meeting analysis criteria in the Tasic <italic>et al</italic>. data.</title>
        <p>Pairwise DAS comparison across GABAergic cell types from mouse cortex using SCATS, Census and DEXSeq. Colors indicate different GABAergic cell types. Purple, yellow and red indicate three sub cell classes. Heatmaps showing the proportions of detected DAS exon groups or exons for each pairwise comparison between cell types based on 6,275 genes. Dendrograms depicting cell classification results of the 17 GABAergic cell types. The distance metric between two cell types is the proportion of detected DAS exon groups for SCATS, and DAS exons for Census and DEXSeq. SCATS outperformed Census and DEXSeq in detecting splicing heterogeneity across different cell types, while controlling false positive rate.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s011">
      <label>S11 Fig</label>
      <caption>
        <title>DAS analysis results of the Zeisel <italic>et al</italic>. data.</title>
        <p>This dataset includes both UMI and non-UMI read counts. The UMI read counts were obtained by consolidating read counts for reads that originate from the same molecule based on UMI barcodes. This dataset allows us to compare UMI and non-UMI read counts systematically for DAS analysis. <bold>(A,B)</bold> Comparison of UMI and non-UMI read counts. <bold>(A)</bold> Scatter plot of UMI splicing informative read counts against non-UMI splicing informative read counts in log scale. Each point was summarized based on the same exon group in the same cell. Red dashed line represents identical line. <bold>(B)</bold> Distribution comparison between UMI and non-UMI splicing informative read counts. UMI counts are much smaller than non-UMI counts, suggesting that splicing analysis using UMI counts is more challenging. <bold>(C,D)</bold> Pairwise DAS comparison across nine major cell types from mouse cortex and hippocampus using MISO. Colors indicate nine major cell classes. <bold>(C)</bold> Heatmaps showing the proportion of detected DAS exon groups for each pairwise comparison between sub-cell types. <bold>(D)</bold> Dendrogram depicting cell classification results of the 47 sub-cell types. The distance metric between two sub-cell types is the proportion of detected DAS exons among all analyzed exons by MISO. MISO showed the worst performance in cell type classification as compared to SCATS, Census and DEXSeq in <bold><xref ref-type="fig" rid="pcbi.1007925.g003">Fig 3</xref></bold>. <bold>(E)</bold> Gene-level UMI counts and exon-inclusion level estimates of the flip exon from gene <italic>Gria1</italic> across sub-cell types. Splicing quantification offers higher resolution of cellular heterogeneity than total gene expression.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s012">
      <label>S12 Fig</label>
      <caption>
        <title>DAS analysis comparison across different significance levels and methods.</title>
        <p>The analysis was conducted on 296 genes detected as the most differentially spliced genes by Tasic <italic>et al</italic>. based on MISO analysis. Heatmaps showing the proportions of detected DAS events for each pairwise comparison between 49 sub-cell types. The performance of SCATS, Census and DEXSeq was evaluated using different significance levels (α = 0.05, 0.01, 0.005). For within major cell class comparison (GABAergic, Glutamatergic, Non-neuronal), Census yielded much higher DAS detection rate (~0.6) than SCATS (&lt;0.1), indicating possible inflated false positive results for Census as we expect to see smaller splicing differences for cells within the same major cell class.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s012.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007925.s013">
      <label>S13 Fig</label>
      <caption>
        <title>DAS analysis comparison across different significance levels and methods using Zeisel <italic>et al</italic>. data.</title>
        <p>Heatmaps showing the proportion of detected DAS events (3,542 exon groups from 1,826 genes) for each pairwise comparison between nine major cell classes. The performance of SCATS, Census, DEXSeq and MISO was evaluated at different significance levels (α = 0.05, 0.01, 0.005 for SCATS, Census and DEXSeq, or Bayes factor: 50, 100, 200 for MISO).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007925.s013.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007925.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Marinov</surname><given-names>GK</given-names></name>, <name><surname>Williams</surname><given-names>BA</given-names></name>, <name><surname>McCue</surname><given-names>K</given-names></name>, <name><surname>Schroth</surname><given-names>GP</given-names></name>, <name><surname>Gertz</surname><given-names>J</given-names></name>, <name><surname>Myers</surname><given-names>RM</given-names></name>, <etal>et al</etal><article-title>From single-cell to cell-pool transcriptomes: stochasticity in gene expression and RNA splicing</article-title>. <source>Genome Res</source>. <year>2014</year>;<volume>24</volume>(<issue>3</issue>):<fpage>496</fpage>–<lpage>510</lpage>. Epub 2013/12/05. <pub-id pub-id-type="doi">10.1101/gr.161034.113</pub-id><?supplied-pmid 24299736?><pub-id pub-id-type="pmid">24299736</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Shalek</surname><given-names>AK</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Adiconis</surname><given-names>X</given-names></name>, <name><surname>Gertner</surname><given-names>RS</given-names></name>, <name><surname>Gaublomme</surname><given-names>JT</given-names></name>, <name><surname>Raychowdhury</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>. <source>Nature</source>. <year>2013</year>;<volume>498</volume>(<issue>7453</issue>):<fpage>236</fpage>–<lpage>40</lpage>. Epub 2013/05/21. <pub-id pub-id-type="doi">10.1038/nature12172</pub-id><?supplied-pmid 23685454?><pub-id pub-id-type="pmid">23685454</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Tasic</surname><given-names>B</given-names></name>, <name><surname>Menon</surname><given-names>V</given-names></name>, <name><surname>Nguyen</surname><given-names>TN</given-names></name>, <name><surname>Kim</surname><given-names>TK</given-names></name>, <name><surname>Jarsky</surname><given-names>T</given-names></name>, <name><surname>Yao</surname><given-names>Z</given-names></name>, <etal>et al</etal><article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>. <source>Nat Neurosci</source>. <year>2016</year>;<volume>19</volume>(<issue>2</issue>):<fpage>335</fpage>–<lpage>46</lpage>. Epub 2016/01/05. <pub-id pub-id-type="doi">10.1038/nn.4216</pub-id><?supplied-pmid 26727548?><pub-id pub-id-type="pmid">26727548</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Arzalluz-Luque</surname><given-names>A</given-names></name>, <name><surname>Conesa</surname><given-names>A</given-names></name>. <article-title>Single-cell RNAseq for the study of isoforms-how is that possible?</article-title><source>Genome Biol</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>110</fpage> Epub 2018/08/12. <pub-id pub-id-type="doi">10.1186/s13059-018-1496-z</pub-id>
<?supplied-pmid 30097058?><pub-id pub-id-type="pmid">30097058</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Sanguinetti</surname><given-names>G</given-names></name>. <article-title>BRIE: transcriptome-wide splicing quantification in single cells</article-title>. <source>Genome Biol</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>123</fpage> Epub 2017/06/29. <pub-id pub-id-type="doi">10.1186/s13059-017-1248-5</pub-id>
<?supplied-pmid 28655331?><pub-id pub-id-type="pmid">28655331</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Klein</surname><given-names>AM</given-names></name>, <name><surname>Mazutis</surname><given-names>L</given-names></name>, <name><surname>Akartuna</surname><given-names>I</given-names></name>, <name><surname>Tallapragada</surname><given-names>N</given-names></name>, <name><surname>Veres</surname><given-names>A</given-names></name>, <name><surname>Li</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1187</fpage>–<lpage>201</lpage>. Epub 2015/05/23. <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id><?supplied-pmid 26000487?><pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Macosko</surname><given-names>EZ</given-names></name>, <name><surname>Basu</surname><given-names>A</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Nemesh</surname><given-names>J</given-names></name>, <name><surname>Shekhar</surname><given-names>K</given-names></name>, <name><surname>Goldman</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1202</fpage>–<lpage>14</lpage>. Epub 2015/05/23. <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><?supplied-pmid 26000488?><pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>GX</given-names></name>, <name><surname>Terry</surname><given-names>JM</given-names></name>, <name><surname>Belgrader</surname><given-names>P</given-names></name>, <name><surname>Ryvkin</surname><given-names>P</given-names></name>, <name><surname>Bent</surname><given-names>ZW</given-names></name>, <name><surname>Wilson</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>:<fpage>14049</fpage> Epub 2017/01/17. <pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id>
<?supplied-pmid 28091601?><pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>Y</given-names></name>, <name><surname>Botvinnik</surname><given-names>OB</given-names></name>, <name><surname>Lovci</surname><given-names>MT</given-names></name>, <name><surname>Kakaradov</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>P</given-names></name>, <name><surname>Xu</surname><given-names>JL</given-names></name>, <etal>et al</etal><article-title>Single-Cell Alternative Splicing Analysis with Expedition Reveals Splicing Dynamics during Neuron Differentiation</article-title>. <source>Mol Cell</source>. <year>2017</year>;<volume>67</volume>(<issue>1</issue>):<fpage>148</fpage>–<lpage>61 e5</lpage>. Epub 2017/07/05. <pub-id pub-id-type="doi">10.1016/j.molcel.2017.06.003</pub-id> PubMed Central PMCID: PMC5540791. <?supplied-pmid 28673540?><pub-id pub-id-type="pmid">28673540</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Qiu</surname><given-names>X</given-names></name>, <name><surname>Hill</surname><given-names>A</given-names></name>, <name><surname>Packer</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>D</given-names></name>, <name><surname>Ma</surname><given-names>YA</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>. <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>3</issue>):<fpage>309</fpage>–<lpage>15</lpage>. Epub 2017/01/24. <pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id><?supplied-pmid 28114287?><pub-id pub-id-type="pmid">28114287</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Ntranos</surname><given-names>V</given-names></name>, <name><surname>Yi</surname><given-names>L</given-names></name>, <name><surname>Melsted</surname><given-names>P</given-names></name>, <name><surname>Pachter</surname><given-names>L</given-names></name>. <article-title>A discriminative learning approach to differential expression analysis for single-cell RNA-seq</article-title>. <source>Nat Methods</source>. <year>2019</year>;<volume>16</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>6</lpage>. Epub 2019/01/22. <pub-id pub-id-type="doi">10.1038/s41592-018-0303-9</pub-id> .<?supplied-pmid 30664774?><pub-id pub-id-type="pmid">30664774</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hu</surname><given-names>Y</given-names></name>, <name><surname>Lin</surname><given-names>J</given-names></name>, <name><surname>Hu</surname><given-names>J</given-names></name>, <name><surname>Hu</surname><given-names>G</given-names></name>, <name><surname>Wang</surname><given-names>K</given-names></name>, <name><surname>Zhang</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>PennDiff: detecting differential alternative splicing and transcription by RNA sequencing</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>14</issue>):<fpage>2384</fpage>–<lpage>91</lpage>. Epub 2018/02/24. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty097</pub-id><?supplied-pmid 29474557?><pub-id pub-id-type="pmid">29474557</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Anders</surname><given-names>S</given-names></name>, <name><surname>Reyes</surname><given-names>A</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>. <article-title>Detecting differential usage of exons from RNA-seq data</article-title>. <source>Genome Res</source>. <year>2012</year>;<volume>22</volume>(<issue>10</issue>):<fpage>2008</fpage>–<lpage>17</lpage>. Epub 2012/06/23. <pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id><?supplied-pmid 22722343?><pub-id pub-id-type="pmid">22722343</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Sommer</surname><given-names>B</given-names></name>, <name><surname>Keinanen</surname><given-names>K</given-names></name>, <name><surname>Verdoorn</surname><given-names>TA</given-names></name>, <name><surname>Wisden</surname><given-names>W</given-names></name>, <name><surname>Burnashev</surname><given-names>N</given-names></name>, <name><surname>Herb</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Flip and flop: a cell-specific functional switch in glutamate-operated channels of the CNS</article-title>. <source>Science</source>. <year>1990</year>;<volume>249</volume>(<issue>4976</issue>):<fpage>1580</fpage>–<lpage>5</lpage>. Epub 1990/09/28. <pub-id pub-id-type="doi">10.1126/science.1699275</pub-id> .<?supplied-pmid 1699275?><pub-id pub-id-type="pmid">1699275</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Katz</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>ET</given-names></name>, <name><surname>Airoldi</surname><given-names>EM</given-names></name>, <name><surname>Burge</surname><given-names>CB</given-names></name>. <article-title>Analysis and design of RNA sequencing experiments for identifying isoform regulation</article-title>. <source>Nat Methods</source>. <year>2010</year>;<volume>7</volume>(<issue>12</issue>):<fpage>1009</fpage>–<lpage>15</lpage>. Epub 2010/11/09. <pub-id pub-id-type="doi">10.1038/nmeth.1528</pub-id><?supplied-pmid 21057496?><pub-id pub-id-type="pmid">21057496</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Zeisel</surname><given-names>A</given-names></name>, <name><surname>Munoz-Manchado</surname><given-names>AB</given-names></name>, <name><surname>Codeluppi</surname><given-names>S</given-names></name>, <name><surname>Lonnerberg</surname><given-names>P</given-names></name>, <name><surname>La Manno</surname><given-names>G</given-names></name>, <name><surname>Jureus</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>. <year>2015</year>;<volume>347</volume>(<issue>6226</issue>):<fpage>1138</fpage>–<lpage>42</lpage>. Epub 2015/02/24. <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id> .<?supplied-pmid 25700174?><pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Huang</surname><given-names>M</given-names></name>, <name><surname>Torre</surname><given-names>E</given-names></name>, <name><surname>Dueck</surname><given-names>H</given-names></name>, <name><surname>Shaffer</surname><given-names>S</given-names></name>, <name><surname>Murray</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Gene expression distribution deconvolution in single-cell RNA sequencing</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2018</year>;<volume>115</volume>(<issue>28</issue>):<fpage>E6437</fpage>–<lpage>E46</lpage>. Epub 2018/06/28. <pub-id pub-id-type="doi">10.1073/pnas.1721085115</pub-id><?supplied-pmid 29946020?><pub-id pub-id-type="pmid">29946020</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Easton</surname><given-names>J</given-names></name>, <name><surname>Finkelstein</surname><given-names>D</given-names></name>, <name><surname>Wu</surname><given-names>G</given-names></name>, <name><surname>Chen</surname><given-names>X</given-names></name>. <article-title>UMI-count modeling and differential expression analysis for single-cell RNA sequencing</article-title>. <source>Genome Biol</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>70</fpage> Epub 2018/06/02. <pub-id pub-id-type="doi">10.1186/s13059-018-1438-9</pub-id>
<?supplied-pmid 29855333?><pub-id pub-id-type="pmid">29855333</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Jia</surname><given-names>C</given-names></name>, <name><surname>Hu</surname><given-names>Y</given-names></name>, <name><surname>Kelly</surname><given-names>D</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Zhang</surname><given-names>NR</given-names></name>. <article-title>Accounting for technical noise in differential expression analysis of single-cell RNA sequencing data</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>(<issue>19</issue>):<fpage>10978</fpage>–<lpage>88</lpage>. Epub 2017/10/17. <pub-id pub-id-type="doi">10.1093/nar/gkx754</pub-id><?supplied-pmid 29036714?><pub-id pub-id-type="pmid">29036714</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007925.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Dobin</surname><given-names>A</given-names></name>, <name><surname>Davis</surname><given-names>CA</given-names></name>, <name><surname>Schlesinger</surname><given-names>F</given-names></name>, <name><surname>Drenkow</surname><given-names>J</given-names></name>, <name><surname>Zaleski</surname><given-names>C</given-names></name>, <name><surname>Jha</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>21</lpage>. Epub 2012/10/30. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id><?supplied-pmid 23104886?><pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
