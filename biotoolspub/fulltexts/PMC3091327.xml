<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3091327</article-id>
    <article-id pub-id-type="publisher-id">gb-2009-10-11-r134</article-id>
    <article-id pub-id-type="pmid">19930550</article-id>
    <article-id pub-id-type="doi">10.1186/gb-2009-10-11-r134</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Searching for SNPs with cloud computing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Langmead</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>blangmea@jhsph.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Schatz</surname>
          <given-names>Michael C</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>mschatz@umiacs.umd.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Lin</surname>
          <given-names>Jimmy</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>jimmylin@umd.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Pop</surname>
          <given-names>Mihai</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>mpop@umiacs.umd.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Salzberg</surname>
          <given-names>Steven L</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>salzberg@umiacs.umd.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biostatistics, Johns Hopkins Bloomberg School of Public Health, 615 North Wolfe Street, Baltimore, Maryland 21205, USA</aff>
    <aff id="I2"><label>2</label>Center for Bioinformatics and Computational Biology, University of Maryland, College Park, MD 20742, USA</aff>
    <aff id="I3"><label>3</label>The iSchool, College of Information Studies, University of Maryland, College Park, MD 20742, USA</aff>
    <pub-date pub-type="ppub">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>11</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <issue>11</issue>
    <fpage>R134</fpage>
    <lpage>R134</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>9</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>5</day>
        <month>11</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>11</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â©2009 Langmead et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Langmead et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://genomebiology.com/2009/10/11/R134"/>
    <abstract abstract-type="short">
      <p>Novel software utilizing cloud computing technology to cost-effectively align and map SNPs from a human genome in three.</p>
    </abstract>
    <abstract>
      <p>As DNA sequencing outpaces improvements in computer speed, there is a critical need to accelerate tasks like alignment and SNP calling. Crossbow is a cloud-computing software tool that combines the aligner Bowtie and the SNP caller SOAPsnp. Executing in parallel using Hadoop, Crossbow analyzes data comprising 38-fold coverage of the human genome in three hours using a 320-CPU cluster rented from a cloud computing service for about $85. Crossbow is available from <ext-link ext-link-type="uri" xlink:href="http://bowtie-bio.sourceforge.net/crossbow/">http://bowtie-bio.sourceforge.net/crossbow/</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Rationale</title>
    <p>Improvements in DNA sequencing have made sequencing an increasingly valuable tool for the study of human variation and disease. Technologies from Illumina (San Diego, CA, USA), Applied Biosystems (Foster City, CA, USA) and 454 Life Sciences (Branford, CT, USA) have been used to detect genomic variations among humans [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B5">5</xref>], to profile methylation patterns [<xref ref-type="bibr" rid="B6">6</xref>], to map DNA-protein interactions [<xref ref-type="bibr" rid="B7">7</xref>], and to identify differentially expressed genes and novel splice junctions [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]. Meanwhile, technical improvements have greatly decreased the cost and increased the size of sequencing datasets. For example, at the beginning of 2009 a single Illumina instrument was capable of generating 15 to 20 billion bases of sequencing data per run. Illumina has projected [<xref ref-type="bibr" rid="B10">10</xref>] that its instrument will generate 90 to 95 billion bases per run by the end of 2009, quintupling its throughput in one year. Another study shows the per-subject cost for whole-human resequencing declining rapidly over the past year [<xref ref-type="bibr" rid="B11">11</xref>], which will fuel further adoption. Growth in throughput and adoption are vastly outpacing improvements in computer speed, demanding a level of computational power achievable only via large-scale parallelization.</p>
    <p>Two recent projects have leveraged parallelism for whole-genome assembly with short reads. Simpson <italic>et al</italic>. [<xref ref-type="bibr" rid="B12">12</xref>] use ABySS to assemble the genome of a human from 42-fold coverage of short reads [<xref ref-type="bibr" rid="B2">2</xref>] using a cluster of 168 cores (21 computers), in about 3 days of wall clock time. Jackson and colleagues [<xref ref-type="bibr" rid="B13">13</xref>] assembled a <italic>Drosophila melanogaster </italic>genome from simulated short reads on a 512-node BlueGene/L supercomputer in less than 4 hours of total elapsed time. Though these efforts demonstrate the promise of parallelization, they are not widely applicable because they require access to a specific type of hardware resource. No two clusters are exactly alike, so scripts and software designed to run well on one cluster may run poorly or fail entirely on another cluster. Software written for large supercomputers like BlueGene/L is less reusable still, since only select researchers have access to such machines. Lack of reusability also makes it difficult for peers to recreate scientific results obtained using such systems.</p>
    <p>An increasingly popular alternative for large-scale computations is cloud computing. Instead of owning and maintaining dedicated hardware, cloud computing offers a 'utility computing' model, that is, the ability to rent and perform computation on standard, commodity computer hardware over the Internet. These rented computers run in a virtualized environment where the user is free to customize the operating system and software installed. Cloud computing also offers a parallel computing framework called MapReduce [<xref ref-type="bibr" rid="B14">14</xref>], which was designed by Google to efficiently scale computation to many hundreds or thousands of commodity computers. Hadoop [<xref ref-type="bibr" rid="B15">15</xref>] is an open source implementation of MapReduce that is widely used to process very large datasets, including at companies such as Google, Yahoo, Microsoft, IBM, and Amazon. Hadoop programs can run on any cluster where the portable, Java-based Hadoop framework is installed. This may be a local or institutional cluster to which the user has free access, or it may be a cluster rented over the Internet through a utility computing service. In addition to high scalability, the use of both standard software (Hadoop) and standard hardware (utility computing) affords reusability and reproducibility.</p>
    <p>The CloudBurst project [<xref ref-type="bibr" rid="B16">16</xref>] explored the benefits of using Hadoop as a platform for alignment of short reads. CloudBurst is capable of reporting all alignments for millions of human short reads in minutes, but does not scale well to human resequencing applications involving billions of reads. Whereas CloudBurst aligns about 1 million short reads per minute on a 24-core cluster, a typical human resequencing project generates billions of reads, requiring more than 100 days of cluster time or a much larger cluster. Also, whereas CloudBurst is designed to efficiently discover all valid alignments per read, resequencing applications often ignore or discount evidence from repetitively aligned reads as they tend to confound genotyping. Our goal for this work was to explore whether cloud computing could be profitably applied to the largest problems in comparative genomics. We focus on human resequencing, and single nucleotide polymorphism (SNP) detection specifically, in order to allow comparisons to previous studies.</p>
    <p>We present Crossbow, a Hadoop-based software tool that combines the speed of the short read aligner Bowtie [<xref ref-type="bibr" rid="B17">17</xref>] with the accuracy of the SNP caller SOAPsnp [<xref ref-type="bibr" rid="B18">18</xref>] to perform alignment and SNP detection for multiple whole-human datasets per day. In our experiments, Crossbow aligns and calls SNPs from 38-fold coverage of a Han Chinese male genome [<xref ref-type="bibr" rid="B5">5</xref>] in as little as 3 hours (4 hours 30 minutes including transfer time) using a 320-core cluster. SOAPsnp was previously shown to make SNP calls that agree closely with genotyping results obtained with an Illumina 1 M BeadChip assay of the Han Chinese genome [<xref ref-type="bibr" rid="B18">18</xref>] when used in conjunction with the short read aligner SOAP [<xref ref-type="bibr" rid="B19">19</xref>]. We show that SNPs reported by Crossbow exhibit a level of BeadChip agreement comparable to that achieved in the original SOAPsnp study, but in far less time.</p>
    <p>Crossbow is open source software available from the Bowtie website [<xref ref-type="bibr" rid="B20">20</xref>]. Crossbow can be run on any cluster with appropriate versions of Hadoop, Bowtie, and SOAPsnp installed. Crossbow is distributed with scripts allowing it to run either on a local cluster or on a cluster rented through Amazon's Elastic Compute Cloud (EC2) [<xref ref-type="bibr" rid="B21">21</xref>] utility computing service. Version 0.1.3 of the Crossbow software is also provided as Additional data file 1.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>Crossbow harnesses cloud computing to efficiently and accurately align billions of reads and call SNPs in hours, including for high-coverage whole-human datasets. Within Crossbow, alignment and SNP calling are performed by Bowtie and SOAPsnp, respectively, in a seamless, automatic pipeline. Crossbow can be run on any computer cluster with the prerequisite software installed. The Crossbow package includes scripts that allow the user to run an entire Crossbow session remotely on an Amazon EC2 cluster of any size.</p>
    <sec>
      <title>Resequencing simulated data</title>
      <p>To measure Crossbow's accuracy where true SNPs are known, we conducted two experiments using simulated paired-end read data from human chromosomes 22 and X. Results are shown in Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>. For both experiments, 40-fold coverage of 35-bp paired-end reads were simulated from the human reference sequence (National Center for Biotechnology Information (NCBI) 36.3). Quality values and insert lengths were simulated based on empirically observed qualities and inserts in the Wang <italic>et al</italic>. dataset [<xref ref-type="bibr" rid="B5">5</xref>].</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Experimental parameters for Crossbow experiments using simulated reads from human chromosomes 22 and X</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Reference chromosome</th>
              <th align="center">Chromosome 22</th>
              <th align="center">Chromosome X</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Reference base pairs</td>
              <td align="center">49.7 million</td>
              <td align="center">155 million</td>
            </tr>
            <tr>
              <td align="left">Chromosome copy number</td>
              <td align="center">Diploid</td>
              <td align="center">Haploid</td>
            </tr>
            <tr>
              <td align="left">HapMap SNPs introduced</td>
              <td align="center">36,096</td>
              <td align="center">71,976</td>
            </tr>
            <tr>
              <td align="left">âHeterozygous</td>
              <td align="center">24,761</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="left">âHomozygous</td>
              <td align="center">11,335</td>
              <td align="center">71,976</td>
            </tr>
            <tr>
              <td align="left">Novel SNPs introduced</td>
              <td align="center">10,490</td>
              <td align="center">30,243</td>
            </tr>
            <tr>
              <td align="left">âHeterozygous</td>
              <td align="center">6,967</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="left">âHomozygous</td>
              <td align="center">3,523</td>
              <td align="center">30,243</td>
            </tr>
            <tr>
              <td align="left">Simulated coverage</td>
              <td align="center">40-fold</td>
              <td align="center">40-fold</td>
            </tr>
            <tr>
              <td align="left">Read type</td>
              <td align="center">35-bp paired</td>
              <td align="center">35-bp paired</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>SNP calling measurements for Crossbow experiments using simulated reads from human chromosomes 22 and X</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="center" colspan="3">Chromosome 22</th>
              <th align="center" colspan="3">Chromosome X</th>
            </tr>
            <tr>
              <th/>
              <th colspan="3">
                <hr/>
              </th>
              <th colspan="3">
                <hr/>
              </th>
            </tr>
            <tr>
              <th/>
              <th align="center">True number of sites</th>
              <th align="center">Crossbow sensitivity</th>
              <th align="center">Crossbow precision</th>
              <th align="center">True number of sites</th>
              <th align="center">Crossbow sensitivity</th>
              <th align="center">Crossbow precision</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">All SNP sites</td>
              <td align="center">46,586</td>
              <td align="center">99.0%</td>
              <td align="center">99.1%</td>
              <td align="center">102,219</td>
              <td align="center">99.0%</td>
              <td align="center">99.6%</td>
            </tr>
            <tr>
              <td align="left">âOnly HapMap SNP sites</td>
              <td align="center">36,096</td>
              <td align="center">99.8%</td>
              <td align="center">99.9%</td>
              <td align="center">71,976</td>
              <td align="center">99.9%</td>
              <td align="center">99.9%</td>
            </tr>
            <tr>
              <td align="left">âOnly novel SNP sites</td>
              <td align="center">10,490</td>
              <td align="center">96.3%</td>
              <td align="center">96.3%</td>
              <td align="center">30,243</td>
              <td align="center">96.8%</td>
              <td align="center">98.8%</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">âOnly homozygous</td>
              <td align="center">14,858</td>
              <td align="center">98.7%</td>
              <td align="center">99.9%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td align="left">âOnly heterozygous</td>
              <td align="center">31,728</td>
              <td align="center">99.2%</td>
              <td align="center">98.8%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">âOnly novel het</td>
              <td align="center">6,967</td>
              <td align="center">96.6%</td>
              <td align="center">94.6%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td align="left">âAll other</td>
              <td align="center">39,619</td>
              <td align="center">99.4%</td>
              <td align="center">99.9%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Sensitivity is the proportion of true SNPs that were correctly identified. Precision is the proportion of called SNPs that were genuine. NA denotes "not applicable" because of the ploidy of the chromosome.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>SOAPsnp can exploit user-supplied information about known SNP loci and allele frequencies to refine its prior probabilities and improve accuracy. Therefore, the read simulator was designed to simulate both known HapMap [<xref ref-type="bibr" rid="B22">22</xref>] SNPs and novel SNPs. This mimics resequencing experiments where many SNPs are known but some are novel. Known SNPs were selected at random from actual HapMap alleles for human chromosomes 22 and X. Positions and allele frequencies for known SNPs were calculated according to the same HapMap SNP data used to simulate SNPs.</p>
      <p>For these simulated data, Crossbow agrees substantially with the true calls, with greater than 99% precision and sensitivity overall for chromosome 22. Performance for HapMap SNPs is noticeably better than for novel SNPs, owing to SOAPsnp's ability to adjust SNP-calling priors according to known allele frequencies. Performance is similar for homozygous and heterozygous SNPs overall, but novel heterozygous SNPs yielded the worst performance of any other subset studied, with 96.6% sensitivity and 94.6% specificity on chromosome 22. This is as expected, since novel SNPs do not benefit from prior knowledge, and heterozygous SNPs are more difficult than homozygous SNPs to distinguish from the background of sequencing errors.</p>
    </sec>
    <sec>
      <title>Whole-human resequencing</title>
      <p>To demonstrate performance on real-world data, we used Crossbow to align and call SNPs from the set of 2.7 billion reads and paired-end reads sequenced from a Han Chinese male by Wang <italic>et al </italic>[<xref ref-type="bibr" rid="B5">5</xref>]. Previous work demonstrated that SNPs called from this dataset by a combination of SOAP and SOAPsnp are highly concordant with genotypes called by an Illumina 1 M BeadChip genotyping assay of the same individual [<xref ref-type="bibr" rid="B18">18</xref>]. Since Crossbow uses SOAPsnp as its SNP caller, we expected Crossbow to yield very similar, but not identical, output. Differences may occur because: Crossbow uses Bowtie whereas the previous study used SOAP to align the reads; the Crossbow version of SOAPsnp has been modified somewhat to operate within a MapReduce context; in this study, alignments are binned into non-overlapping 2-Mbp partitions rather than into chromosomes prior to being given to SOAPsnp; and the SOAPsnp study used additional filters to remove some additional low confidence SNPs. Despite these differences, Crossbow achieves comparable agreement with the BeadChip assay and at a greatly accelerated rate.</p>
      <p>We downloaded 2.66 billion reads from a mirror of the YanHuang site [<xref ref-type="bibr" rid="B23">23</xref>]. These reads cover the assembled human genome sequence to 38-fold coverage. They consist of 2.02 billion unpaired reads with sizes ranging from 25 to 44 bp, and 658 million paired-end reads. The most common unpaired read lengths are 35 and 40 bp, comprising 73.0% and 17.4% of unpaired reads, respectively. The most common paired-end read length is 35 bp, comprising 88.8% of all paired-end reads. The distribution of paired-end separation distances is bimodal with peaks in the 120 to 150 bp and 420 to 460 bp ranges.</p>
      <p>Table <xref ref-type="table" rid="T3">3</xref> shows a comparison of SNPs called by either of the sequencing-based assays - Crossbow labeled 'CB' and SOAP+SOAPsnp labeled 'SS' - against SNPs obtained with the Illumina 1 M BeadChip assay from the SOAPsnp study [<xref ref-type="bibr" rid="B18">18</xref>]. The 'sites covered' column reports the proportion of BeadChip sites covered by a sufficient number of sequencing reads. Sufficient coverage is roughly four reads for diploid chromosomes and two reads for haploid chromosomes (see Materials and methods for more details about how sufficient coverage is determined). The 'Agreed' column shows the proportion of covered BeadChip sites where the BeadChip call equaled the SOAPsnp or Crossbow call. The 'Missed allele' column shows the proportion of covered sites where SOAPsnp or Crossbow called a position as homozygous for one of two heterozygous alleles called by BeadChip at that position. The 'Other disagreement' column shows the proportion of covered sites where the BeadChip call differed from the SOAPsnp/Crossbow in any other way. Definitions of the 'Missed allele' and 'Other disagreement' columns correspond to the definitions of 'false negatives' and 'false positives', respectively, in the SOAPsnp study.</p>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Coverage and agreement measurements comparing Crossbow (CB) and SOAP/SOAPsnp (SS) to the genotyping results obtained by an Illumina 1 M genotyping assay in the SOAPsnp study</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th/>
              <th/>
              <th/>
              <th/>
              <th/>
              <th align="center" colspan="2">(SS)</th>
              <th align="center" colspan="2">(CB)</th>
            </tr>
            <tr>
              <th/>
              <th/>
              <th/>
              <th/>
              <th/>
              <th/>
              <th colspan="2">
                <hr/>
              </th>
              <th colspan="2">
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left">Illumina 1 M genotype</th>
              <th align="center">Sites</th>
              <th align="center">Sites covered (SS)</th>
              <th align="center">Sites covered (CB)</th>
              <th align="center">Agreed (SS)</th>
              <th align="center">Agreed (CB)</th>
              <th align="center">Missed allele</th>
              <th align="center">Other disagreement</th>
              <th align="center">Missed allele</th>
              <th align="center">Other disagreement</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Chromosome X</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">âHOM reference</td>
              <td align="center">27,196</td>
              <td align="center">98.65%</td>
              <td align="center">99.83%</td>
              <td align="center">99.99%</td>
              <td align="center">99.99%</td>
              <td align="center">NA</td>
              <td align="center">0.004%</td>
              <td align="center">NA</td>
              <td align="center">0.011%</td>
            </tr>
            <tr>
              <td align="left">âHOM mutant</td>
              <td align="center">10,737</td>
              <td align="center">98.49%</td>
              <td align="center">99.19%</td>
              <td align="center">99.89%</td>
              <td align="center">99.85%</td>
              <td align="center">NA</td>
              <td align="center">0.113%</td>
              <td align="center">NA</td>
              <td align="center">0.150%</td>
            </tr>
            <tr>
              <td align="left">âTotal</td>
              <td align="center">37,933</td>
              <td align="center">98.61%</td>
              <td align="center">99.65%</td>
              <td align="center">99.97%</td>
              <td align="center">99.95%</td>
              <td align="center">NA</td>
              <td align="center">0.035%</td>
              <td align="center">NA</td>
              <td align="center">0.050%</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">Autosomal</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">âHOM reference</td>
              <td align="center">540,878</td>
              <td align="center">99.11%</td>
              <td align="center">99.88%</td>
              <td align="center">99.96%</td>
              <td align="center">99.92%</td>
              <td align="center">NA</td>
              <td align="center">0.044%</td>
              <td align="center">NA</td>
              <td align="center">0.078%</td>
            </tr>
            <tr>
              <td align="left">âHOM mutant</td>
              <td align="center">208,436</td>
              <td align="center">98.79%</td>
              <td align="center">99.28%</td>
              <td align="center">99.81%</td>
              <td align="center">99.70%</td>
              <td align="center">NA</td>
              <td align="center">0.194%</td>
              <td align="center">NA</td>
              <td align="center">0.296%</td>
            </tr>
            <tr>
              <td align="left">âHET</td>
              <td align="center">250,667</td>
              <td align="center">94.81%</td>
              <td align="center">99.64%</td>
              <td align="center">99.61%</td>
              <td align="center">99.75%</td>
              <td align="center">0.374%</td>
              <td align="center">0.017%</td>
              <td align="center">0.236%</td>
              <td align="center">0.014%</td>
            </tr>
            <tr>
              <td align="left">âTotal</td>
              <td align="center">999,981</td>
              <td align="center">97.97%</td>
              <td align="center">99.70%</td>
              <td align="center">99.84%</td>
              <td align="center">99.83%</td>
              <td align="center">0.091%</td>
              <td align="center">0.069%</td>
              <td align="center">0.059%</td>
              <td align="center">0.108%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>'Sites covered' is the proportion of BeadChip sites covered by a sufficient number of sequencing reads (roughly four reads for diploid and two reads for haploid chromosomes). 'Agreed' is the proportion of covered BeadChip sites where the BeadChip call equaled the SOAPsnp/Crossbow call. 'Missed allele' is the proportion of covered sites where SOAPsnp/Crossbow called a position as homozygous for one of two heterozygous alleles called by BeadChip. 'Other disagreement' is the proportion of covered sites where the BeadChip call differed from the SOAPsnp/Crossbow in any other way. NA denotes "not applicable" due to ploidy.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Both Crossbow and SOAP+SOAPsnp exhibit a very high level of agreement with the BeadChip genotype calls. The small differences in number of covered sites (&lt;2% higher for Crossbow) and in percentage agreement (&lt;0.1% lower for Crossbow) are likely due to the SOAPsnp study's use of additional filters to remove some SNPs prior to the agreement calculation, and to differences in alignment policies between SOAP and Bowtie. After filtering, Crossbow reports a total of 3,738,786 SNPs across all autosomal chromosomes and chromosome X, whereas the SNP GFF file available from the YanHaung site [<xref ref-type="bibr" rid="B23">23</xref>] reports a total of 3,072,564 SNPs across those chromosomes. This difference is also likely due to the SOAPsnp study's more stringent filtering.</p>
    </sec>
    <sec>
      <title>Cloud performance</title>
      <p>The above results were computed on a Hadoop 0.20 cluster with 10 worker nodes located in our laboratory, where it required about 1 day of wall clock time to run. Each node is a four-core 3.2 GHz Intel Xeon (40 cores total) running 64-bit Redhat Enterprise Linux Server 5.3 with 4 GB of physical memory and 366 GB of local storage available for the Hadoop Distributed Filesystem (HDFS) and connected via gigabit ethernet. We also performed this computation using Amazon's EC2 service on clusters of 10, 20 and 40 nodes (80, 160, and 320 cores) running Hadoop 0.20. In each case, the Crossbow pipeline was executed end-to-end using scripts distributed with the Crossbow package. In the 10-, 20- and 40-node experiments, each individual node was an EC2 Extra Large High CPU Instance, that is, a virtualized 64-bit computer with 7 GB of memory and the equivalent of 8 processor cores clocked at approximately 2.5 to 2.8 Ghz. At the time of this writing, the cost of such nodes was $0.68 ($0.76 in Europe) per node per hour.</p>
      <p>Before running Crossbow, the short read data must be stored on a filesystem the Hadoop cluster can access. When the Hadoop cluster is rented from Amazon's EC2 service, users will typically upload input data to Amazon's Simple Storage Service (S3) [<xref ref-type="bibr" rid="B24">24</xref>], a service for storing large datasets over the Internet. For small datasets, data transfers typically complete very quickly, but for large datasets (for example, more than 100 GB of compressed short read data), transfer time can be significant. An efficient method to copy large datasets to S3 is to first allocate an EC2 cluster of many nodes and have each node transfer a subset of the data from the source to S3 in parallel. Crossbow is distributed with a Hadoop program and driver scripts for performing these bulk parallel copies while also preprocessing the reads into the form required by Crossbow. We used this software to copy 103 gigabytes of compressed short read data from a public FTP server located at the European Bioinformatics Institute in the UK to an S3 repository located in the US in about 1 hour 15 minutes (approximately 187 Mb/s effective transfer rate). The transfer cost approximately $28: about $3.50 ($3.80 in Europe) in cluster rental fees and about $24 ($24 in Europe) in data transfer fees.</p>
      <p>Transfer time depends heavily on both the size of the data and the speed of the Internet uplink at the source. Public archives like NCBI and the European Bioinformatics Institute (EBI) have very high-bandwidth uplinks to the &gt;10 Gb/s JANET and Internet2 network backbones, as do many academic institutions. However, even at these institutions, the bandwidth available for a given server or workstation can be considerably less (commonly 100 Mb/s or less). Delays due to slow uplinks can be mitigated by transferring large datasets in stages as reads are generated by the sequencer, rather than all at once.</p>
      <p>To measure how the whole-genome Crossbow computation scales, separate experiments were performed using 10, 20 and 40 EC2 Extra Large High CPU nodes. Table <xref ref-type="table" rid="T4">4</xref> presents the wall clock running time and approximate cost for each experiment. The experiment was performed once for each cluster size. The results show that Crossbow is capable of calling SNPs from 38-fold coverage of the human genome in under 3 hours of wall clock time and for about $85 ($96 in Europe).</p>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Timing and cost for Crossbow experiments using reads from the Wang <italic>et al</italic>. study [<xref ref-type="bibr" rid="B5">5</xref>]</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">EC2 Nodes</th>
              <th align="right">1 master, 10 workers</th>
              <th align="right">1 master, 20 workers</th>
              <th align="right">1 master, 40 workers</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Worker CPU cores</td>
              <td align="right">80</td>
              <td align="right">160</td>
              <td align="right">320</td>
            </tr>
            <tr>
              <td align="left">Wall clock time</td>
              <td align="right">6 h:30 m</td>
              <td align="right">4 h:33 m</td>
              <td align="right">2 h:53 m</td>
            </tr>
            <tr>
              <td align="left">Approximate cluster setup time</td>
              <td align="right">18 m</td>
              <td align="right">18 m</td>
              <td align="right">21 m</td>
            </tr>
            <tr>
              <td align="left">Approximate crossbow time</td>
              <td align="right">6 h:12 m</td>
              <td align="right">4 h:15 m</td>
              <td align="right">2 h:32 m</td>
            </tr>
            <tr>
              <td align="left">Approximate cost (US/Europe)</td>
              <td align="right">$52.36/$60.06</td>
              <td align="right">$71.40/$81.90</td>
              <td align="right">$83.64/$95.94</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Costs are approximate and based on the pricing as of this writing, that is, $0.68 per extra-large high-CPU EC2 node per hour in the US and $0.78 in Europe. Times can vary subject to, for example, congestion and Internet traffic conditions.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Figure <xref ref-type="fig" rid="F1">1</xref> illustrates scalability of the computation as a function of the number of processor cores allocated. Units on the vertical axis are the reciprocal of the wall clock time. Whereas wall clock time measures elapsed time, its reciprocal measures throughput - that is, experiments per hour. The straight diagonal line extending from the 80-core point represents hypothetical linear speedup, that is, extrapolated throughput under the assumption that doubling the number of processors also doubles throughput. In practice, parallel algorithms usually exhibit worse-than-linear speedup because portions of the computation are not fully parallel. In the case of Crossbow, deviation from linear speedup is primarily due to load imbalance among CPUs in the map and reduce phases, which can cause a handful of work-intensive 'straggler' tasks to delay progress. The reduce phase can also experience imbalance due to, for example, variation in coverage.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Number of worker CPU cores allocated from EC2 versus throughput measured in experiments per hour: that is, the reciprocal of the wall clock time required to conduct a whole-human experiment on the Wang <italic>et al</italic>. dataset [<xref ref-type="bibr" rid="B5">5</xref>]. The line labeled 'linear speedup' traces hypothetical linear speedup relative to the throughput for 80 CPU cores.</p>
        </caption>
        <graphic xlink:href="gb-2009-10-11-r134-1"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec>
      <title>Alignment and SNP calling in Hadoop</title>
      <p>Hadoop is an implementation of the MapReduce parallel programming model. Under Hadoop, programs are expressed as a series of map and reduce phases operating on tuples of data. Though not all programs are easily expressed this way, Hadoop programs stand to benefit from services provided by Hadoop. For instance, Hadoop programs need not deal with particulars of how work and data are distributed across the cluster; these details are handled by Hadoop, which automatically partitions, sorts and routes data among computers and processes. Hadoop also provides fault tolerance by partitioning files into chunks and storing them redundantly on the HDFS. When a subtask fails due to hardware or software errors, Hadoop restarts the task automatically, using a cached copy of its input data.</p>
      <p>A mapper is a short program that runs during the map phase. A mapper receives a tuple of input data, performs a computation, and outputs zero or more tuples of data. A tuple consists of a key and a value. For example, within Crossbow a read is represented as a tuple where the key is the read's name and the value equals the read's sequence and quality strings. The mapper is generally constrained to be stateless - that is, the content of an output tuple may depend only on the content of the corresponding input tuple, and not on previously observed tuples. This enables MapReduce to safely execute many instances of the mapper in parallel. Similar to a mapper, a reducer is a short program that runs during the reduce phase, but with the added condition that a single instance of the reducer will receive all tuples from the map phase with the same key. In this way, the mappers typically compute partial results, and the reducer finalizes the computation using all the tuples with the same key, and outputs zero or more output tuples. The reducer is also constrained to be stateless - that is, the content of an output tuple may depend only the content of the tuples in the incoming batch, not on any other previously observed input tuples. Between the map and reduce phases, Hadoop automatically executes a sort/shuffle phase that bins and sorts tuples according to primary and secondary keys before passing batches on to reducers. Because mappers and reducers are stateless, and because Hadoop itself handles the sort/shuffle phase, Hadoop has significant freedom in how it distributes parallel chunks of work across the cluster.</p>
      <p>The chief insight behind Crossbow is that alignment and SNP calling can be framed as a series of map, sort/shuffle and reduce phases. The map phase is short read alignment where input tuples represent reads and output tuples represent alignments. The sort/shuffle phase bins alignments according to the genomic region ('partition') aligned to. The sort/shuffle phase also sorts alignments along the forward strand of the reference in preparation for consensus calling. The reduce phase calls SNPs for a given partition, where input tuples represent the sorted list of alignments occurring in the partition and output tuples represent SNP calls.</p>
      <p>A typical Hadoop program consists of Java classes implementing the mapper and reducer running in parallel on many compute nodes. However, Hadoop also supports a 'streaming' mode of operation whereby the map and reduce functions are delegated to command-line scripts or compiled programs written in any language. In streaming mode, Hadoop executes the streaming programs in parallel on different compute nodes, and passes tuples into and out of the program as tab-delimited lines of text written to the 'standard in' and 'standard out' file handles. This allows Crossbow to reuse existing software for aligning reads and calling SNPs while automatically gaining the scaling benefits of Hadoop. For alignment, Crossbow uses Bowtie [<xref ref-type="bibr" rid="B17">17</xref>], which employs a Burrows-Wheeler index [<xref ref-type="bibr" rid="B25">25</xref>] based on the full-text minute-space (FM) index [<xref ref-type="bibr" rid="B26">26</xref>] to enable fast and memory-efficient alignment of short reads to mammalian genomes.</p>
      <p>To report SNPs, Crossbow uses SOAPsnp [<xref ref-type="bibr" rid="B18">18</xref>], which combines multiple techniques to provide high-accuracy haploid or diploid consensus calls from short read alignment data. At the core of SOAPsnp is a Bayesian SNP model with configurable prior probabilities. SOAPsnp's priors take into account differences in prevalence between, for example, heterozygous versus homozygous SNPs and SNPs representing transitions versus those representing transversions. SOAPsnp can also use previously discovered SNP loci and allele frequencies to refine priors. Finally, SOAPsnp recalibrates the quality values provided by the sequencer according to a four-dimensional training matrix representing observed error rates among uniquely aligned reads. In a previous study, human genotype calls obtained using the SOAP aligner and SOAPsnp exhibited greater than 99% agreement with genotype calls obtained using an Illumina 1 M BeadChip assay of the same Han Chinese individual [<xref ref-type="bibr" rid="B18">18</xref>].</p>
      <p>Crossbow's efficiency requires that the three MapReduce phases, map, sort/shuffle and reduce, each be efficient. The map and reduce phases are handled by Bowtie and SOAPsnp, respectively, which have been shown to perform efficiently in the context of human resequencing. But another advantage of Hadoop is that its implementation of the sort/shuffle phase is extremely efficient, even for human resequencing where mappers typically output billions of alignments and hundreds of gigabytes of data to be sorted. Hadoop's file system (HDFS) and intelligent work scheduling make it especially well suited for huge sort tasks, as evidenced by the fact that a 1,460-node Hadoop cluster currently holds the speed record for sorting 1 TB of data on commodity hardware (62 seconds) [<xref ref-type="bibr" rid="B27">27</xref>].</p>
    </sec>
    <sec>
      <title>Modifications to existing software</title>
      <p>Several new features were added to Bowtie to allow it to operate within Hadoop. A new input format (option --12) was added, allowing Bowtie to recognize the one-read-per-line format produced by the Crossbow preprocessor. New command-line options --mm and --shmem instruct Bowtie to use memory-mapped files or shared memory, respectively, for loading and storing the reference index. These features allow many Bowtie processes, each acting as an independent mapper, to run in parallel on a multi-core computer while sharing a single in-memory image of the reference index. This maximizes alignment throughput when cluster computers contain many CPUs but limited memory. Finally, a Crossbow-specific output format was implemented that encodes an alignment as a tuple where the tuple's key identifies a reference partition and the value describes the alignment. Bowtie detects instances where a reported alignment spans a boundary between two reference partitions, in which case Bowtie outputs a pair of alignment tuples with identical values but different keys, each identifying one of the spanned partitions. These features are enabled via the --partition option, which also sets the reference partition size.</p>
      <p>The version of SOAPsnp used in Crossbow was modified to accept alignment records output by modified Bowtie. Speed improvements were also made to SOAPsnp, including an improvement for the case where the input alignments cover only a small interval of a chromosome, as is the case when Crossbow invokes SOAPsnp on a single partition. None of the modifications made to SOAPsnp fundamentally affect how consensus bases or SNPs are called.</p>
    </sec>
    <sec>
      <title>Workflow</title>
      <p>The input to Crossbow is a set of preprocessed read files, where each read is encoded as a tab-delimited tuple. For paired-end reads, both ends are stored on a single line. Conversion takes place as part of a bulk-copy procedure, implemented as a Hadoop program driven by automatic scripts included with Crossbow. Once preprocessed reads are situated on a filesystem accessible to the Hadoop cluster, the Crossbow MapReduce job is invoked (Figure <xref ref-type="fig" rid="F2">2</xref>). Crossbow's map phase is short read alignment by Bowtie. For fast alignment, Bowtie employs a compact index of the reference sequence, requiring about 3 Gb of memory for the human genome. The index is distributed to all computers in the cluster either via Hadoop's file caching facility or by instructing each node to independently obtain the index from a shared filesystem. The map phase outputs a stream of alignment tuples where each tuple has a primary key containing chromosome and partition identifiers, and a secondary key containing the chromosome offset. The tuple's value contains the aligned sequence and quality values. The soft/shuffle phase, which is handled by Hadoop, uses Hadoop's KeyFieldBasedPartitioner to bin alignments according to the primary key and sort according to the secondary key. This allows separate reference partitions to be processed in parallel by separate reducers. It also ensures that each reducer receives alignments for a given partition in sorted order, a necessary first step for calling SNPs with SOAPsnp.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Crossbow workflow. Previously copied and pre-processed read files are downloaded to the cluster, decompressed and aligned using many parallel instances of Bowtie. Hadoop then bins and sorts the alignments according to primary and secondary keys. Sorted alignments falling into each reference partition are then submitted to parallel instances of SOAPsnp. The final output is a stream of SNP calls made by SOAPsnp.</p>
        </caption>
        <graphic xlink:href="gb-2009-10-11-r134-2"/>
      </fig>
      <p>The reduce phase performs SNP calling using SOAPsnp. A wrapper script performs a separate invocation of the SOAPsnp program per partition. The wrapper also ensures that SOAPsnp is invoked with appropriate options given the ploidy of the reference partition. Files containing known SNP locations and allele frequencies derived from dbSNP [<xref ref-type="bibr" rid="B28">28</xref>] are distributed to worker nodes via the same mechanism used to distribute the Bowtie index. The output of the reduce phase is a stream of SNP tuples, which are stored on the cluster's distributed filesystem. The final stage of the Crossbow workflow archives the SNP calls and transfers them from the cluster's distributed filesystem to the local filesystem.</p>
    </sec>
    <sec>
      <title>Cloud support</title>
      <p>Crossbow comes with scripts that automate the Crossbow pipeline on a local cluster or on the EC2 [<xref ref-type="bibr" rid="B21">21</xref>] utility computing service. The EC2 driver script can be run from any Internet-connected computer; however, all the genomic computation is executed remotely. The script runs Crossbow by: allocating an EC2 cluster using the Amazon Web Services tools; uploading the Crossbow program code to the master node; launching Crossbow from the master; downloading the results from the cluster to the local computer; and optionally terminating the cluster, as illustrated in Figure <xref ref-type="fig" rid="F3">3</xref>. The driver script detects common problems that can occur in the cluster allocation process, including when EC2 cannot provide the requested number of instances due to high demand. The overall process is identical to running on a local dedicated cluster, except cluster nodes are allocated as requested.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Four basic steps to running the Crossbow computation. Two scenarios are shown: one where Amazon's EC2 and S3 services are used, and one where a local cluster is used. In step 1 (red) short reads are copied to the permanent store. In step 2 (green) the cluster is allocated (may not be necessary for a local cluster) and the scripts driving the computation are uploaded to the master node. In step 3 (blue) the computation is run. The computation download reads from the permanent store, operates on them, and stores the results in the Hadoop distributed filesystem. In step 4 (orange), the results are copied to the client machine and the job completes. SAN (Storage Area Network) and NAS (Network-Attached Storage) are two common ways of sharing filesystems across a local network.</p>
        </caption>
        <graphic xlink:href="gb-2009-10-11-r134-3"/>
      </fig>
    </sec>
    <sec>
      <title>Genotyping experiment</title>
      <p>We generated 40-fold coverage of chromosomes 22 and X (NCBI 36.3_ using 35-bp paired-end reads. Quality values were assigned by randomly selecting observed quality strings from a pair of FASTQ files in the Wang <italic>et al</italic>. [<xref ref-type="bibr" rid="B5">5</xref>] dataset (080110_EAS51_FC20B21AAXX_L7_YHPE_PE1). The mean and median quality values among those in this subset are 21.4 and 27, respectively, on the Solexa scale. Sequencing errors were simulated at each position at the rate dictated by the quality value at that position. For instance, a position with Solexa quality 30 was changed to a different base with a probability of 1 in 1,000. The three alternative bases were considered equally likely.</p>
      <p>Insert lengths were assigned by randomly selecting from a set of observed insert lengths. Observed insert lengths were obtained by aligning a pair of paired-end FASTQ files (the same pair used to simulate the quality values) using Bowtie with options '-X 10000 -v 2 --strata --best -m 1'. The observed mean mate-pair distance and standard deviation for this subset were 422 bp and 68.8 bp, respectively.</p>
      <p>Bowtie version 0.10.2 was run with the '-v 2 --best --strata -m 1' to obtain unique alignments with up to two mismatches. We define an alignment as unique if all other alignments for that read have strictly more mismatches. SOAPsnp was run with the rank-sum and binomial tests enabled (-u and -n options, respectively) and with known-SNP refinement enabled (-2 and -s options). Positions and allele frequencies for known SNPs were calculated according to the same HapMap SNP data used to simulate SNPs. SOAPsnp's prior probabilities for novel homozygous and heterozygous SNPs were set to the rates used by the simulator (-r 0.0001 -e 0.0002 for chromosome 22 and -r 0.0002 for chromosome X).</p>
      <p>An instance where Crossbow reports a SNP on a diploid portion of the genome was discarded (that is, considered to be homozygous for the reference allele) if it was covered by fewer than four uniquely aligned reads. For a haploid portion, a SNP was discarded if covered by fewer than two uniquely aligned reads. For either diploid or haploid portions, a SNP was discarded if the call quality as reported by SOAPsnp was less than 20.</p>
    </sec>
    <sec>
      <title>Whole-human resequencing experiment</title>
      <p>Bowtie version 0.10.2 and a modified version of SOAPsnp 1.02 were used. Both were compiled for 64-bit Linux. Bowtie was run with the '-v 2 --best --strata -m 1' options, mimicking the alignment and reporting modes used in the SOAPsnp study. A modified version of SOAPsnp 1.02 was run with the rank-sum and binomial tests enabled (-u and -n options, respectively) and with known-SNP refinement enabled (-2 and -s options). Positions for known SNPs were calculated according to data in dbSNP [<xref ref-type="bibr" rid="B28">28</xref>] versions 128 and 130, and allele frequencies were calculated according to data from the HapMap project [<xref ref-type="bibr" rid="B22">22</xref>]. Only positions occurring in dbSNP version 128 were provided to SOAPsnp. This was to avoid biasing the result by including SNPs submitted by Wang <italic>et al</italic>. [<xref ref-type="bibr" rid="B5">5</xref>] to dbSNP version 130. SOAPsnp's prior probabilities for novel homozygous and heterozygous SNPs were left at their default values of 0.0005 and 0.001, respectively. Since the subject was male, SOAPsnp was configured to treat autosomal chromosomes as diploid and sex chromosomes as haploid.</p>
      <p>To account for base-calling errors and inaccurate quality values reported by the Illumina software pipeline [<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>], SOAPsnp recalibrates quality values according to a four-dimensional matrix recording observed error rates. Rates are calculated across a large space of parameters, the dimensions of which include sequencing cycle, reported quality value, reference allele and subject allele. In the previous study, separate recalibration matrices were trained for each human chromosome; that is, a given chromosome's matrix was trained using all reads aligning uniquely to that chromosome. In this study, each chromosome is divided into non-overlapping stretches of 2 million bases and a separate matrix is trained and used for each partition. Thus, each recalibration matrix receives less training data than if matrices were trained per-chromosome. Though the results indicate that this does not affect accuracy significantly, future work for Crossbow includes merging recalibration matrices for partitions within a chromosome prior to genotyping.</p>
      <p>An instance where Crossbow reports a SNP on a diploid portion of the genome is discarded (that is, considered to be homozygous for the reference allele) if it is covered by fewer than four unique alignments. For a haploid portion, a SNP is discarded if covered by fewer than two unique alignments. For either diploid or haploid portions, a SNP is discarded if the call quality as reported by SOAPsnp is less than 20. Note that the SOAPsnp study applies additional filters to discard SNPs at positions that, for example, are not covered by any paired-end reads or appear to have a high copy number. Adding such filters to Crossbow is future work.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In this paper we have demonstrated that cloud computing realized by MapReduce and Hadoop can be leveraged to efficiently parallelize existing serial implementations of sequence alignment and genotyping algorithms. This combination allows large datasets of DNA sequences to be analyzed rapidly without sacrificing accuracy or requiring extensive software engineering efforts to parallelize the computation.</p>
    <p>We describe the implementation of an efficient whole-genome genotyping tool, Crossbow, that combines two previously published software tools: the sequence aligner Bowtie and the SNP caller SOAPsnp. Crossbow achieves at least 98.9% accuracy on simulated datasets of individual chromosomes, and better than 99.8% concordance with the Illumina 1 M BeadChip assay of a sequenced individual. These accuracies are comparable to those achieved in the prior SOAPsnp study once filtering stringencies are taken into account.</p>
    <p>When run on conventional computers, a deep-coverage human resequencing project requires weeks of time to analyze on a single computer by contrast, Crossbow aligns and calls SNPs from the same dataset in less than 3 hours on a 320-core cluster. By taking advantage of commodity processors available via cloud computing services, Crossbow condenses over 1,000 hours of computation into a few hours without requiring the user to own or operate a computer cluster. In addition, running on standard software (Hadoop) and hardware (EC2 instances) makes it easier for other researchers to reproduce our results or execute their own analysis with Crossbow.</p>
    <p>Crossbow scales well to large clusters by leveraging Hadoop and the established, fast Bowtie and SOAPsnp algorithms with limited modifications. The ultrafast Bowtie alignment algorithm, utilizing a quality-directed best-first-search of the FM index, is especially important to the overall performance of Crossbow relative to CloudBurst. Crossbow's alignment stage vastly outperforms the fixed-seed seed-and-extend search algorithm of CloudBurst on clusters of the same size. We expect that the Crossbow infrastructure will serve as a foundation for bringing massive scalability to other high-volume sequencing experiments, such as RNA-seq and ChIP-seq. In our experiments, we demonstrated that Crossbow works equally well either on a local cluster or a remote cluster, but in the future we expect that utility computing services will make cloud computing applications widely available to any researcher.</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>EC2: Elastic Compute Cloud; FM: full-text minute-space; HDFS: Hadoop Distributed Filesystem; NCBI: National Center for Biotechnology Information; S3: Simple Storage Service; SNP: single nucleotide polymorphism.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>BL and MCS developed the algorithms, collected results, and wrote the software. JL contributed to discussions on algorithms. BL, MCS, JL, MP, and SLS wrote the manuscript.</p>
  </sec>
  <sec>
    <title>Additional data files</title>
    <p>The following additional data are included with the online version of this article: version 0.1.3 of the Crossbow software (Additional data file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional data file 1</title>
        <p>Version 0.1.3 of the Crossbow software.</p>
      </caption>
      <media xlink:href="gb-2009-10-11-r134-S1.ZIP" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was funded in part by NSF grant IIS-0844494 (MP) and by NIH grants R01-LM006845 (SLS) and R01-HG004885 (MP). We thank the Amazon Web Services Hadoop Testing Program for providing credits, and Deepak Singh for his assistance. We also thank Miron Livny and his team for providing access to their compute cluster.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ahn</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>TH</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Ghang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>BC</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>SY</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>WY</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>YS</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Reja</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Jho</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>CG</given-names>
        </name>
        <name>
          <surname>Cha</surname>
          <given-names>JY</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>KH</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Bhak</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>SJ</given-names>
        </name>
        <article-title>The first Korean genome sequence and analysis: full genome sequencing for a socio-ethnic group.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1622</fpage>
        <lpage>1629</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.092197.109</pub-id>
        <pub-id pub-id-type="pmid">19470904</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bentley</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Balasubramanian</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Swerdlow</surname>
          <given-names>HP</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Milton</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Brown</surname>
          <given-names>CG</given-names>
        </name>
        <name>
          <surname>Hall</surname>
          <given-names>KP</given-names>
        </name>
        <name>
          <surname>Evers</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Barnes</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Bignell</surname>
          <given-names>HR</given-names>
        </name>
        <name>
          <surname>Boutell</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Bryant</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Keira Cheetham</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cox</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Ellis</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Flatbush</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Gormley</surname>
          <given-names>NA</given-names>
        </name>
        <name>
          <surname>Humphray</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Irving</surname>
          <given-names>LJ</given-names>
        </name>
        <name>
          <surname>Karbelashvili</surname>
          <given-names>MS</given-names>
        </name>
        <name>
          <surname>Kirk</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Maisinger</surname>
          <given-names>KS</given-names>
        </name>
        <name>
          <surname>Murray</surname>
          <given-names>LJ</given-names>
        </name>
        <name>
          <surname>Obradovic</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Ost</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Parkinson</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Pratt</surname>
          <given-names>MR</given-names>
        </name>
        <etal/>
        <article-title>Accurate whole human genome sequencing using reversible terminator chemistry.</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>53</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07517</pub-id>
        <pub-id pub-id-type="pmid">18987734</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ley</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Mardis</surname>
          <given-names>ER</given-names>
        </name>
        <name>
          <surname>Ding</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Fulton</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>McLellan</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Dooling</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Dunford-Shore</surname>
          <given-names>BH</given-names>
        </name>
        <name>
          <surname>McGrath</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hickenbotham</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Cook</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Abbott</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Larson</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>Koboldt</surname>
          <given-names>DC</given-names>
        </name>
        <name>
          <surname>Pohl</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hawkins</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Abbott</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Locke</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Hillier</surname>
          <given-names>LW</given-names>
        </name>
        <name>
          <surname>Miner</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Fulton</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Magrini</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Wylie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Glasscock</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Conyers</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Sander</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Shi</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Osborne</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Minx</surname>
          <given-names>P</given-names>
        </name>
        <etal/>
        <article-title>DNA sequencing of a cytogenetically normal acute myeloid leukaemia genome.</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>66</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07485</pub-id>
        <pub-id pub-id-type="pmid">18987736</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>McKernan</surname>
          <given-names>KJ</given-names>
        </name>
        <name>
          <surname>Peckham</surname>
          <given-names>HE</given-names>
        </name>
        <name>
          <surname>Costa</surname>
          <given-names>GL</given-names>
        </name>
        <name>
          <surname>McLaughlin</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Fu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Tsung</surname>
          <given-names>EF</given-names>
        </name>
        <name>
          <surname>Clouser</surname>
          <given-names>CR</given-names>
        </name>
        <name>
          <surname>Duncan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Ichikawa</surname>
          <given-names>JK</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>CC</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Ranade</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Dimalanta</surname>
          <given-names>ET</given-names>
        </name>
        <name>
          <surname>Hyland</surname>
          <given-names>FC</given-names>
        </name>
        <name>
          <surname>Sokolsky</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Sheridan</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Hendrickson</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Kotler</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Stuart</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Malek</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Manning</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Antipova</surname>
          <given-names>AA</given-names>
        </name>
        <name>
          <surname>Perez</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>MP</given-names>
        </name>
        <name>
          <surname>Hayashibara</surname>
          <given-names>KC</given-names>
        </name>
        <name>
          <surname>Lyons</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Beaudoin</surname>
          <given-names>RE</given-names>
        </name>
        <etal/>
        <article-title>Sequence and structural variation in a human genome uncovered by short-read, massively parallel ligation sequencing using two-base encoding.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1527</fpage>
        <lpage>1541</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.091868.109</pub-id>
        <pub-id pub-id-type="pmid">19546169</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Tian</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Goodman</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Fan</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Guo</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Fang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Liang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Du</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Zheng</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Hellmann</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Inouye</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pool</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Yi</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Duan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Qin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>L</given-names>
        </name>
        <etal/>
        <article-title>The diploid genome sequence of an Asian individual.</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07484</pub-id>
        <pub-id pub-id-type="pmid">18987735</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lister</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ecker</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Finding the fifth base: genome-wide sequencing of cytosine methylation.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>959</fpage>
        <lpage>966</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.083451.108</pub-id>
        <pub-id pub-id-type="pmid">19273618</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tuteja</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>White</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Schug</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kaestner</surname>
          <given-names>KH</given-names>
        </name>
        <article-title>Extracting transcription factor targets from ChIP-Seq data.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>e113</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp536</pub-id>
        <pub-id pub-id-type="pmid">19553195</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mortazavi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Williams</surname>
          <given-names>BA</given-names>
        </name>
        <name>
          <surname>McCue</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Schaeffer</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wold</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq.</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1226</pub-id>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pachter</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>TopHat: discovering splice junctions with RNA-Seq.</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp120</pub-id>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="other">
        <article-title>Illumina Presents Development Roadmap for Scaling its Genome Analyzer: Innovations to substantially increase output, decrease cost, and expand applications</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://investor.illumina.com/phoenix.zhtml?c=121127&amp;p=irol-newsArticle_print&amp;ID=1252407&amp;highlight=">http://investor.illumina.com/phoenix.zhtml?c=121127&amp;p=irol-newsArticle_print&amp;ID=1252407&amp;highlight=</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pushkarev</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Neff</surname>
          <given-names>NF</given-names>
        </name>
        <name>
          <surname>Quake</surname>
          <given-names>SR</given-names>
        </name>
        <article-title>Single-molecule sequencing of an individual human genome.</article-title>
        <source>Nat Biotechnol</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>847</fpage>
        <lpage>852</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1561</pub-id>
        <pub-id pub-id-type="pmid">19668243</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Simpson</surname>
          <given-names>JT</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Jackman</surname>
          <given-names>SD</given-names>
        </name>
        <name>
          <surname>Schein</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Birol</surname>
          <given-names>I</given-names>
        </name>
        <article-title>ABySS: a parallel assembler for short read sequence data.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1117</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.089532.108</pub-id>
        <pub-id pub-id-type="pmid">19251739</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="book">
        <name>
          <surname>Jackson</surname>
          <given-names>BG</given-names>
        </name>
        <name>
          <surname>Schnable</surname>
          <given-names>PS</given-names>
        </name>
        <name>
          <surname>Aluru</surname>
          <given-names>S</given-names>
        </name>
        <person-group person-group-type="editor">Rajasekaran S</person-group>
        <article-title>Assembly of large genomes from paired short reads.</article-title>
        <source>Proceedings of the 1st International Conference on Bioinformatics and Computational Biology: 8-10 April 2009; New Orleans, Louisiana, United States. New Orleans, LA</source>
        <year>2009</year>
        <publisher-name>Springer-Verlag</publisher-name>
        <fpage>30</fpage>
        <lpage>43</lpage>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="book">
        <name>
          <surname>Dean</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ghemawat</surname>
          <given-names>S</given-names>
        </name>
        <article-title>MapReduce: simplified data processing on large clusters.</article-title>
        <source>Proceedings of the 6th Symposium on Operating Systems Design &amp; Implementation: 6-8 December 2004; San Francisco, California, USA</source>
        <year>2004</year>
        <volume>6</volume>
        <publisher-name>ACM, New York, NY, USA</publisher-name>
        <fpage>137</fpage>
        <lpage>150</lpage>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="other">
        <article-title>Apache Hadoop</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://hadoop.apache.org/">http://hadoop.apache.org/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schatz</surname>
          <given-names>MC</given-names>
        </name>
        <article-title>CloudBurst: highly sensitive read mapping with MapReduce.</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1363</fpage>
        <lpage>1369</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp236</pub-id>
        <pub-id pub-id-type="pmid">19357099</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pop</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome.</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Fang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <article-title>SNP detection for massively parallel whole-genome resequencing.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1124</fpage>
        <lpage>1132</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.088013.108</pub-id>
        <pub-id pub-id-type="pmid">19420381</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>SOAP: short oligonucleotide alignment program.</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>713</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn025</pub-id>
        <pub-id pub-id-type="pmid">18227114</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="other">
        <article-title>Crossbow: Whole Genome Resequencing using Cloud Computing.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bowtie-bio.sourceforge.net/crossbow/">http://bowtie-bio.sourceforge.net/crossbow/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="other">
        <article-title>Amazon Elastic Compute Cloud</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/ec2/">http://aws.amazon.com/ec2/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Frazer</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Ballinger</surname>
          <given-names>DG</given-names>
        </name>
        <name>
          <surname>Cox</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Hinds</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Stuve</surname>
          <given-names>LL</given-names>
        </name>
        <name>
          <surname>Gibbs</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Belmont</surname>
          <given-names>JW</given-names>
        </name>
        <name>
          <surname>Boudreau</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hardenbol</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Leal</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Pasternak</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wheeler</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Willis</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gao</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Pan</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Tang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>H</given-names>
        </name>
        <etal/>
        <article-title>A second generation human haplotype map of over 3.1 million SNPs.</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>851</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06258</pub-id>
        <pub-id pub-id-type="pmid">17943122</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="other">
        <article-title>YanHuang Project: YH1 Genome Database</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://yh.genomics.org.cn/">http://yh.genomics.org.cn/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="other">
        <article-title>Amazon Simple Storage Service</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/s3/">http://aws.amazon.com/s3/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="book">
        <name>
          <surname>Burrows</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Wheeler</surname>
          <given-names>DJ</given-names>
        </name>
        <source>A Block-sorting Lossless Data Compression Algorithm. Technical Report 124</source>
        <year>1994</year>
        <publisher-name>Palo Alto, CA: Digital Systems Research Center</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book">
        <name>
          <surname>Ferragina</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Manzini</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Opportunistic data structures with applications.</article-title>
        <source>Proceedings of the 41st Annual Symposium on Foundations of Computer Science</source>
        <year>2000</year>
        <publisher-name>IEEE Computer Society, Los Alamitos, California USA</publisher-name>
        <fpage>390</fpage>
        <lpage>398</lpage>
        <comment>full_text</comment>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="other">
        <article-title>Sort Benchmark Home Page.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://sortbenchmark.org/">http://sortbenchmark.org/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sherry</surname>
          <given-names>ST</given-names>
        </name>
        <name>
          <surname>Ward</surname>
          <given-names>MH</given-names>
        </name>
        <name>
          <surname>Kholodov</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Baker</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Phan</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Smigielski</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Sirotkin</surname>
          <given-names>K</given-names>
        </name>
        <article-title>dbSNP: the NCBI database of genetic variation.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>308</fpage>
        <lpage>311</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/29.1.308</pub-id>
        <pub-id pub-id-type="pmid">11125122</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="other">
        <name>
          <surname>Corrada Bravo</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Irizarry</surname>
          <given-names>RA</given-names>
        </name>
        <article-title>Model-based quality assessment and base-calling for second-generation sequencing data.</article-title>
        <source>Biometrics</source>
        <comment> in press </comment>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dohm</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Lottaz</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Borodina</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Himmelbauer</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn425</pub-id>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
