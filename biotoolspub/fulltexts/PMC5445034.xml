<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5445034</article-id>
    <article-id pub-id-type="publisher-id">219</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-017-0219-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comprehensive comparison of in silico MS/MS fragmentation tools of the CASMI contest: database boosting is needed to achieve 93% accuracy</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Blaženović</surname>
          <given-names>Ivana</given-names>
        </name>
        <address>
          <email>iblazenovic@ucdavis.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kind</surname>
          <given-names>Tobias</given-names>
        </name>
        <address>
          <email>tkind@ucdavis.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torbašinović</surname>
          <given-names>Hrvoje</given-names>
        </name>
        <address>
          <email>hrvoje.torbasinovic@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Obrenović</surname>
          <given-names>Slobodan</given-names>
        </name>
        <address>
          <email>janjetina77@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mehta</surname>
          <given-names>Sajjan S.</given-names>
        </name>
        <address>
          <email>ssmehta@ucdavis.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tsugawa</surname>
          <given-names>Hiroshi</given-names>
        </name>
        <address>
          <email>hiroshi.tsugawa@riken.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wermuth</surname>
          <given-names>Tobias</given-names>
        </name>
        <address>
          <email>tobynextdoor@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schauer</surname>
          <given-names>Nicolas</given-names>
        </name>
        <address>
          <email>schauer@metabolomicdiscoveries.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jahn</surname>
          <given-names>Martina</given-names>
        </name>
        <address>
          <email>mjahn@tu-bs.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Biedendieck</surname>
          <given-names>Rebekka</given-names>
        </name>
        <address>
          <email>r.biedendieck@tu-braunschweig.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jahn</surname>
          <given-names>Dieter</given-names>
        </name>
        <address>
          <email>d.jahn@tu-bs.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6261-8928</contrib-id>
        <name>
          <surname>Fiehn</surname>
          <given-names>Oliver</given-names>
        </name>
        <address>
          <phone>+1-530-754-8258</phone>
          <phone>+1-530-752-9922</phone>
          <email>ofiehn@ucdavis.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1090 0254</institution-id><institution-id institution-id-type="GRID">grid.6738.a</institution-id><institution/><institution>Technische Universität Braunschweig - Institute of Microbiology, </institution></institution-wrap>Brunswick, Germany </aff>
      <aff id="Aff2"><label>2</label>Metabolomic Discoveries GmbH, Potsdam, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9684</institution-id><institution-id institution-id-type="GRID">grid.27860.3b</institution-id><institution>NIH West Coast Metabolomics Center, </institution><institution>UC Davis Genome Center, </institution></institution-wrap>Room 1313, 451 Health Sci Drive, Davis, CA 95616 USA </aff>
      <aff id="Aff4"><label>4</label>Inovatus Ltd, Zagreb, Croatia </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000000094465255</institution-id><institution-id institution-id-type="GRID">grid.7597.c</institution-id><institution/><institution>RIKEN Center for Sustainable Resource Science, </institution></institution-wrap>Yokohama, Kanagawa Japan </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0619 1117</institution-id><institution-id institution-id-type="GRID">grid.412125.1</institution-id><institution>Department of Biochemistry, Faculty of Sciences, </institution><institution>King Abdulaziz University, </institution></institution-wrap>Jeddah, Saudi Arabia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>32</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>In mass spectrometry-based untargeted metabolomics, rarely more than 30% of the compounds are identified. Without the true identity of these molecules it is impossible to draw conclusions about the biological mechanisms, pathway relationships and provenance of compounds. The only way at present to address this discrepancy is to use in silico fragmentation software to identify unknown compounds by comparing and ranking theoretical MS/MS fragmentations from target structures to experimental tandem mass spectra (MS/MS). We compared the 
performance of four publicly available in silico fragmentation algorithms (MetFragCL, CFM-ID, MAGMa+ and MS-FINDER) that participated in the 2016 CASMI challenge. We found that optimizing the use of metadata, weighting factors and the manner of combining different tools eventually defined the ultimate outcomes of each method. We comprehensively analysed how outcomes of different tools could be combined and reached a final success rate of 93% for the training data, and 87% for the challenge data, using a combination of MAGMa+, CFM-ID and compound importance information along with MS/MS matching. Matching MS/MS spectra against the MS/MS libraries without using any in silico tool yielded 60% correct hits, showing that the use of in silico methods is still important.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13321-017-0219-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Compound identification</kwd>
      <kwd>Mass spectrometry</kwd>
      <kwd>Structure elucidation</kwd>
      <kwd>In silico fragmentation</kwd>
      <kwd>MS/MS</kwd>
      <kwd>Metabolomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U24 DK097154</award-id>
        <award-id>P20 HL113452</award-id>
        <award-id>R01 HL091357</award-id>
        <principal-award-recipient>
          <name>
            <surname>Blaženović</surname>
            <given-names>Ivana</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>Oliver</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MCB 1139644</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fiehn</surname>
            <given-names>Oliver</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000968</institution-id>
            <institution>American Heart Association</institution>
          </institution-wrap>
        </funding-source>
        <award-id>15SDG25760020</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kind</surname>
            <given-names>Tobias</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>Many fields of research, from environmental analysis to forensics and biology, are moving towards hypothesis-generating screening approaches using liquid chromatography coupled with tandem mass spectrometry (LC–MS/MS) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Such an approach yields hundreds to thousands of signals per study, most of them having unidentified structures even after comprehensive searches of existing mass spectral libraries such as NIST, MassBank, Metlin or MassBank of North America (MoNA). Overall, tandem mass spectral databases cover less than one per cent of the compound space that is covered in Chemspider or PubChem with 50 to 90 million compounds, respectively. As an alternative strategy for compound annotation of known compounds in silico fragmentation software tools have been developed and are used to identify MS/MS spectra when the reference MS/MS spectrum is not available. Such software tools include MetFrag [<xref ref-type="bibr" rid="CR3">3</xref>], MIDAS [<xref ref-type="bibr" rid="CR4">4</xref>], MAGMa [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], MAGMa+ [<xref ref-type="bibr" rid="CR7">7</xref>], MOLGEN–MS/MS [<xref ref-type="bibr" rid="CR8">8</xref>], CSI:FingerID [<xref ref-type="bibr" rid="CR9">9</xref>], CFM-ID [<xref ref-type="bibr" rid="CR10">10</xref>], FingerID [<xref ref-type="bibr" rid="CR11">11</xref>], Input output kernel regression (IOKR) [<xref ref-type="bibr" rid="CR12">12</xref>] and the MS-Finder software [<xref ref-type="bibr" rid="CR13">13</xref>]. A number of commercial software solutions such as MassFrontier (HighChem), MS-Fragmenter (ACD/Labs) or Molecular Structure Correlator (Agilent) are also available, but lack open access code or algorithm transparency.</p>
    <p>The data for our investigation was obtained from the CASMI website (<ext-link ext-link-type="uri" xlink:href="http://www.casmi-contest.org/2016/">http://www.casmi-contest.org/2016/</ext-link>). The Critical Assessment of Small Molecule Identification (CASMI) contest was founded in 2012 to help scientists with their compound identification methods by providing community challenges and competitions [<xref ref-type="bibr" rid="CR14">14</xref>]. For practical reasons, including the source code and model availability, error handling, batch processing capabilities and the ability to perform local database queries, we only covered in silico fragmentation software that was used for results submitted by the CASMI 2016 deadline.</p>
    <p>We surveyed four different tools, all using different algorithms for in silico fragmentation, MetFragCL, CFM-ID, MAGMa+ and MS-FINDER. MetFragCL retrieves candidate structures and fragments them using a bond dissociation approach and those fragments are then compared to the product ions in a measured spectrum to determine which candidate best explains the measured compound by assigning it a score that is a function of the mass to charge ratio (<italic>m/z</italic>), intensity and bond dissociation energy (BDE) of the matched peaks, while 5 of neutral loss rules account for rearrangements [<xref ref-type="bibr" rid="CR3">3</xref>]. CFM-ID (competitive fragment modelling) employs a method for learning a generative model of collision-induced dissociation fragmentation [<xref ref-type="bibr" rid="CR10">10</xref>]. CFM-ID can be used to assign fragments to spectra to rank the candidates, but also to predict MS/MS spectra from structures alone. MAGMa+ is a parameter-optimized version of the original MAGMa software [<xref ref-type="bibr" rid="CR5">5</xref>]. MAGMa analyses substructures and utilizes different bond dissociations. It furthermore calculates a penalty score for all the bonds that are disconnected and form a specific substructure [<xref ref-type="bibr" rid="CR15">15</xref>]. The improved MAGMa+ version utilized a parameter optimization approach to find optimal processing parameters [<xref ref-type="bibr" rid="CR7">7</xref>]. The MS-FINDER algorithm simulates the alpha-cleavage of linear chains up to three chemical bonds and considers also bond dissociation energies. Multiple bonds (double, triple, or cycles) are modelled as penalized single bonds in which hydrogens are lost (hydrogen rearrangement rules). The total score also includes mass accuracy, isotopic ratio, product ion assignment, neutral loss assignment and existence of the compound in an internal structure database [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. First-principle quantum chemical models for spectrum prediction [<xref ref-type="bibr" rid="CR17">17</xref>] have only been developed for electron ionization but not for electrospray collision-induced dissociation tandem mass spectrometry (ESI-CID-MS/MS).</p>
    <p>The CASMI 2016 contest consisted of three categories. Category 1: “Best Structure identification on Natural Products”, with 19 natural product dereplication challenges. The data for Categories 2 and 3 consist of training sets and challenge sets of 312 and 208 of known compounds, respectively. For Category 2: “Best Automatic Structural Identification—In Silico Fragmentation” no other information than the in silico fragmentation was allowed [<xref ref-type="bibr" rid="CR18">18</xref>]. Category 3: “Best Automatic Structural Identification—Full Information” allowed for any type of additional information to be used, including mixed models, structure rankings and MS/MS search [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p>In order to obtain the ground truth of performance of in silico fragmentation software it is important to exclude all pre-knowledge or any bias such as molecular formula lookup, database ranking or any other means that would influence the score. Furthermore, it is important to include a large number of unknown compounds in order to improve the statistical power of the investigation. We therefore chose the 312 training and 208 challenge MS/MS spectra for investigating the capabilities of current software to perform unbiased batch processing of hundreds of test and validation cases. Additionally, we compare the tools’ performances when more information is allowed to be used and how consensus modelling can improve results.</p>
  </sec>
  <sec id="Sec2" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Tandem mass spectral input data</title>
      <p>The CASMI 2016 website (<ext-link ext-link-type="uri" xlink:href="http://www.casmi-contest.org/2016/">http://www.casmi-contest.org/2016/</ext-link>) provided 312 training and 208 validation files containing MS/MS information as *.MGF file. The MS/MS spectra were acquired on a Q Exactive Plus Hybrid Quadrupole-Orbitrap mass spectrometer (Thermo Fisher), with &lt;5 ppm mass accuracy and MS/MS resolution of 35,000 using ESI ionization. Spectra were collected in stepped 20, 35 and 50 eV in mode. Only [M+H]<sup>+</sup> (positive) and [M−H]<sup>−</sup> ion species were available. Spectral meta-data included the ChemSpider ID, compound name, the monoisotopic mass, molecular formula, SMILES, InChI and InChIKey. Some of the candidate structures provided by the organizers were erroneous and did not match the provided formula, SMILES or InChIKey. After the contest deadline, the CASMI organizers provided all correct results for the 312 training and 208 challenge cases that were used in our evaluation.</p>
    </sec>
    <sec id="Sec4">
      <title>Query compounds from ChemSpider</title>
      <p>For each of the training and validation cases the CASMI team provided possible candidate lists. These compounds were obtained from ChemSpider with a ±5 ppm search window and the structure files contained the ChemSpider ID, compound name, monoisotopic mass, molecular formula, SMILES, InChI and InChIKey. Because compound masses are unevenly distributed, some mass spectra yielded up to 8000 possible structure candidates within the 5 ppm mass window, whereas one mass spectrum was only associated with a single possible candidate structure, pentabromophenol. A total of 432,511 candidates were available for the training set and 258,808 candidates were obtained for the validation set (challenge set).</p>
      <p>Each of the four software tools used different structure-handling libraries or routines, hence structure conversion issues occurred. Such errors can be attributed to salt forms, isotopic elements, radical compounds and conversion issues. Each of the four tested software tools required different input formats and output formats. For that purpose, an application was written in Java to process all output files and analyse the results. It also includes short scripts to help with preparing input files for each tool. Source and result files can be found under (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/insilico-fragmentation/">https://sourceforge.net/projects/insilico-fragmentation/</ext-link>).</p>
    </sec>
    <sec id="Sec5">
      <title>Software settings</title>
      <sec id="Sec6">
        <title>MS-FINDER</title>
        <p>The MS-FINDER software (version 1.70) was downloaded from the Riken institute website (<ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/Metabolomics_Software/MS-FINDER/index.html">http://prime.psc.riken.jp/Metabolomics_Software/MS-FINDER/index.html</ext-link>) and was used on a standard personal computer with a 2.50 GHz Intel Core-i7 CPU and 16 GBytes of RAM under the Windows 10 operating system. MS-FINDER requires specially formatted MS<sup>1</sup> and MS<sup>2</sup> files as input. The settings are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. The MS-FINDER program has a resource folder where two databases are located that the software uses to rank the candidate structures. The file ExistStructureDB_vs8.esd is an internal structure lookup database and the file ExistFormulaDB_vs8.efd (comprising formula from 13 metabolomics databases) is used to prioritize generated molecular formulas. These databases were emptied in order to evaluate the pure in silico fragmentation performances for challenge 2 and a new database was created, analogous to the one of MS-FINDER, using candidate structures provided by the CASMI organizers.</p>
        <p>Both databases were opened in Notepad++ and all data except the header row was deleted and saved in the same format. Settings were adjusted to ±5 ppm mass accuracy and all compounds were processed in batch mode. Detailed information about the process can be obtained from the supplement section.</p>
      </sec>
      <sec id="Sec7">
        <title>CFM-ID</title>
        <p>The CFM-ID software (version 2.2, revision 26) was downloaded from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/cfm-id/and">https://sourceforge.net/projects/cfm-id/and</ext-link> was used on a server with 48-core AMD Opteron 6344 processor (2.6 GHz) running CentOS Linux 7. Out of several available command line utilities, the cfm-id executable was used for this project. Given an input spectrum and a list of candidate SMILES (or InChI) as provided by CASMI, cfm-id computes a predicted spectrum for each candidate and compares it to the input spectrum. It returns a ranking of the candidates according to how closely they match. The original CFM positive and negative models were used for the spectrum prediction, which were originally trained on data from the METLIN database. Mass tolerances of ±5 ppm were used and the Jaccard score and dot product score were applied for spectral comparisons. The dot product produced better rankings when applied in the voting/consensus model and was therefore used. The input spectrum was repeated for the low, medium and high energies, which originally emulate 10, 20 and 40 eV CID MS/MS spectra. Additional information is contained in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      </sec>
      <sec id="Sec8">
        <title>MetFragCL</title>
        <p>The command line version of MetFragCL software (version 2.2-CL) was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/c-ruttkies/MetFrag">https://github.com/c-ruttkies/MetFrag</ext-link> and was used on MacBook Pro with 2.7 GHz Intel Core i5 and 16 GB DDR3. MetFragCL needs a parameter file of specific layout as input and it contains all necessary information for the processing of a given MS/MS peak list. Parameters for fragmentation are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2. Candidate files were prepared with the same application used for the analysis of the results, as mentioned previously. Finally, the in silico fragments are matched against the query peak list provided by CASMI. The measured peaks correspond to the charged fragments, so the matching function adds (positive mode) or removes (negative mode) a proton (1.007 Da) to or from the fragment mass. Additional settings are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      </sec>
      <sec id="Sec9">
        <title>MAGMa+</title>
        <p>The MAGMa+ software was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/savantas/MAGMA-plus">https://github.com/savantas/MAGMA-plus</ext-link> and was used on a cluster node with a 48-core AMD Opteron 6344 processor running CentOS Linux 7. MAGMa+ is an optimized version of the software MAGMa and is written as a Python wrapper script with identical command line arguments as the original MAGMa program with few changed parameters. Each candidate molecule was used to annotate the corresponding spectral tree with in silico generated substructures according to the algorithm published previously [<xref ref-type="bibr" rid="CR15">15</xref>]. A Python script (process_hmdb.py) is provided that generates an SQLite.db database file from the public HMDB.sdf structures file, which is then used when running MAGMa. This script was modified to produce an analogous database file from the provided InChIs for each set of CASMI candidates. An additional Python script was written to generate spectral-tree files required by MAGMa from the CASMI peak lists and metadata. Additional information can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="results">
    <title>Results</title>
    <sec id="Sec11">
      <title>CASMI Category 2 (Best Automatic Structural Identification: In Silico Fragmentation Only): parameter optimization and development of a voting/consensus model</title>
      <p>We tested the four tools that were used in the CASMI challenge, and for which the authors of the tools submitted result data by the CASMI deadline. 
Figure <xref rid="Fig1" ref-type="fig">1</xref> gives the overview of our workflow for comparing results for CASMI Category 2 (in silico fragmentation tools only, Fig. <xref rid="Fig1" ref-type="fig">1</xref>a) and CASMI Category 3 (complementing results of in silico fragmentation tools with metadata queries, here: presence in chemical databases and MS/MS libraries). We first investigated whether the structures used in the CASMI training and validation sets were similar to each other. We decomposed the structures into molecular descriptors (structure fingerprints) and used these for variance analysis by Principal Component Analysis (PCA), (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). This analysis showed that both data sets were structurally highly similar, and only few compounds in the validation set were structurally different from the training set. Indeed, discrepancies in structure similarities between model building and model testing will certainly also occur when researchers try to identify unknown compounds in exposome or metabolomics research, as one cannot expect that ‘unknowns’ in untargeted profiling experiments will indeed fully resemble structures of identified compounds.<fig id="Fig1"><label>Fig. 1</label><caption><p>Structure elucidation workflow of small molecules. <bold>a</bold> In silico fragmentation can be used to identify and rank unknown MS/MS spectra by matching theoretical fragments to experimental MS/MS spectra. <bold>b</bold> The voting/consensus combines the output of multiple in silico fragmentation tools, uses compound and MS/MS databases lookups to further boost compound ranks</p></caption><graphic xlink:href="13321_2017_219_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Principal component analysis of the molecular descriptor space from the training and validation sets. Individual outliers show compounds only found in a specific data set. Overlapping dots show very similar compounds</p></caption><graphic xlink:href="13321_2017_219_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>Not surprisingly, simple parameter optimization already resulted in improved structure annotation accuracies in comparison to the results the tool authors had submitted to CASMI. Such parameter optimization includes using a 5 ppm window for spectral comparison. Detailed parameter setting for each tool is listed in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Secondly, each tool provided a ranked list of all MS/MS spectra (training and challenge) which was then used as an input for voting/consensus model resulting in new improved rankings, as described below.</p>
      <sec id="Sec12">
        <title>In silico performance using the training set</title>
        <p>Following the guidelines of the Category 2 challenge by the 2016 CASMI organizers, we evaluated each in silico software individually by using the best recommended settings and without secondary database rankings or use of other metadata. We utilized the 312 MS/MS spectra from the CASMI training set for parameter optimization of each tool and development of voting/consensus model. The number of compounds to be queried for each individual case ranged from less than 20 to over 8000 compounds. The individual software tools were able identify between 10 and 17% of the training set as top hits (see Table <xref rid="Tab1" ref-type="table">1</xref>). CFM-ID ranked the correct metabolite first in 15% of the cases and 40% as top 5 candidates. MS-FINDER ranked the correct metabolite first in 10% of cases and 27% in the top 5. MAGMa+ ranked 16% of the compounds correctly. MetFragCL was the best performing tool in our comparison placing 17% cases correctly in the top rank and 43% in the top 5 hits (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Results for the training data of the CASMI 2016 contest</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">#</th><th align="left">Tools</th><th align="left">Top hits</th><th align="left">Top 5</th><th align="left">Top 10</th><th align="left">Top 20</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">MetFrag + CFM-ID + DB + MS/MS Voting/consensus</td><td char="." align="char">290</td><td char="." align="char">304</td><td char="." align="char">305</td><td char="." align="char">306</td></tr><tr><td align="left">2</td><td align="left">CFM-ID + ID_sorted + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">289</td><td char="." align="char">304</td><td char="." align="char">306</td><td char="." align="char">308</td></tr><tr><td align="left">3</td><td align="left">MetFrag + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">288</td><td char="." align="char">305</td><td char="." align="char">306</td><td char="." align="char">308</td></tr><tr><td align="left">4</td><td align="left">MetFrag + DB + MS/MS</td><td char="." align="char">288</td><td char="." align="char">305</td><td char="." align="char">305</td><td char="." align="char">307</td></tr><tr><td align="left">5</td><td align="left">MAGMa(+) + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">288</td><td char="." align="char">304</td><td char="." align="char">307</td><td char="." align="char">309</td></tr><tr><td align="left">6</td><td align="left">CFM-ID + ID_sorted + MAGMa(+) + MetFrag + DB + MS/MS Voting/consensus</td><td char="." align="char">288</td><td char="." align="char">304</td><td char="." align="char">305</td><td char="." align="char">308</td></tr><tr><td align="left">7</td><td align="left">MetFrag + CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">288</td><td char="." align="char">304</td><td char="." align="char">305</td><td char="." align="char">307</td></tr><tr><td align="left">8</td><td align="left">CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">288</td><td char="." align="char">303</td><td char="." align="char">306</td><td char="." align="char">307</td></tr><tr><td align="left">9</td><td align="left">MetFrag + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">288</td><td char="." align="char">303</td><td char="." align="char">305</td><td char="." align="char">307</td></tr><tr><td align="left">10</td><td align="left">CFM-ID + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">287</td><td char="." align="char">304</td><td char="." align="char">306</td><td char="." align="char">308</td></tr><tr><td align="left">11</td><td align="left">CFM-ID + DB + MS/MS</td><td char="." align="char">287</td><td char="." align="char">304</td><td char="." align="char">304</td><td char="." align="char">306</td></tr><tr><td align="left">12</td><td align="left">ID-sorted + DB + MS/MS</td><td char="." align="char">286</td><td char="." align="char">306</td><td char="." align="char">306</td><td char="." align="char">308</td></tr><tr><td align="left">13</td><td align="left">MetFrag + MS-FINDER + DB + MS/MS Voting/consensus</td><td char="." align="char">286</td><td char="." align="char">302</td><td char="." align="char">305</td><td char="." align="char">307</td></tr><tr><td align="left">14</td><td align="left">MS-FINDER + CFM-ID + DB + MS/MS Voting/consensus</td><td char="." align="char">286</td><td char="." align="char">301</td><td char="." align="char">304</td><td char="." align="char">305</td></tr><tr><td align="left">15</td><td align="left">MAGMa(+) + DB + MS/MS</td><td char="." align="char">286</td><td char="." align="char">301</td><td char="." align="char">302</td><td char="." align="char">303</td></tr><tr><td align="left">16</td><td align="left">MetFrag + MS-FINDER + CFM-ID + DB + MS/MS Voting/consensus</td><td char="." align="char">285</td><td char="." align="char">303</td><td char="." align="char">305</td><td char="." align="char">307</td></tr><tr><td align="left">17</td><td align="left">MS-FINDER + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">285</td><td char="." align="char">302</td><td char="." align="char">306</td><td char="." align="char">307</td></tr><tr><td align="left">18</td><td align="left">MetFrag + MS-FINDER + CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">285</td><td char="." align="char">302</td><td char="." align="char">305</td><td char="." align="char">307</td></tr><tr><td align="left">19</td><td align="left">MS-FINDER + DB + MS/MS</td><td char="." align="char">285</td><td char="." align="char">300</td><td char="." align="char">302</td><td char="." align="char">303</td></tr><tr><td align="left">20</td><td align="left">CFM-ID + ID_sorted + MAGMa(+) + MetFrag + MS-FINDER + DB + MS/MS Voting/consensus</td><td char="." align="char">284</td><td char="." align="char">303</td><td char="." align="char">306</td><td char="." align="char">307</td></tr><tr><td align="left">21</td><td align="left">MetFrag + MS-FINDER + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">284</td><td char="." align="char">302</td><td char="." align="char">306</td><td char="." align="char">306</td></tr><tr><td align="left">22</td><td align="left">MS-FINDER + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">284</td><td char="." align="char">301</td><td char="." align="char">305</td><td char="." align="char">306</td></tr><tr><td align="left">23</td><td align="left">MS-FINDER + CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">283</td><td char="." align="char">302</td><td char="." align="char">305</td><td char="." align="char">305</td></tr><tr><td align="left">24</td><td align="left">MetFrag + CFM-ID + DB Voting/consensus</td><td char="." align="char">243</td><td char="." align="char">291</td><td char="." align="char">296</td><td char="." align="char">304</td></tr><tr><td align="left">25</td><td align="left">MetFrag + MS-FINDER + CFM-ID + DB Voting/consensus</td><td char="." align="char">242</td><td char="." align="char">289</td><td char="." align="char">298</td><td char="." align="char">301</td></tr><tr><td align="left">26</td><td align="left">MetFrag + CFM-ID + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">240</td><td char="." align="char">290</td><td char="." align="char">297</td><td char="." align="char">304</td></tr><tr><td align="left">27</td><td align="left">MS-FINDER + DB</td><td char="." align="char">239</td><td char="." align="char">284</td><td char="." align="char">294</td><td char="." align="char">296</td></tr><tr><td align="left">28</td><td align="left">MetFrag + DB</td><td char="." align="char">238</td><td char="." align="char">290</td><td char="." align="char">296</td><td char="." align="char">301</td></tr><tr><td align="left">29</td><td align="left">MS-FINDER + CFM-ID + DB Voting/consensus</td><td char="." align="char">238</td><td char="." align="char">287</td><td char="." align="char">297</td><td char="." align="char">298</td></tr><tr><td align="left">30</td><td align="left">MS-FINDER + CFM-ID + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">237</td><td char="." align="char">288</td><td char="." align="char">298</td><td char="." align="char">300</td></tr><tr><td align="left">31</td><td align="left">CFM-ID + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">236</td><td char="." align="char">289</td><td char="." align="char">298</td><td char="." align="char">303</td></tr><tr><td align="left">32</td><td align="left">MetFrag + MS-FINDER + DB Voting/consensus</td><td char="." align="char">236</td><td char="." align="char">289</td><td char="." align="char">297</td><td char="." align="char">300</td></tr><tr><td align="left">33</td><td align="left">MetFrag + MS-FINDER + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">236</td><td char="." align="char">288</td><td char="." align="char">298</td><td char="." align="char">300</td></tr><tr><td align="left">34</td><td align="left">MAGMa(+) + DB</td><td char="." align="char">236</td><td char="." align="char">287</td><td char="." align="char">294</td><td char="." align="char">299</td></tr><tr><td align="left">35</td><td align="left">CFM-ID + DB</td><td char="." align="char">236</td><td char="." align="char">286</td><td char="." align="char">295</td><td char="." align="char">302</td></tr><tr><td align="left">36</td><td align="left">MetFrag + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">235</td><td char="." align="char">290</td><td char="." align="char">298</td><td char="." align="char">301</td></tr><tr><td align="left">37</td><td align="left">MS-FINDER + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">235</td><td char="." align="char">288</td><td char="." align="char">298</td><td char="." align="char">299</td></tr><tr><td align="left">38</td><td align="left">ID-sorted + DB</td><td char="." align="char">227</td><td char="." align="char">291</td><td char="." align="char">301</td><td char="." align="char">303</td></tr><tr><td align="left">39</td><td align="left">Randomize + DB + MS/MS</td><td char="." align="char">195</td><td char="." align="char">273</td><td char="." align="char">289</td><td char="." align="char">305</td></tr><tr><td align="left">40</td><td align="left">Randomize + DB</td><td char="." align="char">193</td><td char="." align="char">268</td><td char="." align="char">283</td><td char="." align="char">298</td></tr><tr><td align="left">41</td><td align="left">ID-sorted</td><td char="." align="char">143</td><td char="." align="char">249</td><td char="." align="char">267</td><td char="." align="char">270</td></tr><tr><td align="left">42</td><td align="left">MetFrag + CFM-ID in silico Voting/consensus</td><td char="." align="char">69</td><td char="." align="char">155</td><td char="." align="char">194</td><td char="." align="char">230</td></tr><tr><td align="left">43</td><td align="left">MetFrag + CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">62</td><td char="." align="char">154</td><td char="." align="char">187</td><td char="." align="char">228</td></tr><tr><td align="left">44</td><td align="left">MetFrag + MS-FINDER + CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">62</td><td char="." align="char">145</td><td char="." align="char">180</td><td char="." align="char">228</td></tr><tr><td align="left">45</td><td align="left">MetFrag + MS-FINDER + CFM-ID in silico Voting/consensus</td><td char="." align="char">58</td><td char="." align="char">145</td><td char="." align="char">179</td><td char="." align="char">221</td></tr><tr><td align="left">46</td><td align="left">MS-FINDER + CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">58</td><td char="." align="char">133</td><td char="." align="char">170</td><td char="." align="char">213</td></tr><tr><td align="left">47</td><td align="left">CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">55</td><td char="." align="char">134</td><td char="." align="char">179</td><td char="." align="char">221</td></tr><tr><td align="left">48</td><td align="left">MetFrag in silico only</td><td char="." align="char">52</td><td char="." align="char">134</td><td char="." align="char">171</td><td char="." align="char">210</td></tr><tr><td align="left">49</td><td align="left">MetFrag + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">52</td><td char="." align="char">133</td><td char="." align="char">171</td><td char="." align="char">210</td></tr><tr><td align="left">50</td><td align="left">MAGMa + in silico only</td><td char="." align="char">50</td><td char="." align="char">121</td><td char="." align="char">151</td><td char="." align="char">189</td></tr><tr><td align="left">51</td><td align="left">MS-FINDER + CFM-ID in silico Voting/consensus</td><td char="." align="char">50</td><td char="." align="char">111</td><td char="." align="char">141</td><td char="." align="char">188</td></tr><tr><td align="left">52</td><td align="left">MetFrag + MS-FINDER + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">49</td><td char="." align="char">128</td><td char="." align="char">153</td><td char="." align="char">210</td></tr><tr><td align="left">53</td><td align="left">CFM-ID in silico only</td><td char="." align="char">48</td><td char="." align="char">124</td><td char="." align="char">170</td><td char="." align="char">209</td></tr><tr><td align="left">54</td><td align="left">MS-FINDER + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">44</td><td char="." align="char">105</td><td char="." align="char">135</td><td char="." align="char">183</td></tr><tr><td align="left">55</td><td align="left">MetFrag + MS-FINDER in silico Voting/consensus</td><td char="." align="char">43</td><td char="." align="char">120</td><td char="." align="char">143</td><td char="." align="char">178</td></tr><tr><td align="left">56</td><td align="left">MS-FINDER in silico only</td><td char="." align="char">32</td><td char="." align="char">86</td><td char="." align="char">117</td><td char="." align="char">145</td></tr><tr><td align="left">57</td><td align="left">Randomize</td><td char="." align="char">4</td><td char="." align="char">13</td><td char="." align="char">27</td><td char="." align="char">46</td></tr></tbody></table><table-wrap-foot><p>‘MetFragCL, CFM-ID, MAGMa+ and MS-FINDER’ designate results obtained by the in silico fragmentation software tools. ‘DB’ designates priority ranking by presence in chemical and biochemical databases. ‘MS/MS’ designates presence in MS/MS libraries based on &gt;400 dot-product similarity. 312 MS/MS spectra of the CASMI 2016 training data were used</p></table-wrap-foot></table-wrap>
</p>
      </sec>
      <sec id="Sec13">
        <title>Voting/consensus model</title>
        <p>Each software provided candidate ranking for each MS/MS spectrum from the training and challenge data set. For ranking of the structures we considered only the first block of an InChiKey to discard enantiomeric or diastereomeric isomers. The voting/consensus model combines the ranking results of all tools and creates a new ranking system based on two criteria. The primary score of the voting/consensus model is calculated as the sum of the number of tools that successfully ranked a candidate compound. When all four tools found the candidate structure, this primary score was four. When none of the tools ranked a candidate, the score was zero. The secondary score for every voting/consensus model was calculated for each candidate structure by:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ S = \mathop \sum \limits_{A} \frac{{Ranking\;\left( {software\;A} \right)}}{{\omega \left( {top\;10\;software\;A} \right)}} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>A</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.277778em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>A</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ω</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mspace width="0.277778em"/><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mi>A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13321_2017_219_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where ω represents the calculated sensitivity. The sensitivity for each software was calculated using a training data set as follows:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \omega = \frac{correctly\;assigned\;structures}{correctly\;assigned\;structures + falsely\;assigned\;structures} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi mathvariant="italic">ω</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13321_2017_219_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>Correctly assigned structures were tested with different thresholds: top rank (the correct structure had to be ranked #1 by the software), top 5 (the correct structure had to be found within the top 5 structures), top 10 and top 20. We obtained best results when the sensitivity was calculated for the top 10 correctly assigned structures as shown in Table <xref rid="Tab3" ref-type="table">3</xref>, and the calculated sensitivities were used for the validation set later on. By sorting the results in two levels with primary scores in descending and secondary scores in ascending order, new rankings are obtained for each candidate structure. The best voting/consensus model was chosen for each experiment. The voting/consensus model was written in R script and Java. The code is freely available at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/insilico-fragmentation/">https://sourceforge.net/projects/insilico-fragmentation/</ext-link>. The application of the voting/consensus model to both categories is shown in the Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
      </sec>
      <sec id="Sec14">
        <title>Voting/consensus model applied to in silico results</title>
        <p>Subsequently we improved overall rankings by applying the voting/consensus model as detailed in the method section. In comparison to each individual tool’s results, the voting/consensus model built from a combination of MetFragCL and CFM-ID improved the overall results by 5%, ranking 22% cases in the top rank, 49% in the top 5 and 63% of the compounds in the top 10, an overview is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The voting/consensus model takes into account the quality of each software which is why a secondary score is calculated using the number of hits in the top 10, assuming that experts will usually rely on and use the top 10 candidates proposed by a software.<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of the accuracy of compound annotations obtained by in silico fragmentation tools alone and in combination with metadata for both CASMI data sets</p></caption><graphic xlink:href="13321_2017_219_Fig3_HTML" id="MO5"/></fig>
</p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>CASMI Category 3 (Best Automatic Structural Identification: Full Information): application of database and MS/MS similarity boosting</title>
      <p>In Category 3, any additional information could be used to aid in the identification of the challenge spectra, for example, retention time information, mass spectral libraries, patents, reference count or biological relevance. Therefore, this CASMI category allowed a comparison of results obtained from pure in silico fragmentation tools with the integration of context metadata and in silico tools. Here, we exemplify the power of combining database presence with MS/MS similarity boosting in order to improve the accuracy of structure annotations from mass spectra, an approach which was successfully implemented previously [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
      <p>Ultimately, a modified voting/consensus model was generated starting with the primary ranking obtained by the in silico fragmentation voting/consensus model sorted in descending order. The final score was then calculated by adding in the presence in compound databases, giving special emphasis on the presence of a structure in the STOFF-IDENT database, and adding MS/MS spectrum matching scores. When this ranking yielded a tie for two structures, the solution with the higher in silico ranking was given priority.<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Final\;score = in\;silico\;consensus\;rank + DB\;presence \,+\, 2XDB_{STOFF{-}IDENT} \,+\, 4XDB_{MS/MS} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.277778em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mspace width="0.277778em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>B</mml:mi><mml:mspace width="0.277778em"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="0.166667em"/><mml:mn>2</mml:mn><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>O</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="0.166667em"/><mml:mn>4</mml:mn><mml:mi>X</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13321_2017_219_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>The rationale for these boosting factors is given as follows:</p>
      <p>(1) <italic>Using database boosting</italic> In silico fragmentation tools have never been published as a stand-alone tool without searching structure databases [<xref ref-type="bibr" rid="CR21">21</xref>]. Querying public databases enables ranking in silico results according to the occurrence or importance of compounds. For example, if a candidate result structure is contained in multiple databases, it is most likely an often observed or important molecule, and might be more likely the correct structure than a less frequently observed isomer. Using this information would, hence, boost the ranking of isomers of in silico fragmentation tools. Other methods could employ the frequency of literature citations or the presence in target databases (e.g. for compounds known to be present in species or organs of interest). Here, we have used boosting structure rankings by its membership in the local database of MS-FINDER. This local compound database covers structures from the 13 most important metabolomic databases, including BMDB, CheBI, DrugBank, ECMDB, FoodDB, HMDB, KNApSack, PlantCyc, SMPDB, T3DB, UNPD, YMDB and STOFF-IDENT [<xref ref-type="bibr" rid="CR22">22</xref>], containing 220,213 entries sorted according to InChIKey, PubChem, exact mass, formula and SMILES.</p>
      <p>(2) <italic>Using database presence emphasis factors</italic> Many compounds in the CASMI training and challenge sets were environmentally relevant. We have therefore used the STOFF-IDENT compound database [<xref ref-type="bibr" rid="CR22">22</xref>] which is used for environmentally relevant substances with a twofold boost factor. Other compound databases such as the EPA Dashboard [<xref ref-type="bibr" rid="CR21">21</xref>] can be used accordingly. The boosting factor should be higher than one but lower than the MS/MS boosting factor. We recommend that this formula should be adapted when searching for structures that have other origins. When investigating endogenous metabolites, it is important to utilize biochemical databases like KEGG and to boost them accordingly.</p>
      <p>(3) <italic>Using mass spectral similarities</italic> If an unknown compound has a perfect MS/MS similarity hit in a standard spectral library such as MassBank or NIST14, such a compound must be ranked very highly in the overall score. Even for medium spectral similarities, there are reasons to assume that differences between the experimental spectrum and library spectra might be due to differences in MS/MS parameters. Hence, candidate structures were boosted by mass spectral similarity matching against MS/MS libraries [<xref ref-type="bibr" rid="CR23">23</xref>]. The NIST MS PepSearch program is a batch command-line version of the NIST MS search GUI program. Originally aimed at peptide scoring, this software can also be used for small molecule MS/MS similarity. Using.msp as input files, the NIST [<xref ref-type="bibr" rid="CR24">24</xref>] and MassBank [<xref ref-type="bibr" rid="CR11">11</xref>] MS/MS libraries were searched with a 5 ppm precursor window. Detailed parameters are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. Out of 312 MS/MS spectra in the training set, 276 challenge spectra (88.4%) yielded hits in the MS/MS libraries with dot product scores ranging from very low similarity matches of 183 (for the training spectrum 109) up to optimal dot product scores of 999 (for the training spectrum 029). In the challenge data set, 208 MS/MS spectra were matched against the combined MassBank and NIST libraries. 125 spectra (60%) had positive matches with dot product scores ranging from 441 (for the challenge spectrum 182) up to a dot product score of 999 (for the challenge spectrum 049). We tested different cut offs for dot product matching scores in order to determine which threshold yielded results with most true positive compound annotations and the fewest false positive identifications. We found that for this CASMI data set, a dot product score threshold of 400 gave the best results on the training MS/MS spectra data set. We therefore used the same threshold for the CASMI challenge data set.</p>
      <p>In order to ensure that good hits in the MS/MS spectral comparisons were given a high priority in ranking, we boosted hits for MS/MS similarity by a four-fold factor. We did not further use the actual MS/MS similarity match score but only the presence of an ‘MS/MS dot score &gt;400’ hit, because the CASMI spectra represented data from different experiments and different MS/MS conditions, similar to spectra in NIST and MassBank libraries. The final rankings were obtained by sorting the sum of the scores in descending order. The higher the final score—the higher the new ranking.</p>
      <p>Using this multi-parameter model, we boosted the overall accuracy of the model significantly by including each individual in silico fragmentation tool.</p>
      <p>(4) <italic>Using other metadata</italic> We also noted that CASMI structure entries were listed by ChemSpider numbers, a database listing over 50 million chemicals [<xref ref-type="bibr" rid="CR25">25</xref>]. ChemSpider entries are numbered by increasing numbers according to date of entry. We hypothesized that early ChemSpider entries (with low entry numbers) might be more relevant than high-entry numbers and tested if simple ID-number ranking (reported as ID-sorted) improved the overall ranking accuracy (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p>A total of 57 different combinations were tested and the related data can be found in Table <xref rid="Tab1" ref-type="table">1</xref>. The best voting/consensus model, built on CFM-ID and MetFragCL and it placed ~93% correctly in the top rank and ~98% in the top 10. However, it should be noted that simple boosting (i.e. querying for presence in databases or MS/MS similarity libraries) yielded almost as good results as a combination of in silico fragmentation and database/library boosting (Table <xref rid="Tab1" ref-type="table">1</xref>): boosting alone yielded 286 correct hits which was only slightly worse than the best combination of in silico fragmentation tools and boosting. In comparison, in silico fragmentation tools alone (without boosting), yielded a maximum of 69 correct hits, even in a voting/consensus model, and a maximum of 52 correct hits when a single in silico tool was used.</p>
      <sec id="Sec16">
        <title>Validation set performance for Categories 2 and 3</title>
        <p>Finally, all 57 combinatorial methods were calculated on the training set and subsequently applied to the validation set (Table <xref rid="Tab2" ref-type="table">2</xref>). This validation result mimics the approach an experienced investigator would take when identifying unknown compounds, by developing and tuning and cross-validating the algorithm on the training set and then applying the optimized parameters on the validation set. Again, each tool was used individually without any additional information and the voting/consensus model was applied using the weights calculated from the training set (see Table <xref rid="Tab3" ref-type="table">3</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Results for the challenge (validation) data of the CASMI 2016 contest</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">#</th><th align="left">Tools</th><th align="left">Top hits</th><th align="left">Top 5</th><th align="left">Top 10</th><th align="left">Top 20</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">CFM-ID + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">181</td><td char="." align="char">194</td><td char="." align="char">201</td><td char="." align="char">204</td></tr><tr><td align="left">2</td><td align="left">CFM-ID + ID_sorted + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">180</td><td char="." align="char">195</td><td char="." align="char">200</td><td char="." align="char">205</td></tr><tr><td align="left">3</td><td align="left">CFM-ID + ID_sorted + MAGMa(+) + MetFrag + DB + MS/MS Voting/consensus</td><td char="." align="char">180</td><td char="." align="char">194</td><td char="." align="char">200</td><td char="." align="char">204</td></tr><tr><td align="left">4</td><td align="left">CFM-ID + DB + MS/MS</td><td char="." align="char">180</td><td char="." align="char">193</td><td char="." align="char">199</td><td char="." align="char">201</td></tr><tr><td align="left">5</td><td align="left">MAGMa(+) + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">180</td><td char="." align="char">193</td><td char="." align="char">197</td><td char="." align="char">201</td></tr><tr><td align="left">6</td><td align="left">CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">180</td><td char="." align="char">192</td><td char="." align="char">195</td><td char="." align="char">202</td></tr><tr><td align="left">7</td><td align="left">MetFrag + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">180</td><td char="." align="char">188</td><td char="." align="char">194</td><td char="." align="char">198</td></tr><tr><td align="left">8</td><td align="left">MAGMa(+) + DB + MS/MS</td><td char="." align="char">180</td><td char="." align="char">188</td><td char="." align="char">192</td><td char="." align="char">198</td></tr><tr><td align="left">9</td><td align="left">MetFrag + CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">179</td><td char="." align="char">190</td><td char="." align="char">196</td><td char="." align="char">201</td></tr><tr><td align="left">10</td><td align="left">MetFrag + CFM-ID + DB + MS/MS Voting/consensus</td><td char="." align="char">178</td><td char="." align="char">192</td><td char="." align="char">199</td><td char="." align="char">203</td></tr><tr><td align="left">11</td><td align="left">CFM-ID + ID_sorted + MAGMa(+) + MetFrag + MS-FINDER + DB + MS/MS Voting/consensus</td><td char="." align="char">175</td><td char="." align="char">191</td><td char="." align="char">200</td><td char="." align="char">203</td></tr><tr><td align="left">12</td><td align="left">MetFrag + MS-FINDER + CFM-ID + DB + MS/MS Voting/consensus</td><td char="." align="char">175</td><td char="." align="char">189</td><td char="." align="char">194</td><td char="." align="char">200</td></tr><tr><td align="left">13</td><td align="left">MetFrag + MS-FINDER + CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">175</td><td char="." align="char">189</td><td char="." align="char">194</td><td char="." align="char">200</td></tr><tr><td align="left">14</td><td align="left">MS-FINDER + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">175</td><td char="." align="char">189</td><td char="." align="char">194</td><td char="." align="char">199</td></tr><tr><td align="left">15</td><td align="left">MS-FINDER + CFM-ID + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">175</td><td char="." align="char">188</td><td char="." align="char">196</td><td char="." align="char">201</td></tr><tr><td align="left">16</td><td align="left">MetFrag + MS-FINDER + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">175</td><td char="." align="char">186</td><td char="." align="char">191</td><td char="." align="char">197</td></tr><tr><td align="left">17</td><td align="left">MS-FINDER + MAGMa(+) + DB + MS/MS Voting/consensus</td><td char="." align="char">175</td><td char="." align="char">185</td><td char="." align="char">190</td><td char="." align="char">195</td></tr><tr><td align="left">18</td><td align="left">ID_SORTED + DB + MS/MS</td><td char="." align="char">174</td><td char="." align="char">195</td><td char="." align="char">198</td><td char="." align="char">204</td></tr><tr><td align="left">19</td><td align="left">MetFrag + ID_sorted + DB + MS/MS Voting/consensus</td><td char="." align="char">174</td><td char="." align="char">194</td><td char="." align="char">199</td><td char="." align="char">203</td></tr><tr><td align="left">20</td><td align="left">MS-FINDER + CFM-ID + DB + MS/MS Voting/consensus</td><td char="." align="char">174</td><td char="." align="char">189</td><td char="." align="char">195</td><td char="." align="char">201</td></tr><tr><td align="left">21</td><td align="left">MetFrag + DB + MS/MS</td><td char="." align="char">174</td><td char="." align="char">189</td><td char="." align="char">192</td><td char="." align="char">197</td></tr><tr><td align="left">22</td><td align="left">MetFrag + MS-FINDER + DB + MS/MS Voting/consensus</td><td char="." align="char">174</td><td char="." align="char">187</td><td char="." align="char">190</td><td char="." align="char">197</td></tr><tr><td align="left">23</td><td align="left">MS-FINDER + DB + MS/MS</td><td char="." align="char">174</td><td char="." align="char">184</td><td char="." align="char">185</td><td char="." align="char">191</td></tr><tr><td align="left">24</td><td align="left">MetFrag + CFM-ID + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">151</td><td char="." align="char">184</td><td char="." align="char">192</td><td char="." align="char">198</td></tr><tr><td align="left">25</td><td align="left">CFM-ID + DB</td><td char="." align="char">151</td><td char="." align="char">183</td><td char="." align="char">191</td><td char="." align="char">197</td></tr><tr><td align="left">26</td><td align="left">MetFrag + MS-FINDER + CFM-ID + DB Voting/consensus</td><td char="." align="char">151</td><td char="." align="char">180</td><td char="." align="char">191</td><td char="." align="char">198</td></tr><tr><td align="left">27</td><td align="left">MS-FINDER + CFM-ID + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">151</td><td char="." align="char">179</td><td char="." align="char">191</td><td char="." align="char">198</td></tr><tr><td align="left">28</td><td align="left">CFM-ID + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">150</td><td char="." align="char">184</td><td char="." align="char">189</td><td char="." align="char">199</td></tr><tr><td align="left">29</td><td align="left">MetFrag + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">150</td><td char="." align="char">181</td><td char="." align="char">189</td><td char="." align="char">194</td></tr><tr><td align="left">30</td><td align="left">MetFrag + MS-FINDER + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">150</td><td char="." align="char">178</td><td char="." align="char">186</td><td char="." align="char">193</td></tr><tr><td align="left">31</td><td align="left">MS-FINDER + MAGMa(+) + DB Voting/consensus</td><td char="." align="char">150</td><td char="." align="char">174</td><td char="." align="char">183</td><td char="." align="char">191</td></tr><tr><td align="left">32</td><td align="left">MetFrag + CFM-ID + DB Voting/consensus</td><td char="." align="char">149</td><td char="." align="char">186</td><td char="." align="char">196</td><td char="." align="char">201</td></tr><tr><td align="left">33</td><td align="left">MAGMa(+) + DB</td><td char="." align="char">149</td><td char="." align="char">180</td><td char="." align="char">185</td><td char="." align="char">193</td></tr><tr><td align="left">34</td><td align="left">MS-FINDER + CFM-ID + DB Voting/consensus</td><td char="." align="char">149</td><td char="." align="char">179</td><td char="." align="char">189</td><td char="." align="char">199</td></tr><tr><td align="left">35</td><td align="left">MS-FINDER + DB</td><td char="." align="char">148</td><td char="." align="char">173</td><td char="." align="char">178</td><td char="." align="char">186</td></tr><tr><td align="left">36</td><td align="left">MetFrag + DB</td><td char="." align="char">147</td><td char="." align="char">185</td><td char="." align="char">188</td><td char="." align="char">194</td></tr><tr><td align="left">37</td><td align="left">MetFrag + MS-FINDER + DB Voting/consensus</td><td char="." align="char">147</td><td char="." align="char">178</td><td char="." align="char">184</td><td char="." align="char">193</td></tr><tr><td align="left">38</td><td align="left">ID_SORTED + DB</td><td char="." align="char">134</td><td char="." align="char">188</td><td char="." align="char">194</td><td char="." align="char">202</td></tr><tr><td align="left">39</td><td align="left">Randomize + DB + MS/MS</td><td char="." align="char">123</td><td char="." align="char">184</td><td char="." align="char">189</td><td char="." align="char">197</td></tr><tr><td align="left">40</td><td align="left">Randomize + DB</td><td char="." align="char">119</td><td char="." align="char">176</td><td char="." align="char">180</td><td char="." align="char">189</td></tr><tr><td align="left">41</td><td align="left">ID_SORTED</td><td char="." align="char">106</td><td char="." align="char">169</td><td char="." align="char">177</td><td char="." align="char">186</td></tr><tr><td align="left">42</td><td align="left">MetFrag in silico</td><td char="." align="char">53</td><td char="." align="char">92</td><td char="." align="char">111</td><td char="." align="char">137</td></tr><tr><td align="left">43</td><td align="left">MetFrag + MS-FINDER + CFM-ID in silico Voting/consensus</td><td char="." align="char">51</td><td char="." align="char">95</td><td char="." align="char">129</td><td char="." align="char">151</td></tr><tr><td align="left">44</td><td align="left">MetFrag + CFM-ID in silico Voting/consensus</td><td char="." align="char">47</td><td char="." align="char">102</td><td char="." align="char">129</td><td char="." align="char">153</td></tr><tr><td align="left">45</td><td align="left">MetFrag + MS-FINDER + CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">46</td><td char="." align="char">97</td><td char="." align="char">128</td><td char="." align="char">152</td></tr><tr><td align="left">46</td><td align="left">MetFrag + CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">42</td><td char="." align="char">104</td><td char="." align="char">126</td><td char="." align="char">150</td></tr><tr><td align="left">47</td><td align="left">CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">39</td><td char="." align="char">94</td><td char="." align="char">123</td><td char="." align="char">148</td></tr><tr><td align="left">48</td><td align="left">MetFrag + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">39</td><td char="." align="char">90</td><td char="." align="char">111</td><td char="." align="char">128</td></tr><tr><td align="left">49</td><td align="left">MetFrag + MS-FINDER + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">38</td><td char="." align="char">79</td><td char="." align="char">117</td><td char="." align="char">138</td></tr><tr><td align="left">50</td><td align="left">MS-FINDER + CFM-ID + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">34</td><td char="." align="char">97</td><td char="." align="char">127</td><td char="." align="char">147</td></tr><tr><td align="left">51</td><td align="left">MetFrag + MS-FINDER in silico Voting/consensus</td><td char="." align="char">33</td><td char="." align="char">76</td><td char="." align="char">103</td><td char="." align="char">125</td></tr><tr><td align="left">52</td><td align="left">MS-FINDER + MAGMa(+) in silico Voting/consensus</td><td char="." align="char">32</td><td char="." align="char">69</td><td char="." align="char">93</td><td char="." align="char">119</td></tr><tr><td align="left">53</td><td align="left">MS-FINDER + CFM-ID in silico Voting/consensus</td><td char="." align="char">30</td><td char="." align="char">76</td><td char="." align="char">110</td><td char="." align="char">139</td></tr><tr><td align="left">54</td><td align="left">CFM-ID in silico (dot product)</td><td char="." align="char">29</td><td char="." align="char">76</td><td char="." align="char">104</td><td char="." align="char">122</td></tr><tr><td align="left">55</td><td align="left">MAGMa(+) in silico</td><td char="." align="char">28</td><td char="." align="char">72</td><td char="." align="char">98</td><td char="." align="char">117</td></tr><tr><td align="left">56</td><td align="left">MS-FINDER in silico</td><td char="." align="char">23</td><td char="." align="char">57</td><td char="." align="char">79</td><td char="." align="char">93</td></tr><tr><td align="left">57</td><td align="left">Randomize</td><td char="." align="char">20</td><td char="." align="char">27</td><td char="." align="char">28</td><td char="." align="char">121</td></tr></tbody></table><table-wrap-foot><p>‘MetFragCL, CFM-ID, MAGMa+ and MS-FINDER’ designate results obtained by the in silico fragmentation software tools. ‘DB’ designates priority ranking by presence in chemical and biochemical databases. ‘MS/MS’ designates presence in MS/MS libraries based on &gt;400 dot-product similarity. 208 MS/MS spectra of the CASMI 2016 training data were used</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Sensitivity, ω, calculated for each tool (MetFragCL, CFM-ID, MAGMa+ and MS-FINDER) based on the correctly assigned structures in the top rank, top 5, top 10 and top 20 using the training data set of 312 MS/MS spectra</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">#</th><th align="left">Tools</th><th align="left">Top hits</th><th align="left">Top 5</th><th align="left">Top 10</th><th align="left">Top 20</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">MetFragCL in silico only</td><td char="." align="char">0.1666</td><td char="." align="char">0.4294</td><td char="." align="char">0.548</td><td char="." align="char">0.673</td></tr><tr><td align="left">2</td><td align="left">MAGMa+ in silico only</td><td char="." align="char">0.1602</td><td char="." align="char">0.3878</td><td char="." align="char">0.4839</td><td char="." align="char">0.6057</td></tr><tr><td align="left">3</td><td align="left">CFM-ID in silico only</td><td char="." align="char">0.1538</td><td char="." align="char">0.3974</td><td char="." align="char">0.5448</td><td char="." align="char">0.6698</td></tr><tr><td align="left">4</td><td align="left">MS-FINDER in silico only</td><td char="." align="char">0.10256</td><td char="." align="char">0.27564</td><td char="." align="char">0.3750</td><td char="." align="char">0.4647</td></tr></tbody></table><table-wrap-foot><p>The sensitivity was calculated as follows: ω = true positive/(true positive + false negative). The calculated sensitivities were used on the challenge data set</p></table-wrap-foot></table-wrap>
</p>
        <p>The validation set corroborated the findings from the training set performances. With 25% correctly assigned structures as the top hit, MetFragCL was the best stand-alone in silico fragmentation tool. CFM-ID followed with 14% correctly identified compounds and MAGMa+ and MS-FINDER identified less than 14% correct. The voting/consensus model built on MetFragCL, CFM-ID and MS-FINDER did not improve the top hit results of MetFrag, however there were 9% more correctly assigned structures noted in the top 10.</p>
        <p>When boosting the pure in silico outputs by database presence and MS/MS scoring, the best individual tool to use was CFM-ID, correctly assigning 86% of the cases in the top rank. Indeed, results for each of the in silico tools were drastically improved by DB and MS/MS boosting. The best results (top hit) were obtained with 87% correct annotations for the CFM-ID and ID-sorted voting/consensus model. Additional file <xref rid="MOESM2" ref-type="media">2</xref> contains all the combinatorial methods that were
used but were not shown in the manuscript.</p>
      </sec>
      <sec id="Sec17">
        <title>Calculation times</title>
        <p>We investigated a total of 520 compounds. However, each individual in silico tool had to process 691,319 compounds from the query database. This large number of database compounds made it challenging for a number of tools. Performance-wise, MetFragCL was the fastest with only a 12-h calculation time for the 312 training compounds, MAGMa+ needed 18 h, whereas MS-FINDER needed one day, using a regular personal computer as given in the method section. CFM-ID needed two days on a 48-CPU cluster to finish the calculation of the training set. Here additional time-out parameters can be set in the future to avoid very long computational times for individual compounds.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec18" sec-type="discussion">
    <title>Discussion</title>
    <p>Results uploaded to the CASMI contest website as well as our post hoc tool comparison clearly show that in silico algorithms alone are still far away from practical use for identification of true unknowns, for example, compounds that are not currently represented in chemical or biochemical databases. Only 17% of the answers were correctly annotated structures from MS/MS spectral information in the training data set. Even when combining all in silico tools in a voting/consensus model, only 22% of the compounds were ranked as top-candidates. Importantly, even these numbers rest on the assumption that ‘unknowns’ detected in LC–MS/MS of metabolomic or environmental studies are present as existing structures in PubChem or ChemSpider, as CASMI gave lists of potential structures that were to be ranked using ChemSpider structures. It is very likely that in actual untargeted profiling studies, many structures would have to be considered ‘unknown unknowns’, i.e. compounds that have not been structurally described before and that are not represented by the 70 million compounds found in PubChem or ChemSpider. Few approaches exist to enumerate such database derivative structures, for example the ‘metabolic in silico network expansion DB (MINE)’ [<xref ref-type="bibr" rid="CR23">23</xref>]. Completely de-novo spectra-to-structure calculations are yet impossible.</p>
    <p>Currently, best results were obtained when structure database importance and MS/MS search were used along with in silico voting/consensus models. Interestingly, each of the in silico tools experienced tremendous boosts, leading to 93% correctly assigned structures when combining CFM-ID and MetFragCL results in the training data set. Indeed, combined approaches have been successfully used in past CASMI challenges [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. However, previous challenges did not include a large enough number of compounds for full testing. Our step-wise combinatorial multi-model approach shows a more detailed view of overall performances. Once customizable tools are available, we will extend our searches to other in silico fragmentation algorithms such as CSI:FingerID [<xref ref-type="bibr" rid="CR9">9</xref>] or the novel Input Output Kernel Regression models (IOKR) [<xref ref-type="bibr" rid="CR28">28</xref>]. The two latter tools are of interest, because they are user-friendly, very fast and were top performers in the official CASMI contest in the in silico-only category. CSI:FingerID currently does not allow for localized database search, and CSI:IOKR is still not publicly available.</p>
    <p>The compounds provided in the CASMI 2016 contest were environmental xenobiotics and drugs, all covered in structure databases. About 70 MS/MS spectra had not yet been deposited in commercial or publicly available MS/MS databases. Therefore, these MS/MS spectra were not available for any software to be used as training sets, rendering these spectra an excellent test for the CASMI 2016 contest to test in silico fragmentation algorithms. Moreover, 37,957 compounds contained fluorine atoms in their structure, for which fragmentation patterns are harder to interpret. Similar to real LC–MS/MS runs, a range of challenge MS/MS spectra were sparse in the number of product ion peaks, causing in silico tools to fail for lack of data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). While often hundreds of isomers are retrieved per chemical formula, annotation tools must fail if too few MS/MS product ions are generated [<xref ref-type="bibr" rid="CR29">29</xref>]. We recommend acquiring and combining MS/MS data under multiple collision energies, or even with different mass spectrometers, for important unknowns that are detected as statistically significant in metabolomics studies.</p>
    <p>Offering a command-line version for in silico fragmentation software that is capable to run batches of tests is required to process potentially thousands of unknown tandem mass spectra from profiling studies. Multi-threading and use of all CPU cores is required. However, the true challenge lies in providing tools that can be used in batch mode, but are still user-friendly enough for untrained investigators. Many of these software tools operate across Windows, Linux and MacOS and require different libraries and dependencies, demanding a team environment that is skilled in cheminformatics techniques. Structure clean-up steps from the provided structure databases proved to be time-consuming, involving tasks such as removing counter ions, adduct salts, or isotopes. Offering a web-based research tool is recommended. However, data transfer over the web is often forbidden in industrial environments and is also prone to network errors and server outages. Because almost all mass spectrometry vendors use the Windows platform, we further recommend providing Windows-based tools for in silico fragmentations. For individual performance checking it is also useful to investigate each individual result with graphical user interfaces. Here MS-FINDER provides a convenient desktop solution for Windows.</p>
    <p>Our newly developed voting/consensus model software can automatically evaluate hundreds of optimization models and report overall outcomes or top hits, top ten hits and the specificity of the model. Our software is suited to be extended to include more in silico software tools, with output statistics to be modified to calculate additional statistical figures of merit. Such extensions require that in silico software tools are publicly available in a usable form so the results can be independently validated. One could imagine future CASMI contests completely run automatically by software, preventing errors and individual interventions.</p>
  </sec>
  <sec id="Sec19" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In silico algorithms for structural fragmentation of compounds are still in early development. In many cases, existing tools only cover simple fragmentations, but not more complex rearrangement reactions [<xref ref-type="bibr" rid="CR29">29</xref>]. Once more MS/MS spectra become available and corresponding structural diversity increases, these can be used to train and optimize in silico algorithms which will lead to better performance [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p>Pure in silico algorithms only identified 17–25% of the compounds correctly. Once the database and MS/MS search were added, the algorithm was able to correctly identify 87–93% of the “known-unknown” compounds as the first hit. Our results show that for the “known-unknown” compounds the choice of in silico fragmentation software is negligible, when database and MS/MS boosting are aiding the annotation process. These results confirm that voting/consensus models can be used for real-world applications. Our software will also allow for automatic testing and performance tuning without user interaction.</p>
    <p>The true challenge is presented by the identification of “unknown unknown” compounds that are not yet covered in compound databases or that are computationally derived as chemical or enzymatic derivatives [<xref ref-type="bibr" rid="CR23">23</xref>]. Here classical experimental ways of structure elucidation, including compound purification and subsequent NMR, UV and MS will play a role in elucidating the correct isomer structure.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2017_219_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Contains detailed parameter settings for each tool used in this research.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13321_2017_219_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2.</bold> Contains results of all calculations and combinations of the tools that were used but were not shown in the manuscript.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (doi:10.1186/s13321-017-0219-x) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Authors’ contributions</title>
    <p>IB, TK, OF designed the experiment. IB and SM performed the analysis, IB and TK evaluated the results, TK interpreted the results, HT provided support with programming, SO designed the voting/consensus model. IB, TK, DJ, MJ, RB, NS and OF wrote the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Acknowledgements</title>
      <p>We would like to thank CASMI 2016 participants for sharing their methods and parameter settings with us for this research: Felicity Allen, Christoph Ruttkies, Dries Verdegem and Arpana Vaniya. We are thankful to Boris Šlogar for revision and linguistic editing efforts.</p>
    </sec>
    <sec id="FPar2">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar3">
      <title>Funding</title>
      <p>Funding for T.K. and O.F. was supported by NSF MCB 1139644, NIH P20 HL113452 and U24 DK097154. Additional funding for T.K. was provided by American Heart Association 15SDG25760020 (Irvin) and NIH 7R01HL091357-06 (Arnett). Furthermore, we are thankful to Deutsche Forschungsgemeinschaft (German Research Foundation), Bundesministerium für Bildung und Forschung (BMBF, the Federal Ministry for Education and Research) and we are grateful to the Cusanuswerk (KAAD) for support.</p>
    </sec>
    <sec id="FPar4">
      <title>Availability of data and materials</title>
      <p>Project name: In silico fragmentation evaluation.</p>
      <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/insilico-fragmentation/">https://sourceforge.net/projects/insilico-fragmentation/</ext-link>.</p>
      <p>Operating system(s): Platform independent. Programming language: Various.</p>
    </sec>
    <sec id="d29e3675">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hufsky</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mining molecular structure databases: Identification of small molecules based on fragmentation mass spectrometry data</article-title>
        <source>Mass Spectrom Rev</source>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allard</surname>
            <given-names>P-M</given-names>
          </name>
          <name>
            <surname>Péresse</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bisson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gindro</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marcourt</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pham</surname>
            <given-names>VC</given-names>
          </name>
          <name>
            <surname>Roussi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Litaudon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolfender</surname>
            <given-names>J-L</given-names>
          </name>
        </person-group>
        <article-title>Integration of molecular networking and in-silico MS/MS fragmentation for natural products dereplication</article-title>
        <source>Anal Chem</source>
        <year>2016</year>
        <volume>88</volume>
        <issue>6</issue>
        <fpage>3317</fpage>
        <lpage>3323</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.5b04804</pub-id>
        <pub-id pub-id-type="pmid">26882108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruttkies</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schymanski</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hollender</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MetFrag relaunched: incorporating strategies beyond in silico fragmentation</article-title>
        <source>J Cheminform</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0115-9</pub-id>
        <pub-id pub-id-type="pmid">26807156</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kora</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bowen</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>MIDAS: a database-searching algorithm for metabolite identification in metabolomics</article-title>
        <source>Anal Chem</source>
        <year>2014</year>
        <volume>86</volume>
        <issue>19</issue>
        <fpage>9496</fpage>
        <lpage>9503</lpage>
        <pub-id pub-id-type="doi">10.1021/ac5014783</pub-id>
        <pub-id pub-id-type="pmid">25157598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ridder</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van der Hooft</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Verhoeven</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>de Vos</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Bino</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Vervoort</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Automatic chemical structure annotation of an LC–MS n based metabolic profile from green tea</article-title>
        <source>Anal Chem</source>
        <year>2013</year>
        <volume>85</volume>
        <issue>12</issue>
        <fpage>6033</fpage>
        <lpage>6040</lpage>
        <pub-id pub-id-type="doi">10.1021/ac400861a</pub-id>
        <pub-id pub-id-type="pmid">23662787</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ridder</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van der Hooft</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Verhoeven</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Automatic compound annotation from mass spectrometry data using MAGMa</article-title>
        <source>Mass Spectrom</source>
        <year>2014</year>
        <volume>3</volume>
        <issue>Spec Iss 2</issue>
        <fpage>S0033</fpage>
        <pub-id pub-id-type="doi">10.5702/massspectrometry.S0033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verdegem</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lambrechts</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Carmeliet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ghesquière</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Improved metabolite identification with MIDAS and MAGMa through MS/MS spectral dataset-driven parameter optimization</article-title>
        <source>Metabolomics</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-016-1036-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meringer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reinker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MS/MS data improves automated determination of molecular formulas by mass spectrometry</article-title>
        <source>MATCH Commun Math Comput Chem</source>
        <year>2011</year>
        <volume>65</volume>
        <fpage>259</fpage>
        <lpage>290</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meusel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rousu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Searching molecular structure databases with tandem mass spectra using CSI: FingerID</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>41</issue>
        <fpage>12580</fpage>
        <lpage>12585</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1509788112</pub-id>
        <pub-id pub-id-type="pmid">26392543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Greiner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Competitive fragmentation modeling of ESI-MS/MS spectra for putative metabolite identification</article-title>
        <source>Metabolomics</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>98</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-014-0676-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanaya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nihei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Suwa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ojima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aoshima</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MassBank: a public repository for sharing mass spectral data for life sciences</article-title>
        <source>J Mass Spectrom</source>
        <year>2010</year>
        <volume>45</volume>
        <issue>7</issue>
        <fpage>703</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1002/jms.1777</pub-id>
        <pub-id pub-id-type="pmid">20623627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schymanski</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Gerlich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ruttkies</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Solving CASMI 2013 with MetFrag, MetFusion and MOLGEN–MS/MS</article-title>
        <source>Mass Spectrom</source>
        <year>2014</year>
        <volume>3</volume>
        <issue>Spec Iss 2</issue>
        <fpage>S0036</fpage>
        <pub-id pub-id-type="doi">10.5702/massspectrometry.S0036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nakabayashi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yukihira</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cajka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Hydrogen rearrangement rules: computational MS/MS fragmentation and structure elucidation using MS-FINDER software</article-title>
        <source>Anal Chem</source>
        <year>2016</year>
        <volume>88</volume>
        <fpage>7946</fpage>
        <lpage>7958</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.6b00770</pub-id>
        <pub-id pub-id-type="pmid">27419259</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schymanski</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The critical assessment of small molecule identification (CASMI): challenges and solutions</article-title>
        <source>Metabolites</source>
        <year>2013</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>517</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="doi">10.3390/metabo3030517</pub-id>
        <pub-id pub-id-type="pmid">24958137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ridder</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hooft</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Verhoeven</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vos</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Schaik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vervoort</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Substructure-based annotation of high-resolution multistage MSn spectral trees</article-title>
        <source>Rapid Commun Mass Spectrom</source>
        <year>2012</year>
        <volume>26</volume>
        <issue>20</issue>
        <fpage>2461</fpage>
        <lpage>2471</lpage>
        <pub-id pub-id-type="doi">10.1002/rcm.6364</pub-id>
        <pub-id pub-id-type="pmid">22976213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaniya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Samra</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Palazoglu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Using MS-FINDER for identifying 19 natural products in the CASMI 2016 contest</article-title>
        <source>Phytochem Lett</source>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grimme</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Towards first principles calculation of electron impact mass spectra of molecules</article-title>
        <source>Angew Chem Int Ed</source>
        <year>2013</year>
        <volume>52</volume>
        <issue>24</issue>
        <fpage>6306</fpage>
        <lpage>6312</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.201300158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schymanski</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Ruttkies</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Krauss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brouard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vaniya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Verdegem</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Critical assessment of small molecule identification 2016: automated methods</article-title>
        <source>J Cheminform</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-017-0207-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cajka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Wohlgemuth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Barupal</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Showalter</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Identification of small molecules using accurate mass MS/MS search</article-title>
        <source>Mass Spectrom Rev</source>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Little</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Pshenichnov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tkachenko</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Identification of “known unknowns” utilizing accurate mass data and ChemSpider</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>2012</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>179</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-011-0265-y</pub-id>
        <pub-id pub-id-type="pmid">22069037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McEachran</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Sobus</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Identifying known unknowns using the US EPA’s CompTox Chemistry Dashboard</article-title>
        <source>Anal Bioanal Chem</source>
        <year>2016</year>
        <volume>409</volume>
        <fpage>1729</fpage>
        <lpage>1735</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-016-0139-z</pub-id>
        <pub-id pub-id-type="pmid">27987027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huckele</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Track</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Risk management of emerging compounds and pathogens in the water cycle (RiSKWa)</article-title>
        <source>Environ Sci Eur</source>
        <year>2013</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1186/2190-4715-25-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeffryes</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Colastani</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Elbadawi-Sidhu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Niehaus</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Broadbelt</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Hanson</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Tyo</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>MINEs: open access databases of computationally predicted enzyme promiscuity products for untargeted metabolomics</article-title>
        <source>J Cheminform</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-015-0087-1</pub-id>
        <pub-id pub-id-type="pmid">26322134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linstrom</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Mallard</surname>
            <given-names>WG</given-names>
          </name>
        </person-group>
        <article-title>The NIST Chemistry WebBook: a chemical data resource on the internet</article-title>
        <source>J Chem Eng Data</source>
        <year>2001</year>
        <volume>46</volume>
        <issue>5</issue>
        <fpage>1059</fpage>
        <lpage>1063</lpage>
        <pub-id pub-id-type="doi">10.1021/je000236i</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tkachenko</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>The Royal Society of Chemistry and the delivery of chemistry data repositories for the community</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2014</year>
        <volume>28</volume>
        <issue>10</issue>
        <fpage>1023</fpage>
        <lpage>1030</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-014-9784-5</pub-id>
        <pub-id pub-id-type="pmid">25086851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oberacher</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Applying tandem mass spectral libraries for solving the critical assessment of small molecule identification (CASMI) LC/MS challenge 2012</article-title>
        <source>Metabolites</source>
        <year>2013</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>312</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.3390/metabo3020312</pub-id>
        <pub-id pub-id-type="pmid">24957994</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newsome</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>CASMI 2013: identification of small molecules by tandem mass spectrometry combined with database and literature mining</article-title>
        <source>Mass Spectrom</source>
        <year>2014</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>S0034</fpage>
        <pub-id pub-id-type="doi">10.5702/massspectrometry.S0034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brouard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>d’Alché-Buc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rousu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fast metabolite identification with input output Kernel Regression</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>i28</fpage>
        <lpage>i36</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw246</pub-id>
        <pub-id pub-id-type="pmid">27307628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Demarque</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Crotti</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Vessecchi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lopes</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Lopes</surname>
            <given-names>NP</given-names>
          </name>
        </person-group>
        <article-title>Fragmentation reactions using electrospray ionization mass spectrometry: an important tool for the structural elucidation and characterization of synthetic and natural products</article-title>
        <source>Nat Prod Rep</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>432</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="doi">10.1039/C5NP00073D</pub-id>
        <pub-id pub-id-type="pmid">26673733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Searching molecular structure databases using tandem MS data: are we there yet?</article-title>
        <source>Curr Opin Chem Biol</source>
        <year>2017</year>
        <volume>36</volume>
        <fpage>1</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2016.12.010</pub-id>
        <pub-id pub-id-type="pmid">28025165</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
