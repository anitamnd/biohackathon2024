<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4071205</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu137</article-id>
    <article-id pub-id-type="publisher-id">btu137</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Biological Reference Repository (BioR): a rapid and flexible system for genomics annotation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kocher</surname>
          <given-names>Jean-Pierre A.</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu137-COR1">*</xref>
        <xref ref-type="author-notes" rid="btu137-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quest</surname>
          <given-names>Daniel J.</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="btu137-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duffy</surname>
          <given-names>Patrick</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meiners</surname>
          <given-names>Michael A.</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moore</surname>
          <given-names>Raymond M.</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rider</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hossain</surname>
          <given-names>Asif</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hart</surname>
          <given-names>Steven N.</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dinu</surname>
          <given-names>Valentin</given-names>
        </name>
        <xref ref-type="aff" rid="btu137-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <aff id="btu137-AFF1"><sup>1</sup>Division of Biomedical Statistics and Informatics, Department of Health Sciences Research and <sup>2</sup>Department of Research IT, Mayo Clinic, Rochester, MN 55905, USA and <sup>3</sup>Department of Biomedical Informatics, Arizona State University, Scottsdale, AZ 85259, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu137-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: John Hancock</p>
      </fn>
      <fn id="btu137-FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>3</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>3</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>13</issue>
    <fpage>1920</fpage>
    <lpage>1922</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>2</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>04</day>
        <month>3</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> The Biological Reference Repository (BioR) is a toolkit for annotating variants. BioR stores public and user-specific annotation sources in indexed JSON-encoded flat files (catalogs). The BioR toolkit provides the functionality to combine and retrieve annotation from these catalogs via the command-line interface. Several catalogs from commonly used annotation sources and instructions for creating user-specific catalogs are provided. Commands from the toolkit can be combined with other UNIX commands for advanced annotation processing. We also provide instructions for the development of custom annotation pipelines.</p>
      <p><bold>Availability and implementation:</bold> The package is implemented in Java and makes use of external tools written in Java and Perl. The toolkit can be executed on Mac OS X 10.5 and above or any Linux distribution. The BioR application, quickstart, and user guide documents and many biological examples are available at <ext-link ext-link-type="uri" xlink:href="http://bioinformaticstools.mayo.edu">http://bioinformaticstools.mayo.edu</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>Kocher.JeanPierre@mayo.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu137/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Next-generation sequencing (NGS) technology platforms are providing unprecedented opportunities to study genomic variants that are associated with clinical conditions and drug response. Using NGS technologies, researchers can identify mutations associated with rare diseases, characterize somatic variants in tumor for diagnostic or prognostic purpose or guide therapeutic treatment. Although the large amount of data produced by NGS platforms and the time to process them are largely being addressed by expanding the IT infrastructure, high-performance computing and code optimization, the annotation process needed to interpret the thousands of variants found in individual genomes is still a challenging task. The annotation process requires extracting and combining information from disparate external and in-house annotation sources, or even command-line tools. Several applications such as ANNOVAR (<xref rid="btu137-B8" ref-type="bibr">Wang <italic>et al.</italic>, 2010</xref>), GEMINI (<xref rid="btu137-B7" ref-type="bibr">Paila <italic>et al.</italic>, 2013</xref>) and TREAT (<xref rid="btu137-B1" ref-type="bibr">Asmann <italic>et al.</italic>, 2012</xref>) have recently been developed to automate the annotation and filtering of genomics variants. However, these systems are restrictive, as expansion and maintenance of annotation depends on the authors’ availability/willingness, and annotation and filtering are often combined, making integration with other tools challenging. Other approaches such as Bio2RDF (<xref rid="btu137-B2" ref-type="bibr">Belleau <italic>et al.</italic>, 2008</xref>) propose the conversion of annotation sources into Resource Description Framework (RDF) format that can be loaded into a triple store database for querying. This approach, although flexible because it allows independent integration of new annotation sources, presents scalability limitations and does not integrate well with existing command-line tools. Under production loads, the number of searches to annotate variants can become extremely large. For instance, the annotation of ∼30 million variants from 10 whole genome sequencing runs per day, with annotation extracted from 10 data sources would involve &gt;300 million queries.</p>
    <p>In this article, we present the Biological Reference Repository (BioR), a flexible and scalable infrastructure for the specific purpose of gene and variant annotation. BioR is built around a slightly modified version of the JSON format (<ext-link ext-link-type="uri" xlink:href="http://www.json.org/">http://www.json.org/</ext-link>), referred in this article as TJSON. To facilitate usability, BioR provides a toolkit (BioR toolkit) that includes a set of UNIX command-line functions to facilitate catalog management and annotation extraction. The BioR toolkit is engineered to work in high-performance computing environments and scale to multiple simultaneous instances.</p>
  </sec>
  <sec>
    <title>2 METHODS AND RESULTS</title>
    <sec id="SEC2.1">
      <title>2.1 The TJSON representation</title>
      <p>The TJSON representation is used by catalogs and used as standard input/output for most of the functions of the BioR toolkit. The TJSON consists of a mix of tab-delimited values and JSON strings (see example below). Like JSON, TJSON is a compact, readable and hierarchical format that can be used to store one to many relationships present in relational annotation sources. TJSON was preferred over others like XML, as in addition to being readable, it is relatively compact. Like XML, it can represent complex hierarchical data structures into a single text string. The hierarchical structures existing in relational data sources are therefore maintained in BioR catalogs. JSON strings can easily be extracted from a TJSON and processed with JSON libraries in most programming languages like Perl, Java and Python. BioR provides commands necessary to retrieve nested values from JSON strings. An example of TJSON, where ‘\t’ is a tab character (typically non-displaying) acting as a column separator is here:
<disp-quote content-type="extract"><p><monospace>1024\t145.6\t{"_type":"gene","_strand":"+", "_minBP":10954,"_maxBP":11507,"note":"similarity to: 1 Protein", "GeneID":"100506145"}\t12.334</monospace></p></disp-quote>
</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 BioR toolkit</title>
      <p>The BioR toolkit includes set of commands for the management of catalogs, extraction of annotation based on genomics coordinates, variant or gene information. These stand-alone commands that are executed like common UNIX commands leverage third-party JSON libraries to process JSON strings. TJSON is intentionally used as standard input/output by most of the BioR commands to enable the concatenation of multiple BioR commands into a single UNIX command using standard piping syntax. The user can add functions to the toolkit or operate on their data using conventional UNIX tools as long as the function operates on TJSON strings.</p>
      <p>The BioR toolkit also includes commands to convert tab-delimited input file into TJSON strings (such as VCF and BED files) or convert TJSON into tab-delimited output file. Any metadata recorded in VCF or GFF style header (starting with ‘#’) in the input file will be carried through by the BioR toolkit functions to be recorded in the output file. The commands included in the BioR toolkit are listed in<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu137/-/DC1"> Supplementary Table S1</ext-link>.</p>
      <p>Finally, the BioR toolkit supports two command-line utilities for annotating variants: (i) bior_snpeff, which integrates SnpEff annotations (<xref rid="btu137-B3" ref-type="bibr">Cingolani <italic>et al.</italic>, 2012</xref>), and (ii) bior_vep to annotate files using Ensemble’s variant effect predictor (<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/info/docs/variation/vep/">www.ensembl.org/info/docs/variation/vep/</ext-link>).</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 BioR annotation catalogs</title>
      <p>BioR catalogs are in a readable, indexable and schema-free format for storing and rapidly accessing arbitrary structured data such as genomic features, diseases, conditions, genetic tests and drugs. Catalogs are modular, based on specific data sources or tools, and can be built and queried independently of other catalogs. They use the TJSON representation to store annotation information and corresponding genomic coordinates. The first tab-delimited field is used to store the origin of the sequence (usually a chromosome). The next two fields record the start and end coordinates of a genomic interval for position-dependent annotations. These two fields are otherwise set to 0. These three fields are indexed by Tabix (<xref rid="btu137-B6" ref-type="bibr">Li, 2011</xref>). The last field is a JSON string that contains all the data from the original source.</p>
      <p>To reduce storage footprint and accelerate coordinate-based searches, catalogs are compressed using the open source BGZip (<xref rid="btu137-B4" ref-type="bibr">Danecek <italic>et al.</italic>, 2011</xref>) and indexed using Tabix. The Tabix index file is stored in the same directory as the related catalog. BioR toolkit takes advantage of the Tabix library to perform coordinate-based overlap searches. BioR can also perform searches on identifiers that can be indexed using a BioR toolkit command for fast querying. Finally, to accelerate coordinate-based and variant-matching searches, a set of semantically consistent identifiers called Golden Identifiers are automatically indexed. These identifiers are implicitly used by some BioR commands (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu137/-/DC1">Supplementary Table S2</ext-link>).</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Building BioR catalogs</title>
      <p>The complexity of building BioR catalogs depends on the organization of data in the annotation source. Data available in tab-delimited text format can be readily converted to a BioR catalog using the command ‘bior_create_catalog’ and a configuration file describing each column. When annotations are extracted from complex systems such as relational databases, programming is required to reformat related tables into a single tab-delimited text. BioR catalogs must be created for each set of related tables the user wants to use.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 BioR catalog library</title>
      <p>BioR includes 19 documented catalogs built from the most commonly used data sources (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu137/-/DC1">Supplementary Table S3</ext-link>). It also includes a list of catalogs built from UCSC Genome Browser tracks (<xref rid="btu137-B5" ref-type="bibr">Kent <italic>et al.</italic>, 2002</xref>). To increase clinical applicability, pharmacogenomics catalogs built from PharmGKB, DrugBank and Therapeutic Target Database are also provided.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Example</title>
      <p>The following example illustrates how sample variant rsIDs stored in the file rsID.txt can be annotated with European frequency from the 1000 Genomes Project. First, using the ‘bior_lookup’ command, rsIDs in the rsID.txt file are matched to entries in the dbSNP.tsv.bgz catalog containing the identifier ‘ID’. Matching entries in JSON format are piped to the function ‘bior_same_variant’. This function uses the Golden Identifiers present in the JSON string to look up allele frequencies in the KGenomes.tsv.gz catalog. Finally, the function ‘bior_drill’ and the Unix command ‘cut’ reformat the TJSON string into a tab-delimited output.
<disp-quote content-type="extract"><p><monospace>$ cat rsIDs.txt | bior_lookup -p ID –d dbSNP.tsv.bgz |</monospace></p><p><monospace>bior_same_variant -d KGenomes.tsv.gz |</monospace></p><p><monospace>bior_drill -c -1 -p INFO.EUR_AF | cut -f 1,3</monospace></p></disp-quote>
</p>
      <p>This macro annotates 100 000 rsIDs in 2:23 min on a MacBook Pro 2.3 GHz Intel Core i7 with solid state drive and 8 G RAM.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 RESULTS</title>
    <p>BioR is an open annotation tool. It includes a toolkit with a base set of commands needed to build and index catalogs and retrieve annotations. Annotations can be retrieved based on location (genomic coordinates) or identifiers. The TJSON format is used for catalogs and as input/output for most of the toolkit functions facilitating the assembly of complex pipelines. Because the TJSON format is readable, users can design their own scripts to extract annotation from catalogs. Scripts can also be intermixed with toolkit commands as long as the TSJON format is maintained. This stream-based approach on which BioR is based significantly reduces memory footprint. In addition, the BioR toolkit is inherently parallel and can be configured to take advantage of computers with multi-core architectures. BioR catalogs can easily be combined into new catalogs to decrease retrieval time by avoiding multiple cross-catalog queries. In conclusion, BioR is a rapid and flexible system for annotating high-throughput genomics experiments.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_13_1920__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btu137_BioRQuickstart2.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btu137_BioR_Supplementary_Material2.docx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENT</title>
    <p>The authors thank the Center for Individualized Medicine at Mayo Clinic for funding the development of BioR.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu137-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asmann</surname>
            <given-names>YW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TREAT: a bioinformatics tool for variant annotations and visualizations in targeted and exome sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>277</fpage>
        <lpage>278</lpage>
        <pub-id pub-id-type="pmid">22088845</pub-id>
      </element-citation>
    </ref>
    <ref id="btu137-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belleau</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bio2RDF: towards a mashup to build bioinformatics knowledge systems</article-title>
        <source>J. Biomed. Inform.</source>
        <year>2008</year>
        <volume>41</volume>
        <fpage>706</fpage>
        <lpage>716</lpage>
        <pub-id pub-id-type="pmid">18472304</pub-id>
      </element-citation>
    </ref>
    <ref id="btu137-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cingolani</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of <italic>Drosophila melanogaster</italic> strain w1118; iso-2; iso-3</article-title>
        <source>Fly (Austin)</source>
        <year>2012</year>
        <volume>6</volume>
        <fpage>80</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="pmid">22728672</pub-id>
      </element-citation>
    </ref>
    <ref id="btu137-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The variant call format and VCFtools</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2156</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="pmid">21653522</pub-id>
      </element-citation>
    </ref>
    <ref id="btu137-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="btu137-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Tabix: fast retrieval of sequence features from generic TAB-delimited files</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>718</fpage>
        <lpage>719</lpage>
        <pub-id pub-id-type="pmid">21208982</pub-id>
      </element-citation>
    </ref>
    <ref id="btu137-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paila</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GEMINI: integrative exploration of genetic variation and genome annotations</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003153</fpage>
        <pub-id pub-id-type="pmid">23874191</pub-id>
      </element-citation>
    </ref>
    <ref id="btu137-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e164</fpage>
        <pub-id pub-id-type="pmid">20601685</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
