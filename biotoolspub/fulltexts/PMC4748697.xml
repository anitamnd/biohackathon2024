<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="pmc">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">PeerJ</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4748697</article-id>
    <article-id pub-id-type="publisher-id">1603</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.1603</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Taxonomy</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>PhyloPythiaS+</italic>: a self-training method for the rapid reconstruction of low-ranking taxonomic bins from metagenomes</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Gregor</surname>
          <given-names>Ivan</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-2">2</xref>
        <xref ref-type="aff" rid="aff-3">3</xref>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Dröge</surname>
          <given-names>Johannes</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-2">2</xref>
        <xref ref-type="aff" rid="aff-3">3</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Schirmer</surname>
          <given-names>Melanie</given-names>
        </name>
        <xref ref-type="aff" rid="aff-4">4</xref>
      </contrib>
      <contrib id="author-4" contrib-type="author">
        <name>
          <surname>Quince</surname>
          <given-names>Christopher</given-names>
        </name>
        <xref ref-type="aff" rid="aff-5">5</xref>
      </contrib>
      <contrib id="author-5" contrib-type="author" corresp="yes">
        <name>
          <surname>McHardy</surname>
          <given-names>Alice C.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-2">2</xref>
        <xref ref-type="aff" rid="aff-3">3</xref>
        <email>Alice.McHardy@helmholtz-hzi.de</email>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>Max-Planck Research Group for Computational Genomics and Epidemiology, Max-Planck Institute for Informatics</institution>, <addr-line>Saarbrücken</addr-line>, <country>Germany</country></aff>
      <aff id="aff-2"><label>2</label><institution>Department of Algorithmic Bioinformatics, Heinrich-Heine-University Düsseldorf</institution>, <addr-line>Düsseldorf</addr-line>, <country>Germany</country></aff>
      <aff id="aff-3"><label>3</label><institution>Computational Biology of Infection Research, Helmholtz Center for Infection Research</institution>, <addr-line>Braunschweig</addr-line>, <country>Germany</country></aff>
      <aff id="aff-4"><label>4</label><institution>The Broad Institute of MIT and Harvard</institution>, <addr-line>Cambridge, MA</addr-line>, <country>United States</country></aff>
      <aff id="aff-5"><label>5</label><institution>School of Engineering, University of Glasgow</institution>, <addr-line>Glasgow</addr-line>, <country>United Kingdom</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib id="editor-1" contrib-type="editor">
        <name>
          <surname>Eisen</surname>
          <given-names>Jonathan</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2016-02-08">
      <day>8</day>
      <month>2</month>
      <year iso-8601-date="2016">2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>4</volume>
    <elocation-id>e1603</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2015-10-14">
        <day>14</day>
        <month>10</month>
        <year iso-8601-date="2015">2015</year>
      </date>
      <date date-type="accepted" iso-8601-date="2015-12-24">
        <day>24</day>
        <month>12</month>
        <year iso-8601-date="2015">2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2016 Gregor et al.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Gregor et al.</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/1603"/>
    <abstract>
      <p><bold>Background.</bold> Metagenomics is an approach for characterizing environmental microbial communities <italic>in situ</italic>, it allows their functional and taxonomic characterization and to recover sequences from uncultured taxa. This is often achieved by a combination of sequence assembly and binning, where sequences are grouped into ‘bins’ representing taxa of the underlying microbial community. Assignment to low-ranking taxonomic bins is an important challenge for binning methods as is scalability to Gb-sized datasets generated with deep sequencing techniques. One of the best available methods for species bins recovery from deep-branching phyla is the expert-trained <italic>PhyloPythiaS</italic> package, where a human expert decides on the taxa to incorporate in the model and identifies ‘training’ sequences based on marker genes directly from the sample. Due to the manual effort involved, this approach does not scale to multiple metagenome samples and requires substantial expertise, which researchers who are new to the area do not have.</p>
      <p><bold>Results.</bold> We have developed <italic>PhyloPythiaS+</italic>, a successor to our <italic>PhyloPythia(S)</italic> software. The new (+) component performs the work previously done by the human expert. <italic>PhyloPythiaS+</italic> also includes a new <italic>k</italic>-mer counting algorithm, which accelerated the simultaneous counting of 4–6-mers used for taxonomic binning 100-fold and reduced the overall execution time of the software by a factor of three. Our software allows to analyze Gb-sized metagenomes with inexpensive hardware, and to recover species or genera-level bins with low error rates in a fully automated fashion. <italic>PhyloPythiaS+</italic> was compared to <italic>MEGAN</italic>, <italic>taxator-tk</italic>, <italic>Kraken</italic> and the generic <italic>PhyloPythiaS</italic> model. The results showed that <italic>PhyloPythiaS+</italic> performs especially well for samples originating from novel environments in comparison to the other methods.</p>
      <p><bold>Availability.</bold><italic>PhyloPythiaS+</italic> in a virtual machine is available for installation under Windows, Unix systems or OS X on: <uri xlink:href="https://github.com/algbioi/ppsp/wiki">https://github.com/algbioi/ppsp/wiki</uri>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Metagenomics</kwd>
      <kwd>Taxonomic classification</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Bioinformatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Max-Planck society, Heinrich Heine University Düsseldorf</funding-source>
      </award-group>
      <award-group id="fund-2">
        <funding-source>Helmholtz Center for Infection Research</funding-source>
      </award-group>
      <award-group id="fund-3">
        <funding-source>Unilever R &amp; D Port Sunlight, Bebington, UK</funding-source>
      </award-group>
      <award-group id="fund-4">
        <funding-source>Engineering and Physical Sciences Research Council Career Acceleration Fellowship</funding-source>
        <award-id>EP/H003851/1</award-id>
      </award-group>
      <funding-statement>ACM, IG and JD were funded by the Max-Planck society, Heinrich Heine University Düsseldorf and Helmholtz Center for Infection Research. MS was supported by Unilever R &amp; D Port Sunlight, Bebington, UK. CQ was supported by an Engineering and Physical Sciences Research Council Career Acceleration Fellowship [EP/ H003851/1]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Metagenomics is the functional or sequence-based analysis of microbial DNA isolated directly from a microbial community of interest (<xref rid="ref-34" ref-type="bibr">Riesenfeld, Schloss &amp; Handelsman, 2004</xref>; <xref rid="ref-18" ref-type="bibr">Kunin et al., 2008</xref>). As the cultivation conditions for most microorganisms are unknown or too complex to reproduce in the laboratory (<xref rid="ref-12" ref-type="bibr">Hugenholtz, 2002</xref>), random shotgun and amplicon-sequencing based metagenome studies have led to substantial advances in our understanding of the structure and functions of microbial communities within the last decade (<xref rid="ref-15" ref-type="bibr">Kalyuzhnaya et al., 2008</xref>; <xref rid="ref-43" ref-type="bibr">Turnbaugh et al., 2010</xref>; <xref rid="ref-11" ref-type="bibr">Hess et al., 2011</xref>; <xref rid="ref-33" ref-type="bibr">Pope et al., 2011b</xref>; <xref rid="ref-47" ref-type="bibr">Zarowiecki, 2012</xref>; <xref rid="ref-37" ref-type="bibr">Schloissnig et al., 2013</xref>; <xref rid="ref-2" ref-type="bibr">Blaser et al., 2013</xref>). The taxonomic classification or ‘binning’ of metagenome samples is often performed after sequence assembly (<xref rid="ref-31" ref-type="bibr">Peng et al., 2011</xref>; <xref rid="ref-19" ref-type="bibr">Laserson, Jojic &amp; Koller, 2011</xref>; <xref rid="ref-3" ref-type="bibr">Boisvert et al., 2012</xref>; <xref rid="ref-26" ref-type="bibr">Namiki et al., 2012</xref>; <xref rid="ref-30" ref-type="bibr">Pell et al., 2012</xref>). This is a computationally demanding task, which for metagenome samples results in a mixture of sequence fragments of varying lengths, originating from the different microbial community members. A taxonomic binning defines ‘bins’ of sequence fragments that were assigned the same taxonomic identifier, representing draft genomes or pan-genomes of the different microbial community members. Taxonomic binning methods use sequence homology, sequence composition and similarities of contigs in read coverage or gene counts, see <xref rid="ref-8" ref-type="bibr">Dröge &amp; McHardy (2012)</xref> for a recent review. The subsequent analysis of these bins allows characterizing the functional and metabolic potential for individual taxa. For instance, in a collaboration with Mark Morrison’s group, a functional and metabolic analysis of a draft genome recovered by taxonomic binning from the gut of the Australian Tammar Wallaby metagenome led to the isolation and subsequent characterization of a new and previously uncultivated bacterium (<xref rid="ref-33" ref-type="bibr">Pope et al., 2011b</xref>). Different from binning methods, taxonomic profiling tools (<xref rid="ref-45" ref-type="bibr">Wu &amp; Eisen, 2008</xref>; <xref rid="ref-41" ref-type="bibr">Stark et al., 2009</xref>; <xref rid="ref-20" ref-type="bibr">Liu et al., 2011</xref>; <xref rid="ref-24" ref-type="bibr">Meinicke, Asshauer &amp; Lingner, 2011</xref>; <xref rid="ref-46" ref-type="bibr">Wu &amp; Scott, 2012</xref>; <xref rid="ref-39" ref-type="bibr">Segata et al., 2012</xref>; <xref rid="ref-42" ref-type="bibr">Sunagawa et al., 2013</xref>; <xref rid="ref-40" ref-type="bibr">Silva et al., 2013</xref>) return a taxonomic profile for a metagenome sample to represent the taxonomic composition of the underlying sampled community.</p>
    <p>Composition-based binning methods assign metagenome sequences based on their <italic>k</italic>-mer signature, which is derived from the counts of short oligomers (<italic>k</italic>-mers) for a sequence (<xref rid="ref-16" ref-type="bibr">Karlin &amp; Burge, 1995</xref>; <xref rid="ref-7" ref-type="bibr">Deschavanne et al., 1999</xref>). Our previously developed <italic>PhyloPythia(S)</italic> (<italic>PPS</italic>) (<xref rid="ref-23" ref-type="bibr">McHardy et al., 2007</xref>; <xref rid="ref-28" ref-type="bibr">Patil, Roune &amp; McHardy, 2011</xref>) software uses this information in combination with a structured output support vector machine framework for taxonomic classification. Composition-based signatures are global genomic properties, which can be estimated from any sufficiently sized sequence sample for a taxon; e.g., for <italic>PP(S)</italic>, 100 kb of reference sequences for a taxon are sufficient for accurate assignment, also for low ranking taxa. Thus, no complete genome sequences of related organisms are required for assignment, which is often a limiting factor for the homology-based methods. Composition-based methods are very fast, with classification runtimes increasing linearly with the size of the sequence sample, whereas the runtime of alignment-based methods is proportional to the product of the reference collection size and the sequence sample size. As the current sequencing technologies produce Gb-sized metagenome samples (<xref rid="ref-25" ref-type="bibr">Metzker, 2010</xref>; <xref rid="ref-21" ref-type="bibr">Loman et al., 2012</xref>), scalability and computational efficiency are becoming increasingly important for computational metagenomic methods. Therefore, we have developed a fully automated taxonomic binning software, that can rapidly process large metagenome samples. <italic>PhyloPythiaS</italic>+ (<italic>PPS</italic>+) is the successor to our previously described <italic>PPS</italic> software and improves on it in several important ways. We provide an automated marker-gene based framework for design and creation of sample-derived structured output support vector machine models, which allows the generation of accurate sample-derived models without user intervention or expert knowledge. <italic>PPS</italic>+ is the first tool that combines taxonomic profiling and subsequent taxonomic composition based binning of the whole metagenome sample, which is particularly valuable for the draft genome reconstruction of taxa from deep-branching phyla. By implementation of a faster <italic>k</italic>-mer counting algorithm, we substantially increased its throughput to 0.5 Gb/h. <italic>PPS</italic>+ is distributed in a virtual machine which facilitates installation under all common operating systems and runs on inexpensive hardware available to most users. <fig id="fig-1" orientation="portrait" position="float"><object-id pub-id-type="doi">10.7717/peerj.1603/fig-1</object-id><label>Figure 1</label><caption><title>Illustration of the <italic>PhyloPythiaS</italic>+ workflow.</title><p>The recommended use of <italic>PPS</italic> is that a human expert specifies the taxa to incorporate in a composition-based taxonomic metagenome classifier and identifies the relevant ‘training’ sequences based on marker genes directly from the sample. The inclusion of contigs originating directly from members of the microbial community, as ‘training’ sequences, is very important for achieving good classification accuracy, as many members of microbial communities are underrepresented in public sequence collections. In <italic>PPS</italic>+, the step of deciding which taxa to include in the model and defining suitable ‘training’ sequences was automated in the + component, based on marker genes, genome and draft genome sequence collections. The data generated by the + component are then used to build the <italic>PPS</italic> models, that are subsequently used to generate the taxonomic binning of the entire metagenome sequence sample.</p></caption><graphic xlink:href="peerj-04-1603-g001"/></fig></p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>The classification of a shotgun metagenome sequence sample with <italic>PPS</italic>+ proceeds in two phases (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>): In the first phase, the newly developed (+) component identifies sample-derived training sequences and the taxa to be modeled by searching for copies of 34 ubiquitous taxonomic marker genes in the metagenome sample. The marker gene analysis results in taxonomic assignments for a small fraction of the sample. Based on the taxa abundance profile derived from these assignments and the sequences available in the reference sequence collections, our method determines which taxa will be modeled and which are the sample-derived data that will be used for training <italic>PPS</italic>.</p>
    <p>The second phase is the composition-based taxonomic assignment of the entire metagenome sample using <italic>PPS</italic> models trained using the data generated in the first phase. <italic>PPS</italic> models can be reused to classify further metagenome samples, e.g., additional samples from the same community.</p>
    <sec>
      <title>PhyloPythiaS</title>
      <p>Assignment with <italic>PPS</italic> proceeds in two steps: In the training step, an ensemble of structured output Support Vector Machines (SVMs) (<xref rid="ref-14" ref-type="bibr">Joachims, Finley &amp; Yu, 2009</xref>) for the specified part of the NCBI taxonomy, defined by the taxa being modeled, are trained using the sample-derived training sequences and additional data for these taxa from a customized reference collection of sequenced genomes and draft genomes (<xref ref-type="supplementary-material" rid="supp-1">Suplemental Information 1</xref>, Section 3.3). The list of modeled taxa and sample-derived data are generated with the + component of <italic>PPS</italic>+. The list of taxa restricts the taxonomic output space that is modeled, i.e., a sequence from a metagenome sample will be assigned to a leaf node taxon or a corresponding higher-ranking taxon of the learned taxonomy.</p>
      <p>In the prediction step, the <italic>PPS</italic> model ensemble identifies the taxon which best matches a query sequence in terms of its <italic>k</italic>-mer profile and assigns to it the respective taxonomic identifier. By default, sequences of 1 kb or more are classified (<italic>PPS</italic>+ configuration parameter: <italic>minSeqLen</italic>).</p>
    </sec>
    <sec>
      <title>The + component of <italic>PhyloPythiaS+</italic></title>
      <p>The input for the + component of <italic>PhyloPythiaS</italic>+ is the metagenome sample. This step returns a list of clades and sample-derived data for the subsequent <italic>PPS</italic> training. The + component performs the following steps:</p>
      <list list-type="simple" id="list-1">
        <list-item>
          <label>(1)</label>
          <p><italic>Marker gene identification</italic>: DNA sequences from the sample are translated in all six reading frames (i.e., also considering reverse complement sequences) to protein sequences. In both the translated and untranslated sequences, regions with similarity to the DNA or protein Hidden Markov model (HMM) profiles of 34 taxonomically informative marker genes (<xref rid="ref-45" ref-type="bibr">Wu &amp; Eisen, 2008</xref>; <xref rid="ref-41" ref-type="bibr">Stark et al., 2009</xref>; <xref rid="ref-20" ref-type="bibr">Liu et al., 2011</xref>; <xref rid="ref-46" ref-type="bibr">Wu &amp; Scott, 2012</xref>; <xref rid="ref-39" ref-type="bibr">Segata et al., 2012</xref>; <xref rid="ref-42" ref-type="bibr">Sunagawa et al., 2013</xref>) are identified (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.3 and 6.1). The corresponding DNA marker gene sequences from these regions are used for further analysis.</p>
        </list-item>
        <list-item>
          <label>(2)</label>
          <p><italic>Taxonomic marker gene assignment</italic>: The marker gene sequences are assigned a taxonomic identifier using the composition-based Naïve Bayes classifier (<xref rid="ref-38" ref-type="bibr">Schloss et al., 2009</xref>) (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 6.2).</p>
        </list-item>
        <list-item>
          <label>(3)</label>
          <p><italic>Taxonomic sequence assignment</italic>: If a sequence contains multiple marker genes, multiple taxonomic identifiers are identified in Step 2. Then the highest bootstrap confidence score (<italic>hcs</italic>) returned by the Naïve Bayes classifier (NBC) for one of the markers on the fragment is identified. We use all marker gene assignments with confidence scores larger than <italic>hcs <sup>∗</sup> (1 − candidatePlTopPercentThreshold)</italic>. The default setting for the configuration parameter <italic>candidatePlTopPercentThreshold</italic> is 0.1. From the set of taxonomic identifiers, the lowest taxon <italic>t</italic> is identified for which all other assignments are either to the same taxon <italic>t</italic> or defined at higher-ranking parental taxa of <italic>t</italic>. Taxon <italic>t</italic> is consequently used for the overall fragment assignment. The confidence score for the fragment is set to the smallest confidence score for the set of retained marker gene assignments.</p>
        </list-item>
        <list-item>
          <label>(4)</label>
          <p><italic>(Optional: Taxonomic scaffold assignment):</italic> Scaffolding information (i.e., the mapping of contigs to scaffolds) can be used to obtain more training data for the relevant taxa. Assembled contigs can be grouped into scaffolds based on the paired-end information after the assembly. As all contigs of a particular scaffold originate from the same strain, all contigs of the respective scaffold should have the same taxonomic label. Here, we make use of this scaffolding information, such that unassigned contigs of a particular scaffold can be assigned based on the assigned contigs of the respective scaffold. In the first step, the taxonomic identifiers of all assigned contigs for a scaffold are corrected as follows: Let us consider that <italic>n</italic> taxonomically assigned contigs of a scaffold are placed along a common path from the root <italic>r</italic> down to a low-ranking clade <italic>lc</italic> in the reference taxonomy. The unassigned contigs of a scaffold are not among these <italic>n</italic> contigs. To obtain a consistent assignment for all the contigs of a scaffold and to correct for ‘outlier’ contig assignments to low ranking taxa, contigs are reassigned according to the following: All <italic>n</italic> assigned contigs of the respective scaffold are reassigned to the lowest taxon <italic>c</italic>, which lies on the path from <italic>r</italic> to <italic>lc</italic>, where <italic>c</italic> is chosen such that at least (<italic>agThreshold <sup>∗</sup> n</italic>) of the contigs are assigned on the path from <italic>c</italic> to <italic>lc</italic>. In the second step, unassigned contigs are assigned to the same taxon <italic>c</italic>, if a sufficient number of contigs have already been assigned. Let us denote the sum of all contig lengths for a scaffold as <italic>l</italic> and the sum of all assigned contig lengths of the respective scaffold as <italic>al</italic>. If <italic>al/l</italic> ≥ <italic>assignedPartThreshold,</italic> then the unassigned contigs of a scaffold are also assigned to clade <italic>c</italic> (see the configuration parameters: <italic>placeContigsFromTheSameScaffold</italic> = <italic>True</italic>, <italic>agThreshold</italic> = <italic>0.3</italic>, <italic>assignedPartThreshold</italic> = <italic>0.5</italic>).</p>
        </list-item>
        <list-item>
          <label>(5)</label>
          <p><italic>Assignment path truncation</italic>: Contigs assigned to a lower-ranking taxon than the specified lowest rank are reassigned to the parental taxon of this lowest rank (configuration parameter: <italic>rankIdCut</italic>).</p>
        </list-item>
        <list-item>
          <label>(6)</label>
          <p><italic>Taxa selection for model specification</italic>: Any taxon for which at least 100 kb of sample-derived data have been identified can be modeled. Furthermore, species can be modeled if at least 300 kb of reference sequences are available in the reference sequence database, and higher-ranking taxa can be modeled if data for at least three distinct species with this requirement (&gt;300 kb per species) are available. Contigs assigned to taxa for which there are fewer data are subsequently assigned to higher taxonomic ranks for which sufficient data are available to allow their use as sample-derived training data (configuration parameters: <italic>minGenomesWgs</italic> = <italic>3 or 1</italic>, <italic>minBpPerSpecies</italic> = <italic>300,000</italic>, <italic>minBpToModel</italic> = <italic>100,000</italic>).</p>
        </list-item>
        <list-item>
          <label>(7)</label>
          <p><italic>Abundant taxa selection</italic>: To reduce the number of taxa to the most relevant ones, the least abundant taxon is removed iteratively. This is defined as the taxon to which the minimum number of bp is assigned. Sequences assigned to this taxon are reassigned to the closest defined taxon at a parental rank. The algorithm ends when the number of leaf taxa is less than or equal to the maximum number of taxa to be modeled (configuration parameter: <italic>maxLeafClades</italic> = <italic>50</italic>; this can be set realistically up to 800).</p>
        </list-item>
      </list>
      <p><italic>Balancing training data</italic>: The part of the taxonomy that will be modeled with <italic>PPS</italic> is defined by the taxa identified in the previous step. It has leaf nodes at different ranks above the specified rank cut-off, and internal nodes. Only leaf node taxa and sample-derived training data assigned to leaf node taxa in the preceding steps are specified as input for <italic>PPS</italic> training. To balance the training data across clades, a maximum of 400 kb of sample-derived training data are selected for each leaf node taxon (configuration parameter: <italic>maxSSDfileSize</italic>). For this selection, contigs are used in order of decreasing confidence values and then in order of decreasing length. The balancing of training data can be switched off by setting the configuration parameter (<italic>maxSSDfileSize</italic>) to a large number.</p>
    </sec>
    <sec>
      <title>Simultaneous counting of multiple short <italic>k</italic>-mers</title>
      <p>We provide <italic>PPS</italic>+ with a new custom <italic>k</italic>-mer counting algorithm that is based on the Rabin Karp string matching algorithm (<xref rid="ref-17" ref-type="bibr">Karp &amp; Rabin, 1987</xref>). The algorithm is highly optimized to count occurrences of short DNA sequences. It is very fast, as it is memory efficient, because it does not need any large helper data structure similar to suffix trees. It explores the locality of reference, uses very fast bit shift operations and is efficiently implemented in C. Its complexity is <italic>O</italic>(<italic>n</italic>), where <italic>n</italic> is the length of the DNA sequence that is being considered. It enumerates <italic>k</italic>-mers up to hundred times faster than when using suffix trees that were employed in <italic>PPS</italic>. This made <italic>PPS</italic>+ overall up to 3x faster than <italic>PPS</italic>. Because the algorithm allows to simultaneously enumerate <italic>k</italic>-mers of consecutive lengths in one run, it is at least 2–7x faster than the state-of-the-art software <italic>Jellyfish</italic> (<xref rid="ref-22" ref-type="bibr">Marcais &amp; Kingsford, 2011</xref>) and 11x faster than <italic>KAnalyze</italic> (<xref rid="ref-1" ref-type="bibr">Audano &amp; Vannberg, 2014</xref>) in the scenario used in <italic>PPS</italic>+, i.e., when calculating <italic>k</italic>-mers of length 4, 5, and 6 for every sequence (<xref ref-type="supplementary-material" rid="supp-17">Table S1</xref>, <xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 2). We also found that the state-of-the-art <italic>k</italic>-mer counting methods <italic>KMC 2</italic> (<xref rid="ref-6" ref-type="bibr">Deorowicz et al., 2015</xref>) and <italic>Turtle</italic> (<xref rid="ref-36" ref-type="bibr">Roy, Bhattacharya &amp; Schliep, 2014</xref>) are not applicable to our problem setting, as <italic>KMC 2</italic> can count only <italic>k</italic>-mers ≥ 10 and <italic>Turtle</italic> is prohibitively slow for sequences ≥ 16 kb.</p>
      <sec>
        <title>Algorithm description</title>
        <p>Let us assume that we are given an array <italic>a</italic>, which represents a DNA sequence of length <italic>n</italic> where all letters are encoded as numbers <italic>0, 1, 2, 3</italic> (where <italic>A</italic> ∼<italic>0, T</italic> ∼<italic>1, G</italic> ∼<italic>2, C</italic>∼<italic>3</italic>) and let <italic>a</italic><sub>0</sub>, …, <italic>a</italic><sub><italic>n</italic>−1</sub> denote the respective entries. We would like to count the occurrences of all <italic>k</italic>-mers of length <italic>k</italic> and store the counts in an array <italic>c</italic> of length 4<sup><italic>k</italic></sup>, which is initialized by zeros. Each <italic>k</italic>-mer maps to a unique index in the array <italic>c</italic>. The index of the first <italic>k</italic>-mer in our sequence is calculated according to: <disp-formula id="eqn-1"><alternatives><graphic xlink:href="peerj-04-1603-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} {\mathrm{index}}_{0}={\mathrm{a}}_{0}\ast {4}^{\mathrm{k}-1}+{\mathrm{a}}_{1}\ast {4}^{\mathrm{k}-2}+\cdots +{\mathrm{a}}_{\mathrm{ k}-2}\ast {4}^{1}+{\mathrm{a}}_{\mathrm{ k}-1}\ast {4}^{0}. \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-1"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi mathvariant="normal">index</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>The index of the (<italic>i</italic> + 1)th <italic>k</italic>-mer of the sequence is computed from the (<italic>i</italic>)th index as: <disp-formula id="eqn-2"><alternatives><graphic xlink:href="peerj-04-1603-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} {\mathrm{index}}_{i+1}=({\mathrm{index}}_{i}-{\mathrm{a}}_{i}\ast {4}^{\mathrm{k}-1})\ast {\mathrm{a}}_{i+\mathrm{k}}\ast {4}^{0}. \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-2"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi mathvariant="normal">index</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi mathvariant="normal">index</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mfenced></mml:mrow><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>When an index is identified, the corresponding <italic>k</italic>-mer count at this index position in array <italic>c</italic> is incremented by one. For instance, the DNA sequence <italic>ATGCATG</italic> is encoded in array <italic>a</italic> as [0, 1, 2, 3, 0, 1, 2]. For <italic>k</italic> = 2, we would add two counts for the <italic>k</italic>-mer <italic>AT</italic> in array <italic>c</italic> at the index position 0∗4 + 1 = 1, two counts for <italic>TG</italic> at the index position 1∗4 + 2 = 6, one count for <italic>GC</italic> at the index position 2∗4 + 3 = 11 and one count for <italic>CA</italic> at index position 3∗4 + 0 = 12. The multiplication operation X∗4<sup>m</sup> can be computed using the bit shift operation <italic>X</italic> ≪ 2∗<italic>m</italic>, which is usually much faster than multiplication.</p>
      </sec>
      <sec>
        <title>Counting k-mers of different lengths at once</title>
        <p>If <italic>index<sub>i</sub></italic> is the index of the <italic>i</italic>th <italic>k</italic>-mer of length <italic>k</italic>, the index of the <italic>i</italic>th (<italic>k</italic> − <italic>j</italic>)-mer (of length <italic>k</italic> − <italic>j</italic>) can be simultaneously computed using the bit shift operation as <italic>index<sub>i</sub></italic> ≫ (2∗<italic>j</italic>) (for <italic>j</italic> ∈ [1..<italic>k</italic> − 1]) and the corresponding counter at the computed index of a respective counter array of length 4<sup>(<italic>k</italic>−<italic>j</italic>)</sup> is incremented. The end of a DNA sequence can be handled by adding several non-DNA characters to its end.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>We evaluated <italic>PPS</italic>+ by comparing it to homology-based methods (<italic>MEGAN4</italic>, <italic>taxator-tk)</italic> (<xref rid="ref-13" ref-type="bibr">Huson et al., 2011</xref>; <xref rid="ref-9" ref-type="bibr">Dröge, Gregor &amp; McHardy, 2014</xref>), the fast taxonomic binning program <italic>Kraken</italic> (<xref rid="ref-44" ref-type="bibr">Wood &amp; Salzberg, 2014</xref>), the composition-based method <italic>PhyloPythia</italic> trained under expert guidance (a recommended but time-consuming procedure) and to a generic <italic>PPS</italic> model using default settings (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.5–3.8). For a performance comparison of <italic>PPS</italic> to methods with prohibitive runtimes for large datasets, such as <italic>PhymmBL</italic> (<xref rid="ref-4" ref-type="bibr">Brady &amp; Salzberg, 2011</xref>) and <italic>CARMA3</italic> (<xref rid="ref-10" ref-type="bibr">Gerlach &amp; Stoye, 2011</xref>), and the web-based tool <italic>NBC</italic> (<xref rid="ref-35" ref-type="bibr">Rosen, Reichenberger &amp; Rosenfeld, 2011</xref>) see <xref rid="ref-29" ref-type="bibr">Patil et al. (2011)</xref>; <xref rid="ref-28" ref-type="bibr">Patil, Roune &amp; McHardy (2011)</xref>; <xref rid="ref-9" ref-type="bibr">Dröge, Gregor &amp; McHardy (2014)</xref>, as <italic>PPS</italic> has already been compared to these methods with favorable outcomes. For a comparison with ‘taxonomy-free’ binning software <italic>CLARK</italic> (<xref rid="ref-27" ref-type="bibr">Ounit et al., 2015</xref>) see (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 7). We did not compare <italic>PPS</italic>+ to profiling tools such as (<xref rid="ref-20" ref-type="bibr">Liu et al., 2011</xref>), as <italic>PPS</italic>+ is a binning method that assigns a taxonomic label to each input sequence. As benchmark datasets, we created two simulated datasets, one with a uniform (137 Mb) and one with a log-normal (66 Mb) distribution of 47 community members (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.1, <xref ref-type="supplementary-material" rid="supp-24">Datasets S1</xref> and <xref ref-type="supplementary-material" rid="supp-24">S2</xref>). We also used two real datasets, a metagenome sample from the guts of two obese human twins (255 Mb) (<xref rid="ref-43" ref-type="bibr">Turnbaugh et al., 2010</xref>) and a cow rumen metagenome sample (319 Mb) from <xref rid="ref-11" ref-type="bibr">Hess et al. (2011)</xref> (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.2, <xref ref-type="supplementary-material" rid="supp-24">Datasets S3</xref>–<xref ref-type="supplementary-material" rid="supp-24">S6</xref>) for evaluation.</p>
    <sec>
      <title>Benchmarks with simulated datasets</title>
      <p>We constructed the simulated datasets by assembling simulated reads with an empirical error profile. The details on how the simulated reads were generated and assembled can be found in (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.1). For the evaluation, precision and recall were calculated (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.9). Furthermore, these measures were also calculated with a ‘correction,’ to account for the case where the sequences of one taxon were consistently assigned to a different taxon, as for draft genome reconstruction, it is more important that the sequences are assigned consistently than that the taxonomic identifier is correct. To assess the performance of the different methods in assigning the simulated sequence fragments without related reference genomes being available, ‘new strain,’ ‘new species’ and ‘new genus’ scenarios were simulated by removing all sequence data from the taxa of the simulated test dataset at each rank from the reference data. Furthermore, for <italic>PPS</italic>+, we distinguished whether the reference data were excluded (masked) from the reference sequence (RS) collection or also from the marker gene (<italic>MG</italic>) collection, since the <italic>MG</italic> collection included sequences for 15 times more distinct species than the RS collection. There were therefore two different situations to consider (<xref ref-type="table" rid="table-1">Table 1</xref>).</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.1603/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Performance comparisons with simulated datasets.</title>
          <p>(A) and (C) show the fraction of correct, incorrect and unassigned bp for simulated datasets with uniform and log-normally distributed species abundance for <italic>PhyloPythiaS</italic>+, the generic <italic>PhyloPythiaS</italic> model, <italic>MEGAN4, Kraken</italic> and <italic>taxator-tk</italic> for assignments at the species, genus and family ranks. Results were averaged over all test ‘scenarios’ (<xref ref-type="table" rid="table-1">Table 1</xref>), where sequences of the same strain, species or genus from the simulated metagenomes were removed from the genome, draft genome and marker gene reference sequence collections (<xref ref-type="supplementary-material" rid="supp-3">Figs. S1</xref>, <xref ref-type="supplementary-material" rid="supp-5">S3</xref>, <xref ref-type="supplementary-material" rid="supp-16">S14A</xref> and <xref ref-type="supplementary-material" rid="supp-16">S14C</xref>). (B) and (D) show the portion of consistently (correct), inconsistently (incorrect) and unbinned (unassigned) bp without consideration of the taxonomic identifiers (<xref ref-type="supplementary-material" rid="supp-4">Figs. S2</xref>, <xref ref-type="supplementary-material" rid="supp-6">S4</xref>, <xref ref-type="supplementary-material" rid="supp-16">S14B</xref> and <xref ref-type="supplementary-material" rid="supp-16">S14D</xref>, <xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.9.2). The exact values and the corresponding precision, recall and <italic>f</italic><sub>1</sub>-score are contained in (<xref ref-type="supplementary-material" rid="supp-18">Tables S2</xref>–<xref ref-type="supplementary-material" rid="supp-21">S5</xref>) for (A–D), respectively.</p>
        </caption>
        <graphic xlink:href="peerj-04-1603-g002"/>
      </fig>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.1603/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Test scenarios.</title>
          <p>Test scenarios where data was removed (masked) up to the specified rank for the corresponding taxa represented in the simulated metagenome datasets from the reference collections. RS denotes the reference collection of complete or draft genomes; <italic>MG</italic> indicates the reference collection of marker genes (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.3).</p>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-04-1603-g005"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Test scenario</th>
                <th rowspan="1" colspan="1">Rank masked from RS</th>
                <th rowspan="1" colspan="1">Rank masked from <italic>MG</italic></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">1.</td>
                <td rowspan="1" colspan="1">None</td>
                <td rowspan="1" colspan="1">None</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">2.</td>
                <td rowspan="1" colspan="1">Strain</td>
                <td rowspan="1" colspan="1">None</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">3.</td>
                <td rowspan="1" colspan="1">Species</td>
                <td rowspan="1" colspan="1">None</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">4.</td>
                <td rowspan="1" colspan="1">Genus</td>
                <td rowspan="1" colspan="1">None</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">5.</td>
                <td rowspan="1" colspan="1">Strain</td>
                <td rowspan="1" colspan="1">Strain</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">6.</td>
                <td rowspan="1" colspan="1">Species</td>
                <td rowspan="1" colspan="1">Strain</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">7.</td>
                <td rowspan="1" colspan="1">Genus</td>
                <td rowspan="1" colspan="1">Strain</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">8.</td>
                <td rowspan="1" colspan="1">Species</td>
                <td rowspan="1" colspan="1">Species</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">9.</td>
                <td rowspan="1" colspan="1">Genus</td>
                <td rowspan="1" colspan="1">Genus</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><italic>PPS</italic>+ showed a substantially improved precision and recall over the <italic>PPS</italic> generic model, which demonstrated the impact of the improved selection of training data and modeled taxa (<xref ref-type="fig" rid="fig-2">Figs. 2A</xref> and <xref ref-type="fig" rid="fig-2">2C</xref>, <xref ref-type="supplementary-material" rid="supp-3">S1A</xref>–<xref ref-type="supplementary-material" rid="supp-3">S1D</xref> and <xref ref-type="supplementary-material" rid="supp-5">S3A</xref>–<xref ref-type="supplementary-material" rid="supp-5">S3D</xref>). <italic>PPS</italic>+ almost always had higher precision and recall than <italic>MEGAN4</italic> and <italic>Kraken,</italic> except when almost all test data were included in the reference sequences (<xref ref-type="fig" rid="fig-2">Figs. 2A</xref> and <xref ref-type="fig" rid="fig-2">2C</xref>, <xref ref-type="supplementary-material" rid="supp-3">S1A</xref>–<xref ref-type="supplementary-material" rid="supp-3">S1C</xref>, <xref ref-type="supplementary-material" rid="supp-3">S1E</xref>, <xref ref-type="supplementary-material" rid="supp-5">S3A</xref>–<xref ref-type="supplementary-material" rid="supp-5">S3C</xref>, <xref ref-type="supplementary-material" rid="supp-5">S3E</xref>, <xref ref-type="supplementary-material" rid="supp-16">S14A</xref>). This was even more pronounced when comparing bin quality using the corrected measures (<xref ref-type="fig" rid="fig-2">Figs. 2B</xref> and <xref ref-type="fig" rid="fig-2">2D</xref>, <xref ref-type="supplementary-material" rid="supp-4">S2A</xref>–<xref ref-type="supplementary-material" rid="supp-4">S2C</xref>, <xref ref-type="supplementary-material" rid="supp-4">S2E</xref>, <xref ref-type="supplementary-material" rid="supp-6">S4A</xref>–<xref ref-type="supplementary-material" rid="supp-6">S4C</xref>, <xref ref-type="supplementary-material" rid="supp-6">S4E</xref>, <xref ref-type="supplementary-material" rid="supp-16">S14A</xref> and <xref ref-type="supplementary-material" rid="supp-16">S14D</xref>). When comparing <italic>PPS</italic>+ to <italic>taxator-tk</italic>, <italic>PPS</italic>+ had substantially improved recall, particularly for lower ranks (<xref ref-type="fig" rid="fig-2">Figs. 2A</xref> and <xref ref-type="fig" rid="fig-2">2C</xref>, <xref ref-type="supplementary-material" rid="supp-3">S1A</xref>–<xref ref-type="supplementary-material" rid="supp-3">S1C</xref>, <xref ref-type="supplementary-material" rid="supp-3">S1F</xref>, <xref ref-type="supplementary-material" rid="supp-5">S3A</xref>–<xref ref-type="supplementary-material" rid="supp-5">S3C</xref>, <xref ref-type="supplementary-material" rid="supp-5">S3F</xref>); while <italic>taxator-tk</italic> outperformed all other methods in terms of precision (<xref ref-type="fig" rid="fig-2">Figs. 2A</xref> and <xref ref-type="fig" rid="fig-2">2C</xref>, <xref ref-type="supplementary-material" rid="supp-3">S1A</xref>–<xref ref-type="supplementary-material" rid="supp-3">S1F</xref> and <xref ref-type="supplementary-material" rid="supp-5">S3A</xref>–<xref ref-type="supplementary-material" rid="supp-5">S3F</xref>). Both methods were similarly precise when analyzing bin recovery, independent of assigning the taxonomic identifiers to the corrected measures (<xref ref-type="fig" rid="fig-2">Figs. 2B</xref> and <xref ref-type="fig" rid="fig-2">2D</xref>, <xref ref-type="supplementary-material" rid="supp-4">S2A</xref>–<xref ref-type="supplementary-material" rid="supp-4">S2C</xref>, <xref ref-type="supplementary-material" rid="supp-4">S2F</xref>, <xref ref-type="supplementary-material" rid="supp-6">S4A</xref>–<xref ref-type="supplementary-material" rid="supp-6">S4C</xref> and <xref ref-type="supplementary-material" rid="supp-6">S4F</xref>). As a strong point of <italic>PPS</italic>+ , we also observed that it more rarely predicted wrong taxa that were not a part of the sample than the other methods (<xref ref-type="supplementary-material" rid="supp-7">Fig. S5</xref>). For example, for the genus rank in Scenarios 3 and 8, <italic>PPS</italic>+ assigned sequences to only 2–5 false positive taxa, while <italic>taxator-tk</italic> identified 20, <italic>MEGAN4</italic> 37 and <italic>PPS</italic> 59 false ones. If <italic>PPS</italic>+ identified wrong taxa, these were usually very closely related to the true taxa.</p>
    </sec>
    <sec>
      <title>Benchmarks with real datasets</title>
      <sec>
        <title>Comparison of scaffold and contig assignments</title>
        <p>For each taxonomic rank, the percentage and the total number of kb (% agreement and kb agreement) that were assigned the same taxonomic identifier were calculated for the real datasets, based on the assignments of scaffold and contig sequences (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.10.1). For the chunked cow rumen dataset (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.2.2), <italic>taxator-tk</italic> had the highest assignment consistency (<xref ref-type="table" rid="table-2">Table 2</xref>); however, it assigned much fewer data than the other methods at lower taxonomic ranks. A detailed comparison is given in heat maps (<xref ref-type="supplementary-material" rid="supp-8">Figs. S6</xref>–<xref ref-type="supplementary-material" rid="supp-15">S13</xref>). <italic>PPS</italic>+ performed substantially better by both measures than the generic <italic>PPS</italic> model in almost all cases. <italic>PPS</italic>+ was also more consistent than <italic>MEGAN4</italic> for all lower ranks and assigned many more sequences than <italic>MEGAN4</italic> overall. For instance, at the genus rank, the scores were 84.3 and 56 ‘% agreement’, as well as 33,724 and 13,726 ‘kb agreement’ for <italic>PPS</italic>+ and <italic>MEGAN4</italic>, respectively. The overall low numbers for <italic>Kraken</italic> suggests that it is rather not applicable to samples containing novel taxa. Also, the low number of consistently assigned bp by <italic>MEGAN4</italic> and <italic>taxator-tk</italic> to lower taxonomic ranks reflects the availability of few related reference genome sequences for the cow rumen metagenome sample, which is not an issue for a composition-based method <italic>PPS</italic>+.</p>
        <table-wrap id="table-2" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj.1603/table-2</object-id>
          <label>Table 2</label>
          <caption>
            <title>Comparison of contig and scaffold assignments of the chunked cow rumen dataset.</title>
            <p>Contigs of the cow rumen dataset of at least 10 kb were divided into chunks of 2 kb for evaluation of assignment consistency (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.2.2). The contigs and scaffolds of the chunked cow rumen dataset were assigned using <italic>PPS</italic>+ , the generic <italic>PPS</italic> model, <italic>MEGAN4</italic>, <italic>taxator-tk</italic> and <italic>Kraken</italic>. For each method, up to two taxonomic identifiers were assigned to each contig at each rank, i.e., one identifier came from the contig assignment and the second identifier came from the corresponding scaffold assignment. Contigs with less than two taxonomic assignments at each rank were not considered in this comparison. The measure ‘% agreement’ was the percentage of contigs with the same two taxonomic identifiers at a particular rank, whereas ‘kb agreement’ was the total number of kb of contigs with the same taxonomic identifiers (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.10.1). Bold numbers correspond to the best values, whereas italic numbers indicate the worst values.</p>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-04-1603-g006"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Method</th>
                  <th rowspan="1" colspan="1">Rank</th>
                  <th rowspan="1" colspan="1">% agreement</th>
                  <th rowspan="1" colspan="1">kb agreement</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">73.9</td>
                  <td rowspan="1" colspan="1">
                    <bold>153,774</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">67.8</td>
                  <td rowspan="1" colspan="1">75,538</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">74.2</td>
                  <td rowspan="1" colspan="1">43,380</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">
                    <bold>98.2</bold>
                  </td>
                  <td rowspan="1" colspan="1">59,702</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">
                    <italic>67.0</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>33,558</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">86.0</td>
                  <td rowspan="1" colspan="1">
                    <bold>99,596</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">
                    <italic>58.5</italic>
                  </td>
                  <td rowspan="1" colspan="1">43,931</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">68.5</td>
                  <td rowspan="1" colspan="1">33,780</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">
                    <bold>97.7</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>23,190</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">
                    <italic>58.5</italic>
                  </td>
                  <td rowspan="1" colspan="1">27,536</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">88.4</td>
                  <td rowspan="1" colspan="1">
                    <bold>98,616</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">63.8</td>
                  <td rowspan="1" colspan="1">41,349</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">68.9</td>
                  <td rowspan="1" colspan="1">32,650</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">
                    <bold>98.0</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>22,368</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">
                    <italic>57.0</italic>
                  </td>
                  <td rowspan="1" colspan="1">26,410</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">80.0</td>
                  <td rowspan="1" colspan="1">
                    <bold>46,343</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">55.8</td>
                  <td rowspan="1" colspan="1">19,158</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">55.0</td>
                  <td rowspan="1" colspan="1">15,790</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">
                    <bold>98.9</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>7,276</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">
                    <italic>45.2</italic>
                  </td>
                  <td rowspan="1" colspan="1">18,370</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">84.3</td>
                  <td rowspan="1" colspan="1">
                    <bold>33,724</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">63.2</td>
                  <td rowspan="1" colspan="1">12,938</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">56.0</td>
                  <td rowspan="1" colspan="1">13,726</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">
                    <bold>99.1</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>6,042</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">
                    <italic>43.7</italic>
                  </td>
                  <td rowspan="1" colspan="1">16,912</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">91.6</td>
                  <td rowspan="1" colspan="1">9,821</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">N/A</td>
                  <td rowspan="1" colspan="1">N/A</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">54.6</td>
                  <td rowspan="1" colspan="1">8,502</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">
                    <bold>100.0</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>292</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">
                    <italic>38.1</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>14,186</bold>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>For the human gut microbiome, extensive sequencing of isolate cultures has resulted in a large collection of several hundred reference genome sequences. Accordingly, for the human gut dataset, <italic>taxator-tk</italic>, <italic>MEGAN4 and Kraken</italic> assigned many more sequences than they did for the cow rumen dataset (<xref ref-type="table" rid="table-2">Tables 2</xref> and <xref ref-type="table" rid="table-3">3</xref>). For <italic>Kraken</italic> and <italic>MEGAN4</italic>, this was most pronounced for the genus and species ranks, even though this was also caused by counting scaffolds containing only one contig being consistent to itself. The most consistent method was again <italic>taxator-tk</italic>, but it also assigned fewer sequences than the other methods. <italic>PPS</italic>+ performed better than the generic <italic>PPS</italic> model in all cases in terms of both measures (<xref ref-type="table" rid="table-3">Table 3</xref>). <italic>PPS</italic>+ and <italic>MEGAN4</italic> showed comparable consistency, with <italic>PPS</italic>+ being more consistent for the class, order and species ranks, and <italic>MEGAN4</italic> being more consistent for the superkingdom, family and genus ranks. However, <italic>PPS</italic>+ consistently assigned (kb agreement) more sequences than <italic>MEGAN4</italic>, except for the genus and species ranks. Thus, in the case of larger collections of related isolate genome sequences being available, composition- and homology-based methods perform similarly well.</p>
        <table-wrap id="table-3" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj.1603/table-3</object-id>
          <label>Table 3</label>
          <caption>
            <title>Comparison of contig and scaffold assignments of the human gut metagenome dataset.</title>
            <p>Contig and scaffold sequences of the human gut metagenome dataset were assigned using <italic>PPS</italic>+, the generic <italic>PPS</italic> model, <italic>MEGAN4</italic>, <italic>taxator-tk</italic> and <italic>Kraken</italic>. The measures ‘% agreement’ and ‘kb agreement’ were used to compare individual methods (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.10.1). Bold numbers correspond to the best values, whereas italic numbers indicate the worst values.</p>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-04-1603-g007"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Method</th>
                  <th rowspan="1" colspan="1">Rank</th>
                  <th rowspan="1" colspan="1">% agreement</th>
                  <th rowspan="1" colspan="1">kb agreement</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">99.0</td>
                  <td rowspan="1" colspan="1">
                    <bold>140,283</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">
                    <italic>97.0</italic>
                  </td>
                  <td rowspan="1" colspan="1">124,884</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">99.0</td>
                  <td rowspan="1" colspan="1">127,658</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">
                    <bold>100.0</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>104,475</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">97.6</td>
                  <td rowspan="1" colspan="1">123,428</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">99.5</td>
                  <td rowspan="1" colspan="1">
                    <bold>134,707</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">96.9</td>
                  <td rowspan="1" colspan="1">118,068</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">98.5</td>
                  <td rowspan="1" colspan="1">122,131</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">
                    <bold>100.0</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>84,228</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">
                    <italic>96.3</italic>
                  </td>
                  <td rowspan="1" colspan="1">121,071</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">99.5</td>
                  <td rowspan="1" colspan="1">
                    <bold>134,127</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">97.3</td>
                  <td rowspan="1" colspan="1">117,185</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">98.6</td>
                  <td rowspan="1" colspan="1">121,811</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">
                    <bold>100.0</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>83,337</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">
                    <italic>96.3</italic>
                  </td>
                  <td rowspan="1" colspan="1">121,003</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">94.0</td>
                  <td rowspan="1" colspan="1">
                    <bold>110,664</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">92.6</td>
                  <td rowspan="1" colspan="1">97,066</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">96.2</td>
                  <td rowspan="1" colspan="1">98,582</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">
                    <bold>99.8</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>43,751</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">
                    <italic>89.4</italic>
                  </td>
                  <td rowspan="1" colspan="1">109,151</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">95.3</td>
                  <td rowspan="1" colspan="1">82,992</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">91.9</td>
                  <td rowspan="1" colspan="1">58,883</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">96.1</td>
                  <td rowspan="1" colspan="1">86,495</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">
                    <bold>99.9</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>34,667</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">
                    <italic>88.3</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>97,097</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">94.7</td>
                  <td rowspan="1" colspan="1">43,329</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>PPS</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">N/A</td>
                  <td rowspan="1" colspan="1">N/A</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MEGAN4</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">93.5</td>
                  <td rowspan="1" colspan="1">64,554</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>taxator-tk</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">
                    <bold>99.7</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>10,314</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>Kraken</italic>
                  </td>
                  <td rowspan="1" colspan="1">Species</td>
                  <td rowspan="1" colspan="1">
                    <italic>81.3</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>94,591</bold>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The taxonomic scaffold-contig consistency of the assignments was additionally evaluated (<xref ref-type="supplementary-material" rid="supp-22">Table S6</xref> and <xref ref-type="supplementary-material" rid="supp-23">Table S7</xref>) using a set of measures (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.10.2) that provide more detailed insights into assignment consistency (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 5.1) and support the conclusions in this section.</p>
      </sec>
      <sec>
        <title>Comparison to an expert binning based on marker genes</title>
        <p>A taxonomic binning generated by <italic>PhyloPythia</italic> (<italic>PP</italic>) with expert guidance for sample-derived model construction (<xref rid="ref-43" ref-type="bibr">Turnbaugh et al., 2010</xref>) was compared to the <italic>PPS</italic>+ assignments. Scaffolds that were unassigned by either method were not considered. The <italic>PP</italic> expert binning and the <italic>PPS</italic>+ binning agreed well, down to the order rank (<xref ref-type="table" rid="table-4">Table 4</xref>). For the family and genus ranks, the overlap of both methods dropped to 69.5–74.1%, which may partly be due to changes in the NCBI taxonomy since the generation of the expert binning in 2009. Both <italic>PPS</italic>+ and <italic>PP</italic> assignments were highly consistent with the <italic>MG</italic> assignments made by the + component of <italic>PPS</italic>+ alone, though only a small number of scaffolds with marker genes could be compared (7–23% for different ranks). While <italic>PPS</italic>+ had a larger overlap (‘% agreement’) with the <italic>MG</italic> assignments at the genus rank, <italic>PP</italic> had a larger overlap (‘% agreement’) with the <italic>MG</italic> assignments at the family rank. Moreover, we compared the number of taxonomic assignments for individual methods (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>): <italic>PPS</italic>+ assigned sequences to low-ranking taxa down to the species level, in agreement with the <italic>MG</italic> assignments, while <italic>PP</italic> often assigned the respective sequences only to the parental taxa. This demonstrates that <italic>PPS</italic>+ can generate a high quality taxonomic binning in a fully automated manner.</p>
        <table-wrap id="table-4" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj.1603/table-4</object-id>
          <label>Table 4</label>
          <caption>
            <title>Comparison to an expert binning based on marker genes.</title>
            <p>Comparison of the taxonomic assignments of <italic>PPS</italic>+ versus <italic>PhyloPythia</italic> (<italic>PP</italic>), with expert guidance for sample-derived model construction (<xref rid="ref-43" ref-type="bibr">Turnbaugh et al., 2010</xref>) for the human gut scaffolds (161, 343 kb) based on marker genes (<italic>MG</italic>), using the + component of <italic>PPS</italic>+. The measure ‘% agreement’ represents the percentage of bp assigned by both methods to the same taxonomic identifiers at a given rank, whereas ‘kb agreement’ is the corresponding number of kb assigned by both methods to the same taxonomic identifier. Scaffolds assigned by only one method are not considered in this comparison. Bold numbers correspond to the best values, whereas italic numbers indicate the worst values.</p>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-04-1603-g008"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Comparison</th>
                  <th rowspan="1" colspan="1">Rank</th>
                  <th rowspan="1" colspan="1">% agreement</th>
                  <th rowspan="1" colspan="1">kb agreement</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PP vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Superkingdom</td>
                  <td rowspan="1" colspan="1">99.6</td>
                  <td rowspan="1" colspan="1">
                    <bold>160,617</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MG vs PP</italic>
                  </td>
                  <td rowspan="1" colspan="1">Superkingdom</td>
                  <td rowspan="1" colspan="1">
                    <bold>99.7</bold>
                  </td>
                  <td rowspan="1" colspan="1">38,314</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>MG vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Superkingdom</td>
                  <td rowspan="1" colspan="1">
                    <italic>99.5</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>38,220</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PP vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">
                    <italic>95.4</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>149,213</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MG vs PP</italic>
                  </td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">96.9</td>
                  <td rowspan="1" colspan="1">
                    <italic>17,771</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>MG vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Phylum</td>
                  <td rowspan="1" colspan="1">
                    <bold>98.7</bold>
                  </td>
                  <td rowspan="1" colspan="1">18,065</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PP vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">
                    <italic>97.0</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>145,887</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MG vs PP</italic>
                  </td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">98.1</td>
                  <td rowspan="1" colspan="1">
                    <italic>17,599</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>MG vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Class</td>
                  <td rowspan="1" colspan="1">
                    <bold>100.0</bold>
                  </td>
                  <td rowspan="1" colspan="1">17,869</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PP vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">
                    <italic>98.0</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>145,373</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MG vs PP</italic>
                  </td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">98.3</td>
                  <td rowspan="1" colspan="1">
                    <italic>17,494</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>MG vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Order</td>
                  <td rowspan="1" colspan="1">
                    <bold>100.0</bold>
                  </td>
                  <td rowspan="1" colspan="1">17,764</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PP vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">
                    <italic>69.5</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>95,779</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MG vs PP</italic>
                  </td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">
                    <bold>90.7</bold>
                  </td>
                  <td rowspan="1" colspan="1">13,047</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>MG vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Family</td>
                  <td rowspan="1" colspan="1">83.7</td>
                  <td rowspan="1" colspan="1">
                    <italic>12,013</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>PP vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">
                    <italic>74.1</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <bold>78,686</bold>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <italic>MG vs PP</italic>
                  </td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">91.6</td>
                  <td rowspan="1" colspan="1">12,235</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1"><italic>MG vs PPS</italic>+</td>
                  <td rowspan="1" colspan="1">Genus</td>
                  <td rowspan="1" colspan="1">
                    <bold>94.9</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic>11,479</italic>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <fig id="fig-3" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerj.1603/fig-3</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Comparison to expert binning based on marker genes.</title>
            <p>The amount of assigned bp by <italic>PhyloPythia</italic> (<italic>PP</italic>), <italic>PhyloPythiaS</italic>+ (<italic>PPS</italic>+) and taxonomically informative marker genes directly (<italic>MG</italic>) to each taxon are indicated by the pie chart sizes on a log-scale for the human gut metagenome sample (<xref rid="ref-43" ref-type="bibr">Turnbaugh et al., 2010</xref>; <xref rid="ref-28" ref-type="bibr">Patil, Roune &amp; McHardy, 2011</xref>). <italic>PhyloPythiaS</italic>+ automatically determined the taxa to model from the sample. For the expert-trained <italic>PhyloPythia</italic>, the taxa to model were specified by an expert, and were included in the model if they were covered by sufficient reference sequence data retrieved separately from the sample and from sequenced human gut isolates. <italic>PhyloPythiaS</italic>+ assigned sequences to low-ranking taxa down to the species level, in agreement with the marker gene assignments, while <italic>PhyloPythia</italic> often assigned these sequences to the parental taxa. For the <italic>MG</italic> assignments, a negligible amount—only two contigs (3.6 kb) of two scaffolds (231 kb)—were used as sample-derived training data for <italic>PPS</italic>+; as mainly sample contigs (2.5 Mb) that were not part of scaffolds were used as sample-derived data to train <italic>PPS</italic>.</p>
          </caption>
          <graphic xlink:href="peerj-04-1603-g003"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Throughput comparison</title>
      <p>The throughput of the individual methods for contig assignments of the human gut sample was calculated (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.3, 3.4 and 5.3). The throughput of <italic>Kraken</italic> substantially varied between 38.4 Mb/h and 4.2 Gb/h in our experiments, depending on whether its large (∼200 GB) reference database was already loaded in the main memory or not, therefore <italic>Kraken</italic> is the fastest method in high performance environments. When only the prediction step of <italic>PPS</italic>+ was considered, <italic>PPS</italic>+ assigned up to 0.5 Gb/h and was more than 7 times faster than the homology-based methods (<xref ref-type="fig" rid="fig-4">Fig. 4</xref>). This is relevant when <italic>PPS</italic> models are reused for the classification of another sample. Moreover, unlike the homology-based tools and <italic>Kraken</italic>, <italic>PPS</italic>+ can be run on a standard laptop, as it requires much less main memory (see <xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.4 for the hardware configurations used).</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.1603/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Empirical comparison of execution times.</title>
          <p>The throughput was measured in Mb and the number of sequences classified within 1 h with one execution thread, using all assembled contigs of the human gut metagenome dataset on a server computer with an AMD Opteron 6386 SE 2.8 GHz processor and 512 GB of RAM. Default settings were used for all methods (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.5–3.7). Both <italic>MEGAN4</italic> and <italic>taxator-tk</italic> were run using <italic>BLAST</italic>. For <italic>MEGAN4</italic>, only the runtime of <italic>BLAST</italic> was considered, as the runtime of the subsequent algorithm was negligible. For <italic>PhyloPythiaS</italic> and <italic>PhyloPythiaS</italic>+, the throughput was calculated for the prediction step and both steps (training and prediction). The former is relevant when using previously generated models for the classification of multiple samples. The execution time shown for <italic>PhyloPythiaS</italic> is approximately three times better than that for the original release, as we incorporated the new <italic>k</italic>-mer counting algorithm. <italic>PhyloPythiaS</italic>+ was the only method that could also be executed on a standard laptop (NB) with an Intel i5 M520 2.4 GHz processor, 4 GB of RAM and 150 GB disk space.</p>
        </caption>
        <graphic xlink:href="peerj-04-1603-g004"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We describe a taxonomic assignment program that produces accurate assignments with a precision of 80% or more also for low-ranking taxa from metagenome samples. <italic>PPS</italic>+ is a fully automated successor of the <italic>PhyloPythiaS</italic> software. It automatically determines the most relevant taxa to be modeled and suitable training sequences directly from the input sample, which are then used to generate a sample-specific structured output SVM taxonomic classifier for the taxonomic binning of a sample. This enables its use for researchers without experience in the field or time to search for suitable training sequences for the manual construction of well-matching taxonomic classifier to a particular metagenome sequence sample.</p>
    <p><italic>PPS</italic>+ is best suited for the analysis of large NGS metagenome samples with assembled contigs (&gt; 1kb) carrying marker genes or datasets including the high quality longer PacBio (<xref rid="ref-5" ref-type="bibr">Chin et al., 2013</xref>) consensus reads. Contrary to some recent methods for the taxonomic profiling or binning of multiple similar samples (<xref rid="ref-42" ref-type="bibr">Sunagawa et al., 2013</xref>), <italic>PPS</italic>+ can be also applied to individual samples. <italic>PPS</italic>+ requires only 100 kb of sample-derived data to model a bin, while homology-based methods require large related reference genome or draft genome sequence collections for substantial assignments to low-ranking taxa. Our experiments on both real and simulated metagenome samples showed that <italic>PPS</italic>+ automatically reconstructed many low-ranking bins from metagenome samples, such as for genera and species, representing draft genomes or pan-genomes of different community members.</p>
    <p>The novel implementation of the <italic>k</italic>-mer counting algorithm accelerated <italic>k</italic>-mer counting 100-fold in comparison to the original <italic>PPS</italic> software and made <italic>PPS</italic>+ overall up to three times faster. The method performed favorably in comparison to all state-of-the-art <italic>k</italic>-mer counting software for the simultaneous enumeration of 4–6-mers, commonly used for composition-based binning.</p>
    <p><italic>PPS</italic> models can be reused when classifying multiple samples from the same or similar environments. When comparing assignment with <italic>PPS</italic>+ to <italic>MEGAN4</italic> and <italic>taxator-tk</italic>, <italic>PPS</italic>+ showed a competitive processing time, allowing to process up to 0.5 Gb of sequences per hour with a given <italic>PPS</italic> model on a single core with much lower main memory requirements, while <italic>MEGAN4</italic> processed 0.065 Gb and <italic>taxator-tk</italic> 0.03 Gb (<xref ref-type="fig" rid="fig-4">Fig. 4</xref>). The fastest method in the comparison was <italic>Kraken</italic> with up to 4.2 Gb/h; however, we have found that <italic>Kraken</italic> should be used only for well-studied environments, for which many closely related (draft) genomes have been sequenced, as an alternative to alignment-based methods, as its use for samples originating from novel environments is very limited (<xref ref-type="fig" rid="fig-2">Fig. 2</xref>).</p>
    <p>In terms of assignment quality, we found that <italic>PPS</italic>+ often outperformed <italic>MEGAN4</italic> and <italic>Kraken</italic> in terms of precision, recall and consistency. <italic>Taxator-tk</italic> performed best in terms of precision and consistency, but assigned substantially fewer sequences to low taxonomic ranks. <italic>PPS</italic>+ also excelled in determining the taxa that were part of the simulated metagenome community. We found that the fully automated <italic>PPS</italic>+ binning can be as good as an expert-guided binning with the original <italic>PhyloPythia</italic> implementation. <italic>PPS</italic>+ also showed a substantially improved assignment performance compared to the generic <italic>PPS</italic> model.</p>
    <p>To conclude, the newly introduced self-training (+) component and the faster <italic>k</italic>-mer counting algorithm implemented in <italic>PPS</italic>+ allow users to generate high quality taxonomic binnings of metagenome samples in a high-throughput fashion, without requiring expensive hardware, manual intervention and expert knowledge. It should be helpful to a wide range of users. An initial version of the software has been already employed for the taxonomic binning of a metagenome sample from reindeer guts by <xref rid="ref-32" ref-type="bibr">Pope et al. (2011a)</xref> and it is currently used in several other projects: for instance, a <italic>PPS</italic>+ binning of shotgun metagenome samples indicated the likely metabolite flow and participating microbial phylotypes for a biogas-producing microbial community tolerant of high ammonia levels (<xref ref-type="supplementary-material" rid="supp-2">Supplemental Information 2</xref>).</p>
    <p><italic>PPS</italic>+ is distributed with a large reference sequence collection (containing Bacterial and Archaeal data) in a virtual machine, which makes it easy to install. This allows metagenome sample analysis on a standard laptop under Windows, Unix or OS X systems.</p>
  </sec>
  <sec sec-type="supplementary-material" id="supplemental-information">
    <title>Supplemental Information</title>
    <supplementary-material content-type="local-data" id="supp-1">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-1</object-id>
      <label>Text S1</label>
      <caption>
        <title>Supplemental Text S1</title>
      </caption>
      <media xlink:href="peerj-04-1603-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-2">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-2</object-id>
      <label>Text S2</label>
      <caption>
        <title>Supplemental Text S2</title>
        <p>Personal communication from Dr PB Pope.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-3">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-3</object-id>
      <label>Figure S1</label>
      <caption>
        <title>Benchmark results for the simulated dataset with uniform distribution</title>
        <p>Precision (P) and recall (R) (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.9.1) at different taxonomic ranks were calculated for (A–C) <italic>PPS</italic>+, (D) the generic <italic>PPS</italic> model, (E) <italic>MEGAN4</italic> and (F) <italic>taxator-tk</italic> in all test scenarios (<xref ref-type="table" rid="table-1">Table 1</xref>: Test Scenarios 1–9). In parentheses, (mg) and (rs) denote whether the sequences at a given taxonomic rank were masked from the marker gene or from the reference sequence collections, respectively (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Sections 3.1 and 3.3). If not stated, sequences were masked from both reference collections.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s003.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-4">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-4</object-id>
      <label>Figure S2</label>
      <caption>
        <title>Benchmark results for the simulated dataset with uniform distribution using ‘correction’</title>
        <p>Precision (P) and recall (R) were calculated with a ‘correction’ (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.9) at different taxonomic ranks for (A–C) <italic>PPS</italic>+, (D) the generic <italic>PPS</italic> model, (E) <italic>MEGAN4</italic> and (F) <italic>taxator-tk</italic> in all test scenarios (<xref ref-type="table" rid="table-1">Table 1</xref>: Test Scenarios 1–9, <xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.1).</p>
      </caption>
      <media xlink:href="peerj-04-1603-s004.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-5">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-5</object-id>
      <label>Figure S3</label>
      <caption>
        <title>Benchmark results for the simulated dataset with the log-normal distribution</title>
        <p>Precision (P) and recall (R) (Section 3.9.1) at different taxonomic ranks were calculated for (A–C) <italic>PPS</italic>+, (D) the generic <italic>PPS</italic> model, (E) <italic>MEGAN4</italic> and (F) <italic>taxator-tk</italic> in all test scenarios (<xref ref-type="table" rid="table-1">Table 1</xref>: Test Scenarios 1–9, <xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.1).</p>
      </caption>
      <media xlink:href="peerj-04-1603-s005.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-6">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-6</object-id>
      <label>Figure S4</label>
      <caption>
        <title>Benchmark results for the simulated dataset with the log-normal distribution using ‘correction’</title>
        <p>Precision (P) and recall (R) were calculated with a ‘correction’ (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.9) at different taxonomic ranks for (A–C) <italic>PPS</italic>+, (D) the generic <italic>PPS</italic> model, (E) <italic>MEGAN4</italic> and (F) <italic>taxator-tk</italic> in all test scenarios (<xref ref-type="table" rid="table-1">Table 1</xref>: Test Scenarios 1–9, <xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.1).</p>
      </caption>
      <media xlink:href="peerj-04-1603-s006.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-7">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-7</object-id>
      <label>Figure S5</label>
      <caption>
        <title>Base pairs assigned to individual taxa for a simulated metagenome of a microbial community with log-normally distributed species abundance</title>
        <p>The number of taxonomic assignments to each taxon in bp is indicated on a log-scale by the pie chart sizes for <italic>PPS</italic>+, the generic <italic>PPS</italic> model, <italic>taxator-tk</italic>, <italic>MEGAN4</italic> and the underlying standard of truth (TRUE). There were 47 strains present in the simulated metagenome sample. Assignments to taxa not shown in black in the chart are to false taxa that are not present in the simulated metagenome. (A) shows the scenario where sequences from the same species as those of the simulated dataset were excluded from the reference sequences but not the marker gene databases (<xref ref-type="table" rid="table-1">Table 1</xref>: Test Scenario 3). (B) shows the scenario where sequences from the same species as those of the simulated dataset were excluded from the reference sequence and marker gene databases (<xref ref-type="table" rid="table-1">Table 1</xref>: Test Scenario 8).</p>
      </caption>
      <media xlink:href="peerj-04-1603-s007.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-8">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-8</object-id>
      <label>Figure S6</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using <italic>PPS</italic>+ for the chunked cow rumen dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Sections 3.2.2 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus; (F) species.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s008.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-9">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-9</object-id>
      <label>Figure S7</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using the generic <italic>PPS</italic> model for the chunked cow rumen dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Sections 3.2.2 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s009.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-10">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-10</object-id>
      <label>Figure S8</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using <italic>MEGAN4</italic> for the chunked cow rumen dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.2.2 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus; (F) species.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s010.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-11">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-11</object-id>
      <label>Figure S9</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using <italic>taxator-tk</italic> for the chunked cow rumen dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.2.2 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus; (F) species.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s011.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-12">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-12</object-id>
      <label>Figure S10</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using <italic>PPS</italic>+ for the human gut dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Sections 3.2.1 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus; (F) species.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s012.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-13">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-13</object-id>
      <label>Figure S11</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using the generic <italic>PPS</italic> model for the human gut dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Sections 3.2.1 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s013.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-14">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-14</object-id>
      <label>Figure S12</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using <italic>MEGAN4</italic> for the human gut dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Sections 3.2.1 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus; (F) species.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s014.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-15">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-15</object-id>
      <label>Figure S13</label>
      <caption>
        <title>Comparison of scaffold and contig assignments using <italic>taxator-tk</italic> for the human gut dataset</title>
        <p>The comparisons were performed at different taxonomic ranks using heat maps (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Sections 3.2.1 and 3.10.1). The rows correspond to scaffolds and the columns correspond to contig assignments. (A) Phylum; (B) class; (C) order; (D) family; (E) genus; (F) species.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s015.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-16">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-16</object-id>
      <label>Figure S14</label>
      <caption>
        <title>Benchmark results for the simulated datasets with the <italic>Kraken</italic> software</title>
        <p>Precision (P) and recall (R) (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.9) at different taxonomic ranks were calculated for the <italic>Kraken</italic> software in four test scenarios (<xref ref-type="table" rid="table-1">Table 1</xref>: Test Scenarios 1, 5, 8, 9, <xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.1) using the simulated datasets with the uniform (A and B) and log-norm (C and D) distribution.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s016.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-17">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-17</object-id>
      <label>Table S1</label>
      <caption>
        <title>Runtime comparison of the <italic>k</italic>-mer counting algorithms <italic>Jellyfish, KAnalyze,</italic> and the new <italic>k</italic>-mer counting algorithm implemented in <italic>PPS</italic>+</title>
        <p>The relevant combination of <italic>k</italic>-mers that is typically counted for taxonomic binning is marked in bold. The benchmark was run in one thread on a server with an Intel Xeon (CPU X5660, 2.8 GHz) processor, nevertheless we observed that <italic>Jellyfish</italic> 1.1.1 took approximately 30% more CPU resources than specified. Parallel runs of the methods can be done by splitting the input FASTA file, running multiple instances of a tool for each file separately in parallel and merging of the result files, thus the runtimes scale approximately linearly with the number of CPUs used. As a benchmark dataset, concatenated contigs from (<xref rid="ref-43" ref-type="bibr">Turnbaugh et al., 2010</xref>) (255 Mb) were used.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s017.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-18">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-18</object-id>
      <label>Table S2</label>
      <caption>
        <title>Exact values corresponding to (<xref ref-type="fig" rid="fig-2">Fig. 2A</xref>)</title>
      </caption>
      <media xlink:href="peerj-04-1603-s018.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-19">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-19</object-id>
      <label>Table S3</label>
      <caption>
        <title>Exact values corresponding to (<xref ref-type="fig" rid="fig-2">Fig. 2B</xref>)</title>
      </caption>
      <media xlink:href="peerj-04-1603-s019.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-20">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-20</object-id>
      <label>Table S4</label>
      <caption>
        <title>Exact values corresponding to (<xref ref-type="fig" rid="fig-2">Fig. 2C</xref>)</title>
      </caption>
      <media xlink:href="peerj-04-1603-s020.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-21">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-21</object-id>
      <label>Table S5</label>
      <caption>
        <title>Exact values corresponding to (<xref ref-type="fig" rid="fig-2">Fig. 2D</xref>)</title>
      </caption>
      <media xlink:href="peerj-04-1603-s021.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-22">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-22</object-id>
      <label>Table S6</label>
      <caption>
        <title>Scaffold-contig consistency of the chunked cow rumen dataset.</title>
        <p>Contigs of the cow rumen dataset of at least 10 kb were divided into chunks of 2 kb for evaluation of assignment consistency (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.2.2). Scaffold-contig consistency of the assignments made by <italic>PPS</italic>+, the generic <italic>PPS</italic> model, <italic>MEGAN4</italic>, <italic>Kraken</italic> and <italic>taxator-tk</italic> for the chunked cow rumen dataset, computed via different definitions (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.10.2). The table also contains the number of kb of contigs assigned at low taxonomic ranks (family, genus and species) and the corresponding consistency (% agreement) (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.10.1). Bold numbers correspond to the best values, whereas italic numbers indicate the worst values.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s022.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-23">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-23</object-id>
      <label>Table S7</label>
      <caption>
        <title>Scaffold-contig consistency of the human gut metagenome dataset</title>
        <p>Scaffold-contig consistency of the assignments made by <italic>PPS</italic>+, the generic <italic>PPS</italic> model, <italic>MEGAN4</italic>, <italic>Kraken</italic> and <italic>taxator-tk</italic> of the human gut dataset (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.2.1) computed using different definitions (<xref ref-type="supplementary-material" rid="supp-1">Supplemental Information 1</xref>, Section 3.10). Bold numbers correspond to the best values, whereas italic numbers indicate the worst values.</p>
      </caption>
      <media xlink:href="peerj-04-1603-s023.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-24">
      <object-id pub-id-type="doi">10.7717/peerj.1603/supp-24</object-id>
      <label>Dataset S1</label>
      <caption>
        <title>Simulated and real datasets used for the benchmarks</title>
      </caption>
      <media xlink:href="peerj-04-1603-s024.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Phillip B. Pope and Jeremy Frank for their summary of the <italic>PPS</italic>+ results for shotgun metagenome data from a biogas-producing microbial community (<xref ref-type="supplementary-material" rid="supp-2">Supplemental Information 2</xref>); and Rubén Garrido Oter for generating the pie tree figures.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="conflict">
        <p>Alice C. McHardy is an Academic Editor for PeerJ. The authors declare there are no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Ivan Gregor</xref> conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, wrote the paper, prepared figures and/or tables.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Johannes Dröge</xref> conceived and designed the experiments, performed the experiments, reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-3" fn-type="con">
        <p><xref ref-type="contrib" rid="author-3">Melanie Schirmer</xref> performed the experiments, reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-4" fn-type="con">
        <p><xref ref-type="contrib" rid="author-4">Christopher Quince</xref> reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-5" fn-type="con">
        <p><xref ref-type="contrib" rid="author-5">Alice C. McHardy</xref> conceived and designed the experiments, wrote the paper, analyzed the data.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1" fn-type="other">
        <p>The following information was supplied regarding data availability:</p>
        <p>All the external resources can be found at: <uri xlink:href="https://github.com/algbioi/ppsp/wiki">https://github.com/algbioi/ppsp/wiki</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Audano &amp; Vannberg (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Audano</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vannberg</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>KAnalyze: a fast versatile pipelined K-mer toolkit</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2070</fpage>
        <lpage>2072</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu152</pub-id>
        <pub-id pub-id-type="pmid">24642064</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Blaser et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blaser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The microbiome explored: recent insights and future challenges</article-title>
        <source>Nature Reviews Microbiology</source>
        <year>2013</year>
        <volume>11</volume>
        <fpage>213</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2973</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Boisvert et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boisvert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raymond</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Godzaridis</surname>
            <given-names>É</given-names>
          </name>
          <name>
            <surname>Laviolette</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Corbeil</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ray Meta: scalable de novo metagenome assembly and profiling</article-title>
        <source>Genome Biology</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R122</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-12-r122</pub-id>
        <pub-id pub-id-type="pmid">23259615</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Brady &amp; Salzberg (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brady</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PhymmBL expanded: confidence scores, custom databases, parallelization and more</article-title>
        <source>Nature Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>367</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth0511-367</pub-id>
        <pub-id pub-id-type="pmid">21527926</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Chin et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Klammer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heiner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Clum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huddleston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Korlach</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>563</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2474</pub-id>
        <pub-id pub-id-type="pmid">23644548</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Deorowicz et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Debudaj-Grabysz</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>KMC 2: fast and resource-frugal k-mer counting</article-title>
        <source>Bioinformatics</source>
        <issue>10</issue>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1569</fpage>
        <lpage>1576</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv022</pub-id>
        <pub-id pub-id-type="pmid">25609798</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Deschavanne et al. (1999)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deschavanne</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Giron</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fagot</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fertil</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Genomic signature: characterization and classification of species assessed by chaos game representation of sequences</article-title>
        <source>Molecular Biology and Evolution</source>
        <year>1999</year>
        <volume>16</volume>
        <fpage>1391</fpage>
        <lpage>1399</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a026048</pub-id>
        <pub-id pub-id-type="pmid">10563018</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Dröge, Gregor &amp; McHardy (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gregor</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Taxator-tk: precise taxonomic assignment of metagenomes by fast approximation of evolutionary neighborhoods</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>817</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu745</pub-id>
        <pub-id pub-id-type="pmid">25388150</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Dröge &amp; McHardy (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Taxonomic binning of metagenome samples generated by next-generation sequencing technologies</article-title>
        <source>Briefings in Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>646</fpage>
        <lpage>655</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs031</pub-id>
        <pub-id pub-id-type="pmid">22851513</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Gerlach &amp; Stoye (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerlach</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Taxonomic classification of metagenomic shotgun sequences with CARMA3</article-title>
        <source>Nucleic Acids Research</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>e91</fpage>
        <lpage>e91</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr225</pub-id>
        <pub-id pub-id-type="pmid">21586583</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Hess et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hess</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sczyrba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>T-W</given-names>
          </name>
          <name>
            <surname>Chokhawala</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mackie</surname>
            <given-names>RI</given-names>
          </name>
          <name>
            <surname>Pennacchio</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Tringe</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Visel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Woyke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic discovery of biomass-degrading genes and genomes from cow rumen</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>331</volume>
        <fpage>463</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1200387</pub-id>
        <pub-id pub-id-type="pmid">21273488</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Hugenholtz (2002)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Exploring prokaryotic diversity in the genomic era</article-title>
        <source>Genome Biology</source>
        <year>2002</year>
        <volume>3</volume>
        <comment>REVIEWS0003</comment>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Huson et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ruscheweyh</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Integrative analysis of environmental sequences using MEGAN4</article-title>
        <source>Genome Research</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>1552</fpage>
        <lpage>1560</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.120618.111</pub-id>
        <pub-id pub-id-type="pmid">21690186</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Joachims, Finley &amp; Yu (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joachims</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Finley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>C-NJ</given-names>
          </name>
        </person-group>
        <article-title>Cutting-plane training of structural SVMs</article-title>
        <source>Machine Learning</source>
        <year>2009</year>
        <volume>77</volume>
        <fpage>27</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="doi">10.1007/s10994-009-5108-8</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Kalyuzhnaya et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalyuzhnaya</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Szeto</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Salamov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grigoriev</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Suciu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Markowitz</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tringe</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Bruce</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Lidstrom</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Chistoserdova</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>High-resolution metagenomics targets specific functional types in complex microbial communities</article-title>
        <source>Nature Biotechnology</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1029</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1488</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Karlin &amp; Burge (1995)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dinucleotide relative abundance extremes: a genomic signature</article-title>
        <source>Trends in Genetics</source>
        <year>1995</year>
        <volume>11</volume>
        <fpage>283</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="doi">10.1016/S0168-9525(00)89076-9</pub-id>
        <pub-id pub-id-type="pmid">7482779</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Karp &amp; Rabin (1987)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karp</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Rabin</surname>
            <given-names>MO</given-names>
          </name>
        </person-group>
        <article-title>Efficient randomized pattern-matching algorithms</article-title>
        <source>IBM Journal of Research and Development</source>
        <year>1987</year>
        <volume>31</volume>
        <fpage>249</fpage>
        <lpage>260</lpage>
        <pub-id pub-id-type="doi">10.1147/rd.312.0249</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Kunin et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A bioinformatician’s guide to metagenomics</article-title>
        <source>Microbiology and Molecular Biology Reviews</source>
        <year>2008</year>
        <volume>72</volume>
        <fpage>557</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1128/MMBR.00009-08</pub-id>
        <pub-id pub-id-type="pmid">19052320</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Laserson, Jojic &amp; Koller (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laserson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jojic</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Genovo: de novo assembly for metagenomes</article-title>
        <source>Journal of Computational Biology</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>429</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0244</pub-id>
        <pub-id pub-id-type="pmid">21385045</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Liu et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gibbons</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ghodsi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Accurate and fast estimation of taxonomic profiles from metagenomic shotgun sequences</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>S4</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-S2-S4</pub-id>
        <pub-id pub-id-type="pmid">21989143</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Loman et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Constantinidou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>JZM</given-names>
          </name>
          <name>
            <surname>Halachev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sergeant</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Penn</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Pallen</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>High-throughput bacterial genome sequencing: an embarrassment of choice, a world of opportunity</article-title>
        <source>Nature Reviews Microbiology</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>599</fpage>
        <lpage>606</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2850</pub-id>
        <pub-id pub-id-type="pmid">22864262</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Marcais &amp; Kingsford (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marcais</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>764</fpage>
        <lpage>770</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr011</pub-id>
        <pub-id pub-id-type="pmid">21217122</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>McHardy et al. (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Martín</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Tsirigos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Accurate phylogenetic classification of variable-length DNA fragments</article-title>
        <source>Nature Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>63</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth976</pub-id>
        <pub-id pub-id-type="pmid">17179938</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Meinicke, Asshauer &amp; Lingner (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meinicke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Asshauer</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Lingner</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Mixture models for analysis of the taxonomic composition of metagenomes</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1618</fpage>
        <lpage>1624</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr266</pub-id>
        <pub-id pub-id-type="pmid">21546400</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Metzker (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metzker</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Sequencing technologies—the next generation</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2626</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Namiki et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Namiki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hachiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>MetaVelvet: an extension of Velvet assembler to de novo metagenome assembly from short sequence reads</article-title>
        <source>Nucleic Acids Research</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>20</issue>
        <fpage>e155</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks678</pub-id>
        <pub-id pub-id-type="pmid">22821567</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Ounit et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wanamaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Close</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>236</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1419-2</pub-id>
        <pub-id pub-id-type="pmid">25879410</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Patil, Roune &amp; McHardy (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patil</surname>
            <given-names>KRK</given-names>
          </name>
          <name>
            <surname>Roune</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>ACA</given-names>
          </name>
        </person-group>
        <article-title>The <italic>PhyloPythiaS</italic> web server for taxonomic assignment of metagenome sequences</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e38581</fpage>
        <lpage>e38581</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0038581</pub-id>
        <pub-id pub-id-type="pmid">22745671</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Patil et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patil</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Haider</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pope</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scheffer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Taxonomic metagenome sequence assignment with structured output models</article-title>
        <source>Nature Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>191</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth0311-191</pub-id>
        <pub-id pub-id-type="pmid">21358620</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Pell et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hintze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Canino-Koning</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Scaling metagenome sequence assembly with probabilistic de Bruijn graphs</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <year>2012</year>
        <volume>109</volume>
        <fpage>13272</fpage>
        <lpage>13277</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1121464109</pub-id>
        <pub-id pub-id-type="pmid">22847406</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Peng et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HCM</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FYL</given-names>
          </name>
        </person-group>
        <article-title>Meta-IDBA: a de Novo assembler for metagenomic data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>i94</fpage>
        <lpage>i101</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr216</pub-id>
        <pub-id pub-id-type="pmid">21685107</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Pope et al. (2011a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pope</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Mackenzie</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Gregor</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sundset</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eijsink</surname>
            <given-names>VGH</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics of the svalbard reindeer rumen microbiome reveals abundance of polysaccharide utilization Loci</article-title>
        <source>PLoS One</source>
        <year>2011a</year>
        <volume>7</volume>
        <fpage>e38571</fpage>
        <lpage>e38571</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0038571</pub-id>
        <pub-id pub-id-type="pmid">22701672</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Pope et al. (2011b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pope</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Denman</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Tringe</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McSweeney</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Isolation of Succinivibrionaceae implicated in low methane emissions from Tammar wallabies</article-title>
        <source>Science</source>
        <year>2011b</year>
        <volume>333</volume>
        <fpage>646</fpage>
        <lpage>648</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1205760</pub-id>
        <pub-id pub-id-type="pmid">21719642</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Riesenfeld, Schloss &amp; Handelsman (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riesenfeld</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics: genomic analysis of microbial communities</article-title>
        <source>Annual Review of Genetics</source>
        <year>2004</year>
        <volume>38</volume>
        <fpage>525</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genet.38.072902.091216</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Rosen, Reichenberger &amp; Rosenfeld (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosen</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Reichenberger</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Rosenfeld</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>NBC: the Naive Bayes Classification tool webserver for taxonomic classification of metagenomic reads</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>127</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq619</pub-id>
        <pub-id pub-id-type="pmid">21062764</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Roy, Bhattacharya &amp; Schliep (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roy</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Bhattacharya</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schliep</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Turtle: Identifying frequent k-mers with cache-efficient algorithms</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1950</fpage>
        <lpage>1957</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu132</pub-id>
        <pub-id pub-id-type="pmid">24618471</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Schloissnig et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloissnig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mitreva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tap</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Waller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kota</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sunyaev</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Genomic variation landscape of the human gut microbiome</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>493</volume>
        <fpage>45</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11711</pub-id>
        <pub-id pub-id-type="pmid">23222524</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-38">
      <label>Schloss et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ryabin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hollister</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Lesniewski</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Oakley</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Sahl</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Stres</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thallinger</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Van Horn</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Applied and Environmental Microbiology</source>
        <year>2009</year>
        <volume>75</volume>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-39">
      <label>Segata et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ballarini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Narasimhan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jousson</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>
        <source>Nature Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>811</fpage>
        <lpage>814</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2066</pub-id>
        <pub-id pub-id-type="pmid">22688413</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-40">
      <label>Silva et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silva</surname>
            <given-names>GGZ</given-names>
          </name>
          <name>
            <surname>Cuevas</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>FOCUS: an alignment-free model to identify organisms in metagenomes using non-negative least squares</article-title>
        <source>PeerJ</source>
        <year>2013</year>
        <volume>2</volume>
        <fpage>e425</fpage>
        <lpage>e425</lpage>
        <pub-id pub-id-type="doi">10.7717/peerj.425</pub-id>
        <pub-id pub-id-type="pmid">24949242</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-41">
      <label>Stark et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mering von</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>MLTreeMap—accurate Maximum Likelihood placement of environmental DNA sequences into taxonomic and functional reference phylogenies</article-title>
        <source>BMC Genomics</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>461</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-11-461</pub-id>
        <pub-id pub-id-type="pmid">20687950</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-42">
      <label>Sunagawa et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Zeller</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Izquierdo-Carrasco</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Coelho</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tap</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brunak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Guarner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>De Vos</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Doré</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ehrlich</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1196</fpage>
        <lpage>1199</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2693</pub-id>
        <pub-id pub-id-type="pmid">24141494</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-43">
      <label>Turnbaugh et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Faith</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Niazi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Affourtit</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Egholm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Henrissat</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Organismal, genetic, and transcriptional variation in the deeply sequenced gut microbiomes of identical twins</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>7503</fpage>
        <lpage>7508</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1002355107</pub-id>
        <pub-id pub-id-type="pmid">20363958</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-44">
      <label>Wood &amp; Salzberg (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biology</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R46</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
        <pub-id pub-id-type="pmid">24580807</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-45">
      <label>Wu &amp; Eisen (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A simple, fast, and accurate method of phylogenomic inference</article-title>
        <source>Genome Biology</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R151</fpage>
        <lpage>R151</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-r151</pub-id>
        <pub-id pub-id-type="pmid">18851752</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-46">
      <label>Wu &amp; Scott (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic analysis of bacterial and archaeal sequences with AMPHORA2</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1033</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts079</pub-id>
        <pub-id pub-id-type="pmid">22332237</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-47">
      <label>Zarowiecki (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zarowiecki</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics with guts</article-title>
        <source>Nature Reviews Microbiology</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>674</fpage>
        <lpage>674</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2879</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
