<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6511130</article-id>
    <article-id pub-id-type="publisher-id">2854</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2854-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pTrimmer: An efficient tool to trim primers of multiplex deep sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Xiaolong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Shao</surname>
          <given-names>Yanyan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Tian</surname>
          <given-names>Jichao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liao</surname>
          <given-names>Yuwei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Peiying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Jun</given-names>
        </name>
        <address>
          <email>chenjundl@vip.sina.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Zhiguang</given-names>
        </name>
        <address>
          <email>zhiguangli2013@126.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9558 1426</institution-id><institution-id institution-id-type="GRID">grid.411971.b</institution-id><institution>Center of Genome and Personalized Medicine, Institute of Cancer Stem Cell, </institution><institution>Dalian Medical University, </institution></institution-wrap>Dalian, 116044 Liaoning China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.452828.1</institution-id><institution>The Second Hospital of Dalian Medical University, </institution></institution-wrap>467th Zhongshan Road, Shahekou District, Dalian, 116023 Liaoning China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2189 3846</institution-id><institution-id institution-id-type="GRID">grid.207374.5</institution-id><institution>The Second Affiliated Hospital, School of Medicine, </institution><institution>Zhengzhou University, </institution></institution-wrap>Zhengzhou, 450052 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>236</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">With the widespread use of multiple amplicon-sequencing (MAS) in genetic variation detection, an efficient tool is required to remove primer sequences from short reads to ensure the reliability of downstream analysis. Although some tools are currently available, their efficiency and accuracy require improvement in trimming large scale of primers in high throughput target genome sequencing. This issue is becoming more urgent considering the potential clinical implementation of MAS for processing patient samples. We here developed pTrimmer that could handle thousands of primers simultaneously with greatly improved accuracy and performance.</p>
      </sec>
      <sec>
        <title>Result</title>
        <p id="Par2">pTrimmer combines the two algorithms of k-mers and Needleman-Wunsch algorithm, which ensures its accuracy even with the presence of sequencing errors. pTrimmer has an improvement of 28.59% sensitivity and 11.87% accuracy compared to the similar tools. The simulation showed pTrimmer has an ultra-high sensitivity rate of 99.96% and accuracy of 97.38% compared to cutPrimers (70.85% sensitivity rate and 58.73% accuracy). And the performance of pTrimmer is notably higher. It is about 370 times faster than cutPrimers and even 17,000 times faster than cutadapt per threads. Trimming 2158 pairs of primers from 11 million reads (Illumina PE 150 bp) takes only 37 s and no more than 100 MB of memory consumption.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">pTrimmer is designed to trim primer sequence from multiplex amplicon sequencing and target sequencing. It is highly sensitive and specific compared to other three similar tools, which could help users to get more reliable mutational information for downstream analysis.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2854-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Primer trimming</kwd>
      <kwd>Target sequencing</kwd>
      <kwd>Multiplex amplicon sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>81472637, 81672784 and 81602200</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Zhiguang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">Genomic mutation detection has become more and more popular in clinical cancer research [<xref ref-type="bibr" rid="CR1">1</xref>]. Multiplex amplicon-based deep sequencing is one of the major approaches for mutation detection of specific diseases-associated genes [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Many algorithms have been developed to identify mutations in cancer-associated genes [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. The reads from multiplex amplicon-based next-generation sequencing (NGS) usually contain two parts, namely gene-specific primers (i.e., sequence used to amplify the target regions) and region of interest [<xref ref-type="bibr" rid="CR5">5</xref>]. The contiguous amplicon sequences are usually designed to overlap with each other to cover the whole genes of interest [<xref ref-type="bibr" rid="CR6">6</xref>]. However, the ineffective oligonucleotide synthesis will introduce errors to primers, which means mapping the untrimmed NGS reads directly to reference genome would lead to unreliable mutation information. Specifically, the synthesis errors of primers would be mistakenly regarded as containing the mutational information, which would increase the value of variant allele frequency (VAF) at the corresponding genomic site, and therefore increasing its probability to be called as a ‘true’ nucleotide variant by the mutation caller software.</p>
    <p id="Par9">Some tools are currently available or compatible with primer trimming, such as cutadapt [<xref ref-type="bibr" rid="CR7">7</xref>] and AlienTrimmer [<xref ref-type="bibr" rid="CR8">8</xref>]. These tools work efficiently in removing adapter sequences. But multiplex amplicon sequencing usually has hundreds of or thousands of primer sequences [<xref ref-type="bibr" rid="CR2">2</xref>]. These tools become inefficient in trimming multiplex primer sequences. BAMClipper, a bam-based primer removing tool, focuses on the detection of insertion and deletion near the edge of region-of-interest [<xref ref-type="bibr" rid="CR5">5</xref>]. However, the Perl implementation and soft-clipping based primer matching algorithm make it rather low in processing large datasets. Some other tools, such as the technical sequences removing program, Trimmomatic [<xref ref-type="bibr" rid="CR9">9</xref>], can only trim the specific sequence from 3′-end instead of primer sequences from both 5′-end and 3′-end. The tool of cutPrimers [<xref ref-type="bibr" rid="CR10">10</xref>] is specially developed to remove multiplex primer sequences, however, the algorithm of regular expression matching and Python implementation result in the low sensitivity, specificity and performance.</p>
    <p id="Par10">In this study, we developed a new tool, pTrimmer, to trim primer sequence from multiplex amplicon sequence data. To increase the sensitivity and specificity, we employed both k-mers algorithm [<xref ref-type="bibr" rid="CR11">11</xref>] and Needleman-Wunsch algorithms [<xref ref-type="bibr" rid="CR12">12</xref>]. And the C implementation of the tool ensures its high performance. This tool can be deployed on both Windows and Linux systems. Benchmark analysis with three other tools shows that pTrimmer is highly time-efficient and accurate in primer trimming.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <p id="Par11">The pTrimmer workflow (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) is implemented with C language and is available to 32-bit/64-bit Windows and Linux platforms. pTrimmer takes fastq (single-end or paired-end) and a set of amplicon primer pairs as input. The method firstly preprocesses the given file to obtain the maximum sequence read length, the maximum primer length and the base quality encoding format (Phred+ 33 or Phred+ 64). Before the processing, pTrimmer loads the amplicon primer sequences into the computer’s RAM and extracts all potential 1-base shift k-mer sequence (default: 8-bp). Then, a ‘hash table’ is constructed to record k-mer sequences and their corresponding indexes, i.e. relative positions, in the primer sequence. To increase the sensitivity and specificity, pTrimmer employs two approaches, named ‘k-mers model’ and ‘dynamic model’, to detect primer sequences within the reads. The ‘k-mers model’ (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1) takes part of 5′ end of sequence from NGS reads, usually equal to maximum primer length plus 12 bp buffer length, as input and extract all potential 1-base shift k-mer subsequences. Then, all the k-mer subsequences are mapped to the ‘hash table’ (built with amplicon primers) to find all potential candidate primers and the ‘hamming distance’ are calculated between reads and candidate primers to find the best matches. The best match is the primer that has minimum mismatches with the target NGS reads. No scoring scheme was employed, and the search complexity approaches O(1), which leads to extremely fast running time of pTrimmer.<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of pTrimmer. The flowchart shows the details of the program. The program takes a primer sequence file and the two FASTQ files (paired-end sequencing) or one (single-end sequencing) as input. The primer sequence file contains three necessary fields for the forward primer, reverse primer and insert length of amplicon. pTrimmer will first extract all possible 1-base shift kmer sequence of both forward primer and reverse primer to build the ‘hash table’. Kmer sequence will also be extracted from FASTQ read with 1-bp shift each time to search for best candidate primer from ‘hash table’. The 12-bp buffer shift length enable the program has 12 times to find the best primer sequence with ‘k-mers model’. If fails, the program will automatically switch to ‘dynamic model’. The ‘dynamic model’ could extract all possible 1-bp shift kmer sequence and get the best candidate primer that has most kmer hit. Then the program will perform dynamic programing between candidate primer sequence and given read</p></caption><graphic xlink:href="12859_2019_2854_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par12">The ‘k-mers model’ isn’t able to properly handle indels in the primer regions of the reads. This shortcoming can be made up by the Needleman-Wunsch algorithm of ‘dynamic model’. pTrimmer prefers to use the ‘k-mers model’ to detect the primer sequence. If failed, it switches to ‘dynamic model’ automatically. The ‘dynamic model’ (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1) takes all the potential k-mer sequences into consideration and calculates the score of each candidate primer. The candidate primer that has the highest score will perform dynamic programming algorithm with given reads to calculate the ‘edit distance’. The score is the number of k-mer sequence hits per potential primer sequence. And the ‘dynamic programming’ algorithm is performed using the Needleman-Wunsch local algorithm with the parameters of 0 for match, − 1 for mismatch and − 1 for gap extension.</p>
      <p id="Par13">pTrimmer could handle two conditions of primer trimming, referred to as ‘read-through condition’ (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) and ‘normal condition’ (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). In the ‘read-through condition’, the method firstly detects the 5′ end forward primer sequence and then detects the reverse complementary sequence of reverse primer at 3′ end. Instead, the ‘normal condition’ only detects and removes the 5′ end forward primer. The two conditions are distinguished by the insert length of amplicon. A standard Ubuntu16.04 laptop computer, with 4 cores i7-5500U 2.4GHz and 8 GB RAM, can handle 11 million reads within 37 s, during which the peak memory consumption is no more than 100 MB.<fig id="Fig2"><label>Fig. 2</label><caption><p>Two conditions of sequencing read. <bold>a</bold> The ‘read-through condition’ has a forward primer (5′ end) and a reverse complementary primer (3′ end) at the right and left ends of both read1 and read2. This situation is pretty popular in liquid biopsy studies, where the amplicon length is around 140 bp due to the confine of cfDNA fragment length while the read length could be 150 bp. <bold>b</bold> The ‘normal condition’ only has forward primer at the 5′ end of reads, both read1 and read2. This occurs when the amplicon length is larger than read length</p></caption><graphic xlink:href="12859_2019_2854_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec3">
      <title>Results</title>
      <p id="Par14">DNA synthesis could reach the error rate of about 1 in 300–600 bases [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. To evaluate the effects of primer synthesis error on mutation calling in multiplex amplicon sequencing, we calculated the number of mutations in three sample datasets using the raw reads that include primers or the primer-trimmed counterparts. After primer trimmed, the number of 3892, 9221 and 33,760, potential mutations were found in the sample datasets cfDNA1, cfDNA2 and cfDNA3. With primer region inclusion, the number of potential mutations increased to 8060 (107% increase), 17,378 (88%) and 54,550 (62%), respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), indicating primer synthesis error could have large impacts on mutation calling. However, clipping primers would shorten the reads, and thus possibly pose difficulties to identify the correct genomic location during alignment. To clear out this concern, we mapped both the raw reads and primer-trimmed reads to reference genome by BWA software. We found averagely 99.7% of primer-trimmed reads were mapped exactly to the same genomic locations as raw reads in the three target sequencing datasets, cfDNA1 (99.8%), cfDNA2 (99.7%) and cfDNA3 (99.6%), indicating the shortened reads contain sufficient information for correct alignment.</p>
      <p id="Par15">As a benchmark, we compared pTrimmer to other three tools (Alientrimmer Cutadapt and cutPrimers) on a Centos7 server, equipped with 32 cores E5–2630 V3 2.4GHz and 128 GB RAM, with multiplex amplicon datasets of cfDNA1–3. All the processing, including the time consumed on primer trimming and the ratio of trimmed reads, are reported in the Table <xref rid="Tab1" ref-type="table">1</xref>. The commands used in the benchmark are listed in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Command Line. pTrimmer is extremely time-efficient, processing 11 million reads in 35 s, 32 times faster than the second time-efficient program, Alientrimmer (Table <xref rid="Tab1" ref-type="table">1</xref>). This advantage becomes more obvious with the increase of input reads amount. When fed with a fastq of 36 million reads, pTrimmer gets almost 100 times faster than Alientrimmer (Table <xref rid="Tab1" ref-type="table">1</xref>). Moreover, pTrimmer is highly accurate. In most cases, pTrimmer removes and only removes the primer sequences from short reads, leaving the insert sequences for downstream analysis. In the three cfDNA samples, the percentage of ‘precisely trimmed reads’ in total reads averagely reached 92.93% in pTrimmer. This number is 43.83% increased for the secondly ranked program, cutPrimmers.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Benchmarks of four programs with three multiplex amplicon sequencing datasets. ‘Trimmed Reads’ indicates the reads that had any number of bases removed by the program. ‘Precisely Trimmed Reads’ indicates the reads whose primer sequences were precisely trimmed. K: the number of nucleotides for “k-mer” algorithm. Err: the number or percentage of allowed mismatches for primer searching. See Additional file <xref rid="MOESM1" ref-type="media">1</xref> for the detailed parameters to run each of these programs</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Sample (No. of reads)</th><th/><th>Alientrimmer</th><th>Cutadapt</th><th>cutPrimers</th><th/></tr><tr><th>Parameter</th><th>1 thread, K = 9, err = 3</th><th>8 threads, err = 10%</th><th>8 threads, err = 3</th><th>2 threads, k = 9, err = 3</th></tr></thead><tbody><tr><td>CfDNA1 (11,498,560)</td><td>Time of</td><td>1137</td><td>108,918</td><td>2224</td><td>35</td></tr><tr><td>CfDNA2 (16,694,386)</td><td>Running (s)</td><td>2511</td><td>170,920</td><td>3646</td><td>47</td></tr><tr><td>CfDNA3 (36,119,764)</td><td/><td>6099</td><td>349,789</td><td>7772</td><td>62</td></tr><tr><td>CfDNA1 (11,498,560)</td><td>No. of</td><td>2,228,698 (19.28)</td><td>11,392,006 (99.07)</td><td>8,733,142 (75.95)</td><td>10,973,548 (95.43)</td></tr><tr><td>CfDNA2 (16,694,386)</td><td>Trimmed Reads (%)</td><td>3,193,584 (19.13)</td><td>16,633,850 (99.64)</td><td>12,481,890 (74.77)</td><td>16,023,158 (95.98)</td></tr><tr><td>CfDNA3 (36,119,764)</td><td/><td>5,680,392 (15.73)</td><td>35,921,534 (99.45)</td><td>24,460,516 (67.72)</td><td>32,314,848 (89.47)</td></tr><tr><td>CfDNA1 (11,498,560)</td><td>No. of</td><td>81,143 (0.71)</td><td>389,526 (3.39)</td><td>7,752,109 (67.42)</td><td>10,908,534 (94.87)</td></tr><tr><td>CfDNA2 (16,694,386)</td><td>Precisely Trimmed Reads (%)</td><td>134,647 (0.81)</td><td>516,377 (3.09)</td><td>11,130,147 (66.67)</td><td>5,905,037 (95.27)</td></tr><tr><td>CfDNA3 (36,119,764)</td><td/><td>236,252 (0.65)</td><td>1,003,057 (2.78)</td><td>21,581,726 (59.75)</td><td>12,024,840 (88.66)</td></tr></tbody></table></table-wrap></p>
      <p id="Par16">To have a better view of pTrimmer, we simulate 10 MA datasets with a depth of 1000 × − 10,000× to study the time consumption of these tools. The results show that pTrimmer has a notably higher efficiency (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Varying parameters of tolerant mismatch number are applied to a simulation dataset (100×) to explore the performance of pTrimmer. The Table <xref rid="Tab2" ref-type="table">2</xref> shows that pTrimmer is capable of achieving ultra-high sensitivity (99.96%) and accuracy (99.38%) when the number of mismatched base pairs allowed is 2. Although the sensitivity of Alientrimmer and Cutadapt is very high (100%), their extremely low specificity and accuracy indicate that they assume that all NGS reads have primers.<fig id="Fig3"><label>Fig. 3</label><caption><p>Time consumption of Alientrimmer, cutPrimers pTrimmer and BAMClipper with the increasing depth from 1000× to 10,000×. The results of Cutadapt were excluded due to its huge time consumption. And the results of BAMClipper is the running time of processing the bam files. For better displaying, we run Alientrimmer, BAMClipper and pTrimmer with one thread and run cutPrimers with 8 threads</p></caption><graphic xlink:href="12859_2019_2854_Fig3_HTML" id="MO3"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Effects of mismatches on the performance of Alientrimmer, Cutadapt, cutPrimers and pTrimmer. with a simulation datasets (100×). Sensitivity (True Positive Rate, TPR) represent the proportion of reads whose primers were removed, in part or in full, by the programs in the reads that have primers introduced during simulation. Specificity (True Negative Rate, TNR) represent the proportion of reads for whom no primers were identified by the program in the reads that have no primers introduced during simulation. Accuracy (ACC) represent the proportion of reads whose primer sequences were precisely trimmed. Testing was performed with a simulation dataset of 100× depth with 1 ~ 5 mismatches allowed</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Mismatch</th><th>Alientrimmer<break/>1 threads, K = 9</th><th>Cutadapt<break/>8 threads</th><th>cutPrimers<break/>8 threads</th><th>pTrimer<break/>2 threads, k = 9</th></tr><tr><th>TPR (%)/TNR (%)/ACC (%)</th><th>TPR (%)/TNR (%)/ACC (%)</th><th>TPR (%)/TNR (%)/ACC (%)</th><th>TPR (%)/TNR (%)/ACC (%)</th></tr></thead><tbody><tr><td>1</td><td>100.00/0.00/2.48</td><td>100.00/98.42/0.00</td><td>56.56/100.00/56.56</td><td>99.22/100.00/98.87</td></tr><tr><td>2</td><td>100.00/0.00/0.91</td><td>100.00/98.42/0.00</td><td>64.08/100.00/57.77</td><td>99.96/100.00/99.38</td></tr><tr><td>3</td><td>100.00/0.00/0.40</td><td>100.00/45.79/0.00</td><td>67.44/100.00/58.32</td><td>99.94/100.00/99.13</td></tr><tr><td>4</td><td>100.00/0.00/0.00</td><td>100.00/44.74/0.00</td><td>70.85/100.00/58.73</td><td>99.67/100.00/98.60</td></tr><tr><td>5</td><td>100.00/0.00/0.00</td><td>100.00/23.16/0.00</td><td>70.77/100.00/57.46</td><td>98.88/100.00/97.63</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Discussion</title>
    <p id="Par17">pTrimmer is a proper tool to trim off primer sequencing from MAS and target sequencing to ensure the reliable mutation landscape of download analysis. In addition, it also provided some useful function, such as parameter “--minqual” that could filter the reads by sequencing quality and “--seqtype” that enables to process both single-end and paired-end fastq file. A potential extension of pTrimmer is to remove adapter sequence by appropriately modifying the primer file. Except for the programs tested above, we also tested a bam-based primer trimming tools -- BAMClipper. Although the algorithm of BAMClipper is simple, we found its accuracy is comparable to pTrimmer. However, when the sequencing depth increases, its running time will increase rapidly (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In contrast, the running time of pTrimmer keeps almost unchanged even with 10x increases of NGS reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p>
  </sec>
  <sec id="Sec5">
    <title>Conclusions</title>
    <p id="Par18">pTrimmer is a high performance and memory efficient multiplex amplicon sequencing primer trimmer. It is applicable to the study of ‘multiplex amplicon sequencing’ and ‘target sequencing’ that have multiple pairs of primers. The combinatorial algorithm of ‘k-mers model’ and ‘dynamic model’ ensures its high sensitivity and specificity. And the ‘normal condition’ and ‘read-through condition’ could make the pTrimmer have the ability to remove primers of both long and short DNA fragment. The ability to handle ‘read-through’ short reads makes pTrimmer be the ideal tool to process circulating tumor DNA (ctDNA)-based liquid biopsy data since ctDNA has the length of 132–145 bp that leads to read-through on regular Illumina platform [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <sec id="Sec6">
      <title>Availability and requirements</title>
      <p id="Par19">
        <list list-type="bullet">
          <list-item>
            <p id="Par20">Project name: pTrimmer</p>
          </list-item>
          <list-item>
            <p id="Par21">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/DMU-lilab/pTrimmer">https://github.com/DMU-lilab/pTrimmer</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par22">Operating system: Linux and Windows</p>
          </list-item>
          <list-item>
            <p id="Par23">Programming language: C</p>
          </list-item>
          <list-item>
            <p id="Par24">Other requirements: zlib-1.2.7 and gcc</p>
          </list-item>
          <list-item>
            <p id="Par25">License: GNU General Public License v3.0</p>
          </list-item>
          <list-item>
            <p id="Par26">Any restrictions to use by non-academics: GNU GPL License v3.0</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec7">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2854_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Table S1.</bold> The impact of primer regions on mutation calling. (DOCX 20 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2854_MOESM2_ESM.pdf">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Figure S1.</bold> Primer alignment algorithm, including both ‘k-mers model’ and ‘dynamic model’. The ‘k-mers model’ (line 8–17) will first try 12 times to find the target primer. If it fails, pTrimmer will perform a ‘dynamic model’ (line 20–35) to get the primer with the most k-mer hits. (PDF 13 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>cfDNA</term>
        <def>
          <p id="Par4">Circulating cell-free DNA</p>
        </def>
      </def-item>
      <def-item>
        <term>ctDNA</term>
        <def>
          <p id="Par5">Circulating tumor DNA.</p>
        </def>
      </def-item>
      <def-item>
        <term>MAS</term>
        <def>
          <p id="Par6">Multiple amplicon-sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par7">Next generation sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the staff and participants of the pTrimmer study for their important contributions.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par27">This work was supported by National Natural Science Foundation of China (No. 81472637, 81672784, and 81602200). The funding body didn’t play any roles in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par28">Three samples were sequenced in this work, designated as cfDNA1, cfDNA2 and cfDNA3. All the libraries were constructed with 2,158 pairs of multiplex amplicon primers from human DNA and sequenced on Illumina Hiseq X-ten platform at Novogen (Beijing, China) with paired-end reads of 150 bases. The primer sequences used in the study are available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/DMU-lilab/pTrimmer">https://github.com/DMU-lilab/pTrimmer</ext-link>). The datasets generated and analyzed during the current study are available in the NCBI SRA repository (accession no. SRP152580).</p>
      <p id="Par29">Eleven simulation datasets with the average depth of 100×, 1,000×, 2,000×, 3,000×, 4,000×, 5,000×, 6,000×, 7,000×, 8,000×, 9,000×,and 10,000× respectively, were generated using in-house python script “MASimulator.py”. Every read comprised one of the 2,158 pairs of multiplex amplicon primers and its insert, similar to the data in cfDNA1–3. The python script is available at GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/DMU-lilab/pTrimmer">https://github.com/DMU-lilab/pTrimmer</ext-link>. The datasets were generated with the considerations: i. 5% probability to introduce a mismatch or an insertion (1-base) or a deletion (1-base) in the primer region. ii. About 4.22% off-target NGS reads that reside outside of the 2,158 pairs of amplicon regions.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>XLZ, YYS and JCT conceived of and planned this project. XLZ developed code base and tutorial. YYS and YWL performed the benchmarks. PYL prepared the samples and experiment. XLZ, YZ and ZGL wrote the manuscript. JC revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Au</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Wa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Clinical evaluation of panel testing by next-generation sequencing (NGS) for gene mutations in myeloid neoplasms</article-title>
        <source>Diagn Pathol</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.1186/s13000-016-0456-8</pub-id>
        <pub-id pub-id-type="pmid">26796102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Betge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Miersch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Leible</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Erdmann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Galata</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gaiser</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Post</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>MP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Amplicon sequencing of colorectal cancer: variant calling in frozen and formalin-fixed samples</article-title>
        <source>PLoS One</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>5</issue>
        <fpage>e0127146</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0127146</pub-id>
        <pub-id pub-id-type="pmid">26010451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cher</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Sim</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Gill</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lie</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>KF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation sequencing with a myeloid gene panel in core-binding factor AML showed KIT activation loop and TET2 mutations predictive of outcome</article-title>
        <source>Blood Cancer J</source>
        <year>2016</year>
        <volume>6</volume>
        <issue>7</issue>
        <fpage>e442</fpage>
        <pub-id pub-id-type="doi">10.1038/bcj.2016.51</pub-id>
        <pub-id pub-id-type="pmid">27391574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ermolenko</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Boyarskikh</surname>
            <given-names>UA</given-names>
          </name>
          <name>
            <surname>Kechin</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Mazitova</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Khrapov</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Petrova</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Lazarev</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Kushlinskii</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Filipenko</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Massive parallel sequencing for diagnostic genetic testing of BRCA genes--a single center experience</article-title>
        <source>Asian Pac J Cancer Prev</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>17</issue>
        <fpage>7935</fpage>
        <lpage>7941</lpage>
        <pub-id pub-id-type="doi">10.7314/APJCP.2015.16.17.7935</pub-id>
        <pub-id pub-id-type="pmid">26625824</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Au</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Kwong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>ESK</given-names>
          </name>
        </person-group>
        <article-title>BAMClipper: removing primers from alignments to minimize false-negative mutations in amplicon next-generation sequencing</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1567</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-01703-6</pub-id>
        <pub-id pub-id-type="pmid">28484262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samorodnitsky</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jewell</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Hagopian</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Miya</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wing</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Lyon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Damodaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bhatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reeser</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of hybridization capture versus amplicon-based methods for whole-exome sequencing</article-title>
        <source>Hum Mutat</source>
        <year>2015</year>
        <volume>36</volume>
        <issue>9</issue>
        <fpage>903</fpage>
        <lpage>914</lpage>
        <pub-id pub-id-type="doi">10.1002/humu.22825</pub-id>
        <pub-id pub-id-type="pmid">26110913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Martin M. Cutadapt removes adapter sequences from high-throughput sequencing reads. EMBnet Journal. 2011;17(10–12).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Criscuolo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brisse</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>AlienTrimmer: a tool to quickly and accurately trim off multiple short contaminant sequences from high-throughput sequencing reads</article-title>
        <source>Genomics</source>
        <year>2013</year>
        <volume>102</volume>
        <issue>5–6</issue>
        <fpage>500</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2013.07.011</pub-id>
        <pub-id pub-id-type="pmid">23912058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>15</issue>
        <fpage>2114</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kechin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boyarskikh</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Kel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Filipenko</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>cutPrimers: a new tool for accurate cutting of primers from reads of targeted next generation sequencing</article-title>
        <source>J Comput Biol</source>
        <year>2017</year>
        <volume>24</volume>
        <issue>11</issue>
        <fpage>1138</fpage>
        <lpage>1143</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2017.0096</pub-id>
        <pub-id pub-id-type="pmid">28715235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Assembly algorithms for next-generation sequencing data</article-title>
        <source>Genomics</source>
        <year>2010</year>
        <volume>95</volume>
        <issue>6</issue>
        <fpage>315</fpage>
        <lpage>327</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2010.03.001</pub-id>
        <pub-id pub-id-type="pmid">20211242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with burrows-wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carr</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Genome engineering</article-title>
        <source>Nat Biotechnol</source>
        <year>2009</year>
        <volume>27</volume>
        <issue>12</issue>
        <fpage>1151</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1590</pub-id>
        <pub-id pub-id-type="pmid">20010598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mueller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Coleman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wimmer</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Putting synthesis into biology: a viral view of genetic engineering through de novo gene and genome synthesis</article-title>
        <source>Chem Biol</source>
        <year>2009</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>337</fpage>
        <lpage>347</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chembiol.2009.03.002</pub-id>
        <pub-id pub-id-type="pmid">19318214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Underhill</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Hellwig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Welker</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Gligorich</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Rostomily</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Bronner</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fragment length of circulating tumor DNA</article-title>
        <source>PLoS Genet</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>7</issue>
        <fpage>e1006162</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1006162</pub-id>
        <pub-id pub-id-type="pmid">27428049</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
