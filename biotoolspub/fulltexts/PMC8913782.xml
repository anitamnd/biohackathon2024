<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8913782</article-id>
    <article-id pub-id-type="publisher-id">28803</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-022-28803-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7780-482X</contrib-id>
        <name>
          <surname>Ianevski</surname>
          <given-names>Aleksandr</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0941-1458</contrib-id>
        <name>
          <surname>Giri</surname>
          <given-names>Anil K.</given-names>
        </name>
        <address>
          <email>anil.kumar@helsinki.fi</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0886-9769</contrib-id>
        <name>
          <surname>Aittokallio</surname>
          <given-names>Tero</given-names>
        </name>
        <address>
          <email>tero.aittokallio@helsinki.fi</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.452494.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0409 5350</institution-id><institution>Institute for Molecular Medicine Finland (FIMM), HiLIFE, University of Helsinki, </institution></institution-wrap>Helsinki, Finland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.500231.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 0530 9461</institution-id><institution>Helsinki Institute for Information Technology (HIIT), Aalto University, </institution></institution-wrap>Helsinki, Finland </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.55325.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 0389 8485</institution-id><institution>Institute for Cancer Research, Department of Cancer Genetics, Oslo University Hospital, </institution></institution-wrap>Oslo, Norway </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.5510.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8921</institution-id><institution>Centre for Biostatistics and Epidemiology (OCBE), Faculty of Medicine, </institution><institution>University of Oslo, </institution></institution-wrap>Oslo, Norway </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>1246</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>2</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identification of cell populations often relies on manual annotation of cell clusters using established marker genes. However, the selection of marker genes is a time-consuming process that may lead to sub-optimal annotations as the markers must be informative of both the individual cell clusters and various cell types present in the sample. Here, we developed a computational platform, ScType, which enables a fully-automated and ultra-fast cell-type identification based solely on a given scRNA-seq data, along with a comprehensive cell marker database as background information. Using six scRNA-seq datasets from various human and mouse tissues, we show how ScType provides unbiased and accurate cell type annotations by guaranteeing the specificity of positive and negative marker genes across cell clusters and cell types. We also demonstrate how ScType distinguishes between healthy and malignant cell populations, based on single-cell calling of single-nucleotide variants, making it a versatile tool for anticancer applications. The widely applicable method is deployed both as an interactive web-tool (<ext-link ext-link-type="uri" xlink:href="https://sctype.app">https://sctype.app</ext-link>), and as an open-source R-package.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Cell types are typically identified in single cell transcriptomic data by manual annotation of cell clusters using established marker genes. Here the authors present a fully-automated computational platform that can quickly and accurately distinguish between cell types.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational platforms and environments</kwd>
      <kwd>Software</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland (Suomen Akatemia)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>295504, 310507, 326238, 340141 and 344698</award-id>
        <principal-award-recipient>
          <name>
            <surname>Aittokallio</surname>
            <given-names>Tero</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100010661</institution-id>
            <institution>EC | Horizon 2020 Framework Programme (EU Framework Programme for Research and Innovation H2020)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ERA PerMed JAKSTAT-TARGET</award-id>
        <principal-award-recipient>
          <name>
            <surname>Aittokallio</surname>
            <given-names>Tero</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100006383</institution-id>
            <institution>Syöpäjärjestöt (Cancer Society of Finland)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100006306</institution-id>
            <institution>Sigrid Juséliuksen Säätiö (Sigrid Jusélius Foundation)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100008730</institution-id>
            <institution>Kreftforeningen (Norwegian Cancer Society)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Accurate identification of distinct cell types in complex tissue samples is a critical prerequisite for elucidating the roles of cell populations in various biological processes including hematopoiesis, embryonic and intestinal development<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref></sup>. Traditionally, cell sorting and microscopic techniques have been extensively used to isolate cell types, followed by molecular profiling of the sorted cells using, for instance, mRNA or protein measurements<sup><xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup>. Decades of research has led to several collections of cell-specific features, including expression of marker genes in various tissues that are being used to distinguish various cell types in new tissue samples<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. However, the entire process is manually tedious and technically challenging. Recently, single-cell RNA sequencing (scRNA-seq) has been established as a high-throughput approach to routinely chart diverse cell populations in tissue samples and to study various biological processes in disease and development<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup>. The scRNA-seq technology has provided an unprecedented view of various cell types and it has become the leading technology in large-scale cell mapping projects such as the Human Cell Atlas<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p>
    <p id="Par4">Identification of cell populations often relies on unsupervised clustering of cells based on their transcriptomic profiles, followed by cluster annotation using marker genes that are differentially-expressed between the clusters<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. These marker genes are then manually inspected using available information in the literature or cell marker databases<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> to assign cell type labels to each detected cluster. However, the manual selection of cluster-specific marker genes is a time-consuming and error-prone task, since the marker genes are often (i) expressed in multiple cell clusters, and (ii) correspond to multiple cell types. In addition, the expression of negative marker genes, which provide evidence against a cell being of a particular type, should also be incorporated into the cell-type identification process. The cell annotation procedure is further complicated by the lack of curated cell marker databases that include both known and de novo positive and negative markers to annotate cell-types with confidence. For example, selection of <italic>CD44</italic> as marker gene may compromise the accuracy of cell annotation as <italic>CD44</italic> is expressed in various immune cell populations<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Another popular approach for cell-type assignment is to utilize a reference dataset, a collection of previously annotated cell types in single-cell data, to train a classification algorithm and to apply it to new single-cell datasets. However, such supervised approaches require that the reference and new datasets resemble each other, which often pose a problem in scRNA-seq studies<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>.</p>
    <p id="Par5">One important application of single-cell characterization is to design personalized treatments that selectively target malignant cell types in a patient-derived sample, while avoiding severe inhibition and toxic effects on healthy cells<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. In cancers and other complex diseases, monotherapy resistance often emerges and requires multi-drug co-inhibition of various disease- and resistance-driving cell populations. We recently demonstrated how our comprehensive ScType marker database helped an AI-guided identification of personalized drug combination therapies for patients with refractory acute myeloid leukemia (AML), which led to synergistic co-inhibition of leukemic cell subpopulations that emerged in various stages of the disease pathogenesis and treatment regimens<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. These cancer-selective and patient-specific combinations were shown to be relatively less toxic to lymphoid cells (non-malignant cells in the AML case), thereby increasing their likelihood for clinical translation. However, how to accurately distinguish between multiple malignant and non-malignant cell populations for targeted treatments remains a translational challenge and requires both systematic and highly selective strategies that are applicable to various diseases and tissue types. In many biomedical applications, reference single-cell data and cell-type annotations are not available, rather the cell population identification needs to be done individually for each patient sample.</p>
    <p id="Par6">To solve these challenges, we developed a computational ScType platform (marker database and cell-type identification algorithm), which requires only a single scRNA-seq dataset for accurate and unsupervised cell-type annotation (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The unbiased yet selective cell-type annotation is achieved by compiling the largest database of established cell-specific markers (ScType database), and by ensuring the specificity of marker genes across both the cell clusters and cell-types (ScType specificity score, see Fig. <xref rid="Fig1" ref-type="fig">1b, c</xref>). We carried out a systematic benchmarking of ScType and related methods across 6 scRNA-seq datasets from four human and two mouse tissues, and showed that ScType platform correctly annotated a total of 72 out of 73 cell-types (98.6% accuracy), including 8 newly-reannotated cell-types that were incorrectly or non-specifically annotated in the original studies. In addition, ScType implements a single-cell single-nucleotide variant (SNV) calling option to distinguish between malignant and non-malignant cells (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>), exemplified here using scRNA-seq data from AML patient sample. This case study demonstrates how the ScType platform can be used for anticancer applications, such as data-driven identification of leukemic cell populations toward personalized and selective treatment selection. ScType platform is implemented as an open-source and interactive web-tool (<ext-link ext-link-type="uri" xlink:href="https://sctype.app">https://sctype.app</ext-link>), connected to the ScType marker database, to enable ultra-fast and fully-automated cell-type annotation in a wide range of biomedical applications.<fig id="Fig1"><label>Fig. 1</label><caption><title>A schematic view of cell-type annotation using ScType.</title><p><bold>a</bold> ScType requires only the raw or pre-processed single-cell transcriptomics dataset(s) as input. ScType implements options for additional quality control and normalization steps, where needed, followed by unsupervised clustering of cells based on scRNA-seq profiles. The results here are based on the Louvain clustering; however, also SC3, DBSCAN, GiniClust and k-means clustering options are available in ScType (see Methods). In the next step, ScType performs a fully-automated cell-type annotation using an in-built comprehensive marker database. Finally, ScType implements novel options for somatic single-cell SNV calling to distinguish between healthy and malignant cell populations. <bold>b</bold>, <bold>c</bold> ScType specificity score guarantees that the marker genes show specificity both across clusters and cell types for accurate unsupervised cell-type annotation with high cell subpopulation selectivity. <bold>d</bold> UMAP example of automated cell subtype identification by ScType in the liver atlas dataset, where it automatically labelled the same cell-types as assigned manually in the original study<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. <bold>e</bold> Based on the information that plasma cells do not express common B-cell markers, such as <italic>CD19</italic> and <italic>CD20</italic>, but instead express CD138, ScType enhanced the resolution of cell-type annotations of two cell clusters, which were jointly annotated as B-cells in the original study, by segregating them into immature B-cell and plasma (B) cell types (lower UMAP plot of panel (<bold>d</bold>).</p></caption><graphic xlink:href="41467_2022_28803_Fig1_HTML" id="d32e403"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>ScType improves annotation of cell types based solely on a given scRNA-seq data</title>
      <p id="Par7">We first investigated the performance of ScType by re-analyzing a published scRNA-seq study of human liver cells<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Using only the raw scRNA-seq data from the liver atlas dataset, ScType automatically identified 17 clusters and correctly assigned them to 11 identified liver-related cell types that were manually annotated in the original study (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). This demonstrates the benefits of the comprehensive marker databases and the accuracy of the fully-automated annotation process. Additionally, ScType was able to automatically distinguish between two closely-related cell populations of B-cells (immature and plasma B cells) that were not differentiated in the original manuscript<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. This segregation between immature and plasma B cells was done based on the positive and negative information in the ScType database that plasma cells do not express common B-cell markers, such as <italic>CD19</italic> and <italic>CD20</italic>, but instead they express <italic>CD138</italic> (Fig. <xref rid="Fig1" ref-type="fig">1e</xref>)<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
      <p id="Par8">Next, we re-analyzed another published scRNA-seq data of mouse retinal cells (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. ScType automatically identified three closely-related cell populations of amacrine cell types (GABAergic, glycinergic and startbust), which were originally-identified by an extensive and deep analysis of selectively-expressed markers<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Furthermore, ScType correctly distinguished between the two subtypes of bipolar cells–rod (expressing <italic>PRKCA</italic><sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and <italic>CAR8</italic><sup><xref ref-type="bibr" rid="CR22">22</xref></sup>,) and cone (expressing SCGN<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>) bipolar cells, which were manually assigned to a single group in the original study, therefore enhancing the resolution of the cell-type annotation. Taken together, these results indicate that ScType enables a fully-automated prioritization of highly-specific markers for accurate annotation of even rare cell-types with distinct and selective molecular features.</p>
    </sec>
    <sec id="Sec4">
      <title>Systematic benchmarking of ScType in human and mouse scRNA-seq data sets</title>
      <p id="Par9">To investigate the wider applicability of the automated method, we next benchmarked the performance of ScType in terms of its ability to automatically assign cell-types in comparison to the cell-type annotations given by the original authors of additional four published scRNA-seq studies. We further utilized all the six datasets to compare ScType performance against the other recent cell-type annotation methods in terms of their accuracy and running time. The RNA-seq datasets used in the benchmarking originated from various tissues, including human liver<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, pancreas<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, peripheral blood mononuclear cells (PBMCs)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, brain<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, as well as mouse lung<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> and retina samples<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. These scRNA-seq datasets enabled us to investigate the performance of ScType and the related methods in the context of various sequencing platforms, tissues types and organisms.</p>
      <p id="Par10">Among the six scRNA-seq datasets from various human and mouse tissues, ScType correctly annotated a total of 72 cell types out of 73 cell-types (98.6% accuracy), including 8 correctly reannotated cell-types that were originally incorrectly or non-specifically annotated (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). The only cell-type ScType was unable to automatically label as known was fetal cells in the human brain dataset, as there are no fetal cell markers available for human brain in the current version of the ScType database. However, ScType correctly identified all the other cell populations of the human brain tissues (oligodendrocytes, astrocytes, microglial cells, neurons, endothelial and oligodendrocyte precursor cells), according to the annotations made in the original study<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Furthermore, ScType was able to refine the originally-annotated neuron cell population into cholinergic (expressing <italic>SLC17A7</italic>)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and glutamatergic (expressing <italic>ACHE</italic>)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> subtypes.<fig id="Fig2"><label>Fig. 2</label><caption><title>ScType performs ultra-fast and accurate cell-type annotation across various tissues.</title><p><bold>a</bold> The overall performance of ScType across six human and mouse scRNA-seq datasets. ScType automatically assigned cell-types according to the original studies, and it also correctly reannotated five cell types in the human brain, liver and pancreas tissues, compared to the original studies (marked as novel cell types). ScType labelled only single cluster (fetal cells) as unknown cell-type in the human brain dataset (marked as not assigned). Similarly, in the mouse lung and retina datasets, ScType enabled automated identification of all the cell types, and it also correctly reassigned three novel mouse cell types. <bold>b</bold> Comparison of ScType with three recently developed cell-type annotation methods in terms of percentage of correctly annotated cells (upper panel) and running time (lower panel; <italic>note</italic>: the time axis is log-scaled). <bold>c</bold> Detailed cell-type annotations of the human PBMC dataset with the methods under comparison.</p></caption><graphic xlink:href="41467_2022_28803_Fig2_HTML" id="d32e548"/></fig></p>
      <p id="Par11">Next, we compared ScType against the state-of-the-art cell-type annotation methods with reported (i) highest accuracy (scSorter<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> that was recently shown to outperform several popular tools such as Garnett<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and CellAssign<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>), (ii) fastest running time (SCINA<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>), and (iii) full-automated process (scCATCH<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>). For an unbiased comparison, we provided scSorter and SCINA with our in-built database markers, while scCATCH utilized its own integrated marker database. Overall, ScType correctly annotated more than 94% of the cells in each dataset (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, upper panel), outperforming the other algorithms in 5 out 6 datasets. We note that the differences between ScType and the next best performing method scSorter were not large, as both methods showed a high accuracy in all the datasets, but importantly ScType was more than 30 times faster than scSorter (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, bottom panel). In particular, ScType showed almost perfect accuracy in the challenging human PBMC dataset (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), where there exist multiple closely-related subtypes. In contrast, scSorter and scCATCH did not identify natural killer cell populations, and they incorrectly identified several T cell subtypes, while SCINA was not able to distinguish between the two monocyte subpopulations as well as several subsets of T cells (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>).</p>
      <p id="Par12">These benchmarking results indicate that ScType enables ultra-fast and highly accurate separation even between closely related subtypes by utilizing the novel concepts of marker gene specificity across both cell clusters and cell types.</p>
    </sec>
    <sec id="Sec5">
      <title>Evaluation of dropout effects and unknown cell types in simulated scRNA-seq data</title>
      <p id="Par13">The dropout rates can be significant in single-cell data (up to 80%), which may notably impact the clustering solutions and annotation results. To investigate this effect, we utilized the Splatter method<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, and generated 45 simulated datasets with various dropout rates: 15 datasets with ~50% dropouts, 15 datasets with ~65% dropouts, and 15 datasets with ~80% dropouts (see Methods). For each cell type, we generated both highly-specific markers (ten top-ranked marker genes separately for each cell type), and low-specificity markers (ten top-ranked marker genes for a mixture of cell types including the cell type in question), which were used as the input for the ScType and the other methods (note: scCATCH was not used in this comparison since its implementation does not allow for the use of custom markers). The comparison results in the simulated datasets showed that the ScType annotations are relatively robust against high percentages of cells with missing expression, with the annotation accuracy remaining above 90% even at 80% dropout rate, generally outperforming the other methods both in terms of the annotation accuracy and running time (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>).</p>
      <p id="Par14">Due to the limited amount of information currently available on the markers expressed in many of the cell types, accurate identification of “unknown” cell types is an important practical task. To investigate the impact of unknown cell types on the performance of ScType, scSorter and SCINA methods, we utilized the same 45 simulated datasets and used a cross-validation scheme of “leave-one-cell-type-out” to evaluate the accuracy of identifying the unknown cell groups. More specifically, we removed the specific marker signatures of one of the cell types at a time in each of the 45 datasets, and then performed the cell type annotations with all the methods. In ScType, we considered a low ScType score (less than quarter the number of cells in a cluster) or a negative ScType score as low-confidence cell type annotations, which were assigned as “unknown” cell types. We observed that ScType and SCINA were able to correctly assign unknown cell types in most of the simulated datasets, 43 out of 45 datasets (95.5%) and 41 out of 45 datasets (91.1%), respectively, while ScSorter correctly identified unknown cell types only in 22 out of 45 datasets (48.8%).</p>
    </sec>
    <sec id="Sec6">
      <title>ScType utilizes both positive and negative markers for the cell type annotation</title>
      <p id="Par15">As a unique feature, ScType accepts and makes use of not only positive markers, but also negative marker genes, i.e., markers that are not expected to be expressed in a particular cell type, with the aim to differentiate between closely related cell types. In general, we note that the same gene can be a positive marker for one cell type and a negative marker for another cell type. Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref> shows an illustrative example of how ScType calculates the marker specificity and enrichment scores based on both positive and negative marker genes. Compared to the number of positive markers, there is still only a relatively small number of negative markers in the current database, which originated from our literature search<sup><xref ref-type="bibr" rid="CR36">36</xref>–<xref ref-type="bibr" rid="CR40">40</xref></sup>, but the users can apply their custom sets of negative (and positive) markers based on their domain knowledge and emerging studies to improve the annotation process and the coverage of the ScType marker database. This is expected to further increase the accuracy of automatic annotation of new scRNA-seq datasets in the future studies.</p>
      <p id="Par16">As an example, we found the negative markers to be informative when distinguishing between two closely-related groups of T-cells in the human PBMC dataset. It is known that both naïve and memory T cells express <italic>CCR7</italic> and <italic>SELL</italic> genes, which are required for lymph node migration, whereas these genes are not expressed in effector T cells<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>. Therefore, we added <italic>CCR7</italic> and <italic>SELL</italic> genes as negative markers for the effector T cells in the ScType database. When using both positive and negative markers, ScType was able to correctly distinguish naïve and memory T cells (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>, left panel), whereas when using only positive markers, ScType assigned naïve T cells as effector T cells (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>, right panel). In the latter case, an almost equal ScType score was assigned for both T cell types (4 and 7, respectively), even though <italic>SELL</italic> and CCR7 genes were expressed in this cluster (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). The original study also annotated the same cluster as naïve T cells<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, whereas the other methods were not able to correctly annotate the cluster (see Fig. <xref rid="Fig2" ref-type="fig">2c</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><title>ScType utilizes negative markers when distinguishing between groups of T-cells.</title><p><bold>a</bold> Automated cell type annotations with ScType in the human PBMC dataset when utilizing both positive and negative marker genes (left panel), and only positive marker genes (right panel). <bold>b</bold> Expression of <italic>CCR7</italic> and <italic>SELL</italic> genes, which are required for lymph node migration, and are therefore not expected to be expressed in the effector T cells (i.e., negative markers).</p></caption><graphic xlink:href="41467_2022_28803_Fig3_HTML" id="d32e678"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Single-cell SNV calling distinguishes between healthy and malignant cell types</title>
      <p id="Par17">To enable genetic analyses in cancer applications, we further implemented an option for single-nucleotide variation (SNV) calling directly from the scRNA-seq data. As an example, we re-analyzed the scRNA-seq transcriptomic profile and cell-type composition of an AML patient sample from our recent study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> using the ScType platform (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). After performing automated single-cell SNV calling (see Methods), we investigated whether the number of SNVs within a cell-type could distinguish between healthy and cancerous populations present in the patient sample (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). More specifically, ScType quantified the percentage of cells in a cell-type above the median SNV in the cancer consensus genes across all cells within the sample (ScType SNV score). As expected, we observed a higher SNV score in the <italic>CD34</italic>+ progenitor (HSC/MPP) cells and <italic>CD34</italic>+ interferon-stimulated gene (ISG)+ blast cells, as compared to <italic>CD24</italic>+ <italic>CD66</italic>+  neutrophils and memory <italic>CD</italic>+ T cells, which are usually considered as non-malignant cell types in AML<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). As another validation for correctly distinguishing normal cells from malignant cells, we considered aneuploidy (unbalanced number of chromosomes), which is common for most human tumors<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. To identify aneuploidy, we incorporated the recent Bayesian segmentation approach, CopyKAT<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, that classified majority of <italic>CD2</italic>+ <italic>CD66</italic>+ neutrophils and memory <italic>CD8</italic>+ T cells as diploid cells (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>), suggesting their non-malignancy. These two validations demonstrated how ScType correctly assigned <italic>CD2</italic>+ <italic>CD66</italic>+ neutrophils and memory <italic>CD8</italic>+ T cells as non-malignant cells (ScType SNV score &lt;20 and the majority of cell within the cell-type are classified as diploid cells, Fig. <xref rid="Fig4" ref-type="fig">4e</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>ScType enables SNV calling directly from the scRNA-seq profiles.</title><p><bold>a</bold> UMAP plot of the cell types in the AML patient sample automatically annotated with ScType. <bold>b</bold> Distribution of somatic SNVs in the cancer consensus genes across the various cell types of the patient. <bold>c</bold> ScType SNV score summarizes the number of point mutations in the cancer genes for each cell type, shown as the percentage of SNVs above the median SNV value within the particular cell cluster. <bold>d</bold> UMAP showing aneuploid and diploid cell classification based on Bayesian segmentation approach CopyKAT<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. <bold>e</bold> ScType assigns cell types as non-malignant when the ScType SNV score is below 20 and more than 50% of cells within the cell-type are classified as diploid. <bold>f</bold> Chord diagram shows the associations between different cell types in terms of the similarity of their SNVs in the cancer genes (i.e., occurrence of common SNVs, see Methods for details). The width of a connection corresponds to the degree of SNV similarity between cell-types, while the connection color indicates a specific cell-type as shown in the UMAP plot in panel a.</p></caption><graphic xlink:href="41467_2022_28803_Fig4_HTML" id="d32e783"/></fig></p>
      <p id="Par18">To further investigate the ScType cell population classification, we studied the associations between the various cell-types based on the occurrence of common SNVs in the cancer consensus genes, and observed that non-malignant cell-types (i.e. memory <italic>CD8</italic>+ T cells and <italic>CD24</italic> + <italic>CD66</italic> + neutrophils) were closely similar to each other, while showing almost no SNV similarity with the malignant cell types (e.g. <italic>HSC/MPP</italic> and <italic>ISG</italic>+ blast cells, see Fig. <xref rid="Fig4" ref-type="fig">4f</xref>). These results demonstrate how the ScType platform enables one to distinguish between malignant and non-malignant cell populations, based directly on scRNA data from a given patient sample, which is critical for the selection of safe and effective targeted treatment regimens for individual AML patients. For other cancer types and malignancies, the platform similarly supports automated options for the marker selection and cell population classification into healthy and diseased cells. In addition, ScType enables the visualization of the genome-wide copy number profiles from scRNA-seq data using CopyKAT to identify larger-scale copy number alterations (CNAs), such as somatic gains or deletions of large segments of chromosomes (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> as an example in the AML patient sample). In the downstream analyses, the identified CNAs may explain difference in the cellular phenotypes of specific cell types and subclones, including their apoptotic potential or drug sensitivity. This case study shows how the general purpose ScType platform can be used for anticancer applications, where single-cell analyses are increasingly being used both for better understanding of the disease processes and precision treatment selection for individual patients.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par19">We presented ScType, a fully-automated platform for cell-type identification that enables accurate and ultra-fast single-cell-type annotations based solely on the given scRNA-seq data, using our comprehensive ScType marker databases as background information. To the best of our knowledge, ScType is currently the only unsupervised method that makes use of the marker gene specificity across both cell clusters and cell types to automatically identify highly-specific positive marker genes, along with negative marker genes to provide evidence against cells being of a particular cell-type for cell-type selective annotations. To promote its wide application, either as a stand-alone tool or together with other popular single-cell data analysis software (e.g., Seurat<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, MAST<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, PAGODA<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>), we have deployed ScType both as an interactive web-platform (<ext-link ext-link-type="uri" xlink:href="http://sctype.app">http://sctype.app</ext-link>), and as an open-source R implementation (<ext-link ext-link-type="uri" xlink:href="https://github.com/IanevskiAleksandr/sc-type">https://github.com/IanevskiAleksandr/sc-type</ext-link>).</p>
    <p id="Par20">We anticipate the ScType platform will accelerate unbiased phenotypic profiling of cells when applied either to large-scale single-cell sequencing projects or smaller-scale profiling of patient-derived samples. For example, the integrative marker information in the ScType database may enable the identification of rare cell subtypes that have distinct combinations of molecular markers, suggesting specific functions and phenotypic profiles. We recently demonstrated how the ScType database provided information for patient-tailored identification of cancer-selective combinatorial therapies for relapsed AML patients, each with different genetic background and resistance mechanisms<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. The ScType annotation algorithm, together with the novel methods to distinguish between malignant and non-malignant cells, are expected to enable design of targeted treatment regimens also for other cancer types.</p>
    <p id="Par21">The existing computational methods for automatic identification of cell types can be broadly categorized into two groups: (1) supervised methods that require carefully-annotated training datasets labelled with correct cell populations to train the classifiers (e.g. CaSTLe<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> and ACTINN<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> that annotate cell types based on pre-defined reference set of cells without the need of cell marker input), and (2) a prior knowledge-based methods that require either a marker gene set or a pre-trained classifier for the selected cell populations (e.g. scSorter<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, SCINA<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and scCATCH<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>). The supervised methods may have severe limitations when annotating especially rare populations of cells, due to lack of reference data to train the machine learning algorithms. Furthermore, supervised methods are notoriously time-consuming to train, as well as error prone to technical artifacts in the training data, which affect their prediction ability for new scRNA-seq data<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>.</p>
    <p id="Par22">Similarly, the prior knowledge-based cell classification approaches have certain limitations. For instance, their performance heavily depends on the available gene lists provided as markers for each cell type, typically obtained from manual literature search or matching to marker databases that are still suboptimal both in coverage and specificity. Ideally, one would like to use an appropriate number of specific markers to achieve a maximally accurate cell-type classification. However, most existing methods utilize a limited number of markers, thereby potentially masking the identification of a subpopulation of cells that do not express the selected marker genes. Furthermore, the use of inconsistent cell-type markers across experiments and laboratories may compromise the reproducibility of the findings<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. These caveats become even more pronounced when the number of cell types and samples increases, thus preventing fast and reproducible annotations. It has been therefore argued that prior information does improve the automated cell-type identifications<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>.</p>
    <p id="Par23">ScType implements a number of improvements compared to the existing cell-annotation tools. Our unsupervised approach outperformed the prior knowledge-based methods scSorter<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, SCINA<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and scCATCH<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, which were recently shown to enable accurate annotation of multiple cell types<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Another group of supervised methods, such as CaSTLe<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, ACTINN<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, SingleR<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> and CHETAH<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>, utilize reference bulk or single-cell transcriptomic data for cell-type predictions, and therefore require comprehensive, manually-annotated and high-quality reference datasets for training; furthermore, these methods do not allow identification of novel cell-type marker genes. In contrast, ScType requires neither reference scRNA-seq datasets nor manual selection of marker genes; instead, all the background information for established or de novo markers comes from the ScType database that is to date the most comprehensive database of specific markers for human and mouse cells.</p>
    <p id="Par24">In comparison with many other computational approaches that require manual interference<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>, ScType takes a fully data-driven approach, and it annotates the cell-types at once in a totally unsupervised manner. The only input needed for the ScType tool is the raw sequencing data file, although uploading of pre-processed scRNA-seq data is also an option. This saves considerable time and costs in the scRNA-seq analysis, especially when searching for cell-types in a tissue that involves a large variety of cell-types with similar transcriptomic profiles (e.g. bone marrow samples from mixed lineage leukemia subjects). The running time of ScType is also orders of magnitude faster than the supervised methods. Furthermore, ScType implements options for SNV and CNV calling from the raw scRNA-seq profiles of individual samples. The users may compare SNV levels across different cell types, and study associations between cell clusters based on their SNV load.</p>
    <p id="Par25">Using six scRNA-seq datasets from the human and mouse tissues, we demonstrated that ScType provides scalable and accurate identification of cell-clusters, and it is compatible with data formats from various sequencing techniques (e.g. Drop-seq and Smart-seq). These benchmarking results against the existing cell annotation approaches indicated that ScType is widely-applicable to various biomedical problems, and it provides fast and accurate cell-type classifications. Furthermore, we expect that the comprehensive ScType database will lead to the development of new and improved cell-type detection methods, as well as accelerate the implementation of single-cell pipelines for translational applications, such as monitoring of therapy resistant cancer cell sub-populations and designing of targeted combinatorial therapies to overcome the monotherapy resistance in cancer patients, which require fast and automated analyses for real-time clinical implementation.</p>
    <p id="Par26">Due to both biological and technical reasons, certain genes may not be detected in a specific cell type<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>, which can be considered as a negative marker in ScType for the cell type. In the future extensions of ScType, we plan to incorporate correction methods for drop-out events in scRNA-seq data, such as scDoc<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>, which should help to identify true and robust negative markers. Even if the number of negative markers is still relatively low, compared to the number of positive markers, we expect the annotation results of ScType will further improve once more negative markers are identified in future studies and incorporated into the ScType database. In addition, ScType utilizes z-score transformation for computationally-efficient combination of multiple markers, which may be suboptimal when dealing with single-cell transcriptomic data. However, our results in the simulated datasets showed a drastic decrease in the annotation accuracy when removing the z-score transformation (<italic>P</italic> &lt; 0.001, Wilcoxon test; Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>).</p>
    <p id="Par27">In conclusion, ScType provides fully-automated cell-type identification using its own in-built marker database, as well as identification of malignant cell populations and cancer targets based on SNV calling and aneuploidy identification, requiring only raw scRNA-seq data as an input. As increased number of scRNA-seq datasets from various tissue types become available from the Human Cell Atlas and other projects, the accuracy and coverage of the ScType platform is expected to increase accordingly.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>ScType database construction</title>
      <p id="Par28">ScType database is the largest database to date of human and mouse cell-specific markers, compiled by integrating the information available in the CellMarker database (<ext-link ext-link-type="uri" xlink:href="http://biocc.hrbmu.edu.cn/CellMarker/">http://biocc.hrbmu.edu.cn/CellMarker/</ext-link>) and PanglaoDB (<ext-link ext-link-type="uri" xlink:href="https://panglaodb.se">https://panglaodb.se</ext-link>), which are currently the two largest available databases for cell-type markers. In the CellMarker database, 13,605 cell markers for 467 cell types in 158 human tissues/sub-tissues and 9,148 cell makers for 389 cell types in 81 mouse tissues/sub-tissues were manually collected and curated from more than 100,000 published papers<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. In the PanglaoDB, 6,631 gene markers mapping to 155 cell types have been identified by differential expression analysis in the particular cell types using single-cell data and a community-based crowdsourcing approach for curation of gene expression markers<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. However, these two databases differ in the number of tissues, cell types and marker numbers, as well as in the way the markers have been assigned to each cell type. Therefore, we firstly converted the non-uniform gene IDs to approved gene symbols within and between the databases. Next, we removed the low evidence marker genes from the CellMarker database (i.e., genes having only one reference to support the cell-type marker), and genes that appeared in less than five clusters of specific cell-type from PanglaoDB. Additionally, we excluded genes showing no expression across all the datasets in PanglaoDB. Ultimately, we unified the cell and tissue naming from the two databases and excluded tissues comprising less than 5 cell types. Fifteen novel cell types with corresponding marker genes were added by manual curation of &gt;10 papers to the current version of the compiled ScType database (<ext-link ext-link-type="uri" xlink:href="https://sctype.app/database.php">https://sctype.app/database.php</ext-link>), as relatively few brain and eye tissue cell types were provided in the first version of the database. Furthermore, we extracted 37 negative markers for the cell types studied in this work based on literature search<sup><xref ref-type="bibr" rid="CR36">36</xref>–<xref ref-type="bibr" rid="CR40">40</xref></sup>. The users can also apply their custom sets of both positive and negative markers, based on their domain knowledge and emerging studies, both in R code and web-app, and the community can suggest new marker genes for the cell type annotation to be included into future versions of ScType database either using GitHub’s “Pull Request” feature or by sending an email to the authors. In total, the current version of the ScType database comprises 3,980 cell markers for 194 cell types in 17 human tissues and 4,212 cell markers for 194 cell types in 17 mouse tissues.</p>
    </sec>
    <sec id="Sec11">
      <title>Cell-type specificity of markers</title>
      <p id="Par29">Cell-type specificity score provides a quantitative measure of how uniquely a particular marker <italic>i</italic> identifies a specific cell-type of the given tissue (<italic>t</italic>), with higher scores corresponding to highly-specific markers and lower scores to the promiscuous markers. The cell-type specificity score (<italic>S</italic>) was calculated separately for each marker gene <italic>M</italic><sub><italic>i</italic></sub> within a tissue <italic>t</italic> by firstly pooling all the cell-type specific markers within the tissue into marker pool <italic>M</italic>, and then calculating the cell-type specificity score for each marker as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{i}^{t}=1-\frac{{\left|{M}_{i}\right|}_{t}-{min }({\left|M\right|}_{t})}{{max }\left({\left|M\right|}_{t}\right)-{min }({\left|M\right|}_{t})}$$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq1.gif"/></alternatives></inline-formula>. Here, |M<sub>i</sub> | <sub>t</sub> denotes the number of cell types of tissue <italic>t</italic> where the <italic>i</italic>th marker is enlisted, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\min }\left({\left|M\right|}_{t}\right)$$\end{document}</tex-math><mml:math id="M4"><mml:mi>min</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\max }\left({\left|M\right|}_{t}\right)$$\end{document}</tex-math><mml:math id="M6"><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq3.gif"/></alternatives></inline-formula> are the minimum and maximum number of cell types for which any of the provided genes is enlisted as a marker in the ScType database. A toy example of the calculation of the cell-type specificity score is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>ScType workflow options</title>
      <p id="Par30">ScType provides a complete pipeline for single-cell RNA-seq data analysis and cell-type annotation. We utilized Seurat v4.0<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> for data processing and normalization. For clustering analysis, the default option is Louvain clustering based on a shared nearest neighbor graph (using FindClusters function with the resolution parameter set to 0.8 and 20 principal components given as input), which was used to generate the current results; however, also SC3<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>, DBSCAN<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>, GiniClust<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> and k-means clustering options are available in ScType. The clusters are visualized using either principal components analysis (PCA), t-distributed Stochastic Neighbor Embedding (t-SNE), Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP), Isomap<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>, Diffusion Map<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>, largeVis<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> or by means of expression heatmaps. For the integrated multi-scRNA-seq dataset analysis, ScType uses FindIntegrationAnchors and IntegrateData functions from Seurat v4.0 that were shown to enable an effective identification of anchor correspondences across multiple single-cell datasets<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. As a key unique component, ScType implements an ultra-fast and fully-automated cell-type identification, using highly-specific marker genes (see above), and allows the user to explore each gene’s contribution to cell type annotations (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). Finally, Sctype implements options for SNV calling and aneuploidy identification, and it automatically suggests separation between non-malignant and malignant cell types (see below).</p>
    </sec>
    <sec id="Sec13">
      <title>ScType cell-type annotation</title>
      <p id="Par31">In order to assign each cell-type to a cluster (<italic>p</italic>), given the input scRNA-seq data (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X$$\end{document}</tex-math><mml:math id="M8"><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq4.gif"/></alternatives></inline-formula>) with <italic>m</italic> genes and <italic>n</italic> cells, ScType first standardizes each gene expression profile into z-score across all cells. Only positive and negative markers genes corresponding to different cell types of the specified tissues are considered (extracted either from ScType database or using user-provided custom cell-type gene sets as an alternative option). Then, each gene expression level is multiplied with its cell type-specificity <italic>(</italic><inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{i}^{t}$$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq5.gif"/></alternatives></inline-formula><italic>)</italic> score: <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{\prime} =({(Z({X}^{T}))}^{T}\subseteq {{{{{{\rm{M}}}}}}}_{t})\cdot {S}_{i}^{t}$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>⊆</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq6.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}^{{\prime} }$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq7.gif"/></alternatives></inline-formula> is a transformed scRNA-seq expression matrix of <italic>n</italic> cells and |M<sub><italic>t</italic></sub>| genes, M<sub><italic>t</italic></sub> is the vector of marker genes of all cell types within the tissue <italic>t</italic>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z$$\end{document}</tex-math><mml:math id="M16"><mml:mi>Z</mml:mi></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq8.gif"/></alternatives></inline-formula> denotes the z-score-transformation. The transformed expression values for each cell-type <italic>(c)</italic> are further summarized into cell type-specific marker-enrichment-score as the normalized sum of all the individual genes supporting a cell-type: <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{x}}}}}}}_{c}^{{\prime} }=\,\frac{\mathop{\sum }\nolimits_{i=1}^{j}{x}_{i}^{{\prime} }}{\sqrt{j}}-\frac{\mathop{\sum }\nolimits_{k=1}^{l}{x}_{k}^{{\prime} }}{\sqrt{l}}\,$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq9.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{x}}}}}}^{\prime}$$\end{document}</tex-math><mml:math id="M20"><mml:msup><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq10.gif"/></alternatives></inline-formula> is the unique column of <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}^{{\prime} }$$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq11.gif"/></alternatives></inline-formula> corresponding to one cell, <italic>c</italic> is the specific cell-type within the tissue, and <italic>i, …, j</italic> are the indices corresponding to cell-type-specific marker genes, while <italic>k, …, l</italic> are the indices of negative marker genes that are not expected to be expressed in the cell type. Such transformation results in normalized expression matrix of c-by-n dimension, where each row represents one of the cell types and each column represents an individual cell. Finally, by summing up the values of each row (cell type) across the cells corresponding to a specific cluster <italic>p</italic>, the cluster summary enrichment-score (called ScType score, Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>) for each cell-type is calculated: <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{ScType\; score}}_{c}=\mathop{\sum}\nolimits_{z\in p}{x}_{c}^{z}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>T</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.16em"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq12.gif"/></alternatives></inline-formula>. A cell-type with the highest ScType score is used for assignment to the cluster <italic>p</italic>. Such formulation guarantees marker gene specificity across both the cell-types <italic>(</italic><inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{i}^{t}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq13.gif"/></alternatives></inline-formula><italic>)</italic> and cell clusters <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\sum }_{z\in p}{x}_{c}^{z})$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2022_28803_Article_IEq14.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1b, c</xref>), thus allowing for a highly accurate cell-type annotation. We consider a low ScType score (less than quarter the number of cells in a cluster), or a negative ScType score to indicate a low-confidence cell-type annotation, which are assigned as “unknown” cell type in the web-tool. In addition to the cell-type assignments, the ScType web-portal (<ext-link ext-link-type="uri" xlink:href="http://sctype.app">http://sctype.app</ext-link>) allows users to view the metadata based on which the assignment was made, view the markers that are enriched in each specific cluster, and plot the cumulative gene-specificity for different cell types as bar graphs.</p>
    </sec>
    <sec id="Sec14">
      <title>Systematic comparison in publicly available datasets</title>
      <p id="Par32">In order to benchmark the ScType against the other cell-type annotation methods, we utilized six scRNA-seq datasets from public domain and re-analysed these using ScType platform. Five datasets were downloaded from Gene Express Omnibus (GEO): Human Liver (GSE124395), Human Brain (GSE67835), Human Pancreas (GSE85241), Mouse Lung (GSE63269) and Mouse Retina (GSE63473). Human PBMC dataset was downloaded from the 10x Genomics Dataset Repository (<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/10x.files/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz">https://s3-us-west-2.amazonaws.com/10x.files/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz</ext-link>).</p>
      <p id="Par33">The human brain dataset was used to define the markers in the ScType marker gene database based on the publication list in the PangloDB paper<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> and website (<ext-link ext-link-type="uri" xlink:href="https://panglaodb.se/papers.html">https://panglaodb.se/papers.html</ext-link>). To make the comparison unbiased, we excluded the markers identified from the human brain data while annotating the cell cluster in the comparative study. The other marker source, CellMarker database, is based on manual curation of more than 100 000 publications<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, but it did not list the studies used for defining its marker genes. Hence, we could not confirm whether the CellMarker database have incorporated markers from the experimental dataset used in the comparative study.</p>
    </sec>
    <sec id="Sec15">
      <title>Comparison with other cell-type annotation tools</title>
      <p id="Par34">We compared the accuracy, running time and requirement of hardware resources of ScType against scSorter<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, SCINA<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and scCATCH<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> using the six scRNA-seq datasets (see Publicly available datasets). We used the default parameters to run all the methods. To provide unbiased comparisons, we used the same cell-type marker gene information (based on our ScType database) in scSorter and SCINA. scCATCH has its own in-built database that was used in the analysis.</p>
      <p id="Par35">We utilized the Splatter method<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> to generate 45 simulated datasets with various dropout rates: 15 datasets with ~50% dropouts, 15 datasets with ~65% dropouts, and 15 datasets with ~80% dropouts (dropout.shape -0.5 and dropout.mid −2.5, 0, 2.5, respectively). Each simulated dataset contained 10 cell types with varying cell proportions using scaled lognormal random deviates (e.g., 42.3%, 22.7%, 12.6%, 4.5%, 4.5%, 4.1%, 4.0%, 2.9%, 1.8%, 0.3%). Each dataset has “Moderate” similarity among the cell types (i.e., de.facScale parameter was randomly set to either 0.5, 0.6 or 0.7). Using the simulated datasets, we also compared the performance and running time of ScType, scSorter, and SCINA methods. We note that the scCATCH method was not used in these comparisons since its implementation does not allow for the use custom markers.</p>
      <p id="Par36">We extracted marker genes from the simulated reference data by performing differential expression analysis using the Wilcoxon rank sum test, similarly to the recent comparative evaluation work<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>. For each cell type, we generated both highly-specific markers (ten top-ranked marker genes separately for each cell type), identified through differential expression, and low-specificity markers (ten top-ranked marker genes for a mixture of all simulated cell types including the cell type in question), which were used as the input for the ScType and other methods. To generate low-specificity markers for <italic>n</italic><sup>th</sup> cell type, we took all the pairs of two cell types including <italic>n</italic>th cell type (e.g. <italic>n</italic>th and <italic>n</italic> + 1, or <italic>n</italic>th and <italic>n</italic> + 2 cell types), and identified differentially expressed genes between each group of two cell types vs other cells; finally, we combined all “unspecific” genes together and randomly selected 10 of them.</p>
    </sec>
    <sec id="Sec16">
      <title>SNV identification using single-cell RNA sequencing</title>
      <p id="Par37">ScType utilizes raw scRNA-seq data to identify single-nucleotide variants (SNVs) present in each cell. ScType processes the raw input scRNA-seq BAM file using samtools<sup><xref ref-type="bibr" rid="CR59">59</xref></sup> and call the SNVs using Strelka2<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>. Next, ScType connects the SNV to each cluster using vartrix (<ext-link ext-link-type="uri" xlink:href="https://github.com/10XGenomics/vartrix">https://github.com/10XGenomics/vartrix</ext-link>). As an extended feature, ScType also calculates the sum of total number of SNV present in the COSMIC cancer census genes<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> as the combined SNV score (ScType SNV score) for each cluster in a cancerous tissue profile. More specifically, ScType SNV score summarizes the number of point mutations in the cancer genes for each cell type, calculated as the percentage of SNVs above the median SNV value within the particular cell cluster.</p>
      <p id="Par38">ScType also incorporates the recently implemented Bayesian segmentation approach, called CopyKAT<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, to distinguish between aneuploid and diploid cells. Based on these two analyses, ScType automatically makes a classification between malignant and non-malignant cells. ScType assigns cells as non-malignant if ScType SNV score &lt;20 and the majority of cell within the cell-type (&gt;50%) are classified as diploid and the others as malignant. Users can use these two analyses to assign healthy and cancerous cell-type labels to the cell clusters, based on the assumption that cancerous cell clusters tend to have more SNVs in the cancer genes and aneuploidy is common for most human tumors<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. The list of cancer consensus genes was downloaded from the catalogue of somatic mutation in cancer database (COSMIC v92)<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>.</p>
    </sec>
    <sec id="Sec17">
      <title>Reporting summary</title>
      <p id="Par39">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2022_28803_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2022_28803_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2022_28803_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec19">
        <title>Source data</title>
        <p id="Par43">
          <media position="anchor" xlink:href="41467_2022_28803_MOESM4_ESM.xlsx" id="MOESM4">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-022-28803-w.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Dr. Pirkko M Mattila, Dr. Jenni Lahtela and Bhiswa Ghimire for their valuable suggestions on how to improve the web-tool, Olle Hansson for the FIMM cluster server machine to host the web-tool and the database, and all the beta-testers for confirming the smooth operation and reproducibility of the analyses. This work was supported by the Academy of Finland (grants 295504, 310507, 326238, 340141 and 344698 to TA), European Union’s Horizon 2020 Research and Innovation Programme (ERA PerMed JAKSTAT-TARGET), the Cancer Society of Finland (TA), the Sigrid Jusélius Foundation (TA), and the Norwegian Cancer Society (grant 216104 to TA).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.I., A.K.G. and T.A. conceived and planned the study. A.I. developed the method, implemented the ScType web-tool and collected and analyzed the data. A.I. compiled the ScType database with the help of A.K.G. A.I. prepared the figures for manuscript with the help of T.A. and A.K.G. T.A. and A.K.G. supervised the study. All the authors wrote the manuscript and approved its final version.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par40"><italic>Nature Communications</italic> thanks Sangsoo Kim and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Publicly available scRNA-seq datasets for methods benchmarking: Human Liver (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE124395">GSE124395</ext-link>) Human Brain (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE67835">GSE67835</ext-link>), Human Pancreas (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE85241">GSE85241</ext-link>), Mouse Lung (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE63269">GSE63269</ext-link>), and Mouse Retina (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE63473">GSE63473</ext-link>); Human PBMC dataset was downloaded from the 10x Genomics Dataset Repository [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/10x.files/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz">https://s3-us-west-2.amazonaws.com/10x.files/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz</ext-link>].</p>
    <p>Previously published scRNA-seq data from an AML patient sample<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>: EGAS00001004614. <xref rid="Sec19" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>R source-code of the ScType algorithm is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/IanevskiAleksandr/sc-type/">https://github.com/IanevskiAleksandr/sc-type/</ext-link> to allow reproduction of the results and its further comparison against or integration with other algorithms<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>. ScType is also freely available as an interactive web-tool at <ext-link ext-link-type="uri" xlink:href="http://sctype.app">http://sctype.app</ext-link>. The ScType database is freely available at <ext-link ext-link-type="uri" xlink:href="https://sctype.app/database.php">https://sctype.app/database.php</ext-link>. Quick start instructions and a step-by-step analysis example is provided at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/IanevskiAleksandr/sc-type/">https://github.com/IanevskiAleksandr/sc-type/</ext-link>), and a step-by-step tour that guides the new users through the web-application, as well as documentation of the analysis steps is provided on the landing-page of the app (<ext-link ext-link-type="uri" xlink:href="http://sctype.app">http://sctype.app</ext-link>).</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par41">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pellin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comprehensive single cell transcriptional landscape of human hematopoietic progenitors</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2395</fpage>
        <?supplied-pmid 31160568?>
        <pub-id pub-id-type="pmid">31160568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome analysis maps the developmental track of the human heart</article-title>
        <source>Cell Rep.</source>
        <year>2019</year>
        <volume>26</volume>
        <fpage>1934</fpage>
        <lpage>1950</lpage>
        <?supplied-pmid 30759401?>
        <pub-id pub-id-type="pmid">30759401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fawkner-Corbett</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatiotemporal analysis of human intestinal development at single-cell resolution</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>810</fpage>
        <lpage>826</lpage>
        <?supplied-pmid 33406409?>
        <pub-id pub-id-type="pmid">33406409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modelling human blastocysts by reprogramming fibroblasts into iBlastoids</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>591</volume>
        <fpage>627</fpage>
        <lpage>632</lpage>
        <?supplied-pmid 33731926?>
        <pub-id pub-id-type="pmid">33731926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maestre-Batlle</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Novel flow cytometry approach to identify bronchial epithelial cells from healthy human airways</article-title>
        <source>Sci. Rep.</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>42214</fpage>
        <?supplied-pmid 28165060?>
        <pub-id pub-id-type="pmid">28165060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lubeck</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Single-cell systems biology by super-resolution imaging and combinatorial labeling</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>743</fpage>
        <lpage>748</lpage>
        <?supplied-pmid 22660740?>
        <pub-id pub-id-type="pmid">22660740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rust</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Sub-diffraction-limit imaging by stochastic optical reconstruction microscopy (STORM)</article-title>
        <source>Nat. Methods</source>
        <year>2006</year>
        <volume>3</volume>
        <fpage>793</fpage>
        <lpage>796</lpage>
        <?supplied-pmid 16896339?>
        <pub-id pub-id-type="pmid">16896339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <?supplied-pmid 30289549?>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Franzen O., Gan L. M., Bjorkegren J. L. M. PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data. <italic>Database (Oxford)</italic><bold>2019</bold>, baz046 (2019).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aizarani</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human liver cell atlas reveals heterogeneity and epithelial progenitors</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>572</volume>
        <fpage>199</fpage>
        <lpage>204</lpage>
        <?supplied-pmid 31292543?>
        <pub-id pub-id-type="pmid">31292543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Galen</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals AML hierarchies relevant to disease progression and immunity</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <fpage>1265</fpage>
        <lpage>1281</lpage>
        <?supplied-pmid 30827681?>
        <pub-id pub-id-type="pmid">30827681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Melms J. C. et al. A molecular single-cell lung atlas of lethal COVID-19. <italic>Nature</italic><bold>595</bold>, 114–119 (2021).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Building a high-quality Human Cell Atlas</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>149</fpage>
        <lpage>153</lpage>
        <?supplied-pmid 33500565?>
        <pub-id pub-id-type="pmid">33500565</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <?supplied-pmid 30617341?>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luecken</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e8746</fpage>
        <?supplied-pmid 31217225?>
        <pub-id pub-id-type="pmid">31217225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <?supplied-pmid 6152897?>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconvolution of cell type-specific drug responses in human tumor tissue with single-cell RNA-seq</article-title>
        <source>Genome Med.</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>82</fpage>
        <?supplied-pmid 33975634?>
        <pub-id pub-id-type="pmid">33975634</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ianevski</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patient-tailored design for selective co-inhibition of leukemic cell subpopulations</article-title>
        <source>Sci. Adv.</source>
        <year>2021</year>
        <volume>7</volume>
        <fpage>eabe4038</fpage>
        <?supplied-pmid 33608276?>
        <pub-id pub-id-type="pmid">33608276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tellier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nutt</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Standing out from the crowd: how to identify plasma cells</article-title>
        <source>Eur. J. Immunol.</source>
        <year>2017</year>
        <volume>47</volume>
        <fpage>1276</fpage>
        <lpage>1279</lpage>
        <?supplied-pmid 28787106?>
        <pub-id pub-id-type="pmid">28787106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Matsuda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cepko</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <article-title>A core paired-type and POU homeodomain-containing transcription factor program drives retinal bipolar cell gene expression</article-title>
        <source>J. Neurosci.</source>
        <year>2008</year>
        <volume>28</volume>
        <fpage>7748</fpage>
        <lpage>7764</lpage>
        <?supplied-pmid 18667607?>
        <pub-id pub-id-type="pmid">18667607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recruitment of rod photoreceptors from short-wavelength-sensitive cones during the evolution of nocturnal vision in mammals</article-title>
        <source>Dev. Cell</source>
        <year>2016</year>
        <volume>37</volume>
        <fpage>520</fpage>
        <lpage>532</lpage>
        <?supplied-pmid 27326930?>
        <pub-id pub-id-type="pmid">27326930</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cherry</surname>
            <given-names>TJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development and diversification of retinal amacrine interneurons at single cell resolution</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>9495</fpage>
        <lpage>500</lpage>
        <?supplied-pmid 19470466?>
        <pub-id pub-id-type="pmid">19470466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385</fpage>
        <lpage>394</lpage>
        <?supplied-pmid 27693023?>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14049</fpage>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>7285</fpage>
        <lpage>7290</lpage>
        <?supplied-pmid 26060301?>
        <pub-id pub-id-type="pmid">26060301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angelidis</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An atlas of the aging lung mapped by single cell transcriptomics and deep tissue proteomics</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>963</fpage>
        <?supplied-pmid 30814501?>
        <pub-id pub-id-type="pmid">30814501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herzog</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expression of vesicular glutamate transporters, VGLUT1 and VGLUT2, in cholinergic spinal motoneurons</article-title>
        <source>Eur. J. Neurosci.</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1752</fpage>
        <lpage>1760</lpage>
        <?supplied-pmid 15379996?>
        <pub-id pub-id-type="pmid">15379996</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Excessive expression of acetylcholinesterase impairs glutamatergic synaptogenesis in hippocampal neurons</article-title>
        <source>J. Neurosci.</source>
        <year>2004</year>
        <volume>24</volume>
        <fpage>8950</fpage>
        <lpage>8960</lpage>
        <?supplied-pmid 15483114?>
        <pub-id pub-id-type="pmid">15483114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>scSorter: assigning cells to known cell types according to marker genes</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>69</fpage>
        <?supplied-pmid 33618746?>
        <pub-id pub-id-type="pmid">33618746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>983</fpage>
        <lpage>986</lpage>
        <?supplied-pmid 31501545?>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>AW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1007</fpage>
        <lpage>1015</lpage>
        <?supplied-pmid 31501550?>
        <pub-id pub-id-type="pmid">31501550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
          </name>
          <etal/>
        </person-group>
        <article-title>SCINA: semi-supervised analysis of single cells in silico</article-title>
        <source>Genes</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>531</fpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scCATCH: automatic annotation on cell types of clusters from single-cell RNA sequencing data</article-title>
        <source>iScience</source>
        <year>2020</year>
        <volume>23</volume>
        <fpage>100882</fpage>
        <?supplied-pmid 32062421?>
        <pub-id pub-id-type="pmid">32062421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">28077169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nolz</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Starbeck-Miller</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Harty</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Naive, effector and memory CD8 T-cell trafficking: parallels and distinctions</article-title>
        <source>Immunotherapy</source>
        <year>2011</year>
        <volume>3</volume>
        <fpage>1223</fpage>
        <lpage>1233</lpage>
        <?supplied-pmid 21995573?>
        <pub-id pub-id-type="pmid">21995573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mahnke</surname>
            <given-names>YD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The who’s who of T‐cell differentiation: human memory T‐cell subsets</article-title>
        <source>Eur. J. Immunol.</source>
        <year>2013</year>
        <volume>43</volume>
        <fpage>2797</fpage>
        <lpage>2809</lpage>
        <?supplied-pmid 24258910?>
        <pub-id pub-id-type="pmid">24258910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krijgsman</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of circulating T-, NK-, and NKT cell subsets in patients with colorectal cancer: the peripheral blood immune cell profile</article-title>
        <source>Cancer Immunol., Immunother.</source>
        <year>2019</year>
        <volume>68</volume>
        <fpage>1011</fpage>
        <lpage>1024</lpage>
        <pub-id pub-id-type="pmid">31053876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapellos</surname>
            <given-names>TS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human monocyte subsets and phenotypes in major chronic inflammatory diseases</article-title>
        <source>Front. Immunol.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2035</fpage>
        <?supplied-pmid 31543877?>
        <pub-id pub-id-type="pmid">31543877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pavlasova</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mraz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The regulation and function of CD20: an “enigma” of B-cell biology and targeted therapy</article-title>
        <source>Haematologica</source>
        <year>2020</year>
        <volume>105</volume>
        <fpage>1494</fpage>
        <?supplied-pmid 32482755?>
        <pub-id pub-id-type="pmid">32482755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Delineating copy number and clonal substructure in human tumors from single-cell transcriptomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>599</fpage>
        <lpage>608</lpage>
        <?supplied-pmid 33462507?>
        <pub-id pub-id-type="pmid">33462507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive Integration of Single-</article-title>
        <source>Cell Data. Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902</lpage>
        <?supplied-pmid 31178118?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>278</fpage>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>241</fpage>
        <lpage>244</lpage>
        <?supplied-pmid 26780092?>
        <pub-id pub-id-type="pmid">26780092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rokach</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shay</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>CaSTLe</surname>
            <given-names>-</given-names>
          </name>
        </person-group>
        <article-title>Classification of single cells by transfer learning: Harnessing the power of publicly available single cell RNA sequencing experiments to annotate new experiments</article-title>
        <source>PLoS One</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>e0205499</fpage>
        <?supplied-pmid 30304022?>
        <pub-id pub-id-type="pmid">30304022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ACTINN: Automated Identification of Cell Types in Single Cell RNA Sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>36</volume>
        <fpage>533</fpage>
        <lpage>538</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>194</fpage>
        <?supplied-pmid 31500660?>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aran</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>
        <source>Nat. Immunol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>163</fpage>
        <lpage>172</lpage>
        <?supplied-pmid 30643263?>
        <pub-id pub-id-type="pmid">30643263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Kanter</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lijnzaad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Candelli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Margaritis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>FCP</given-names>
          </name>
        </person-group>
        <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>e95</fpage>
        <?supplied-pmid 31226206?>
        <pub-id pub-id-type="pmid">31226206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skinnider</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell type prioritization in single-cell data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>30</fpage>
        <lpage>34</lpage>
        <?supplied-pmid 32690972?>
        <pub-id pub-id-type="pmid">32690972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ran</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scDoc: correcting drop-out events in single-cell RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>4233</fpage>
        <lpage>4239</lpage>
        <?supplied-pmid 32365169?>
        <pub-id pub-id-type="pmid">32365169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ester</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kriegel</surname>
            <given-names>H-P</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title>
        <source>Kdd</source>
        <year>1996</year>
        <volume>96</volume>
        <fpage>226</fpage>
        <lpage>231</lpage>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Jiang, L., Chen, H., Pinello, L. &amp; Yuan, G.-C. GiniClust: detecting rare cell types from single-cell gene expression data with Gini index. <italic>Genome Biol</italic><bold>17</bold>, 144 (2016).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tenenbaum</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>290</volume>
        <fpage>2319</fpage>
        <lpage>2323</lpage>
        <?supplied-pmid 11125149?>
        <pub-id pub-id-type="pmid">11125149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coifman</surname>
            <given-names>RR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Geometric diffusions as a tool for harmonic analysis and structure definition of data: diffusion maps</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>7426</fpage>
        <lpage>7431</lpage>
        <?supplied-pmid 15899970?>
        <pub-id pub-id-type="pmid">15899970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Tang, J. et al. Visualizing Large-scale and High-dimensional Data. <italic>Proc. 25th Int. Conf. World Wide Web</italic> 287–297 (2016).</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of cell type annotation R packages on single-cell RNA-seq data</article-title>
        <source>Genomics, Proteom. Bioinforma.</source>
        <year>2020</year>
        <volume>2</volume>
        <fpage>267</fpage>
        <lpage>281</lpage>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <?supplied-pmid 2723002?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>591</fpage>
        <lpage>594</lpage>
        <?supplied-pmid 30013048?>
        <pub-id pub-id-type="pmid">30013048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The COSMIC Cancer Gene Census: describing genetic dysfunction across all human cancers</article-title>
        <source>Nat. Rev. Cancer</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>696</fpage>
        <lpage>705</lpage>
        <?supplied-pmid 30293088?>
        <pub-id pub-id-type="pmid">30293088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Ianevski A. et al. Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data. GitHub repository IanevskiAleksandr/sc-type. <italic>Zenodo</italic>. 10.5281/zenodo.5842322 (2022).</mixed-citation>
    </ref>
  </ref-list>
</back>
