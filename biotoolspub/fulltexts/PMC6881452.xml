<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6881452</article-id>
    <article-id pub-id-type="publisher-id">13395</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-019-13395-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0478-5533</contrib-id>
        <name>
          <surname>Singh</surname>
          <given-names>Jaswinder</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6956-6748</contrib-id>
        <name>
          <surname>Hanson</surname>
          <given-names>Jack</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3553-3662</contrib-id>
        <name>
          <surname>Paliwal</surname>
          <given-names>Kuldip</given-names>
        </name>
        <address>
          <email>k.paliwal@griffith.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9958-5699</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Yaoqi</given-names>
        </name>
        <address>
          <email>yaoqi.zhou@griffith.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0437 5432</institution-id><institution-id institution-id-type="GRID">grid.1022.1</institution-id><institution>Signal Processing Laboratory, School of Engineering and Built Environment, </institution><institution>Griffith University, </institution></institution-wrap>Brisbane, QLD 4111 Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0437 5432</institution-id><institution-id institution-id-type="GRID">grid.1022.1</institution-id><institution>Institute for Glycomics and School of Information and Communication Technology, </institution><institution>Griffith University, </institution></institution-wrap>Parklands Dr., Southport, QLD 4222 Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>5407</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The majority of our human genome transcribes into noncoding RNAs with unknown structures and functions. Obtaining functional clues for noncoding RNAs requires accurate base-pairing or secondary-structure prediction. However, the performance of such predictions by current folding-based algorithms has been stagnated for more than a decade. Here, we propose the use of deep contextual learning for base-pair prediction including those noncanonical and non-nested (pseudoknot) base pairs stabilized by tertiary interactions. Since only <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M2"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq1.gif"/></alternatives></inline-formula>250 nonredundant, high-resolution RNA structures are available for model training, we utilize transfer learning from a model initially trained with a recent high-quality bpRNA dataset of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; $$\end{document}</tex-math><mml:math id="M4"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq2.gif"/></alternatives></inline-formula>10,000 nonredundant RNAs made available through comparative analysis. The resulting method achieves large, statistically significant improvement in predicting all base pairs, noncanonical and non-nested base pairs in particular. The proposed method (SPOT-RNA), with a freely available server and standalone software, should be useful for improving RNA structure modeling, sequence alignment, and functional annotations.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The limited availability of high-resolution 3D RNA structures for model training limits RNA secondary structure prediction. Here, the authors overcome this challenge by pre-training a DNN on a large set of predicted RNA structures and using transfer learning with high-resolution structures.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational models</kwd>
      <kwd>Machine learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>This work was supported by Australia Research Council DP180102060 to Y.Z. and K. P. and in part by National Health and Medical Research Council (1121629) of Australia to Y.Z.</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">RNA secondary structure is represented by a list of the nucleotide bases paired by hydrogen bonding within its nucleotide sequence. Stacking these base pairs forms the scaffold driving the folding of RNA three-dimensional structures<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. As a result, the knowledge of the RNA secondary structure is essential for modeling RNA structures and understanding their functional mechanisms. As such, many experimental methods have been developed to infer paired bases by using one-dimensional or multiple-dimensional probes, such as enzymes, chemicals, mutations, and cross-linking techniques coupled with next-generation sequencing<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. However, precise base-pairing information at the resolution of single base pairs still requires high-resolution, three-dimensional RNA structures determined by X-ray crystallography, nuclear magnetic resonance (NMR), or cryogenic electron microscopy. With <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.01 \%$$\end{document}</tex-math><mml:math id="M6"><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq3.gif"/></alternatives></inline-formula> of 14 million noncoding RNAs collected in RNAcentral<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> having experimentally determined structures<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, it is highly desirable to develop accurate and cost-effective computational methods for direct prediction of RNA secondary structure from sequence.</p>
    <p id="Par4">Current RNA secondary-structure prediction methods can be classified into comparative sequence analysis and folding algorithms with thermodynamic, statistical, or probabilistic scoring schemes<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. Comparative sequence analysis determines base pairs conserved among homologous sequences. These methods are highly accurate<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> if a large number of homologous sequences are available and those sequences are manually aligned with expert knowledge. However, only a few thousand RNA families are known in Rfam<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. As a result, the most commonly used approach for RNA secondary-structure prediction is to fold a single RNA sequence according to an appropriate scoring function. In this approach, RNA structure is divided into substructures such as loops and stems according to the nearest-neighbor model<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Dynamic programming algorithms are then employed for locating the global minimum or probabilistic structures from these substructures. The scoring parameters of each substructure can be obtained experimentally<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> (e.g., RNAfold<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, RNAstructure<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and RNAshapes<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>) or by machine learning (e.g., CONTRAfold<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, CentroidFold<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, and ContextFold<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>). However, the overall precision (the fraction of correctly predicted base pairs in all predicted base pairs) appears to have reached a “performance ceiling”<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> at about 80<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M8"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq4.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. This is in part because all existing methods ignore some or all base pairs that result from tertiary interactions<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. These base pairs include lone (unstacked), pseudoknotted (non-nested), and noncanonical (not A–U, G–C, and G–U) base pairs as well as triplet interactions<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. While some methods can predict RNA secondary structures with pseudoknots (e.g., pknotsRG<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, Probknot<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, IPknot<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, and Knotty<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>) and others can predict noncanonical base pairs (e.g., MC-Fold<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, MC-Fold-DP<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, and CycleFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>), none of them can provide a computational prediction for both, not to mention lone base pairs and base triplets.</p>
    <p id="Par5">The work presented in this paper is inspired by a recent advancement in the direct prediction of protein contact maps from protein sequences by Raptor-X<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and SPOT-Contact<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> with deep-learning neural network algorithms such as Residual Networks (ResNets)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> and two-dimensional Bidirectional Long Short-Term Memory cells (2D-BLSTMs)<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>. SPOT-Contact treats the entire protein “image” as context and used an ensemble of ultra-deep hybrid networks of ResNets coupled with 2D-BLSTMs for prediction. ResNets can capture contextual information from the whole sequence “image” at each layer and map the complex relationship between input and output. Also, 2D-BLSTMs proved very effective in propagating long-range sequence dependencies in protein structure prediction<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> because of the ability of LSTM cells to remember the structural relationship between the residues that are far from each other in their sequence positions during training. Similar to protein contact map, a RNA secondary structure is a two-dimensional contact matrix, although its contacts are defined differently (hydrogen bonds for RNA base pairs and distance cutoff for protein contacts, respectively). However, unlike proteins, the small number of nonredundant RNA structures available in the Protein Data Bank (PDB)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> makes deep-learning methods unsuitable for direct single-sequence-based prediction of RNA secondary structure. As a result, machine-learning techniques are rarely utilized. To our knowledge, the only example is mxfold<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> that employs a small-scale machine-learning algorithm (structured support vector machines) for RNA secondary-structure prediction. Its performance after combining with a thermodynamic model makes some improvement over folding-based techniques. However, mxfold is limited to canonical base pairs without accounting for pseudoknots.</p>
    <p id="Par6">Recently, a large database of more than 100,000 RNA sequences (bpRNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>) with automated annotation of secondary structure was released. While this database is large enough for us to employ deep-learning techniques, the annotated secondary structures from the comparative analysis may not be reliable at the single base-pair level. To overcome this limitation, we first employed bpRNA to train an ensemble of ResNets and LSTM networks, similar to the ensemble used by us for protein contact map prediction by SPOT-Contact<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. We then further trained the large model with a small database of precise base pairs derived from high-resolution RNA structures. This transfer-learning technique<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> is used successfully by us for identifying molecular recognition features in intrinsically disordered regions of proteins<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. The resulting method, called SPOT-RNA, is a deep-learning technique for predicting all bases paired, regardless if they are associated with tertiary interactions. The new method provides more than 53<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M10"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq5.gif"/></alternatives></inline-formula>, 47<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M12"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq6.gif"/></alternatives></inline-formula>, and 10<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M14"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq7.gif"/></alternatives></inline-formula> improvement in F1 score for non-nested, noncanonical, and all base pairs, respectively, over the next-best method, compared with an independent test set of 62 high-resolution RNA structures by X-ray crystallography. The performance of SPOT-RNA is further confirmed by a separate test set of 39 RNA structures determined by NMR and 6 recently released nonredundant RNAs in PDB.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Initial training by bpRNA</title>
      <p id="Par7">We trained our models of ResNets and LSTM networks by building a nonredundant set of RNA sequences with annotated secondary structure from bpRNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> at 80<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M16"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq8.gif"/></alternatives></inline-formula> sequence-identity cutoff, which is the lowest sequence-identity cutoff allowed by the program CD-HIT-EST<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> and has been employed previously by many studies for the same purpose<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. This dataset of 13,419 RNAs after excluding those <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; $$\end{document}</tex-math><mml:math id="M18"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq9.gif"/></alternatives></inline-formula>80<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M20"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq10.gif"/></alternatives></inline-formula> sequence identities was further randomly divided into 10,814 RNAs for training (TR0), 1300 for validation (VL0), and 1,305 for an independent test (TS0). By using TR0 for training, VL0 for validation, and the single sequence (a one-hot vector of <italic>L</italic>x4) as the only input, we trained many two-dimensional deep-learning models with various combinations in the numbers and sizes of ResNets, BLSTM, and FC layers with a layout shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The performance of an ensemble of the best 5 models (validated by VL0 only) on VL0 and TS0 is shown in Table <xref rid="Tab1" ref-type="table">1</xref>. Essentially the same performance with Matthews correlation coefficient (MCC) at 0.632 for VL0 and 0.629 for TS0 suggests the robustness of the ensemble trained. The F1 scores, the harmonic mean of precision, and sensitivity are also essentially the same between validation and test (0.629 vs. 0.626). Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> further compared the performance of individual models to the ensemble. The MCC improves by 2<inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M22"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq11.gif"/></alternatives></inline-formula> from 0.617 (the best single model) to 0.629 in TS0, confirming the usefulness of an ensemble to eliminate random prediction errors in individual models.<fig id="Fig1"><label>Fig. 1</label><caption><p>Generalized model architecture of SPOT-RNA. The network layout of the SPOT-RNA, where <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M24"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq12.gif"/></alternatives></inline-formula> is the sequence length of a target RNA, Act. indicates the activation function, Norm. indicates the normalization function, and PreT indicates the pretrained (initial trained) models trained on the bpRNA dataset.</p></caption><graphic xlink:href="41467_2019_13395_Fig1_HTML" id="d29e565"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance of SPOT-RNA on validation and test set after initial training, transfer learning, and direct training.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>Training set</th><th>Analysis set</th><th>MCC<inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{a}$$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mrow/><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq13.gif"/></alternatives></inline-formula></th><th>F1<inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M28"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq14.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th></tr></thead><tbody><tr><td>Initial training</td><td>TR0</td><td>VL0</td><td>0.632</td><td>0.629</td><td>0.712</td><td>0.563</td></tr><tr><td/><td>TR0</td><td>TS0</td><td>0.629</td><td>0.626</td><td>0.709</td><td>0.560</td></tr><tr><td/><td>TR0</td><td>TS1</td><td>0.650</td><td>0.630</td><td>0.897</td><td>0.485</td></tr><tr><td>Transfer learning</td><td>TR1+VL1</td><td>TR1+VL1</td><td>0.701 (0.02<inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M30"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq15.gif"/></alternatives></inline-formula>)</td><td>0.690 (0.02<inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq16.gif"/></alternatives></inline-formula>)</td><td>0.853 (0.02<inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq17.gif"/></alternatives></inline-formula>)</td><td>0.580 (0.03<inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq18.gif"/></alternatives></inline-formula>)</td></tr><tr><td/><td>TR1+VL1</td><td>TS1</td><td>0.690 (0.02<inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq19.gif"/></alternatives></inline-formula>)</td><td>0.687 (0.01<inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M40"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq20.gif"/></alternatives></inline-formula>)</td><td>0.888 (0.02<inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq21.gif"/></alternatives></inline-formula>)</td><td>0.562 (0.02<inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{c}$$\end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mrow/><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq22.gif"/></alternatives></inline-formula>)</td></tr><tr><td>Direct training</td><td>TR1</td><td>VL1</td><td>0.583</td><td>0.546</td><td>0.854</td><td>0.401</td></tr><tr><td/><td>TR1</td><td>TS1</td><td>0.571</td><td>0.527</td><td>0.870</td><td>0.378</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Matthews correlation coefficient</p><p><sup>b</sup>Harmonic mean of precision and sensitivity</p><p><sup>c</sup>Standard deviation based on five-fold cross-validation</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Transfer learning with RNA structures</title>
      <p id="Par8">The models obtained from the bpRNA dataset were transferred to further train on base pairs derived from high-resolution nonredundant RNA structures with TR1 (training set), VL1 (validation set), and TS1 (test set) having 120, 30, and 67 RNAs, respectively. The TS1 set is independent of the training data (TR0 and TR1) as it was obtained by first filtering through CD-HIT-EST at the lowest allowed sequence-identity cutoff (80<inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M46"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq23.gif"/></alternatives></inline-formula>). To further remove potential homologies, we utilized BLAST-N<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> against the training data (TR0 and TR1) with an e-value cutoff of 10. To examine the consistency of the models built, we performed 5-fold cross-validation by combining TR1 and VL1 datasets. The results of cross-validation on training data (TR1+VL1) and unseen TS1 for the ensemble of the same top 5 models are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. The minor fluctuations on 5-fold with MCC of 0.701<inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M48"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq24.gif"/></alternatives></inline-formula>0.02 and F1 of 0.690<inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M50"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq25.gif"/></alternatives></inline-formula>0.02 and small difference between 5-fold cross-validation and test set TS1 (0.701 vs. 0.690 for MCC) indicate the robustness of the models trained for the unseen data. Table <xref rid="Tab1" ref-type="table">1</xref> also shows that the direct application of the model trained by bpRNA leads to a reasonable but inferior performance on TS1 compared with the model after transfer learning. The improvement in MCC is 6<inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M52"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq26.gif"/></alternatives></inline-formula> before (0.650) and after (0.690) transfer learning on TS1. Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref> compare the result of the ensemble of models and five individual models for five-fold cross-validation (TR1+VL1) and independent test set (TS1), respectively. Significant improvement of the ensemble over the best single model is observed with 3<inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M54"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq27.gif"/></alternatives></inline-formula> improvement in MCC for cross-validation and independent tests.</p>
    </sec>
    <sec id="Sec5">
      <title>Comparison between transfer learning and direct learning</title>
      <p id="Par9">To demonstrate the usefulness of transfer learning, we also perform the direct training of the 5 models with the same ensemble network architecture and hyperparameters (the number of layers, the depth of layers, the kernel size, the dilation factor, and the learning rate) on the structured RNA train set (TR1) and validated by VL1 and tested by TS1. The performance of the ensemble of five models by direct learning on VL1 and TS1 is shown in Table <xref rid="Tab1" ref-type="table">1</xref>. Similar performance between validation and test with MCC = 0.583, 0.571, respectively, confirms the robustness of direct learning. However, this performance is substantially lower than that of transfer learning (21<inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M56"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq28.gif"/></alternatives></inline-formula> reduction of the MCC value and 30<inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M58"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq29.gif"/></alternatives></inline-formula> reduction in F1 score). This confirms the difficulty of direct learning with a small training dataset of TR1 and the need for using a large dataset (bpRNA) that can effectively utilize capabilities of deep-learning networks. Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref> further compared the performance of individual models with the ensemble by direct learning on TR1. Figure <xref rid="Fig2" ref-type="fig">2</xref>a compares the precision-recall (PR) curves given by initial training (SPOT-RNA-IT), direct training (SPOT-RNA-DT), and transfer learning (SPOT-RNA) on the independent test set TS1. The results are from a reduced TS1 (62 RNAs rather than 67) because some other methods shown in the same figure do not predict secondary structure for sequences with missing or invalid bases. Interestingly, direct training starts with 100<inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M60"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq30.gif"/></alternatives></inline-formula> precision at very low sensitivity (recall), whereas both initial training and transfer learning have high but <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M62"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq31.gif"/></alternatives></inline-formula>100<inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M64"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq32.gif"/></alternatives></inline-formula> precision at the lowest achievable sensitivities for the highest possible threshold that separates positive from negative prediction. This suggests that the existence of false positives in bpRNA “contaminated” the initial training. Nevertheless, the transfer learning achieves a respectable 93.2<inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M66"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq33.gif"/></alternatives></inline-formula> precision at 50<inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M68"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq34.gif"/></alternatives></inline-formula> recall. This indicates that the fraction of potential false positives in bpRNA is small.<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance comparison of SPOT-RNA with 12 other predictors by using PR curve and boxplot on the test set TS1. <bold>a</bold> Precision-recall curves on the independent test set TS1 by initial training (SPOT-RNA-IT, the green dashed line), direct training (SPOT-RNA-DT, the blue dot-dashed line), and transfer learning (SPOT-RNA, the solid magenta line). Precision and sensitivity results from ten currently used predictors are also shown as labeled with open symbols for the methods accounting for pseudoknots and filled symbols for the methods not accounting for pseudoknots. CONTRAfold and CentroidFold were also shown as curves (Gold and Black) because their methods provide predicted probabilities. <bold>b</bold> Distribution of F1 score for individual RNAs on the independent test set TS1 given by various methods as labeled. On each box, the central mark indicates the median, and the bottom and top edges of the box indicate the 25th and 75th percentiles, respectively. The outliers are plotted individually by using the “+” symbol.</p></caption><graphic xlink:href="41467_2019_13395_Fig2_HTML" id="d29e1063"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Comparison with other secondary-structure predictors</title>
      <p id="Par10">Figure <xref rid="Fig2" ref-type="fig">2</xref>a further compares precision/recall curves given by our transfer-learning ensemble model with 12 other available RNA secondary-structure predictors on independent test set TS1. Two predictors (CONTRAfold and CentroidFold) with probabilistic outputs are also represented by the PR curves with the remaining shown as a singular point. The performance of most existing methods is clustered around the sensitivity of 50<inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M70"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq35.gif"/></alternatives></inline-formula> and precision of 67–83<inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M72"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq36.gif"/></alternatives></inline-formula> (Table <xref rid="Tab2" ref-type="table">2</xref>). By comparison, our method SPOT-RNA improves by 9<inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M74"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq37.gif"/></alternatives></inline-formula> in MCC and more than 10<inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M76"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq38.gif"/></alternatives></inline-formula> in F1 score over the next-best mxfold.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of all the predictors according to base-pair types on the test set TS1.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="4">All base pairs</th><th colspan="3">Canonical only</th><th colspan="3">Watson–Crick only</th><th colspan="3">Wobble only</th></tr><tr><th/><th>MCC<inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{a}$$\end{document}</tex-math><mml:math id="M78"><mml:msup><mml:mrow/><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq39.gif"/></alternatives></inline-formula></th><th>F1<inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq40.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th><th>F1<inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M82"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq41.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th><th>F1<inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M84"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq42.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th><th>F1<inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M86"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq43.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th></tr></thead><tbody><tr><td>SPOT-RNA</td><td>0.700</td><td>0.690</td><td>0.849</td><td>0.582</td><td>0.773</td><td>0.858</td><td>0.703</td><td>0.790</td><td>0.857</td><td>0.733</td><td>0.592</td><td>0.865</td><td>0.450</td></tr><tr><td>mxfold</td><td>0.644</td><td>0.628</td><td>0.824</td><td>0.508</td><td>0.728</td><td>0.824</td><td>0.652</td><td>0.749</td><td>0.830</td><td>0.682</td><td>0.519</td><td>0.747</td><td>0.398</td></tr><tr><td>ContextFold</td><td>0.636</td><td>0.621</td><td>0.811</td><td>0.503</td><td>0.719</td><td>0.811</td><td>0.646</td><td>0.737</td><td>0.822</td><td>0.668</td><td>0.554</td><td>0.693</td><td>0.462</td></tr><tr><td>CONTRAfold</td><td>0.621</td><td>0.611</td><td>0.765</td><td>0.508</td><td>0.704</td><td>0.765</td><td>0.652</td><td>0.724</td><td>0.778</td><td>0.677</td><td>0.517</td><td>0.630</td><td>0.439</td></tr><tr><td>Knotty</td><td>0.611</td><td>0.603</td><td>0.742</td><td>0.508</td><td>0.694</td><td>0.742</td><td>0.652</td><td>0.713</td><td>0.755</td><td>0.676</td><td>0.519</td><td>0.611</td><td>0.450</td></tr><tr><td>IPknot</td><td>0.596</td><td>0.576</td><td>0.789</td><td>0.454</td><td>0.671</td><td>0.789</td><td>0.583</td><td>0.690</td><td>0.799</td><td>0.608</td><td>0.483</td><td>0.681</td><td>0.374</td></tr><tr><td>RNAfold</td><td>0.593</td><td>0.585</td><td>0.724</td><td>0.491</td><td>0.674</td><td>0.724</td><td>0.630</td><td>0.696</td><td>0.742</td><td>0.655</td><td>0.478</td><td>0.554</td><td>0.421</td></tr><tr><td>ProbKnot</td><td>0.582</td><td>0.576</td><td>0.705</td><td>0.486</td><td>0.662</td><td>0.705</td><td>0.624</td><td>0.684</td><td>0.725</td><td>0.648</td><td>0.466</td><td>0.522</td><td>0.421</td></tr><tr><td>CentroidFold</td><td>0.577</td><td>0.569</td><td>0.706</td><td>0.477</td><td>0.656</td><td>0.706</td><td>0.612</td><td>0.675</td><td>0.719</td><td>0.636</td><td>0.476</td><td>0.569</td><td>0.409</td></tr><tr><td>RNAstructure</td><td>0.570</td><td>0.562</td><td>0.702</td><td>0.469</td><td>0.648</td><td>0.702</td><td>0.602</td><td>0.670</td><td>0.719</td><td>0.627</td><td>0.451</td><td>0.532</td><td>0.392</td></tr><tr><td>RNAshapes</td><td>0.564</td><td>0.555</td><td>0.699</td><td>0.460</td><td>0.640</td><td>0.699</td><td>0.591</td><td>0.661</td><td>0.716</td><td>0.614</td><td>0.455</td><td>0.531</td><td>0.398</td></tr><tr><td>pkiss</td><td>0.543</td><td>0.538</td><td>0.660</td><td>0.454</td><td>0.619</td><td>0.660</td><td>0.582</td><td>0.643</td><td>0.682</td><td>0.608</td><td>0.403</td><td>0.453</td><td>0.363</td></tr><tr><td>CycleFold</td><td>0.461</td><td>0.466</td><td>0.476</td><td>0.456</td><td>0.546</td><td>0.551</td><td>0.540</td><td>0.565</td><td>0.566</td><td>0.564</td><td>0.368</td><td>0.403</td><td>0.339</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Matthews correlation coefficient</p><p><sup>b</sup>Harmonic mean of precision and sensitivity</p></table-wrap-foot></table-wrap></p>
      <p id="Par11">The results presented in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a are the overall performance at the base-pair level. Figure <xref rid="Fig2" ref-type="fig">2</xref>b shows the distribution of the F1 score among individual RNAs in terms of median, 25th, and 75th percentiles. SPOT-RNA has the highest median F1 score along with the highest F1 score (0.348) for the worst-performing RNA, compared with nearly 0 for all other methods. This highlights the highly stable performance of SPOT-RNA, relative to all other folding-based techniques, including mxfold, which mixes thermodynamic and machine-learning models. The difference between SPOT-RNA and the next-best mxfold on TS1 is statistically significant with <italic>P</italic> value <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M88"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq44.gif"/></alternatives></inline-formula> 0.006 obtained through a paired <italic>t</italic> test. Also, we calculated the ensemble defect (see the “Methods” section) from the predicted base-pair probabilities for SPOT-RNA, CONTRAfold, and CentroidFold on TS1. The ensemble defect metric describes the deviation of probabilistic structural ensembles from their corresponding native RNA secondary structure, where 0 represents a perfect prediction. The ensemble defect for SPOT-RNA was 0.19 as compared with 0.24 and 0.25 for CONTRAfold and CentroidFold, respectively, showing that the structural ensemble predicted by SPOT-RNA is more similar to target structures in comparison with the other two predictors.</p>
      <p id="Par12">Our method was trained for RNAs with a maximum length of 500 nucleotides, due to hardware limitations. It is of interest to determine how our method performs in terms of size dependence. As the maximum sequence length in TS1 was 189, therefore, we added 32 RNAs of sequence length from 298 to 1500 to TS1 by relaxing the resolution requirement to 4 Å and including RNA chains complexed with other RNAs (but ignored inter-RNA base pairs). The reason for relaxing the resolution to 4 Å and including RNA chains complexed with other RNAs because there were not many high-resolution and single-chain long RNAs in PDB. Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> compares the F1 score of each RNA given by SPOT-RNA with that from the next-best mxfold as a function of the length of RNAs. There is a trend of lower performance for a longer RNA chain for both methods as expected. SPOT-RNA consistently outperforms mxfold within 500 nucleotides that our method was trained on. Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> also shows that mxfold performs better with an average of F1 score at 0.50, compared with 0.35 by SPOT-RNA on 21 long RNAs (<italic>L</italic> <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; $$\end{document}</tex-math><mml:math id="M90"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq45.gif"/></alternatives></inline-formula> 1000). We found that the poor performance of SPOT-RNA is mainly because of the failure of SPOT-RNA to capture ultra long-distance pairs with sequence separation <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; $$\end{document}</tex-math><mml:math id="M92"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq46.gif"/></alternatives></inline-formula>300. This failure is caused by the limited long RNA data in training. By comparison, the thermodynamic algorithm in mxfold can locate the global minimum regardless of the distance between sequence positions of the base pairs.</p>
      <p id="Par13">The above comparison may be biased toward our method because almost all other methods compared can only predict canonical base pairs, which include Watson–Crick (A–U and G–C) pairs and Wobble pairs (G–U). To address this potential bias, Table <xref rid="Tab2" ref-type="table">2</xref> further compares the performance of SPOT-RNA with others on canonical pairs, Watson–Crick pairs (A–U and G–C pairs), and Wobble pairs (G–U), separately on TS1. Indeed, all methods have a performance boost when noncanonical pairs are excluded from performance measurement. SPOT-RNA continues to have the best performance with 6<inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M94"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq47.gif"/></alternatives></inline-formula> improvement in F1 score for canonical pairs and Watson–Crick pairs over the next-best mxfold and 7<inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M96"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq48.gif"/></alternatives></inline-formula> improvement for Wobble pairs over the next-best ContextFold. mxfold does not perform as well in predicting Wobble pairs and is only the fourth best.</p>
      <p id="Par14">Base pairs associated with pseudoknots are challenging for both folding-based and machine-learning-based approaches because they are often associated with tertiary interactions that are difficult to predict. To make a direct comparison in the capability of predicting base pairs in pseudoknots, we define pseudoknot pairs as the minimum number of base pairs that can be removed to result in a pseudoknot-free secondary structure. The program bpRNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/hendrixlab/bpRNA">https://github.com/hendrixlab/bpRNA</ext-link>) was used to obtain base pairs in pseudoknots from both native and predicted secondary structures. Table <xref rid="Tab3" ref-type="table">3</xref> compares the performance of SPOT-RNA with all 12 other methods regardless if they can handle pseudoknots or not for those 40 RNAs with at least one pseudoknot in the independent test TS1. As none of the other methods predict multiplets, we ignore the base pairs associated with the multiplets in the analysis. mxfold remains the second best behind SPOT-RNA although it is unable to predict pseudoknots, due to the number of base pairs in pseudoknots accounting for only 10<inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M98"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq49.gif"/></alternatives></inline-formula> of all base pairs (see Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>). Table <xref rid="Tab3" ref-type="table">3</xref> shows that all methods perform poorly with F1 score &lt; 0.3 for base pairs associated with pseudoknots. Despite the challenging nature of this problem, SPOT-RNA makes a substantial improvement over the next-best (pkiss) by 52<inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M100"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq50.gif"/></alternatives></inline-formula> in F1 score.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance of all the predictors on 40 pseudoknot RNAs in the test set TS1.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="4">All Base Pairs</th><th colspan="3">Base Pairs in Pseudoknots</th><th colspan="3">Base Pair not in Pseudoknots</th></tr><tr><th/><th>MCC<inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{a}$$\end{document}</tex-math><mml:math id="M102"><mml:msup><mml:mrow/><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq51.gif"/></alternatives></inline-formula></th><th>F1<inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M104"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq52.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th><th>F1<inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq53.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th><th>F1<inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{b}$$\end{document}</tex-math><mml:math id="M108"><mml:msup><mml:mrow/><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq54.gif"/></alternatives></inline-formula></th><th>Precision</th><th>Sensitivity</th></tr></thead><tbody><tr><td>SPOT-RNA</td><td>0.769</td><td>0.764</td><td>0.875</td><td>0.679</td><td>0.239</td><td>0.550</td><td>0.153</td><td>0.797</td><td>0.872</td><td>0.734</td></tr><tr><td>mxfold</td><td>0.687</td><td>0.682</td><td>0.797</td><td>0.595</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.714</td><td>0.780</td><td>0.659</td></tr><tr><td>ContextFold</td><td>0.686</td><td>0.680</td><td>0.797</td><td>0.594</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.714</td><td>0.781</td><td>0.658</td></tr><tr><td>CONTRAfold</td><td>0.659</td><td>0.658</td><td>0.735</td><td>0.595</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.688</td><td>0.719</td><td>0.659</td></tr><tr><td>Knotty</td><td>0.678</td><td>0.678</td><td>0.740</td><td>0.625</td><td>0.108</td><td>0.134</td><td>0.090</td><td>0.707</td><td>0.761</td><td>0.660</td></tr><tr><td>IPknot</td><td>0.638</td><td>0.629</td><td>0.769</td><td>0.533</td><td>0.131</td><td>0.458</td><td>0.076</td><td>0.664</td><td>0.768</td><td>0.585</td></tr><tr><td>RNAfold</td><td>0.605</td><td>0.606</td><td>0.666</td><td>0.555</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.646</td><td>0.666</td><td>0.628</td></tr><tr><td>ProbKnot</td><td>0.610</td><td>0.611</td><td>0.669</td><td>0.562</td><td>0.118</td><td>0.256</td><td>0.076</td><td>0.632</td><td>0.663</td><td>0.603</td></tr><tr><td>CentroidFold</td><td>0.616</td><td>0.616</td><td>0.682</td><td>0.562</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.644</td><td>0.668</td><td>0.621</td></tr><tr><td>RNAstructure</td><td>0.585</td><td>0.584</td><td>0.650</td><td>0.531</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.621</td><td>0.647</td><td>0.598</td></tr><tr><td>RNAshapes</td><td>0.569</td><td>0.568</td><td>0.639</td><td>0.512</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.591</td><td>0.622</td><td>0.563</td></tr><tr><td>pkiss</td><td>0.564</td><td>0.565</td><td>0.619</td><td>0.520</td><td>0.157</td><td>0.180</td><td>0.139</td><td>0.566</td><td>0.616</td><td>0.523</td></tr><tr><td>CycleFold</td><td>0.455</td><td>0.458</td><td>0.423</td><td>0.499</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.482</td><td>0.422</td><td>0.563</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Matthews correlation coefficient</p><p><sup>b</sup>Harmonic mean of precision and sensitivity</p></table-wrap-foot></table-wrap></p>
      <p id="Par15">Noncanonical pairs, triplets, and lone base pairs are also associated with tertiary interactions other than pseudoknots. Here, lone base pairs refer to a single base pair without neighboring base pairs (i.e., [<italic>i</italic>, <italic>j</italic>] in the absence of [<italic>i</italic> − 1, <italic>j</italic> + 1] and [<italic>i</italic> + 1, <italic>j</italic> − 1]). Triplets refer to the rare occasion of one base forming base pairs with two other bases. As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>, SPOT-RNA makes a 47<inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M110"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq55.gif"/></alternatives></inline-formula> improvement in F1 score for predicting noncanonical base pairs over CycleFold. Although the sensitivity of prediction given by SPOT-RNA is low (15.4<inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M112"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq56.gif"/></alternatives></inline-formula>), the precision is high at 73.2<inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M114"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq57.gif"/></alternatives></inline-formula>. Very low performance for triplets and lone pairs (F1 score <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M116"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq58.gif"/></alternatives></inline-formula> 0.2) is observed.</p>
      <p id="Par16">Secondary structure of RNAs is characterized by structural motifs in their layout. For each native or predicted secondary structure, the secondary-structure motif was classified by program bpRNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The performance in predicting bases in different secondary structural motifs by different methods is shown in Table <xref rid="Tab4" ref-type="table">4</xref>. According to the F1 score, SPOT-RNA makes the best prediction in stem base pairs (6<inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M118"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq59.gif"/></alternatives></inline-formula> improvement over the next best), hairpin loop nucleotide (8<inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M120"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq60.gif"/></alternatives></inline-formula> improvement), and bulge nucleotide (11<inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M122"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq61.gif"/></alternatives></inline-formula> improvement), although it performs slightly worse than CONTRAfold in multiloop (by 2<inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M124"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq62.gif"/></alternatives></inline-formula>). mxfold is best for internal loop prediction over the second-best predictor Knotty by 18<inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M126"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq63.gif"/></alternatives></inline-formula>. To demonstrate the SPOT-RNA’s ability to predict tertiary interactions along with canonical base pairs, Supplementary Figs. <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref> show two examples (riboswitch<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> and t-RNA<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>) from TS1 with one high performance and one average performance, respectively. For both the examples, SPOT-RNA is able to predict noncanonical base pairs (in green), pseudoknot base pairs, and lone pair (in blue), while mxfold and IPknot remain unsuccessful to predict noncanonical and pseudoknot base pairs.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Performance of all the predictors on secondary-structure motifs on the test set TS1.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Stem(F1<sup><italic>a</italic></sup>)</th><th>Stem (PR)</th><th>Stem (SN)</th><th>Hairpin loop (F1<sup><italic>a</italic></sup>)</th><th>Hairpin loop (PR)</th><th>Hairpin loop (SN)</th><th>Bulge (F1<sup><italic>a</italic></sup>)</th><th>Bulge (PR)</th><th>Bulge (SN)</th><th>Internal loop (F1<sup><italic>a</italic></sup>)</th><th>Internal loop (PR)</th><th>Internal loop (SN)</th><th>Multiloop (F1<sup><italic>a</italic></sup>)</th><th>Multiloop (PR)</th><th>Multiloop (SN)</th></tr></thead><tbody><tr><td>SPOT-RNA</td><td>0.762</td><td>0.841</td><td>0.697</td><td>0.686</td><td>0.625</td><td>0.761</td><td>0.369</td><td>0.508</td><td>0.289</td><td>0.266</td><td>0.239</td><td>0.300</td><td>0.562</td><td>0.503</td><td>0.638</td></tr><tr><td>mxfold</td><td>0.717</td><td>0.769</td><td>0.671</td><td>0.625</td><td>0.525</td><td>0.771</td><td>0.213</td><td>0.360</td><td>0.152</td><td>0.329</td><td>0.270</td><td>0.422</td><td>0.526</td><td>0.465</td><td>0.607</td></tr><tr><td>ContextFold</td><td>0.706</td><td>0.755</td><td>0.663</td><td>0.633</td><td>0.513</td><td>0.825</td><td>0.286</td><td>0.539</td><td>0.194</td><td>0.214</td><td>0.170</td><td>0.289</td><td>0.574</td><td>0.544</td><td>0.607</td></tr><tr><td>CONTRAfold</td><td>0.688</td><td>0.705</td><td>0.671</td><td>0.624</td><td>0.553</td><td>0.715</td><td>0.331</td><td>0.378</td><td>0.294</td><td>0.279</td><td>0.241</td><td>0.331</td><td>0.469</td><td>0.587</td><td>0.391</td></tr><tr><td>Knotty</td><td>0.670</td><td>0.739</td><td>0.613</td><td>0.600</td><td>0.493</td><td>0.766</td><td>0.295</td><td>0.421</td><td>0.227</td><td>0.279</td><td>0.238</td><td>0.338</td><td>0.549</td><td>0.649</td><td>0.476</td></tr><tr><td>IPknot</td><td>0.665</td><td>0.754</td><td>0.595</td><td>0.602</td><td>0.510</td><td>0.735</td><td>0.201</td><td>0.474</td><td>0.128</td><td>0.218</td><td>0.202</td><td>0.236</td><td>0.417</td><td>0.339</td><td>0.542</td></tr><tr><td>RNAfold</td><td>0.671</td><td>0.686</td><td>0.657</td><td>0.617</td><td>0.539</td><td>0.722</td><td>0.313</td><td>0.500</td><td>0.227</td><td>0.270</td><td>0.218</td><td>0.354</td><td>0.514</td><td>0.555</td><td>0.478</td></tr><tr><td>ProbKnot</td><td>0.625</td><td>0.661</td><td>0.592</td><td>0.571</td><td>0.480</td><td>0.704</td><td>0.276</td><td>0.377</td><td>0.218</td><td>0.209</td><td>0.187</td><td>0.236</td><td>0.481</td><td>0.492</td><td>0.470</td></tr><tr><td>CentroidFold</td><td>0.646</td><td>0.662</td><td>0.632</td><td>0.579</td><td>0.467</td><td>0.761</td><td>0.293</td><td>0.395</td><td>0.232</td><td>0.179</td><td>0.211</td><td>0.156</td><td>0.433</td><td>0.379</td><td>0.506</td></tr><tr><td>RNAstructure</td><td>0.646</td><td>0.665</td><td>0.629</td><td>0.596</td><td>0.508</td><td>0.720</td><td>0.300</td><td>0.440</td><td>0.227</td><td>0.238</td><td>0.204</td><td>0.285</td><td>0.478</td><td>0.546</td><td>0.424</td></tr><tr><td>RNAshapes</td><td>0.627</td><td>0.650</td><td>0.605</td><td>0.574</td><td>0.507</td><td>0.663</td><td>0.310</td><td>0.432</td><td>0.242</td><td>0.238</td><td>0.193</td><td>0.308</td><td>0.433</td><td>0.507</td><td>0.378</td></tr><tr><td>pkiss</td><td>0.618</td><td>0.684</td><td>0.565</td><td>0.532</td><td>0.449</td><td>0.655</td><td>0.253</td><td>0.457</td><td>0.175</td><td>0.229</td><td>0.183</td><td>0.304</td><td>0.406</td><td>0.494</td><td>0.344</td></tr><tr><td>CycleFold</td><td>0.496</td><td>0.431</td><td>0.584</td><td>0.437</td><td>0.564</td><td>0.357</td><td>0.277</td><td>0.333</td><td>0.237</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.367</td><td>0.374</td><td>0.360</td></tr></tbody></table><table-wrap-foot><p><inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{a}$$\end{document}</tex-math><mml:math id="M128"><mml:msup><mml:mrow/><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq64.gif"/></alternatives></inline-formula>Harmonic mean of precision (PR) and sensitivity (SN)</p></table-wrap-foot></table-wrap></p>
      <p id="Par17">To further confirm the performance of SPOT-RNA, we compiled another test set (TS2) with 39 RNA structures solved by NMR. As with TS1, TS2 was made nonredundant to our training data by using CD-HIT-EST and BLAST-N. Figure <xref rid="Fig3" ref-type="fig">3</xref>a compares precision-recall curves given by SPOT-RNA with 12 other RNA secondary-structure predictors on the test set TS2. SPOT-RNA outperformed all other predictors on this test set (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>). Furthermore, Fig. <xref rid="Fig3" ref-type="fig">3</xref>b shows the distribution of the F1 score among individual RNAs in terms of median, 25th, and 75th percentiles. SPOT-RNA achieved the highest median F1 score with the least fluctuation although the difference between SPOT-RNA and the next-best (Knotty this time) on individual RNAs (shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>) is not significant with <italic>P</italic> value <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M130"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq65.gif"/></alternatives></inline-formula> 0.16 obtained through a paired <italic>t</italic> test. Ensemble defect on TS2 is the smallest by SPOT-RNA (0.14 for SPOT-RNA as compared with 0.18 and 0.19 by CentroidFold and CONTRAfold, respectively). Here, we did not compare the performance in pseudoknots because the number of base pairs in pseudoknots (a total of 21) in this dataset is too small to make statistically meaningful comparison.<fig id="Fig3"><label>Fig. 3</label><caption><p>Performance comparison of SPOT-RNA with 12 other predictors by using PR curve and boxplot on the test set TS2. <bold>a</bold> Precision-recall curves on the independent test set TS2 by various methods as in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a labeled. <bold>b</bold> Distribution of F1 score for individual RNAs on the independent test set TS2 given by various methods as in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b labeled.</p></caption><graphic xlink:href="41467_2019_13395_Fig3_HTML" id="d29e3476"/></fig></p>
      <p id="Par18">In addition, we found a total of 6 RNAs with recently solved structures (after March 9, 2019) that are not redundant according to CD-HIT-EST and BLAST-N to our training sets (TR0 and TR1) and test sets (TS1 and TS2). The prediction for a synthetic construct RNA (released on 26 June 2019, chain H in PDB ID 6dvk)<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> was compared with the native structure in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. For this synthetic RNA, SPOT-RNA yields a structural topology very similar to the native secondary structure with F1 score of 0.85, precision of 97<inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M132"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq66.gif"/></alternatives></inline-formula>, and sensitivity of 77<inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M134"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq67.gif"/></alternatives></inline-formula>. In particular, SPOT-RNA captures one noncanonical base pair between G46 and A49 correctly but missed others in pseudoknots. The SPOT-RNA predictions of Glutamine II Riboswitch (chain A in PDB ID 6qn3, released on June 12, 2019)<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> and Synthetic Construct Hatchet Ribozyme (chain U in PDB ID 6jq6, released on June 12, 2019)<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> are compared with their respective native secondary structure in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, c, respectively. For these two RNAs, experimental evidence suggests strand swapping in dimerization<sup><xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. Thus, their monomeric native structures are obtained by replacing the swapped stand by its original stand. SPOT-RNA is able to predict both the stems and pseudoknot (in Blue) with an overall F1 score of 0.90 for Glutamine II Riboswitch. For Hatchet Ribozyme, SPOT-RNA is able to predict native-like structure with F1 score of 0.74 although it has missed noncanonical and pseudoknot base pairs.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of SPOT-RNA prediction with the native structure of a Synthetic Construct, Glutamine II Riboswitch, and Hatchet Ribozyme. The secondary structure of a synthetic construct RNA (chain H in PDB ID 6dvk), the Glutamine II Riboswitch RNA (chain A in PDB ID 6qn3), and Synthetic Construct Hatchet Ribozyme (chain U in PDB ID 6jq6) represented by 2D diagram with canonical base pair (BP) in black color, noncanonical BP in green color, pseduoknot BP and lone pair in blue color, and wrongly predicted BP in magenta color: <bold>a</bold> predicted structure by SPOT-RNA (at top), with 97<inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M136"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq68.gif"/></alternatives></inline-formula> precision and 77<inline-formula id="IEq69"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M138"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq69.gif"/></alternatives></inline-formula> sensitivity, as compared with the native structure (at bottom) for the Synthetic Construct RNA, <bold>b</bold> the predicted structure by SPOT-RNA (at top) with 100<inline-formula id="IEq70"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M140"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq70.gif"/></alternatives></inline-formula> precision and 81<inline-formula id="IEq71"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M142"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq71.gif"/></alternatives></inline-formula> sensitivity, as compared with the native structure (at bottom) for the Riboswitch, <bold>c</bold> the predicted structure by SPOT-RNA (at top) with 100<inline-formula id="IEq72"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M144"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq72.gif"/></alternatives></inline-formula> precision and 59<inline-formula id="IEq73"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M146"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq73.gif"/></alternatives></inline-formula> sensitivity, as compared with the native structure (at bottom) for the synthetic construct Hatchet ribozyme.</p></caption><graphic xlink:href="41467_2019_13395_Fig4_HTML" id="d29e3603"/></fig></p>
      <p id="Par19">Three other RNAs are Pistol Ribozyme (chain A and B in PDB ID 6r47, released on July 3, 2019)<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, Mango Aptamer (chain B in PDB ID 6e8u, released on April 17, 2019)<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, and Adenovirus Virus-associated RNA (chain C in PDB ID 6ol3, released on July 3, 2019)<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. SPOT-RNA achieves F1 score of 0.57, 0.41, and 0.63 on Pistol Ribozyme, Mango Aptamer, and adenovirus virus-associated RNA, respectively. For this level of performance, it is more illustrative to show a one-dimensional representation of RNA secondary structure (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a–c). The figures show that the relatively poor performance of Pistol Ribozyme and Mango Aptamer RNAs is in part due to the uncommon existence of a large number of noncanonical base pairs (in Green). For adenovirus virus-associated RNA (VA-I), SPOT-RNA’s prediction is poor. It contains three false-positive stems with falsely predicted pseudoknots (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c).<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of SPOT-RNA prediction with the native structure of a Pistol Ribozyme, Mango aptamer, and Adenovirus Virus-associated RNA. The secondary structure of a Pistol Ribozyme (chain A and B in PDB ID 6r47), the Mango Aptamer (chain B in PDB ID 6e8u), and the adenovirus virus-associated RNA (chain C in PDB ID 6ol3) represented by arc diagrams with canonical base pair (BP) in blue color, noncanonical, pseduoknot BP and lone pair in green color, and wrongly predicted BP in magenta color: <bold>a</bold> predicted structure by SPOT-RNA (on left), with 93<inline-formula id="IEq74"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M148"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq74.gif"/></alternatives></inline-formula> precision and 41<inline-formula id="IEq75"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M150"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq75.gif"/></alternatives></inline-formula> sensitivity, as compared with the native structure (on right) for the Pistol Ribozyme, <bold>b</bold> the predicted structure by SPOT-RNA (on left) with 100<inline-formula id="IEq76"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M152"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq76.gif"/></alternatives></inline-formula> precision and 26<inline-formula id="IEq77"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M154"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq77.gif"/></alternatives></inline-formula> sensitivity, as compared with the native structure (on right) for the Mango aptamer, <bold>c</bold> the predicted structure by SPOT-RNA (on left) with 66<inline-formula id="IEq78"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M156"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq78.gif"/></alternatives></inline-formula> precision and 60<inline-formula id="IEq79"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M158"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq79.gif"/></alternatives></inline-formula> sensitivity, as compared with the native structure (on right) for the adenovirus virus-associated RNA.</p></caption><graphic xlink:href="41467_2019_13395_Fig5_HTML" id="d29e3703"/></fig></p>
      <p id="Par20">Performance comparison on these 6 RNAs with 12 other secondary-structure predictors is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. SPOT-RNA outperforms all other predictors on Synthetic Construct RNA (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a), Glutamine II Riboswitch (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b), and Pistol Ribozyme (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). It is the co-first (same as mxfold) in Mango Aptamer (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e) and the second best (behind mxfold only) in Hatchet Ribozyme (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). However, it did not do well on adenovirus virus-associated RNA (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f), which was part of RNA puzzle-2017, when compared with other methods. This poor prediction compared with other methods is likely because this densely contacted, base-pairing network without pseudoknots (except those due to noncanonical base pairs) is most suitable for folding-based algorithms that maximize the number of stacked canonical base pairs.<fig id="Fig6"><label>Fig. 6</label><caption><p>Performance comparison of all predictors on 6 recently released (after March 9, 2019) crystal structures. <bold>a</bold> F1 score of predicted structure on a synthetic construct RNA (chain H in PDB ID 6dvk), <bold>b</bold> F1 score of predicted structure on the Glutamine II Riboswitch RNA (chain A in PDB ID 6qn3), <bold>c</bold> F1 score of predicted structure on a synthetic construct Hatchet Ribozyme (chain U in PDB ID 6jq6), <bold>d</bold> F1 score of predicted structure on a Pistol Ribozyme (chain A &amp; B in PDB ID 6r47), <bold>e</bold> F1 score of predicted structure on the Mango Aptamer (chain B in PDB ID 6e8u), <bold>f</bold> F1 score of predicted structure on the adenovirus virus-associated RNA (chain C in PDB ID 6ol3).</p></caption><graphic xlink:href="41467_2019_13395_Fig6_HTML" id="d29e3756"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par21">This work developed RNA secondary-structure prediction method purely based on deep neural network learning from a single RNA sequence. Because only a small number of high-resolution RNA structures are available, deep-learning models have to be first trained by using a large database of RNA secondary structures (bpRNA) annotated according to comparative analysis, followed by transfer learning to the precise secondary structures derived from 3D structures. Although the slightly noisy data in bpRNA lead to an upbound around 96<inline-formula id="IEq80"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M160"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq80.gif"/></alternatives></inline-formula> for the precision (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), the model generated from transfer learning yields a substantial improvement (30<inline-formula id="IEq81"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M162"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq81.gif"/></alternatives></inline-formula> in F1 score) over the model based on direct learning TS1. Without the need for folding-based optimization, the transfer-learning model yields a method that can predict not only canonical base pairs but also those base pairs often associated with tertiary interactions, including pseudoknots, lone, and noncanonical base pairs. By comparing with 12 current secondary-structure prediction techniques by using the independent test of 62 high-resolution X-ray structures of RNAs, the method (SPOT-RNA) achieved 93<inline-formula id="IEq82"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M164"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq82.gif"/></alternatives></inline-formula> in precision, which is a 13<inline-formula id="IEq83"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M166"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq83.gif"/></alternatives></inline-formula> improvement over the second-best method mxfold when the sensitivity for SPOT-RNA is set to 50.8<inline-formula id="IEq84"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M168"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq84.gif"/></alternatives></inline-formula> as in mxfold.</p>
    <p id="Par22">One advantage of a pure machine-learning approach is that all base pairs can be trained and predicted, regardless if it is associated with local or nonlocal (tertiary) interactions. By comparison, a folding-based method has to have accurate energetic parameters to capture noncanonical base pairs and sophisticated algorithms for a global minimum search to account for pseudoknots. SPOT-RNA represents a significant advancement in predicting noncanonical base pairs. Its F1 score improves over CycleFold by 47<inline-formula id="IEq85"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M170"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq85.gif"/></alternatives></inline-formula> from 17<inline-formula id="IEq86"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M172"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq86.gif"/></alternatives></inline-formula> to 26<inline-formula id="IEq87"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M174"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq87.gif"/></alternatives></inline-formula> although both methods have a low sensitivity at about 16<inline-formula id="IEq88"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M176"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq88.gif"/></alternatives></inline-formula> (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). SPOT-RNA can also achieve the best prediction of base pairs in pseudoknots although the performance of all methods remains low with an F1 score of 0.239 for SPOT-RNA and 0.157 for the next-best (pkiss, Table <xref rid="Tab3" ref-type="table">3</xref>). This is mainly because the number of base pairs in pseudoknots is low in the structural datasets (an average of 3–4 base pairs per pseudoknot RNA in TS1, see Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>). Moreover, a long stem of many stacked base pairs is easier to learn and predict than a few nonlocal base pairs in pseudoknot. As a reference for future method development, we also examined the ability of SPOT-RNA to capture triple interactions: one base paired with two other bases. Both precision and sensitivity are low (12<inline-formula id="IEq89"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M178"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq89.gif"/></alternatives></inline-formula> and 7<inline-formula id="IEq90"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M180"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq90.gif"/></alternatives></inline-formula>, respectively, Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). This is mainly because there is a lack of data on base triples in bpRNA for pretraining and the number of both triplets and quartets is only 1194 in the structural training set TR1.</p>
    <p id="Par23">To further confirm the performance, SPOT-RNA was applied to 39 RNA structures determined by NMR (TS2). Unlike X-ray structures, structures determined by NMRs resulted from minimization of experimental distance-based constraints. These 39 NMR structures, smaller with average length of 51 nucleotides, have only a total of 21 base pairs in pseudoknots. As a result, they are much easier to predict for all methods (MCC <inline-formula id="IEq91"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M182"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq91.gif"/></alternatives></inline-formula> 0.7 except SPOT-RNA for TS1 but <inline-formula id="IEq92"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; $$\end{document}</tex-math><mml:math id="M184"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq92.gif"/></alternatives></inline-formula>0.74 for most methods in TS2). Despite of this, SPOT-RNA continues to have the best performance (Fig. <xref rid="Fig3" ref-type="fig">3</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>, and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>) as compared with other 12 predictors. Furthermore, the performance of SPOT-RNA was tested on 6 recently released nonredundant (to TR0 and TR1) RNAs in PDB. SPOT-RNA performs the best or the same as the best in 4 and the second best in 1 of the 6 RNAs (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).</p>
    <p id="Par24">One limitation of SPOT-RNA is that it was trained by RNAs shorter than 500 nucleotides due to our hardware limitation. Within 500 nucleotides, SPOT-RNA provides a consistent improvement over existing techniques (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). However, for really long RNA chains (<inline-formula id="IEq93"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; $$\end{document}</tex-math><mml:math id="M186"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq93.gif"/></alternatives></inline-formula>1000), a purely machine-learning-based technique is not as accurate as some of the folding-algorithm-based methods such as mxfold as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>. The lack of training for long RNAs is the main reason. Currently, even if there is no hardware limitation, the number of high-resolution RNA structures with <inline-formula id="IEq94"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; $$\end{document}</tex-math><mml:math id="M188"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq94.gif"/></alternatives></inline-formula>500 nucleotides in PDB structures are too few to provide adequate training. Thus, at this stage, SPOT-RNA is most suitable for RNA length of <inline-formula id="IEq95"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M190"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq95.gif"/></alternatives></inline-formula>500.</p>
    <p id="Par25">In addition to prediction accuracy, high computational efficiency is necessary for RNA secondary-structure prediction because genome-scale studies are often needed. We found that the CPU time for predicting all 62 RNAs in the test set TS1 on a single thread of 32-core Intel Xenon(R) E5-2630v4 CPU is 540 s, which is faster than Knotty (2800 s) but slower than IPknot (1.2 s), ProbKnot (13 s), and pkiss (112 s). However, our distributed version can be easily run on multiple CPU threads or on GPUs. For example, by running SPOT-RNA on a single Nvidia GTX TITAN X GPU, the computation time for predicting all 62 RNAs would be reduced to 39 s. Thus, SPOT-RNA can feasibly be used for genome-scale studies.</p>
    <p id="Par26">This work has used a single RNA sequence as the only input. It is quite remarkable that relying on a single sequence alone can obtain a more accurate method than existing folding methods in secondary-structure prediction. For protein contact map prediction, evolution profiles generated from PSIBLAST<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> and HHblits<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> as well as direct coupling analysis among homologous sequences<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> are the key input vectors responsible for the recent improvement in highly accurate prediction. Thus, one expects that a similar evolution-derived sequence profile generated from BLAST-N and direct/evolution-coupling analysis would further improve secondary-structure prediction for nonlocal base pairs in long RNAs, in particular. Indeed, recently, we have shown that using evolution-derived sequence profiles significantly improves the accuracy of predicting RNA solvent accessibility and flexibility<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. For example, the correlation coefficient between predicted and actual solvent accessibility increases from 0.54 to 0.63 if a single sequence is replaced by a sequence profile from BLAST-N<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. However, the generation of sequence profiles and evolution coupling is computationally time consuming. The resulting improvement (or lack of improvement) is strongly depending on the number of homologous sequences available in current RNA sequence databases. If the number of homologous sequences is too low (which is true for most RNAs), it may introduce more noise than the signal to prediction as demonstrated in protein secondary structure and intrinsic disorder prediction<sup><xref ref-type="bibr" rid="CR51">51</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup>. Moreover, synthetic RNAs will not have any homologous sequences. Thus, we present the method with single-sequence information as input in this study. Using sequence profiles and evolutionary coupling as input for RNA secondary-structure prediction is working in progress.</p>
    <p id="Par27">Another possible method for further improving SPOT-RNA is to employ the predicted probability as a restraint for folding with an appropriate scoring function. Such a dual-approach method will likely improve SPOT-RNA as folding optimization may have a better capability to capture nonlocal interactions between WC pairs for long RNAs, in particular as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>. However, a simple integration may not yield a large improvement for shorter chains (<inline-formula id="IEq96"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M192"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq96.gif"/></alternatives></inline-formula>500). In mxfold, combining machine-learning and thermodynamic models leads to 0.6<inline-formula id="IEq97"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M194"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq97.gif"/></alternatives></inline-formula> in one test set and 5<inline-formula id="IEq98"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M196"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq98.gif"/></alternatives></inline-formula> in another test set<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Moreover, most thermodynamic methods simply ignore noncanonical base pairs and many do not even account for pseudoknots. mxfold, for example, employs a pseudoknot-free thermodynamic method to combine with its machine-learning model. Thus, balancing the performance for canonical, noncanonical, and pseudoknots will require a careful selection of appropriate scoring schemes. A simple integration may lead to high performance in one type of base pair at the expense of other types of base pairs. Nevertheless, we found that if we simply keep only the base pair with the highest predicted probability in predicted triple interactions, SPOT-RNA would be improved by another 3<inline-formula id="IEq99"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M198"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq99.gif"/></alternatives></inline-formula> in F1 score (from 0.69 to 0.71 in TS1), confirming that there is some room for improvement. We will defer this for future studies.</p>
    <p id="Par28">The significantly improved performance in secondary-structure prediction should allow large improvement in modeling RNA 3D structures. This is because the method predicts not only canonical base pairs but also provides important tertiary contacts of noncanonical and non-nested base pairs. Thus, it can serve as a more accurate, quasi-three-dimensional frame to enable correct folding into the right RNA tertiary structure. The usefulness of 2D structure prediction for 3D structure modeling has been demonstrated in RNA Puzzles (blind RNA structure prediction)<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. Moreover, improvement in predicting secondary structural motifs (stems, loops, and bulges, see Table <xref rid="Tab4" ref-type="table">4</xref>) would allow better functional inference<sup><xref ref-type="bibr" rid="CR54">54</xref>,<xref ref-type="bibr" rid="CR55">55</xref></sup>, sequence alignment<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>, and RNA inhibitor design<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. The method and datasets are available as a server and stand-alone software publicly at <ext-link ext-link-type="uri" xlink:href="http://sparks-lab.org/jaswinder/server/SPOT-RNA/">http://sparks-lab.org/jaswinder/server/SPOT-RNA/</ext-link>and <ext-link ext-link-type="uri" xlink:href="https://github.com/jaswindersingh2/SPOT-RNA/">https://github.com/jaswindersingh2/SPOT-RNA/</ext-link>.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Datasets</title>
      <p id="Par29">The datasets for initial training were obtained from bpRNA-1m (Version 1.0)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, which consists of 102,348 RNA sequences with annotated secondary structure. Sequences with sequence similarity of more than 80% were removed by using CD-HIT-EST<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. About 80<inline-formula id="IEq100"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M200"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq100.gif"/></alternatives></inline-formula> sequence-identity cutoff was the lowest cutoff allowed by CD-HIT-EST and has been used previously as an RNA nonredundancy cutoff<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. After removing sequence similarity, 14,565 sequences remained. RNA sequences with RNA structures from the PDB<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> available in this dataset were also removed as we prepared separate datasets based on RNAs with PDB structure only<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Moreover, due to hardware limitations for training on long sequences, the maximum sequence length was restricted to 500. After preprocessing, this dataset contains 13,419 sequences. These sequences were randomly split into 10,814 RNAs for training (TR0), 1300 for validation (VL0), and 1,305 for independent test (TS0). Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref> shows the number of RNA sequences and their Watson–Crick (A–U and G–C), Wobble (G–U), and noncanonical base-pair count as well as the number of base pairs associated with pseudoknots. The average sequence lengths in TR0, VL0, and TS0 are all roughly 130. Here, base pairs associated with pseudoknots are defined as the minimum number of base pairs that can be removed to result in a pseudoknot-free secondary structure. Pseudoknot labels were generated by using software bpRNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/hendrixlab/bpRNA">https://github.com/hendrixlab/bpRNA</ext-link>).</p>
      <p id="Par30">The datasets for transfer learning were obtained by downloading high-resolution (<inline-formula id="IEq101"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M202"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq101.gif"/></alternatives></inline-formula>3.5 Å) RNAs from PDB on March 2, 2019<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Sequences with similarity of more than 80<inline-formula id="IEq102"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M204"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq102.gif"/></alternatives></inline-formula> among these sequences were removed with CD-HIT-EST<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. After removing sequence similarity, only 226 sequences remained. These sequences were randomly split into 120, 30, and 76 RNAs for training (TR1), validation (VL1), and independent test (TS1), respectively. Furthermore, any sequence in TS1 having sequence similarity of more than 80<inline-formula id="IEq103"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M206"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq103.gif"/></alternatives></inline-formula> with TR0 was also removed, which reduced TS1 to 69 RNAs. As CD-HIT-EST can only remove sequences with similarity more than 80<inline-formula id="IEq104"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M208"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq104.gif"/></alternatives></inline-formula>, we employed BLAST-N<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> to further remove potential sequence homologies with training data with a large e-value cutoff of 10. This procedure further decreased TS1 from 69 to 67 RNAs.</p>
      <p id="Par31">To further benchmark RNA secondary-structure predictors, we employed 641 RNA structures solved by NMR. Using CD-HIT-EST with 80<inline-formula id="IEq105"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M210"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq105.gif"/></alternatives></inline-formula> identity cutoff followed by BLAST-N with <italic>e</italic>-value cutoff of 10 against TR0, TR1, and TS1, we obtained 39 NMR-solved structures as TS2.</p>
      <p id="Par32">The secondary structure of all the PDB sets was derived from their respective structures by using DSSR<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> software. For NMR- solved structures, model 1 structure was used as it is considered as the most reliable structure among all. The numbers of canonical, noncanonical, and pseudoknot base pairs, and base multiplets (triplets and quartets) for all the sets are listed in Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>. These datasets along with annotated secondary structure are publicly available at <ext-link ext-link-type="uri" xlink:href="http://sparks-lab.org/jaswinder/server/SPOT-RNA/">http://sparks-lab.org/jaswinder/server/SPOT-RNA/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/jaswindersingh2/SPOT-RNA">https://github.com/jaswindersingh2/SPOT-RNA</ext-link>.</p>
    </sec>
    <sec id="Sec10">
      <title>RNA secondary-structure types</title>
      <p id="Par33">For the classification of different RNA secondary-structure types, we used the same definitions as previously used by bpRNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. A stem is defined as a region of uninterrupted base pairs, with no intervening loops or bulge. A hairpin loop is a sequence of unpaired nucleotides with both ends meeting at the two strands of a stem region. An internal loop is defined as two unpaired strands flanked by closing base pairs on both sides. A bulge is a special case of the internal loop where one of the strands is of length zero. A multiloop consists of a cycle of more than two unpaired strands, connected by stems. The distribution of different secondary-structure types in TR1, VL1, and TS1 (excluding multiplet base pairs) is shown in Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>. These secondary-structure classifications were obtained by using a secondary-structure analysis program bpRNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>.</p>
    </sec>
    <sec id="Sec11">
      <title>Deep neural networks</title>
      <p id="Par34">We employed an ensemble of deep-learning neural networks for pretraining. The ensemble is made of 5 top-ranked models based on their performance on VL0 with the architecture shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, similar to what was used previously for protein contact prediction in SPOT-Contact<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>.</p>
      <p id="Par35">The architecture of each model consists of ResNet blocks followed by a 2D-BLSTM layer and a fully connected (FC) block. An initial convolution layer for pre-activation was used before our ResNet blocks as proposed in He et al.<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. The initial convolution layer is followed by <inline-formula id="IEq106"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{A}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq106.gif"/></alternatives></inline-formula> ResNet blocks (Block A in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Each ResNet block consists of two convolutional layers with a kernel size of <inline-formula id="IEq107"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\times 3$$\end{document}</tex-math><mml:math id="M214"><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\times 5$$\end{document}</tex-math><mml:math id="M216"><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq108.gif"/></alternatives></inline-formula>, respectively, and a depth of <inline-formula id="IEq109"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{\rm{RES}}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RES</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq109.gif"/></alternatives></inline-formula>. The exponential linear units (ELU)<sup><xref ref-type="bibr" rid="CR59">59</xref></sup> activation function and the layer normalization technique<sup><xref ref-type="bibr" rid="CR60">60</xref></sup> were used. A dropout rate of 25<inline-formula id="IEq110"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M220"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq110.gif"/></alternatives></inline-formula> was used before each convolution layer to avoid overfitting during training<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. In some models, we used dilated convolutions that are reported to better learn longer-range dependencies<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>. For the dilated convolutional layers, the dilation factor was set to <inline-formula id="IEq111"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${2}^{i \% n}$$\end{document}</tex-math><mml:math id="M222"><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>%</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq111.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq112"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M224"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq112.gif"/></alternatives></inline-formula> is the depth of the convolution layer, <inline-formula id="IEq113"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M226"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq113.gif"/></alternatives></inline-formula> is a fixed scalar, and <inline-formula id="IEq114"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M228"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq114.gif"/></alternatives></inline-formula> is the modulus operator.</p>
      <p id="Par36">The next block in the architecture was a 2D-BLSTM<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>. The output from the final ResNet block was activated (with ELU) and normalized (using layer normalization) before being given as an input to the 2D-BLSTM. The number of nodes in each LSTM direction cell was <inline-formula id="IEq115"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{BL}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq115.gif"/></alternatives></inline-formula>. After the 2D-BLSTM, <inline-formula id="IEq116"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{B}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq116.gif"/></alternatives></inline-formula> FC layers with <inline-formula id="IEq117"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{FC}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq117.gif"/></alternatives></inline-formula> nodes were used, as per Block B in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The output of each FC layer was activated with the ELU function and normalized by using the layer normalization technique. A dropout rate of 50<inline-formula id="IEq118"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\%$$\end{document}</tex-math><mml:math id="M236"><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq118.gif"/></alternatives></inline-formula> was utilized for the hidden FC layers to avoid overtraining. The final stage of the architecture consisted of an output FC layer with one node and a sigmoidal activation function. The sigmoid function converts the output into the probability of each nucleotide being paired with other nucleotides. The number of outputs was equal to the number of elements in the upper triangular matrix of size <inline-formula id="IEq119"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\times L$$\end{document}</tex-math><mml:math id="M238"><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq119.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq120"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M240"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq120.gif"/></alternatives></inline-formula> is the length of the sequence.</p>
      <p id="Par37">Each model was implemented in Google’s Tensorflow framework (v1.12)<sup><xref ref-type="bibr" rid="CR63">63</xref></sup> and trained by using the ADAM optimization algorithm<sup><xref ref-type="bibr" rid="CR64">64</xref></sup> with default parameters. All models were trained on Nvidia GTX TITAN X graphics processing unit (GPU) to speed up training<sup><xref ref-type="bibr" rid="CR65">65</xref></sup>. We trained multiple deep-learning models, based on the architecture shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, on TR0 by performing a hyperparameter grid search over <inline-formula id="IEq121"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{A}$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq121.gif"/></alternatives></inline-formula>, <inline-formula id="IEq122"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{\rm{RES}}$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RES</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq122.gif"/></alternatives></inline-formula>, <inline-formula id="IEq123"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{\rm{BL}}$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq123.gif"/></alternatives></inline-formula>, <inline-formula id="IEq124"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{B}$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq124.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq125"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{\rm{FC}}$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">FC</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq125.gif"/></alternatives></inline-formula>. <inline-formula id="IEq126"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{A}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq126.gif"/></alternatives></inline-formula>, <inline-formula id="IEq127"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{\rm{RES}}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RES</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq127.gif"/></alternatives></inline-formula>, <inline-formula id="IEq128"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{\rm{BL}}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq128.gif"/></alternatives></inline-formula>, <inline-formula id="IEq129"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{B}$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq129.gif"/></alternatives></inline-formula>, <inline-formula id="IEq130"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{\rm{FC}}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">FC</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq130.gif"/></alternatives></inline-formula> were searched from 16 to 32, 32 to 72, 128 to 256, 0 to 4, and 256 to 512, respectively. These models were optimized on VL0 and tested on TS0. Transfer learning was then used to further train these models on TR1. During transfer learning, VL1 was used as the validation set and TS1 was used as an independent test set.</p>
    </sec>
    <sec id="Sec12">
      <title>Transfer learning</title>
      <p id="Par38">Transfer learning<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> involves further training a large model that was trained on a large dataset for a specific task to some other related task with limited data. In this project, we used our large dataset bpRNA for initial training, and then transfer learning was employed by using the small PDB dataset as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. All of the weights/parameters that were learnt on TR0 were retrained for further training on TR1. During transfer learning, training and validation labels were formatted in exactly the same way as the initial training as a 2-dimensional (2D) <inline-formula id="IEq131"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\times L$$\end{document}</tex-math><mml:math id="M262"><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq131.gif"/></alternatives></inline-formula> upper triangular matrix where <italic>L</italic> is the length of the RNA sequence. All of the labels used during the transfer learning were derived from high-resolution X-ray structures in the PDB. Some approaches in transfer learning freeze weights for specific layers and train for other layers. Here, we trained all the weights of the models without freezing any layer, as this provided better results. Previous work on protein molecular recognition features (MoRFs) prediction<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> also showed that using transfer learning by retraining through all of the weights provides a better result than freezing some of the layers during retraining.</p>
      <p id="Par39">During transfer learning on TS1, we used the same hyperparameters (number of layers, depth of layers, kernel size, dilation factor, and learning rate) that were used for the TS0-trained models. All the models were validated for VL1, and based on the performance of these models on VL1, the 5 best models were selected for the ensemble. The parameters of these models are shown in Supplementary Table <xref rid="MOESM1" ref-type="media">9</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>Input</title>
      <p id="Par40">The input to SPOT-RNA is an RNA sequence represented by a binary one-hot vector of size <italic>L</italic> <inline-formula id="IEq132"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M264"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq132.gif"/></alternatives></inline-formula> 4, where <italic>L</italic> is the length of the RNA sequence and 4 corresponds to the number of base types (A, U, C, G). In one-hot encoding, a value of 1 was assigned to the corresponding base-type position in the vector and 0 elsewhere. A missing or invalid sequence in residue value of −1 was assigned in one-hot encoded vector.</p>
      <p id="Par41">This one-dimensional (<italic>L</italic> <inline-formula id="IEq133"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M266"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq133.gif"/></alternatives></inline-formula> 4) input feature is converted into two dimensional (<italic>L</italic> <inline-formula id="IEq134"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M268"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq134.gif"/></alternatives></inline-formula> <italic>L</italic> <inline-formula id="IEq135"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M270"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq135.gif"/></alternatives></inline-formula> 8) by the outer concatenation function as described in RaptorX-Contact<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. The input is standardized to have zero mean and unit variance (according to the training data) before being fed into the model.</p>
    </sec>
    <sec id="Sec14">
      <title>Output</title>
      <p id="Par42">The output of our model is a 2-dimensional (2D) <inline-formula id="IEq136"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\times L$$\end{document}</tex-math><mml:math id="M272"><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq136.gif"/></alternatives></inline-formula> upper triangular matrix where <italic>L</italic> is the length of the RNA sequence. This upper triangular matrix represents the likelihood of each nucleotide to be paired with any other nucleotide in a sequence. A single threshold value is used to decide whether a nucleotide is in pair with any other nucleotides. The value of the threshold was chosen in such a way that it optimizes the performance on the validation set.</p>
    </sec>
    <sec id="Sec15">
      <title>Performance measure</title>
      <p id="Par43">RNA secondary-structure prediction is a binary classification problem. We used sensitivity, precision, and F1 score for performance measure where sensitivity is the fraction of predicted base pairs in all native base pairs (<inline-formula id="IEq137"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{SN=TP/(TP+FN)}}$$\end{document}</tex-math><mml:math id="M274"><mml:mi mathvariant="normal">SN = TP∕(TP + FN)</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq137.gif"/></alternatives></inline-formula>), precision is the fraction of correctly predicted base pairs (<inline-formula id="IEq138"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{PR=TP/(TP+FP)}}$$\end{document}</tex-math><mml:math id="M276"><mml:mi mathvariant="normal">PR = TP∕(TP + FP)</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq138.gif"/></alternatives></inline-formula>), and F1 score is their harmonic mean (<inline-formula id="IEq139"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{F1=2(PR* SN)/(PR+SN)}}$$\end{document}</tex-math><mml:math id="M278"><mml:mi mathvariant="normal">F1 = 2(PR * SN)∕(PR + SN)</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_13395_Article_IEq139.gif"/></alternatives></inline-formula>). Here, TP, FN, and FP denote true positives, false negatives, and false positives, respectively. In addition to the above metrics that emphasize on positives, a balanced measure, Matthews correlation coefficient (MCC)<sup><xref ref-type="bibr" rid="CR66">66</xref></sup> was also used. MCC is calculated as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{{MCC}}}=\frac{{\mathrm{{TP}}}\times {\mathrm{{TN}}}-{\mathrm{{FP}}}\times {\mathrm{{FN}}}}{\sqrt{({\mathrm{{TP}}}+{\mathrm{{FP}}})({\mathrm{{TP}}}+{\mathrm{{FN}}})({\mathrm{{TN}}}+{\mathrm{{FP}}})({\mathrm{{TN}}}+{\mathrm{{FN}}})}},$$\end{document}</tex-math><mml:math id="M280"><mml:mi mathvariant="normal">MCC</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">TN</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">FP</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">FP</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TN</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">FP</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">TN</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2019_13395_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">where TN denotes true negatives. MCC measures the correlation between the expected class and the obtained class. Moreover, a precision-recall (sensitivity) curve is used to compare our model with currently available RNA secondary-structure predictors. To show the statistical significance of improvement by SPOT-RNA over the second-best predictor, a paired <italic>t</italic> test was used on F1 score to obtain <italic>P</italic> value<sup><xref ref-type="bibr" rid="CR67">67</xref></sup>. The smaller the <italic>P</italic> value is, the more significant the difference between the two predictors. As the output of the SPOT-RNA is a base-pair probability, we can use the ensemble defect as an additional performance metric. The ensemble defect describes the similarity between predicted base-pair probability and target structure<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>. It can be calculated by appending an extra column to the predicted probability matrix and target matrix for unpaired bases. If <italic>P</italic> and <italic>S</italic> are predicted and target structures, respectively, and <italic>P</italic>′ and <italic>S</italic>′ are predicted and target structures after appending the extra column, the ensemble defect (ED) is given by<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{ED}}=1-\frac{1}{L}\sum _{\begin{array}{c}i=1:L\\ j=1:L+1\end{array}}{P}_{ij}^{^{\prime} }{S}_{ij}^{^{\prime} },$$\end{document}</tex-math><mml:math id="M282"><mml:mi mathvariant="normal">ED</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>L</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2019_13395_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par45">where <italic>L</italic> is the length of the sequence. The smaller the value of ED is, the higher the structural similarity between predicted base-pair probability and target structure.</p>
    </sec>
    <sec id="Sec16">
      <title>Methods comparison</title>
      <p id="Par46">We compared SPOT-RNA with 12 best available predictors. We downloaded the stand-alone version of mxfold<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/keio-bioinformatics/mxfold">https://github.com/keio-bioinformatics/mxfold</ext-link>), ContextFold<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://www.cs.bgu.ac.il/negevcb/contextfold/">https://www.cs.bgu.ac.il/negevcb/contextfold/</ext-link>), CONTRAfold<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="http://contra.stanford.edu/contrafold/">http://contra.stanford.edu/contrafold/</ext-link>), Knotty<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HosnaJabbari/Knotty">https://github.com/HosnaJabbari/Knotty</ext-link>), IPknot<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="http://rtips.dna.bio.keio.ac.jp/ipknot/">http://rtips.dna.bio.keio.ac.jp/ipknot/</ext-link>), RNAfold<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://www.tbi.univie.ac.at/RNA/">https://www.tbi.univie.ac.at/RNA/</ext-link>), ProbKnot<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="http://rna.urmc.rochester.edu/RNAstructure.html">http://rna.urmc.rochester.edu/RNAstructure.html</ext-link>), CentroidFold<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/satoken/centroid-rna-package">https://github.com/satoken/centroid-rna-package</ext-link>), RNAstructure<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="http://rna.urmc.rochester.edu/RNAstructure.html">http://rna.urmc.rochester.edu/RNAstructure.html</ext-link>), RNAshapes<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://bibiserv.cebitec.uni-bielefeld.de/rnashapes">https://bibiserv.cebitec.uni-bielefeld.de/rnashapes</ext-link>), pkiss<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="https://bibiserv.cebitec.uni-bielefeld.de/pkiss">https://bibiserv.cebitec.uni-bielefeld.de/pkiss</ext-link>), and CycleFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> (available at <ext-link ext-link-type="uri" xlink:href="http://rna.urmc.rochester.edu/RNAstructure.html">http://rna.urmc.rochester.edu/RNAstructure.html</ext-link>). In most of the cases, we used default parameters for secondary-structure prediction except for pkiss. In pkiss, we used Strategy C that is slow but thorough in comparison with Strategies A and B that are fast but less accurate. For CONTRAfold and CentroidFold their performance metrics are derived from their predicted base-pair probabilities with threshold values from maximizing MCC.</p>
    </sec>
    <sec id="Sec17">
      <title>Reporting summary</title>
      <p id="Par47">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2019_13395_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2019_13395_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic> Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-13395-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by Australia Research Council DP180102060 to Y.Z. and K.P. and in part by National Health and Medical Research Council (1,121,629) of Australia to Y.Z. We also gratefully acknowledge the use of the High Performance Computing Cluster Gowonda to complete this research, and the aid of the research cloud resources provided by the Queensland CyberInfrastructure Foundation (QCIF). We gratefully acknowledge the support of NVIDIA Corporation with the donation of the Titan V GPU used for this research.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.S., J.H., and K.P. designed the network architectures, J.S. prepared the data, did the data analysis, and wrote the paper. J.S. and J.H. performed the training and testing of the algorithms. Y.Z. conceived of the study, participated in the initial design, assisted in data analysis, and drafted the whole paper. All authors read, contributed to the discussion, and approved the final paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The data used by SPOT-RNA for initial training (bpRNA)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> and transfer learning (PDB)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> along with their annotated secondary structure are publicly available at <ext-link ext-link-type="uri" xlink:href="http://sparks-lab.org/jaswinder/server/SPOT-RNA/">http://sparks-lab.org/jaswinder/server/SPOT-RNA/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/jaswindersingh2/SPOT-RNA">https://github.com/jaswindersingh2/SPOT-RNA</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>SPOT-RNA predictor is available as a server at <ext-link ext-link-type="uri" xlink:href="http://sparks-lab.org/jaswinder/server/SPOT-RNA/">http://sparks-lab.org/jaswinder/server/SPOT-RNA/</ext-link> and stand-alone software at <ext-link ext-link-type="uri" xlink:href="https://github.com/jaswindersingh2/SPOT-RNA">https://github.com/jaswindersingh2/SPOT-RNA</ext-link> to run on a local computer. The web server provides an arc diagram and a 2D diagram of predicted RNA secondary structure through Visualization Applet for RNA (VARNA)<sup><xref ref-type="bibr" rid="CR69">69</xref></sup> tool along with a dot plot of SPOT-RNA-predicted base-pair probabilities.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par48">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tinoco</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>How RNA folds</article-title>
        <source>J. Mol. Biol.</source>
        <year>1999</year>
        <volume>293</volume>
        <fpage>271</fpage>
        <lpage>281</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1999.3001</pub-id>
        <?supplied-pmid 10550208?>
        <pub-id pub-id-type="pmid">10550208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bevilacqua</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Ritchey</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Assmann</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of RNA secondary structure</article-title>
        <source>Annu. Rev. Genet.</source>
        <year>2016</year>
        <volume>50</volume>
        <fpage>235</fpage>
        <lpage>266</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genet-120215-035034</pub-id>
        <?supplied-pmid 27648642?>
        <pub-id pub-id-type="pmid">27648642</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNA structure through multidimensional chemical mapping</article-title>
        <source>Q. Rev. Biophys.</source>
        <year>2016</year>
        <volume>49</volume>
        <fpage>e7</fpage>
        <pub-id pub-id-type="doi">10.1017/S0033583516000020</pub-id>
        <?supplied-pmid 27266715?>
        <pub-id pub-id-type="pmid">27266715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">RNAcentral: a comprehensive database of non-coding RNA sequences. <italic>Nucleic Acids Res.</italic> 45, D128–D134 (2016).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rose</surname>
            <given-names>PW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The RCSB protein data bank: integrative view of protein, gene and 3D structural information</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>45</volume>
        <fpage>D271</fpage>
        <lpage>D281</lpage>
        <?supplied-pmid 5210513?>
        <pub-id pub-id-type="pmid">27794042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>The four ingredients of single-sequence RNA secondary structure prediction. A unifying perspective</article-title>
        <source>RNA Biol.</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1185</fpage>
        <lpage>1196</lpage>
        <pub-id pub-id-type="doi">10.4161/rna.24971</pub-id>
        <?supplied-pmid 3849167?>
        <pub-id pub-id-type="pmid">23695796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gutell</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Cannone</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>The accuracy of ribosomal RNA comparative structure models</article-title>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>301</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1016/S0959-440X(02)00339-1</pub-id>
        <pub-id pub-id-type="pmid">12127448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khanna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Rfam: an RNA family database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>439</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg006</pub-id>
        <?supplied-pmid 165453?>
        <pub-id pub-id-type="pmid">12520045</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stiegler</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1981</year>
        <volume>9</volume>
        <fpage>133</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/9.1.133</pub-id>
        <?supplied-pmid 326673?>
        <pub-id pub-id-type="pmid">6163133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Schroeder, S. J. and Turner, D. H. Chapter 17—Optical Melting Measurements of Nucleic Acid Thermodynamics. In <italic>Biophysical, Chemical, and Functional Probes of RNA Structure, Interactions and Folding: Part A</italic>, vol. 468 of <italic>Methods in Enzymology</italic>, 371–387 (Academic Press, 2009).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ViennaRNA Package 2.0</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id>
        <?supplied-pmid 3319429?>
        <pub-id pub-id-type="pmid">22115189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reuter</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>RNAstructure: software for RNA secondary structure prediction and analysis</article-title>
        <source>BMC Bioinforma.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>129</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janssen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The RNA shapes studio</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>423</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu649</pub-id>
        <?supplied-pmid 4308662?>
        <pub-id pub-id-type="pmid">25273103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CONTRAfold: RNA secondary structure prediction without physics-based models</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>e90</fpage>
        <lpage>e98</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl246</pub-id>
        <pub-id pub-id-type="pmid">16873527</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hamada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mituyama</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>CentroidFold: a web server for RNA secondary structure prediction</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>W277</fpage>
        <lpage>W280</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp367</pub-id>
        <?supplied-pmid 2703931?>
        <pub-id pub-id-type="pmid">19435882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zakov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Goldberg</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Elhadad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ziv-ukelson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Rich parameterization improves RNA structure prediction</article-title>
        <source>J. Computational Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1525</fpage>
        <lpage>1542</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0184</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Seetin, M. G. and Mathews, D. H. RNA Structure prediction: an overview of methods. In (ed Keiler, K. C.) <italic>Bacterial Regulatory RNA: Methods and Protocols</italic>, 99–122 (Humana Press, Totowa, NJ, 2012). 10.1007/978-1-61779-949-5_8.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S-J</given-names>
          </name>
        </person-group>
        <article-title>Physics-based RNA structure prediction</article-title>
        <source>Biophysics Rep.</source>
        <year>2015</year>
        <volume>1</volume>
        <fpage>2</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1007/s41048-015-0001-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nowakowski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tinoco</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>RNA structure and stability</article-title>
        <source>Semin. Virol.</source>
        <year>1997</year>
        <volume>8</volume>
        <fpage>153</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="doi">10.1006/smvy.1997.0118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Westhof</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fritsch</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>RNA folding: beyond Watson-Crick pairs</article-title>
        <source>Structure</source>
        <year>2000</year>
        <volume>8</volume>
        <fpage>R55</fpage>
        <lpage>R65</lpage>
        <pub-id pub-id-type="doi">10.1016/S0969-2126(00)00112-X</pub-id>
        <pub-id pub-id-type="pmid">10745012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Design, implementation and evaluation of a practical pseudoknot folding algorithm based on thermodynamics</article-title>
        <source>BMC Bioinforma.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>104</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bellaousov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>ProbKnot: fast prediction of RNA secondary structure including pseudoknots</article-title>
        <source>RNA</source>
        <year>2010</year>
        <volume>16</volume>
        <fpage>1870</fpage>
        <lpage>1880</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.2125310</pub-id>
        <?supplied-pmid 2941096?>
        <pub-id pub-id-type="pmid">20699301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kato</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hamada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Akutsu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>IPknot: fast and accurate prediction of RNA secondary structures with pseudoknots using integer programming</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>i85</fpage>
        <lpage>i93</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr215</pub-id>
        <?supplied-pmid 3117384?>
        <pub-id pub-id-type="pmid">21685106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jabbari</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wark</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Montemagno</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Knotty: efficient and accurate prediction of complex RNA pseudoknot structures</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3849</fpage>
        <lpage>3856</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty420</pub-id>
        <pub-id pub-id-type="pmid">29868872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The MC-fold and MC-sym pipeline infers RNA structure from sequence data</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>51</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06684</pub-id>
        <pub-id pub-id-type="pmid">18322526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>zu Siederdissen</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>A folding algorithm for extended RNA secondary structures</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>i129</fpage>
        <lpage>i136</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr220</pub-id>
        <?supplied-pmid 3117358?>
        <pub-id pub-id-type="pmid">21685061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sloma</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Base pair probability estimates improve the prediction accuracy of RNA non-canonical base pairs</article-title>
        <source>PLOS Comput. Biol.</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Accurate de novo prediction of protein contact map by ultra-deep learning model</article-title>
        <source>PLOS Comput. Biol.</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paliwal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Litfin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Accurate prediction of protein contact maps by coupling residual two-dimensional bidirectional long short-term memory with convolutional neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>4039</fpage>
        <lpage>4045</lpage>
        <pub-id pub-id-type="pmid">29931279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">He, K., Zhang, X., Ren, S. and Sun, J. Identity mappings in deep residual networks. In (eds Leibe, B., Matas, J., Sebe, N. and Welling, M.) <italic>Computer Vision—ECCV 2016</italic>, 630–645 (Springer International Publishing, Cham, 2016).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schmidhuber</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Long short-term memory</article-title>
        <source>Neural Comput.</source>
        <year>1997</year>
        <volume>9</volume>
        <fpage>1735</fpage>
        <lpage>1780</lpage>
        <pub-id pub-id-type="doi">10.1162/neco.1997.9.8.1735</pub-id>
        <?supplied-pmid 9377276?>
        <pub-id pub-id-type="pmid">9377276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paliwal</surname>
            <given-names>KK</given-names>
          </name>
        </person-group>
        <article-title>Bidirectional recurrent neural networks</article-title>
        <source>IEEE Trans. Signal Process.</source>
        <year>1997</year>
        <volume>45</volume>
        <fpage>2673</fpage>
        <lpage>2681</lpage>
        <pub-id pub-id-type="doi">10.1109/78.650093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akiyama</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A max-margin training of RNA secondary structure prediction integrated with the thermodynamic model</article-title>
        <source>J. Bioinforma. Comput. Biol.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>1840025</fpage>
        <pub-id pub-id-type="doi">10.1142/S0219720018400255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danaee</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>bpRNA: large-scale automated annotation and analysis of RNA secondary structure</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>5381</fpage>
        <lpage>5394</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky285</pub-id>
        <?supplied-pmid 29746666?>
        <pub-id pub-id-type="pmid">29746666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>A Survey on Transfer Learning</article-title>
        <source>IEEE Trans. Knowl. Data Eng.</source>
        <year>2010</year>
        <volume>22</volume>
        <fpage>1345</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="doi">10.1109/TKDE.2009.191</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Hanson, J., Litfin, T., Paliwal, K. and Zhou, Y. Identifying molecular recognition features in intrinsically disordered regions of proteins by transfer learning. <italic>Bioinformatics</italic>. 10.1093/bioinformatics/btz691 (2019).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3150</fpage>
        <lpage>3152</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id>
        <?supplied-pmid 3516142?>
        <pub-id pub-id-type="pmid">23060610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-scale characterization of RNA tertiary structures and their functional impact by RNA solvent accessibility prediction</article-title>
        <source>RNA</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>14</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.057364.116</pub-id>
        <?supplied-pmid 27807179?>
        <pub-id pub-id-type="pmid">27807179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guruge</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Taherzadeh</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>B-factor profile prediction for RNA flexibility using support vector machines</article-title>
        <source>J. Comput. Chem.</source>
        <year>2018</year>
        <volume>39</volume>
        <fpage>407</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.25124</pub-id>
        <?supplied-pmid 29164646?>
        <pub-id pub-id-type="pmid">29164646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
        <?supplied-pmid 146917?>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liberman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Salim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krucinska</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wedekind</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Structure of a class II preQ1 riboswitch reveals ligand recognition by a new fold</article-title>
        <source>Nat. Chem. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>353 EP</fpage>
        <pub-id pub-id-type="doi">10.1038/nchembio.1231</pub-id>
        <pub-id pub-id-type="pmid">23584677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goto-Ito</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ito</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kuratani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bessho</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yokoyama</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Tertiary structure checkpoint at anticodon loop modification in tRNA functional maturation</article-title>
        <source>Nat. Struct. Amp; Mol. Biol.</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1109 EP</fpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.1653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yesselman</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational design of three-dimensional RNA structure and function</article-title>
        <source>Nat. Nanotechnol.</source>
        <year>2019</year>
        <volume>14</volume>
        <fpage>866</fpage>
        <lpage>873</lpage>
        <pub-id pub-id-type="doi">10.1038/s41565-019-0517-8</pub-id>
        <pub-id pub-id-type="pmid">31427748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Watkins</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lilley</surname>
            <given-names>DMJ</given-names>
          </name>
        </person-group>
        <article-title>Structure and ligand binding of the glutamine-II riboswitch</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>7666</fpage>
        <lpage>7675</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz539</pub-id>
        <?supplied-pmid 6698751?>
        <pub-id pub-id-type="pmid">31216023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hatchet ribozyme structure and implications for cleavage mechanism</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>10783</fpage>
        <lpage>10791</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1902413116</pub-id>
        <pub-id pub-id-type="pmid">31088965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>TJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of the structures and mechanisms of the Pistol and Hammerhead ribozymes</article-title>
        <source>J. Am. Chem. Soc.</source>
        <year>2019</year>
        <volume>141</volume>
        <fpage>7865</fpage>
        <lpage>7875</lpage>
        <pub-id pub-id-type="doi">10.1021/jacs.9b02141</pub-id>
        <?supplied-pmid 6523996?>
        <pub-id pub-id-type="pmid">31017785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trachman</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure and functional reselection of the Mango-III fluorogenic RNA aptamer</article-title>
        <source>Nat. Chem. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>472</fpage>
        <lpage>479</lpage>
        <pub-id pub-id-type="doi">10.1038/s41589-019-0267-9</pub-id>
        <pub-id pub-id-type="pmid">30992561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hood</surname>
            <given-names>IV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Crystal structure of an adenovirus virus-associated RNA</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2871</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10752-6</pub-id>
        <?supplied-pmid 6599070?>
        <pub-id pub-id-type="pmid">31253805</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Remmert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Biegert</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>
        <source>Nat. Methods</source>
        <year>2011</year>
        <volume>9</volume>
        <fpage>173</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1818</pub-id>
        <pub-id pub-id-type="pmid">22198341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Leonardis</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct-Coupling Analysis of nucleotide coevolution facilitates RNA secondary and tertiary structure prediction</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>10444</fpage>
        <lpage>10455</lpage>
        <?supplied-pmid 4666395?>
        <pub-id pub-id-type="pmid">26420827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heffernan</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-sequence-based prediction of protein secondary structures and solvent accessibility by deep whole-sequence learning</article-title>
        <source>J. Comput. Chem.</source>
        <year>2018</year>
        <volume>39</volume>
        <fpage>2210</fpage>
        <lpage>2216</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.25534</pub-id>
        <pub-id pub-id-type="pmid">30368831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paliwal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Accurate single-sequence prediction of protein intrinsic disorder by an ensemble of deep recurrent and convolutional architectures</article-title>
        <source>J. Chem. Inf. Model.</source>
        <year>2018</year>
        <volume>58</volume>
        <fpage>2369</fpage>
        <lpage>2376</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.8b00636</pub-id>
        <pub-id pub-id-type="pmid">30395465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles Round III: 3D RNA structure prediction of five riboswitches and one ribozyme</article-title>
        <source>RNA</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>655</fpage>
        <lpage>672</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.060368.116</pub-id>
        <?supplied-pmid 5393176?>
        <pub-id pub-id-type="pmid">28138060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Rabani, M., Kertesz, M. and Segal, E. Computational prediction of RNA structural motifs involved in post-transcriptional regulatory processes. In (ed Gerst, J. E.) <italic>RNA Detection and Visualization: Methods and Protocols</italic>, 467–479 (Humana Press, 2011).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Achar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sætrom</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>RNA motif discovery: a computational overview</article-title>
        <source>Biol. Direct</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>61</fpage>
        <pub-id pub-id-type="doi">10.1186/s13062-015-0090-5</pub-id>
        <?supplied-pmid 4600295?>
        <pub-id pub-id-type="pmid">26453353</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2933</fpage>
        <lpage>2935</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id>
        <?supplied-pmid 3810854?>
        <pub-id pub-id-type="pmid">24008419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schlick</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pyle</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Opportunities and challenges in RNA structural modeling and design</article-title>
        <source>Biophys. J.</source>
        <year>2017</year>
        <volume>113</volume>
        <fpage>225</fpage>
        <lpage>234</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2016.12.037</pub-id>
        <?supplied-pmid 5529161?>
        <pub-id pub-id-type="pmid">28162235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>X-J</given-names>
          </name>
          <name>
            <surname>Bussemaker</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>DSSR: an integrated software tool for dissecting the spatial structure of RNA</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>e142</fpage>
        <lpage>e142</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv541</pub-id>
        <?supplied-pmid 4666379?>
        <pub-id pub-id-type="pmid">26184874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Clevert, D.-A., Unterthiner, T. and Hochreiter, S. <italic>Fast and Accurate Deep Network Learning by Exponential Linear Units (ELUs)</italic>. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1511.07289">https://arxiv.org/abs/1511.07289</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Ba, J. L., Kiros, J. R. and Hinton, G. E. <italic>Layer Normalization</italic>. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1607.06450">https://arxiv.org/abs/1607.06450</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Krizhevsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sutskever</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Salakhutdinov</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Dropout: a simple way to prevent neural networks from overfitting</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>1929</fpage>
        <lpage>1958</lpage>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Bai, S., Kolter, J. Z. and Koltun, V. An empirical evaluation of generic convolutional and recurrent networks for sequence modeling. <italic>CoRR</italic><bold>abs/1803.01271</bold> (2018).</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Abadi, M. et al. TensorFlow: A System for Large-Scale Machine Learning. In <italic>12th USENIX Symposium on Operating Systems Design and Implementation (OSDI 16)</italic>, 265–283 (USENIX Association, Savannah, GA, 2016). <ext-link ext-link-type="uri" xlink:href="https://www.usenix.org/conference/osdi16/technical-sessions/presentation/abadi">https://www.usenix.org/conference/osdi16/technical-sessions/presentation/abadi</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Kingma, D. P. and Ba, J. <italic>Adam: A Method for Stochastic Optimization</italic>. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1412.6980">https://arxiv.org/abs/1412.6980</ext-link> (2014).</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oh</surname>
            <given-names>K-S</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>GPU implementation of neural networks</article-title>
        <source>Pattern Recognit.</source>
        <year>2004</year>
        <volume>37</volume>
        <fpage>1311</fpage>
        <lpage>1314</lpage>
        <pub-id pub-id-type="doi">10.1016/j.patcog.2004.01.013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matthews</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>
        <source>Biochim. Biophys. Acta</source>
        <year>1975</year>
        <volume>405</volume>
        <fpage>442</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1016/0005-2795(75)90109-9</pub-id>
        <pub-id pub-id-type="pmid">1180967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Lovric, M. (ed.) <italic>International Encyclopedia of Statistical Science</italic> (Springer, Berlin Heidelberg, 2011). 10.1007/978-3-642-04898-2</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Describing the structural diversity within an RNAas ensemble</article-title>
        <source>Entropy</source>
        <year>2014</year>
        <volume>16</volume>
        <fpage>1331</fpage>
        <lpage>1348</lpage>
        <pub-id pub-id-type="doi">10.3390/e16031331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darty</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Denise</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ponty</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>VARNA: Interactive drawing and editing of the RNA secondary structure</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1974</fpage>
        <lpage>1975</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp250</pub-id>
        <?supplied-pmid 2712331?>
        <pub-id pub-id-type="pmid">19398448</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
