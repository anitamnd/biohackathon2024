<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6385470</article-id>
    <article-id pub-id-type="publisher-id">1641</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1641-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>dStruct: identifying differentially reactive regions from RNA structurome profiling data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Choudhary</surname>
          <given-names>Krishna</given-names>
        </name>
        <address>
          <email>kchoudhary@ucdavis.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lai</surname>
          <given-names>Yu-Hsuan</given-names>
        </name>
        <address>
          <email>lai64@purdue.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tran</surname>
          <given-names>Elizabeth J.</given-names>
        </name>
        <address>
          <email>ejtran@purdue.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1872-9820</contrib-id>
        <name>
          <surname>Aviran</surname>
          <given-names>Sharon</given-names>
        </name>
        <address>
          <email>saviran@ucdavis.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9684</institution-id><institution-id institution-id-type="GRID">grid.27860.3b</institution-id><institution>Department of Biomedical Engineering and Genome Center, </institution><institution>University of California, Davis, </institution></institution-wrap>One Shields Avenue, Davis, 95616 CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 2197</institution-id><institution-id institution-id-type="GRID">grid.169077.e</institution-id><institution>Department of Biochemistry, </institution><institution>Purdue University, </institution></institution-wrap>BCHM 305, 175 S. University Street, West Lafayette, 47907-2063 IN USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 2197</institution-id><institution-id institution-id-type="GRID">grid.169077.e</institution-id><institution>Purdue University Center for Cancer Research, Purdue University, </institution></institution-wrap>Hansen Life Sciences Research Building, Room 141, 201 S. University Street, West Lafayette, 47907-2064 IN USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>40</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>1</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>RNA biology is revolutionized by recent developments of diverse high-throughput technologies for transcriptome-wide profiling of molecular RNA structures. RNA structurome profiling data can be used to identify differentially structured regions between groups of samples. Existing methods are limited in scope to specific technologies and/or do not account for biological variation. Here, we present dStruct which is the first broadly applicable method for differential analysis accounting for biological variation in structurome profiling data. dStruct is compatible with diverse profiling technologies, is validated with experimental data and simulations, and outperforms existing methods.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-019-1641-3) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA structure</kwd>
      <kwd>Structure probing</kwd>
      <kwd>Differential analysis</kwd>
      <kwd>Transcriptome-wide profiling</kwd>
      <kwd>SHAPE</kwd>
      <kwd>DMS</kwd>
      <kwd>PARS</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R00-HG006860</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM097332</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P30-CA023168</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100013415</institution-id>
            <institution>Purdue University Center for Cancer Research</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>RNA molecules adopt diverse and intricate structures, which confer on them the capacity to perform key roles in myriads of cellular processes [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Structures, and hence functions, of RNAs are modulated by a number of factors, such as solution environment (in vivo or in vitro), presence of RNA-binding proteins or ligands, mutation in the RNA sequence, and temperature [<xref ref-type="bibr" rid="CR3">3</xref>]. The amalgamation of classic chemical probing methods, which probe RNA structure at nucleotide resolution, with next-generation sequencing has ushered in a new era of RNA structuromics [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. In fact, recent developments have led to a diversity of structure probing or structure profiling (SP) technologies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. These technologies have made it possible to perform comparative analysis of structures of select RNAs or whole RNA structuromes simultaneously [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p>SP technologies result in nucleotide-level scores, called as <italic>reactivities</italic>, that summarize one or more aspects of local structure (e.g., steric constraint due to base pairing interaction). To this end, they utilize probing reagents that react with RNA nucleotides in a structure-sensitive manner. The degree of reaction at a nucleotide is a function of local stereochemistry. A number of reagents (e.g., SHAPE, DMS, nucleases) exist, which react with sensitivity to different aspects of local stereochemistry [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref>]. Moreover, depending on the reagent, the reaction results either in chemical modification of the sugar/base moiety or a cleavage of the RNA strand. Its degree is captured in a cDNA library through primer extension by reverse transcriptase, which either stops at modified nucleotides or proceeds but introduces a mutation [<xref ref-type="bibr" rid="CR3">3</xref>]. In addition, to assess the background noise, most SP technologies use samples that are not treated with reagent [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref>]. Furthermore, there are diverse library preparation methods. For example, some methods enrich for modified transcript copies [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Indeed, SP technologies differ in their choices of probing reagents and key library preparation steps. Yet, each technology has its advantages, which might make it the preferred choice for certain studies. Irrespective of the SP technology and end goals of a study, cDNA libraries are sequenced and data is processed to obtain reactivities. Often, this involves combining information from the treated and untreated control samples [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR32">32</xref>]. The sequence of nucleotide reactivities for a transcript is called its <italic>reactivity profile</italic>. It is noteworthy that reactivity profiles are estimated using approaches customized to the SP technology used for a study [<xref ref-type="bibr" rid="CR6">6</xref>]. Hence, different approaches yield reactivities with different statistical properties [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. Nonetheless, amid the diversity of protocols and reactivity estimation methods, identifying differentially reactive regions (DRRs) is a common step in the majority of SP studies [<xref ref-type="bibr" rid="CR6">6</xref>]. In this article, we focus on identifying DRRs from SP data.</p>
    <p>Several methods have been developed for differential analysis of SP data [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. They utilize two common principles. First, they premise that differential structure manifests at a regional level and not at individual isolated nucleotides. Second, they recognize that SP data manifests substantial noise at the nucleotide level. Despite these shared principles, these methods differ in how they account for noise in the data. deltaSHAPE [<xref ref-type="bibr" rid="CR8">8</xref>] and StrucDiff [<xref ref-type="bibr" rid="CR9">9</xref>] address nucleotide-level noise by smoothing reactivity or count profiles. Subsequently, they find DRRs from smoothed profiles. Note that we call the method developed by Wan et al. StrucDiff after the name of the score it employs. In contrast, the method included in the PARCEL pipeline assesses the significance of changes in counts at the nucleotide level first. It considers nucleotides as “genes” in an RNA-seq model. To this end, it uses edgeR [<xref ref-type="bibr" rid="CR36">36</xref>] to account for nucleotide-level noise and compute <italic>p</italic> values for changes in counts. Next, it chains together nucleotides with significant changes as DRRs by performing a second statistical test [<xref ref-type="bibr" rid="CR21">21</xref>] (henceforth, we refer to this method as PARCEL). Similarly, Mizrahi et al. account for nucleotide-level noise with a two-step “regression and spatial analysis” approach [<xref ref-type="bibr" rid="CR20">20</xref>] (for convenience, we acronymize this method as RASA). Specifically, to evaluate the changes in reactivities at the nucleotide level, they use generalized mixed model extension of logistic regression with counts and coverages as inputs. Next, they identify the regions with clusters of differentially reactive nucleotides using a permutation test. Another method, classSNitch, utilizes a machine learning classifier that learns from training data how to distinguish between nucleotide-level noise and DRRs [<xref ref-type="bibr" rid="CR35">35</xref>].</p>
    <p>Despite notable developments in existing methods, several key challenges remain unaddressed. First, it is known that different regions in RNAs manifest different levels of variation among biological replicates (henceforth, called biological variation) [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR37">37</xref>–<xref ref-type="bibr" rid="CR40">40</xref>]. Hence, inherently variable regions should be distinguished from DRRs. Indeed, DRRs are expected to differ consistently between the two groups of samples distinguished by a structure-altering factor. Furthermore, between-group variation in DRRs should significantly exceed the variation between samples of the same group. However, deltaSHAPE, StrucDiff,and classSNitch do not account for biological variation. While PARCEL and RASA account for biological variation, they are limited in scope to specific technologies. One issue that underlies this limitation is that they do not utilize untreated samples. Yet, untreated samples are an integral component of most SP technologies [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref>]. Importantly, combining information from both treated and untreated samples has been shown to provide accurate assessment of reactivities [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR32">32</xref>]. Furthermore, broadly applicable approaches for estimating reactivities combine information from the two kinds of samples and yield analog reactivity values [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. As PARCEL and RASA are based on counts, they are not readily applicable to analog reactivity readouts. Besides this, PARCEL does not account for coverage variations within a transcript. Second, in many studies, candidate regions, which might be DRRs, are not known a priori [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. Hence, they need to be constructed de novo. However, StrucDiff and classSNitch require predefined regions, which are typically obtained from a collateral study. For example, a collateral study might indicate sites with single-nucleotide variants between two cell lines, and candidate regions might be constructed as short stretches of nucleotides flanking each variant [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Third, searching for DRRs in transcriptome-wide data might involve testing multiple hypotheses. While each hypothesis considers the same question about the presence/absence of a differential signal, a separate test might be conducted for each candidate region of each candidate RNA. This leads to the so-called multiple testing problem [<xref ref-type="bibr" rid="CR41">41</xref>]. Since no hypothesis test is perfect, there is a risk of false positive from each test. When we test numerous hypotheses on a dataset simultaneously, the associated risk of false-positive results grows. Hence, it is recommended that <italic>p</italic> values (or alternative summaries of statistical significance) assessed from each test be adjusted to control for the risk of false discoveries. However, deltaSHAPE, classSNitch, and RASA do not perform multiple testing correction. Fourth, if candidate regions were known a priori, restricting search of DRRs to the predefined candidates before statistical testing might improve power in the context of multiple testing [<xref ref-type="bibr" rid="CR41">41</xref>]. We call this scenario <italic>guided</italic><italic>discovery</italic>. However, deltaSHAPE, PARCEL, and RASA allow for comparison with a priori knowledge only after de novo discovery of DRRs. Fifth, of significance in SP data is the “pattern” of reactivities in a region [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR45">45</xref>]. Specifically, in a DRR, while some nucleotides could become more reactive, others could become less reactive, thereby keeping the average level insignificantly altered while altering the reactivity pattern in that region [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. For example, this could be indicative of a hairpin transitioning to a G-quadruplex [<xref ref-type="bibr" rid="CR47">47</xref>]. Indeed, in a study assessing how experts classify the differences in reactivity profiles by visual inspection, reactivity pattern was found to be key to human decision [<xref ref-type="bibr" rid="CR35">35</xref>]. However, none of the methods except for classSNitch explicitly account for reactivity patterns. While classSNitch accounts for reactivity patterns, it utilizes a classifier trained with SHAPE data only. Hence, it is limited in scope to SHAPE data. Finally, the need to account for reactivity patterns limits the applicability of differential analysis methods commonly used in other genomic disciplines (e.g., differential methylation analysis from bisulfite sequencing data). These methods generally seek regional changes in the signal’s magnitude and not the signal’s pattern [<xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR49">49</xref>]. Yet, it has been demonstrated that specialized methods accounting for signal patterns in ChIP-seq and bisulfite sequencing data can improve power to detect differential regions [<xref ref-type="bibr" rid="CR50">50</xref>, <xref ref-type="bibr" rid="CR51">51</xref>].</p>
    <p>To address the aforementioned limitations of existing methods, we present dStruct, which identifies DRRs from SP data within a single RNA or a transcriptome. Central to dStruct is a dissimilarity measure, called <italic>d</italic> score. dStruct starts by assessing within-group and between-group variations in reactivities, in terms of nucleotide <italic>d</italic> scores (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>a, b). Due to the effect of structure-altering factors in DRRs, the between-group variation is expected to be higher than the within-group variation (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Hence, next, dStruct screens for regions with evidence of increased <italic>d</italic> scores between groups. This step is skipped if a predefined set of candidate regions is available. Finally, dStruct compares the within-group nucleotide <italic>d</italic> scores with the between-group scores using Wilcoxon signed-rank test and controls the FDR using the Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="CR52">52</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. dStruct is the first differential analysis method that both directly accounts for biological variation and is applicable to diverse SP protocols. We validated dStruct with data from different SP technologies, namely, SHAPE-Seq, Structure-Seq, and PARS, as well as with simulations. Test datasets vary in size from single RNAs to transcriptomes and feature samples from bacteria, virus, fungi, and humans. In addition, the structure-altering factors include protein binding, ligand binding, and single-nucleotide variants. Besides utilizing real data, we developed a novel approach to simulate biological replicates of SP data. In particular, existing approaches do not provide a way to generate correlated biological replicates [<xref ref-type="bibr" rid="CR54">54</xref>, <xref ref-type="bibr" rid="CR55">55</xref>]. We addressed this gap to allow for proper assessment of dStruct’s performance. dStruct enables guided as well as de novo discovery. In all tests, we demonstrate that for a properly controlled FDR, dStruct has a higher power than existing methods. Besides validations, we discuss in detail the limitations of dStruct as well as of existing approaches.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The <italic>d</italic> score quantifies the dissimilarity between reactivities. <bold>a</bold> Four hypothetical reactivity profiles, labeled A1 and A2 (group A) and B1 and B2 (group B). Red lines highlight the reactivity patterns. Triangles mark a nucleotide that maintains identical reactivities within groups. Asterisks mark a nucleotide that flips its reactivity between groups. <bold>b</bold> Comparison of samples from the same group (e.g., A1, A2) results in <italic>d</italic> scores lower than those from between-group comparisons (e.g., A1, B1). A triangle highlights the low <italic>d</italic> score of a nucleotide with high within-group agreement. An asterisk highlights a nucleotide that displays high within-group agreement and therefore results in a low within-group <italic>d</italic> score. It also displays poor between-group agreement, which results in a high between-group <italic>d</italic> score. <bold>c</bold> The <italic>d</italic> score monotonically increases with the absolute value of coefficient of variation</p></caption><graphic xlink:href="13059_2019_1641_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>dStruct identifies differentially reactive regions. <bold>a</bold> Users input samples of reactivity profiles, some from group A and some from group B. <bold>b</bold> In the first step, dStruct quantifies the within-group and between-group variations in terms of <italic>d</italic> scores. <bold>c</bold> In the second step, dStruct identifies regions where the between-group variation appears to be greater than the within-group variation. These are highlighted by purple background. This step is skipped if users provide a list of candidate regions. <bold>d</bold> Reactivity profiles for one of the candidate regions. <bold>e</bold> In the third step, dStruct compares the <italic>d</italic><sub>within</sub> and <italic>d</italic><sub>between</sub> profiles using a Wilcoxon signed-rank test. <bold>f</bold> The results are output as a list of region identifiers, such as the start and end locations of the candidates tested, and the <italic>p</italic> values and <italic>q</italic> values for each region</p></caption><graphic xlink:href="13059_2019_1641_Fig2_HTML" id="MO2"/></fig>
</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Dissimilarity measure</title>
      <p>We define a dissimilarity measure for reactivities, which we call a <italic>d</italic> score. Given a transcript of length <italic>n</italic> and a set of <italic>m</italic> reactivity profiles for the transcript, let <italic>r</italic><sub><italic>ij</italic></sub> represents the reactivity of nucleotide <italic>i</italic> in profile <italic>j</italic>. If <italic>σ</italic><sub><italic>i</italic></sub> and <italic>μ</italic><sub><italic>i</italic></sub> represent the sample standard deviation and mean of reactivities for nucleotide <italic>i</italic>, respectively, then the <italic>d</italic> score of nucleotide <italic>i</italic> is defined as: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} d_{i} &amp; = &amp; \frac{2}{\pi} \arctan \left(\frac{\sigma_{i}}{\left| \mu_{i} \right|} \right). \end{array} $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>arctan</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For <italic>m</italic>=2, the above expression simplifies to: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} d_{i} &amp; = &amp; \frac{2}{\pi} \arctan \left(\sqrt{2}\left|\frac{r_{i1} - r_{i2} }{ r_{i1} + r_{i2} }\right| \right). \end{array} $$ \end{document}</tex-math><mml:math id="M4"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>arctan</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msqrt><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Taking the ratio of <italic>σ</italic><sub><italic>i</italic></sub> and <italic>μ</italic><sub><italic>i</italic></sub> accounts for the fact that higher reactivities tend to manifest higher fluctuations [<xref ref-type="bibr" rid="CR56">56</xref>]. However, the ratio by itself is very sensitive to small changes in <italic>μ</italic><sub><italic>i</italic></sub>, especially when <italic>μ</italic><sub><italic>i</italic></sub> is small. For example, PARS reactivities can be both positive and negative (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). This can result in <italic>μ</italic><sub><italic>i</italic></sub> being close to 0, while <italic>σ</italic><sub><italic>i</italic></sub> remains high (e.g., nucleotide highlighted with asterisks in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Importantly, <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| increases very fast and approaches infinity as <italic>μ</italic><sub><italic>i</italic></sub> decreases and approaches zero (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). However, the dStruct pipeline involves taking means of <italic>d</italic><sub><italic>i</italic></sub> as we describe below. Since the mean is not robust to outliers, extremely high values of <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| could pose problems in the dStruct pipeline. Hence, we reduce the sensitivity of <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| to changes in <italic>μ</italic><sub><italic>i</italic></sub> by transforming it with the arctan function. While <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| is unbounded, its arctan-transformed value is bounded between 0 and <italic>π</italic>/2. To restrict its range to [0, 1], we scale it by 2/<italic>π</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). <italic>d</italic><sub><italic>i</italic></sub> is 0 when the same reactivity is observed for nucleotide <italic>i</italic> in all samples (e.g., nucleotide highlighted with triangles in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, b). It monotonically increases as <italic>r</italic><sub><italic>ij</italic></sub> becomes more dispersed (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c; see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section for details).</p>
    </sec>
    <sec id="Sec4">
      <title>Differentially reactive regions</title>
      <p>Equipped with <italic>d</italic> score as a dissimilarity measure, we have developed a method to identify DRRs. Our method has three steps (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). First, we assess the within-group and between-group variations in terms of <italic>d</italic> scores. Next, we distinguish between de novo and guided discovery situations. To discover DRRs de novo, we need to identify regions that are potential candidates for DRRs. This is done in the second step by screening for regions where between-group variation appears to be higher, on average, than within-group variation. Note that this step is skipped for guided discovery as candidate regions are predefined from a collateral study. In the third step, to assess the statistical significance at each candidate region, the variation between groups in that region is compared to the variation within groups. If the between-group variation is found to be significantly higher, the region is reported as a DRR. In what follows, we briefly describe each step.</p>
      <sec id="Sec5">
        <title>Step 1</title>
        <p>Given <italic>m</italic><sub><italic>A</italic></sub> and <italic>m</italic><sub><italic>B</italic></sub> samples from groups A and B, respectively, let <italic>m</italic>= max(<italic>m</italic><sub><italic>A</italic></sub>,<italic>m</italic><sub><italic>B</italic></sub>) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). We construct all possible subsets of the <italic>m</italic><sub><italic>A</italic></sub>+<italic>m</italic><sub><italic>B</italic></sub> samples, such that each subset has <italic>m</italic> samples. Of these subsets, at maximum, two will be homogeneous, i.e., they will comprise of samples from A only or B only. If <italic>m</italic><sub><italic>A</italic></sub>≠<italic>m</italic><sub><italic>B</italic></sub>, there will be only one homogeneous subset with samples from group A if <italic>m</italic><sub><italic>A</italic></sub>&gt;<italic>m</italic><sub><italic>B</italic></sub> or with samples from group B if <italic>m</italic><sub><italic>A</italic></sub>&lt;<italic>m</italic><sub><italic>B</italic></sub>. All other subsets will be heterogeneous. For each subset, we assess the <italic>d</italic> score for each nucleotide as previously described “<xref rid="Sec3" ref-type="sec">Dissimilarity measure</xref>”. We use the nucleotide-wise average of <italic>d</italic> scores across homogeneous subsets as the measure of within-group variation, denoted as <italic>d</italic><sub>within</sub> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Similarly, the average of <italic>d</italic> scores across heterogeneous subsets is used as the measure of between-group variation, denoted as <italic>d</italic><sub>between</sub>.</p>
      </sec>
      <sec id="Sec6">
        <title>Step 2</title>
        <p>The second step is performed only for de novo discovery, as it constructs candidates for DRRs. In the absence of prior knowledge of where DRRs start and end, we rely on the evidence in the data to construct the so-called data-driven regions [<xref ref-type="bibr" rid="CR49">49</xref>]. In our case, the evidence is in the difference between <italic>d</italic><sub>between</sub> and <italic>d</italic><sub>within</sub>. Hence, we define <italic>Δ</italic><italic>d</italic>=<italic>d</italic><sub>between</sub>−<italic>d</italic><sub>within</sub>. If <italic>Δ</italic><italic>d</italic> is positive for all nucleotides in a contiguous region of length greater than or equal to a user-specified length, the region is a potential DRR candidate (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, c). However, DRRs could have altered reactivity patterns without necessarily having altered reactivities at all nucleotides. Indeed, in DRRs, some nucleotides may have <italic>Δ</italic><italic>d</italic>≤0. Hence, we smooth the <italic>Δ</italic><italic>d</italic> profile prior to screening for candidates (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). Then, we search for regions that have a positive value of smoothed <italic>Δ</italic><italic>d</italic> for all nucleotides (highlighted in purple in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). These regions are deemed potential candidates for DRRs. Note that the smoothed <italic>Δ</italic><italic>d</italic> profile is used only to construct candidate regions. Inputs to the final step are unsmoothed profiles obtained in Step 1.</p>
      </sec>
      <sec id="Sec7">
        <title>Step 3</title>
        <p>The significance of the differential reactivity pattern in a candidate region (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>d for an example) is determined by comparing <italic>d</italic><sub>within</sub> and <italic>d</italic><sub>between</sub> for the region (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). Specifically, we perform Wilcoxon signed-rank test to test the null hypothesis against the one-sided alternative hypothesis that the population mean of <italic>d</italic><sub>between</sub>−<italic>d</italic><sub>within</sub> is positive [<xref ref-type="bibr" rid="CR52">52</xref>]. For the set of screened regions from all transcripts, the FDR is controlled using the Benjamini-Hochberg procedure to obtain <italic>q</italic> values (i.e., FDR-adjusted <italic>p</italic> values) [<xref ref-type="bibr" rid="CR53">53</xref>]. Finally, users obtain a list of regions with their corresponding <italic>p</italic> values and <italic>q</italic> values (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f). At this point, it is noteworthy that the final step of the statistical testing is performed only for regions that meet a criterion for minimum quality, i.e., if their average <italic>d</italic><sub>within</sub> is less than a threshold (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). Henceforth, we call this criterion the <italic>minimum quality threshold</italic>. Keeping the average <italic>d</italic><sub>within</sub> below this threshold ensures that samples in the same group have similar profiles in the region of interest, see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section for additional details.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Validation with small datasets</title>
      <p>We tested dStruct on three small datasets for which prior knowledge of DRRs is available from independent sources. In addition, we compared its performance to that of RASA, PARCEL, and deltaSHAPE. Overall, we found that dStruct discovers DRRs de novo while having a minimal false-positive rate. Note that we defer comparison with StrucDiff until the section on large datasets, as the small datasets considered below do not have predefined candidates for DRRs. We require SHAPE data with both predefined candidates and replicate samples to compare dStruct and classSNitch. This is because classSNitch is currently trained for guided discovery in SHAPE data only and dStruct requires replicates. Since data satisfying requirements of classSNitch and dStruct simultaneously is not available, we have excluded classSNitch from performance comparisons.</p>
      <sec id="Sec9">
        <title>dStruct accurately rejects transcripts with no DRRs</title>
        <p>We obtained three replicate samples of four <italic>Saccharomyces cerevisiae</italic> rRNAs (5S, 5.8S, 18S, and 25S) from in vivo DMS probing using the Structure-Seq protocol (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). Since we probed the samples under identical conditions, there should not be any DRRs between replicated profiles of the same rRNA. To assess the specificities of dStruct and the other methods, for each RNA, we performed null comparisons of each possible pair of samples (labeled group A) with the single remaining sample (labeled group B). Therefore, we created 12 test cases (3 for each of the 4 rRNAs), in which we searched for DRRs. We tested deltaSHAPE, RASA, and PARCEL with default search parameters. deltaSHAPE and RASA use windows of 5 nt and 50 nt by default, respectively. We tested dStruct for both window lengths. PARCEL does not require predefined window lengths. Furthermore, deltaSHAPE accepts only one sample per group. Hence, for group A, we input reactivities assessed from pooled counts to deltaSHAPE (i.e., we tallied counts and coverages across all samples). We summarized the performances as follows.</p>
        <p>We tallied the number of DRRs reported by each method. Out of the 12 test cases, dStruct reported 3 DRRs when searching over 5 nt windows (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Its performance was similar or better for longer windows (data not shown). For example, it reported no DRRs when searching over 50-nt windows (data not shown). RASA performed comparably to dStruct, reporting 4 DRRs. In contrast, PARCEL and deltaSHAPE reported 61 and 97 DRRs, respectively.
<fig id="Fig3"><label>Fig. 3</label><caption><p>dStruct had a low false-positive rate in null comparisons. In a comparison of biological replicates of rRNAs probed in vivo under identical conditions, <bold>a</bold> dStruct and RASA reported 3 and 4 false positives, respectively. In contrast, PARCEL and deltaSHAPE reported 61 and 97 false positives, respectively. <bold>b</bold> dStruct had lower nucleotide-level false-positive rates than RASA, PARCEL, and deltaSHAPE</p></caption><graphic xlink:href="13059_2019_1641_Fig3_HTML" id="MO3"/></fig>
</p>
        <p>We calculated the false-positive rates at the nucleotide level as the fraction of nucleotides incorrectly reported as positives for a transcript. For dStruct, the rate was 0% in 9 cases and 0.2%, 0.3%, and 2% in the remaining cases whereas the other methods displayed higher rates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b).</p>
        <p>dStruct’s superior performance could be attributed to the fact that it overcomes limitations of the existing methods. In particular, RASA and PARCEL do not account for information obtained from untreated control samples. Structure-Seq, however, does integrate it into the resulting reactivities [<xref ref-type="bibr" rid="CR25">25</xref>]. PARCEL also does not account for coverage variations within a transcript, which is known to be a significant issue [<xref ref-type="bibr" rid="CR57">57</xref>]. Additionally, dStruct controls for false discoveries by adjusting the <italic>p</italic> values for multiple tests whereas deltaSHAPE and RASA do not. For detailed overview of deltaSHAPE, RASA, PARCEL, and their limitations, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Sections S1-S3.</p>
      </sec>
      <sec id="Sec10">
        <title>dStruct identifies DRRs from ligand-mediated structure alteration</title>
        <p>Next, we considered cotranscriptional SHAPE-Seq data for the <italic>Bacillus cereus crcB</italic> fluoride riboswitch (100 nt in length), probed in vitro in the absence and presence of fluoride ions [<xref ref-type="bibr" rid="CR12">12</xref>]. It featured four samples for each group. The presence of fluoride prevents completion of a terminator hairpin by stabilizing a pseudoknot (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). Such a mechanism allows fluoride-mediated transcription control. Between the conditions with and without fluoride, nucleotides 12–17, 38, 40, and 67–74 have altered base pairing states [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR58">58</xref>, <xref ref-type="bibr" rid="CR59">59</xref>]. In addition, Watters et al. observed distinct reactivity changes at nucleotides 22–27 from visual examination of an independent dataset [<xref ref-type="bibr" rid="CR10">10</xref>]. These nucleotides join the P1 and P3 helices but do not have altered base pairing states between conditions. However, these changes were observed consistently over a range of intermediate lengths that were probed cotranscriptionally. Hence, Watters et al. inferred that they were related to fluoride-mediated stabilization of the pseudoknot. Furthermore, we noted a consistent increase in the reactivity at nucleotide 48 in the presence of fluoride, consistent with prior observations by Watters et al. [<xref ref-type="bibr" rid="CR10">10</xref>]. Given the reproducibility of this change, we regarded nucleotide 48 as differentially reactive. Taken together, we considered nucleotides 12–17, 22–27, 38–40, 48, and 67–74 as our ground truth of DRRs (highlighted in blue on top of each sample in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). Note that in the absence of fluoride, nucleotides 42–47 pair with nucleotides 68–74 and are part of a hairpin. In the presence of fluoride, nucleotides 42–47 pair with nucleotides 12–17 to form a pseudoknot. However, ligand binding is not expected to change the reactivities at nucleotides 42–47 because this region is paired in both the liganded and unliganded states. Hence, we excluded it from the ground truth.
<fig id="Fig4"><label>Fig. 4</label><caption><p>dStruct identified DRRs from a ligand-mediated structure alteration. Fluoride ions bind the <italic>crcB</italic> fluoride riboswitch and alter its structure. <bold>a</bold> Secondary structure in the absence of fluoride ions. <bold>b</bold> Secondary structure in the presence of 10 mM fluoride ions. The red curves highlight the pseudoknot between nucleotides 12–17 and 42–47. The purple curves highlight long-range interactions between the nucleotide pairs (10, 38) and (40, 48). <bold>c</bold> Eight samples of reactivity profiles, four from group A (A1, A2, A3, and A4) with 0 mM fluoride ions and four from group B (B1, B2, B3, and B4) with 10 mM fluoride ions. Solid blue lines mark DRRs that are considered as the ground truth. Hollow black rectangles mark the DRRs called by deltaSHAPE. A red background marks the DRRs called by dStruct. A green line marks the DRR called by PARCEL. Note that RASA did not report any DRRs</p></caption><graphic xlink:href="13059_2019_1641_Fig4_HTML" id="MO4"/></fig>
</p>
        <p>We searched for DRRs using dStruct, deltaSHAPE, PARCEL, and RASA. For comparability, we specified the same window length of 5 nt to dStruct, deltaSHAPE, and RASA. We chose 5 nt because it is the default in deltaSHAPE. The default used by RASA is 50 nt, which is too long for a short transcript of length 100 nt. Note that PARCEL does not require a window length.</p>
        <p>dStruct reported a DRR from 3–39, encompassing regions 12–17 and 22–27 and overlapping region 38–40 (region highlighted with red background in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). However, this DRR joined together three separate regions and extended to additional nucleotides towards the 5 <sup>′</sup> end. This is due to dStruct’s propensity to screen for the longest possible contiguous regions. While dStruct did not report any false positives, it did not recognize the DRR within 67–74. This region was screened as a candidate but had a <italic>p</italic> value of 0.071 and <italic>q</italic> value of 0.106, both above our desired significance level of 0.05. This is because in this region, the within-group profiles were noisy and not consistently altered between the groups. For example, the reactivity patterns for this region look identical between samples A4 and B4 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). Additionally, dStruct could not identify the differential reactivity at the isolated nucleotide 48. Indeed, one limitation of dStruct is that it might not report changes at isolated nucleotides even if such changes were real signal. This is due to the fact that differential signals at isolated nucleotides get diluted when scanning over windows. For example, nucleotide 48 is flanked by nucleotides that do not have differential signals. In the “<xref rid="Sec15" ref-type="sec">Discussion</xref>” section, we propose ways to mitigate this limitation.</p>
        <p>Similarly, deltaSHAPE correctly identified DRRs from 11–16 and 21–25, but it also correctly identified 47–49 and 71–73 (marked by black rectangles on top of each sample in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). However, it incorrectly reported region 2–4 and failed to identify region 38–40. PARCEL reported a single DRR that stretched from nucleotides 4–75 (marked by a green line at the bottom of each sample). This DRR correctly encompassed all the real DRRs but also included regions that separate them. RASA did not report any DRRs when searching over 5 nt. It is noteworthy that RASA did not report any DRRs when searching over its default window length of 50 nt either.</p>
        <p>Our results highlight that a key difference between the outputs of dStruct, deltaSHAPE, and PARCEL lies in the lengths of DRRs. dStruct identifies contiguous stretches of nucleotides that manifest reactivity changes. While dStruct might join together nearby DRRs, it does so only if they are separated by no more than twice the specified search length. For example, the DRRs from 38–40 and 67–74 are separated by 27 nt with only one differentially reactive nucleotide. This prevents dStruct from extending its reported DRR (3–39 nt) beyond nucleotide 39. In contrast, deltaSHAPE was developed to identify compact regions that might be DRRs. Hence, it yields several short regions as DRRs. Finally, PARCEL was developed to identify the longest possible regions that have at least one nucleotide with significant changes. Thus, it includes long stretches of nucleotides without a differential signal in the reported DRRs. For example, it reported the entire span from the most 5 <sup>′</sup> real DRR to the most 3 <sup>′</sup> real DRR and included everything in between.</p>
      </sec>
      <sec id="Sec11">
        <title>dStruct identifies sites of RNA-protein interactions</title>
        <p>We tested dStruct on another SHAPE-Seq dataset, which structurally characterizes the HIV Rev-response element (RRE)—a part of a viral RNA intron [<xref ref-type="bibr" rid="CR11">11</xref>]. RRE binds multiple copies of Rev protein to form a complex that facilitates export of unspliced viral transcripts from the nucleus to the cytoplasm during late stage of HIV infection. Regions of Rev-RRE interactions have been identified using independent methods and provided us with a ground truth for comparisons (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR60">60</xref>–<xref ref-type="bibr" rid="CR62">62</xref>]. We obtained reactivity profiles for six samples — three replicates each in the presence and absence of Rev. However, counts and coverage information were not available. When searching for regions of length 5 nt or more, dStruct identified 10 DRRs that overlapped 6 of the 7 regions known to bind Rev. However, two of the reported DRRs were false positives. As RASA, PARCEL, and deltaSHAPE require coverage information, we could not apply them to this dataset. At this point, it is worth noting that RASA and PARCEL are based on counts and do not accept reactivities directly. Hence, they are not compatible with available datasets that contain only reactivities or with computational methods that output reactivities [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>].</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Validation with large datasets</title>
      <p>We tested the methods on two large datasets, one with simulated DRRs and another with DRRs due to known single-nucleotide variants. In all tests, dStruct outperformed the existing methods.</p>
      <sec id="Sec13">
        <title>dStruct identifies simulated DRRs with properly controlled FDR</title>
        <p>We used simulations to assess the methods’ capability in discovering DRRs de novo from transcriptome-wide SP data. To this end, we obtained three replicate samples of the <italic>S. cerevisiae</italic> mRNA structurome using in vivo DMS probing (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). Next, to mimic realistic trends in within-group variation, coverages, and transcript lengths, we introduced simulated DRRs into these samples. One of the samples was randomly labeled as group A, and the other two were labeled as group B. To start with, we randomly selected 1000 regions in the transcriptome for DRRs. The length of each region was chosen in the range of 50–75 nt, which is the usual range of lengths for search of structured regions [<xref ref-type="bibr" rid="CR34">34</xref>]. Note that while we simulated the structural profiles for groups A and B over this range, we allowed the simulated DRRs to be shorter, as described next.</p>
        <p>RNAs often adopt multiple structural conformations, and reactivities summarize measurements over the entire structure ensembles. Hence, we obtained reactivities for selected regions as ensemble-weighted average of profiles simulated for structures in an ensemble. For each of the selected regions, we sampled up to 1000 unique secondary structures using the ViennaRNA package [<xref ref-type="bibr" rid="CR63">63</xref>]. Each of the unique structures was assigned an ensemble weight that reflected its proportion in the structure ensemble. The ensemble weights were randomly sampled from arbitrarily chosen probability density functions (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). For each group, we selected up to five structures that were assigned high weights and hence dominated the overall reactivity profile for that group. The reactivity profiles differed between groups due to the disjoint selection of dominant structures. We introduced within-group variation by adding noise to ensemble weights. In addition, we controlled the between-group variation by controlling the weight of the minimum free energy (MFE) structure in each group. For example, increasing the weight of the MFE structure in both groups increased the similarity of their structure ensembles, thereby reducing the between-group variation. For each structure, we generated a DMS reactivity profile by sampling reactivities using probability density functions for reactivities of paired and unpaired nucleotides [<xref ref-type="bibr" rid="CR54">54</xref>]. The probability density functions were obtained by fitting a Gaussian mixture model to our data using patteRNA [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR64">64</xref>]. The final reactivity profile for each region was obtained as the ensemble-weighted average of profiles for individual structures (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section for details).</p>
        <p>Overall, we simulated a range of within-group and between-group variations in reactivities, as reflected in the resulting within-group and between-group Pearson correlation coefficients (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4A). Since all simulated structures for a region represented folding of the same short sequence, there were stretches within them that did not have altered base pairing states between the groups. Indeed, the pairing states were altered for stretches shorter than the complete chosen regions (median length 11 nt; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4B). Therefore, we ran dStruct, RASA, and deltaSHAPE with a search length of 11 nt. As noted earlier, PARCEL automatically determines the appropriate length for each DRR.</p>
        <p>We evaluated the methods in terms of power and observed FDR. Power was calculated as the proportion of simulated DRRs that overlapped at least one reported DRR. The observed FDR was calculated as the proportion of reported DRRs that did not overlap any simulated DRRs. We observed the following performances.</p>
        <p>We tested dStruct’s performance for several values of the minimum quality threshold (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The threshold was specified in terms of maximum dissimilarity of reactivity profiles within the same group, i.e., maximum <italic>d</italic><sub>within</sub>. We observed that dStruct had reasonably high power (∼ 60%) to discover DRRs for a range of the quality threshold (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). In addition, its FDR was properly controlled to the specified target level of 5%.
<fig id="Fig5"><label>Fig. 5</label><caption><p>dStruct properly controlled the false discovery rates in simulated data. We searched for DRRs in simulated data using dStruct, deltaSHAPE, PARCEL, and RASA (<bold>a</bold>–<bold>d</bold>, respectively). The powers (circles) and FDRs (triangles) are plotted for each method. We tested each method for a range of stringency levels. Vertical dotted blue lines mark the default parameter settings. A horizontal dotted red line in <bold>a</bold> marks the specified target FDR. deltaSHAPE, PARCEL, and RASA do not control for FDR. <italic>X</italic>-axis labels indicate the parameter tuned for each method. <bold>a</bold> dStruct calls a candidate region a DRR only if it satisfies a quality threshold as well as has significant <italic>p</italic> value and <italic>q</italic> value. The quality threshold is specified in terms of a maximum allowed within-group variation, measured as the average <italic>d</italic><sub>within</sub> in the region. <bold>b</bold> deltaSHAPE chains together differentially reactive nucleotides as DRRs if a minimum number of them are colocalized within a specified search length. <bold>c</bold> PARCEL quantifies the statistical significance of structural changes in a region in terms of an <italic>E</italic> value. Under the null hypothesis of no differential signal, it is computed as the number of regions that can be expected to have structural change scores at least as high as the given region’s score. <bold>d</bold> RASA identifies DRRs as the regions that have significant clustering of nucleotides with large changes in reactivities. The significance of the observed clustering is evaluated by comparing the observed distribution of the numbers of such nucleotides in sliding windows of a specified length with their null distribution obtained from permutations. The comparison is done in terms of standard <italic>Z</italic> scores</p></caption><graphic xlink:href="13059_2019_1641_Fig5_HTML" id="MO5"/></fig>
</p>
        <p>deltaSHAPE calls DRRs based on the number of nucleotides in a region that manifest significant changes in reactivities (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1). Requiring fewer nucleotides amounts to a less stringent criterion. We tested deltaSHAPE’s performance for a range of stringency levels. We observed consistently high FDR in its detections (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). For the least stringent criterion, deltaSHAPE’s power was comparable to that of dStruct, albeit at the cost of excessive FDR (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b). Its high FDR could be attributed to its tendency to always report DRRs in transcripts that have high coverage (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1 for a detailed overview of deltaSHAPE and its limitations). This is because deltaSHAPE calls DRRs from locally smoothed reactivity profiles. However, smoothing artificially spreads noise at a nucleotide into neighboring nucleotides. This might amplify the noise leading to false appearance of a strong differential signal. In addition, deltaSHAPE does not account for biological variation and does not control for false discoveries.</p>
        <p>PARCEL calls DRRs based on the <italic>E</italic> value statistic, which quantifies the statistical significance of reactivity changes in a region (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2 for details). A lower cutoff for <italic>E</italic> values represents a more stringent criterion. We tested PARCEL’s performance on a range of cutoff values (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). We observed a consistently high FDR (∼ 82%) and low detection power (&lt; 1%). PARCEL’s poor performance could be attributed to the fact that it was designed to work in conjunction with a specific SP technology [<xref ref-type="bibr" rid="CR21">21</xref>]. As such, it does not consider untreated samples or coverage variations across a transcript, which are important issues in transcriptome-wide data from most technologies [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR30">30</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2 for a detailed overview of PARCEL and its limitations).</p>
        <p>RASA calls DRRs in two steps. It uses a generalized mixed model to quantify the significance of reactivity changes for each nucleotide. Then, it identifies regions enriched in differentially reactive nucleotides via permutation testing (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3). Since RASA quantifies enrichment in terms of <italic>Z</italic> scores, we assessed its performance for a range of <italic>Z</italic> score cutoffs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d). The lower the cutoff, the less stringent was the criterion for calling a DRR. We observed that RASA consistently yielded excessively high FDR and very low power. This could be explained by the fact that it does not utilize untreated samples to compute reactivities. Hence, its application might not be suitable for SP technologies like Structure-Seq, which relies on untreated samples [<xref ref-type="bibr" rid="CR25">25</xref>]. In addition, RASA does not perform multiple testing correction to control for false discoveries (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 for a detailed overview of RASA and its limitations).</p>
        <p>Overall, we conclude from these comparisons that dStruct has higher power than existing methods and that its observed FDR is properly controlled to the specified target of 5%. We provide additional performance summaries for all methods in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5. Interestingly, we found that the proportions of transcript lengths reported by dStruct as DRRs correlated well with their simulated ground truths (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). This did not hold for the other methods.</p>
        <p>Finally, we assessed the effect of varying the specified search length on dStruct’s performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5F). We found that dStruct’s power remained approximately constant up to a search length of 25 nt, from which point it monotonically decreased. This is expected because a higher minimum length excludes more regions whose alterations span stretches shorter than the search length.</p>
      </sec>
      <sec id="Sec14">
        <title>dStruct identifies DRRs caused by single-nucleotide variants</title>
        <p>We compared the performances of dStruct and StrucDiff in a guided discovery context with PARS data for human RNAs by Wan et al. [<xref ref-type="bibr" rid="CR9">9</xref>]. PARS utilizes a pair of nucleases as probing reagents, and the degrees of reactions from the nucleases are summarized as a PARS score for each nucleotide. The PARS dataset from Wan et al. features RNAs obtained from cell lines derived from a family trio of a father, a mother, and a child, with no replicates for any cell line. Wan et al. obtained a list of transcripts with single-nucleotide variants for this trio and identified DRRs of lengths 11 nt with the variants at their centers. To this end, they developed the StrucDiff approach (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4). For each variant, they compared each pair of individuals separately using StrucDiff. They called a region a riboSNitch (i.e., a regulatory element whose structure is altered by a single-nucleotide variant) if any of the pairwise comparisons for the region yielded a significant result.</p>
        <p>StrucDiff has five steps. Given a pair of profiles, first, the data is locally smoothed using a rolling mean over sliding windows of 5 nt to calculate smoothed PARS scores. Second, the absolute difference in the smoothed PARS scores (denoted as <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta {\overline {r}_{i}}$\end{document}</tex-math><mml:math id="M6"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq1.gif"/></alternatives></inline-formula> for nucleotide <italic>i</italic>) is calculated. Third, given the variant’s location, the structural change score around the variant (henceforth, called <italic>v</italic><sub>SNV</sub>) is calculated as the average <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta {\overline {r}_{i}}$\end{document}</tex-math><mml:math id="M8"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq2.gif"/></alternatives></inline-formula> for the nucleotides flanking it. In the fourth step, StrucDiff assesses the statistical significance of <italic>v</italic><sub>SNV</sub>. To this end, it permutes the sequence of <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta {\overline {r}_{i}}$\end{document}</tex-math><mml:math id="M10"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq3.gif"/></alternatives></inline-formula> 1000 times. For each permutation, it assesses a structural change score under the null hypothesis (henceforth, called <italic>v</italic><sub>null</sub>). A <italic>p</italic> value is assigned to the variant as the fraction of <italic>v</italic><sub>null</sub> values greater than <italic>v</italic><sub>SNV</sub>. In addition, StrucDiff controls the FDR using the Benjamini-Hochberg procedure. Finally, a variant region is classified as a riboSNitch if it has significant <italic>p</italic> values and <italic>q</italic> values, <italic>v</italic><sub>SNV</sub>&gt;1, high local coverage, and high signal strength in a window of 11 nt.</p>
        <p>Of the regions examined by Wan et al., only those found to be riboSNitches were reported. For our analysis, we selected those for which two of the three individuals were allelically identical, i.e., they were either both heterozygous or both homozygous with the same allele. However, none of the studied cell lines were probed in replicates. Hence, we used profiles from the two cell lines with identical allele at a variant site as two replicate samples of the same PARS profile (labeled group A) for a region of 11 nt centered at the variant. This is reasonable under the assumption that the variant at the center of a region is the only distinguishable structure-altering factor. The remaining cell line with a different allele (labeled group B) could potentially have a significantly altered profile in this region. Hence, we used dStruct (guided discovery mode) to identify the regions with variants that were DRRs. Since there were no independent validations that could provide a ground truth for the variants under consideration (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section), we resorted to an indirect way of comparing the results from dStruct and StrucDiff using the Pearson correlation coefficient. The correlation between a pair of differentially reactive profiles is expected to be lower than the correlation between the samples of the same group [<xref ref-type="bibr" rid="CR35">35</xref>]. Hence, we calculated the within-group and between-group Pearson correlation coefficients for each region. We found that the within-group correlations for DRRs identified by dStruct were high (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). In addition, the between-group correlations were substantially lower in comparison with the within-group values. This trend in within-group and between-group correlations is expected because dStruct aims to find regions where the between-group variation exceeds that within groups. We further confirmed the similarity of reactivity patterns within groups and their dissimilarity between groups by visual inspection (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7). The inferences from the Pearson correlation coefficients and visual examination support our previous finding of a properly controlled FDR by dStruct. In agreement with dStruct, for two of the DRRs, StrucDiff consistently found significant changes in both the pairwise comparisons of profiles between groups. However, for each of the remaining two DRRs reported by dStruct, it inconsistently called a DRR in one pairwise comparison but not in the other. This is anomalous because both pairwise comparisons involved the same pair of variants.
<fig id="Fig6"><label>Fig. 6</label><caption><p>dStruct reported riboSNitches from a PARS dataset. <bold>a</bold> The within-group Pearson correlation coefficients (green bars) for riboSNitches reported by dStruct were higher than their respective between-group Pearson correlations (red bars). <bold>b</bold> Example of reactivity profiles for the mother, the child, and the father for one of the regions that dStruct reported as riboSNitch, i.e., the single-nucleotide variant at site 1817 for NM_032855. Note that for this region, the mother and child were allelically identical and therefore labeled as group A (A1 and A2). They appear identical, but they differ from the father, who had a different allele and was labeled as group B (B1). <bold>c</bold> A histogram of the differences between Pearson correlation coefficients between and within groups. Many of the riboSNitches reported by StrucDiff had only a minor change in their Pearson correlation. For many of the regions, the between-group Pearson correlations were also higher. The dotted vertical line in red marks the median of distribution</p></caption><graphic xlink:href="13059_2019_1641_Fig6_HTML" id="MO6"/></fig>
</p>
        <p>To glean the FDR of StrucDiff, we took the difference of the between-group correlations and the within-group correlations for all regions. For DRRs, the difference should be significant and negative. However, we found that for many of the regions, the difference was positive, with a median − 0.06 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). This suggests that there could possibly be a significant proportion of false positives reported by StrucDiff. In other words, StrucDiff’s FDR might be higher than the specified level of 0.1 as well as than that of dStruct. An alternative explanation for this observation could be that the variants at the center of the examined regions were not always the only relevant factors that influenced local structures. In fact, Wan et al. proposed that co-variation of variants in the close vicinity of a variant under consideration might influence the local structure. However, they also found that riboSNitches (identified using StrucDiff) have fewer variants around them in comparison with variants that do not alter structure. Nonetheless, it is possible that our starting assumption that allelic similarity implies the absence of a DRR does not apply for at least some of the variants. This would explain the low proportion of riboSNitches found by our method. It could also explain the anomalous distribution of changes in the correlations for the riboSNitches reported by StrucDiff. Note that we could not compare the powers of dStruct and StrucDiff due to the lack of a ground truth for the data. Besides a comparison of FDRs, it is worthwhile to observe that the permutation test approach utilized by StrucDiff might not be suitable for locally smoothed reactivity data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4). This is because local smoothing introduces local correlations in <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \overline {r}_{i}$\end{document}</tex-math><mml:math id="M12"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq4.gif"/></alternatives></inline-formula>. However, these local correlations are absent in the permuted data. As such, the sampling distribution of <italic>v</italic><sub>SNV</sub> under the null hypothesis turns out to be different from the distribution of <italic>v</italic><sub>null</sub> values, which can lead to inflated error rates [<xref ref-type="bibr" rid="CR65">65</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="discussion">
    <title>Discussion</title>
    <sec id="Sec16">
      <title>Accounting for biological variation in reactivity patterns</title>
      <p>Biological variation in measurements from samples of the same group has been observed across all areas of genomics [<xref ref-type="bibr" rid="CR66">66</xref>]. In fact, RNA biologists that use SP protocols have been aware of its presence [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. A recent study by Selega et al. shows that accounting for biological variation improves the estimates of reactivities [<xref ref-type="bibr" rid="CR30">30</xref>]. Two methods, PARCEL and RASA, which explicitly account for biological variation in the context of differential analysis, have also been published recently [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. PARCEL uses edgeR to compare the counts between the groups of samples [<xref ref-type="bibr" rid="CR36">36</xref>]. However, it does not consider coverage variation within a transcript, which is known to be significant [<xref ref-type="bibr" rid="CR57">57</xref>]. RASA accounts for coverage variation, but similarly to PARCEL, it does not use untreated control samples in computing reactivities. Instead, it assesses the background noise from the untreated samples and then excludes from analysis nucleotides whose noise level exceeds a threshold. It favors this strategy because it was developed to be used with DMS-MaPseq, which does not consider untreated samples in reactivity estimation [<xref ref-type="bibr" rid="CR67">67</xref>]. Yet, this limits the detection power in transcriptome-wide data from other technologies by filtering a major fraction of the nucleotides because these datasets are highly noisy [<xref ref-type="bibr" rid="CR7">7</xref>]. Additionally, this places the burden on the user to optimize the threshold level for noise. Recently, broadly applicable computational methods for reactivity estimation have been developed, namely, PROBer and BUM-HMM [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. These address several challenges in estimating reactivities from transcriptome-wide data, e.g., multi-mapping reads, background noise, and coverage variation. Therefore, it is necessary for novel differential analysis methods to either address these challenges directly or be compatible with methods such as PROBer and BUM-HMM. However, RASA and PARCEL neither account for some of these major issues nor are they compatible with the analog reactivities output by said methods. The incompatibility arises because RASA and PARCEL were designed to take read counts as their (digital) input. Hence, the need for a robust differential analysis method remains unmet for the majority of SP technologies.</p>
      <p>Besides accounting for biological variation, it is desirable to identify regions that display differences in their reactivity patterns [<xref ref-type="bibr" rid="CR33">33</xref>]. An altered pattern in a region could indicate a change in the composition of its structural ensemble [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR64">64</xref>]. Reactivity pattern is defined collectively by the reactivities of all the nucleotides in a region (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Hence, one must consider every nucleotide in a region for inferences on pattern changes. However, RASA, PARCEL, and deltaSHAPE first evaluate the changes at individual nucleotides and subsequently chain nucleotides with significant changes together as DRRs. Furthermore, the criteria for the number of nucleotides with significant changes are not always stringent (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1-S3). For example, PARCEL requires only one significantly altered nucleotide to call a DRR. In contrast to these three methods, StrucDiff considers all nucleotides in a region but only after smoothing the read counts (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4). This effectively obscures the reactivity patterns. classSNitch is the only method that explicitly accounts for patterns (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S5). However, it does not account for biological variation and is also currently limited to SHAPE data. dStruct presents a major advance over existing methods as it accounts for biological variation and reactivity patterns and is also compatible with diverse technologies. Notably, it smoothes the <italic>d</italic> scores in the second step but only to construct candidate regions. Once constructed, it reverts to the unsmoothed <italic>d</italic> scores to perform the statistical inference (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In guided discovery, it does not perform smoothing at all.</p>
      <p>Our approach deviates from the methods for differential analysis of other kinds of high-throughput data, which do not generally account for signal patterns, because our feature of interest is reactivity pattern. For example, in differential methylation studies, the feature of interest for a region is the average methylation level. Such a feature could be described as higher or lower when comparing two samples [<xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR66">66</xref>]. However, reactivity pattern is a geometrical feature. As such, it cannot be described as being higher or lower when comparing samples. It has to be described in terms of agreement in reactivity pattern, which can be numerically captured in a transformation of the data. For example, a secondary feature of the data could be assessed, such as the sequence of slopes of segments joining reactivities for two adjacent sites (see slopes of segments of red line in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). If two profiles were parallel, the slope of the segment between any pair of adjacent sites would be the same for both profiles. Indeed, this idea forms the basis for the classical approach of profile analysis for test of parallelism [<xref ref-type="bibr" rid="CR68">68</xref>]. However, this approach requires a large sample size to account for biological variation and can potentially be applied only to predefined regions. In addition, it would require normality of reactivities. If two profiles were to be found as parallel by this approach, they could be tested for coincidence in a second hypothesis test. Since the telling feature for DRRs is coincidence of profiles, dStruct assesses coincidence at the nucleotide level directly in terms of <italic>d</italic> score. Two profiles can be classified as coincident if the vertical distance (or difference in reactivity) between them is 0 at each nucleotide. However, such a definition would be applicable only for two profiles. Our dissimilarity measure, <italic>d</italic> score, extends the concept of pairwise “vertical distance” to multiple profiles. We use <italic>d</italic> score to assess dissimilarity within groups and between groups. Then, we test the null hypothesis that profiles for the two groups are coincident and <italic>d</italic> scores are not significantly different within and between groups.</p>
      <p>Our dissimilarity measure is based on the mean and standard deviation of reactivities for each nucleotide. In differential analysis studies in other fields, it has been noted that when standard deviation from very few samples is used to estimate <italic>t</italic>-type test statistics, the test statistics can be unreliable and lead to false positives and reduced power [<xref ref-type="bibr" rid="CR69">69</xref>]. However, despite this issue, dStruct has reasonably high power and low observed FDR. dStruct’s high performance is possible because we do not utilize standard deviation to assess a test statistic directly. Instead, it contributes to the assessment of a secondary feature of the data. Additionally, from the point-of-view of Wilcoxon signed-rank test, the test statistic in our method is the sum of signed ranks. This test statistic pools information from all nucleotides in a candidate region, and hence, its susceptibility to noise in nucleotide-level <italic>d</italic> scores is reduced. While untransformed ratio of <italic>μ</italic><sub><italic>i</italic></sub> and <italic>σ</italic><sub><italic>i</italic></sub> is very sensitive to small changes in <italic>μ</italic><sub><italic>i</italic></sub> when <italic>μ</italic><sub><italic>i</italic></sub> is close to zero, we have improved our dissimilarity measure with a monotonic transformation (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). Yet, it is to be noted that our approach focuses on variation at the level of reactivities. Indeed, in our analysis, we have not modeled the mean-variance relationship of reactivities. While dStruct provides a significant improvement over existing methods in its current form, accurate models of heteroscedasticity in mean-variance relationship might enhance the dStruct’s performance. For example, methods for differential gene expression analysis utilize such models [<xref ref-type="bibr" rid="CR70">70</xref>]. Moreover, we do not model variation directly at the level of counts. In the future, it might be possible to achieve better performance with rigorous models for variation directly at counts level [<xref ref-type="bibr" rid="CR49">49</xref>].</p>
      <p>Finally, our approach differs from other methods of differential analysis in one additional way. For each region of interest, other methods assess a single test statistic [<xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR69">69</xref>]. To classify the region, they either rely on a cutoff or assess statistical significance in reference to a null distribution. Moreover, the null distribution is generally obtained by permuting the sample assignment labels for data points and calculating test statistic for permuted data. In contrast to the approach of capturing the effect size and within-group variation in a single test statistic for each region, our approach of quantifying within-group and between-group variations in reactivity patterns provides two vectors of <italic>d</italic> score profiles for each region. The vectors consist of values that reflect nucleotide-level dissimilarity of reactivity patterns. Given these vectors, our goal is to test if between-group variation is significantly higher than within-group variation, in which case it can be reasonably classified as a DRR. Hence, we forgo label permutations in favor of the Wilcoxon signed-rank test. Wilcoxon signed-rank test is an alternative to paired Student’s <italic>t</italic> test and does not assume normal distribution of <italic>d</italic> scores. It compares <italic>d</italic> scores for within-group and between-group variations. In other words, our method assesses the significance of differential reactivity in a region by comparing it to within-group variation in that region. In fact, experts can identify altered reactivity patterns by inspecting a region alone, without needing to resort to transcript-wide or transcriptome-wide data for reference. This suggests that there is adequate information within the candidate regions for classification purpose [<xref ref-type="bibr" rid="CR35">35</xref>]. Our approach in dStruct takes advantage of this characteristic of the reactivity data. In addition, such an approach of significance testing confers robustness to the presence of outliers or poor quality data outside the regions of interest.</p>
    </sec>
    <sec id="Sec17">
      <title>Limitations</title>
      <p>While we found that dStruct can identify DRRs with reasonable power and a properly controlled FDR, several limitations are worth noting. First, dStruct does not automatically identify a search length for DRRs (i.e., the minimum allowed length). With little known about RNA structures, users might not a priori know the optimal search length. Importantly, the analysis results can vary depending on the search length. For example, consider the impact of decreasing the search length from <italic>l</italic><sub>1</sub> to <italic>l</italic><sub>2</sub>. Given the new search length, in addition to identifying the same candidates that were found with length <italic>l</italic><sub>1</sub>, dStruct might identify additional ones, which are shorter than <italic>l</italic><sub>1</sub>. While the <italic>p</italic> values of candidates common to both searches should remain the same, their <italic>q</italic> values might change. This might lead to loss of power if the true DRRs were generally longer than <italic>l</italic><sub>1</sub>. On the other hand, if the true DRRs were shorter than <italic>l</italic><sub>1</sub>, specifying a minimum search length of <italic>l</italic><sub>1</sub> might also lead to loss of power. This is because dStruct disregards all evidence of between-group variation in regions shorter than the specified search length. In our simulations, we found that for a wide range of input search lengths (5–25 nt), dStruct maintained approximately constant power and properly controlled the observed FDR (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5F). However, this might not always be the case.</p>
      <p>Another limitation to note is that dStruct might not determine DRR boundaries accurately, as it opts for the longest contiguous regions possible. Thus, it might join DRRs that are separated by fewer nucleotides than the search length. Moreover, dStruct might miss regions where a majority of the nucleotides have zero reactivities. While zero PARS scores could be considered no information, zero SHAPE/DMS reactivities may report either high-quality information or no information (e.g., a manifestation of high background noise) [<xref ref-type="bibr" rid="CR37">37</xref>]. In our experience, for PARS as well as SHAPE/DMS data, a substantial fraction of the nucleotides have zeros across all replicates. Considering all of them as high-quality information and defining their <italic>d</italic> scores as 0 results in erroneous inferences (data not shown). Hence, we leave the <italic>d</italic> score for such nucleotides as undefined. Yet, it is worth noting that the quality criteria that we use to filter candidate regions ensure that no more than a small fraction of the nucleotides have undefined <italic>d</italic> scores in candidate regions (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). Regions containing zero or very low reactivities for most nucleotides are not found by dStruct, even if they are true DRRs. In addition, if one of the groups manifests only zero reactivities in a region, it does not contribute to the assessment of within-group variation in that region.</p>
      <p>Another limitation of dStruct is that it leaves the burden of normalizing the reactivities to the user. Normalization is a common practice in the field and aims to bridge differences in reaction conditions [<xref ref-type="bibr" rid="CR6">6</xref>]. Several approaches have been utilized, which heuristically identify outliers and subsequently use the remaining values to determine a normalization constant [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR71">71</xref>]. Thus, they critically depend on outlier detection. However, outliers are typically noisy and can easily distort the scaling [<xref ref-type="bibr" rid="CR6">6</xref>]. Furthermore, their prevalence and characteristics in the context of transcriptome-wide SP are still poorly understood. For these reasons, proper normalization is a critical step in differential analysis, and when done well, it could substantially enhance power. A hallmark of proper normalization is good agreement between the normalized replicates [<xref ref-type="bibr" rid="CR72">72</xref>]. In that context, we designed dStruct to consider only those regions which satisfy a minimum requirement for replicate agreement (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section for minimum quality threshold and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). Specifically, transcripts or regions thereof, which display poor replicate agreement, are filtered by dStruct. We caution users to check for agreement between replicates from the same group in those regions that dStruct discarded. Furthermore, if it excluded a large fraction of the transcripts due to quality considerations, this could suggest that samples were not properly normalized.</p>
      <p>Another limitation of dStruct and all other methods is that they might miss the <italic>differentially structured</italic> regions if they do not manifest differential reactivities, as there might be regions in a transcript that pair with alternative partners between groups. For example, nucleotides 42–47 of the <italic>crcB</italic> fluoride riboswitch (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b) change partners between groups but remain paired in both groups. Such nucleotides might not exhibit significant reactivity changes. Notably, this limitation is due to the nature of SP data.</p>
      <p>Besides these limitations, dStruct might miss DRRs that exhibit significant changes at only one to two nucleotides. For long search lengths, it might even overlook such DRRs as candidate regions. This is because differential signals concentrated at only a few nucleotides get diluted when searching over windows. The longer the search length, the more is the signal dilution. Notably, specifying a short search length might not remedy this issue, as it arises from the limited power of the Wilcoxon signed-rank test when applied to very small samples. For example, at a significance level of 0.05, this test cannot identify DRRs shorter than 5 nt in length. This places a hard limit on dStruct’s detection power. Nevertheless, regions shorter than 5 nt might be listed with insignificant <italic>p</italic> values if the specified search length were ≤ 5. Hence, if it is of interest to find isolated single-nucleotide changes, users can specify a short search length and visually examine all the candidate regions. Detection power in such a case could also be improved by replacing Wilcoxon signed-rank test with paired <italic>t</italic> test, which might be more powerful for small samples [<xref ref-type="bibr" rid="CR73">73</xref>].</p>
      <p>Some of the dStruct’s limitations could be mitigated. It is possible that in a study, RNAs are expected to have altered reactivity patterns over multiple non-contiguous regions, yet no region has a sufficiently strong effect size. In such a case, the detection power could be improved by testing all candidate regions identified within an RNA collectively (see dStruct’s manual). Note, however, that this assesses the significance of differences at the level of a transcript and not a region. This distinction should thus be clearly reported. An alternative scenario is that the biological question warrants a short search length, but due to the noisy nature of data, it results in screening of candidate regions that do not represent DRRs. This might impact the detection power because non-DRR candidates impact the correction for multiple tests. However, it is plausible that the real DRRs among the candidates are closely located, say separated by 5–10 nt, while the non-DRR candidates are separated by larger distances. In such cases, power could be improved by leveraging the proximity of real DRR candidates and testing candidate regions collectively if they are located within a certain distance of each other. Another way to improve power in such situations is to integrate differential analysis of SP data with other kinds of relevant data. For example, consider a study on how a protein impacts RNA structure upon binding. Let there be two groups with wild-type samples and samples where the protein’s binding domain has been eliminated. Let us say that dStruct is given a search length of 5 nt and constructs a lot of candidate regions but calls no DRRs due to the subtleness of reactivity changes. It might be possible to integrate the information from a collateral study on sites of RNA-protein binding with regions constructed by dStruct and perform enrichment tests. The null hypothesis underlying such a test could be that constructed regions are not associated with the change in protein’s function. Such tests have been used in other fields of genomics to yield useful biological insights, e.g., gene set enrichment analysis [<xref ref-type="bibr" rid="CR74">74</xref>, <xref ref-type="bibr" rid="CR75">75</xref>]. Future developments of such methods specialized to the SP data could benefit RNA structure studies. Furthermore, it might be possible to do SP in the presence of a range of concentrations of wild-type protein [<xref ref-type="bibr" rid="CR11">11</xref>]. This would result in several groups of samples with different concentrations of the protein. Differential analysis of such data could be performed in the following manner. One could compare each group of samples to the group with the lowest concentration of the protein. Emergence of certain constructed regions as the difference in concentrations between groups increases might reveal the DRRs. If such regions consistently appear beyond a level of concentration differences, they could be considered as evidence in support of DRRs.</p>
    </sec>
    <sec id="Sec18">
      <title>Additional recommendations</title>
      <p>We strongly recommend using dStruct in conjunction with the data obtained from paired-end reads. While dStruct works with both single- and paired-end reads, reactivities are most reliable when the treated and untreated detection rates are estimated using local coverages instead of transcript-level coverages [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. In addition, it is critical to secure at least two samples per group. In our experience, reactivity patterns could change merely due to biological variation. In the absence of replicates for a group, it does not contribute to the estimates of within-group variation. This might lead to false positives. Moreover, in some studies, one of the groups might be expected to manifest much higher variation than the other due to experimental limitations and/or known biological factors. For example, Watters et al. compared genome segment RNA3 of the <italic>Cucumber mosaic virus</italic> between infected cell lysates (group A) and in vitro refolded viral RNA extracted from virions (group B) [<xref ref-type="bibr" rid="CR13">13</xref>]. They observed much higher variation in group A than in group B. In such a case, <italic>d</italic><sub>within</sub>, which summarizes the within-group variation in both groups, might be very high and thereby limit the detection power. However, as has been recently done in methylation studies [<xref ref-type="bibr" rid="CR48">48</xref>], it may be possible to enhance dStruct’s power by assessing <italic>d</italic><sub>within</sub> only for the less variable group (see dStruct’s manual for details). DRRs found using this approach would represent regions where one group varies much more than the other. Importantly, if such an approach was utilized, the supporting details should be clearly reported. Finally, in guided discovery situations, it is possible that collateral studies do not pinpoint the exact regions where DRRs might be found but only indicate their approximate locations. For example, in RNA-protein interaction studies, DRRs might be anywhere within say 100 nt upstream/downstream of CLIP-seq signal peaks. In this case, performing guided discovery with say a 20 nt window centered at the peak may preclude the discovery of more distant DRRs. However, de novo discovery within the entire transcript may not be optimal either. Hence, if the precision of the CLIP-seq data was known, it may be better to perform de novo discovery with say a 200-nt window centered at the peaks.</p>
    </sec>
  </sec>
  <sec id="Sec19" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We described dStruct, a novel approach to identify DRRs from SP data. dStruct is compatible with diverse SP protocols and accounts for biological variation in SP data. First, it quantifies the within-group and between-group variation. Then, it constructs regions that are potential candidates for DRRs to facilitate de novo discovery or utilizes candidate regions identified by collateral studies to aid guided discovery. Finally, it assesses the statistical significance of differential reactivities in candidate regions and controls for false discoveries. To validate dStruct, we used diverse datasets, which span a range of SP technologies, structure-altering factors, and organisms. We demonstrated that for a properly controlled FDR, dStruct has a higher power than existing approaches. While we validated dStruct with the SHAPE-Seq, Structure-Seq, and PARS protocols, it is applicable to many other SP technologies. With SP technologies reaching the phase of maturation, there is a need to develop robust methods to perform differential analysis of SP data. We discussed the unique aspects of SP data that distinguish it from other kinds of genomic data. These unique aspects present a need for differential analysis methods tailored to the needs of diverse SP technologies. dStruct is a first step in this direction.</p>
  </sec>
  <sec id="Sec20">
    <title>Methods</title>
    <sec id="Sec21">
      <title>Quantifying dissimilarity of reactivities</title>
      <p>We used a <italic>d</italic> score to quantify the dissimilarity of reactivities. Its definition was motivated by the need for a robust measure of agreement/disagreement in reactivity patterns in a transcript or in regions thereof. We devised the <italic>d</italic> score by examining the deficiencies of existing approaches in serving this need. For example, classSNitch utilizes a feature of reactivity profiles called a pattern correlation coefficient. It is the Pearson correlation coefficient of sequences of signs of slopes of the segments joining reactivity scores for adjacent nucleotides in plots of reactivity profiles (slope of segments of red line in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). While correlation in sequences of slopes could assess if two profiles were parallel, a region with approximately parallel profiles might still be a DRR if the profiles were not coincident. classSNitch assesses the coincidence in profiles by taking the Euclidean distance between a pair of profiles. However, the Euclidean distance is valid for only two profiles and can be sensitive to outliers. At nucleotide resolution, the coincidence of two profiles could be captured as the vertical distances between the profiles or the differences in reactivities. If the differences were zero or significantly low for a pair of profiles, they might be called coincident. This is the basis of structural change scores used in deltaSHAPE and StrucDiff. However, the utility of reactivity differences is limited to a comparison of two profiles. Besides the need for a measure that could simultaneously summarize the agreement of reactivity patterns for more than two replicates, we identified a need to account for the fact that nucleotides with higher average reactivity tend to have higher fluctuations [<xref ref-type="bibr" rid="CR56">56</xref>]. This aspect of the data could be accounted for by considering the ratio of the reactivity difference and the mean reactivity at a nucleotide, i.e., if <italic>r</italic><sub>1,<italic>i</italic></sub> and <italic>r</italic><sub>2,<italic>i</italic></sub> are the reactivities in two replicates at nucleotide <italic>i</italic>, we could consider: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \frac{\left| r_{1,i} - r_{2,i} \right|}{\frac{1}{2}\left| r_{1,i} + r_{2,i} \right|}. \end{array} $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The above expression yields a sequence of zeros for perfectly coincident profiles. It yields a sequence of very high numbers (or infinity) for nearly anti-parallel profiles. For two profiles, <italic>d</italic> score is defined as the arctan of the above expression, with additional scaling as described next. To account for multiple profiles simultaneously, we replaced the numerator in the above expression with the sample’s standard deviation (denoted <italic>σ</italic><sub><italic>i</italic></sub>), which gave us the absolute value of the coefficient of variation, or |CV|. However, |CV| is very sensitive to small changes in the mean reactivity (denoted <italic>μ</italic><sub><italic>i</italic></sub>), especially when <italic>μ</italic><sub><italic>i</italic></sub> is close to zero (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). This could lead to excessively large |CV|. For example, PARS scores can take both positive and negative values, which can yield <italic>μ</italic><sub><italic>i</italic></sub> values close to zero. As <italic>μ</italic><sub><italic>i</italic></sub> decreases and approaches zero, <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| increases very fast and approaches infinity. This is problematic because excessively large values can dominate the averages that we use within the dissimilarity measures (i.e., nucleotide-wise averages across all the homogeneous subsets or all the heterogeneous subsets in step 1; average at the regional level in step 2; see the “<xref rid="Sec4" ref-type="sec">Differentially reactive regions</xref>” section). Hence, we applied a monotonic transformation to |CV| that prevents the occurrence of excessively large values (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). While logarithmic transformation is a common choice, it is not suitable for |CV| directly as it goes to −<italic>∞</italic> for |CV| close to 0. Indeed, |CV| being close to zero suggests that the reactivities being compared are identical, which can happen in regions with good data quality. While log transforming (1+|CV|) is a possible alternative, log transformation does not restrict the range of the transformed values. In fact, their range remains the same as that of the untransformed |CV|, i.e., [0,<italic>∞</italic>). Hence, log does not guarantee bounded values in transcriptome-wide data, which displays numerous instances of extremely high |CV| for PARS data (data not shown). We use a transformation that yields values of identical order of magnitude as the log transformation for <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| up to ∼ 10<sup>3</sup> and which does not increase to infinity for higher values of <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). A natural choice to transform ratios is to use inverse trigonometric functions. For example, proportions are often transformed using the arcsin function [<xref ref-type="bibr" rid="CR49">49</xref>]. However, arcsin’s domain is limited to [−1,1]. Hence, we transformed |CV|, which can take any positive value, using an arctan function—a monotonic transformation that ranges from 0 to <italic>π</italic>/2 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). arctan(<italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|) is approximately equal to <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| for <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|&lt;1. Additionally, for higher values of <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|, it is close to log10(1+<italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|) when <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| is less than or around order 10<sup>3</sup>. Importantly, arctan(<italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|) asymptotically reaches <italic>π</italic>/2 as <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| increases beyond order 10<sup>3</sup>, whereas log10(1+<italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|) continues to increase with <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|. This is a useful property because we do observe <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|≫10<sup>3</sup> in transcriptome-wide data (not shown). Furthermore, we compared performances of log and arctan transformations in the context of differential analysis with dStruct. In addition, we compared a threshold approach to bound <italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>| by restricting large values to the threshold. We observed identical performances of all three approaches. This is because dStruct utilizes a non-parametric test. In such a test, only the relative ranks of <italic>d</italic> scores are of concern (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). Since log and arctan transformations are both monotonic transformations, using one instead of another alters the absolute magnitudes of <italic>d</italic> scores but not their relative ranks. Nonetheless, for our purpose, the major advantage of the arctan transformation is that it results in values that are bounded to a finite interval. This allows a convenient scaling such that the <italic>d</italic> scores are bound between 0 and 1, which is a desirable feature for interpretation [<xref ref-type="bibr" rid="CR76">76</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10).</p>
      <p>Since arctan(<italic>σ</italic><sub><italic>i</italic></sub>/|<italic>μ</italic><sub><italic>i</italic></sub>|) ranges from 0 to <italic>π</italic>/2, we rescaled it such that it ranges from 0 to 1. Finally, we obtained the following expression for the <italic>d</italic> score: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} d_{i} &amp;=&amp; \frac{2}{\pi} \arctan \left(\frac{\sigma_{i}}{\left| \mu_{i} \right|} \right). \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>arctan</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For reactivity scales that are restricted to non-negative values (e.g., SHAPE), the <italic>d</italic> score will never reach the maximum value of 1. For PARS-type data, positive and negative reactivities carry information about the likelihood of a nucleotide forming or not forming a base pair. However, if the PARS reactivities across samples were such that <italic>μ</italic><sub><italic>i</italic></sub>=0, it would imply that some samples indicated the presence of a base pair at <italic>i</italic> while others indicated the contrary, thereby resulting in <italic>μ</italic><sub><italic>i</italic></sub>=0. Hence, <italic>μ</italic><sub><italic>i</italic></sub>=0 is indicative of maximal dissimilarity between reactivities for nucleotide <italic>i</italic>, and <italic>d</italic><sub><italic>i</italic></sub>=1 when <italic>μ</italic><sub><italic>i</italic></sub>=0.</p>
      <p>Note that we previously reported an approach to quantify agreement between reactivity profiles, which is similar to <italic>d</italic> score, namely, the signal-to-noise ratio (SNR) [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. We demonstrated the utility of SNR in quality control of SP data, where we showed that given several samples of the same group, SNR-based analysis could identify the discordant replicates and regions. SNR was defined as the inverse of the CV and was tested only for SHAPE and DMS data. In addition, we dealt with the sensitivity of the mean SNR to small changes in <italic>σ</italic><sub><italic>i</italic></sub> by restricting its maximum value to 35 based on the properties of the data. The <italic>d</italic> score can be interpreted as a redefinition of SNR. While SNR captures agreement of reactivities, <italic>d</italic> score captures variation. In addition, sensitivity of <italic>d</italic> score to small changes in <italic>μ</italic><sub><italic>i</italic></sub> was reduced by a monotonic transformation of |CV|. As such, the <italic>d</italic> score could be used to replace SNR in quality control applications (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11).</p>
    </sec>
    <sec id="Sec22">
      <title>Overview of dStruct</title>
      <p>We developed dStruct to identify DRRs in three steps. In the first step, we assess the within-group and between-group variation. In the second step, we identify regions that could potentially be DRRs. This step is performed only for de novo discovery. In the third step, the regions identified in the second step are statistically tested to detect DRRs.</p>
      <p>Given the two groups labeled A and B and <italic>m</italic><sub><italic>A</italic></sub> and <italic>m</italic><sub><italic>B</italic></sub> replicate samples from these groups, respectively, let <italic>m</italic>= max(<italic>m</italic><sub><italic>A</italic></sub>,<italic>m</italic><sub><italic>B</italic></sub>). We construct all the possible subsets of the <italic>m</italic><sub><italic>A</italic></sub>+<italic>m</italic><sub><italic>B</italic></sub> samples, such that each subset has <italic>m</italic> samples. Among these subsets, some will be homogeneous, i.e., all the samples in the subset will come from the same group, whereas others will be heterogeneous. In a subset, suppose there are <italic>g</italic><sub><italic>A</italic></sub> samples from group A and <italic>g</italic><sub><italic>B</italic></sub> from group B. For <italic>m</italic>=2, all the heterogeneous subsets will have <italic>g</italic><sub><italic>A</italic></sub>=1 and <italic>g</italic><sub><italic>B</italic></sub>=1. In other words, the ratio of the numbers of samples from the two groups in all the heterogeneous subsets will be 1:1. Similarly, for <italic>m</italic>=3, all the heterogeneous subsets will have either <italic>g</italic><sub><italic>A</italic></sub>=1 and <italic>g</italic><sub><italic>B</italic></sub>=2 or <italic>g</italic><sub><italic>A</italic></sub>=2 and <italic>g</italic><sub><italic>B</italic></sub>=1. The ratio of the numbers of samples from the two groups in all heterogeneous subsets will be 2:1. However, for <italic>m</italic>&gt;3, the heterogeneous subsets can have different ratios. For example, for <italic>m</italic>=4, some heterogeneous subsets will have <italic>g</italic><sub><italic>A</italic></sub>=3;<italic>g</italic><sub><italic>B</italic></sub>=1 or <italic>g</italic><sub><italic>A</italic></sub>=1;<italic>g</italic><sub><italic>B</italic></sub>=3, resulting in a ratio of 3:1, while others will have <italic>g</italic><sub><italic>A</italic></sub>=2;<italic>g</italic><sub><italic>B</italic></sub>=2, resulting in a ratio of 1:1. Hence, for <italic>m</italic>&gt;3, dStruct retains only those heterogeneous subsets which have the highest degree of heterogeneity defined as <italic>g</italic><sub><italic>A</italic></sub><italic>g</italic><sub><italic>B</italic></sub>/<italic>m</italic><sup>2</sup>. For each subset, we assess <italic>d</italic> scores as described before “<xref rid="Sec3" ref-type="sec">Dissimilarity measure</xref>”. We use the nucleotide-wise average of <italic>d</italic> scores from the homogeneous subsets, called <italic>d</italic><sub>within</sub>, as the measure of the within-group variation in the second and the final steps. Similarly, we use the average of the <italic>d</italic> scores from the heterogeneous subsets, called <italic>d</italic><sub>between</sub>, as the measure of the between-group variation.</p>
      <p>Before we describe the second and the third steps, we note that the <italic>d</italic> score is a sample statistic. Hence, it is best estimated from sets with a large number of samples. To ensure high confidence in the estimated <italic>d</italic> scores, we define the number of samples in the homogeneous/heterogeneous sets as <italic>m</italic>= max(<italic>m</italic><sub><italic>A</italic></sub>,<italic>m</italic><sub><italic>B</italic></sub>). However, this definition could be problematic if <italic>m</italic><sub><italic>A</italic></sub> and <italic>m</italic><sub><italic>B</italic></sub> differ by a large number. For example, if <italic>m</italic><sub><italic>A</italic></sub>=5 and <italic>m</italic><sub><italic>B</italic></sub>=1, then under the scheme described above, there will be one homogeneous set with five samples from group A. In addition, there will be five heterogenous sets, each with four samples from group A and one sample from group B. Due to the large concentration of samples from the same group in heterogeneous sets, <italic>d</italic><sub>between</sub> might be low. In fact, <italic>d</italic><sub>between</sub> might be close in magnitude to <italic>d</italic><sub>within</sub>, even in the presence of a differential signal. This could reduce the power because we identify DRRs by comparing <italic>d</italic><sub>between</sub> and <italic>d</italic><sub>within</sub>. Hence, if heterogeneous sets have unequal numbers of samples from A and B, i.e., <italic>g</italic><sub><italic>A</italic></sub>≠<italic>g</italic><sub><italic>B</italic></sub>, we adjust <italic>m</italic> such that the resulting heterogeneous subsets would have equal numbers of samples from both groups. Specifically, we adjust <italic>m</italic> by reducing it in decrements of 1, but not below 3. We stop reducing <italic>m</italic> once <italic>g</italic><sub><italic>A</italic></sub>=<italic>g</italic><sub><italic>B</italic></sub> has been achieved or <italic>m</italic>=3. Notably, we do not reduce <italic>m</italic> below 3 because of the heavy loss in confidence when estimating a statistic (e.g., standard deviation) from two samples instead of three. Hence, whenever possible, we use a minimum set size of three samples to estimate the <italic>d</italic> scores. A properly chosen <italic>m</italic> enables estimation of <italic>d</italic><sub>within</sub> and <italic>d</italic><sub>between</sub>, such that the power could be maximized in the following steps.</p>
      <p>In the second step, we identify candidate regions of lengths greater than or equal to a user-specified search length, <italic>l</italic>. To this end, we define <italic>Δ</italic><italic>d</italic>=<italic>d</italic><sub>between</sub>−<italic>d</italic><sub>within</sub>. We smooth <italic>Δ</italic><italic>d</italic> with a rolling mean over windows of lengths <italic>l</italic>. If the smoothed <italic>Δ</italic><italic>d</italic> is positive for all the nucleotides in a contiguous region of length <italic>l</italic> or longer, we consider the region a potential candidate for DRR. Additional details on this step are noteworthy. They are implemented to ensure a reasonable quality of identified regions. By default, for the sake of constructing candidate regions, we mask <italic>Δ</italic><italic>d</italic> for nucleotides with |<italic>r</italic><sub><italic>i</italic></sub>|&lt;0.1 across all samples. Alteration in reactivity patterns due to changes in the relative magnitudes of very low reactivities is not meaningful. Hence, we mask <italic>Δ</italic><italic>d</italic> for nucleotides with very low reactivities to prevent identification of regions with low signal strength for the majority of nucleotides as candidates. In addition, for the identified regions of length 11 or more, we trim nucleotides with reactivity &lt; 0.1 in all samples from the edges. We do not trim for shorter regions as it can lead to loss of power. Besides this, we require that the identified regions have non-missing <italic>Δ</italic><italic>d</italic> for at least five nucleotides if <italic>l</italic>&gt;5 and for at least <italic>l</italic>−1 nucleotides if <italic>l</italic>≤5 (i.e., <italic>Δ</italic><italic>d</italic> not masked due to low signal strength and not 0/0). This might not be the case in poor quality regions (due to lack of coverage or high background noise) or for short regions identified in data from base-selective probes, such as DMS. Finally, we require that the identified regions have no more than an allowed level of average <italic>d</italic><sub>within</sub>. We impose this requirement because our statistical test only assesses if the between-group variation is significantly more than the within-group variation. However, it is desirable that the reported DRRs have at least moderate correlations within groups to ensure a minimum quality in DRRs. Importantly, filtering out poor-quality, and hence unreliable candidates, before statistical testing could improve power [<xref ref-type="bibr" rid="CR41">41</xref>]. Hence, we set a liberal threshold for average <italic>d</italic><sub>within</sub> in identified regions, i.e., we filter regions with poor within-group correlation but keep those that have moderate to good correlation. In other words, we only filter regions that have highly unreliable reactivity profiles. We call this a <italic>minimum quality threshold</italic>. We require that the average <italic>d</italic><sub>within</sub> be &lt; 0.5 if min(<italic>m</italic><sub><italic>A</italic></sub>,<italic>m</italic><sub><italic>B</italic></sub>)≥2 and &lt; 0.2 if min(<italic>m</italic><sub><italic>A</italic></sub>,<italic>m</italic><sub><italic>B</italic></sub>)=1. Note that average <italic>d</italic> scores of 0.5 and 0.2 correspond to mean SNR values of 1 and ∼ 3, respectively; we have previously shown that these SNR values filter regions with poor agreement between replicate samples and/or poor coverage [<xref ref-type="bibr" rid="CR37">37</xref>], and hence, they are liberal thresholds for quality. We impose a more stringent requirement (chosen based on simulation results) for <italic>d</italic><sub>within</sub> if only one sample is available for one of the groups. This is because in such cases, the within-group variation in one of the groups cannot be estimated. Hence, we utilize a less liberal threshold for <italic>d</italic><sub>within</sub> to compensate for unavailable quality information from one group. Note that while we do not screen for regions if the user inputs candidate regions (guided discovery), even in this case, we require that the candidate regions have no more than an allowed level of average <italic>d</italic><sub>within</sub>. The threshold is set identical to that for de novo discovery. Besides this, for guided discovery, we also require that the median of <italic>Δ</italic><italic>d</italic> in candidate regions be positive for the regions to be called DRRs. We impose this requirement because DRRs are expected to have observable increase in variation from within-group to between-group. The candidate regions that satisfy all the quality criteria are statistically tested in the final step.</p>
      <p>In the third step, we obtain the significance of the differential reactivities in a candidate region (obtained in the second step or provided by the user) by comparing <italic>d</italic><sub>within</sub> and <italic>d</italic><sub>between</sub> for the region. Specifically, we perform a Wilcoxon signed-rank test to test the null hypothesis against a one-sided alternative hypothesis that the population mean of <italic>d</italic><sub>between</sub>−<italic>d</italic><sub>within</sub>&gt;0 [<xref ref-type="bibr" rid="CR52">52</xref>]. The FDR of the screened regions from all transcripts is controlled using the Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="CR53">53</xref>]. Finally, we obtain a list of regions with corresponding <italic>p</italic> values and <italic>q</italic> values.</p>
      <p>It is worthwhile to note that the application of a Wilcoxon signed-rank test to compare <italic>d</italic><sub>within</sub> and <italic>d</italic><sub>between</sub> requires two assumptions under the null hypothesis. First, we assume that if the null hypothesis were true, then <italic>d</italic><sub>within</sub> and <italic>d</italic><sub>between</sub> would be identically distributed. This is a reasonable assumption because a true null hypothesis implies that all the samples are identical, irrespective of the groups they belong to. Hence, the <italic>d</italic> scores assessed from the homogeneous and heterogeneous subsets of the samples should have identical distributions. Second, we assume that under the null hypothesis, <italic>Δ</italic><italic>d</italic> for different nucleotides in a candidate region are independent of each other. This is reasonable under the assumption that <italic>σ</italic><sub><italic>i</italic></sub> is directly proportional to <italic>μ</italic><sub><italic>i</italic></sub> [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR56">56</xref>]. Under this assumption, <italic>σ</italic><sub><italic>i</italic></sub>/<italic>μ</italic><sub><italic>i</italic></sub> should be a constant plus an error term. In other words, while <italic>μ</italic><sub><italic>i</italic></sub> might exhibit correlation between adjacent nucleotides, <italic>σ</italic><sub><italic>i</italic></sub>/<italic>μ</italic><sub><italic>i</italic></sub>, and hence <italic>d</italic><sub><italic>i</italic></sub>, should be independent of <italic>μ</italic><sub><italic>i</italic></sub>. Furthermore, autocorrelation in <italic>μ</italic><sub><italic>i</italic></sub> should not carry over to <italic>Δ</italic><italic>d</italic><sub><italic>i</italic></sub>’s. We confirmed that this is indeed the case for our Structure-Seq data for three identical replicates. We assessed the autocorrelation in the <italic>μ</italic><sub><italic>i</italic></sub> profiles for the mRNAs represented in the data. In addition, we randomly assigned one of the replicates to group A and the other two to group B. We assessed the <italic>Δ</italic><italic>d</italic> profile for each mRNA. Since all replicates were obtained identically, these <italic>Δ</italic><italic>d</italic> profiles represented values under the null hypothesis. Then, we computed the autocorrelation in each <italic>Δ</italic><italic>d</italic> profile. For a lag of 1, we found that the <italic>μ</italic><sub><italic>i</italic></sub>’s had median autocorrelation of 0.2, while the <italic>Δ</italic><italic>d</italic><sub><italic>i</italic></sub>’s had median autocorrelation of 0.02 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). In other words, the <italic>Δ</italic><italic>d</italic><sub><italic>i</italic></sub>’s were essentially uncorrelated under the null hypothesis.</p>
      <sec id="Sec23">
        <title>Software</title>
        <p>An R package implementing dStruct is freely available online under the BSD-2 license. dStruct utilizes the “parallel” package in R to enable faster processing. In addition, it utilizes the “ggplot2” package to provide detailed plots for differentially reactive regions.</p>
      </sec>
    </sec>
    <sec id="Sec24">
      <title>Structure-Seq library preparation and sequencing</title>
      <p>Structure-Seq was adapted from Ding et al. [<xref ref-type="bibr" rid="CR77">77</xref>]. Yeast cells (<italic>S. cerevisiae</italic>, BY4741) were grown to an O.D. of 0.5 ∼0.7 in 50 mL of YP with 2% glucose at 30 <sup>∘</sup>C, and then incubated with 10 mM dimethyl sulfate (DMS) for 10 min at 30 <sup>∘</sup>C with vigorous shaking. To stop the reaction, 75 mL of 4.8 M 2-mercaptoethanol (BME) and 25 mL of isoamyl alcohol were added to the cells. Cells were harvested and pellets were washed once with 5 mL of 4.8 M BME and then once with 5 mL of AE buffer (50 mM sodium acetate pH 5.2, 10 mM EDTA). Total RNA was extracted using acid phenol/chloroform. Polyadenylated RNAs (poly(A) RNAs) were enriched with the Poly(A)Purist MAG kit (ThermoFisher Scientific). The poly(A) RNAs were incubated with TURBO DNase and isolated using acid phenol/chloroform. For each biological replicate, 1 <italic>μ</italic>g of DNase-treated poly(A) RNAs were used to generate cDNAs by SuperScript III (ThermoFisher Scientific) using the random hexamer fused with Illumina TruSeq adaptor (Random-hex RT-primer, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). This reverse transcription (RT) reaction was performed according to the manufacturer’s instruction. The reaction was then stopped by heating the samples at 85 <sup>∘</sup>C for 5 min. After the samples cooled down, they were treated with 1 <italic>μ</italic>L of RNase H (5 U/ <italic>μ</italic>L, ThermoFisher Scientific) to degrade residual RNAs at 37 <sup>∘</sup>C for 20 min. The cDNAs were purified with phenol (pH 8.0)—chloroform extraction and resolved on a 10% denaturing polyacrylamide gel and stained with SYBR Gold. Products with length &gt; 30 nt were collected and eluted from the gel in TEN buffer [<xref ref-type="bibr" rid="CR77">77</xref>] overnight at 4 <sup>∘</sup>C. Gel purified cDNAs were ethanol-precipitated, re-suspended in water, and ligated with an ssDNA linker (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) at 3 <sup>′</sup> ends using CircLigase I (epicenter) as previously described [<xref ref-type="bibr" rid="CR77">77</xref>]. Products &gt; 60 nt were gel purified as above and suspended in 10 <italic>μ</italic>L of water. The ligated cDNAs were subjected to PCR as previously described [<xref ref-type="bibr" rid="CR77">77</xref>]. To identify potential non-specific primer-dimers in the following steps, a non-template control without any cDNA was also included in the PCR reaction. The products were then resolved on a 10% non-denaturing polyacrylamide gel, and only those above 180 bp were gel purified to eliminate primer dimers. After purification, the library was ethanol-precipitated and re-suspended in water. These libraries were analyzed by Agilent Bioanalyzer to determine the size distribution. A total of six libraries, including three samples with and three samples without DMS treatment, were sequenced on the Illumina Hiseq 2500 platform for 2 × 100 bp paired-end cycle run. Note that we performed paired-end sequencing to ensure accurate assessment of local coverage for reactivity calculations [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec25">
      <title>Pre-processing of Structure-Seq data</title>
      <p>Illumina adaptors were removed from the reads using Trimmomatic (version 0.36). Next, cutadapt (version 1.9.1) was used to trim the random trimers from the 5 <sup>′</sup> end of the forward reads. Trimmed reads were aligned to the S288C reference genome (R64-2-1, from the Saccharomyces Genome Database [<xref ref-type="bibr" rid="CR78">78</xref>]) using STAR (version 2.5.2b) [<xref ref-type="bibr" rid="CR79">79</xref>] and only uniquely aligned reads (MAPQ = 255 after mapping) were kept for the subsequent analyses. We mapped the reads once to the whole genome sequence and again to rRNA sequences only. We compared mapping to the genome sequence with mRNA annotations to obtain counts and coverages for use in simulations. The mapping to the rRNAs was used for null comparisons as described in the section on validations with small datasets.</p>
      <p>The annotation for mRNA untranslated regions (UTRs) was derived as follows. The UTRs for each mRNA were obtained from two published datasets [<xref ref-type="bibr" rid="CR80">80</xref>, <xref ref-type="bibr" rid="CR81">81</xref>]. If the UTR coordinates for the same transcript were different in the two datasets, the coordinates with the widest range were used. For mRNAs without UTR annotations, 135 nucleotides (close to the median lengths of all <italic>S. cerevisiae</italic> 5 <sup>′</sup> and 3 <sup>′</sup> UTRs) were added before and after the ORF region as 5 <sup>′</sup> and 3 <sup>′</sup> UTRs. After ignoring genes with sequence overlaps with other genes on the same strand, we retained 4681 mRNAs for use in simulations. Reads were grouped according to their source mRNA, and the start and end indices from genomic alignment of each read were converted to the mRNA coordinates with the start of the 5 <sup>′</sup> UTR as position + 1.</p>
      <p>Due to multiple copies of rRNA sequences in the genome, reads did not map uniquely to rRNA loci. Hence, we separately mapped the reads to the rRNA sequences after adaptor removal and random trimer trimming. The uniquely mapped reads were grouped according to the source rRNA and the start and end indices of each read were converted to a 1-based coordinate system.</p>
    </sec>
    <sec id="Sec26">
      <title>Reactivity calculations</title>
      <p>The reactivity of a nucleotide is a measure of its degree of reaction with the probing reagent. In this study, we used reactivities obtained from the Structure-Seq, SHAPE-Seq, SHAPE-MaP, and PARS protocols. Structure-Seq utilizes DMS as a probing reagent. DMS methylates the base pairing faces of unpaired As and Cs [<xref ref-type="bibr" rid="CR25">25</xref>]. SHAPE-Seq and SHAPE-MaP utilize SHAPE (<italic>s</italic>elective 2 <sup>′</sup>-<italic>h</italic>ydroxyl <italic>a</italic>cylation analyzed by <italic>p</italic>rimer <italic>e</italic>xtension) reagents, which form a 2 <sup>′</sup>−<italic>O</italic>−ester adduct on the RNA backbone [<xref ref-type="bibr" rid="CR22">22</xref>]. The adduct formation is favored at unpaired nucleotides relative to paired ones. This is because the higher flexibility of unpaired nucleotides enables them to adopt conformations favorable for reaction with the SHAPE reagent. Both DMS- and SHAPE-modified nucleotides impact primer extension by reverse transcriptase. The “-Seq” and “-MaP” approaches differ in how they are impacted by nucleotide modification. In “-Seq” approaches, primer extension stops upon encountering a modified nucleotide [<xref ref-type="bibr" rid="CR32">32</xref>]. In “-MaP” approaches, primer extension proceeds upon encountering a modified nucleotide but misreads it, thereby incorporating a noncomplementary nucleotide into the cDNA [<xref ref-type="bibr" rid="CR82">82</xref>]. Besides treating samples with reagents, Structure-Seq, SHAPE-Seq, and SHAPE-MaP utilize untreated samples to assess background noise. On the other hand, PARS utilizes two nucleases, V1 and S1. The V1 and S1 nucleases cleave the RNA strands next to paired and unpaired nucleotides, respectively. A cDNA library is prepared for RNAs treated with the nucleases by primer extension with reverse transcriptase. In all protocols, the cDNA library is sequenced and reads are analyzed to calculate reactivities.</p>
      <p>For Structure-Seq and SHAPE-Seq, the number of reads starting 1 nt downstream of each nucleotide were tallied to get the detection counts for the nucleotide (i.e., detection of reagent-induced modifications and noise in treated samples and noise in untreated samples). In addition, the number of reads starting anywhere upstream of, at, or 1 nt downstream of each nucleotide, and ending anywhere downstream of the nucleotide, were tallied as its local coverage. Detection rates were calculated for each nucleotide as the ratio of detection counts to local coverage [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. Raw reactivities were calculated by combining the information from the treated and untreated samples prepared in the same batch. Raw reactivities, <italic>r</italic><sub><italic>i</italic>,raw</sub>, were obtained as: 
<disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} r_{i,\text{raw}} &amp; = &amp; \max\left(\frac{r_{i}^{+} - r_{i}^{-}}{1 - r_{i}^{-}}, 0 \right)  \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>raw</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:munderover></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{i}^{+}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{i}^{-}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq6.gif"/></alternatives></inline-formula> are the detection rates at nucleotide <italic>i</italic> for treated and untreated samples, respectively [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR83">83</xref>]. Note that it is a common practice to assign a reactivity score of 0 to nucleotides where <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{i}^{-} &gt; r_{i}^{+}$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq7.gif"/></alternatives></inline-formula>, which can happen due to high background noise [<xref ref-type="bibr" rid="CR6">6</xref>]. For Structure-Seq data, due to the base-selective nature of DMS, reactivities for Gs and Us were masked as missing information. This step was skipped for SHAPE-Seq data, as SHAPE reagents probe all four nucleotides. Next, raw reactivities were normalized using a 2–8% approach [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR84">84</xref>], i.e., the top 2% of reactivities were filtered as outliers and the mean of the next 8% reactivities was used to normalize all the reactivities in that sample. This provided a single sample of reactivity profiles for each batch. Normalized SHAPE-MaP reactivities were available directly from the Weeks lab website. For PARS data, we downloaded the V1 and S1 counts for all transcripts, which were available online [<xref ref-type="bibr" rid="CR9">9</xref>]. The nucleotide-wise V1 and S1 counts for each cell line were combined as previously described to obtain PARS scores [<xref ref-type="bibr" rid="CR9">9</xref>], <italic>r</italic><sub><italic>i</italic></sub>, for nucleotide <italic>i</italic>, as: 
<disp-formula id="Equb"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} r_{i} = \log_{2} \left(\frac{V1_{i} + 5}{S1_{i} + 5} \right).  \end{array} $$ \end{document}</tex-math><mml:math id="M26"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"/><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>A small number 5 added to V1 and S1 counts in the above equation prevents over-estimation of PARS scores for nucleotides with low coverage. Note that we use <italic>r</italic><sub><italic>i</italic></sub> to denote PARS scores as well as normalized reactivities from Structure-Seq, SHAPE-Seq, or SHAPE-MaP. Download links for all the datasets used in this study are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2.</p>
    </sec>
    <sec id="Sec27">
      <title>Implementation of deltaSHAPE</title>
      <p>deltaSHAPE was implemented using the software version 1.0 available for download from the Weeks lab website [<xref ref-type="bibr" rid="CR8">8</xref>]. In addition to the reactivity of a nucleotide, deltaSHAPE requires the standard error of the reactivity (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1). It is obtained as the standard deviation of the sampling distribution of the reactivity. It can be computed using theoretical models that require counts and local coverage information for a sample. For the <italic>Xist</italic> long non-coding RNA SHAPE-MaP data, standard errors were available online alongside reactivity data [<xref ref-type="bibr" rid="CR85">85</xref>]. For SHAPE-Seq and Structure-Seq data, we utilized a simplified expression for a formula derived in our previous publication [<xref ref-type="bibr" rid="CR37">37</xref>] to estimate the standard error, SE <sub><italic>i</italic></sub>, at nucleotide <italic>i</italic>: 
<disp-formula id="Equc"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \text{SE}_{i} &amp;=&amp; \frac{1}{f} \sqrt{\frac{r^{+}_{i}}{C^{+}_{i}} + \frac{r^{-}_{i}}{C^{-}_{i}} }, \end{array} $$ \end{document}</tex-math><mml:math id="M28"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mtext>SE</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>f</italic> is the normalization constant for the transcript, obtained using the 2-8% approach [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR84">84</xref>], <italic>r</italic><sup>+</sup> and <italic>r</italic><sup>−</sup> represent the detection rates at nucleotide <italic>i</italic> for the treated and untreated samples, respectively, and <italic>C</italic><sup>+</sup> and <italic>C</italic><sup>−</sup> represent the local coverages in the corresponding samples.</p>
    </sec>
    <sec id="Sec28">
      <title>Implementation of PARCEL</title>
      <p>To the best of our knowledge, no software implementing PARCEL is available publicly. Hence, we implemented PARCEL to the best of our understanding based on descriptions by Tapsin et al. and email correspondence with them [<xref ref-type="bibr" rid="CR21">21</xref>]. We identified DRRs in four steps (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2). We executed all the steps separately for each RNA. First, we ran edgeR on the detection counts for two groups of samples as input [<xref ref-type="bibr" rid="CR36">36</xref>]. For each nucleotide of a candidate RNA, edgeR outputs the logarithm of fold change in detection counts between the groups. In addition, it outputs <italic>p</italic> values quantifying the statistical significances of changes in counts. Let the <italic>p</italic> value for nucleotide <italic>i</italic> be <italic>p</italic><sub><italic>i</italic></sub>. In the second step, we converted the <italic>p</italic><sub><italic>i</italic></sub>’s to scores, <italic>s</italic><sub><italic>i</italic></sub>: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} s_{i} &amp; = &amp; \log \left(0.1 \right) - \log \left(p_{i} \right). \end{array} $$ \end{document}</tex-math><mml:math id="M30"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In simple terms, nucleotides with <italic>p</italic><sub><italic>i</italic></sub>&lt;0.1 received a positive score. We assigned <italic>s</italic><sub><italic>i</italic></sub>=−10 to nucleotides that had 1 or fewer detection counts. In the third step, we utilized a recursive implementation of the Kadane algorithm to identify regions with high aggregate scores [<xref ref-type="bibr" rid="CR86">86</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2 for details). Given the aggregate score of a region, <italic>S</italic>, we assessed the statistical significance of the structural changes in the region in terms of <italic>E</italic> values. <italic>E</italic> values were defined as <italic>E</italic>=<italic>K</italic><italic>e</italic><sup>−<italic>λ</italic><italic>S</italic></sup>. In simple terms, an <italic>E</italic> value represents the number of regions that are expected to have at least as high an aggregate score as <italic>S</italic> if there were no real differential signal. As such, a lower <italic>E</italic> value indicates a more significant differential signal in a region. The values of <italic>K</italic> and <italic>λ</italic> were derived by Tapsin et al. theoretically. These were <italic>K</italic>=0.0809635 and <italic>λ</italic>=0.862871. Hence, given <italic>S</italic> for a region, its <italic>E</italic> value could be computed. We considered a region as having a high score if its <italic>E</italic> value was less than a cutoff. In keeping with Tapsin et al., we used a cutoff of <italic>E</italic>=10 for tests with small datasets. We varied the <italic>E</italic> value cutoff for tests with simulated data. Finally, high-scoring regions were declared as DRRs if they contained at least one nucleotide with (a) Bonferroni-corrected <italic>p</italic><sub><italic>i</italic></sub>&lt;0.1 and (b) absolute value of the logarithm of fold change &gt; 2.</p>
    </sec>
    <sec id="Sec29">
      <title>Implementation of RASA</title>
      <p>We received scripts utilized by Mizrahi et al. for data analysis (correspondence via email) [<xref ref-type="bibr" rid="CR20">20</xref>]. We extracted key steps from their scripts and implemented them in custom written scripts for the sake of computational efficiency and proper code organization. RASA accepts detection counts and local coverages for two groups of samples. In addition, it accepts the mean reactivity of a suitable ribosomal RNA in each sample. The latter information helps account for the normalization requirements for reactivities. To this end, Mizrahi et al. utilized the mean reactivity of 28S rRNA in their study on human SP data. For our tests with <italic>S. cerevisiae</italic> and simulated data, we used the mean reactivities of 25S rRNA in each sample. For the test with fluoride riboswitch data, we used the mean reactivity of the riboswitch in each sample.</p>
      <p>Given the abovementioned information, we identified DRRs in two steps. We executed the first step (regression analysis) separately for each nucleotide. In this step, we fit two generalized mixed models (with logistic regression) to the sample-wise counts and the coverages while also accounting for variation in the mean reactivities of samples. The null model assumed no effect of grouping of the samples. It attempted to explain the variation in detection rates from one sample to another as inherent biological variation. The alternative model considered the possibility of differential signal between the groups in addition to the biological variation. We compared the goodness of fit from the two models using a likelihood ratio test. In the presence of a real differential signal, the alternative model is expected to fit the data better. Hence, we summarized the output of the likelihood ratio test in terms of a <italic>p</italic> value to quantify the statistical significance of the improvement in the fit by the alternative model. In addition, the alternative model provided an assessment of the change in detection rates between the groups. If the <italic>p</italic> value for a nucleotide was &lt; 0.01 and its absolute fold change in detection rates was &gt; 1.33, the nucleotide was said to have a significant change in reactivity. We call such nucleotides as altered nucleotides.</p>
      <p>In the second step, we searched for regions where altered nucleotides were clustered (spatial analysis). This step was executed separately for each RNA. We scanned an RNA in windows of a specified length. Mizrahi et al. used 50 nt as the window length. We used 50 nt for the <italic>S. cerevisiae</italic> rRNAs, 5 nt for the fluoride riboswitch data, and 11 nt for the simulated data (for justifications, see the relevant subsections of the “<xref rid="Sec2" ref-type="sec">Results</xref>” section). Let the number of altered nucleotides in a window centered at nucleotide <italic>i</italic> be <italic>w</italic><sub><italic>i</italic></sub>. We recorded two parameters for each transcript. The first parameter was the maximum value of <italic>w</italic><sub><italic>i</italic></sub>. The second was the chi-square distance of the observed distribution of <italic>w</italic><sub><italic>i</italic></sub>’s from their expected distribution in the absence of a differential signal. Specifically, in the absence of a differential signal, the <italic>w</italic><sub><italic>i</italic></sub>’s should follow a Poisson distribution with the mean equal to the observed mean of the <italic>w</italic><sub><italic>i</italic></sub>’s. Hence, we calculated the second parameter as the chi-square distance of the observed distribution and the expected Poisson distribution. In addition, we assessed both parameters for 1000 permutations of the observed arrangement of altered nucleotides. The permuted arrangements provided null values for the parameters. Next, we computed <italic>Z</italic> scores for each parameter value by comparing their observed values with the distribution of null values. Finally, we classified region(s) with the highest <italic>w</italic><sub><italic>i</italic></sub> and <italic>Z</italic>&gt;2 for both parameters as DRRs.</p>
      <p>A few more details are worth noting. In keeping with Mizrahi et al.’s implementation, we excluded nucleotides with untreated sample detection rates greater than 0.008 for As and 0.005 for Cs from the first step. We performed this filtering for both the real and the simulated Structure-Seq data. However, we skipped the filtering for the fluoride riboswitch as the cutoffs for untreated sample detection rates from SHAPE data were unknown. Moreover, due to the high quality of the fluoride riboswitch data, the untreated sample detection rates were generally low (median ∼ 0.002). In addition, if the local coverage at a nucleotide was greater than 10,000, we scaled down the local coverage to 10,000. For such nucleotides, we also scaled the detection count, such that the detection rate remained constant. The scaling was done to reduce the computational burden of performing regression analysis for each nucleotide separately.</p>
    </sec>
    <sec id="Sec30">
      <title>Simulations</title>
      <p>We added simulated DRRs to experimentally obtained Structure-Seq data for three replicate samples of <italic>S. cerevisiae</italic>. To start with, we selected regions with lengths ranging from 50–75 nt out of 4681 mRNAs. We required that the selected regions have a minimum local coverage of &gt; 25 and be among the top ∼ 20% of the mRNAs sorted according to average coverage. In addition, we allowed for more than one region in the same transcript. In total, out of the regions that satisfied the coverage criteria, we obtained 1000 regions in 630 mRNAs. Let us represent the selected regions as <italic>R</italic><sub><italic>i</italic></sub>, with <italic>i</italic> ranging from 1 to 1000. For each selected region, we simulated three reactivity profiles, one labeled group A and the other two as two samples of group B. The typical way to simulate reactivity profiles given a secondary structure for a region is to sample reactivities randomly from probability density functions for reactivities of paired and unpaired nucleotides [<xref ref-type="bibr" rid="CR54">54</xref>, <xref ref-type="bibr" rid="CR55">55</xref>]. However, such an approach results in zero correlation between replicates (data not shown). Hence, it does not result in realistic simulations as real data exhibits correlation within groups as well as between groups even in DRRs. Hence, we developed a new approach to simulate data for replicates, which displays a range of within-group and between-group correlations as well as between-group correlations. In what follows, we describe how we simulated reactivities and controlled the correlations within and between groups.</p>
      <p>To simulate a reactivity profile for a region <italic>R</italic><sub><italic>i</italic></sub>, first, we sampled 1000 secondary structures using its mRNA sequence as input to RNAsubopt (ViennaRNA package) [<xref ref-type="bibr" rid="CR63">63</xref>]. We retained only the unique structures from those returned by RNAsubopt. In addition, we ensured that the MFE structure was represented in this set. Let us denote the generated structures for region <italic>R</italic><sub><italic>i</italic></sub> by <italic>T</italic><sub><italic>ij</italic></sub>, where <italic>j</italic> ranges from 1 to the number of unique structures for <italic>R</italic><sub><italic>i</italic></sub>. For each <italic>T</italic><sub><italic>ij</italic></sub>, we generated a reactivity profile. To this end, we used patteRNA (with argument “-l”) to fit a Gaussian mixture model to our experimental data [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR64">64</xref>]. Note that the fitting was done on the average reactivity profile from the three samples. Next, given a sequence of base pairing states for <italic>T</italic><sub><italic>ij</italic></sub>, we sampled reactivities using the fitted model (we used scripts published with patteRNA for this purpose). Hence, for each region, we obtained a set of secondary structures and a reactivity profile for each structure. Let us denote the reactivity profile for structure <italic>T</italic><sub><italic>ij</italic></sub> as <italic>r</italic><sub><italic>k</italic>,<italic>i</italic><italic>j</italic></sub>, where <italic>k</italic> ranges from 1 to the length of <italic>R</italic><sub><italic>i</italic></sub>. The final reactivity profile, denoted <italic>r</italic><sub><italic>k</italic>,<italic>i</italic></sub>, for <italic>R</italic><sub><italic>i</italic></sub> for each sample was an ensemble-weighted average of <italic>r</italic><sub><italic>k</italic>,<italic>i</italic><italic>j</italic></sub>. Hence, we assigned each secondary structure an ensemble weight such that all ensemble weights summed to 1. For each <italic>R</italic><sub><italic>i</italic></sub>, the <italic>T</italic><sub><italic>ij</italic></sub>’s were divided into two categories—dominant structures (up to 5 in number) and infrequent structures. The dominant structures received a total ensemble weight between 0.33–0.66. The remaining ensemble weight was randomly distributed among the infrequent structures. Let us denote the ensemble weight for <italic>T</italic><sub><italic>ij</italic></sub> by <italic>w</italic><sub><italic>ij</italic></sub>. Then, the reactivity profile of an <italic>R</italic><sub><italic>i</italic></sub> was obtained as <inline-formula id="IEq8"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{k,i} = \sum _{j} w_{ij}r_{k,ij}.$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq8.gif"/></alternatives></inline-formula></p>
      <p>The three samples differed in the assignment of ensemble weights. We ensured that the two groups had different structure ensembles by ensuring that the sets of dominant structures for groups A and B are disjoint. Let us represent the <italic>w</italic><sub><italic>ij</italic></sub>’s for groups A and B by <italic>w</italic><sub><italic>i</italic><italic>j</italic>,<italic>A</italic></sub> and <italic>w</italic><sub><italic>i</italic><italic>j</italic>,<italic>B</italic></sub>, respectively. In addition, we ensured that the <italic>r</italic><sub><italic>k</italic>,<italic>i</italic></sub>’s displayed a range of within-group and between-group variations as quantified in terms of within-group and between-group Pearson correlation coefficients. Note that the between-group correlation coefficient was obtained as the average of the correlation coefficients from comparing a sample from group A with two samples from group B. To ensure a range of within-group correlations, we added random noise to <italic>w</italic><sub><italic>i</italic><italic>j</italic>,<italic>B</italic></sub> to represent two replicates from group B. The parameters and probability density functions for adding random noise were tuned by trial and error to ensure that a range of within-group correlations was obtained. In addition, to ensure a range of between-group correlations, we controlled the ensemble weight for the MFE structure in <italic>w</italic><sub><italic>i</italic><italic>j</italic>,<italic>A</italic></sub> and <italic>w</italic><sub><italic>i</italic><italic>j</italic>,<italic>B</italic></sub>. Increasing the weight of the MFE structure in both groups to identical levels increased the between-group correlations. The parameters and probability density function dictating the selected level of MFE for an <italic>R</italic><sub><italic>i</italic></sub> were tuned based on a trial-and-error approach to ensure that a range of between-group correlations was obtained. Overall, we used five sets of parameters and probability density functions tuned by trial-and-error to obtain a range of within-group and between-group correlations for selected <italic>R</italic><sub><italic>i</italic></sub>’s (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). In keeping with the base-selective nature of DMS, reactivities for Gs and Us were masked as missing information in all simulated profiles. Then, <italic>r</italic><sub><italic>k</italic>,<italic>i</italic></sub>’s for each sample were normalized using the 2–8% approach. After normalization, these <italic>r</italic><sub><italic>k</italic>,<italic>i</italic></sub>’s replaced experimentally obtained reactivity profiles in the corresponding <italic>R</italic><sub><italic>i</italic></sub>’s and samples. Let us represent the final reactivity for a transcript <italic>t</italic> as <italic>r</italic><sub><italic>k</italic>,<italic>t</italic></sub>, where <italic>k</italic> ranges from 1 to the transcript’s length.</p>
      <p>In addition to simulating reactivities, we needed counts and coverage information for running deltaSHAPE. Hence, we back-calculated count profiles that corresponded to <italic>r</italic><sub><italic>k</italic>,<italic>t</italic></sub>’s. We preserved the experimentally observed hit rates of DMS on an mRNA (estimated as the sum of raw experimental reactivities [<xref ref-type="bibr" rid="CR32">32</xref>]) for all mRNAs, their untreated detection rates/counts and local coverages in both the treated and untreated samples. With these pieces fixed, only the counts from the treated samples remained unknown. First, we estimated raw reactivities corresponding to <italic>r</italic><sub><italic>k</italic>,<italic>t</italic></sub>’s. Let the hit rate of transcript <italic>t</italic> be <italic>h</italic><sub><italic>t</italic></sub>. Then, raw reactivities for the transcript were obtained as <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\nicefrac {r_{k,t}h_{t}}{\sum _{k} r_{k,t}}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq9.gif"/></alternatives></inline-formula>. To these, we added the untreated sample detection rates to get the treated detection rates. Multiplying the treated detection rates and treated local coverages and rounding the result provided the treated sample counts. The back-calculated counts and local coverages were used along with the <italic>r</italic><sub><italic>k</italic>,<italic>t</italic></sub>’s when running deltaSHAPE as described earlier.</p>
      <p>dStruct, deltaSHAPE, PARCEL, and RASA were used to identify DRRs in the simulated data. We ran these for a range of parameter values more conservative as well as more liberal than the default parameters. For dStruct, we varied the minimum quality criterion for candidate regions, specified in terms of average <italic>d</italic><sub>within</sub>. The maximum allowed value of average <italic>d</italic><sub>within</sub> ranged from 0.1 to 0.5. <italic>d</italic><sub>within</sub> of 0.1 and 0.5 correspond to mean SNR &gt; 6 (stringent high quality criterion) and &gt; 1 (very liberal quality criterion), respectively [<xref ref-type="bibr" rid="CR37">37</xref>]. For deltaSHAPE, we varied the colocalization requirement for the number of screened nucleotides with a high reactivity change. At minimum, colocalization of two nucleotides (liberal criterion) within a search window of 11 nt was required to define a DRR, and we increased this requirement to up to six nucleotides (conservative criterion). For PARCEL, we varied the <italic>E</italic> value cutoff. Lower cutoffs amount to a more conservative criterion. The tested cutoff values ranged from 5 (conservative criterion) to 10000 (liberal criterion). For RASA, we varied the <italic>Z</italic> score cutoffs. Higher cutoffs amount to a more stringent criterion. The tested cutoff values ranged from 1 (liberal criterion) to 5 (conservative criterion).</p>
    </sec>
    <sec id="Sec31">
      <title>List of single-nucleotide variants for validation with PARS data</title>
      <p>We obtained a list of single-nucleotide variants from the supplementary information provided by Wan et al. [<xref ref-type="bibr" rid="CR9">9</xref>]. The list contained only those regions with variants (1907 in number), which were found to be riboSNitches by StrucDiff. Of these, 1576 variants were such that two cell lines out of the mother, father, and child trio were allelically identical. Note that none of these 1576 variants were independently validated by Wan et al. to be structure altering. We considered the PARS profiles of cell lines that were allelically identical for a variant as biological replicates for the 11 nt centered at the variable nucleotide. However, not all of the 1576 variants were unique. There were several duplicates of variants at the same genomic location. The duplicates corresponded to related transcripts, which were either splicing variants of the same gene or splicing variants of a gene and their fusion products with a neighboring gene. We verified that the counts in at least the 11 nt window centered at the variant for the related transcripts were exactly identical for all three cell lines. Hence, we collapsed all duplicates to a single variant. This resulted in 351 variants. While Wan et al.’s pairwise approach ensured that at least 2 of the 3 cell lines had high coverages for the reported variants, it did not ensure that all three had high coverage. Therefore, from the reduced set of 351 variants, we further filtered out variants that had average counts less than 10 in an 11-nt window around the variant, i.e., a variant at site <italic>k</italic> was excluded if <inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {1}{11}{\sum \nolimits }_{i=k-5}^{k+5} \left (V1_{i} +S1_{i}\right) &lt; 10$\end{document}</tex-math><mml:math id="M36"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>V</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq10.gif"/></alternatives></inline-formula> for any of the 3 cell lines. In total, we retained 323 variants for our analysis.</p>
    </sec>
    <sec id="Sec32">
      <title>Implementation of StrucDiff</title>
      <p>To the best of our knowledge, no software implementation of StructDiff is available. Hence, we implemented it as described by Wan et al. [<xref ref-type="bibr" rid="CR9">9</xref>] using custom scripts. First, we smoothed the V1 and S1 counts using a rolling mean in windows of 5 nt. We obtained smoothed PARS scores, <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {r}_{i}$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq11.gif"/></alternatives></inline-formula>, for nucleotide <italic>i</italic> from the smoothed counts: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \overline{r}_{i} = \log_{2} \left(\sum\limits_{j= i - 2}^{i+2} \frac{V1_{j} + 5}{5} \right) - \log_{2} \left(\sum\limits_{j= i - 2}^{i+2} \frac{S1_{j} + 5}{5} \right). \end{array} $$ \end{document}</tex-math><mml:math id="M40"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Second, we calculated the absolute difference in the smoothed PARS scores, <inline-formula id="IEq12"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \overline {r}_{i}$\end{document}</tex-math><mml:math id="M42"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq12.gif"/></alternatives></inline-formula>, between any pair of samples, say father (denoted with subscript <italic>f</italic>) and child (denoted with subscript <italic>c</italic>), as <inline-formula id="IEq13"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \overline {r}_{i} = \left | \overline {r}_{i,f} - \overline {r}_{i,c} \right |$\end{document}</tex-math><mml:math id="M44"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq13.gif"/></alternatives></inline-formula>. Third, in terms of <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \overline {r}_{i}$\end{document}</tex-math><mml:math id="M46"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq14.gif"/></alternatives></inline-formula>, we estimated the structural change score, <italic>v</italic><sub>SNV</sub>, around a single-nucleotide variant at site <italic>k</italic> as: 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  v_{\text{SNV}} &amp; = &amp; \frac{1}{5} \sum\limits_{i = k-2}^{k+2} \Delta\overline{r}_{i}. \end{array} $$ \end{document}</tex-math><mml:math id="M48"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>SNV</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1641_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Fourth, we assessed the statistical significance of the observed <italic>v</italic><sub>SNV</sub>. To this end, we permuted the sequence of non-zero <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \overline {r}_{i}$\end{document}</tex-math><mml:math id="M50"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1641_Article_IEq15.gif"/></alternatives></inline-formula> values 1000 times. For each permuted sequence, we assessed a structural change score under the null hypothesis, <italic>v</italic><sub>null</sub>, which we defined similarly to <italic>v</italic><sub>SNV</sub>. A <italic>p</italic> value was estimated for a single-nucleotide variant as the fraction of <italic>v</italic><sub>null</sub> values greater than the corresponding <italic>v</italic><sub>SNV</sub>. We used this implementation to estimate the <italic>p</italic> values for a subset of riboSNitches reported by Wan et al. The subset was selected by screening for variants that were (i) shared by at least 2 related transcripts, (ii) had identical V1 and S1 counts in an 11-nt window around a shared variant for the related transcripts, and (iii) were not classified identically by StrucDiff in the context of all related transcripts that shared the variant, i.e., in some contexts, the variant was classified as structure altering and in other contexts, it was classified as not structure altering.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec33">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1641_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary information. Detailed overview of deltaSHAPE, PARCEL, RASA, StrucDif,f and classSNitch, supplementary figures and tables. The download links for all datasets used in this study and organization of data on Zenodo are described in <bold>Table S2</bold>. (PDF 11,040 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DRR</term>
        <def>
          <p>Differentially reactive region</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p>False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>MFE</term>
        <def>
          <p>Minimum free energy</p>
        </def>
      </def-item>
      <def-item>
        <term>SP</term>
        <def>
          <p>Structure profiling or structure probing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Availability of data and materials</bold>
      </p>
      <p>dStruct is written in R version 3.4.1. The source code is freely available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/AviranLab/dStruct">https://github.com/AviranLab/dStruct</ext-link>
under the BSD-2 license [<xref ref-type="bibr" rid="CR87">87</xref>]. Data and scripts supporting the conclusions of this article are available on Zenodo at 10.5281/zenodo.2536501 [<xref ref-type="bibr" rid="CR88">88</xref>]. The Zenodo link provides the experimental counts, coverages and reactivities for all the Structure-Seq samples. These were obtained by pre-processing sequencing data and summarizing the mapped reads for reactivity calculations as described in “<xref rid="Sec20" ref-type="sec">Methods</xref>” section. The simulated reactivity profiles that were used in conjunction with experimental data for the results illustrated in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4-S6 are also available on Zenodo. The organization of data on Zenodo is described in a note with Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2. The original datasets used in this study are available at the links listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2. These can be obtained from the following online sources:</p>
      <p>Zenodo: 10.5281/zenodo.2536501 [<xref ref-type="bibr" rid="CR88">88</xref>]</p>
      <p>RMDB: <ext-link ext-link-type="uri" xlink:href="https://rmdb.stanford.edu/search/?sstring=FLUORSW_BZCN">https://rmdb.stanford.edu/search/?sstring=FLUORSW_BZCN</ext-link>, RMDB_IDs: FLUORSW_BZCN_0021, FLUORSW_BZCN_0024, FLUORSW_BZCN_0027, FLUORSW_BZCN_0028, FLUORSW_BZCN_0029, FLUORSW_BZCN_0030, FLUORSW_BZCN_0031, FLUORSW_BZCN_0032 [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR89">89</xref>]</p>
      <p>AviranLab GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/AviranLab/SPEQC">https://github.com/AviranLab/SPEQC</ext-link> [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR90">90</xref>]</p>
      <p>Weeks lab repository: <ext-link ext-link-type="uri" xlink:href="http://www.chem.unc.edu/rna">http://www.chem.unc.edu/rna</ext-link> [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR85">85</xref>, <xref ref-type="bibr" rid="CR91">91</xref>]</p>
      <p>GEO: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE50676">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE50676</ext-link> [<xref ref-type="bibr" rid="CR92">92</xref>]</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Mirko Ledda for numerous helpful discussions, Pierce Radecki, Sana Vaziri and Mirko Ledda for critically reading the manuscript, Aharon Nachshon and Niranjan Nagarajan for answering questions regarding RASA and PARCEL, respectively and, two anonymous reviewers for providing constructive criticism that helped improve the manuscript.</p>
    <sec id="d29e5326">
      <title>Funding</title>
      <p>This work was supported by the National Human Genome Research Institute grant R00-HG006860 to SA, National Institute of General Medical Sciences grant R01-GM097332 and P30CA023168 for core facilities at the Purdue University Center for Cancer Research to EJT and for a bioinformatics fellowship to YL.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>KC and SA developed the method and analyzed the data. YL and EJT designed and performed the Structure-Seq experiments. KC and YL pre-processed the Structure-Seq data. KC and SA wrote the manuscript with input from YL and EJT. KC implemented the <italic>dStruct</italic> software package. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec>
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec>
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharp</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>The centrality of RNA</article-title>
        <source>Cell</source>
        <year>2009</year>
        <volume>136</volume>
        <issue>4</issue>
        <fpage>577</fpage>
        <lpage>80</lpage>
        <?supplied-pmid 19239877?>
        <pub-id pub-id-type="pmid">19239877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortimer</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kidwell</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Doudna</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Insights into RNA structure and function from genome-wide studies</article-title>
        <source>Nat Rev Genet</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>469</fpage>
        <?supplied-pmid 24821474?>
        <pub-id pub-id-type="pmid">24821474</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwok</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Assmann</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Bevilacqua</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>The RNA structurome: transcriptome-wide structure probing with next-generation sequencing</article-title>
        <source>Trends Biochem Sci</source>
        <year>2015</year>
        <volume>40</volume>
        <issue>4</issue>
        <fpage>221</fpage>
        <lpage>32</lpage>
        <?supplied-pmid 25797096?>
        <pub-id pub-id-type="pmid">25797096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kubota</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spitale</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>RNA structure: merging chemistry and genomics for a holistic perspective</article-title>
        <source>BioEssays</source>
        <year>2015</year>
        <volume>37</volume>
        <issue>10</issue>
        <fpage>1129</fpage>
        <lpage>38</lpage>
        <?supplied-pmid 26288173?>
        <pub-id pub-id-type="pmid">26288173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
        </person-group>
        <article-title>Decoding the RNA structurome</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2016</year>
        <volume>36</volume>
        <fpage>142</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 26923056?>
        <pub-id pub-id-type="pmid">26923056</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choudhary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparative and integrative analysis of RNA structural profiling data: current practices and emerging questions</article-title>
        <source>Quant Biol</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <lpage>24</lpage>
        <?supplied-pmid 28717530?>
        <pub-id pub-id-type="pmid">28717530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitale</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>QC</given-names>
          </name>
          <name>
            <surname>Crisalli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Kuchelmeister</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Batista</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Torre</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Kool</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
        </person-group>
        <article-title>Structural imprints in vivo decode RNA regulatory mechanisms</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>519</volume>
        <issue>7544</issue>
        <fpage>486</fpage>
        <lpage>90</lpage>
        <?supplied-pmid 25799993?>
        <pub-id pub-id-type="pmid">25799993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smola</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Calabrese</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Detection of RNA–protein interactions in living cells with SHAPE</article-title>
        <source>Biochemistry</source>
        <year>2015</year>
        <volume>54</volume>
        <issue>46</issue>
        <fpage>6867</fpage>
        <lpage>875</lpage>
        <?supplied-pmid 26544910?>
        <pub-id pub-id-type="pmid">26544910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>QC</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Manor</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spitale</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
        </person-group>
        <article-title>Landscape and variation of RNA secondary structure across the human transcriptome</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>505</volume>
        <fpage>706</fpage>
        <?supplied-pmid 24476892?>
        <pub-id pub-id-type="pmid">24476892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watters</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Strobel</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lis</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Lucks</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Cotranscriptional folding of a riboswitch at nucleotide resolution</article-title>
        <source>Nat Struct Mol Biol</source>
        <year>2016</year>
        <volume>23</volume>
        <fpage>1124</fpage>
        <?supplied-pmid 27798597?>
        <pub-id pub-id-type="pmid">27798597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tambe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Doudna</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>RNA-guided assembly of Rev-RRE nuclear export complexes</article-title>
        <source>eLife</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>e03656</fpage>
        <?supplied-pmid 25163983?>
        <pub-id pub-id-type="pmid">25163983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strobel</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Watters</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Nedialkov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Artsimovitch</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lucks</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Distributed biotin–streptavidin transcription roadblocks for mapping cotranscriptional RNA folding</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>12</issue>
        <fpage>109</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watters</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lucks</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Probing of RNA structures in a positive sense RNA virus reveals selection pressures for structural elements</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>5</issue>
        <fpage>2573</fpage>
        <lpage>584</lpage>
        <?supplied-pmid 29294088?>
        <pub-id pub-id-type="pmid">29294088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Guo JU, Bartel DP. RNA G-quadruplexes are globally unfolded in eukaryotic cells and depleted in bacteria. Science. 2006;353(6306). 10.1126/science.aaf5371.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barnwal</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Godin</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Yip</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lavender</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Varani</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Structure and mechanism of a molecular rheostat, an RNA thermometer that modulates immune evasion by <italic>Neisseria meningitidis</italic></article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>19</issue>
        <fpage>9426</fpage>
        <lpage>9437</lpage>
        <?supplied-pmid 27369378?>
        <pub-id pub-id-type="pmid">27369378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Righetti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Nuss</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Twittenhoff</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beele</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Dersch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Narberhaus</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Temperature-responsive in vitro RNA structurome of <italic>Yersinia pseudotuberculosis</italic></article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>26</issue>
        <fpage>7237</fpage>
        <?supplied-pmid 27298343?>
        <pub-id pub-id-type="pmid">27298343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Lackey L, Coria A, Woods C, McArthur E, Laederach A. Allele-specific SHAPE-MaP assessment of the effects of somatic variation and protein binding on mRNA structure. RNA. 2018. 10.1261/rna.064469.117. <ext-link ext-link-type="uri" xlink:href="http://rnajournal.cshlp.org/content/early/2018/01/09/rna.064469.117.full.pdf+html">http://rnajournal.cshlp.org/content/early/2018/01/09/rna.064469.117.full.pdf+html</ext-link>. Accessed 9 Jan 2018.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burlacu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lackmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Aguilar</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Belikov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nues</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Trahan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hector</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Dominelli-Whiteley</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cockroft</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wieslander</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Oeffinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Granneman</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>High-throughput RNA structure probing reveals critical folding events during early 60S ribosome assembly in yeast</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>714</fpage>
        <?supplied-pmid 28959008?>
        <pub-id pub-id-type="pmid">28959008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talkish</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Woolford</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>McManus</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Mod-seq: high-throughput sequencing for chemical probing of RNA structure</article-title>
        <source>RNA</source>
        <year>2014</year>
        <volume>20</volume>
        <issue>5</issue>
        <fpage>713</fpage>
        <lpage>20</lpage>
        <?supplied-pmid 24664469?>
        <pub-id pub-id-type="pmid">24664469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mizrahi</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Nachshon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shitrit</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gelbart</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Dobesova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kahana</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stern-Ginossar</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Virus-induced changes in mRNA secondary structure uncover cis-regulatory elements that directly control gene expression</article-title>
        <source>Mol Cell</source>
        <year>2018</year>
        <volume>72</volume>
        <issue>5</issue>
        <fpage>862</fpage>
        <lpage>874.e5</lpage>
        <?supplied-pmid 30318442?>
        <pub-id pub-id-type="pmid">30318442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tapsin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>XN</given-names>
          </name>
          <name>
            <surname>Susanto</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lezhava</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide identification of natural RNA aptamers in prokaryotes and eukaryotes</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1289</fpage>
        <?supplied-pmid 29599443?>
        <pub-id pub-id-type="pmid">29599443</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weeks</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Advances in RNA structure analysis by chemical probing</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>295</fpage>
        <lpage>304</lpage>
        <?supplied-pmid 20447823?>
        <pub-id pub-id-type="pmid">20447823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Knapp</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>[16 ] Enzymatic approaches to probing of RNA secondary and tertiary structure</article-title>
        <source>Methods in Enzymology, vol. 180</source>
        <year>1989</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwok</surname>
            <given-names>CK</given-names>
          </name>
        </person-group>
        <article-title>Dawn of the in vivo RNA structurome and interactome</article-title>
        <source>Biochemical Society Transactions</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>5</issue>
        <fpage>1395</fpage>
        <lpage>410</lpage>
        <?supplied-pmid 27911722?>
        <pub-id pub-id-type="pmid">27911722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bevilacqua</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Assmann</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>In vivo genome-wide profiling of RNA secondary structure reveals novel regulatory features</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>505</volume>
        <fpage>696</fpage>
        <?supplied-pmid 24270811?>
        <pub-id pub-id-type="pmid">24270811</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smola</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Busan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Siegfried</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Selective 2’-hydroxyl acylation analyzed by primer extension and mutational profiling (SHAPE-MaP) for direct, versatile and accurate RNA structure analysis</article-title>
        <source>Nat Protoc</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>1643</fpage>
        <?supplied-pmid 26426499?>
        <pub-id pub-id-type="pmid">26426499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lucks</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Mortimer</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Doudna</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed RNA structure characterization with selective 2’-hydroxyl acylation analyzed by primer extension sequencing (SHAPE-Seq)</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>27</issue>
        <fpage>11063</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 21642531?>
        <pub-id pub-id-type="pmid">21642531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hector</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Burlacu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aitken</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bihan</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Tuijtel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zaplatina</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Granneman</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snapshots of pre-rRNA structural flexibility reveal eukaryotic 40S assembly dynamics at nucleotide resolution</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>19</issue>
        <fpage>12138</fpage>
        <lpage>54</lpage>
        <?supplied-pmid 25200078?>
        <pub-id pub-id-type="pmid">25200078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poulsen</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Kielpinski</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Salama</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vinther</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SHAPE selection (SHAPES) enrich for RNA structure signal in SHAPE sequencing-based probing data</article-title>
        <source>RNA</source>
        <year>2015</year>
        <volume>21</volume>
        <issue>5</issue>
        <fpage>1042</fpage>
        <lpage>1052</lpage>
        <?supplied-pmid 25805860?>
        <pub-id pub-id-type="pmid">25805860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Selega</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sirocchi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iosub</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Granneman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Robust statistical modeling improves sensitivity of high-throughput RNA structure probing experiments</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <?supplied-pmid 27819660?>
        <pub-id pub-id-type="pmid">27819660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tambe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>PROBer provides a general toolkit for analyzing sequencing-based toeprinting assays</article-title>
        <source>Cell Syst</source>
        <year>2017</year>
        <volume>4</volume>
        <issue>5</issue>
        <fpage>568</fpage>
        <lpage>74</lpage>
        <?supplied-pmid 28501650?>
        <pub-id pub-id-type="pmid">28501650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lucks</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>RNA structure characterization from chemical mapping experiments</article-title>
        <source>2011 49th Annual Allerton Conference on Communication, Control, and Computing</source>
        <year>2011</year>
        <publisher-loc>Monticello</publisher-loc>
        <publisher-name>IEEE</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ledda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PATTERNA: transcriptome-wide search for functional RNA elements via structural data signatures</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>28</fpage>
        <?supplied-pmid 29495968?>
        <pub-id pub-id-type="pmid">29495968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kutchko</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Laederach</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Transcending the prediction paradigm: novel applications of SHAPE to RNA function and evolution</article-title>
        <source>Wiley Interdiscip Rev RNA</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1374</fpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Woods</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Laederach</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Classification of RNA structure change by ‘gazing’ at experimental data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>11</issue>
        <fpage>1647</fpage>
        <lpage>55</lpage>
        <?supplied-pmid 28130241?>
        <pub-id pub-id-type="pmid">28130241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choudhary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shih</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ledda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Metrics for rapid quality control in RNA structure probing experiments</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>23</issue>
        <fpage>3575</fpage>
        <lpage>583</lpage>
        <?supplied-pmid 27497441?>
        <pub-id pub-id-type="pmid">27497441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choudhary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Shih</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>SEQualyzer: interactive tool for quality control and exploratory analysis of high-throughput RNA structural profiling data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>441</fpage>
        <lpage>3</lpage>
        <?supplied-pmid 28172632?>
        <pub-id pub-id-type="pmid">28172632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kutchko</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Plante</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Vincent</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Cruz Cisneros</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Moorman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Heise</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Laederach</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Structural divergence creates new functional features in alphavirus genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>7</issue>
        <fpage>3657</fpage>
        <lpage>670</lpage>
        <?supplied-pmid 29361131?>
        <pub-id pub-id-type="pmid">29361131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaziri</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koehl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Extracting information from RNA SHAPE data: Kalman filtering approach</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>0207029</fpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goeman</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Solari</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Multiple hypothesis testing in genomics</article-title>
        <source>Stat Med</source>
        <year>2014</year>
        <volume>33</volume>
        <issue>11</issue>
        <fpage>1946</fpage>
        <lpage>78</lpage>
        <?supplied-pmid 24399688?>
        <pub-id pub-id-type="pmid">24399688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Statistical modeling of RNA structure profiling experiments enables parsimonious reconstruction of structure landscapes</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>606</fpage>
        <?supplied-pmid 29426922?>
        <pub-id pub-id-type="pmid">29426922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rouskin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zubradt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide probing of RNA structure reveals active unfolding of mRNA structures in vivo</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>505</volume>
        <fpage>701</fpage>
        <?supplied-pmid 24336214?>
        <pub-id pub-id-type="pmid">24336214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wells</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Igel</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Ares</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Use of dimethyl sulfate to probe RNA structure in vivo</article-title>
        <source>Methods Enzymol</source>
        <year>2000</year>
        <volume>318</volume>
        <fpage>479</fpage>
        <lpage>92</lpage>
        <?supplied-pmid 10890007?>
        <pub-id pub-id-type="pmid">10890007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <mixed-citation publication-type="other">Tack DC, Tang Y, Ritchey LE, Assmann SM, Bevilacqua PC. StructureFold2: Bringing chemical probing data into the computational fold of RNA structural analysis. Methods. 2018. 10.1016/j.ymeth.2018.01.018.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Halvorsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Davis-Neulander</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ritz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gopinath</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beauregard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laederach</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Structural effects of linkage disequilibrium on the transcriptome</article-title>
        <source>RNA</source>
        <year>2012</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>77</fpage>
        <lpage>87</lpage>
        <?supplied-pmid 22109839?>
        <pub-id pub-id-type="pmid">22109839</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwok</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Sahakyan</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Balasubramanian</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Structural analysis using SHALiPE to reveal RNA G–quadruplex formation in human precursor microRNA</article-title>
        <source>Angew Chem Int Ed</source>
        <year>2016</year>
        <volume>55</volume>
        <issue>31</issue>
        <fpage>8958</fpage>
        <lpage>961</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>83</fpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <mixed-citation publication-type="other">Korthauer K, Chakraborty S, Benjamini Y, Irizarry RA. Detection and accurate false discovery rate control of differentially methylated regions from whole genome bisulfite sequencing. Biostatistics. 2018.kxy007, 10.1093/biostatistics/kxy007.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schweikert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cseke</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Clouaire</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bird</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>MMDiff: quantitative testing for shape changes in ChIP-Seq data sets</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>826</fpage>
        <?supplied-pmid 24267901?>
        <pub-id pub-id-type="pmid">24267901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayo</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Schweikert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>M3D: a kernel-based test for spatially correlated changes in methylation profiles</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>809</fpage>
        <lpage>16</lpage>
        <?supplied-pmid 25398611?>
        <pub-id pub-id-type="pmid">25398611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <source>Handbook of biological statistics, vol. 2</source>
        <year>2009</year>
        <publisher-loc>Baltimore</publisher-loc>
        <publisher-name>Sparky House Publishing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sükösd</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Swenson</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Kjems</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heitsch</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Evaluating the accuracy of SHAPE-directed RNA secondary structure predictions</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>5</issue>
        <fpage>2807</fpage>
        <lpage>816</lpage>
        <?supplied-pmid 23325843?>
        <pub-id pub-id-type="pmid">23325843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ledda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vaziri</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Data-directed RNA secondary structure prediction using probabilistic modeling</article-title>
        <source>RNA</source>
        <year>2016</year>
        <volume>22</volume>
        <issue>8</issue>
        <fpage>1109</fpage>
        <lpage>19</lpage>
        <?supplied-pmid 27251549?>
        <pub-id pub-id-type="pmid">27251549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Low</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>SHAPE-directed RNA secondary structure prediction</article-title>
        <source>Methods</source>
        <year>2010</year>
        <volume>52</volume>
        <issue>2</issue>
        <fpage>150</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 20554050?>
        <pub-id pub-id-type="pmid">20554050</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Modeling non-uniformity in short-read rates in RNA-Seq data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>5</issue>
        <fpage>50</fpage>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rajashankar</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Fluoride ion encapsulation by Mg<sup>2+</sup> ions and phosphates in a fluoride riboswitch</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <issue>7401</issue>
        <fpage>85</fpage>
        <?supplied-pmid 22678284?>
        <pub-id pub-id-type="pmid">22678284</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Sudarsan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Weinberg</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stockbridge</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Breaker</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Widespread genetic switches and toxicity resistance proteins for fluoride</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>335</volume>
        <issue>6065</issue>
        <fpage>233</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 22194412?>
        <pub-id pub-id-type="pmid">22194412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Battiste</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Muhandiram</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Frankel</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title><italic>α</italic> helix-RNA major groove recognition in an HIV-1 Rev peptide-RRE RNA complex</article-title>
        <source>Science</source>
        <year>1996</year>
        <volume>273</volume>
        <issue>5281</issue>
        <fpage>1547</fpage>
        <lpage>51</lpage>
        <?supplied-pmid 8703216?>
        <pub-id pub-id-type="pmid">8703216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daugherty</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>D’Orso</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Frankel</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>A solution to limited genomic capacity: using adaptable binding surfaces to assemble the functional HIV Rev oligomer on RNA</article-title>
        <source>Mol Cell</source>
        <year>2008</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>824</fpage>
        <lpage>34</lpage>
        <?supplied-pmid 18922466?>
        <pub-id pub-id-type="pmid">18922466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jayaraman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Crosby</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mavor</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Frankel</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>RNA-directed remodeling of the HIV-1 protein Rev orchestrates assembly of the Rev–Rev response element complex</article-title>
        <source>eLife</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>04120</fpage>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Höner zu Siederdissen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tafer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>ViennaRNA Package 2.0</article-title>
        <source>Algoritm Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>26</fpage>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64</label>
      <mixed-citation publication-type="other">Radecki P, Ledda M, Aviran S. Automated recognition of RNA structure motifs by their SHAPE data signatures. Genes. 2018;9(6),300.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Calian</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>To permute or not to permute</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>18</issue>
        <fpage>2244</fpage>
        <lpage>248</lpage>
        <?supplied-pmid 16870938?>
        <pub-id pub-id-type="pmid">16870938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66</label>
      <mixed-citation publication-type="other">Benjamini Y, Taylor J, Irizarry RA. Selection-corrected statistical inference for region detection with high-throughput assays. J Am Stat Assoc. 2018:1–15. 10.1080/01621459.2018.1498347.</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zubradt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Persad</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambowitz</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Rouskin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>DMS-MaPseq for genome-wide or targeted RNA structure probing in vivo</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>14</volume>
        <fpage>75</fpage>
        <?supplied-pmid 27819661?>
        <pub-id pub-id-type="pmid">27819661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rencher</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Multivariate analysis of variance</article-title>
        <source>Methods of Multivariate Analysis</source>
        <year>2003</year>
        <publisher-loc>New Jersey</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusher</surname>
            <given-names>VG</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2001</year>
        <volume>98</volume>
        <issue>9</issue>
        <fpage>5116</fpage>
        <?supplied-pmid 11309499?>
        <pub-id pub-id-type="pmid">11309499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>limma powers differential expression analyses for rna-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>47</fpage>
        <lpage>7</lpage>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deigan</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Accurate SHAPE-directed RNA structure determination</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>1</issue>
        <fpage>97</fpage>
        <lpage>102</lpage>
        <?supplied-pmid 19109441?>
        <pub-id pub-id-type="pmid">19109441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolstad</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Åstrand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>185</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="pmid">12538238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Winter</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Using the Student’s t-test with extremely small sample sizes</article-title>
        <source>Pract Assess Res Eval</source>
        <year>2013</year>
        <volume>18</volume>
        <issue>10</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>O’dushlaine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Purcell</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>INRICH: interval-based enrichment analysis for genome-wide association studies</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>13</issue>
        <fpage>1797</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 22513993?>
        <pub-id pub-id-type="pmid">22513993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Youden</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Index for rating diagnostic tests</article-title>
        <source>Cancer</source>
        <year>1950</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>32</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 15405679?>
        <pub-id pub-id-type="pmid">15405679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bevilacqua</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Assmann</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide profiling of in vivo RNA structure at single-nucleotide resolution using structure-seq</article-title>
        <source>Nat Protocol</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>1050</fpage>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Amundsen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Balakrishnan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Binkley</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Christie</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Costanzo</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Fisk</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Hirschman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Hitz</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Karra</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Krieger</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Miyasato</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Nash</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Skrzypek</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Simison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>ED</given-names>
          </name>
        </person-group>
        <article-title>Saccharomyces Genome Database: the genomics resource of budding yeast</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>D1</issue>
        <fpage>700</fpage>
        <lpage>5</lpage>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagalakshmi</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Waern</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raha</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Transcriptional landscape of the yeast genome defined by RNA sequencing</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <issue>5881</issue>
        <fpage>1344</fpage>
        <?supplied-pmid 18451266?>
        <pub-id pub-id-type="pmid">18451266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Pfiffner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Ab initio construction of a eukaryotic transcriptome by massively parallel mRNA sequencing</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>9</issue>
        <fpage>3264</fpage>
        <?supplied-pmid 19208812?>
        <pub-id pub-id-type="pmid">19208812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siegfried</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Busan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>JAE</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>RNA motif discovery by SHAPE and mutational profiling (SHAPE-MaP)</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>959</fpage>
        <?supplied-pmid 25028896?>
        <pub-id pub-id-type="pmid">25028896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aviran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lucks</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Mortimer</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Doudna</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Modeling and automation of sequencing-based characterization of RNA structure</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>27</issue>
        <fpage>11069</fpage>
        <?supplied-pmid 21642536?>
        <pub-id pub-id-type="pmid">21642536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sloma</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Burke-Aguero</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Chapter four – improving RNA secondary structure prediction with structure mapping data</article-title>
        <source>Methods in Enzymology, vol. 553</source>
        <year>2015</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smola</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Christy</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Inoue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>CO</given-names>
          </name>
          <name>
            <surname>Friedersdorf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Keene</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Calabrese</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>SHAPE reveals transcript-wide interactions, complex structural domains, and protein interactions across the <italic>Xist</italic> lncRNA in living cells</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>37</issue>
        <fpage>10322</fpage>
        <?supplied-pmid 27578869?>
        <pub-id pub-id-type="pmid">27578869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR86">
      <label>86</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takaoka</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Efficient algorithms for the maximum subarray problem by distance matrix multiplication</article-title>
        <source>Electron Notes Theor Comput Sci</source>
        <year>2002</year>
        <volume>61</volume>
        <fpage>191</fpage>
        <lpage>200</lpage>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87</label>
      <mixed-citation publication-type="other">Choudhary K, Aviran S. AviranLab/dStruct: Initial release. GitHub repository. 2019. <ext-link ext-link-type="uri" xlink:href="https://github.com/AviranLab/dStruct">https://github.com/AviranLab/dStruct</ext-link>. Accessed 9 Jan 2019.</mixed-citation>
    </ref>
    <ref id="CR88">
      <label>88</label>
      <mixed-citation publication-type="other">Choudhary K, Lai YH, Tran EJ, Aviran S. dStruct: identifying differentially reactive regions from RNA structurome profiling data, Datasets. Zenodo. 2019. 10.5281/zenodo.2536501.</mixed-citation>
    </ref>
    <ref id="CR89">
      <label>89</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cordero</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lucks</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An RNA Mapping Database for curating RNA structure mapping experiments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>22</issue>
        <fpage>3006</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 22976082?>
        <pub-id pub-id-type="pmid">22976082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90</label>
      <mixed-citation publication-type="other">Choudhary K, Aviran S. AviranLab/SPEQC: First commit. GitHub repository. 2016. <ext-link ext-link-type="uri" xlink:href="https://github.com/AviranLab/SPEQC">https://github.com/AviranLab/SPEQC</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR91">
      <label>91</label>
      <mixed-citation publication-type="other">Weeks K. Weeks Laboratory: data files. <ext-link ext-link-type="uri" xlink:href="https://weeks.chem.unc.edu/">https://weeks.chem.unc.edu/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR92">
      <label>92</label>
      <mixed-citation publication-type="other">Wan Y, Qu K, Zhang QC, Flynn RA, Manor O, Ouyang Z, Zhang J, Spitale RC, Snyder MP, Segal E, Chang HY. Landscape and variation of RNA secondary structure across the human transcriptome. Gene Expression Omnibus. 2013. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE50676">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE50676</ext-link>. Accessed 19 Dec 2013.</mixed-citation>
    </ref>
  </ref-list>
</back>
