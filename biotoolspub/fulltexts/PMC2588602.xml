<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2588602</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-438</article-id>
    <article-id pub-id-type="pmid">18925937</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-438</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AMMOS: Automated Molecular Mechanics Optimization tool for <italic>in silico </italic>Screening</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Pencheva</surname>
          <given-names>Tania</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>tania.pencheva@clbme.bas.bg</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Lagorce</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>david.lagorce@univ-paris-diderot.fr</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Pajeva</surname>
          <given-names>Ilza</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>pajeva@bio.bas.bg</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Villoutreix</surname>
          <given-names>Bruno O</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>bruno.villoutreix@univ-paris-diderot.fr</email>
      </contrib>
      <contrib id="A5" corresp="yes" contrib-type="author">
        <name>
          <surname>Miteva</surname>
          <given-names>Maria A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>maria.miteva@univ-paris-diderot.fr</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>INSERM U648, Bioinformatics-MTI University Paris Diderot, 5 rue Marie-Andrée Lagroua, 75205 Paris Cedex 13, France</aff>
    <aff id="I2"><label>2</label>Centre of Biomedical Engineering "Prof. Ivan Daskalov", Bulgarian Academy of Sciences, 105, Akad. Georgi Bonchev Str., 1113 Sofia, Bulgaria</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>10</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>438</fpage>
    <lpage>438</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/438"/>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>4</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>10</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Pencheva et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Pencheva et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Pencheva
               Tania
               
               
               tania.pencheva@clbme.bas.bg
            </dc:author><dc:title>
            AMMOS: Automated Molecular Mechanics Optimization tool for in silico Screening
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 438-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;438&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Virtual or <italic>in silico </italic>ligand screening combined with other computational methods is one of the most promising methods to search for new lead compounds, thereby greatly assisting the drug discovery process. Despite considerable progresses made in virtual screening methodologies, available computer programs do not easily address problems such as: structural optimization of compounds in a screening library, receptor flexibility/induced-fit, and accurate prediction of protein-ligand interactions. It has been shown that structural optimization of chemical compounds and that post-docking optimization in multi-step structure-based virtual screening approaches help to further improve the overall efficiency of the methods. To address some of these points, we developed the program AMMOS for refining both, the 3D structures of the small molecules present in chemical libraries and the predicted receptor-ligand complexes through allowing partial to full atom flexibility through molecular mechanics optimization.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The program AMMOS carries out an automatic procedure that allows for the structural refinement of compound collections and energy minimization of protein-ligand complexes using the open source program AMMP. The performance of our package was evaluated by comparing the structures of small chemical entities minimized by AMMOS with those minimized with the Tripos and MMFF94s force fields. Next, AMMOS was used for full flexible minimization of protein-ligands complexes obtained from a mutli-step virtual screening. Enrichment studies of the selected pre-docked complexes containing 60% of the initially added inhibitors were carried out with or without final AMMOS minimization on two protein targets having different binding pocket properties. AMMOS was able to improve the enrichment after the pre-docking stage with 40 to 60% of the initially added active compounds found in the top 3% to 5% of the entire compound collection.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The open source AMMOS program can be helpful in a broad range of <italic>in silico </italic>drug design studies such as optimization of small molecules or energy minimization of pre-docked protein-ligand complexes. Our enrichment study suggests that AMMOS, designed to minimize a large number of ligands pre-docked in a protein target, can successfully be applied in a final post-processing step and that it can take into account some receptor flexibility within the binding site area.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Structure-based virtual ligand screening (SBVLS) allows to investigate thousands or millions of molecules against a biomolecular target [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>], and as such it plays an increasingly important role in modern drug discovery programs. For example, numerous SBVLS methods employing docking and scoring have been developed to assist the discovery of hit compounds and their optimization to leads [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>]. These methods orient and score small molecules in a protein-binding site, searching for shape and chemical complementarities. Many novel active compounds acting on key therapeutic targets have been found through combining SBVLS and in vitro screening experiments [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. Despite the considerable progresses achieved these recent years, several problems are still present in most of the currently available SBVLS packages. Among the most critical is the flexibility of the receptors that frequently change their conformations upon ligand binding. Several methods have been developed to attempt to take into consideration receptor flexibility during docking/scoring [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B10">10</xref>], however, this is still very challenging because the number of conformations rises exponentially with the number of rotatable bonds and the full sampling of all possible conformations is not feasible for a large number of protein-ligand complexes.</p>
    <p>Further the correct prediction of receptor-ligand binding energies [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] and accurate ranking of the compounds with respect to their estimated affinities to a target remains highly challenging. Thus it is still difficult to discriminate bioactive compounds from false positives [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>] despite recent efforts to improve enrichment via, for instance, docking on different protein targets [<xref ref-type="bibr" rid="B15">15</xref>] or through optimized or new scoring functions [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. In addition, and among the many players that are important in SBVLS computations, the quality of the screened chemical libraries has also been shown to be important in order to correctly predict the bound ligand-conformations and for ranking [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>]. Within this context, further refinements and optimization of VLS docking-scoring methods are needed.</p>
    <p>Recently it has been suggested that post-docking optimization, either after conventional docking-scoring procedures or after hierarchical VLS protocols [<xref ref-type="bibr" rid="B20">20</xref>-<xref ref-type="bibr" rid="B23">23</xref>] may help to further improve both, the docking pose and the scoring, and as such the overall efficiency of SBVLS experiments. Recent examples of docked poses and enrichment improvements after post-docking energy minimization support this view [<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B27">27</xref>].</p>
    <p>In the present study, we propose a new open source program, named AMMOS, which addresses some of the pre- and post-processing problems associated with SBVLS computations, through molecular mechanics (MM) modeling. AMMOS executes an automatic procedure for: (1) energy minimization of pre-docked protein-ligand complexes allowing partial or full atom flexibility from both, the ligand and the receptor sides and (2) structural optimization of chemical compounds present in the screening libraries prior to docking experiments. MM is currently a very reliable approach to model protein-receptor interactions in a physically realistic manner [<xref ref-type="bibr" rid="B26">26</xref>-<xref ref-type="bibr" rid="B28">28</xref>] since it can account for local flexibility adjustments from both, the protein and the ligand although conformational exploration is not possible if large conformational changes occur. It is indeed reasonable to apply such framework instead of more computer demanding simulations (for instance molecular dynamics) in large-scale applications involving the handling of thousands of compounds. In conventional MM studies, the bonded interactions include the bonds, bond angles and dihedral terms while the non-bonded interactions involve the van der Waals term represented by the Lennard-Jones (LJ) 6–12 potential, and electrostatic interactions, often treated by Coulombic potential computed between point charges centered on relevant atoms. AMMOS proposes relatively fast energy minimization by making use of the full-featured molecular mechanics program AMMP [<xref ref-type="bibr" rid="B28">28</xref>-<xref ref-type="bibr" rid="B31">31</xref>]. AMMP is available upon GNU license and has been recently implemented in the well-known OpenGL molecular modeling package VEGA [<xref ref-type="bibr" rid="B32">32</xref>]. In particular, VEGA implements AMMP for energy minimization with all the available optimization methods. However, to the best of our knowledge, VEGA can not minimize chemical libraries nor a large number of pre-docked protein-ligand complexes. AMMP has several advantages that make it relevant for the present applications such as: a fast multipole method for including all atoms in the calculation of long-range potentials and robust structural optimizers. AMMP has a flexible choice of several bonded and non-bonded potentials and permits analysis of individual energy terms. An additional advantage of AMMP is that it allows straightforward introduction of non-standard polymer linkages and non-standard amino-acid residues as well as manipulation of both small molecules and macromolecules including proteins, nucleic acids and other polymers. Furthermore, extensive benchmarking of AMMP has been performed highlighting its accuracy in term of energy minimization of proteins (i.e., the changes of atomic positions after minimization have been shown to be within the range of experimentally obtained variations in different crystal forms [<xref ref-type="bibr" rid="B33">33</xref>] and the calculated protein-ligand interaction energies have been successfully correlated with measured ligand binding affinities [<xref ref-type="bibr" rid="B34">34</xref>]). Up to now, AMMP has been successfully applied in numerous modeling studies of proteins and protein-ligand complexes [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B35">35</xref>] but it has not been used thus far for SBVLS computations as numerous implementations would be necessary to apply it automatically on thousands of small molecules, either present in a database or docked in a receptor binding site.</p>
    <p>In this article we describe the development, implementation and evaluation of the AMMOS approach for automatic energy minimization of protein-ligand complexes or of small organic molecules. First energy minimization with AMMOS was validated by refinement of a large chemical library and by comparison of small molecule optimizations with two well established force fields available in the package SYBYL [<xref ref-type="bibr" rid="B36">36</xref>]. The efficiency of AMMOS for optimization of pre-docked protein-ligand complexes was then examined through performing calculations on two protein targets, namely estrogen receptor (ER) and neuraminidase (NA). These two proteins were selected because they are often used in SBVLS studies and because their binding pockets display rather different physicochemical properties and geometries. We used a multi-step SBVLS protocol to generate protein-ligand complexes. Our first VLS stage employed a search for satisfactory shape complementarity allowing rational reduction of the size of the initial chemical library. The pre-docked complexes subjected to AMMOS minimization were generated via the second step involving flexible-ligand docking. Finally we tested AMMOS as a final re-scoring engine on the selected pre-docked protein-ligand complexes for both, ER and NA. The obtained results are promising and suggest that AMMOS can be successfully applied as a post-processing tool to improve enrichment.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>AMMP Molecular Mechanics</title>
      <p>AMMOS makes use of the molecular simulation package AMMP [<xref ref-type="bibr" rid="B30">30</xref>], a program that can easily be embedded in other packages. AMMP allows to introduce standard or non-standard polymer linkages (ensured by the program PREAMMP included in the package AMMP), unusual ligands or non-standard residues, as well as to complete partial protein structures. AMMP incorporates a fast multipole algorithm for the efficient calculation of long-range forces thereby allowing evaluation of non-bonded terms without the use of a cutoff radius and increasing the speed, making calculations comparable to a standard treatment with a 8–10 Å radius cutoff [<xref ref-type="bibr" rid="B28">28</xref>]. The AMMP force field [<xref ref-type="bibr" rid="B28">28</xref>] is developed on the basis of the UFF potential set [<xref ref-type="bibr" rid="B37">37</xref>] and the AMBER partial charges [<xref ref-type="bibr" rid="B38">38</xref>]. The initial UFF set has been optimized for biological molecules [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>] in order to improve the agreement with experimental geometry and spectral data. The first developed AMMP force field was the set <italic>sp4 </italic>[<xref ref-type="bibr" rid="B28">28</xref>]. Lately, Bagossi and co-authors [<xref ref-type="bibr" rid="B39">39</xref>] proposed the <italic>Mo</italic>dified <italic>P</italic>arameter <italic>S</italic>et for AMMP (MOPSA) with improved generation of partial charges for a wider range of compounds especially adapted for modeling of macromolecules, where the electrostatic parameters have been modified to achieve better correlation with experimental dipole moments. MOPSA parameter set has been merged with the AMMP parameter set <italic>sp4 </italic>to generate the new standard force field set <italic>sp5 </italic>[<xref ref-type="bibr" rid="B39">39</xref>].</p>
      <p>We tested several minimization methods as implemented in AMMP. The steepest descent method [<xref ref-type="bibr" rid="B40">40</xref>] (first order) that uses the first derivatives of the energy function to find a local minimum, is available in AMMP, but this does not necessarily produce the fastest convergence. The Poliak-Ribeire Conjugate Gradient method (first order) [<xref ref-type="bibr" rid="B40">40</xref>], performing a search along conjugate directions, can produce generally faster convergence, is also implemented in AMMP. For the second-order minimization methods, the Broyden-Fletcher-Goldfarb-Shanno (BFGS) approach [<xref ref-type="bibr" rid="B41">41</xref>] that belongs to the Quasi-Newton methods [<xref ref-type="bibr" rid="B40">40</xref>], is available in AMMP. The non-derivative polytope simplex method [<xref ref-type="bibr" rid="B41">41</xref>], as well as a genetic algorithm (GA) [<xref ref-type="bibr" rid="B42">42</xref>] (evolutionary algorithms that perform directed random search to find the optimal solution in a complex multidimensional space) are also implemented in AMMP.</p>
    </sec>
    <sec>
      <title>Energy minimization protocols</title>
      <sec>
        <title>Energy minimization of small organic molecules using AMMOS</title>
        <p>We explored both AMMP force fields, <italic>sp4 </italic>and <italic>sp5</italic>, on a set of four small molecules structures generated by OMEGA 2.0 [<xref ref-type="bibr" rid="B43">43</xref>] (see Compound collections below). To speed-up ligand parameterization, partial charges on ligand atoms were assigned with the Gasteiger-Marsili method [<xref ref-type="bibr" rid="B44">44</xref>] using the OpenBabel package [<xref ref-type="bibr" rid="B45">45</xref>]. The maximum number of iterations was set to 5000. All calculations were performed with a convergence value set to 0.01 or 0.02 kcal.mol<sup>-1</sup>.Å<sup>-1</sup>, and no essential differences were observed. Thus, we chose 0.02 kcal.mol<sup>-1</sup>.Å<sup>-1 </sup>as convergence criterion to reduce the computational time. The number of iterations required to reach convergence with the conjugate gradient method (our results demonstrate that this approach is the most efficient, see in the Results section) varied between 300 and 1600 for different small compounds. Therefore for further analysis, two protocols were assessed: one protocol employing two subsequent steps of 500 iterations and one with 1000 iterations. The minimized and initial structures were compared based on the RMSD values between the non-hydrogen atoms using the Superimpose option of the InsightII molecular modeling package [<xref ref-type="bibr" rid="B46">46</xref>]. We should notice that small molecule minimization results depend on initial conformations and this holds for any MM minimization engine. Problems with possible biases due to the starting conformation and exploration of other conformers can be circumvented by the use of our multiconformer generator Multiconf-DOCK [<xref ref-type="bibr" rid="B47">47</xref>] or of OMEGA prior to minimizing small molecules.</p>
      </sec>
      <sec>
        <title>Energy minimization of small organic molecules using other force fields</title>
        <p>Two MM minimization methods implemented in the program SYBYL were applied on the same set of small molecules in order to compare the minimization results obtained with AMMOS. The initial structures of the four small compounds, generated by OMEGA (see for details Compound collections), were optimized by two force fields: the Tripos force field (Tff) [<xref ref-type="bibr" rid="B36">36</xref>] and MMFF94s [<xref ref-type="bibr" rid="B48">48</xref>]. Tff minimization was performed with Gasteiger-Huckel charges, and MMFF94s, with MMFF charges. For both force fields, the following settings were used: distance-dependent dielectric function; non-bonded cutoff 8.0 Å; 0.02 kcal.mol<sup>-1</sup>.Å<sup>-1 </sup>energy gradient convergence criterion; simplex initial optimization. For comparison, several runs were performed with 0.01 kcal.mol<sup>-1</sup>.Å<sup>-1 </sup>convergence and no essential differences in the resulting geometries were recorded. Two gradient methods were experimented: Powell and conjugate gradient. Powell method [<xref ref-type="bibr" rid="B49">49</xref>] belongs to the conjugate gradient family of minimization methods. It is also more tolerant to inexact line searches. As a result, it is faster than the conjugate gradient method and is well-suited for a wide variety of problems [<xref ref-type="bibr" rid="B49">49</xref>]. The number of iterations was set to 5000 for both methods, in all cases however, the convergence was reached well below this number. Because the Powell and conjugate gradient results were quite similar, we report here only the data obtained with the Powell method. The minimized and initial structures were compared based on the RMSD values between the non-hydrogen atoms using the Match option in SYBYL. The calculations with SYBYL were performed on a Silicon Graphics Octane 2 (R12000) running under IRIX 6.5.</p>
      </sec>
    </sec>
    <sec>
      <title>Docking and scoring protocol</title>
      <p>The pre-docked protein-ligand complexes subjected to energy minimization with AMMOS were generated via a multi-step docking-scoring protocol with DOCK6 [<xref ref-type="bibr" rid="B50">50</xref>]. DOCK6 accomplishes a sphere-matching algorithm to fit ligand atoms to spheres representing a negative image of the receptor-binding site. We used the program DMS [<xref ref-type="bibr" rid="B51">51</xref>] to compute the molecular surface of the receptor. The overlapping spheres within a radius of 4 Å were generated on the protein binding site surface using the program SPHGEN [<xref ref-type="bibr" rid="B52">52</xref>]. Sphere clusters within 6 Å to a reference ligand were retained for ER and 4 Å for NA (i.e., NA possesses a very open and flat binding site and it is important to limit the search on the active site area for this kind of target). The first docking step was carried out using rigid body-docking with DOCK6 applying the MS-DOCK protocol [<xref ref-type="bibr" rid="B47">47</xref>] over a compound collection of 37970 molecules (ADME/Tox filtered ChemBridge Diversity set) present in a multi-conformer state without initial minimization with AMMOS (see Compound collections). This stage assesses only shape complementarity and therefore, multi-conformer structures for the small compounds are needed in order to perform this fast "geometric" filtering step. For the positioning of the ligand in the binding site, we applied the faster manual match (see [<xref ref-type="bibr" rid="B50">50</xref>] and a maximum of 500 orientations). As mentioned above, in our calculations, the scores measured only the steric complementarity by use of the contact scoring function that counts the number of receptor-ligand contacts within a 4.5 Å distance from the ligand atoms. Each clash penalized the score by 30. The allowed bump overlaps were chosen to be 0.75 for NA and 0.50 for ER. These values were selected according to our previous observations [<xref ref-type="bibr" rid="B47">47</xref>]. We have seen that for large and flat cavities binding relatively small ligands like in the case of NA, a bump overlap of 0.75 improves the enrichment after a rigid docking procedure. On the contrary, when large ligands fill well the binding site, a bump overlap of 0.50 is preferable, a situation encountered with ER (see for details [<xref ref-type="bibr" rid="B47">47</xref>]).</p>
      <p>Secondly, the retrieved non-minimized top ranked compounds (30–50 % of the library containing at least 60% of the actives) were directly re-docked using a flexible docking mode (i.e., flexibility from the ligand side) implemented in DOCK6 and employing the incremental built algorithm "anchor-first" [<xref ref-type="bibr" rid="B53">53</xref>] with our optimized parameters to better handle ligand flexibility [<xref ref-type="bibr" rid="B47">47</xref>]. We used a maximum of 1000 orientations for the anchor fragment. To speed-up the calculations, we set 50 configurations per cycle for the growth of the ligands. We applied 20 simplex minimization steps to each growth step. All docked molecules were ranked using the standard DOCK score involving soft van der Waals and distance-dependent electrostatic potentials. Finally for each ligand we saved up to 10 best scored conformers with a RMSD of 0.8 Å for subsequent minimization with AMMOS.</p>
    </sec>
    <sec>
      <title>Dataset preparation</title>
      <sec>
        <title>Compound collections</title>
        <p>Energy minimization with AMMOS and the Tff and MMFF94s force fields was carried out initially on 4 small molecules, taken from several X-ray protein-ligand complexes in the Protein Data Bank (PDB) [<xref ref-type="bibr" rid="B54">54</xref>], namely: <bold>raloxifene </bold>(an inhibitor of estrogen receptor, PDB code <ext-link ext-link-type="pdb" xlink:href="1err">1err</ext-link>); 4-(n-acetylamino)-3- [n-(2-ethylbutanoylamino)]benzoic acid (<bold>FDI) </bold>(an inhibitor of neuraminidase, PDB code <ext-link ext-link-type="pdb" xlink:href="1b9s">1b9s</ext-link>); <bold>thymidine </bold>(an inhibitor of thymidine kinase, PDB code <ext-link ext-link-type="pdb" xlink:href="1kim">1kim</ext-link>); thieno [3,2-b]pyridine-2-sulfonic acid [2-oxo-1-(1h-pyrrolo[2,3-c]pyridin-2-ylmethyl)- pyrrolidin-3-yl]-amide (<bold>PR2) </bold>(an inhibitor of coagulation factor X, PDB code <ext-link ext-link-type="pdb" xlink:href="1f0r">1f0r</ext-link>).</p>
        <p>To test the performance of AMMOS on a large number of small organic molecules we used the ChemBridge diversity set [<xref ref-type="bibr" rid="B55">55</xref>]. Our decoy library contained 37970 molecules after ADME/Tox filtering with the program Filter 1.0.2 [<xref ref-type="bibr" rid="B43">43</xref>]. We merged 20 known active compounds for ER and NA (with activities ranging from micromolar to nanomolar) and a number of rotatable bonds ranging from 4 to15) to the decoy collection. Some of the active compounds were taken from the PDB protein-ligand structures: 2 for ER (1err, 3ert; resolution 2.60 Å, 1.90 Å, respectively) and 10 for NA (1inf, 1inv, 1ivb, 1vcj, 1b9s, 1b9t, 1b9v, 1a4g, 1f8b, 2qwk; resolution 2.35–2.50 Å). When a ligand could not be extracted from the PDB, it was rebuilt from the literature [<xref ref-type="bibr" rid="B56">56</xref>]. All these active inhibitors were added to the decoy library, all in SMILES format. The resulting chemical library was transformed in single 3D conformer and saved in mol2 format using the program OMEGA 2.0 [<xref ref-type="bibr" rid="B43">43</xref>]. The multiconformer states were then generated by our program Multiconf-DOCK [<xref ref-type="bibr" rid="B47">47</xref>] applying an energy window of 25 kcal.mol<sup>-1 </sup>and a diversity threshold of 1 Å RMSD. A maximum of 50 conformers were generated for each molecule. These values represent an appropriate balance between speed and accuracy according to the recent studies [<xref ref-type="bibr" rid="B47">47</xref>,<xref ref-type="bibr" rid="B57">57</xref>].</p>
      </sec>
      <sec>
        <title>Protein targets</title>
        <p>The performance of AMMOS for post-processing of the pre-docked protein-ligand complexes was validated on two protein targets. We selected ER with a closed and hydrophobic pocket and NA with an open and highly polar binding site. These two proteins present a binding site with very different degrees of burial (75.4% for ER and 30.5% for NA) and polarity (25% for ER and 65% for NA) (see for details [<xref ref-type="bibr" rid="B20">20</xref>]). We took the co-crystallized structures with best resolution among all retrieved protein-ligand complexes (PDB code <ext-link ext-link-type="pdb" xlink:href="3ert">3ert</ext-link>, resolution 1.90 Å for ER and PDB code <ext-link ext-link-type="pdb" xlink:href="1b9v">1b9v</ext-link>, resolution 2.35 Å for NA). All bound water molecules and crystallized ligands were removed from the binding sites. Hydrogens were assigned using the program InsightII [<xref ref-type="bibr" rid="B46">46</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Algorithm of AMMOS</title>
      <p>AMMOS drives a fully automatic procedure for minimization of protein-ligand complexes in a situation where the compounds are pre-docked in the binding site by any docking engine. AMMOS parameters are optimized such as to handle relatively large docked compound collections. Figure <xref ref-type="fig" rid="F1">1</xref> illustrates all the different steps and required inputs, preparation, minimization of protein-ligand complexes with different degrees of protein flexibility, as well as final ranking of the ligands according to the minimized interaction energy between the ligands and the receptor. Firstly, AMMOS employs the program PREAMMP to convert the input protein and ligand files to AMMP format. Next, AMMP autolink is run to search for incomplete amino-acid residues and to finally link all the residues after corrections. AMMOS allows users to select one among five different solutions to handle protein-ligand complexes: from fully flexible minimization of the whole protein-ligand complex (<italic>case </italic>1) to a flexible ligand in a rigid receptor (<italic>case </italic>5) (see Fig. <xref ref-type="fig" rid="F1">1</xref>). In all situations, the ligand atoms are free to move. Our minimization step with AMMP applied on the protein-ligand complexes for the selected protein flexibility case involves 2×500 iterations with conjugate gradient optimization. The advances user can select any minimization method available in AMMP and specify the minimization parameters (i.e. number of iterations, convergence etc.). Finally, all the minimized conformers are scored by the AMMP minimized interaction protein-ligand energy [<xref ref-type="bibr" rid="B28">28</xref>] and re-ranked.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Schematic diagram of the AMMOS procedure</bold>. The arrows show the cycle of the automated procedure for a large number of ligands.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-438-1"/>
      </fig>
    </sec>
    <sec>
      <title>Implementation of AMMOS</title>
      <p>The package AMMOS consists of several programs developed in C and Python, and makes use of the open source programs AMMP and PREAMMP. One AMMOS routine (written in C) ensures the transformation of the input files (PDB for the protein and mol2 for the ligands) to a specific ammp format required by AMMP and at the end of the process generate reversely, the protein in PDB format and the small molecules in mol2 format. The automatization of the procedure described in Figure <xref ref-type="fig" rid="F1">1</xref> for a large number of ligands in a single or multiple conformer state is accomplished via a Python script. Five different cases (scripts written in C) have been elaborated for the selection of the active/inactive atoms in the protein, while, in all situations, the ligand atoms are flexible: <italic>case 1</italic>: all atoms of the protein are active (a fully flexible minimization); <italic>case 2</italic>: all atoms of the protein side chains are active; <italic>case 3</italic>: all atoms of the protein inside a sphere around the ligand are active; <italic>case 4</italic>: all atoms of the protein side chains inside a sphere around the ligand are active; <italic>case 5</italic>: the whole protein is rigid. After processing of the whole pre-docked compound collection, the following results are saved in a subdirectory named <italic>OUTPUT: </italic>(i) the coordinates of all conformers after minimization, (ii) the coordinates of the flexible part of the protein after minimization, (iii) a file with warnings (if any), and (iv) the interaction energy between the protein and the ligands (external energy), the internal energies of the ligands or the protein, and total energy (including internal and external terms) before and after minimization. Finally a re-ranking step takes place based on the computed external energies of all minimized ligands. The method selects the best conformer among the multiple ligand conformers. The complete automatic procedure could be run for either sp4 or sp5 force field. Because sp5 was not explicitly available in AMMP, we created it using the extended and parameterized list of atom types and electronegativity values available in reference [<xref ref-type="bibr" rid="B39">39</xref>].</p>
      <p>Another application of AMMOS is for the minimization of a large databank of chemical compounds in the absence of a protein. The procedure follows the scheme presented in Figure <xref ref-type="fig" rid="F1">1</xref>, and involves only the steps related to the small molecules, namely preparation and minimization of small molecules and final re-conversion to mol2 format.</p>
      <p>All VLS and AMMOS calculations were carried out on one Mac Pro Quad-Core Xeon 3,0 GHz, 4Go RAM and on one Xeon 3.0 GHz Linux workstation, 1.5 GB RAM. The average time for the minimization on an Apple workstation was 0.3 sec for one small molecule and for one ligand pose in a protein was 24 sec for <italic>case </italic>5 (no protein flexibility is allowed), 44 sec for <italic>case 3 </italic>(all atoms of the protein inside the sphere around the ligand are active), and 5 min for <italic>case 1 </italic>(all protein and ligand atoms are active). Thus, execution times when a large number of ligands should be minimized with AMMOS can be very long. To speed-up the calculations, AMMOS allows jobs to be ran in parallel mode. The input mol2 file containing ligand molecules is divided into chunks of smaller numbers of molecules. During a parallel AMMOS run, each processor is assigned one chunk of molecules at a time. Final ranking of the complete databank containing the energy-minimized ligands is then accomplished after merging of the different chunks.</p>
    </sec>
    <sec>
      <title>Testing of AMMOS</title>
      <sec>
        <title>I. Energy minimization of small organic molecules</title>
        <p>Prior to test the automatic procedure for minimization of protein-ligand complexes, we first explored the ability of AMMOS to minimize small organic molecules starting from 3D structures generated by OMEGA. We compared several minimization methods available in AMMP (see <italic>AMMP Molecular Mechanics </italic>in the Methods section) and further compared the results obtained with AMMP with two other widely used force fields MMFF94s and Tff available in the SYBYL software.</p>
        <sec>
          <title>Energy minimization of small molecules with AMMOS</title>
          <p>The initial 3D structures of the four small molecules, raloxifene, FDI, thymidine and PR2 (see in Methods, Compound collections) generated by OMEGA were optimized using AMMOS with the force fields <italic>sp4 </italic>and <italic>sp5</italic>. Table <xref ref-type="table" rid="T1">1</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> present the results for the four molecules and the five different applied optimization methods. For each method, the number of iterations needed to find the local minimum and the energy of the minimized structures are reported. As seen from Table <xref ref-type="table" rid="T1">1</xref>, <italic>sp4 </italic>and <italic>sp5 </italic>provided very similar results in terms of optimized structural geometries. For PR2 and thymidine, lowest energies of the minimized structures with both <italic>sp4 </italic>and <italic>sp5 </italic>were achieved using the conjugate gradient method, followed by BFGS and GA. Conjugate gradient and GA gave the best results for raloxifene and FDI. For all tested molecules, steepest descent and simplex search led to minimized structures with higher energies. The above comparison suggests that conjugate gradient and GA produced lowest energies, however GA was much slower due to its stochastic nature. We also minimized structures containing important internal clashes in order to assess the robustness of the approach. After application of steepest descent the minimized structures remained insufficiently optimized, while conjugate gradient succeeded to overcome the clashes (results not shown). Although <italic>sp5 </italic>has been reported to be an improved version of <italic>sp4 </italic>[<xref ref-type="bibr" rid="B39">39</xref>], in our work <italic>sp4 </italic>minimized slightly better than <italic>sp5 </italic>in terms of energy differences between the initial and minimized structure, in particular for thymidine and raloxifene. Following the above observations, we chose conjugate gradient and <italic>sp4 </italic>as the minimization protocol for subsequent assessment of AMMOS.</p>
          <table-wrap position="float" id="T1">
            <label>Table 1</label>
            <caption>
              <p>Comparison of AMMP optimization methods for small molecules minimized with sp4 and sp5 force fields</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <td/>
                  <td/>
                  <td/>
                  <td align="center" colspan="10">
                    <bold>Optimization methods</bold>
                  </td>
                </tr>
                <tr>
                  <td/>
                  <td/>
                  <td/>
                  <td colspan="10">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Compound</bold>
                  </td>
                  <td/>
                  <td align="center">
                    <bold>Initial Energy</bold>
                  </td>
                  <td align="center" colspan="2">
                    <bold>Steepest descent</bold>
                  </td>
                  <td align="center" colspan="2">
                    <bold>Conjugate gradient</bold>
                  </td>
                  <td align="center" colspan="2">
                    <bold>BFGS</bold>
                  </td>
                  <td align="center" colspan="2">
                    <bold>Simplex</bold>
                  </td>
                  <td align="center" colspan="2">
                    <bold>GA</bold>
                  </td>
                </tr>
                <tr>
                  <td/>
                  <td/>
                  <td/>
                  <td colspan="10">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td/>
                  <td/>
                  <td/>
                  <td align="center">N<sub>iter</sub></td>
                  <td align="center">E<sub>min</sub></td>
                  <td align="center">N<sub>iter</sub></td>
                  <td align="center">E<sub>min</sub></td>
                  <td align="center">N<sub>iter</sub></td>
                  <td align="center">E<sub>min</sub></td>
                  <td align="center">N<sub>iter</sub></td>
                  <td align="center">E<sub>min</sub></td>
                  <td align="center">N<sub>iter</sub></td>
                  <td align="center">E<sub>min</sub></td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">raloxifene</td>
                  <td align="center">sp4</td>
                  <td align="center">121.08</td>
                  <td align="center">20</td>
                  <td align="center">86.72</td>
                  <td align="center">1600</td>
                  <td align="center">66.71</td>
                  <td align="center">1500</td>
                  <td align="center">75.89</td>
                  <td align="center">80</td>
                  <td align="center">102.24</td>
                  <td align="center">300</td>
                  <td align="center">69.97</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">sp5</td>
                  <td align="center">117.41</td>
                  <td align="center">20</td>
                  <td align="center">88.46</td>
                  <td align="center">1000</td>
                  <td align="center">71.65</td>
                  <td align="center">1200</td>
                  <td align="center">77.62</td>
                  <td align="center">100</td>
                  <td align="center">107.03</td>
                  <td align="center">300</td>
                  <td align="center">70.89</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">RMSD</td>
                  <td/>
                  <td/>
                  <td align="center">0.01</td>
                  <td/>
                  <td align="center">1.23</td>
                  <td/>
                  <td align="center">0.05</td>
                  <td/>
                  <td align="center">0.14</td>
                  <td/>
                  <td align="center">0.42</td>
                </tr>
                <tr>
                  <td colspan="13">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">FDI</td>
                  <td align="center">sp4</td>
                  <td align="center">119.61</td>
                  <td align="center">30</td>
                  <td align="center">74.02</td>
                  <td align="center">200</td>
                  <td align="center">66.14</td>
                  <td align="center">1200</td>
                  <td align="center">64.38</td>
                  <td align="center">10</td>
                  <td align="center">268.07</td>
                  <td align="center">300</td>
                  <td align="center">48.95</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">sp5</td>
                  <td align="center">116.89</td>
                  <td align="center">30</td>
                  <td align="center">75.48</td>
                  <td align="center">300</td>
                  <td align="center">67.94</td>
                  <td align="center">1000</td>
                  <td align="center">67.96</td>
                  <td align="center">10</td>
                  <td align="center">283.08</td>
                  <td align="center">200</td>
                  <td align="center">51.83</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">RMSD</td>
                  <td/>
                  <td/>
                  <td align="center">0.01</td>
                  <td/>
                  <td align="center">0.12</td>
                  <td/>
                  <td align="center">0.02</td>
                  <td/>
                  <td align="center">0.14</td>
                  <td/>
                  <td align="center">1.14</td>
                </tr>
                <tr>
                  <td colspan="13">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">thymidine</td>
                  <td align="center">sp4</td>
                  <td align="center">99.64</td>
                  <td align="center">30</td>
                  <td align="center">64.82</td>
                  <td align="center">400</td>
                  <td align="center">60.52</td>
                  <td align="center">500</td>
                  <td align="center">61.17</td>
                  <td align="center">20</td>
                  <td align="center">114.81</td>
                  <td align="center">300</td>
                  <td align="center">61.40</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">sp5</td>
                  <td align="center">95.78</td>
                  <td align="center">20</td>
                  <td align="center">68.49</td>
                  <td align="center">200</td>
                  <td align="center">64.29</td>
                  <td align="center">1000</td>
                  <td align="center">64.57</td>
                  <td align="center">10</td>
                  <td align="center">99.78</td>
                  <td align="center">200</td>
                  <td align="center">65.85</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">RMSD</td>
                  <td/>
                  <td/>
                  <td align="center">0.01</td>
                  <td/>
                  <td align="center">0.09</td>
                  <td/>
                  <td align="center">0.03</td>
                  <td/>
                  <td align="center">0.06</td>
                  <td/>
                  <td align="center">0.63</td>
                </tr>
                <tr>
                  <td colspan="13">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">PR2</td>
                  <td align="center">sp4</td>
                  <td align="center">156.55</td>
                  <td align="center">50</td>
                  <td align="center">-5.22</td>
                  <td align="center">300</td>
                  <td align="center">-14.57</td>
                  <td align="center">700</td>
                  <td align="center">-13.58</td>
                  <td align="center">10</td>
                  <td align="center">78.01</td>
                  <td align="center">200</td>
                  <td align="center">-5.77</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">sp5</td>
                  <td align="center">155.04</td>
                  <td align="center">50</td>
                  <td align="center">1.11</td>
                  <td align="center">300</td>
                  <td align="center">-13.01</td>
                  <td align="center">600</td>
                  <td align="center">-11.77</td>
                  <td align="center">20</td>
                  <td align="center">72.18</td>
                  <td align="center">200</td>
                  <td align="center">-12.73</td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">RMSD</td>
                  <td/>
                  <td/>
                  <td align="center">0.07</td>
                  <td/>
                  <td align="center">0.02</td>
                  <td/>
                  <td align="center">0.01</td>
                  <td/>
                  <td align="center">0.02</td>
                  <td/>
                  <td align="center">0.61</td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <p>The number of iterations needed to reach convergence (Niter) and the minimized energy (Emin in kcal/mol) and the RMSD values (in Å) between the optimized structures with sp4 and sp5 force fields are given.</p>
            </table-wrap-foot>
          </table-wrap>
          <p>As seen from Table <xref ref-type="table" rid="T1">1</xref>, the required number of iterations for convergence (0.02 kcal.mol<sup>-1</sup>.Å<sup>-1 </sup>energy gradient convergence criterion) with <italic>conjugate gradient </italic>varies between 200 and 1600 for different molecules. The four molecules show different structural properties with various numbers of rotatable bonds: 7 (raloxifene), 6 (FDI), 5 (PR2) and 2 (thymidine). Raloxifene and PR2 are larger than the other two molecules with molecular weights of 473 and 453, respectively. One can see from the figure reported in the Additional File <xref ref-type="supplementary-material" rid="S1">1</xref> that after 400 iterations with <italic>conjugate gradient </italic>the energy gradients of all molecules are very close to the convergence criterion. Our additional tests confirmed that using 1000 or 2× 500 iterations are an acceptable compromise between geometric optimization and speed. Thus, we accepted 2×500 iterations as an appropriate number of steps for the automatic AMMOS procedure aiming at minimizing thousands of small organic molecules or of protein-ligand complexes (i.e., users can change these values if needed).</p>
          <p>Further, we examined 4 different potential functions for non-bonded interactions as implemented and named in AMMP: 1) <italic>nonbon </italic>– involving point atom electrostatics; 2) <italic>screen </italic>– 1s distributed charge electrostatics; 3) <italic>debye </italic>– Debye screened potentials and 4) <italic>shadow </italic>– 4-D non-bonded for embedding. Because compared to the <italic>nonbon </italic>potential, no significant differences were found with the <italic>debye</italic>, <italic>screen </italic>and <italic>shadow </italic>modes and since they considerably increase the lengths of the calculations, we selected the <italic>nonbon </italic>potential for further evaluation of AMMOS (users can employ the <italic>debye </italic>or <italic>shadow </italic>options scripts to account for screening solvent effects).</p>
        </sec>
        <sec>
          <title>Energy minimization of small molecules with other force fields</title>
          <p>The results achieved after application of AMMOS minimization with conjugate gradient with 2× 500 iterations and <italic>sp4 </italic>(this protocol is employed by the automatic procedure for a large number of molecules) were compared with two other force fields – MMFF94s and Tff applied on the same four small molecules starting from 3D initial structures generated by OMEGA. Similar results in terms of energies and structural geometries were obtained with Powell and conjugate gradient methods when one of the MMFF94s and Tff force fields were used. Therefore only the results with the method of Powell for both force fields MMFF94s and Tff are reported here. Table <xref ref-type="table" rid="T2">2</xref> shows the energies of the initial (E<sub>ini</sub>) and minimized (E<sub>min</sub>) structures, obtained with AMMOS, MMFF94s and Tff, as well as the energy differences (ΔE) between the initial and minimized structures. Although energy values obtained by different force fields are not directly comparable, the differences between the energies of the initial and minimized conformations can be indicative of the optimization performance to search for the local minimum. As seen from Table <xref ref-type="table" rid="T2">2</xref>, generally there is a correlation between ΔE values in AMMOS and the other force fields, thus confirming that AMMOS is able to remove ligand energy strains.</p>
          <table-wrap position="float" id="T2">
            <label>Table 2</label>
            <caption>
              <p>Energy minimization with the AMMP sp4, MMFF94s and Tff force fields</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <td align="left">
                    <bold>Compound</bold>
                  </td>
                  <td align="center" colspan="3">
                    <bold>AMMOS, sp4</bold>
                  </td>
                  <td align="center" colspan="3">
                    <bold>MMFF94s</bold>
                  </td>
                  <td align="center" colspan="3">
                    <bold>Tff</bold>
                  </td>
                </tr>
                <tr>
                  <td/>
                  <td colspan="9">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td/>
                  <td align="center">E<sub>ini</sub></td>
                  <td align="center">E<sub>min</sub></td>
                  <td align="center">ΔE</td>
                  <td align="center">E<sub>ini</sub></td>
                  <td align="center">E<sub>min</sub></td>
                  <td align="center">ΔE</td>
                  <td align="center">E<sub>ini</sub></td>
                  <td align="center">E<sub>min</sub></td>
                  <td align="center">ΔE</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">raloxifene</td>
                  <td align="center">121.08</td>
                  <td align="center">69.82</td>
                  <td align="center">51.26</td>
                  <td align="center">100.49</td>
                  <td align="center">86.18</td>
                  <td align="center">14.31</td>
                  <td align="center">61.27</td>
                  <td align="center">16.42</td>
                  <td align="center">44.85</td>
                </tr>
                <tr>
                  <td colspan="10">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">FDI</td>
                  <td align="center">119.61</td>
                  <td align="center">66.14</td>
                  <td align="center">53.47</td>
                  <td align="center">32.41</td>
                  <td align="center">23.81</td>
                  <td align="center">8.60</td>
                  <td align="center">59.79</td>
                  <td align="center">-1.03</td>
                  <td align="center">60.82</td>
                </tr>
                <tr>
                  <td colspan="10">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">thymidine</td>
                  <td align="center">99.64</td>
                  <td align="center">60.52</td>
                  <td align="center">39.12</td>
                  <td align="center">-40.41</td>
                  <td align="center">-58.83</td>
                  <td align="center">18.42</td>
                  <td align="center">22.7</td>
                  <td align="center">-1.58</td>
                  <td align="center">24.28</td>
                </tr>
                <tr>
                  <td colspan="10">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">PR2</td>
                  <td align="center">156.55</td>
                  <td align="center">-14.57</td>
                  <td align="center">171.12</td>
                  <td align="center">19.59</td>
                  <td align="center">-43.31</td>
                  <td align="center">62.90</td>
                  <td align="center">146.95</td>
                  <td align="center">10.27</td>
                  <td align="center">136.68</td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <p>Energies of the initial (Eini) and optimized (Emin) structures are given in kcal/mol.</p>
            </table-wrap-foot>
          </table-wrap>
          <p>Table <xref ref-type="table" rid="T3">3A</xref> reports the RMSD values (all heavy atoms) between the initial and optimized structures for the four small molecules with the three force fields. When comparing the RMSD values between the optimized and initial structures similar results are observed between AMMOS and MMFF94s, as could also be seen in Figure <xref ref-type="fig" rid="F2">2</xref> which represents the superimposition (all heavy atoms) of the structures minimized by AMMP, MMFF94s and Tff. In conclusion, the results obtained after minimization with AMMOS are close to those obtained by other force fields. A widely accepted quality measure for the predicted conformations of small molecules is the RMSD from structures extracted from crystal protein-ligand complexes [<xref ref-type="bibr" rid="B57">57</xref>,<xref ref-type="bibr" rid="B58">58</xref>] despite the fact that the experimental structure does not necessarily correspond to the lowest-energy conformation [<xref ref-type="bibr" rid="B58">58</xref>-<xref ref-type="bibr" rid="B60">60</xref>]. The RMSD values between our minimized and X-ray structures are given in Table <xref ref-type="table" rid="T3">3B</xref>. The relatively low RMSD values between the optimized and X-ray structures suggest that AMMOS produces reasonable and reliable small compound structural geometries.</p>
          <table-wrap position="float" id="T3">
            <label>Table 3</label>
            <caption>
              <p>RMSD values (in Å) obtained after matching the optimized and initial structures (A) and the optimized and X-ray structures (B)</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <td align="center">
                    <bold>A</bold>
                  </td>
                  <td align="center">
                    <bold>AMMOS</bold>
                  </td>
                  <td align="center">
                    <bold>MMFF94s</bold>
                  </td>
                  <td align="center">
                    <bold>Tff</bold>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">raloxifene</td>
                  <td align="center">0.80</td>
                  <td align="center">0.84</td>
                  <td align="center">1.34</td>
                </tr>
                <tr>
                  <td align="left">FDI</td>
                  <td align="center">0.14</td>
                  <td align="center">0.49</td>
                  <td align="center">1.13</td>
                </tr>
                <tr>
                  <td align="left">thymidine</td>
                  <td align="center">0.15</td>
                  <td align="center">0.26</td>
                  <td align="center">0.51</td>
                </tr>
                <tr>
                  <td align="left">PR2</td>
                  <td align="center">0.40</td>
                  <td align="center">1.13</td>
                  <td align="center">1.23</td>
                </tr>
                <tr>
                  <td colspan="4">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="center">
                    <bold>B</bold>
                  </td>
                  <td align="center">
                    <bold>AMMOS</bold>
                  </td>
                  <td align="center">
                    <bold>MMFF94s</bold>
                  </td>
                  <td align="center">
                    <bold>Tff</bold>
                  </td>
                </tr>
                <tr>
                  <td colspan="4">
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left">raloxifene</td>
                  <td align="center">2.12</td>
                  <td align="center">2.39</td>
                  <td align="center">1.51</td>
                </tr>
                <tr>
                  <td align="left">FDI</td>
                  <td align="center">1.88</td>
                  <td align="center">1.90</td>
                  <td align="center">1.52</td>
                </tr>
                <tr>
                  <td align="left">thymidine</td>
                  <td align="center">1.03</td>
                  <td align="center">1.01</td>
                  <td align="center">1.17</td>
                </tr>
                <tr>
                  <td align="left">PR2</td>
                  <td align="center">1.69</td>
                  <td align="center">1.68</td>
                  <td align="center">1.57</td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <p>The minimization with AMMOS is performed with 2×500 iterations and sp4 force field.</p>
            </table-wrap-foot>
          </table-wrap>
          <fig position="float" id="F2">
            <label>Figure 2</label>
            <caption>
              <p><bold>Structural refinement of four small molecules with AMMOS (magenta), MMFF94s (cyan) and Tff (yellow)</bold>. The minimized structures are superimposed on the corresponding X-ray structures (all atom colored). Raloxifene (A), FDI (B), thymidine (C) and PR2 (D).</p>
            </caption>
            <graphic xlink:href="1471-2105-9-438-2"/>
          </fig>
        </sec>
        <sec>
          <title>Energy minimizations of a large chemical library with AMMOS</title>
          <p>The AMMOS procedure for minimization of small compounds was applied to a chemical library of 37970 single conformer molecules (see Methods, Compound collections). Figure <xref ref-type="fig" rid="F3">3A</xref> shows that the differences (ΔE) between the energies of the AMMOS minimized and initial structures generated by OMEGA can be up to around 200 kcal.mol<sup>-1</sup>. Figure <xref ref-type="fig" rid="F3">3B</xref> shows in a more illustrative way the ΔE distribution in the compounds databank: for 76% of the molecules ΔE is below 50 kcal/mol, and only 4% of the compounds show ΔE values &gt; 100 kcal/mol. It should be noted, that AMMOS succeeded to minimize molecules with very high initial energies. The AMMOS minimization improves the geometries thus making the optimized structures more appropriate for subsequent docking and scoring. It is interesting to note that we did not succeed to optimize several structures presenting severe internal clashes and thus very high energies with the other minimization protocols like, for instance, steepest descend, at least as implemented in the AMMP package. This is of interest since, when the derivatives of the energy function are high, it is usually accepted that steepest descents is the most appropriate minimizer. Overall, these results and tests demonstrate the efficiency of AMMOS in the structural refinement of a compound collection.</p>
          <fig position="float" id="F3">
            <label>Figure 3</label>
            <caption>
              <p><bold>Energy minimization results for a chemical library of 37970 small organic molecules</bold>. A. Scatter-plot of the energy differences ΔE in kcal/mol between the AMMOS minimized and initial structures; B. Pieplot of the ΔE distribution.</p>
            </caption>
            <graphic xlink:href="1471-2105-9-438-3"/>
          </fig>
        </sec>
      </sec>
      <sec>
        <title>II. Energy minimization of protein-ligand complexes with AMMOS</title>
        <sec>
          <title>Generation of docked protein-ligand complexes</title>
          <p>Prior to the minimization step carried out with the AMMOS procedure, the protein-ligand complexes were generated using a two-step docking protocol (see Methods). The decoy library contains 37,970 drug-like molecules and two protein targets were used for the VLS experiments. The 37,970 compounds were docked/scored on each protein target, NA and ER, employing first rigid body docking performed with our MS-DOCK protocol [<xref ref-type="bibr" rid="B47">47</xref>] and next flexible docking (from the ligand side) with DOCK6. The top ~30% best scored molecules were selected after the rigid docking step and 6 known actives for ER out of 10 were found. In the case of NA, we decided to select about 50% of the best-scored molecules after the rigid docking, and among these, 6 actives out of 10 were present. In our previous study [<xref ref-type="bibr" rid="B47">47</xref>], we demonstrated that for large ligands filling well the binding pocket (which is the case of ER) selecting the top 30% of the database after shape-complementarity filtering by rigid docking gives a sufficient enrichment for a subsequent flexible docking step. When relatively small ligands bind to a very open and flat pocket (which is the case of NA), 50% of the top ranked ligands after the first rigid docking step should be selected for the subsequent flexible docking step. After flexible docking, we disposed of two target-specific compound libraries, each containing 12,000 compounds (52,345 conformers) for ER and 22,000 compounds (70,120 conformers) for NA. These two collections containing pre-docked ligands in a multi-conformer state were subsequently subjected to the AMMOS minimization protocol.</p>
        </sec>
        <sec>
          <title>Enrichment studies using AMMOS</title>
          <p>We next investigated the impact of the minimization protocol and rescoring with AMMOS on enrichment. The AMMOS runs were performed on ER and NA for the five developed cases (see Figure <xref ref-type="fig" rid="F1">1</xref> and the Methods for details). <italic>Case 1 </italic>and <italic>2 </italic>(full flexible receptor during the minimization) were carried out only for the real actives to reduce the calculation time. Calculations within the framework of <italic>cases 3</italic>, <italic>4 </italic>and <italic>5</italic>, with a partial flexibility of the protein within a 6Å sphere around the ligand (this is a user defined parameter), were performed for the entire pre-docked chemical library. As mentioned above, we used conjugate gradient with the <italic>sp4 </italic>force field. We decided to apply two cycles of 500 iterations in order to have an acceptable compromise between level of minimization and calculation time.</p>
          <p>Figure <xref ref-type="fig" rid="F4">4</xref> illustrates the RMSD between the X-ray and AMMOS minimized structures (applying all <italic>cases </italic>1–5) for 6 ER and NA inhibitors retrieved after DOCK6 flexible docking and saved in a multi-conformer state (up to 10 poses per ligand). Although ligands bound to proteins are not always in the lowest-energy conformation [<xref ref-type="bibr" rid="B59">59</xref>], several recent studies suggested that the bioactive ligand structure should not deviate substantially from a low-energy state [<xref ref-type="bibr" rid="B61">61</xref>]. Thus, the lowest-energy conformers are also shown in Figure <xref ref-type="fig" rid="F4">4</xref>. As seen in this figure, for all shown inhibitors but ER3, the best fitting conformers, with all <italic>cases 1–5</italic>, show RMSD values with the experimental structure below 1.5 Å, highlighting further the performance of AMMOS minimization [<xref ref-type="bibr" rid="B12">12</xref>]. Slightly better results were obtained for ER when the whole receptor was involved in the minimization (Fig. <xref ref-type="fig" rid="F4">4A</xref>) compared to the data in which the binding pocket and/or the ligand alone were taken into account (Fig. <xref ref-type="fig" rid="F4">4B</xref>). In the case of NA, important differences depending on the involved receptor level in the minimization were not observed.</p>
          <fig position="float" id="F4">
            <label>Figure 4</label>
            <caption>
              <p><bold>RMSD (Å) between the AMMOS minimized and X-ray structures for the inhibitors retrieved for the ER and NA targets</bold>. A. Each point represents a single conformer minimized with <italic>case 1 </italic>(black), <italic>case 2 </italic>(grey); Triangles refer to the conformers with lowest energy after AMMOS minimization; B. All conformers are represented by points, with respectively black for <italic>case 3</italic>, grey for <italic>case 4 </italic>and white for <italic>case 5</italic>. Triangles refer to the conformers with lowest energy after AMMOS minimization.</p>
            </caption>
            <graphic xlink:href="1471-2105-9-438-4"/>
          </fig>
          <p>Further we validated the importance of using AMMOS as a final step of a hierarchical VLS protocol. We used a two-stage VLS protocol and a compound collection of 37,970 compounds to generate and select protein-ligand complexes with satisfactory shape complementarity, thus reducing the number of protein-ligand complexes to be minimized. The final selected pre-docked protein-ligand complexes for both protein targets containing 60% of the real active compounds were subjected to energy minimization with AMMOS. Figure <xref ref-type="fig" rid="F5">5</xref> shows the enrichment graphs for the two targets before and after application of the AMMOS minimization protocol. Enrichments for the ER inhibitors (Figure <xref ref-type="fig" rid="F5">5A</xref>) when employing <italic>cases 3 </italic>(red) and <italic>4 </italic>(magenta) are better than with the <italic>case 5 </italic>(green). In both <italic>cases 3 </italic>and <italic>4</italic>, AMMOS retrieved 50% of the inhibitors in the top 3% (1200 compounds) of the entire database.</p>
          <fig position="float" id="F5">
            <label>Figure 5</label>
            <caption>
              <p><bold>Enrichment graphs for ER (A) and NA (B) inhibitors after AMMOS minimization and rescoring</bold>. The y-axis is the % of retrieved actives versus the percentage of the database screened (x-axis): enrichment results after flexible docking step (blue); enrichment results after re-scoring employing AMMOS minimization: <italic>case 3 </italic>(red), all protein atoms inside a sphere around the ligand can move; <italic>case 4 </italic>(magenta), all side chain protein atoms inside a sphere around the ligand can move; <italic>case 5 </italic>(green), the whole protein is rigid.</p>
            </caption>
            <graphic xlink:href="1471-2105-9-438-5"/>
          </fig>
          <p>NA is known as a "difficult" protein target because its binding pocket is open and flat and thus challenging for docking-scoring methods. Despite these difficulties, results obtained after the three-minimization cases with AMMOS (Figure <xref ref-type="fig" rid="F5">5B</xref>) are reasonable. Again, 50% of the inhibitors are found in less than 10% of the proceeded database. It is interesting to note that when the protein was kept rigid (<italic>case 5</italic>, green), slightly better results for NA were achieved after AMMOS minimization. The above results suggest that AMMOS performs well and its use can help to improve enrichment in multi-step SBVLS protocols.</p>
        </sec>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Optimization of existing SBVLS tools and development of open source packages are of crucial importance to assist drug discovery projects. In this work, we developed a new software tool named AMMOS that refines the 3D structure of compounds present in a compound collection, optimizes the binding poses of docked ligands through MM minimization, and rescores these protein-ligand complexes. The open source package AMMOS wraps and enhances the functionality of the MM simulation program AMMP, facilitating its use for <italic>in silico </italic>screening. Numerous algorithms and protocols can be used to perform SBVLS experiments but in most cases, the receptor structure remains rigid during the docking/scoring procedure. Similarly, compounds obtained from chemical vendors are in 2D and their 3D structures have to be generated. Several tools can perform this task but rarely the compound 3D structures are refined prior to docking while it is known that this can be critical for positioning and obviously scoring [<xref ref-type="bibr" rid="B19">19</xref>]. Further and in order to speed-up the SBVLS process, hierarchical protocols have been developed. These ones can include a relatively crude initial shape complementarity filtering step (e.g., rigid docking with compounds present in multi-conformer states) followed by flexible docking with flexibility allowed only for the ligands. In several situations, it could be beneficial for users to have a tool allowing for partial to fully flexible energy minimization of the protein-ligand complexes, either to help ranking or to optimize the docked poses prior to selecting a list of molecules for experimental assay. AMMOS can be applied in these situations as illustrated below.</p>
    <sec>
      <title>Structural refinement of the compound collections with AMMOS</title>
      <p>Some recent reports suggest that it could be beneficial to minimize the 3D structure of the small molecules before performing docking/scoring computation [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B59">59</xref>]. The question is indeed complex because it is widely accepted that ligands do not necessarily adopt their lowest potential energy conformations when bound to a protein. In fact, ligand energies of bioactive conformations have been estimated to be around 5 kcal/mol above the lowest conformation energy of the same compound in solution [<xref ref-type="bibr" rid="B59">59</xref>]. Further, a recent study carried out on 100 protein-bound ligand crystal structures shows that the ligand conformations are nearly identical to their local minimum conformations obtained from normal mode analysis-monitored energy minimization [<xref ref-type="bibr" rid="B18">18</xref>]. All these studies demonstrate that the ligands bind to proteins in a relatively low energy state, suggesting that highly strained energy input ligand conformations should not be appropriate for docking procedure, keeping in mind that many docking algorithms alter the pose of their input ligands only through translation, rotation, and some dihedral angle variations at rotatable bonds. Minimizing compound collections prior docking experiments was demonstrated to improve both docking and scoring with Surflex [<xref ref-type="bibr" rid="B19">19</xref>]. Our preliminary tests involving docking (with DOCK6) of ER inhibitors initially minimized with AMMOS (see Additional File <xref ref-type="supplementary-material" rid="S2">2</xref>) indeed suggest that minimizing small molecules prior to docking can improve at least the docking accuracy. Thus, as seen in the result section, AMMOS is able to automatically energy minimize a large compound collection. The resulting compounds have less strain energy but remain close from experimental structures and display similar structural features as compounds energy minimized with two other well-known force fields.</p>
    </sec>
    <sec>
      <title>Refinement of protein-ligand complexes and re-scoring with AMMOS</title>
      <p>It is important to note that, at present, it is generally accepted that MM methods are not well-suited for a large scale VLS computations because they are slowing down the calculations and since it is unclear whether or not energy minimization with current force fields could help in the ranking process [<xref ref-type="bibr" rid="B62">62</xref>] (i.e., does MM minimization optimize the poses, does computed interaction energy after energy minimization is beneficial to ranking). Some of these questions start to be addressed as for instance several recent studies suggest that post-docking energy minimization can significantly improve enrichment for some protein targets [<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B26">26</xref>]. It is expected that rescoring after MM minimization cannot help when the ligand is wrongly positioned in the binding cavity, however, when the pose generated by a docking engine is near the experimental conformation, energy minimization seems to be able to optimize locally the structure of the complexes, and in this case, the computed energy values (based on traditional force fields or via other scoring approaches) of the minimized structures can be effective at improving ranking and enrichment [<xref ref-type="bibr" rid="B24">24</xref>].</p>
      <p>In the present study, we provide users with the AMMOS package that refines the structure of pre-docked ligand-protein complexes. To illustrate our method, we applied a two-step docking-scoring VLS protocol (i.e., rigid body docking with MS-DOCK and subsequent ligand flexible docking with DOCK6) on two protein targets, ER and NA. Then, we minimized the 10 best poses obtained with DOCK6 with AMMOS and re-scored each pose. Enrichment curves were obtained with different levels of allowed receptor energy minimization (Figure <xref ref-type="fig" rid="F5">5</xref>). As seen, employing fully flexible minimization in the binding site can considerably improve enrichment as it was observed in the case of ER with 50% of the inhibitors retrieved in the top 3% of the entire database. Thus, users can select different protocols depending on the projects and needs (e.g., consider small local flexibility in the binding site area). In terms of efficiency, enrichments obtained by AMMOS are similar to those seen by other tools such as PLOP [<xref ref-type="bibr" rid="B26">26</xref>]. Indeed, after AMMOS rescoring, we found 40% of the NA inhibitors and 60% of the ER active compounds in the top 5% of the compound libraries (2000 compounds).</p>
      <p>Although the post-docking MM minimization of docked poses can improve the binding modes and the scoring in VLS, it has been also observed that relaxing the protein-ligand complexes for some proteins can worsen the final enrichment although the binding modes are improved. For instance the MM scoring method PLOP [<xref ref-type="bibr" rid="B25">25</xref>] involving a generalized Born solvent model has been shown to improve the overall enrichment only for five out of ten tested protein targets. In average, for these ten targets, better enrichment factors were obtained in the top 0.5% of the proceeded database, however only 10–30% of the inhibitors were retrieved in this limited range. Further similar rescoring via the molecular mechanics-generalized Born surface area (MM-GBSA) method [<xref ref-type="bibr" rid="B63">63</xref>] with relaxation of the protein-ligand complexes by MM minimization with PLOS or short molecular dynamics (MD) with AMBER-DOCK on three simple ligand binding cavities helped to discriminate between several active inhibitors and experimentally proven decoy molecules. Here again, the obtained enrichment factors were lower than those found by docking alone before relaxation and rescoring with MM-GBSA. In that study the authors proposed that ligands too large to be accommodated after docking could indeed fit after relaxation of the binding site. In addition, some imperfections in the balance between polar interactions and solvation penalties can be present in the MM-GBSA methodology.</p>
      <p>Along the same line of reasoning, in our study and in the case of ER where large ligands fill well the binding site (with the ratio Volume of the ligand/Volume of the pocket of 0.95) allowing receptor relaxation with AMMOS (<italic>case </italic>3 and <italic>case </italic>4) led to considerable improvement of the enrichment factors (see Fig. <xref ref-type="fig" rid="F5">5A</xref>). On the other hand, we did not obtain better enrichment after AMMOS in the case of NA (Fig. <xref ref-type="fig" rid="F5">5B</xref>). Also, our additional tests with AMMOS applied on a third protein target, thymidine kinase, did not improve the final enrichment, particularly with <italic>cases </italic>3 and 4 when local receptor flexibility was allowed (data not shown). It seems, that for some binding pockets and ligands, allowing post-docking relaxation of the protein-ligand complexes may worsen the enrichment, thereby increasing the number of false positives, as we observed not only in our investigation of NA and thymidine kinase but also in other studies [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B63">63</xref>]. For NA and thymidine kinase, the ligands do not fill well the binding sites (with a Volume of the ligand/Volume of the pocket ratio of 0.44 and 0.45, respectively). Thus, it can be speculated that for large pockets accepting relatively small ligands, authorizing flexibility around the binding site could damage the final enrichment.</p>
      <p>In terms of speed, AMMOS can perform full atom minimization of the binding site area in about ~30–45 sec/ligand conformer with the default parameters. The protocol provided offer a reasonable compromise between speed and accuracy but the users can reduce the number of iterations and speed-up the calculations, depending on the aims of the projects. In addition, multiple poses optimized with AMMOS can be subsequently re-ranked by employing other scoring functions or consensus scoring [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B16">16</xref>].</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>An efficient MM minimization engine called AMMOS that makes use of the AMMP simulation package has been presented. The fully automatic open-source package AMMOS can perform energy minimization of a large compound collection prior to docking and can also refine pre-docked ligands in the context of a protein structure. AMMOS executes efficient and fast minimization procedures and can thus be employed over a large number of protein-ligand complexes. The users can select the energy minimization protocol depending on the projects and, for instance, fix the protein atoms or allow full flexible minimization of both, the ligand and the receptor. Several initial tests were carried out in order to assess AMMOS. We applied our package on two protein targets, ER and NA, which have very different binding site properties. Results shows that AMMOS performs well on large pre-docked compound collections, retrieving most of the active compounds in the top 3% to 5% of the entire database. Although MS-DOCK and DOCK6 were used in this work, users can apply other docking programs to dock a compound library.</p>
    <p>The present version of AMMOS does not take into consideration possible solvation effects, yet, a few water molecules could be treated by the minimization procedure. However, in such a situation, we do not provide a fully automatic procedure and the users should prepare the proper input files. Automated protocol will be implemented in a future release of AMMOS to treat solvation and water molecules. The full AMMOS package is freely available and should be valuable to research groups involved in drug discovery and chemical biology projects.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>AMMOS is written in C and python and runs on Linux platforms. It is also operational on MacOSX system. Detailed installation instructions are provided in the software package. The source code of AMMOS is freely available under the terms and conditions of the GNU Public License from <ext-link ext-link-type="uri" xlink:href="http://www.vls3d.com/"/>.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>TP wrote the code in C for the AMMOS project, tested the program and drafted the first version of the manuscript. DL wrote and tested the Python code for the automated procedure. IP ran the molecular mechanics computations with the SYBYL software. BOV and MAM conceived the AMMOS tool. MAM designed and managed the project. IP, BOV and MAM took an active part in manuscript writing. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Energy minimization of small molecules with sp4 force field and different AMMP optimization methods.</bold> The minimized energies by the Steepest descent, Conjugate gradient, BFGS, Simplex and a genetic algorithms are plotted against the number of iterations.</p>
      </caption>
      <media xlink:href="1471-2105-9-438-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Docking poses of estrogen receptor inhibitors after flexible docking with DOCK6.</bold> The docking poses of six inhibitors minimized with AMMOS prior to docking as well as the docking poses of the inhibitors not minimized prior to docking are shown.</p>
      </caption>
      <media xlink:href="1471-2105-9-438-S2.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>TP appreciates a grant from the City Hall of Paris. IP thanks Prof. M. Wiese for making available the SYBYL software during her research stay in the Institute of Pharmacy, University of Bonn, Germany. We acknowledge the INSERM institute and the University Paris Descartes and Paris Diderot for financial supports.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>Virtual screening of chemical libraries</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>432</volume>
        <fpage>862</fpage>
        <lpage>865</lpage>
        <pub-id pub-id-type="pmid">15602552</pub-id>
        <pub-id pub-id-type="doi">10.1038/nature03197</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Virtual screening strategies in drug discovery</article-title>
        <source>Curr Opin Chem Biol</source>
        <year>2007</year>
        <volume>11</volume>
        <fpage>494</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">17936059</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2007.08.033</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sperandio</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Miteva</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Delfaud</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Villoutreix</surname>
            <given-names>BO</given-names>
          </name>
        </person-group>
        <article-title>Receptor-based computational screening of compound databases: the main docking-scoring engines</article-title>
        <source>Curr Protein Pept Sci</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>369</fpage>
        <lpage>393</lpage>
        <pub-id pub-id-type="pmid">17073691</pub-id>
        <pub-id pub-id-type="doi">10.2174/138920306778559377</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alvarez</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>High-throughput docking as a source of novel drug leads</article-title>
        <source>Curr Opin Chem Biol</source>
        <year>2004</year>
        <volume>8</volume>
        <fpage>365</fpage>
        <lpage>370</lpage>
        <pub-id pub-id-type="pmid">15288245</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2004.05.001</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seifert</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Essential factors for successful virtual screening</article-title>
        <source>Mini Rev Med Chem</source>
        <year>2008</year>
        <volume>8</volume>
        <fpage>63</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="pmid">18220986</pub-id>
        <pub-id pub-id-type="doi">10.2174/138955708783331540</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Villoutreix</surname>
            <given-names>BO</given-names>
          </name>
          <name>
            <surname>Eudes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Miteva</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Structure-based virtual ligand screening: recent success stories</article-title>
        <source>Combinatorial Chemistry and High Throughput Screening</source>
        <year>2008</year>
        <comment/>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popov</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Yee</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Towards in silico lead optimization: scores from ensembles of protein/ligand conformations reliably correlate with biological activity</article-title>
        <source>Proteins</source>
        <year>2007</year>
        <volume>66</volume>
        <fpage>375</fpage>
        <lpage>387</lpage>
        <pub-id pub-id-type="pmid">17078091</pub-id>
        <pub-id pub-id-type="doi">10.1002/prot.21201</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cavasotto</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Kovacs</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Representing receptor flexibility in ligand docking through relevant normal modes</article-title>
        <source>J Am Chem Soc</source>
        <year>2005</year>
        <volume>127</volume>
        <fpage>9632</fpage>
        <lpage>9640</lpage>
        <pub-id pub-id-type="pmid">15984891</pub-id>
        <pub-id pub-id-type="doi">10.1021/ja042260c</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kovacs</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cavasotto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Conformational sampling of protein flexibility in generalized coordinates: Application to ligand docking</article-title>
        <source>J Comput and Theor Nanoscience</source>
        <year>2005</year>
        <volume>2</volume>
        <fpage>354</fpage>
        <lpage>361</lpage>
        <pub-id pub-id-type="doi">10.1166/jctn.2005.204</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amaro</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Baron</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>McCammon</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>An improved relaxed complex scheme for receptor flexibility in computer-aided drug design</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2008</year>
        <volume>22</volume>
        <fpage>693</fpage>
        <lpage>705</lpage>
        <pub-id pub-id-type="pmid">18196463</pub-id>
        <pub-id pub-id-type="doi">10.1007/s10822-007-9159-2</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Graves</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Chodera</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>McReynolds</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Predicting absolute ligand binding free energies to a simple model site</article-title>
        <source>J Mol Biol</source>
        <year>2007</year>
        <volume>371</volume>
        <fpage>1118</fpage>
        <lpage>1134</lpage>
        <pub-id pub-id-type="pmid">17599350</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2007.06.002</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rajamani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Good</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Ranking poses in structure-based lead discovery and optimization: current trends in scoring function development</article-title>
        <source>Curr Opin Drug Discov Devel</source>
        <year>2007</year>
        <volume>10</volume>
        <fpage>308</fpage>
        <lpage>315</lpage>
        <pub-id pub-id-type="pmid">17554857</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warren</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Capelli</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>LaLonde</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lambert</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lindvall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nevins</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Semus</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Senger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tedesco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wall</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Woolven</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Peishoff</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Head</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>A critical assessment of docking programs and scoring functions</article-title>
        <source>J Med Chem</source>
        <year>2006</year>
        <volume>49</volume>
        <fpage>5912</fpage>
        <lpage>5931</lpage>
        <pub-id pub-id-type="pmid">17004707</pub-id>
        <pub-id pub-id-type="doi">10.1021/jm050362n</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Block</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weskamp</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klebe</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Strategies to search and design stabilizers of protein-protein interactions: a feasibility study</article-title>
        <source>Proteins</source>
        <year>2007</year>
        <volume>68</volume>
        <fpage>170</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="pmid">17393392</pub-id>
        <pub-id pub-id-type="doi">10.1002/prot.21296</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fukunishi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kubota</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Noise reduction method for molecular interaction energy: application to in silico drug screening and in silico target protein screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2006</year>
        <volume>46</volume>
        <fpage>2071</fpage>
        <lpage>2084</lpage>
        <pub-id pub-id-type="pmid">16995738</pub-id>
        <pub-id pub-id-type="doi">10.1021/ci060152z</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Scoring functions for protein-ligand docking</article-title>
        <source>Curr Protein Pept Sci</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>407</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="pmid">17073693</pub-id>
        <pub-id pub-id-type="doi">10.2174/138920306778559395</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pham</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Customizing scoring functions for docking</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2008</year>
        <volume>22</volume>
        <fpage>269</fpage>
        <lpage>286</lpage>
        <pub-id pub-id-type="pmid">18273558</pub-id>
        <pub-id pub-id-type="doi">10.1007/s10822-008-9174-y</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>YP</given-names>
          </name>
        </person-group>
        <article-title>Preference of small molecules for local minimum conformations when binding to proteins</article-title>
        <source>PLoS ONE</source>
        <year>2007</year>
        <volume>2</volume>
        <fpage>e820</fpage>
        <pub-id pub-id-type="pmid">17786192</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0000820</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Surflex-Dock 2.1: robust performance from ligand energetic modeling, ring flexibility, and knowledge-based search</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2007</year>
        <volume>21</volume>
        <fpage>281</fpage>
        <lpage>306</lpage>
        <pub-id pub-id-type="pmid">17387436</pub-id>
        <pub-id pub-id-type="doi">10.1007/s10822-007-9114-2</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miteva</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Montes</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Villoutreix</surname>
            <given-names>BO</given-names>
          </name>
        </person-group>
        <article-title>Fast structure-based virtual ligand screening combining FRED, DOCK, and Surflex</article-title>
        <source>J Med Chem</source>
        <year>2005</year>
        <volume>48</volume>
        <fpage>6012</fpage>
        <lpage>6022</lpage>
        <pub-id pub-id-type="pmid">16162004</pub-id>
        <pub-id pub-id-type="doi">10.1021/jm050262h</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Floriano</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Vaidehi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zamanakos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>WA</given-names>
            <suffix>3rd</suffix>
          </name>
        </person-group>
        <article-title>HierVLS hierarchical docking protocol for virtual ligand screening of large-molecule databases</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <fpage>56</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="pmid">14695820</pub-id>
        <pub-id pub-id-type="doi">10.1021/jm030271v</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Springer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Adalsteinsson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Kegelmeyer</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Roe</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>PostDOCK: a structural, empirical approach to scoring protein ligand complexes</article-title>
        <source>J Med Chem</source>
        <year>2005</year>
        <volume>48</volume>
        <fpage>6821</fpage>
        <lpage>6831</lpage>
        <pub-id pub-id-type="pmid">16250641</pub-id>
        <pub-id pub-id-type="doi">10.1021/jm0493360</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miteva</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical structure-based virtual screening for drug design</article-title>
        <source>Biotechnol Biotechnol Eq</source>
        <year>2008</year>
        <volume>22</volume>
        <fpage>634</fpage>
        <lpage>638</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://diagnosisp.com/dp/journals/issue.php?journal_id=1&amp;archive=0&amp;issue_id=17 "/>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perola</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Charifson</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>A detailed comparison of current docking and scoring methods on systems of pharmaceutical relevance</article-title>
        <source>Proteins</source>
        <year>2004</year>
        <volume>56</volume>
        <fpage>235</fpage>
        <lpage>249</lpage>
        <pub-id pub-id-type="pmid">15211508</pub-id>
        <pub-id pub-id-type="doi">10.1002/prot.20088</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kalyanaraman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Physics-based scoring of protein-ligand complexes: enrichment of known inhibitors in large-scale virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2006</year>
        <volume>46</volume>
        <fpage>243</fpage>
        <lpage>253</lpage>
        <pub-id pub-id-type="pmid">16426060</pub-id>
        <pub-id pub-id-type="doi">10.1021/ci0502855</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kalyanaraman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bernacki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanics methods for predicting protein-ligand binding</article-title>
        <source>Phys Chem Chem Phys</source>
        <year>2006</year>
        <volume>8</volume>
        <fpage>5166</fpage>
        <lpage>5177</lpage>
        <pub-id pub-id-type="pmid">17203140</pub-id>
        <pub-id pub-id-type="doi">10.1039/b608269f</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koska</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spassov</surname>
            <given-names>VZ</given-names>
          </name>
          <name>
            <surname>Maynard</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Austin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Flook</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Venkatachalam</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Fully Automated Molecular Mechanics Based Induced Fit Protein-Ligand Docking Method</article-title>
        <source>J Chem Inf Model</source>
        <year>2008</year>
        <comment/>
        <pub-id pub-id-type="pmid">18816046</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanics calculations on Rous sarcoma virus protease with peptide substrates</article-title>
        <source>Protein Sci</source>
        <year>1997</year>
        <volume>6</volume>
        <fpage>2365</fpage>
        <lpage>2374</lpage>
        <pub-id pub-id-type="pmid">9385639</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanics analysis of drug-resistant mutants of HIV protease</article-title>
        <source>Protein Eng</source>
        <year>1999</year>
        <volume>12</volume>
        <fpage>469</fpage>
        <lpage>474</lpage>
        <pub-id pub-id-type="pmid">10388843</pub-id>
        <pub-id pub-id-type="doi">10.1093/protein/12.6.469</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="other">
        <article-title>AMMP</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.cs.gsu.edu/~cscrwh/ammp/ammp.html"/>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Chastine</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Owen</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>AMMP-Vis: a collaborative virtual environment for molecular modeling</article-title>
        <source>Proceedings of the ACM symposium on Virtual reality software and technology, Monterey, CA, USA</source>
        <year>2005</year>
        <fpage>8</fpage>
        <lpage>15</lpage>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedretti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Villa</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vistoli</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>VEGA – an open platform to develop chemo-bio-informatics applications, using plug-in architecture and script programming</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2004</year>
        <volume>18</volume>
        <fpage>167</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="pmid">15368917</pub-id>
        <pub-id pub-id-type="doi">10.1023/B:JCAM.0000035186.90683.f2</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zegers</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Haikal</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wyns</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Crystal structure of RNase T1 with 3'-guanylic acid and guanosine</article-title>
        <source>J Biol Chem</source>
        <year>1994</year>
        <volume>269</volume>
        <fpage>127</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="pmid">8276784</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Predicted ligand interactions of 3'5'-cyclic nucleotide-gated channel binding sites: comparison of retina and olfactory binding site models</article-title>
        <source>Protein Eng</source>
        <year>1996</year>
        <volume>9</volume>
        <fpage>333</fpage>
        <lpage>344</lpage>
        <pub-id pub-id-type="pmid">8738209</pub-id>
        <pub-id pub-id-type="doi">10.1093/protein/9.4.333</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Jarjous</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Proposed structural mechanism of Escherichia coli cAMP receptor protein cAMP-dependent proteolytic cleavage protection and selective and nonselective DNA binding</article-title>
        <source>Biochemistry</source>
        <year>2005</year>
        <volume>44</volume>
        <fpage>8730</fpage>
        <lpage>8748</lpage>
        <pub-id pub-id-type="pmid">15952780</pub-id>
        <pub-id pub-id-type="doi">10.1021/bi0479609</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="other">
        <article-title>Tripos Inc., St. Louis, MO 63144</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.tripos.com"/>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rappé</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Casewit</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Colwell</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>WA</given-names>
            <suffix>III</suffix>
          </name>
          <name>
            <surname>Skiff</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>UFF, a full periodic table force field for molecular mechanics and molecular dynamics simulations</article-title>
        <source>J Am Chem Soc</source>
        <year>1992</year>
        <volume>114</volume>
        <fpage>10024</fpage>
        <lpage>10035</lpage>
        <pub-id pub-id-type="doi">10.1021/ja00051a040</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiner</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Kollman</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Case</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>An all atom force field for simulations of proteins and nucleic acids</article-title>
        <source>J Comput Chem</source>
        <year>1986</year>
        <volume>7</volume>
        <fpage>230</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.540070216</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagossi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zahuczky</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tözsér</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Improved parameters for generating partial charges: correlation with observed dipole moments</article-title>
        <source>J Mol Model</source>
        <year>1999</year>
        <volume>5</volume>
        <fpage>143</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="doi">10.1007/s008940050114</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Leach</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Molecular modelling: principles and applications</source>
        <year>2001</year>
        <publisher-name>Prentice Hall</publisher-name>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nocedal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <source>Numerical Optimization</source>
        <year>1999</year>
        <publisher-name>Springer</publisher-name>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Charbonneau</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>An introduction to genetic algorithms for numerical optimization</source>
        <year>2002</year>
        <publisher-name>Colorado: NCAR Technical Note, Boulder</publisher-name>
      </citation>
    </ref>
    <ref id="B43">
      <citation citation-type="other">
        <article-title>Openeye Scientific Software</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.eyesopen.com"/>
      </citation>
    </ref>
    <ref id="B44">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gasteiger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marsili</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new model for calculating atomic charges in molecules</article-title>
        <source>Tetrahedron Lett</source>
        <year>1978</year>
        <volume>19</volume>
        <fpage>3181</fpage>
        <lpage>3184</lpage>
        <pub-id pub-id-type="doi">10.1016/S0040-4039(01)94977-9</pub-id>
      </citation>
    </ref>
    <ref id="B45">
      <citation citation-type="other">
        <article-title>Open Babel</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://openbabel.sf.net"/>
      </citation>
    </ref>
    <ref id="B46">
      <citation citation-type="other">
        <article-title>InsightII</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.accelrys.com/"/>
      </citation>
    </ref>
    <ref id="B47">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sauton</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lagorce</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Villoutreix</surname>
            <given-names>BO</given-names>
          </name>
          <name>
            <surname>Miteva</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>MS-DOCK: Accurate multiple conformation generator and rigid docking protocol for multi-step virtual ligand screening</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>184</fpage>
        <pub-id pub-id-type="pmid">18402678</pub-id>
      </citation>
    </ref>
    <ref id="B48">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>MMFF VI. MMFF94s option for energy minimization studies</article-title>
        <source>J Comput Chem</source>
        <year>1999</year>
        <volume>20</volume>
        <fpage>720</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1096-987X(199905)20:7&lt;720::AID-JCC7&gt;3.0.CO;2-X</pub-id>
      </citation>
    </ref>
    <ref id="B49">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Powell</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Restart procedures for the conjugate gradient method</article-title>
        <source>Mathematical Programming</source>
        <year>1977</year>
        <volume>12</volume>
        <fpage>241</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01593790</pub-id>
      </citation>
    </ref>
    <ref id="B50">
      <citation citation-type="other">
        <article-title>DOCK6</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://dock.compbio.ucsf.edu/DOCK_6/"/>
      </citation>
    </ref>
    <ref id="B51">
      <citation citation-type="other">
        <article-title>DMS program</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.cgl.ucsf.edu/Overview/software.html#dms"/>
      </citation>
    </ref>
    <ref id="B52">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DesJarlais</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Seibel</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Kuntz</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Venkataraghavan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using shape complementarity as an initial screen in designing ligands for a receptor binding site of known three-dimensional structure</article-title>
        <source>J Med Chem</source>
        <year>1988</year>
        <volume>31</volume>
        <fpage>722</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="pmid">3127588</pub-id>
        <pub-id pub-id-type="doi">10.1021/jm00399a006</pub-id>
      </citation>
    </ref>
    <ref id="B53">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Makino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kuntz</surname>
            <given-names>ID</given-names>
          </name>
        </person-group>
        <article-title>Automated flexible ligand docking method and its application for database search</article-title>
        <source>J Comput Chem</source>
        <year>1997</year>
        <volume>18</volume>
        <fpage>1812</fpage>
        <lpage>1825</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1096-987X(19971115)18:14&lt;1812::AID-JCC10&gt;3.0.CO;2-H</pub-id>
      </citation>
    </ref>
    <ref id="B54">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Westbrook</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gilliland</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bhat</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Weissig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shindyalov</surname>
            <given-names>IN</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>The Protein Data Bank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="pmid">10592235</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
      </citation>
    </ref>
    <ref id="B55">
      <citation citation-type="other">
        <article-title>ChemBridge Corporation</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://chembridge.com"/>
      </citation>
    </ref>
    <ref id="B56">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miteva</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Villoutreix</surname>
            <given-names>BO</given-names>
          </name>
        </person-group>
        <article-title>Structure-based virtual ligand screening with LigandFit: pose prediction and enrichment of compound collections</article-title>
        <source>Proteins</source>
        <year>2007</year>
        <volume>68</volume>
        <fpage>712</fpage>
        <lpage>725</lpage>
        <pub-id pub-id-type="pmid">17510958</pub-id>
        <pub-id pub-id-type="doi">10.1002/prot.21405</pub-id>
      </citation>
    </ref>
    <ref id="B57">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirchmair</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wolber</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Laggner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Langer</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Comparative performance assessment of the conformational model generators omega and catalyst: a large-scale survey on the retrieval of protein-bound ligand conformations</article-title>
        <source>J Chem Inf Model</source>
        <year>2006</year>
        <volume>46</volume>
        <fpage>1848</fpage>
        <lpage>1861</lpage>
        <pub-id pub-id-type="pmid">16859316</pub-id>
        <pub-id pub-id-type="doi">10.1021/ci060084g</pub-id>
      </citation>
    </ref>
    <ref id="B58">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bostrom</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Reproducing the conformations of protein-bound ligands: a critical evaluation of several popular conformational searching tools</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2001</year>
        <volume>15</volume>
        <fpage>1137</fpage>
        <lpage>1152</lpage>
        <pub-id pub-id-type="pmid">12160095</pub-id>
        <pub-id pub-id-type="doi">10.1023/A:1015930826903</pub-id>
      </citation>
    </ref>
    <ref id="B59">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perola</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Charifson</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>Conformational analysis of drug-like molecules bound to proteins: an extensive study of ligand reorganization upon binding</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <fpage>2499</fpage>
        <lpage>2510</lpage>
        <pub-id pub-id-type="pmid">15115393</pub-id>
        <pub-id pub-id-type="doi">10.1021/jm030563w</pub-id>
      </citation>
    </ref>
    <ref id="B60">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirado-Rives</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jorgensen</surname>
            <given-names>WL</given-names>
          </name>
        </person-group>
        <article-title>Contribution of conformer focusing to the uncertainty in predicting free energies for protein-ligand binding</article-title>
        <source>J Med Chem</source>
        <year>2006</year>
        <volume>49</volume>
        <fpage>5880</fpage>
        <lpage>5884</lpage>
        <pub-id pub-id-type="pmid">17004703</pub-id>
        <pub-id pub-id-type="doi">10.1021/jm060763i</pub-id>
      </citation>
    </ref>
    <ref id="B61">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawkins</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Skillman</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Nicholls</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>How to do an evaluation: pitfalls and traps</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2008</year>
        <volume>22</volume>
        <fpage>179</fpage>
        <lpage>190</lpage>
        <pub-id pub-id-type="pmid">18217218</pub-id>
        <pub-id pub-id-type="doi">10.1007/s10822-007-9166-3</pub-id>
      </citation>
    </ref>
    <ref id="B62">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banks</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Beard</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Damm</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Farid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Felts</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Maple</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Philipp</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Repasky</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>LY</given-names>
          </name>
          <name>
            <surname>Berne</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gallicchio</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Integrated Modeling Program, Applied Chemical Theory (IMPACT)</article-title>
        <source>J Comput Chem</source>
        <year>2005</year>
        <volume>26</volume>
        <fpage>1752</fpage>
        <lpage>1780</lpage>
        <pub-id pub-id-type="pmid">16211539</pub-id>
        <pub-id pub-id-type="doi">10.1002/jcc.20292</pub-id>
      </citation>
    </ref>
    <ref id="B63">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graves</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Shivakumar</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Boyce</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Case</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>Rescoring docking hit lists for model cavity sites: predictions and experimental testing</article-title>
        <source>J Mol Biol</source>
        <year>2008</year>
        <volume>377</volume>
        <fpage>914</fpage>
        <lpage>934</lpage>
        <pub-id pub-id-type="pmid">18280498</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2008.01.049</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
