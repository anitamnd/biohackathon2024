<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1009410.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8476010</article-id>
    <article-id pub-id-type="pmid">34499658</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-00064</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009410</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Biochemical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Biochemical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Systems Science</subject>
          <subj-group>
            <subject>Systems Biology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Systems Science</subject>
            <subj-group>
              <subject>Systems Biology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Biophysical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biophysical Simulations</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Biophysical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolic Pathways</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecological Metrics</subject>
            <subj-group>
              <subject>Species Diversity</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecological Metrics</subject>
            <subj-group>
              <subject>Species Diversity</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Material Properties</subject>
            <subj-group>
              <subject>Mechanical Properties</subject>
              <subj-group>
                <subject>Stiffness</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Stoichiometry</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FiCoS: A fine-grained and coarse-grained GPU-powered deterministic simulator for biochemical networks</article-title>
      <alt-title alt-title-type="running-head">FiCoS: A novel GPU-powered deterministic simulator for biochemical networks</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5856-4453</contrib-id>
        <name>
          <surname>Tangherloni</surname>
          <given-names>Andrea</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7692-7203</contrib-id>
        <name>
          <surname>Nobile</surname>
          <given-names>Marco S.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7780-0434</contrib-id>
        <name>
          <surname>Cazzaniga</surname>
          <given-names>Paolo</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Capitoli</surname>
          <given-names>Giulia</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3383-367X</contrib-id>
        <name>
          <surname>Spolaor</surname>
          <given-names>Simone</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3341-5483</contrib-id>
        <name>
          <surname>Rundo</surname>
          <given-names>Leonardo</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="aff008" ref-type="aff">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3520-4022</contrib-id>
        <name>
          <surname>Mauri</surname>
          <given-names>Giancarlo</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5532-3059</contrib-id>
        <name>
          <surname>Besozzi</surname>
          <given-names>Daniela</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Human and Social Sciences, University of Bergamo, Bergamo, Italy</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Industrial Engineering &amp; Innovation Sciences, Eindhoven University of Technology, Eindhoven, The Netherlands</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>SYSBIO/ISBE.IT Centre of Systems Biology, Milan, Italy</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Bicocca Bioinformatics Biostatistics and Bioimaging Centre (B4), University of Milano-Bicocca, Vedano al Lambro, Italy</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>School of Medicine and Surgery, University of Milano-Bicocca, Monza, Italy</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Informatics, Systems and Communication, University of Milano-Bicocca, Milan, Italy</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Department of Radiology, University of Cambridge, Cambridge, United Kingdom</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>Cancer Research UK Cambridge Centre, University of Cambridge, Cambridge, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>andrea.tangherloni@unibg.it</email> (AT); <email>daniela.besozzi@unimib.it</email> (DB)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>9</issue>
    <elocation-id>e1009410</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Tangherloni et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Tangherloni et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="pcbi.1009410.pdf"/>
    <abstract>
      <p>Mathematical models of biochemical networks can largely facilitate the comprehension of the mechanisms at the basis of cellular processes, as well as the formulation of hypotheses that can be tested by means of targeted laboratory experiments. However, two issues might hamper the achievement of fruitful outcomes. On the one hand, detailed mechanistic models can involve hundreds or thousands of molecular species and their intermediate complexes, as well as hundreds or thousands of chemical reactions, a situation generally occurring in rule-based modeling. On the other hand, the computational analysis of a model typically requires the execution of a large number of simulations for its calibration, or to test the effect of perturbations. As a consequence, the computational capabilities of modern Central Processing Units can be easily overtaken, possibly making the modeling of biochemical networks a worthless or ineffective effort. To the aim of overcoming the limitations of the current state-of-the-art simulation approaches, we present in this paper FiCoS, a novel “black-box” deterministic simulator that effectively realizes both a fine-grained and a coarse-grained parallelization on Graphics Processing Units. In particular, FiCoS exploits two different integration methods, namely, the Dormand–Prince and the Radau IIA, to efficiently solve both non-stiff and stiff systems of coupled Ordinary Differential Equations. We tested the performance of FiCoS against different deterministic simulators, by considering models of increasing size and by running analyses with increasing computational demands. FiCoS was able to dramatically speedup the computations up to 855×, showing to be a promising solution for the simulation and analysis of large-scale models of complex biological processes.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Systems Biology is an interdisciplinary research area focusing on the integration of biological data with mathematical and computational methods in order to unravel and predict the emergent behavior of complex biological systems. The ultimate goal is the understanding of the complex mechanisms at the basis of biological processes, together with the formulation of novel hypotheses that can be then tested by means of laboratory experiments. In such a context, mechanistic models can be used to describe and investigate biochemical reaction networks by taking into account all the details related to their stoichiometry and kinetics. Unfortunately, these models can be characterized by hundreds or thousands of molecular species and biochemical reactions, making their simulation unfeasible with classic simulators running on Central Processing Units (CPUs). In addition, a large number of simulations might be required to calibrate the models and/or to test the effect of perturbations. In order to overcome the limitations imposed by CPUs, Graphics Processing Units (GPUs) can be effectively used to accelerate the simulations of these models. We thus designed and developed a novel GPU-based tool, called FiCoS, to speed-up the computational analyses typically required in Systems Biology.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by the SYSBIO/ISBE.IT Centre of Systems Biology.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-09-27</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The source code of FiCoS, both CPU and GPU versions, as well as all the scripts used to generate the results shown in the paper, are publicly and freely available on GitLab: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.com/andrea-tango/ficos" ext-link-type="uri">https://gitlab.com/andrea-tango/ficos</ext-link>. In the same repository, we also uploaded the code of the CPU versions of LSODA and VODE that were used to perform the tests shown in the paper. LASSIE and cupSODA source codes can be downloaded from the corresponding GitHub repositories. All other relevant data are within the manuscript and its <xref rid="sec012" ref-type="sec">Supporting information</xref> files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The source code of FiCoS, both CPU and GPU versions, as well as all the scripts used to generate the results shown in the paper, are publicly and freely available on GitLab: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.com/andrea-tango/ficos" ext-link-type="uri">https://gitlab.com/andrea-tango/ficos</ext-link>. In the same repository, we also uploaded the code of the CPU versions of LSODA and VODE that were used to perform the tests shown in the paper. LASSIE and cupSODA source codes can be downloaded from the corresponding GitHub repositories. All other relevant data are within the manuscript and its <xref rid="sec012" ref-type="sec">Supporting information</xref> files.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The computational analysis of complex biological processes relies on the definition and simulation of mathematical models to investigate the emergent dynamics of these processes both in physiological and perturbed conditions [<xref rid="pcbi.1009410.ref001" ref-type="bibr">1</xref>]. The formalism based on Reaction-Based Models (RBMs) provides a detailed description of biochemical reaction networks [<xref rid="pcbi.1009410.ref002" ref-type="bibr">2</xref>], and represents one of the most suitable solutions to achieve an in-depth comprehension of the underlying control mechanisms of the cellular system under analysis [<xref rid="pcbi.1009410.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1009410.ref004" ref-type="bibr">4</xref>]. RBMs can be straightforwardly exploited to execute different computational tasks, such as Parameter Estimation (PE), Sensitivity Analysis (SA), and Parameter Sweep Analysis (PSA) [<xref rid="pcbi.1009410.ref005" ref-type="bibr">5</xref>–<xref rid="pcbi.1009410.ref007" ref-type="bibr">7</xref>], to gain insights about the system and drive the design of further laboratory experiments. However, these tasks typically require a huge amount of simulations of an RBM with distinct parameterizations, that is, different initial molecular amounts and/or kinetic constants. In addition, when the RBM under investigation is characterized by hundreds or thousands of molecular species and reactions, even one simulation could be so demanding that the capability of modern Central Processing Units (CPUs) is rapidly overtaken.</p>
    <p>In the last decade, many efforts have been made to develop efficient computational tools able to perform massive numbers of simulations of large-scale RBMs. High-performance computing architectures, like Graphics Processing Units (GPUs), have gained ground and have been widely adopted for the parallelization of a variety of tasks in Systems Biology and Bioinformatics [<xref rid="pcbi.1009410.ref008" ref-type="bibr">8</xref>]. GPUs are low-cost, energy-efficient, and powerful many-core co-processors capable of tera-scale performances on common workstations, which can be exploited to dramatically reduce the running time required by traditional CPU-based approaches. Considering the GPU-powered biochemical simulation, the scheme in <xref rid="pcbi.1009410.g001" ref-type="fig">Fig 1</xref> summarizes the current state-of-the-art. The existing tools can be categorized with respect to two main concepts: the simulation granularity, and the simulation type [<xref rid="pcbi.1009410.ref008" ref-type="bibr">8</xref>]. The former category determines how the threads of the GPU can be used: in coarse-grained simulations, each thread corresponds to an independent simulation; in fine-grained simulations, the calculations of a single simulation are distributed over multiple threads. The latter category specifies whether a deterministic, stochastic, or hybrid simulation algorithm is used [<xref rid="pcbi.1009410.ref009" ref-type="bibr">9</xref>–<xref rid="pcbi.1009410.ref011" ref-type="bibr">11</xref>].</p>
    <fig position="float" id="pcbi.1009410.g001">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1009410.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>The “semiotic square” of GPU-powered simulators.</title>
        <p>The horizontal axis represents the parallelization strategy that can be realized to leverage the GPU capabilities: coarse-grained (left), in which multiple simulations are performed in a parallel fashion; fine-grained (right), in which a single simulation is accelerated by distributing the computation over multiple threads. The vertical axis partitions the two types of simulation: deterministic (top) and stochastic (bottom). FiCoS is a deterministic approach implementing both a fine- and a coarse-grained parallelization strategy, filling the gap in the state-of-the-art.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.g001" position="float"/>
    </fig>
    <p>The first GPU-powered simulator was proposed by Li and Petzold [<xref rid="pcbi.1009410.ref012" ref-type="bibr">12</xref>], and consisted in the implementation of the Stochastic Simulation Algorithm (SSA) [<xref rid="pcbi.1009410.ref013" ref-type="bibr">13</xref>]. SSA was later implemented in cuda-sim [<xref rid="pcbi.1009410.ref014" ref-type="bibr">14</xref>], a Python tool for Systems Biology that also supports deterministic simulations. Nobile <italic toggle="yes">et al</italic>. proposed two further GPU-based coarse-grained implementations: cupSODA [<xref rid="pcbi.1009410.ref015" ref-type="bibr">15</xref>], a deterministic simulator based on the Livermore Solver of Ordinary Differential Equations (LSODA) [<xref rid="pcbi.1009410.ref016" ref-type="bibr">16</xref>], and cuTauLeaping [<xref rid="pcbi.1009410.ref017" ref-type="bibr">17</xref>], a stochastic simulator based on a variant of the tau-leaping algorithm [<xref rid="pcbi.1009410.ref018" ref-type="bibr">18</xref>]. cupSODA was then integrated with PySB [<xref rid="pcbi.1009410.ref019" ref-type="bibr">19</xref>], a well-known modeling and simulation framework that allows the user to create biological models as Python programs [<xref rid="pcbi.1009410.ref020" ref-type="bibr">20</xref>]. To date, there exist only two purely fine-grained approaches: LASSIE (LArge-Scale SImulator) [<xref rid="pcbi.1009410.ref021" ref-type="bibr">21</xref>], a fine-grained deterministic simulator tailored on large-scale models (i.e., with more than 100 chemical species), and the large-scale tau-leaping variant proposed by Komarov and D’Souza [<xref rid="pcbi.1009410.ref022" ref-type="bibr">22</xref>], designed to accelerate very large-scale stochastic models (i.e., with more than 10<sup>5</sup> reactions). Two mixed approaches of fine- and coarse-grained acceleration are GPU-ODM [<xref rid="pcbi.1009410.ref023" ref-type="bibr">23</xref>], which is based on a variant of SSA called the Optimized Direct Method, and the SSA proposed by Sumiyoshi <italic toggle="yes">et al</italic>. [<xref rid="pcbi.1009410.ref024" ref-type="bibr">24</xref>]. Besides these GPU-powered tools, other solutions have been recently proposed, such as the Stochastic Simulation as a Service (StochSS) [<xref rid="pcbi.1009410.ref025" ref-type="bibr">25</xref>], and the Systems Biology Simulation Core Library (SBSCL) [<xref rid="pcbi.1009410.ref026" ref-type="bibr">26</xref>]. StochSS is an integrated development environment that can be used to model and simulate both deterministic and discrete stochastic biochemical systems in up to three dimensions. SBSCL provides interpreters and solvers for different Systems Biology formats, like the Systems Biology Markup Language (SBML) [<xref rid="pcbi.1009410.ref027" ref-type="bibr">27</xref>]. SBSCL allows the user to simulate several models by supporting the resolution of Ordinary Differential Equations (ODEs) and Stochastic Differential Equations.</p>
    <p>In this work, we introduce FiCoS (<bold>Fi</bold>ne- and <bold>Co</bold>arse-grained <bold>S</bold>imulator), an efficient deterministic simulator that, differently from the state-of-the-art approaches, was designed to fully exploit the parallelism provided by modern GPUs, by using a combined fine- and coarse-grained parallelization strategy. In particular, the fine-grained parallelization is applied to distribute the calculations required to solve each ODE over multiple GPU cores, while the coarse-grained parallelization is used to perform batches of independent simulations in parallel. To the best of our knowledge, FiCoS is the first deterministic simulator that takes advantage of both parallelization strategies, filling the gap in the state-of-the-art scenario of GPU-powered deterministic simulators (<xref rid="pcbi.1009410.g001" ref-type="fig">Fig 1</xref>).</p>
    <p>FiCoS improves the approach proposed in LASSIE [<xref rid="pcbi.1009410.ref021" ref-type="bibr">21</xref>] by leveraging more efficient integration methods, i.e., the Dormand–Prince (DOPRI) method [<xref rid="pcbi.1009410.ref028" ref-type="bibr">28</xref>–<xref rid="pcbi.1009410.ref030" ref-type="bibr">30</xref>] for stiffness-free systems, and the Radau IIA method [<xref rid="pcbi.1009410.ref031" ref-type="bibr">31</xref>, <xref rid="pcbi.1009410.ref032" ref-type="bibr">32</xref>] when the system of ODEs is stiff. A system is said to be stiff when two well-separated dynamical modes, determined by fast and slow reactions, occur: after a short transient the fast modes lead to stable trajectories, where only the slow modes drive the dynamics [<xref rid="pcbi.1009410.ref033" ref-type="bibr">33</xref>, <xref rid="pcbi.1009410.ref034" ref-type="bibr">34</xref>]. As a matter of fact, systems of ODEs describing biochemical networks are often affected by stiffness [<xref rid="pcbi.1009410.ref035" ref-type="bibr">35</xref>], an issue that generally requires the reduction of the step-size of explicit integration algorithms up to extremely small values, thus increasing the running time.</p>
    <p>The performance of FiCoS was assessed by means of a batch of tests involving up to 2048 parallel simulations of (<italic toggle="yes">i</italic>) synthetic RBMs of increasing size (up to hundreds of species and reactions); (<italic toggle="yes">ii</italic>) a model describing the autophagy/translation switch based on the mutual inhibition of MTORC1 and ULK1 [<xref rid="pcbi.1009410.ref036" ref-type="bibr">36</xref>], characterized by 173 molecular species and 6581 reactions; (<italic toggle="yes">iii</italic>) a model of human intracellular metabolic pathways consisting in 226 reactions involving 114 molecular species [<xref rid="pcbi.1009410.ref037" ref-type="bibr">37</xref>].</p>
    <p>The running time required by FiCoS to perform these analyses was compared to the CPU-based ODE solvers LSODA and Variable-Coefficient ODE (VODE) [<xref rid="pcbi.1009410.ref038" ref-type="bibr">38</xref>], which are exploited by several software for Systems Biology. For instance, libRoadRunner [<xref rid="pcbi.1009410.ref039" ref-type="bibr">39</xref>] uses CVODE [<xref rid="pcbi.1009410.ref040" ref-type="bibr">40</xref>] (a porting of VODE in the C programming language) and a standard fourth-order Runge–Kutta method; COPASI [<xref rid="pcbi.1009410.ref041" ref-type="bibr">41</xref>] performs deterministic simulations using LSODA and an implementation of the RADAU5 method (included only in the latest versions); VCell [<xref rid="pcbi.1009410.ref042" ref-type="bibr">42</xref>] exploits CVODE and other simpler integration algorithms. In this work, we measured the performance of FiCoS against vanilla ODE solvers, rather than considering a specific software, to achieve a fair comparison. By so doing, we can separately measure the time required by the integration methods and the time spent by the simulators for I/O operations. In particular, the CPU-based ODE solvers employed here are those implemented in the Python SciPy library, which provides wrappers to the solvers implemented in the ODEPACK, a collection of efficient Fortran solvers. Moreover, the performance of FiCoS was compared against those of the GPU-powered simulators cupSODA [<xref rid="pcbi.1009410.ref015" ref-type="bibr">15</xref>] and LASSIE [<xref rid="pcbi.1009410.ref021" ref-type="bibr">21</xref>], implemented using the Nvidia CUDA library [<xref rid="pcbi.1009410.ref043" ref-type="bibr">43</xref>].</p>
    <p>Our results show that FiCoS represents the best solution in the case of computational tasks involving either a high number of simulations or large-scale models, overcoming the performance of all state-of-the-art competitors.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>In this section, the computational performance of FiCoS is compared against state-of-the-art ODE solvers, that is, LSODA [<xref rid="pcbi.1009410.ref016" ref-type="bibr">16</xref>], VODE [<xref rid="pcbi.1009410.ref038" ref-type="bibr">38</xref>], cupSODA [<xref rid="pcbi.1009410.ref015" ref-type="bibr">15</xref>], and LASSIE [<xref rid="pcbi.1009410.ref021" ref-type="bibr">21</xref>]. LSODA [<xref rid="pcbi.1009410.ref016" ref-type="bibr">16</xref>] is based on two families of multi-step methods, namely, the Adams methods [<xref rid="pcbi.1009410.ref044" ref-type="bibr">44</xref>], which are explicit integration algorithms inefficient for solving stiff systems, and the Backward Differentiation Formulae (BDF) [<xref rid="pcbi.1009410.ref045" ref-type="bibr">45</xref>], which are implicit integration methods suitable to solve stiff systems. LSODA can efficiently solve stiff systems by switching among the most appropriate integration algorithm during the simulation. Conversely, despite being based on the same integration algorithms used by LSODA, VODE exploits, at the beginning of the simulation, a heuristic to decide the best algorithm that should be used to integrate the system of ODEs. LASSIE solves the systems of ODEs by automatically switching between the Runge-Kutta-Fehlberg method in the absence of stiffness, and the first order BDF in presence of stiffness. FiCoS exploits a heuristic to determine if the system is stiff and which integration method, between DOPRI and Radau IIA, is the most appropriate (see <xref rid="pcbi.1009410.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
    <p>We performed two batches of tests using synthetic RBMs of increasing size (i.e., number of species and number of reactions), generated as described in the Section “<xref rid="sec008" ref-type="sec">Materials and methods</xref>”. To provide some examples of real Systems Biology tasks, we also carried out an in-depth investigation of the RBMs describing the autophagy/translation switch based on mutual inhibition of MTORC1 and ULK1 [<xref rid="pcbi.1009410.ref036" ref-type="bibr">36</xref>], and a human intracellular metabolic pathway [<xref rid="pcbi.1009410.ref037" ref-type="bibr">37</xref>]. All tests were executed on a workstation equipped with an Intel Core i7–2600 CPU (clock 3.4 GHz) and 8 GB of RAM, running Ubuntu 16.04 LTS. The GPU used in the tests was an Nvidia GeForce GTX Titan X (3072 cores, clock 1.075 GHz, RAM 12 GB), CUDA toolkit version 8 (driver 387.26). All simulations were performed with the following settings: absolute error tolerance <italic toggle="yes">ε</italic><sub><italic toggle="yes">a</italic></sub> = 10<sup>−12</sup>, relative error tolerance <italic toggle="yes">ε</italic><sub><italic toggle="yes">r</italic></sub> = 10<sup>−6</sup>, and maximum number of allowed steps equal to 10<sup>4</sup> (these values are widely used in the literature, as well as by the main computational tools like COPASI [<xref rid="pcbi.1009410.ref041" ref-type="bibr">41</xref>]). In all tests, we leveraged the LSODA and VODE implementations provided by the SciPy scientific library (v.1.4.1) [<xref rid="pcbi.1009410.ref046" ref-type="bibr">46</xref>] along with the NumPy library (v.1.18.2) under Python (v.3.8.5). In all the simulations, we saved the dynamics of all species of the RBMs.</p>
    <sec id="sec003">
      <title>Synthetic models</title>
      <p>The computational analyses carried out on synthetic models aimed at determining what is the best simulator to employ under specific conditions, i.e., considering computational tasks with an increasing number of parallel simulations (up to 2048) and different RBM sizes (from tens to hundreds or even thousands of chemical species and reactions).</p>
      <p>The map in <xref rid="pcbi.1009410.g002" ref-type="fig">Fig 2</xref> shows the results obtained in the case of symmetric RBMs, i.e., having the same number of chemical species and reactions (<italic toggle="yes">N</italic> = <italic toggle="yes">M</italic>). When a single simulation is performed, the CPU-based solvers (i.e., LSODA and VODE) achieved the best performance in the case of RBMs smaller than <italic toggle="yes">N</italic> × <italic toggle="yes">M</italic> = 512 × 512, which is the break-even point between CPU- and GPU-based simulators. Indeed, when larger models are considered, FiCoS and LASSIE are the best choices, thanks to their parallelization strategies that offload the calculations onto the GPU. Considering the case of multiple independent simulations, our results indicate that cupSODA should be adopted with small-scale RBMs (i.e., less than 128 species and reactions) when the execution of a limited number of parallel simulations is required (i.e., less than 256). Under these circumstances, cupSODA can leverage the most performing GPU memories, that is, the constant and the shared memories, which provide a relevant reduction of memory access latencies. As shown by the green area in <xref rid="pcbi.1009410.g002" ref-type="fig">Fig 2</xref>, FiCoS outperforms all its competitors in all the other cases thanks to its fine- and coarse-grained parallelization strategy, which allows for simultaneously distributing both the parallel simulations required by the specific computational task and the ODE calculations on the available GPU cores.</p>
      <fig position="float" id="pcbi.1009410.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009410.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparison map for the symmetric RBMs.</title>
          <p>This map represents the best simulator in terms of running time required to simulate symmetric RBMs of size <italic toggle="yes">N</italic> × <italic toggle="yes">M</italic>, with <italic toggle="yes">N</italic> = <italic toggle="yes">M</italic>, where <italic toggle="yes">N</italic> is the number of species and <italic toggle="yes">M</italic> the number of reactions. The running time was analyzed increasing both the size of the RBMs and the number of simulations.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.g002" position="float"/>
      </fig>
      <p>It is worth noting that the performance of the simulators can drastically change when dealing with RBMs characterized by a different number of chemical species and reactions (i.e., asymmetric RBMs, where <italic toggle="yes">N</italic> ≠ <italic toggle="yes">M</italic>). As a matter of fact, since each ODE corresponds to a specific chemical species, the higher the number of species, the higher the parallelization that can be achieved by exploiting the fine-grained strategy. On the contrary, the number of reactions is roughly related to the length (in terms of mathematical complexity) of each ODE, thus increasing the number of operations that must be performed by each thread. In addition, since the clock frequency of the GPU cores is generally lower than that of the CPU, the time required to perform a single instruction on the GPU is higher. For this reason, the performance that can be achieved on the GPU decreases when the number of reactions <italic toggle="yes">M</italic> is larger than the number of species <italic toggle="yes">N</italic>. Figs <xref rid="pcbi.1009410.g003" ref-type="fig">3</xref> and <xref rid="pcbi.1009410.g004" ref-type="fig">4</xref> show the results of the tests performed on asymmetric RBMs with <italic toggle="yes">N</italic> &gt; <italic toggle="yes">M</italic> and <italic toggle="yes">M</italic> &gt; <italic toggle="yes">N</italic>, respectively. We first observe that the previous results are confirmed, as GPU-powered simulators most of the times overcome the CPU-based simulators. In particular, in the case of a single simulation of RBMs with <italic toggle="yes">N</italic> &gt; <italic toggle="yes">M</italic> (<xref rid="pcbi.1009410.g003" ref-type="fig">Fig 3</xref>), LSODA is efficient only for RBMs with a limited number of chemical species (<italic toggle="yes">N</italic> ≤ 128), while cupSODA and LASSIE represent the best option for large-scale RBMs. If the number of simulations is increased, either cupSODA or FiCoS should be employed: the former for small-scale RBMs, the latter in all other cases. Considering the case of RBMs with <italic toggle="yes">M</italic> &gt; <italic toggle="yes">N</italic> (<xref rid="pcbi.1009410.g004" ref-type="fig">Fig 4</xref>), the best options for the single simulation are LSODA for RBMs with size up to 213 × 640, and FiCoS otherwise. Also in this case, if the number of simulations is increased, cupSODA and FiCoS are the best solutions for small-scale and large-scale RBMs, respectively. These results confirm that the number of reactions affects the performance that can be achieved by using GPUs; as a matter of fact, cupSODA is the best solution only for RMBs with size 21 × 64, while FiCoS should be adopted in all other cases.</p>
      <fig position="float" id="pcbi.1009410.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009410.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Comparison map for the asymmetric RBMs with more species than reactions.</title>
          <p>This map represents the best simulator in terms of running time required to simulate asymmetric RBMs of size <italic toggle="yes">N</italic> × <italic toggle="yes">M</italic>, with <italic toggle="yes">N</italic> &gt; <italic toggle="yes">M</italic>, where <italic toggle="yes">N</italic> is the number of species and <italic toggle="yes">M</italic> the number of reactions. The running time was analyzed increasing both the size of the RBMs and the number of simulations.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.g003" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1009410.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009410.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Comparison map for the asymmetric RBMs with more reactions than species.</title>
          <p>This map represents best simulator in terms of running time required to simulate asymmetric RBMs of size <italic toggle="yes">N</italic> × <italic toggle="yes">M</italic>, with <italic toggle="yes">N</italic> &lt; <italic toggle="yes">M</italic>, where <italic toggle="yes">N</italic> is the number of species and <italic toggle="yes">M</italic> the number of reactions composing the models. The running time was analyzed increasing both the size of the RBMs and the number of simulations.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.g004" position="float"/>
      </fig>
      <p>Overall, our analyses prove the relevance of GPU-powered simulators, especially when high numbers of simulations must be performed or large-scale RBMs are used.</p>
    </sec>
    <sec id="sec004">
      <title>Autophagy/translation model</title>
      <p>In order to show the advantages provided by FiCoS in the investigation of models of real biological systems, we performed a bi-dimensional PSA (PSA-2D) on the mathematical model of the autophagy/translation switch based on the mutual inhibition of MTORC1 and ULK1 presented in [<xref rid="pcbi.1009410.ref036" ref-type="bibr">36</xref>]. These two proteins are part of a large regulatory network that is responsible of maintaining cellular energy and nutrients’ homeostasis. Autophagic processes are involved in cell survival during starvation and clearing of damaged cellular components, and thus their investigation is fundamental to understand aging-related and neurodegenerative diseases, as well as immunity and tumorigenesis.</p>
      <p>The PSA-2D presented hereafter was already performed in [<xref rid="pcbi.1009410.ref036" ref-type="bibr">36</xref>] to study the oscillations in the phosphorylation levels of AMBRA1, a protein responsible for the activation of autophagy, and EIF4EBP1, a repressor of translation. Such oscillations generate alternating periods of autophagy and translation inside the cell, in response to varying levels of phosphorylated AMPK (AMPK*), whose presence represents a stress condition for the cell, and of the parameter P<sub>9</sub>, which models the strength of the negative regulation of MTORC1 by AMPK*.</p>
      <p>The mathematical model of the autophagy/translation switch was defined using BioNetGen rule-based modeling language (BNGL) [<xref rid="pcbi.1009410.ref047" ref-type="bibr">47</xref>]. Rule-based modeling is a practical means to describe, in a concise way, the interactions between molecules while keeping track of site-specific details (e.g., the phosphorylation states). We simulated the rule-based model by deriving the corresponding network of reactions, written as a conventional RBM. In particular, the rule-based model is characterized by 7 initial molecule types, involved in 29 rules; the associated RBM contains 173 molecular species and 6581 reactions.</p>
      <p>The PSA-2D was performed by varying simultaneously the two parameters that affect the oscillatory behavior, that is, the initial amount of AMPK* and the value of the parameter P<sub>9</sub>, which modifies 5476 kinetic constants of the corresponding RBM. The initial values of both parameters were obtained by uniformly sampling within the sweep intervals proposed in the original paper [<xref rid="pcbi.1009410.ref036" ref-type="bibr">36</xref>], namely: [0, 10<sup>4</sup>] (molecules/cell) for the initial amount of AMPK*, and [10<sup>−9</sup>, 10<sup>−6</sup>] ((molecules/cell)<sup>−1</sup>s<sup>−1</sup>) for the value of P<sub>9</sub>. We performed a total of 36864 simulations with FiCoS, by running 72 batches of 512 simulations, a value that allowed us to maximize the performance of the simulator on the GPU, as evidenced by specific computational tests. FiCoS completed all simulations in approximately 24 hours; in the same time span, LSODA and VODE were capable of performing only 2090 and 1363 simulations, respectively.</p>
      <p><xref rid="pcbi.1009410.g005" ref-type="fig">Fig 5</xref> shows the average amplitude of EIF4EBP and AMBRA oscillations obtained from the PSA-2D using FiCoS (<xref rid="pcbi.1009410.g005" ref-type="fig">Fig 5A and 5D</xref>), LSODA (<xref rid="pcbi.1009410.g005" ref-type="fig">Fig 5B and 5E</xref>), and VODE (<xref rid="pcbi.1009410.g005" ref-type="fig">Fig 5C and 5F</xref>). Amplitude values equal to zero (black points) denote a non-oscillating dynamics of the molecular species. As it can be observed in the figure, although some information about the behavior of the system can be extrapolated by the results achieved with LSODA and VODE, FiCoS is the only simulation strategy that can provide biologists with extremely detailed analyses of complex cellular models in a limited time span.</p>
      <fig position="float" id="pcbi.1009410.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009410.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Results of the PSA-2D performed on the autophagy/translation model.</title>
          <p>This PSA-2D was realized by varying the initial concentration of AMPK* and the value of the parameter P<sub>9</sub>, which modifies 5476 kinetic parameters. The plots show the average oscillations amplitude of the species EIF4EBP and AMBRA. (A) Oscillations amplitude of EIF4EBP obtained by FiCoS. (B) Oscillations amplitude of EIF4EBP obtained by LSODA. (C) Oscillations amplitude of EIF4EBP obtained by VODE. (D) Oscillations amplitude of AMBRA obtained by FiCoS. (E) Oscillations amplitude of AMBRA obtained by LSODA. (F) Oscillations amplitude of AMBRA obtained by VODE. Considering a time budget of 24 hours, FiCoS was capable of performing 36864 simulations, while LSODA and VODE performed 2090 and 1363 simulations, respectively.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.g005" position="float"/>
      </fig>
      <p>It is worth noting that we compared FiCoS only against LSODA and VODE for the following motivations: (<italic toggle="yes">i</italic>) LSODA and VODE are the most used simulators; (<italic toggle="yes">ii</italic>) the tests on the asymmetric synthetic RBMs with more reactions than species showed that the performance of LASSIE is much lower than FiCoS (see <xref rid="pcbi.1009410.s001" ref-type="supplementary-material">S1 Text</xref>); (<italic toggle="yes">iii</italic>) cupSODA is not suitable for the simulation of large-scale RBMs, as its memory requirements prevent the execution of this kind of tasks.</p>
    </sec>
    <sec id="sec005">
      <title>Human intracellular metabolic pathway</title>
      <p>As a further example of Systems Biology tasks that can be efficiently tackled with FiCoS, we performed an SA and a PE of an RBM of the human intracellular metabolic pathway in red blood cells, presented in [<xref rid="pcbi.1009410.ref048" ref-type="bibr">48</xref>]. The basic version of this model is composed of 94 reactions involving 92 chemical species, which describe the central pathways of the carbohydrate metabolism (i.e., glycolysis and pentose phosphate pathways). Here, we consider the modified model version presented in [<xref rid="pcbi.1009410.ref037" ref-type="bibr">37</xref>], in which the uptake of extracellular substrates is not considered, while the isoforms of the hexokinase (HK) enzyme, fundamental to convert the glucose into glucose-6-phosphate, are explicitly taken into account. The resulting RBM is characterized by 226 reactions among 114 chemical species.</p>
      <p>Metabolic networks can be considered as complex systems, characterized by hundreds of reactions and chemical species, where intra- and extra-cellular processes are involved [<xref rid="pcbi.1009410.ref049" ref-type="bibr">49</xref>, <xref rid="pcbi.1009410.ref050" ref-type="bibr">50</xref>]. In these networks, several sources of indetermination can hamper the outcome of the analyses, especially when different uncharacterized enzyme isoform mixtures exist [<xref rid="pcbi.1009410.ref051" ref-type="bibr">51</xref>]. Enzyme isoforms (i.e., isozymes) can be seen as non-identical, albeit structurally similar, protein complexes that are able to catalyze the same biochemical reactions. However, the structural differences of these isoforms lead to different kinetic behaviors of the catalytic processes [<xref rid="pcbi.1009410.ref052" ref-type="bibr">52</xref>, <xref rid="pcbi.1009410.ref053" ref-type="bibr">53</xref>].</p>
      <p>The SA was performed in order to evaluate the effects of an isoform-specific modification on the system outcome, by varying the initial concentration of the HK isoform with the highest abundance. In a real scenario, the modification of an isoform can be obtained with a tailored gene knock-down experiment, by means of a drug with an isoform-specific target, or with a change in the isozyme expression by exposing the cells to an environmental stimulus [<xref rid="pcbi.1009410.ref050" ref-type="bibr">50</xref>]. Here, we modified both the initial concentration of this HK isoform, as well as that of all the intermediate chemical complexes produced by this HK isoform. We sampled the initial concentration of these 11 species in the range [0, 10<sup>−5</sup>] (mM).</p>
      <p>We exploited the Sobol method for SA [<xref rid="pcbi.1009410.ref054" ref-type="bibr">54</xref>, <xref rid="pcbi.1009410.ref055" ref-type="bibr">55</xref>], which is a variance-based SA where the variance of the model output is decomposed into fractions that can be attributed to the inputs, across the whole input space, and it is also capable of dealing with nonlinear responses. We applied the Saltelli sampling scheme [<xref rid="pcbi.1009410.ref056" ref-type="bibr">56</xref>], an extension of the Sobol sequence that aims at reducing the error rates in the resulting sensitivity index calculations. To calculate the first- and the second-order sensitivities, we considered 12288 distinct initial conditions obtained by sampling 512 points for each of the 11 species involved in the SA. We simulated the dynamics of the ribose 5-phosphate (R5P) metabolite, which is involved in the pentose phosphate pathway, in a 10-hour time window; then, we calculated the difference between the final concentration value achieved and the reference value (obtained by running a simulation with the initial conditions listed in [<xref rid="pcbi.1009410.ref037" ref-type="bibr">37</xref>]). These values were finally used to compute the SA outcome, reported in <xref rid="pcbi.1009410.t001" ref-type="table">Table 1</xref>, which lists the first- and total-order sensitivity indices, together with the corresponding confidence intervals, considering a confidence level of 95%. These results clearly show that the modification of the initial concentrations of the species hkEGLCGSH<sub>2</sub>, hkEGLCDPG23<sub>2</sub>, hkEPhosi<sub>2</sub>, and hkEGLCG6P<sub>2</sub> have the largest impact on the dynamics of the R5P metabolite.</p>
      <table-wrap position="float" id="pcbi.1009410.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009410.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>First- and total-order indices along with the corresponding confidence intervals (confidence level of 95%) of the Sobol SA, calculated on the R5P metabolite outputs.</title>
        </caption>
        <alternatives>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.t001" id="pcbi.1009410.t001g" position="float"/>
          <table frame="hsides" rules="groups" cellspacing="0" style="border-collapse:collapse">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">Species</th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">S<sub>1</sub></th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1009410.e001">
                    <alternatives>
                      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e001" id="pcbi.1009410.e001g" position="anchor"/>
                      <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="inline" overflow="scroll">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mtext>S</mml:mtext>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mn>1</mml:mn>
                                <mml:mrow>
                                  <mml:mtext>conf</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">ST</th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">ST<sub>conf</sub></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkE<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">−0.005</td>
                <td align="char" char="." rowspan="1" colspan="1">0.046</td>
                <td align="char" char="." rowspan="1" colspan="1">0.138</td>
                <td align="char" char="." rowspan="1" colspan="1">0.020</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEMgATP<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.016</td>
                <td align="char" char="." rowspan="1" colspan="1">0.052</td>
                <td align="char" char="." rowspan="1" colspan="1">0.139</td>
                <td align="char" char="." rowspan="1" colspan="1">0.019</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEMgATPGLC<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.008</td>
                <td align="char" char="." rowspan="1" colspan="1">0.053</td>
                <td align="char" char="." rowspan="1" colspan="1">0.139</td>
                <td align="char" char="." rowspan="1" colspan="1">0.019</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEGLC<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.041</td>
                <td align="char" char="." rowspan="1" colspan="1">0.051</td>
                <td align="char" char="." rowspan="1" colspan="1">0.148</td>
                <td align="char" char="." rowspan="1" colspan="1">0.025</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEMgADPG6P<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.031</td>
                <td align="char" char="." rowspan="1" colspan="1">0.046</td>
                <td align="char" char="." rowspan="1" colspan="1">0.145</td>
                <td align="char" char="." rowspan="1" colspan="1">0.023</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEG6P<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">−0.010</td>
                <td align="char" char="." rowspan="1" colspan="1">0.050</td>
                <td align="char" char="." rowspan="1" colspan="1">0.153</td>
                <td align="char" char="." rowspan="1" colspan="1">0.026</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEMgADP<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.029</td>
                <td align="char" char="." rowspan="1" colspan="1">0.044</td>
                <td align="char" char="." rowspan="1" colspan="1">0.112</td>
                <td align="char" char="." rowspan="1" colspan="1">0.022</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEGLCGSH<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.199</td>
                <td align="char" char="." rowspan="1" colspan="1">0.078</td>
                <td align="char" char="." rowspan="1" colspan="1">0.487</td>
                <td align="char" char="." rowspan="1" colspan="1">0.084</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEGLCDPG23<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.240</td>
                <td align="char" char="." rowspan="1" colspan="1">0.079</td>
                <td align="char" char="." rowspan="1" colspan="1">0.462</td>
                <td align="char" char="." rowspan="1" colspan="1">0.075</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hkEPhosi<sub>2</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.233</td>
                <td align="char" char="." rowspan="1" colspan="1">0.085</td>
                <td align="char" char="." rowspan="1" colspan="1">0.509</td>
                <td align="char" char="." rowspan="1" colspan="1">0.086</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">hkEGLCG6P<sub>2</sub></td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.212</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.081</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.482</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.090</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Concerning the running times, FiCoS was able to perform the 12288 simulations—divided into 24 batches of 512 simulations (i.e., the value that maximizes the performance of FiCoS)—in approximately 8 minutes, while LSODA only completed 103 simulations in the same time span. Thus, FiCoS was ∼119× faster than LSODA.</p>
      <p>As shown in the extended version of this model of the human intracellular metabolic pathway [<xref rid="pcbi.1009410.ref037" ref-type="bibr">37</xref>], the values of 78 out of 226 kinetic constants are unknown and need to be estimated to perform a correct simulation of the dynamics. We thus performed a PE of these 78 unknown values, following the approach described in [<xref rid="pcbi.1009410.ref037" ref-type="bibr">37</xref>]. In particular, we compared the running times of the PE executed with the Fuzzy Self-Tuning PSO (FST-PSO) algorithm [<xref rid="pcbi.1009410.ref057" ref-type="bibr">57</xref>], a setting-free version of Particle Swarm Optimization [<xref rid="pcbi.1009410.ref058" ref-type="bibr">58</xref>] that was first coupled with FiCoS and then with LSODA. It is worth noting that in this PE approach, each particle of the FST-PSO encodes a putative model parameterization, whose quality is evaluated by means of a fitness function that computes the relative distance between the target dynamics and the simulated dynamics obtained using that putative parameterization [<xref rid="pcbi.1009410.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1009410.ref059" ref-type="bibr">59</xref>]. FiCoS allowed for efficiently running the simulations required in the PE to assess the quality of the solutions encoded in the particles of FST-PSO; indeed, FiCoS was able to execute the PE ∼30× faster than LSODA, showing again the high relevance of GPU-powered simulators for the execution of these computationally demanding tasks in practical applications.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec006">
    <title>Discussion</title>
    <p>The emerging field of General Purpose Computing on Graphics Processing Units (GPGPU computing)—in which CPUs and GPUs are combined to address the increasing demand of parallel and throughput-intensive algorithms—had a relevant impact to many fields in both science and engineering [<xref rid="pcbi.1009410.ref060" ref-type="bibr">60</xref>]. Specifically, GPGPU computing enabled the development of novel software tools that have been successfully applied to tackle the huge computational efforts required by several disciplines related to life sciences [<xref rid="pcbi.1009410.ref008" ref-type="bibr">8</xref>]. The accelerated biochemical simulation method proposed here, named FiCoS, represents the first open-source deterministic simulator that takes advantage of both fine- and coarse-grained strategies to distribute the massive amount of calculations required by multiple simulations of large-scale RBMs. FiCoS can be effectively applied to tackle the demanding tasks that are generally required in Computational Systems Biology, as in the case of the PSA, SA, and PE presented in this work. The source-code of FiCoS is freely available on GitLab: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.com/andrea-tango/ficos" ext-link-type="uri">https://gitlab.com/andrea-tango/ficos</ext-link> under the BSD 3-Clause License. This repository also contains a description of all input parameters of FiCoS, as well as all the scripts used to perform the computational analyses presented in this work and Jupyter Notebooks with detailed information to run PSA-2D, SA, and PE with FiCoS.</p>
    <p>In terms of performance, FiCoS is capable of solving systems of non-stiff and stiff ODEs with similar and often higher precision and accuracy than other well-known ODE solvers (see Section “Simulation accuracy of FiCoS” in the <xref rid="pcbi.1009410.s001" ref-type="supplementary-material">S1 Text</xref>), but with a dramatic reduction of the execution time. In our tests, FiCoS resulted faster than CPU-based integration methods like LSODA and VODE when multiple simulations need to be executed. Moreover, in many cases FiCoS shown to be faster than LASSIE, which was designed to exploit the fine-grained strategy to distribute the calculations required by a single simulation of large-scale RBMs. As shown in <xref rid="pcbi.1009410.s001" ref-type="supplementary-material">S1 Text</xref> (Section “Computational performance”), FiCoS achieves relevant speed-ups, resulting up to 487× faster than VODE in terms of simulation time and up to 855× considering only the integration time; up to 366× faster than LSODA for the simulation time and up to 79× faster for the integration time only. Considering the comparison with the other GPU-based simulators, FiCoS is 298× faster than LASSIE in terms of simulation time and 760× faster for the integration time only, thanks to the double level of parallelism and the more efficient integration methods employed. FiCoS was also capable of outperforming cupSODA, the GPU implementation of LSODA that exploits a coarse-grained parallelization strategy, resulting 7× faster in terms of simulation time and 17× considering only the integration time. To clarify, the integration time indicates the running time spent by a numerical integration algorithm to solve the system of ODEs, while the simulation time is the overall running time required to perform a simulation, including the I/O operations (i.e., reading and writing operations).</p>
    <p>The analyses presented in this paper allowed us to also identify the limitations of FiCoS. First, since FiCoS was specifically designed to simulate large-scale RBMs, the intra-GPU communication overhead—caused by the fine-grain kernels—affects its performance in the case of small size models. Moreover, as expected, when only a few parallel simulations are required, other CPU- or GPU-based simulators might be preferred. Second, the performance of FiCoS related to the coarse-grained strategy can be affected by the saturation of the computing resources due to an “excessive” parallelization. This phenomenon is caused by the computing resources required by the kernels realizing the fine-grained strategy—exploited to parallelize the resolution of the system of ODEs—which increase along with the RBM size. As a matter of fact, the blocks of threads generated using the Dynamic Parallelism (DP) [<xref rid="pcbi.1009410.ref043" ref-type="bibr">43</xref>, <xref rid="pcbi.1009410.ref061" ref-type="bibr">61</xref>] (see <xref rid="pcbi.1009410.s001" ref-type="supplementary-material">S1 Text</xref> for details) easily saturate the GPU resources and reduce the speed-up. As shown in [<xref rid="pcbi.1009410.ref062" ref-type="bibr">62</xref>], the launching time of child kernels slightly increases after 512 kernels, and dramatically increases around 2000 kernels. Note that the parent grid is launched by the host, while a child grid (composed of child blocks, threads, and kernels) can be launched from each parent thread, resulting in the parallel execution of several child kernels. In addition, the register usage raises along with the number of threads running in parallel, decreasing the performance if the execution requires the access to the global memory, which has high latencies. According to our tests, the performance of FiCoS decreases when more than 2048 parallel simulations of large-scale RBMs are executed.</p>
  </sec>
  <sec sec-type="conclusions" id="sec007">
    <title>Conclusion</title>
    <p>In this work we proposed FiCoS, a GPU-powered deterministic simulator, designed to deal with the computational demanding tasks generally required in the field of Computational and Systems Biology. FiCoS is capable of simulating large-scale RBMs based on mass-action kinetics relying on fine- and coarse-grained parallelization strategies.</p>
    <p>FiCoS was designed to be a “black-box” simulator able to automatically convert RBMs, representing complex biochemical networks, into the corresponding systems of ODEs. These systems are solved by exploiting two Runge-Kutta methods, that is, the DOPRI method [<xref rid="pcbi.1009410.ref028" ref-type="bibr">28</xref>–<xref rid="pcbi.1009410.ref030" ref-type="bibr">30</xref>] in the absence of stiffness and the Radau IIA method [<xref rid="pcbi.1009410.ref031" ref-type="bibr">31</xref>, <xref rid="pcbi.1009410.ref032" ref-type="bibr">32</xref>] when the system is stiff. This mixed parallelization strategy that takes advantage of the DP provided by modern GPUs allows for exploiting the massive parallel capabilities of GPUs, which are essential to obtain a relevant reduction of the computation time.</p>
    <p>The performance of FiCoS was evaluated considering two sets of synthetic RBMs of increasing size (up to 800 molecular species and reactions), a real model of the autophagy/translation switch, based on the mutual inhibition of MTORC1 and ULK1, characterized by 173 molecular species and 6581 reactions, and a human intracellular metabolic pathway, composed of 226 reactions and 114 molecular species. We performed an in-depth analysis to determine the best simulator that should be employed considering both the size of the RBM and the number of simulations required. In particular, we compared the performance of FiCoS against two CPU-based simulators (LSODA and VODE), a fine-grained GPU-powered simulator designed to simulate large-scale models (LASSIE), and a coarse-grained GPU-powered simulator developed to run high numbers of simulations in a parallel fashion (cupSODA). Exploiting both the fine- and the coarse-grained parallelization strategies, FiCoS resulted the natural choice when multiple simulations are required, and when the number of species in the RBM is greater than 64, noticeably outperforming all the other simulators. We also performed a bi-dimensional PSA of a model of the autophagy/translation switch based on the mutual inhibition of MTORC1 and ULK1 [<xref rid="pcbi.1009410.ref036" ref-type="bibr">36</xref>], showing that FiCoS was able to execute 36864 simulations in 24 hours, while LSODA and VODE completed only 2090 and 1363 simulations in the same time span, respectively. Moreover, we performed an SA of a human intracellular metabolic pathway with different enzyme isoforms, requiring the execution of 12288 simulations. FiCoS completed this task in approximately 8 minutes, while LSODA was able to perform only 103 simulations in the same time span. Finally, we coupled FST-PSO [<xref rid="pcbi.1009410.ref057" ref-type="bibr">57</xref>] with both FiCoS and LSODA to run a PE of the RBM of a human intracellular metabolic pathway. Our analysis showed that FiCoS allows for performing this task ∼30× faster than LSODA.</p>
    <p>Although FiCoS showed excellent performance, we did not fully exploit the CUDA memory hierarchy that should be used as much as possible to obtain the best performance. Since both explicit and implicit integration algorithms are intrinsically sequential, FiCoS kernels generally do not reuse any variable, so that the (fast) shared memory of the GPU cannot be leveraged. Moreover, the DP does not currently allow for sharing variables among the threads belonging to the parent grid and those inside the child grids. For these reasons, the current version of FiCoS relies on the global memory (characterized by high latencies) and registers. We plan to develop an improved version of FiCoS tailored for RBMs characterized by a few number of species, leveraging both constant and shared memories, where the former can be used to store the kinetic constants and the structures used to correctly decode the ODEs, while the latter can be exploited to save the states of the system.</p>
    <p>Another limitation of FiCoS regards its capability of dealing with RBMs including reactions following kinetics different than mass-action. This limitation arises from the way ODEs are encoded by FiCoS and are parsed by the CUDA kernels. We are therefore planning to develop an improved version of this encoding able to represent Hill and Michaelis-Menten kinetics [<xref rid="pcbi.1009410.ref063" ref-type="bibr">63</xref>, <xref rid="pcbi.1009410.ref064" ref-type="bibr">64</xref>], in addition to mass-action kinetics. However, we expect that the new parser will slightly affect the performance of FiCoS, mainly because of an increased level of conditional branching and higher latencies due to additional global memory accesses. We are also evaluating the possibility of defining a general-purpose version of FiCoS, capable of simulating models where the reactions follow any arbitrary kinetics. In this case, the main issue would concern the complexity of encoding arbitrary equations and the resulting difficulty of calculating partial derivatives for the Jacobian matrix. A possible solution would be meta-programming, following a strategy similar to ginSODA [<xref rid="pcbi.1009410.ref065" ref-type="bibr">65</xref>], in which the kernels are partially rebuilt and dynamically linked at run-time. However, such an approach is unfeasible for fine-grained parallelization, thus it should be adapted to be applied in FiCoS.</p>
    <p>As a final remark, since several existing tools, such as libRoadRunner, COPASI, and VCell exploit the SBML format [<xref rid="pcbi.1009410.ref027" ref-type="bibr">27</xref>] to encode RBMs, while FiCoS, LASSIE, and cupSODA rely on the BioSimWare format [<xref rid="pcbi.1009410.ref066" ref-type="bibr">66</xref>], we provided in the GitLab repository a simple conversion tool to translate an SBML model into the corresponding BioSimWare model. We are currently working on an improved version of this conversion tool, capable of translating BioSimWare files to SBML files, taking into account all model parameterizations; as a matter of fact, the BioSimWare format allows for easily specifying multiple parameter sets and initial conditions that might be tested in practical applications.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec008">
    <title>Materials and methods</title>
    <sec id="sec009">
      <title>RBMs and ODE generation</title>
      <p>RBMs are defined following a mechanistic, quantitative, and parametric formalism created to describe and simulate networks of biochemical reactions [<xref rid="pcbi.1009410.ref002" ref-type="bibr">2</xref>]. An RBM can be defined by specifying the set <inline-formula id="pcbi.1009410.e002"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e002.jpg" id="pcbi.1009410.e002g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of <italic toggle="yes">N</italic> molecular species and the set <inline-formula id="pcbi.1009410.e003"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e003.jpg" id="pcbi.1009410.e003g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of <italic toggle="yes">M</italic> biochemical reactions that describe the interactions among the species in <inline-formula id="pcbi.1009410.e004"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e004.jpg" id="pcbi.1009410.e004g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="inline" overflow="scroll"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula>. A generic reaction <italic toggle="yes">R</italic><sub><italic toggle="yes">i</italic></sub>, with <italic toggle="yes">i</italic> = 1, …, <italic toggle="yes">M</italic>, is defined as follows:
<disp-formula id="pcbi.1009410.e005"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e005.jpg" id="pcbi.1009410.e005g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mover><mml:mo>→</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">a</italic><sub><italic toggle="yes">ij</italic></sub>, <inline-formula id="pcbi.1009410.e006"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e006.jpg" id="pcbi.1009410.e006g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> are the so-called stoichiometric coefficients and <inline-formula id="pcbi.1009410.e007"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e007.jpg" id="pcbi.1009410.e007g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the kinetic constant associated with <italic toggle="yes">R</italic><sub><italic toggle="yes">i</italic></sub>. Note that <inline-formula id="pcbi.1009410.e008"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e008.jpg" id="pcbi.1009410.e008g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula> can be also written in a compact matrix-vector form: <inline-formula id="pcbi.1009410.e009"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e009.jpg" id="pcbi.1009410.e009g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">S</mml:mi><mml:mover><mml:mo>→</mml:mo><mml:mi mathvariant="bold">K</mml:mi></mml:mover><mml:mi mathvariant="bold">B</mml:mi><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1009410.e010"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e010.jpg" id="pcbi.1009410.e010g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represents the <italic toggle="yes">N</italic>-dimensional column vector of molecular species, <inline-formula id="pcbi.1009410.e011"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e011.jpg" id="pcbi.1009410.e011g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> the <italic toggle="yes">M</italic>-dimensional column vector of kinetic constants, and <inline-formula id="pcbi.1009410.e012"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e012.jpg" id="pcbi.1009410.e012g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="bold">N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> the so-called stoichiometric matrices whose (non-negative) elements [<italic toggle="yes">A</italic>]<sub><italic toggle="yes">i</italic>,<italic toggle="yes">j</italic></sub> and [<italic toggle="yes">B</italic>]<sub><italic toggle="yes">i</italic>,<italic toggle="yes">j</italic></sub> are the stoichiometric coefficients <italic toggle="yes">a</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">b</italic><sub><italic toggle="yes">ij</italic></sub> of the reactants and the products of all reactions, respectively. Given an arbitrary RBM and assuming the law of mass-action [<xref rid="pcbi.1009410.ref067" ref-type="bibr">67</xref>, <xref rid="pcbi.1009410.ref068" ref-type="bibr">68</xref>], the system of coupled ODEs describing the variation in time of the species concentrations can be derived as follows:
<disp-formula id="pcbi.1009410.e013"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e013.jpg" id="pcbi.1009410.e013g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold">K</mml:mi><mml:mo>∘</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">A</mml:mi></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <bold>X</bold> is the <italic toggle="yes">N</italic>-dimensional vector of concentration values (representing the state of the system) at time <italic toggle="yes">t</italic>, the symbol ∘ denotes the entry-by-entry matrix multiplication (Hadamard product), and <inline-formula id="pcbi.1009410.e014"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e014.jpg" id="pcbi.1009410.e014g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">A</mml:mi></mml:msup></mml:math></alternatives></inline-formula> denotes the vector-matrix exponentiation form [<xref rid="pcbi.1009410.ref067" ref-type="bibr">67</xref>]. Note that each species <italic toggle="yes">S</italic><sub><italic toggle="yes">j</italic></sub> at time <italic toggle="yes">t</italic> is characterized by its concentration <italic toggle="yes">X</italic><sub><italic toggle="yes">j</italic></sub>, where <italic toggle="yes">X</italic><sub><italic toggle="yes">j</italic></sub> ∈ <bold>R</bold><sup>≥0</sup> for <italic toggle="yes">j</italic> = 1, …, <italic toggle="yes">N</italic>. Formally, <bold>X</bold><sup><bold>A</bold></sup> is a <italic toggle="yes">M</italic>-dimensional vector whose <italic toggle="yes">i</italic>-th component is equal to <inline-formula id="pcbi.1009410.e016"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e016.jpg" id="pcbi.1009410.e016g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, for <italic toggle="yes">i</italic> = 1, …, <italic toggle="yes">M</italic>. Note that, since we assume the law of mass-action, each ODE composing the system described in <xref rid="pcbi.1009410.e013" ref-type="disp-formula">Eq 2</xref> is a polynomial function with at least one monomial associated with a specific kinetic constant.</p>
    </sec>
    <sec id="sec010">
      <title>Synthetic RBM generation</title>
      <p>In order to investigate the computational performance of FiCoS, both the sets of symmetric and asymmetric RBMs of increasing size were randomly generated by exploiting a custom tool developed by our group, named SBGen [<xref rid="pcbi.1009410.ref069" ref-type="bibr">69</xref>], which allows for creating realistic RBMs whose dynamics resemble those of real biological networks. The synthetic RBMs satisfy the following characteristics:</p>
      <list list-type="bullet">
        <list-item>
          <p>a log-uniform distribution in the interval [10<sup>−4</sup>, 1) was applied to sample the initial concentrations of the molecular species;</p>
        </list-item>
        <list-item>
          <p>a log-uniform distribution in the interval [10<sup>−6</sup>, 10] was used to sample the values of the kinetic constants;</p>
        </list-item>
        <list-item>
          <p>the stoichiometric matrix <bold>A</bold> was generated allowing only zero, first, and second-order reactions (i.e., at most two reactant molecules of the same or different species can appear in each reaction). The rationale is that the probability of a reaction simultaneously involving more than two reactants is almost equal to zero. Anyhow, FiCoS can simulate RBMs with reactions of higher-orders;</p>
        </list-item>
        <list-item>
          <p>the stoichiometric matrix <bold>B</bold> is created allowing at most two product molecules for each reaction.</p>
        </list-item>
      </list>
      <p>It is therefore clear that the matrices <bold>A</bold> and <bold>B</bold> are sparse. A log-uniform distribution (i.e., a uniform distribution in the logarithmic space) was used to sample both the initial conditions and the kinetic constants to capture the typical dispersion of both the concentrations and kinetic parameters, which span over multiple orders of magnitude [<xref rid="pcbi.1009410.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1009410.ref070" ref-type="bibr">70</xref>].</p>
      <p>For each model, the initial value of the kinetic parameters was perturbed to generate different parameterizations (up to 2048). For each kinetic parameter <italic toggle="yes">k</italic><sub><italic toggle="yes">i</italic></sub>, with <italic toggle="yes">i</italic> = 1, …, <italic toggle="yes">M</italic>, we applied the following perturbation:
<disp-formula id="pcbi.1009410.e015"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.e015.jpg" id="pcbi.1009410.e015g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mtext>rnd</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where rnd ∼ Uniform(0, 1) is a random number sampled from the uniform distribution in [0, 1).</p>
    </sec>
    <sec id="sec011">
      <title>Implementation of FiCoS</title>
      <p>In order to efficiently deal with both stiff and non-stiff systems of ODEs, FiCoS relies on two advanced integration methods belonging to the Runge-Kutta families: (<italic toggle="yes">i</italic>) the DOPRI explicit method [<xref rid="pcbi.1009410.ref028" ref-type="bibr">28</xref>–<xref rid="pcbi.1009410.ref030" ref-type="bibr">30</xref>] for solving non-stiff systems; (<italic toggle="yes">ii</italic>) the Radau IIA implicit method [<xref rid="pcbi.1009410.ref031" ref-type="bibr">31</xref>, <xref rid="pcbi.1009410.ref032" ref-type="bibr">32</xref>] when the system under investigation is characterized by stiffness. In particular, we exploited DOPRI5 and RADAU5 methods, which are both Runge-Kutta methods of order 5. We also point out that our implementation was inspired by Blake Ashby’s source code, who ported to C++ the original Fortran code developed by Hairer and Wanner [<xref rid="pcbi.1009410.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1009410.ref031" ref-type="bibr">31</xref>].</p>
      <p>DOPRI is one of the most widespread explicit Runge-Kutta method, since it is a variable step-size algorithm and implements a stiffness detection approach [<xref rid="pcbi.1009410.ref030" ref-type="bibr">30</xref>]. Implicit Runge-Kutta methods are single-step approaches characterized by both a higher order of accuracy and more favorable numerical stability properties with respect to BDF algorithms [<xref rid="pcbi.1009410.ref071" ref-type="bibr">71</xref>]. Among the existing implicit Runge-Kutta methods, the Radau IIA family was proved to hold several useful properties: it is strongly <italic toggle="yes">A</italic>-stable and strongly <italic toggle="yes">S</italic>-stable, implying that it is both <italic toggle="yes">A</italic>-stable and <italic toggle="yes">S</italic>-stable, as well as stiffly accurate [<xref rid="pcbi.1009410.ref072" ref-type="bibr">72</xref>]. One of the main advantages of the <italic toggle="yes">S</italic>-stable methods is their ability to produce stable computations when solving highly stiff problems. In addition, when a fixed step-size is used, strongly <italic toggle="yes">S</italic>-stable methods are more accurate than the other methods. Several numerical tests showed that only <italic toggle="yes">S</italic>-stable methods can produce accurate simulations by using significantly large step-size for stiff problems [<xref rid="pcbi.1009410.ref073" ref-type="bibr">73</xref>]. Finally, RADAU5 is capable of arranging the step-size along with the desired error—controlled by means of <italic toggle="yes">ε</italic><sub><italic toggle="yes">a</italic></sub> and <italic toggle="yes">ε</italic><sub><italic toggle="yes">r</italic></sub> tolerances, which are user-defined parameters—and the detected level of stiffness.</p>
      <p>We exploited a coarse-grained strategy to perform a large number of simulations in a parallel fashion, by distributing the simulations over the available GPU cores. Moreover, in order to accelerate the ODE resolutions of each simulation, we exploited a fine-grained strategy using the DP to distribute the integration algorithms on the GPU cores. When DP is used, each thread belonging to the grid called by the host (named parent grid) can launch a novel grid (named child grid) composed of several threads. All child grids that are executed by the thread of the parent grid can be synchronized, so that the parent threads can consume the output produced by the child threads without involving the CPU. Specifically, we leveraged the DP to distribute the calculations related to the Butcher tableau (see Section “GPU implementation” in the <xref rid="pcbi.1009410.s001" ref-type="supplementary-material">S1 Text</xref>, for additional details) characterizing our integration methods. As a side note, FiCoS also exploits the cuBLAS library [<xref rid="pcbi.1009410.ref074" ref-type="bibr">74</xref>] for both the matrix decompositions and the linear system resolutions required by RADAU5.</p>
      <p>Overall, FiCoS workflow consists in 5 different phases and 26 CUDA kernels, which can be summarized as follows:</p>
      <list list-type="bullet">
        <list-item>
          <p><bold>Phase P</bold><sub><bold>1</bold></sub>: it implements the generation of the data structures encoding the system of ODEs. These data structures are used to evaluate the ODEs during the resolution of the system.</p>
        </list-item>
        <list-item>
          <p><bold>Phase P</bold><sub><bold>2</bold></sub>: for each simulation, the estimation of the dominant eigenvalue of the Jacobian matrix <bold>J</bold> is performed. Every simulation characterized by a dominant eigenvalue lower than 500 will be solved exploiting the DOPRI5 method. The other simulations will be tackled by means of the RADAU5 method. As a matter of fact, when <bold>J</bold> has a large spectral radius, the system of ODEs can be considered stiff [<xref rid="pcbi.1009410.ref035" ref-type="bibr">35</xref>].</p>
        </list-item>
        <list-item>
          <p><bold>Phase P</bold><sub><bold>3</bold></sub>: it implements the DOPRI5 method. Note that if the DOPRI5 fails at solving some simulations, they are re-executed and solved relying on the RADAU5 method. It is worth noting that each thread, associated with a specific simulation, exploits the DP to call the kernels, developed to distribute the calculations required by DOPRI5, launching a novel grid of threads.</p>
        </list-item>
        <list-item>
          <p><bold>Phase P</bold><sub><bold>4</bold></sub>: it implements the RADAU5 method. As in the case of the DOPRI5 method, each thread takes advantage of the DP to run the kernels.</p>
        </list-item>
        <list-item>
          <p><bold>Phase P</bold><sub><bold>5</bold></sub>: for each simulation, the dynamics of the species are stored and written in the output files.</p>
        </list-item>
      </list>
      <p>Notice that only phases <italic toggle="yes">P</italic><sub>1</sub> and <italic toggle="yes">P</italic><sub>5</sub> are executed on the CPU, while the others are entirely executed on the GPU.</p>
    </sec>
  </sec>
  <sec id="sec012" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009410.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>It describes the design and implementation of FiCoS.</title>
        <p>In addition, it shows the achieved results in more details.</p>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009410.s002" position="float" content-type="local-data">
      <label>S2 Text</label>
      <caption>
        <title>It explains the files required by FiCoS to perform the desired simulations.</title>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009410.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Szallasi</surname><given-names>Z</given-names></name>, <name><surname>Stelling</surname><given-names>J</given-names></name>, <name><surname>Periwal</surname><given-names>V</given-names></name>. <source>System Modeling in Cellular Biology: From Concepts to Nuts and Bolts</source>. <publisher-name>The MIT Press</publisher-name>; <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref002">
      <label>2</label>
      <mixed-citation publication-type="other">Besozzi D. Reaction-Based Models of Biochemical Networks. In: Beckmann A, Bienvenu L, Jonoska N, editors. Proc. of Pursuit of the Universal, 12th Conference on Computability in Europe. vol. 9709 of LNCS. Switzerland: Springer International Publishing; 2016. p. 24–34.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref003">
      <label>3</label>
      <mixed-citation publication-type="other">Cazzaniga P, Nobile MS, Besozzi D. The impact of particles initialization in PSO: parameter estimation as a case in point. In: Proc. of Computational Intelligence in Bioinformatics and Computational Biology. IEEE; 2015. p. 1–8.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref004">
      <label>4</label>
      <mixed-citation publication-type="book"><name><surname>Munsky</surname><given-names>B</given-names></name>, <name><surname>Hlavacek</surname><given-names>WS</given-names></name>, <name><surname>Tsimring</surname><given-names>LS</given-names></name>. <source>Quantitative biology: theory, computational methods, and models</source>. <publisher-name>MIT Press</publisher-name>; <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Aldridge</surname><given-names>BB</given-names></name>, <name><surname>Burke</surname><given-names>JM</given-names></name>, <name><surname>Lauffenburger</surname><given-names>DA</given-names></name>, <name><surname>Sorger</surname><given-names>PK</given-names></name>. <article-title>Physicochemical modelling of cell signalling pathways</article-title>. <source>Nat Cell Biol</source>. <year>2006</year>;<volume>8</volume>(<issue>11</issue>):<fpage>1195</fpage>–<lpage>1203</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncb1497</pub-id><?supplied-pmid 17060902?><pub-id pub-id-type="pmid">17060902</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Chou</surname><given-names>IC</given-names></name>, <name><surname>Voit</surname><given-names>EO</given-names></name>. <article-title>Recent developments in parameter estimation and structure identification of biochemical and genomic systems</article-title>. <source>Math Biosci</source>. <year>2009</year>;<volume>219</volume>(<issue>2</issue>):<fpage>57</fpage>–<lpage>83</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.mbs.2009.03.002</pub-id><?supplied-pmid 19327372?><pub-id pub-id-type="pmid">19327372</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Tangherloni</surname><given-names>A</given-names></name>, <name><surname>Spolaor</surname><given-names>S</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <name><surname>Rundo</surname><given-names>L</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Biochemical parameter estimation vs. benchmark functions: a comparative study of optimization performance and representation design</article-title>. <source>Appl Soft Comput</source>. <year>2019</year>;<volume>81</volume>:<fpage>105494</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asoc.2019.105494</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>, <name><surname>Tangherloni</surname><given-names>A</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>. <article-title>Graphics processing units in bioinformatics, computational biology and systems biology</article-title>. <source>Brief Bioinform</source>. <year>2017</year>;<volume>18</volume>(<issue>5</issue>):<fpage>870</fpage>–<lpage>885</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbw058</pub-id><?supplied-pmid 27402792?><pub-id pub-id-type="pmid">27402792</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Wilkinson</surname><given-names>D</given-names></name>. <article-title>Stochastic modelling for quantitative description of heterogeneous biological systems</article-title>. <source>Nat Rev Genet</source>. <year>2009</year>;<volume>10</volume>(<issue>2</issue>):<fpage>122</fpage>–<lpage>133</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg2509</pub-id><?supplied-pmid 19139763?><pub-id pub-id-type="pmid">19139763</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Székely</surname><given-names>TJ</given-names></name>, <name><surname>K</surname><given-names>B</given-names></name>. <article-title>Stochastic simulation in systems biology</article-title>. <source>Comput Struct Biotechnol J</source>. <year>2014</year>;<volume>12</volume>(<issue>20–21</issue>):<fpage>14</fpage>–<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.csbj.2014.10.003</pub-id><?supplied-pmid 25505503?><pub-id pub-id-type="pmid">25505503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Harris</surname><given-names>LA</given-names></name>, <name><surname>Clancy</surname><given-names>P</given-names></name>. <article-title>A “partitioned leaping” approach for multiscale modeling of chemical reaction dynamics</article-title>. <source>J Chem Phys</source>. <year>2006</year>;<volume>125</volume>(<issue>14</issue>):<fpage>144107</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1063/1.2354085</pub-id><?supplied-pmid 17042579?><pub-id pub-id-type="pmid">17042579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Petzold</surname><given-names>L</given-names></name>. <article-title>Efficient parallelization of the stochastic simulation algorithm for chemically reacting systems on the graphics processing unit</article-title>. <source>Int J High Perform Comput Appl</source>. <year>2010</year>;<volume>24</volume>(<issue>2</issue>):<fpage>107</fpage>–<lpage>116</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1177/1094342009106066</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Gillespie</surname><given-names>DT</given-names></name>. <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>. <source>J Comput Phys</source>. <year>1976</year>;<volume>22</volume>(<issue>4</issue>):<fpage>403</fpage>–<lpage>434</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0021-9991(76)90041-3</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Liepe</surname><given-names>J</given-names></name>, <name><surname>Sheng</surname><given-names>X</given-names></name>, <name><surname>Stumpf</surname><given-names>MP</given-names></name>, <name><surname>Barnes</surname><given-names>C</given-names></name>. <article-title>GPU accelerated biochemical network simulation</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>6</issue>):<fpage>874</fpage>–<lpage>876</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btr015</pub-id><?supplied-pmid 21224286?><pub-id pub-id-type="pmid">21224286</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>. <article-title>GPU-accelerated simulations of mass-action kinetics models with cupSODA</article-title>. <source>J Supercomput</source>. <year>2014</year>;<volume>69</volume>(<issue>1</issue>):<fpage>17</fpage>–<lpage>24</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11227-014-1208-8</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Petzold</surname><given-names>L</given-names></name>. <article-title>Automatic selection of methods for solving stiff and nonstiff systems of ordinary differential equations</article-title>. <source>SIAM J Sci Stat Comp</source>. <year>1983</year>;<volume>4</volume>(<issue>1</issue>):<fpage>136</fpage>–<lpage>148</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1137/0904010</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <name><surname>Pescini</surname><given-names>D</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>. <article-title>cuTauLeaping: a GPU-powered tau-leaping stochastic simulator for massive parallel analyses of biological systems</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>3</issue>):<fpage>e91963</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0091963</pub-id><?supplied-pmid 24663957?><pub-id pub-id-type="pmid">24663957</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>Y</given-names></name>, <name><surname>Gillespie</surname><given-names>DT</given-names></name>, <name><surname>Petzold</surname><given-names>LR</given-names></name>. <article-title>Efficient step size selection for the tau-leaping simulation method</article-title>. <source>J Chem Phys</source>. <year>2006</year>;<volume>124</volume>(<issue>4</issue>):<fpage>044109</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1063/1.2159468</pub-id><?supplied-pmid 16460151?><pub-id pub-id-type="pmid">16460151</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Harris</surname><given-names>LA</given-names></name>, <name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Pino</surname><given-names>JC</given-names></name>, <name><surname>Lubbock</surname><given-names>AL</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>GPU-powered model analysis with PySB/cupSODA</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>21</issue>):<fpage>3492</fpage>–<lpage>3494</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx420</pub-id><?supplied-pmid 28666314?><pub-id pub-id-type="pmid">28666314</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Lopez</surname><given-names>CF</given-names></name>, <name><surname>Muhlich</surname><given-names>JL</given-names></name>, <name><surname>Bachman</surname><given-names>JA</given-names></name>, <name><surname>Sorger</surname><given-names>PK</given-names></name>. <article-title>Programming biological models in Python using PySB</article-title>. <source>Mol Syst Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/msb.2013.1</pub-id><?supplied-pmid 23423320?><pub-id pub-id-type="pmid">23423320</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Tangherloni</surname><given-names>A</given-names></name>, <name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>. <article-title>LASSIE: simulating large-scale models of biochemical systems on GPUs</article-title>. <source>BMC Bioinform</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>246</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-017-1666-0</pub-id><?supplied-pmid 28486952?><pub-id pub-id-type="pmid">28486952</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Komarov</surname><given-names>I</given-names></name>, <name><surname>D’Souza</surname><given-names>RM</given-names></name>, <name><surname>Tapia</surname><given-names>J</given-names></name>. <article-title>Accelerating the Gillespie <italic toggle="yes">τ</italic>-leaping method using graphics processing units</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>(<issue>6</issue>):<fpage>e37370</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0037370</pub-id><?supplied-pmid 22715366?><pub-id pub-id-type="pmid">22715366</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Komarov</surname><given-names>I</given-names></name>, <name><surname>D’Souza</surname><given-names>RM</given-names></name>. <article-title>Accelerating the Gillespie exact stochastic simulation algorithm using hybrid parallel execution on graphics processing units</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>(<issue>11</issue>):<fpage>e46693</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0046693</pub-id><?supplied-pmid 23152751?><pub-id pub-id-type="pmid">23152751</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Sumiyoshi</surname><given-names>K</given-names></name>, <name><surname>Hirata</surname><given-names>K</given-names></name>, <name><surname>Hiroi</surname><given-names>N</given-names></name>, <name><surname>Funahashi</surname><given-names>A</given-names></name>. <article-title>Acceleration of discrete stochastic biochemical simulation using GPGPU</article-title>. <source>Front Physiol</source>. <year>2015</year>;<volume>6</volume>:<fpage>42</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fphys.2015.00042</pub-id><?supplied-pmid 25762936?><pub-id pub-id-type="pmid">25762936</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Drawert</surname><given-names>B</given-names></name>, <name><surname>Hellander</surname><given-names>A</given-names></name>, <name><surname>Bales</surname><given-names>B</given-names></name>, <name><surname>Banerjee</surname><given-names>D</given-names></name>, <name><surname>Bellesia</surname><given-names>G</given-names></name>, <name><surname>Daigle</surname><given-names>BJ</given-names><suffix>Jr</suffix></name>, <etal>et al</etal>. <article-title>Stochastic simulation service: bridging the gap between the computational expert and the biologist</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>12</issue>):<fpage>e1005220</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005220</pub-id><?supplied-pmid 27930676?><pub-id pub-id-type="pmid">27930676</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">Panchiwala H, Shah S, Planatscher H, Zakharchuk M, König M, Dräger A. The Systems Biology Simulation Core Library. Preprints. 2020.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Keating</surname><given-names>SM</given-names></name>, <name><surname>Waltemath</surname><given-names>D</given-names></name>, <name><surname>König</surname><given-names>M</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>, <name><surname>Dräger</surname><given-names>A</given-names></name>, <name><surname>Chaouiya</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>SBML Level 3: an extensible format for the exchange and reuse of biological models</article-title>. <source>Mol Syst Biol</source>. <year>2020</year>;<volume>16</volume>(<issue>8</issue>):<fpage>e9110</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.15252/msb.20199110</pub-id><?supplied-pmid 32845085?><pub-id pub-id-type="pmid">32845085</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Dormand</surname><given-names>JR</given-names></name>, <name><surname>Prince</surname><given-names>PJ</given-names></name>. <article-title>A family of embedded Runge-Kutta formulae</article-title>. <source>J Comput Appl Math</source>. <year>1980</year>;<volume>6</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>26</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0771-050X(80)90013-3</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Dormand</surname><given-names>JR</given-names></name>. <source>Numerical methods for differential equations: a computational approach</source>. <volume>vol. 3</volume>. <publisher-name>CRC Press</publisher-name>; <year>1996</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref030">
      <label>30</label>
      <mixed-citation publication-type="book"><name><surname>Hairer</surname><given-names>E</given-names></name>, <name><surname>Nørsett</surname><given-names>SP</given-names></name>, <name><surname>Wanner</surname><given-names>G</given-names></name>. <source>Solving ordinary differential equations I</source>. <volume>vol. 8</volume>. <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>Berlin</publisher-loc>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref031">
      <label>31</label>
      <mixed-citation publication-type="book"><name><surname>Hairer</surname><given-names>E</given-names></name>, <name><surname>Wanner</surname><given-names>G</given-names></name>. <source>Solving ordinary differential equations II</source>. <volume>vol. 14</volume>. <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>Berlin</publisher-loc>; <year>2002</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Hairer</surname><given-names>E</given-names></name>, <name><surname>Wanner</surname><given-names>G</given-names></name>. <article-title>Stiff differential equations solved by Radau methods</article-title>. <source>J Comput Appl Math</source>. <year>1999</year>;<volume>111</volume>(<issue>1-2</issue>):<fpage>93</fpage>–<lpage>111</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0377-0427(99)00134-X</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Gillespie</surname><given-names>DT</given-names></name>. <article-title>Stochastic simulation of chemical kinetics</article-title>. <source>Annu Rev Phys Chem</source>. <year>2007</year>;<volume>58</volume>:<fpage>35</fpage>–<lpage>55</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.physchem.58.032806.104637</pub-id><?supplied-pmid 17037977?><pub-id pub-id-type="pmid">17037977</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Rathinam</surname><given-names>M</given-names></name>, <name><surname>Petzold</surname><given-names>LR</given-names></name>, <name><surname>Cao</surname><given-names>Y</given-names></name>, <name><surname>Gillespie</surname><given-names>DT</given-names></name>. <article-title>Stiffness in stochastic chemically reacting systems: The implicit tau-leaping method</article-title>. <source>J Chem Phys</source>. <year>2003</year>;<volume>119</volume>(<issue>24</issue>):<fpage>12784</fpage>–<lpage>12794</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1063/1.1627296</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Higham</surname><given-names>DJ</given-names></name>, <name><surname>Trefethen</surname><given-names>LN</given-names></name>. <article-title>Stiffness of ODEs</article-title>. <source>BIT Numer Math</source>. <year>1993</year>;<volume>33</volume>(<issue>2</issue>):<fpage>285</fpage>–<lpage>303</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF01989751</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Szymańska</surname><given-names>P</given-names></name>, <name><surname>Martin</surname><given-names>KR</given-names></name>, <name><surname>MacKeigan</surname><given-names>JP</given-names></name>, <name><surname>Hlavacek</surname><given-names>WS</given-names></name>, <name><surname>Lipniacki</surname><given-names>T</given-names></name>. <article-title>Computational analysis of an Autophagy/Translation switch based on mutual inhibition of MTORC1 and ULK1</article-title>. <source>PLoS One</source>. <year>2015</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e0116550</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0116550</pub-id><?supplied-pmid 25761126?><pub-id pub-id-type="pmid">25761126</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">Totis N, Tangherloni A, Beccuti M, Cazzaniga P, Nobile MS, Besozzi D, et al. Efficient and settings-free calibration of detailed kinetic metabolic models with enzyme isoforms characterization. In: Proc. of International Meeting on Computational Intelligence Methods for Bioinformatics and Biostatistics. Springer; 2018. p. 187–202.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>PN</given-names></name>, <name><surname>Byrne</surname><given-names>GD</given-names></name>, <name><surname>Hindmarsh</surname><given-names>AC</given-names></name>. <article-title>VODE: A variable-coefficient ODE solver</article-title>. <source>SIAM J Sci Stat Comp</source>. <year>1989</year>;<volume>10</volume>(<issue>5</issue>):<fpage>1038</fpage>–<lpage>1051</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1137/0910062</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Somogyi</surname><given-names>ET</given-names></name>, <name><surname>Bouteiller</surname><given-names>JM</given-names></name>, <name><surname>Glazier</surname><given-names>JA</given-names></name>, <name><surname>König</surname><given-names>M</given-names></name>, <name><surname>Medley</surname><given-names>JK</given-names></name>, <name><surname>Swat</surname><given-names>MH</given-names></name>, <etal>et al</etal>. <article-title>libRoadRunner: a high performance SBML simulation and analysis library</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>20</issue>):<fpage>3315</fpage>–<lpage>3321</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv363</pub-id><?supplied-pmid 26085503?><pub-id pub-id-type="pmid">26085503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Cohen</surname><given-names>SD</given-names></name>, <name><surname>Hindmarsh</surname><given-names>AC</given-names></name>, <name><surname>Dubois</surname><given-names>PF</given-names></name>. <article-title>CVODE, a stiff/nonstiff ODE solver in C</article-title>. <source>Comput Phys</source>. <year>1996</year>;<volume>10</volume>(<issue>2</issue>):<fpage>138</fpage>–<lpage>143</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1063/1.4822377</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Hoops</surname><given-names>S</given-names></name>, <name><surname>Sahle</surname><given-names>S</given-names></name>, <name><surname>Gauges</surname><given-names>R</given-names></name>, <name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Pahle</surname><given-names>J</given-names></name>, <name><surname>Simus</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>COPASI—a COmplex PAthway SImulator</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>24</issue>):<fpage>3067</fpage>–<lpage>3074</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btl485</pub-id><?supplied-pmid 17032683?><pub-id pub-id-type="pmid">17032683</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Moraru</surname><given-names>II</given-names></name>, <name><surname>Schaff</surname><given-names>JC</given-names></name>, <name><surname>Slepchenko</surname><given-names>BM</given-names></name>, <name><surname>Blinov</surname><given-names>M</given-names></name>, <name><surname>Morgan</surname><given-names>F</given-names></name>, <name><surname>Lakshminarayana</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Virtual Cell modelling and simulation software environment</article-title>. <source>IET Syst Biol</source>. <year>2008</year>;<volume>2</volume>(<issue>5</issue>):<fpage>352</fpage>–<lpage>362</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1049/iet-syb:20080102</pub-id><?supplied-pmid 19045830?><pub-id pub-id-type="pmid">19045830</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref043">
      <label>43</label>
      <mixed-citation publication-type="other">Nvidia. CUDA C Programming Guide, version 8.0; 2016.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref044">
      <label>44</label>
      <mixed-citation publication-type="book"><name><surname>Butcher</surname><given-names>JC</given-names></name>. <source>Numerical methods for ordinary differential equations</source>. <publisher-loc>Chichester West Sussex, UK</publisher-loc>: <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref045">
      <label>45</label>
      <mixed-citation publication-type="book"><name><surname>Cash</surname><given-names>JR</given-names></name>. <part-title>Backward Differentiation Formulae</part-title>. In: <source>Encyclopedia of Applied and Computational Mathematics</source>. <publisher-loc>Berlin Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2015</year>. p. <fpage>97</fpage>–<lpage>101</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref046">
      <label>46</label>
      <mixed-citation publication-type="other">Jones E, Oliphant T, Peterson P, et al. SciPy: Open source scientific tools for Python; 2001. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.scipy.org/" ext-link-type="uri">http://www.scipy.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Harris</surname><given-names>LA</given-names></name>, <name><surname>Hogg</surname><given-names>JS</given-names></name>, <name><surname>Tapia</surname><given-names>JJ</given-names></name>, <name><surname>Sekar</surname><given-names>JA</given-names></name>, <name><surname>Gupta</surname><given-names>S</given-names></name>, <name><surname>Korsunsky</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>BioNetGen 2.2: advances in rule-based modeling</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>21</issue>):<fpage>3366</fpage>–<lpage>3368</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw469</pub-id><?supplied-pmid 27402907?><pub-id pub-id-type="pmid">27402907</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Jamshidi</surname><given-names>N</given-names></name>, <name><surname>Palsson</surname><given-names>BØ</given-names></name>. <article-title>Mass action stoichiometric simulation models: incorporating kinetics and regulation into stoichiometric models</article-title>. <source>Biophys J</source>. <year>2010</year>;<volume>98</volume>(<issue>2</issue>):<fpage>175</fpage>–<lpage>185</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.bpj.2009.09.064</pub-id><?supplied-pmid 20338839?><pub-id pub-id-type="pmid">20338839</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Bennett</surname><given-names>MR</given-names></name>, <name><surname>Pang</surname><given-names>WL</given-names></name>, <name><surname>Ostroff</surname><given-names>NA</given-names></name>, <name><surname>Baumgartner</surname><given-names>BL</given-names></name>, <name><surname>Nayak</surname><given-names>S</given-names></name>, <name><surname>Tsimring</surname><given-names>LS</given-names></name>, <etal>et al</etal>. <article-title>Metabolic gene regulation in a dynamically changing environment</article-title>. <source>Nature</source>. <year>2008</year>;<volume>454</volume>(<issue>7208</issue>):<fpage>1119</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature07211</pub-id><?supplied-pmid 18668041?><pub-id pub-id-type="pmid">18668041</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Metallo</surname><given-names>CM</given-names></name>, <name><surname>Vander Heiden</surname><given-names>MG</given-names></name>. <article-title>Understanding metabolic regulation and its influence on cell physiology</article-title>. <source>Mol Cell</source>. <year>2013</year>;<volume>49</volume>(<issue>3</issue>):<fpage>388</fpage>–<lpage>398</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.molcel.2013.01.018</pub-id><?supplied-pmid 23395269?><pub-id pub-id-type="pmid">23395269</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Smallbone</surname><given-names>K</given-names></name>, <name><surname>Messiha</surname><given-names>HL</given-names></name>, <name><surname>Carroll</surname><given-names>KM</given-names></name>, <name><surname>Winder</surname><given-names>CL</given-names></name>, <name><surname>Malys</surname><given-names>N</given-names></name>, <name><surname>Dunn</surname><given-names>WB</given-names></name>, <etal>et al</etal>. <article-title>A model of yeast glycolysis based on a consistent kinetic characterisation of all its enzymes</article-title>. <source>FEBS Lett</source>. <year>2013</year>;<volume>587</volume>(<issue>17</issue>):<fpage>2832</fpage>–<lpage>2841</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.febslet.2013.06.043</pub-id><?supplied-pmid 23831062?><pub-id pub-id-type="pmid">23831062</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>O’Brien</surname><given-names>J</given-names></name>, <name><surname>Kla</surname><given-names>KM</given-names></name>, <name><surname>Hopkins</surname><given-names>IB</given-names></name>, <name><surname>Malecki</surname><given-names>EA</given-names></name>, <name><surname>McKenna</surname><given-names>MC</given-names></name>. <article-title>Kinetic parameters and lactate dehydrogenase isozyme activities support possible lactate utilization by neurons</article-title>. <source>Neurochem Res</source>. <year>2007</year>;<volume>32</volume>(<issue>4-5</issue>):<fpage>597</fpage>–<lpage>607</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11064-006-9132-9</pub-id><?supplied-pmid 17006762?><pub-id pub-id-type="pmid">17006762</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Wuntch</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>RF</given-names></name>, <name><surname>Vesell</surname><given-names>ES</given-names></name>. <article-title>Lactate dehydrogenase isozymes: kinetic properties at high enzyme concentrations</article-title>. <source>Science</source>. <year>1970</year>;<volume>167</volume>(<issue>3914</issue>):<fpage>63</fpage>–<lpage>65</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.167.3914.63</pub-id><?supplied-pmid 5409479?><pub-id pub-id-type="pmid">5409479</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Sobol</surname><given-names>IM</given-names></name>. <article-title>Global sensitivity indices for nonlinear mathematical models and their Monte Carlo estimates</article-title>. <source>Math Comput Simul</source>. <year>2001</year>;<volume>55</volume>(<issue>1-3</issue>):<fpage>271</fpage>–<lpage>280</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0378-4754(00)00270-6</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Saltelli</surname><given-names>A</given-names></name>, <name><surname>Annoni</surname><given-names>P</given-names></name>, <name><surname>Azzini</surname><given-names>I</given-names></name>, <name><surname>Campolongo</surname><given-names>F</given-names></name>, <name><surname>Ratto</surname><given-names>M</given-names></name>, <name><surname>Tarantola</surname><given-names>S</given-names></name>. <article-title>Variance based sensitivity analysis of model output. Design and estimator for the total sensitivity index</article-title>. <source>Comput Phys Commun</source>. <year>2010</year>;<volume>181</volume>(<issue>2</issue>):<fpage>259</fpage>–<lpage>270</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cpc.2009.09.018</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Saltelli</surname><given-names>A</given-names></name>. <article-title>Making best use of model evaluations to compute sensitivity indices</article-title>. <source>Comput Phys Commun</source>. <year>2002</year>;<volume>145</volume>(<issue>2</issue>):<fpage>280</fpage>–<lpage>297</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0010-4655(02)00280-1</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <name><surname>Colombo</surname><given-names>R</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>, <name><surname>Pasi</surname><given-names>G</given-names></name>. <article-title>Fuzzy Self-Tuning PSO: A settings-free algorithm for global optimization</article-title>. <source>Swarm Evol Comput</source>. <year>2018</year>;<volume>39</volume>:<fpage>70</fpage>–<lpage>85</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.swevo.2017.09.001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Poli</surname><given-names>R</given-names></name>, <name><surname>Kennedy</surname><given-names>J</given-names></name>, <name><surname>Blackwell</surname><given-names>T</given-names></name>. <article-title>Particle swarm optimization</article-title>. <source>Swarm intelligence</source>. <year>2007</year>;<volume>1</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>57</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11721-007-0002-0</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref059">
      <label>59</label>
      <mixed-citation publication-type="other">Nobile MS, Tangherloni A, Rundo L, Spolaor S, Besozzi D, Mauri G, et al. Computational Intelligence for Parameter Estimation of Biochemical Systems. In: Proc. Congress on Evolutionary Computation (CEC). IEEE; 2018. p. 1–8.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Przybylski</surname><given-names>A</given-names></name>, <name><surname>Thiel</surname><given-names>B</given-names></name>, <name><surname>Keller-Findeisen</surname><given-names>J</given-names></name>, <name><surname>Stock</surname><given-names>B</given-names></name>, <name><surname>Bates</surname><given-names>M</given-names></name>. <article-title>Gpufit: An open-source toolkit for GPU-accelerated curve fitting</article-title>. <source>Sci Rep</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>15722</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-017-15313-9</pub-id><?supplied-pmid 29146965?><pub-id pub-id-type="pmid">29146965</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref061">
      <label>61</label>
      <mixed-citation publication-type="other">Jones S. Introduction to dynamic parallelism. In: GPU Technology Conference Presentation S. vol. 338; 2012. p. 2012.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref062">
      <label>62</label>
      <mixed-citation publication-type="other">Wang J, Yalamanchili S. Characterization and analysis of dynamic parallelism in unstructured GPU applications. In: Proc. of International Symposium on Workload Characterization. IEEE; 2014. p. 51–60.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Cornish-Bowden</surname><given-names>A</given-names></name>. <article-title>One hundred years of Michaelis–Menten kinetics</article-title>. <source>Perspect Sci</source>. <year>2015</year>;<volume>4</volume>:<fpage>3</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.pisc.2014.12.002</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Hill</surname><given-names>AV</given-names></name>. <article-title>The possible effects of the aggregation of the molecules of haemoglobin on its dissociation curves</article-title>. <source>J Physiol</source>. <year>1910</year>;<volume>40</volume>:<fpage>4</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>. <article-title>ginSODA: massive parallel integration of stiff ODE systems on GPUs</article-title>. <source>J Supercomput</source>. <year>2019</year>;<volume>75</volume>(<issue>12</issue>):<fpage>7844</fpage>–<lpage>7856</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11227-018-2549-5</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref066">
      <label>66</label>
      <mixed-citation publication-type="other">Besozzi D, Cazzaniga P, Mauri G, Pescini D. BioSimWare: a software for the modeling, simulation and analysis of biological systems. In: proc. of International Conference on Membrane Computing. Springer; 2010. p. 119–143.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Chellaboina</surname><given-names>V</given-names></name>, <name><surname>Bhat</surname><given-names>SP</given-names></name>, <name><surname>Haddad</surname><given-names>WM</given-names></name>, <name><surname>Bernstein</surname><given-names>DS</given-names></name>. <article-title>Modeling and analysis of mass-action kinetics</article-title>. <source>IEEE Control Syst</source>. <year>2009</year>;<volume>29</volume>(<issue>4</issue>):<fpage>60</fpage>–<lpage>78</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/MCS.2009.932926</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Voit</surname><given-names>EO</given-names></name>, <name><surname>Martens</surname><given-names>HA</given-names></name>, <name><surname>W</surname><given-names>OS</given-names></name>. <article-title>150 years of the mass action law</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>e1004012</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004012</pub-id><?supplied-pmid 25569257?><pub-id pub-id-type="pmid">25569257</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Riva</surname><given-names>SG</given-names></name>, <name><surname>Cazzaniga</surname><given-names>P</given-names></name>, <name><surname>Nobile</surname><given-names>MS</given-names></name>, <name><surname>Spolaor</surname><given-names>S</given-names></name>, <name><surname>Rundo</surname><given-names>L</given-names></name>, <name><surname>Besozzi</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>SMGen: A generator of synthetic models of biochemical reaction networks</article-title>. <source>bioRxiv</source>. <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Yue</surname><given-names>H</given-names></name>, <name><surname>Brown</surname><given-names>M</given-names></name>, <name><surname>He</surname><given-names>F</given-names></name>, <name><surname>Jia</surname><given-names>J</given-names></name>, <name><surname>Kell</surname><given-names>DB</given-names></name>. <article-title>Sensitivity analysis and robust experimental design of a signal transduction pathway system</article-title>. <source>Int J Chem Kinet</source>. <year>2008</year>;<volume>40</volume>(<issue>11</issue>):<fpage>730</fpage>–<lpage>741</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/kin.20369</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref071">
      <label>71</label>
      <mixed-citation publication-type="journal"><name><surname>Martín-Vaquero</surname><given-names>J</given-names></name>. <article-title>A 17th-order Radau IIA method for package RADAU. Applications in mechanical systems</article-title>. <source>Comput Math Appl</source>. <year>2010</year>;<volume>59</volume>(<issue>8</issue>):<fpage>2464</fpage>–<lpage>2472</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.camwa.2009.12.025</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref072">
      <label>72</label>
      <mixed-citation publication-type="journal"><name><surname>Prothero</surname><given-names>A</given-names></name>, <name><surname>Robinson</surname><given-names>A</given-names></name>. <article-title>On the stability and accuracy of one-step methods for solving stiff systems of ordinary differential equations</article-title>. <source>Math Comp</source>. <year>1974</year>;<volume>28</volume>(<issue>125</issue>):<fpage>145</fpage>–<lpage>162</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1090/S0025-5718-1974-0331793-2</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref073">
      <label>73</label>
      <mixed-citation publication-type="journal"><name><surname>Du</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>. <article-title>A strongly S-stable low-dissipation and low-dispersion Runge-Kutta scheme for convection diffusion systems</article-title>. <source>Aerosp Sci Technol</source>. <year>2019</year>;<volume>93</volume>:<fpage>105355</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ast.2019.105355</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009410.ref074">
      <label>74</label>
      <mixed-citation publication-type="other">Nvidia. cuBLAS library 8.0; 2015.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009410.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009410.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009410" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">23 May 2021</named-content>
    </p>
    <p>Dear Dr Tangherloni,</p>
    <p>Thank you very much for submitting your manuscript "FiCoS: a fine- and coarse-grained GPU-powered deterministic simulator for biochemical networks" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>Specifically, please make the source, along with the relevant tutorials and examples available as part of an open source repository, such as github and include the link in the manuscript. Otherwise the reviewers can not assess the software and provide an evaluation. This is an important part of software submissions.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: I could not find any mention of where to get the software FiCoS, Without that I cannot review the paper properly. Even a search on google did not bring up any refernce to the software.</p>
    <p>Reviewer #2: This paper presents a novel approach for conducting fine- and coarse-grain parallel simulations of ODE systems arising from biochemical reaction networks. The introduction provides a fairly comprehensive overview of previous efforts in this area and the body of the paper presents results of a series of comparisons between the new method and previous ones, including the widely-used standard single processor CPU-based implementations. Most of the comparisons use synthetic networks, but the final application is a case study on a large-scale existing model of autophagy, which demonstrates that the FiCoS approach is capable of performing a much larger number of ODE integrations given a fixed time budget. The method is described schematically in the Methods section at the end of the paper and in much greater detail in Supplemental material. Overall, this division of material seems appropriate. The paper is generally well written and easy to follow.</p>
    <p>I have two main concerns about the paper. First, I believe this is intended to be an open source freely available tool (e.g., line 232 refers to the tool as "open source") but this is not made clear in the text and no links to the current implementation are provided. I feel that the significance of this work for the computational biology community would be greatly diminished if the tool and code were not available. I am sure that this point is easily addressed. The second concerns demonstration of the practical relevance of the tool. GPU's offer the potential to greatly increase the scale of computational analysis that can be performed on biological models, and the case study presented highlights how the method can be applied to a parameter sweep analysis, which is a commonly-performed task. However, I think it would strengthen the impact and interest of this paper to present demonstrations of one or two other common analyses, such as parameter sensitivity and parameter estimation, and to demonstrate how GPU-based simulations can be used in such practical applications to obtain superior performance. I would strongly encourage the authors to present their case studies in the form of Jupyter notebooks that would be available for the community to adapt for use in their own applications. I think a few examples like this could greatly increase the adoption of GPU use in the field compared to the current state, where I think most practitioners are not using this technology.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: <bold>No: </bold></p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009410.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009410.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009410" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">18 Jun 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009410.s003" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">ResponseReviewers.pdf</named-content></p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009410.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009410.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009410" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">12 Jul 2021</named-content>
    </p>
    <p>Dear Dr Tangherloni,</p>
    <p>Thank you very much for submitting your manuscript "FiCoS: a fine- and coarse-grained GPU-powered deterministic simulator for biochemical networks" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This is an interesting paper on speeding up mass-action based chemical models using GPUs. In fact this is the first paper I've seen where I am actually impressed with the performance. There are limitations, in particular the approach only deals with mass-action kinetics and as far as I can tell it cannot deal with nonlinear rate laws such as Hill of Michaelis-Menten like expressions. Do the authors have any plans to extend the applicably to more complex rate laws? A mention of this could be made in the discussion, eg what would be the issue to implement such capabilities?</p>
    <p>The real bottleneck today in computational systems biology is parameter fitting where most of the time is spend in solving the ODEs. In our own work it can take 36 hours to fit a single model on a 8 core machine and we have many 1000s to fit. The second reviewer also mentioned this problem but it doesn't appear to have been addressed by the reviewers. The authors might not be able to solve this problem at the moment but there should be some comment on this is the discussion section and whether a GPU approach could solve this.</p>
    <p>In terms of comparison it might have been better to compare against CVODE rather than LSODA. CVODE is a much more modern integrator, LSODA is now over 25 years old is unchanged during that time.</p>
    <p>No mention of SBML is made at all in the paper or supplement. Most models are now stored in SBML (see biomodels), how are users to exploit the new GPU code given that models are in SBML? As a result no comparisons were made with existing simulators such as COAPSI, VCell, roadrunner etc.</p>
    <p>I was very happy to see that code is now open source. Note that the use of GPL-3 will likely significantly restrict it use by the community., perhaps a more liberal open license would be better? Of course the authors have the final say in the type of license they use.</p>
    <p>Finally, the supplement mentioned the hardware that was used, "All tests were performed on a workstation equipped with a CPU Intel Core i7-2600 CPU (clock 3.4 GHz) and 8 GB of RAM, running on Ubuntu 16.04 LTS. The GPU used in the tests was a Nvidia GeForce GTX Titan X (3072 cores, clock 1.075 GHz, RAM 12 GB), CUDA toolkit version 8 (driver 387.26)."</p>
    <p>I would move this to the methods section in the main text because if someone want to use this code, they need to know what hardware to purchase and the method section the best place for this. For example this reviewer is interested in trying out the code.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009410.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009410.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009410" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">3 Aug 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009410.s004" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">ResponseReviewers_R2.pdf</named-content></p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009410.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009410.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009410.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009410" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">28 Aug 2021</named-content>
    </p>
    <p>Dear Dr Tangherloni,</p>
    <p>We are pleased to inform you that your manuscript 'FiCoS: a fine-grained and coarse-grained GPU-powered deterministic simulator for biochemical networks' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Dina Schneidman-Duhovny</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Dina Schneidman-Duhovny</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Many thanks to the authors, all my comments have been resovled. This was an interesting paper.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009410.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009410.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009410" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Sep 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-21-00064R2 </p>
    <p>FiCoS: a fine-grained and coarse-grained GPU-powered deterministic simulator for biochemical networks</p>
    <p>Dear Dr Tangherloni,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Andrea Szabo</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
