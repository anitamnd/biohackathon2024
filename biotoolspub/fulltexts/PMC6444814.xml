<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6444814</article-id>
    <article-id pub-id-type="publisher-id">1673</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1673-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Conbase: a software for unsupervised discovery of clonal somatic mutations in single cells through read phasing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4575-5629</contrib-id>
        <name>
          <surname>Hård</surname>
          <given-names>Joanna</given-names>
        </name>
        <address>
          <email>joanna.hard@ki.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Al Hakim</surname>
          <given-names>Ezeddin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kindblom</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Björklund</surname>
          <given-names>Åsa K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Sennblad</surname>
          <given-names>Bengt</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Demirci</surname>
          <given-names>Ilke</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paterlini</surname>
          <given-names>Marta</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reu</surname>
          <given-names>Pedro</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Borgström</surname>
          <given-names>Erik</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ståhl</surname>
          <given-names>Patrik L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Michaelsson</surname>
          <given-names>Jakob</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Mold</surname>
          <given-names>Jeff E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Frisén</surname>
          <given-names>Jonas</given-names>
        </name>
        <address>
          <email>jonas.frisen@ki.se</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.465198.7</institution-id><institution>Department of Cell and Molecular Biology, </institution><institution>Karolinska Institutet, </institution></institution-wrap>Solna, Sweden </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9457</institution-id><institution-id institution-id-type="GRID">grid.8993.b</institution-id><institution>Department of Cell and Molecular Biology, National Bioinformatics Infrastructure Sweden, Scilifelab, </institution><institution>Uppsala University, </institution></institution-wrap>Uppsala, Sweden </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000121581746</institution-id><institution-id institution-id-type="GRID">grid.5037.1</institution-id><institution>Division of Gene Technology, </institution><institution>Scilifelab, KTH Royal Institute of Technology, </institution></institution-wrap>Solna, Sweden </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 0626</institution-id><institution-id institution-id-type="GRID">grid.4714.6</institution-id><institution>Center for Infectious Medicine, Department of Medicine, </institution><institution>Karolinska Institutet, </institution></institution-wrap>Huddinge, Sweden </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>68</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>3</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Accurate variant calling and genotyping represent major limiting factors for downstream applications of single-cell genomics. Here, we report Conbase for the identification of somatic mutations in single-cell DNA sequencing data. Conbase leverages phased read data from multiple samples in a dataset to achieve increased confidence in somatic variant calls and genotype predictions. Comparing the performance of Conbase to three other methods, we find that Conbase performs best in terms of false discovery rate and specificity and provides superior robustness on simulated data, in vitro expanded fibroblasts and clonal lymphocyte populations isolated directly from a healthy human donor.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-019-1673-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell DNA sequencing</kwd>
      <kwd>Single-cell variant calling</kwd>
      <kwd>Somatic variation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004063</institution-id>
            <institution>Knut och Alice Wallenbergs Stiftelse</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004359</institution-id>
            <institution>Vetenskapsrådet</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002794</institution-id>
            <institution>Cancerfonden</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002706</institution-id>
            <institution>AFA Försäkring</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Strategic Research Programme in Stem Cells and Regenerative Medicine at Karolinska Institutet (StratRegen)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007464</institution-id>
            <institution>Torsten Söderbergs Stiftelse</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Swedish Genomes Program, Science for Life Laboratory</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Single-cell DNA sequencing has substantial untapped potential for understanding genomic diversity in both health and disease [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. A particularly interesting target application for single-cell genomics is lineage tracing of human cells, where the distributions of somatic variants among cells in a population reflect their phylogenetic relationships. In this context, minimizing the number of falsely predicted somatic variants is of utmost importance as these introduce noise or misleading signals, severely reducing the power of phylogenetic analyses. Current methods for single-cell DNA sequencing typically require a whole genome amplification (WGA) step to yield enough DNA for sequencing. WGA is widely recognized to introduce technical artifacts including allelic dropout, amplification bias and amplification errors leading to false negative and false positive genotype predictions [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. However, while WGA may introduce amplification errors, which in turn may result in false positive variant calls, amplification errors will most likely affect only one cell because of the low likelihood that exactly the same error arises in more than one WGA reaction. Error rates in WGA have been estimated to correspond to one error per 10<sup>5</sup>–10<sup>6</sup> bases in multiple displacement amplification (MDA) and three errors per 10<sup>4</sup> bases in multiple annealing and looping-based amplification cycles (MALBAC) [<xref ref-type="bibr" rid="CR7">7</xref>]. A more abundant source of false positive variant calls in whole genome sequencing data results from failed realignment and the limitation of using a reference genome with respect to the genome of the donor, giving rise to 1 error in 10–15 kb in raw variant calling output [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. The typical effect of these alignment artifacts is that a locus may be covered by reads originating from multiple locations in the genome, for instance due to paralogous sequences, structural variants that are not present in the reference genome, or a location in low-complexity regions [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. While it is recommended to discard variant calls present in regions in which alignment artifacts occur [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>], it can be extremely difficult to detect their presence just based on the reads of a given cell. Somatic mutations in normal, non-malignant, cells are generally estimated to be infrequent, corresponding to approximately three somatic mutations per cell division [<xref ref-type="bibr" rid="CR2">2</xref>]. Thus, the expected number of false positive variant calls far exceeds the predicted number of true somatic mutations. Moreover, expected observations in WGA data are sites covered by reads originating from only one of the two alleles, due to allelic dropout [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Sites displaying reads originating from only one allele may result in false negatives if dropout occurs only for the mutated allele. Taken together, alignment artifacts, amplification errors, and allelic dropout result in false positive variant calls and incorrect genotype predictions, hampering the use of variant calling to define phylogenetic relationships at the single-cell level [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par14">In order to address artifacts in whole genome sequencing data from related cells, we developed a computational strategy for the unsupervised discovery of somatic single nucleotide variants (sSNVs) in single cells. Accurate genotyping of the individual single cells is achieved independently of the global rate of allelic dropout. Conbase is a multistep algorithm that confirms the allelic origin of bases through read phasing, by using the abundant signal from germline single-nucleotide variants (gSNVs) across the genome. The discovery of sSNV sites is based on analysis of observed haplotype concordance within individual single cells, across the population of cells and in an unamplified bulk sample. By further exploiting the phasing information, locus-specific allelic dropout is determined per sample individually, enabling exclusion of false negative genotypes resulting from dropout of the mutated allele. Thus, Conbase is an ideal tool for detecting mutations in closely related cells from the same individual. However, it is not designed for the analysis of unrelated cells that do not share any somatic mutations.</p>
    <p id="Par15">We evaluate the performance of Conbase on simulated data and two different real datasets containing single-cell DNA libraries from healthy human cells with known phylogenetic relationships prepared using different WGA techniques. For comparative reasons, we evaluate the performance of three additional methods for variant calling in single cells, including Monovar [<xref ref-type="bibr" rid="CR4">4</xref>], SCcaller [<xref ref-type="bibr" rid="CR5">5</xref>], and Linked Read Analysis (LiRA) [<xref ref-type="bibr" rid="CR11">11</xref>]. Monovar leverages data across a single-cell dataset to detect sSNV sites and predicts the presence or absence of mutations in individual samples. This is done by modeling the effects of errors arising from WGA and assuming that data from different loci are independent. SCcaller models amplification bias using read depth observations in gSNV sites to estimate likelihoods that a variant call is an artifact or a sSNV. SCcaller calls variants independently per sample and does not predict the absence of mutations in unmutated samples. Like Conbase, LiRA utilizes read phasing to correct for errors and allelic dropout. In contrast to Conbase and Monovar, and in accordance with SCcaller, LiRA does not perform joint variant calling across the population of cells. While read phasing, as used by Conbase and LiRA, can enable lower false discovery rate (FDR) and higher specificity, it comes with the cost of only enabling analysis of bases in proximity to gSNVs, whereas SCcaller and Monovar has the potential to detect sSNVs in all bases covered by reads. It is worth noting that LiRA and SCcaller only predicts the presence of variants in cells, while absence of a variant (the ancestral, unmutated state) is conflated with missing prediction. In contrast, Conbase and Monovar predict both mutated and unmutated states of cells. Information about the absence of somatic mutations in unmutated cells in a dataset is required for many downstream applications for single-cell genomics, including phylogenetic analysis and high-resolution lineage tracing at the single-cell level.</p>
    <p id="Par16">In summary, we demonstrate the effectiveness of Conbase for identifying true sSNVs in single-cell DNA sequencing libraries exhibiting varying degrees of allelic dropout, generated from biologically relevant populations of human cells. We believe that Conbase will be an increasingly valuable tool for applications ranging from phylogenetic analysis of single eukaryotic cells on the basis of acquired sSNVs to the characterization of the mutational landscape of single cells in healthy and diseased tissues.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of Conbase variant calling</title>
      <p id="Par17">Allelic dropout, amplification errors, and alignment artifacts can result in false negative and false positive genotype calls, respectively (illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Conbase aims to circumvent these problems by integrating phasing and analysis of observed haplotype concordance during variant calling (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S1). Phasing putative sSNVs to gSNVs allows for the determination of maternal or paternal origin of variants, because true sSNVs are expected to be observed only on either the maternal or the paternal allele in the population of cells. The allele that harbors a variant in mutated samples is here defined as the informative allele. The informative allele is distinguished from the non-informative allele by the base observation in gSNVs present in the same sequenced molecule (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S1). The genotypes of samples that only display reads originating from the non-informative allele are unknown (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S1). False negative variant calls, resulting from allelic dropout, are eliminated by requiring that a sample have reads originating from the informative allele in order to be assigned a genotype (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S1). False positive variant calls result from amplification errors and systematic errors, including alignment artifacts. These are to a large extent excluded by analyzing multiple aspects of observed data during variant calling and genotyping, including monitoring observed haplotypes in putative sSNV loci (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S1), maximal expected read depth in an unamplified bulk sample, and the density of mismatches against the reference genome in the region in which variant calls are present (“<xref rid="Sec10" ref-type="sec">Methods</xref>” section: “<xref rid="Sec11" ref-type="sec">Algorithm description</xref>” and “<xref rid="Sec15" ref-type="sec">gSNV filtering</xref>”). The fraction of the genome that can be phased by gSNVs depend on the frequency and distribution of gSNVs in the genome of the donor, as well as on the average insert size of the single-cell sequencing libraries (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S2). With an average sequencing library of 650 bp, ~ 50% of the genome can be phased by Conbase (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S2). LiRA only takes gSNVs that are present in dbSNP into account; hence, the phasable proportion for LiRA is slightly lower (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Since Monovar and SCcaller are not dependent on read phasing, these methods have the advantage of enabling detection of sSNVs in all bases covered by reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, c). Like Monovar, Conbase utilizes data from multiple samples in a dataset to perform joint variant calling, and both these methods predict the absence of mutations in unmutated samples, in contrast to SCcaller and LiRA that only predicts the mutated state and does not distinguish missing data from unmutated states (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). In contrast to the other three methods, Conbase only calls clonal somatic variants (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c); hence, it requires the presence of a mutation in at least two cells. Different features of the methods included in our comparative analyses are summarized in Fig. <xref rid="Fig1" ref-type="fig">1</xref>c.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Somatic mutations are present in a subset of a population of cells and can be identified by DNA sequencing of whole genome amplified single cells. WGA may result in allelic dropout, which in turn may result in false negative variant calls if dropout has occurred of the mutated allele. False positive variant calls may arise from amplification errors or alignment artifacts among molecules with high sequence similarity, resulting in conflicting haplotype observations. Conbase circumvents these problems by determining locus-specific allelic dropout individually per sample and analyzes concordance of the observed haplotypes across the cell population. <bold>b</bold> The percentage of genomic positions that are analyzable by Conbase, Monovar, SCcaller, and LiRA. Genomic positions analyzable for Monovar and SCcaller were defined as the fraction of bases covered by at least one read in an unamplified bulk sample sequenced at 40x coverage. Genomic positions analyzable for Conbase and LiRA were defined as the fraction of unique genomic positions present within 650 bp of gSNVs. <bold>c</bold> Overview of some features of Conbase, Monovar, SCcaller, and LiRA</p></caption><graphic xlink:href="13059_2019_1673_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Performance evaluation on simulated data</title>
      <p id="Par18">We first evaluated the performance of the tested methods using simulated datasets. The advantage of using simulated data generated from a statistical model is that we control the important parameters, which allows us to properly estimate relevant statistics. However, a problematic issue is how to design a generative model that reasonably well reflects biological reality. Here, we simulated data from a model allowing us to control the proportion of two main causes for errors when calling clonal somatic variants in single-cell whole genome sequencing data: errors from alignment artifacts (EAL) and allelic dropout. To address the problem of biological reality, we based our simulation model on loci, reads, and coverage distributions in bulk and single-cell data obtained from a CD8+ T cell donor and a primary human fibroblast donor, later used in our analyses of experimental data. For each set of simulation experiments, we performed two variants with respect to coverage distribution. In our main variant, we used the empirical coverage distributions observed in single cells, to simulate data exhibiting amplification bias. To also investigate the impact of an even coverage distribution, our second variant used a flat coverage of 30 reads per site, representing optimal data quality with uniform amplification on both alleles in all loci. In the simulations, we focused on sSNV sites with phased data available. As noted above, methods based on phasing, including Conbase and LiRA, will fail to predict sSNVs that are not present in the same read or read pair as at least one gSNV, whereas Monovar and SCcaller has the potential of calling variants in all genomic positions covered by reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). This means that the sensitivity for variant calling, as defined below, would be lower if unphased data were included, while it would likely be unaffected for Monovar and SCcaller. Moreover, it is reasonable to assume that the specificity and FDR for all methods would not deviate substantially from those estimated on the phased data.</p>
      <p id="Par159">We performed two separate experiments testing different prediction targets, first focusing on the detection of clonal mutations across a population of cells and secondly on correct genotyping in each individual site. In our first experiment, we investigated the effect of EAL in combination with allelic dropout, on the correct and incorrect classification of loci as clonal sSNVs in a population of cells. We therefore simulated a population of cells consisting of two clones with 10 cells each and a set of loci (<italic>n</italic> = 306) comprising sSNV sites as well as an increasing fraction of sites that were homozygous for the reference allele and affected by EAL. In the sSNV sites, the true genotype for all cells of a randomly selected clone was heterozygous, representing a clonal sSNV, and all cells in the other clone were homozygous for the reference allele, representing the ancestral, unmutated state. No homozygous sSNVs were included in the simulations testing the accuracy of variant calling, because of the low likelihood that the same mutation occurs on both alleles in a diploid genome. The sites that were homozygous for the reference allele represent positions harboring the ancestral, unmutated state.</p>
      <p id="Par190">Variant calling was performed on the simulated read data using Conbase, Monovar, LiRA, and SCcaller to obtain classification of the loci as clonal sSNVs, defined as sites in which at least two cells shared a variant. Sensitivity, specificity, and FDR was computed for each method under varying degree of EAL and dropout. The results show that Conbase, Monovar, and LiRA performs comparably in terms of sensitivity to detect sSNV sites, while the sensitivity of SCcaller is lower (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3a). When evaluating the accuracy of variant calling in data exhibiting even read depth coverage, we found that the sensitivity of SCcaller was substantially improved, indicating that data quality affects the sensitivity of SCcaller (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3b). The sensitivity, determined for SCcaller and Monovar in this simulation, correspond well with findings presented in another study comparing these methods [<xref ref-type="bibr" rid="CR5">5</xref>]. Conbase outperforms Monovar, SCcaller, and LiRA in terms of the specificity to distinguish artifacts, except when the dropout probability is close to 1, in which case all methods approach a specificity of 0.5 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3c). At low dropout probability, LiRA enables detection and exclusion of artifacts resulting from EAL, but its specificity then deteriorates rapidly with increasing dropout probability (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3c). For all tested methods, except for Conbase, FDR increases linearly with EAL. Conbase consistently achieves very low FDR except at extremely high dropout probability (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3d).<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold>–<bold>c</bold> The accuracy of variant calling was evaluated for Conbase, Monovar, SCcaller, and LiRA, reflecting the ability of the methods to detect clonal sSNV loci a population of cells. The sensitivity (<bold>a</bold>) and specificity (<bold>b</bold>) of Conbase, Monovar, SCcaller, and LiRA to detect clonal mutations in at least two cells in simulated data at increasing dropout probabilities (pDO) at different levels of alignment artifact probabilities (pEAL). <bold>c</bold> The false discovery rate of Conbase, Monovar, SCcaller, and LiRA when detecting clonal mutations in simulated data at increasing alignment artifact probabilities (pEAL) at different levels of dropout probabilities (pDO). <bold>d</bold> The accuracy of genotyping was evaluated for Conbase, Monovar, SCcaller, and LiRA, reflecting the ability of the methods to correctly predict genotypes in each sSNV loci and each cell at increasing dropout probabilities (pDO). In each simulation, representing one bar, the true genotype in 50% of the samples were heterozygous, representing samples harboring a sSNV. The remaining samples were homozygous for the reference allele, representing the ancestral unmutated state</p></caption><graphic xlink:href="13059_2019_1673_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par19">In the second experiment, we focused on the accuracy of the tested methods to correctly predict genotypes in individual cells in sSNV sites. We therefore simulated only sSNV loci without EAL, but with varying degree of allelic dropout, and generated reads from these. Here, we also simulated a population of cells consisting of two clones with 10 cells each with mutations occurring in one of the clones in the same manner as described above, but focused on extracting genotype prediction statistics from each individual site in each cell. Again, no homozygous sSNVs were included in the simulations, due to the low likelihood that the same mutation occurs on both alleles in a diploid genome. Conbase, Monovar, SCcaller, and LiRA were applied to the simulated data, and we recorded their classification of loci in individual cells as heterozygote (presence of a sSNV), homozygote (ancestral, unmutated state), or no prediction. We next evaluated the number of correctly and incorrectly predicted genotypes per site (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). In Conbase, Monovar, and LiRA output, we observe similar distributions of correctly predicted heterozygous genotypes, whereas SCcaller predicts a lower number of true heterozygotes. Notice that SCcaller and LiRA only predicts the presence of mutations, and therefore, no predictions are observed in the samples with simulated homozygous genotypes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). Monovar detects a higher number of true homozygotes, as compared to Conbase (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). However, Monovar also predicts a higher number of false homozygotes as compared to Conbase (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). The false homozygotes predicted by Monovar are to a large extent mutated samples with dropout of the mutated allele. This scenario is distinguished from true homozygotes by Conbase, which makes no predictions in samples exhibiting dropout of the mutated allele. Also here, we performed a second variant of the simulation using even read depth coverage, in which all four methods perform better, in particular SCcaller (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3e).</p>
    </sec>
    <sec id="Sec5">
      <title>Performance evaluation on real data obtained from in vitro expanded human fibroblasts</title>
      <p id="Par20">To evaluate the performance on real data, we first made time-lapse recordings of primary human fibroblasts as they divided on polymer slides allowing us to subsequently identify and isolate single fibroblasts with known phylogenetic relationships by laser capture microscopy. We isolated 11 cells derived from clone 1, three cells derived from clone 2, and two unrelated cells. All these single cells were whole genome amplified by MALBAC [<xref ref-type="bibr" rid="CR12">12</xref>]. The single-cell libraries were sequenced to obtain an average of 385 million reads per single cell, corresponding to approximately 12x coverage of the human genome on unamplified genomic DNA (Additional file <xref rid="MOESM3" ref-type="media">2</xref> Table S1). We first estimated amplification efficiency relative to allelic dropout and locus dropout, by analyzing the fraction of genomic bases covered by reads and the fraction of gSNV sites covered by reads originating from the maternal allele, the paternal allele or from both alleles (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S4a–c). On average, 26% of genomic bases were covered by at least one read, with a 70% allelic dropout rate at the covered gSNV sites (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S4b, c). Although varying degrees of allelic dropout has been reported for MALBAC data [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], the rates of allelic dropout observed in this experiment is likely to reflect the fact that the cells were harvested by laser capture microscopy, and thus, part of the genomic material may be lost in the isolation process.</p>
      <p id="Par21">We next performed variant calling on bulk genomic DNA and single fibroblast libraries using FreeBayes [<xref ref-type="bibr" rid="CR13">13</xref>] and computed the fraction of sites in which an alternative genotype was observed in single-cell libraries but not in the bulk sample (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S4d). These sites include a combination of true sSNVs and false positive variant calls. The unrealistically high number of variants uniquely called in single cells (551,971–1,220,408 unique variant calls per single cells) is suggestive of the presence of a large number of false positive variant calls. This is expected as MALBAC is reported to have a relatively high error rate due to the lack of proofreading by the <italic>Bst</italic> polymerase in the initial amplification steps, coupled with exponential amplification in the final steps of the protocol [<xref ref-type="bibr" rid="CR12">12</xref>]. Moreover, variant callers designed for bulk data, including FreeBayes, do not account for the unique properties of WGA-amplified single-cell data and may result in inaccurate SNV calling [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
      <p id="Par22">We next performed variant calling with Monovar and Conbase, which are designed to account for the errors and biases in WGA single-cell data. To estimate the FDR of these methods, we computed the fraction of sites in which the distribution of genotypes was biologically implausible in our clonal populations of fibroblasts. True sSNVs are expected to be shared by closely related clonal cells and not distributed between cells of different clones. Under the assumption that the probability of two mutations occurring independently in the same site twice is extremely low [<xref ref-type="bibr" rid="CR14">14</xref>], we defined implausible genotype distributions as sites where a variant call was observed in both clones and at least one cell displayed the reference genotype. Variants that are restricted to a single clonal population represent a biologically plausible genotype distribution. Variants observed in both clones, without observing individual cells harboring the reference genotype, may however be gSNVs incorrectly interpreted as sSNVs due to the absence of variant supporting reads in the bulk sample since bulk sequencing data may also suffer from allelic dropout due to insufficient sequencing coverage. However, requiring that at least one single-cell sample harbors the reference genotype increases the confidence that the site is not a gSNV; hence, only sites where at least one sample had the reference genotype were included in the analysis. FDR was estimated as the number of sites displaying implausible genotype distributions through the total number of sites displaying plausible and implausible genotype distributions. On raw Monovar output, we applied the recommended filtering [<xref ref-type="bibr" rid="CR4">4</xref>], including removal of sites overlapping with raw variant calling output of a bulk sample (obtained by FreeBayes), as well as sites present within 10 bases of another site. Parsing putative sSNVs from raw Monovar output yielded an unrealistically high number of sites and a high FDR (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2).<fig id="Fig3"><label>Fig. 3</label><caption><p>Biologically plausible and implausible distributions of genotypes called by Monovar and Conbase in clonal populations of fibroblasts. Values above bars represent false discovery rates. Biologically plausible genotype distributions were defined as sites where the variant call is exclusively observed within cells belonging to the same clone. Biologically implausible genotype distributions were defined as sites where the variant call is observed within both clones and at least one cell displayed the reference genotype</p></caption><graphic xlink:href="13059_2019_1673_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par23">To obtain only high confidence genotypes from Monovar output, we applied filters for the genotype quality (GQ). Applying quality filters is a common approach aimed at removing errors in variant calling output [<xref ref-type="bibr" rid="CR15">15</xref>]. The GQ score is calculated for each predicted genotype, reflecting the probability that the genotype prediction is correct. To compute FDR, we again analyzed sites where a variant call was observed in multiple cells and at least one cell was predicted to be unmutated. Genotypes in individual samples which did not pass the evaluated GQ score cutoffs were defined as unknown. When applying GQ filters, &gt; 99% of sites were filtered out, as compared to when no GQ score filters were applied (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2). However, the FDR was comparable regardless of filters for GQ and read depth (DP), when requiring for a variant to be called in &gt; 3 samples (Fig. <xref rid="Fig3" ref-type="fig">3</xref>, Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2). Following variant calling with Conbase, no further quality filtering is required and called genotypes can be used directly in downstream analysis. Also for Conbase output, we computed FDR by analyzing sites where a variant call was observed in multiple cells and at least one cell was predicted to be unmutated. Here we found that Conbase achieved low FDR, when a variant was required to be observed in &gt; 3 cells (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). While the FDR is higher for Monovar compared to Conbase, Monovar detects more sites in absolute numbers when no threshold for genotype quality was applied. This may be explained by the fact that Monovar is not restricted to calling variants in proximity to gSNVs and can thereby detect sSNVs in a larger fraction of the genome as compared to Conbase. Of note, sites displaying a plausible distribution of genotype predictions can occur by chance when genotype data is missing for multiple samples in the dataset due to dropout, as is the case for this dataset.</p>
    </sec>
    <sec id="Sec6">
      <title>Performance evaluation on real world data obtained from in vivo expanded human CD8+ T cells</title>
      <p id="Par24">We next generated a dataset using MDA, a WGA method using the proofreading polymerase Phi29, which is associated with lower error rate and increased amplification efficiency [<xref ref-type="bibr" rid="CR6">6</xref>]. In accordance with MALBAC data, varying degrees of allelic dropout has been reported for MDA data [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. To evaluate Conbase on data generated from cells harvested directly from healthy human subjects, we examined CD8<sup>+</sup> T cell clones that had been expanded in vivo after yellow fever virus vaccination (YFV-17D). Clonally related cells were defined by sequencing of genomically rearranged T cell receptor (TCR) genes. Vaccination triggers the activation of individual naive T cells in lymphoid organs, leading to their expansion to large numbers of effector cells in the lymphoid tissues, which subsequently enter the circulation where they are detectable for at least several months after vaccination [<xref ref-type="bibr" rid="CR17">17</xref>]. Expanded virus-specific CD8<sup>+</sup> T cells can be identified and sorted from peripheral blood by labeling cells with fluorescently labeled dextramers which are streptavidin-linked HLA Class I complexes bound to a single viral epitope (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S5) [<xref ref-type="bibr" rid="CR18">18</xref>]. For this study, we selected CD8<sup>+</sup> T cells which had responded to a previously identified HLA-B7-restricited viral epitope for YFV (HLA-B7:RPIDDRFGL), which we observed to exhibit a reduced diversity of responding cells relative the dominant HLA-A2 epitope [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Single CD8<sup>+</sup> T cells sorted by fluorescence-activated cell sorting (FACS) from longitudinal peripheral blood samples were amplified by MDA and subsequently screened by PCR against either the TCR α and/or β chains to identify clonally related T cells sharing the same TCR. Libraries from two clones, clone A (seven single cells) and clone B (nine single cells), as well as two unrelated cells (UR) were subjected to whole genome sequencing (Additional file <xref rid="MOESM3" ref-type="media">2</xref> Table S1). As compared to MALBAC data, the percentage of bases covered by reads was higher in MDA data and the error rate was lower (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S6).</p>
      <p id="Par25">For this dataset, we evaluated the performance of Conbase with Monovar and LiRA. When running SCcaller on this dataset, no variant calls passed the defined confidence thresholds recommended to use for SCcaller. This finding is explained by the high amplification bias observed in this dataset, which prevents SCcaller to distinguish true sSNVs from artifacts. Following variant calling with Conbase, no further quality filtering is required, although cutoffs for read depth were evaluated (Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2). For Monovar output, we attempted a range of cutoffs for DP and GQ, and the required number of cells in which a variant call was observed, in order to obtain putative sSNVs from Monovar output. Decreased DP cutoffs resulted in increased number of variant sites (Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2). In agreement with results from fibroblast data, applying no filters for GQ resulted in an unrealistically high number of variant sites. When applying GQ cutoffs on Monovar output, &gt; 99% of sites were filtered out, as compared to applying no cutoffs for GQ (Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2). In contrast to Conbase and Monovar, LiRA does not perform genotyping across the cell population, and variants are called individually per sample. To identify putative clonal somatic variants, we merged output from the individual samples and required that a somatic variant (classified as “PASS” in LiRA output) was observed in &gt; 1 sample (Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2).</p>
      <p id="Par26">To investigate if variants called by Conbase, Monovar, and LiRA enable separation of clonal populations of cells, we performed unsupervised hierarchical clustering using shared genotype calls in sSNV sites to define distances between cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Hierarchical clustering based on genotypes called by Conbase demonstrated unambiguous identification of each T cell clonal population, regardless of read depth cutoffs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S7). For Monovar output, we attempted a range of combinations of filters to parse putative sSNVs from the vcf output. However, no combination of cutoffs for DP or GQ, or when requiring for a variant to be present in increasing number of samples, enabled separation of the clonal populations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S8). The somatic variants predicted by LiRA enabled separation of the clonal populations by hierarchical clustering (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S9). However, the total number of sites passing filters was smaller in LiRA output compared to the number of sites called by Conbase with a read depth cutoff ≥ 2 and ≥ 5 (Additional file <xref rid="MOESM4" ref-type="media">3</xref> Table S2).<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold>–<bold>c</bold> Hierarchical clustering using genotypes called by Conbase, Monovar, and LiRA to define distances between cells. The obtained clusters are compared to the known clonal relations, shown below each plot. <bold>d</bold> The total number of clonal variant calls, defined as a call being present in at least two cells, obtained by Conbase, LiRA, and Monovar (GQ ≥ 5)</p></caption><graphic xlink:href="13059_2019_1673_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par27">To estimate FDR in the T cell dataset, we computed the fraction of sites displaying a biologically plausible and implausible distribution of genotypes in our clonal populations. Estimating FDR for clonal somatic variant calling in this way is only possible in output from Conbase and Monovar, since LiRA does not predict the absence of mutations in unmutated samples. The fraction of sites displaying biologically implausible genotype distributions in the T cell clones was small in Conbase output (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). By default, Conbase filter sites in which at least one sample display conflicting genotypes, with support for both a mutated and an unmutated genotype. When allowing samples with conflicting genotypes in the final output from Conbase, we observed that 90% of sites in which at least one sample displayed conflicting genotypes also displayed a biologically implausible distribution of genotypes (data not shown). In accordance with observations in the fibroblast dataset, we found that, in absolute numbers, Monovar detects more sites than Conbase when no thresholds for GQ is applied (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b) and that Conbase achieves a low FDR while the FDR is very high for Monovar, regardless of a range of evaluated sets of filters on variant calling output (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a–d). These findings support the notion that there is a tradeoff between FDR and the absolute number of detected sSNVs.<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold>–<bold>d</bold> Biologically plausible and implausible distributions of predicted genotypes in putative sSNV sites called by Conbase and Monovar in clonal populations of T cells. Values above bars represent false discovery rates. Biologically plausible genotype distributions were defined as sites where the variant call is exclusively observed within cells belonging to the same clone. Biologically implausible genotype distributions were defined as sites where the variant call is observed within both clones and at least one cell displayed the reference genotype</p></caption><graphic xlink:href="13059_2019_1673_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Validation of sSNVs identified by Conbase</title>
      <p id="Par28">We validated a selection of the sSNVs called in T cells by Conbase, through PCR screening of additional MDA libraries generated from single CD8<sup>+</sup> T cells isolated in parallel and determined to be clonally related by TCR sequence to the cells subjected to high-coverage whole genome sequencing. As a control, we included single CD8<sup>+</sup> T cells identified as a third clonal population (Clone C, Additional file <xref rid="MOESM3" ref-type="media">2</xref> Table S1) that was not included in the whole genome sequencing experiment. We designed PCR primers flanking regions containing both gSNVs and sSNVs in order to determine whether allelic dropout or amplification bias led to loss of informative alleles in our PCR products. Gel-purified PCR amplicons from each single cell were subsequently subjected to Sanger sequencing to establish the presence or absence of the informative allele, as determined by the gSNV, and the presence of absence of the sSNV called in whole genome sequencing data. Here, we could confirm the presence of sSNVs in cells belonging to the same clones, but never in unrelated cells, providing definitive evidence that the sSNVs called by Conbase represent true somatic mutations in each clonal lineage in vivo (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). In the Sanger results, we observed two sSNV sites (3:106210015 and 8:55449214), displaying heterogeneity within the clones, with some cells harboring the reference genotype and some cells harboring the alternative genotype. This could indicate that these two mutations appeared later during clonal expansion.<fig id="Fig6"><label>Fig. 6</label><caption><p><bold>a</bold> Genotype predictions by Conbase in 11 sSNV sites. Primers spanning sSNVs and gSNVs were designed against these sites for PCR screening and Sanger sequencing. <bold>b</bold>, <bold>c</bold> Sanger sequencing results for the selected sSNV sites in amplified DNA from single CD8+ T cells identified by TCR sequencing as belonging to clones A, B, or an unrelated clone C</p></caption><graphic xlink:href="13059_2019_1673_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par29">Conbase is to our knowledge the first available software capable of leveraging phased read data from multiple samples in a dataset, thereby improving confidence in variant calls and genotype predictions in single-cell data. Variant calling and genotyping are based on analysis of observed haplotype concordance, enabling exclusion of false positive variants resulting from alignment artifacts and WGA errors. False negative genotype calls are eliminated through analysis of locus-specific allelic dropout, determined individually per sample. As such, Conbase analysis is not dependent on global estimates of allelic dropout, and genotypes can be predicted in samples exhibiting high rates of allelic dropout. The strength of Conbase is that it considers compatibility among related cells in a population and at the same time uses read phasing. This makes Conbase less sensitive to errors, including PCR, base calling, and alignment artifacts, and genotypes can be predicted at low read depth. One limitation of Conbase is that read phasing restricts the analysis to bases present in the same read or read pair as heterozygous gSNVs, corresponding to ~ 50% of the genome with an average insert size of the sequencing library corresponding to 650 bp.</p>
    <p id="Par30">We have compared Conbase to Monovar, SCcaller, and LiRA, which are variant callers designed to account for errors and biases in single-cell DNA sequencing data [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. On simulated phased data, comprising sSNV sites displaying both heterozygous (mutated) and homozygous (unmutated) states over the population of cells, Conbase achieved the best performance overall of the tested methods. On simulated data displaying amplification bias, Conbase, Monovar, and LiRA performed comparably in terms of sensitivity, whereas SCcaller performed worse (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). The sensitivity of SCcaller was substantially improved in simulated data exhibiting even read coverage (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3b).</p>
    <p id="Par31">In simulations, Conbase outperformed Monovar, SCcaller, and LiRA in terms of specificity and FDR, displaying superior ability to detect and exclude artifacts (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, c, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3c, d). These results are supported by our analysis of real data of clonal populations of cells, where FDR could be estimated using the biological plausibility of the predicted genotype distribution for a detected sSNV among clones. Since only Conbase and Monovar predict both mutated and unmutated genotype states, FDR in clonal somatic variant calling on real data was only computed for these two methods. While Monovar detected more sites in absolute numbers, this was achieved at the expense of a substantially higher FDR (Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig5" ref-type="fig">5</xref>). The high FDR estimated for Monovar in our simulations and real data is supported by findings reported in another study [<xref ref-type="bibr" rid="CR5">5</xref>]. The low FDR achieved by Conbase can likely be attributed to its ability to effectively detect and filter false positive variant calls through a combination of read phasing and joint variant calling.</p>
    <p id="Par32">In real data, variants predicted by Conbase and LiRA enabled separation of clonally related populations of single cells from human donors, indicating that the called sSNVs represent true somatic mutations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). Of these two methods, Conbase provided better robustness than LiRA by detecting a higher number of sSNV sites. In sheer numbers, Monovar detected more sites than Conbase and LiRA when no thresholds for GQ were applied (Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S7–S9). However, the genotypes called by Monovar did not enable separation of the clonal populations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S8). Applying filters for GQ on Monovar output did not improve separation of the clonal populations and, moreover, resulted in fewer number of sites passing filters, in comparison to Conbase and LiRA (Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S7–S9). The failure to identify the clonal populations using genotypes predicted by Monovar may be attributed to the fact that the distinction between true sSNVs and false positives is primarily based on modeling amplification errors, but does not directly account for the extent of ambiguous read mapping (EAL) during variant calling and genotyping. Conversely, the ability of Conbase and LiRA to call clonal variants that enable separation of the clonal cell populations may be explained by the use of read phasing, which is employed by both of these methods and enable exclusion of variants supported by reads derived from discordant alleles. It was surprising that LiRA, while achieving identification of sSNVs that enable separation of clonal populations in real data, exhibited a high FDR in simulated data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3d). In theory, analysis of the concordance of phased gSNVs provided by SHAPEIT2 [<xref ref-type="bibr" rid="CR20">20</xref>] and implemented in LiRA should enable exclusion of artifacts present in regions where alignment artifacts occur. One possible explanation is that our simulations could not fully represent the complexity of the effects of alignment artifacts, given that the distribution and frequency of structural variation and low-complexity DNA in the human genome is not well characterized [<xref ref-type="bibr" rid="CR21">21</xref>]. Possibly, our simulations failed to provide phasing information over larger genomic regions, required for LiRA to detect alignment artifacts in simulated data.</p>
    <p id="Par33">Further investigating the variant calling with Conbase, we were able to experimentally validate that identified sSNVs represented true somatic mutations by PCR screening of additional single cells sorted from the same donor and identified as being clonally related to the two clonal populations used for whole genome sequencing (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). We did not detect these variants in any cells isolated in parallel from a third unrelated clone. Indeed, we believe that this approach will provide a useful platform for expanding the analysis to hundreds or thousands of cells using targeted screening after identification of high confidence mutations in single-cell whole genome sequencing data by Conbase.</p>
    <p id="Par34">Lastly, it is interesting to compare how well the different methods predict actual genotypes in different cells in simulated sSNV sites (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S3e). Conbase, Monovar, and LiRA performed comparably in terms of correctly predicting heterozygous mutated genotypes, whereas SCcaller predicted fewer true heterozygous mutated genotypes in data exhibiting amplification bias. However, while Monovar detected a higher number of true homozygous unmutated genotypes than Conbase, this was achieved at the expense of a higher number of incorrectly predicted homozygous unmutated genotypes. Notably, Conbase predicted no false unmutated homozygotes. SCcaller and LiRA only predicted the presence of variants, and therefore, no correct or incorrect predictions in homozygous samples were made by these methods. The choice of only predicting the presence of variants conflates homozygous (unmutated) states with failed predictions (missing data) and is a serious drawback for a number of applications, notably phylogenetic analysis.</p>
    <p id="Par35">It is clear that sSNV calling is a balance between the number of variants called and the proportion of false discoveries. For example, Monovar, which do not integrate read phasing, predicts substantially more sSNV sites in absolute numbers than do Conbase (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). However, this is done at the expense of a very high FDR and a very low specificity, meaning that there is a large probability that a predicted variant is erroneously called. Conbase uses phasing information and joint variant calling across a population of related cells to address the FDR problem and calls variants with very low probability of being wrong, but the total number of predicted variants are fewer than that of Monovar. It should be emphasized that Conbase is designed to be used on data from related cells and that it requires a variant to be present in at least two of these cells. LiRA also uses phasing information and provides a certain amount of clonal variants, but suffer from the inability to predict unmutated genotypes. A user’s choice of which variant caller to use will depend on the application of the resulting data. When high-quality variant calls are more important than the sheer number of calls, for example, as in phylogenetic analysis and high resolution lineage tracing at the single-cell level, Conbase is likely to be the best choice. If the aim requires a large total number of variant calls regardless of the abundance of false calls or if the data at hand comprise a single cell or a set of unrelated cells, then Conbase may not be the optimal choice.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par36">We present Conbase, a new software for somatic variant calling in single-cell data. We show that by exploiting phased read data in multiple cells, Conbase retrieves confident variant calling with low false discovery rate that provide more robustness in downstream analyses.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Algorithm description</title>
      <p id="Par37">Conbase requires whole genome sequencing data from related WGA-amplified single cells and an unamplified bulk sample to predict sSNV sites and genotypes. The identification of clonal somatic variants is unsupervised, such that no prior information about clonal relationships is provided. Conbase takes three inputs: single cell and bulk bam files, a human reference genome in fasta format, and gSNV coordinates to be used for phasing. The gSNV coordinates and gSNV base observations are obtained from vcf output previously generated from variant calling in a bulk sample by FreeBayes (or another variant caller). The analysis is split up in two subprograms: stats and analyze. Stats outputs a json-file with unfiltered variant calls, which is used as input to analyze. The output of analyze are phased filtered variant calls. Conbase variant calling is based on assumptions associated with expected observations in true sSNV sites, including concordance of base observations in independent positions in reads and read pairs within samples and across the dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S1). The assumptions are coded as adjustable parameters with values reflecting how much read observations may deviate from the expected attributes of a true variant site. The parameter values generating the data presented in the current report are specified in parentheses in the algorithm description below.</p>
    </sec>
    <sec id="Sec12">
      <title>Stats</title>
      <p id="Par38">The initial step consists of identifying sites supporting an alternative (potentially mutated) base as compared to the bulk sample. This is done by only considering bases present in the same read or read pair as at least one gSNV using a BAM reader (pysam). The genomic windows in which the analysis will take place are determined by defining the longest distance upstream and downstream of each gSNV, covered by read pairs within the dataset. Because of sequencing errors, amplification errors, or alignment artifacts, more than one alternative base may be observed in the same position, despite a diploid genome. In order to determine the most probable alternative base in a site, we utilize the accumulative information given by all qualified samples in the following way:</p>
      <p id="Par39">Let <italic>R</italic> be the reference base in the bulk and let <italic>b</italic> ∈ <italic>B</italic> = {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T</italic>} ∖ {<italic>R</italic>}. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {N}_b^s $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq1.gif"/></alternatives></inline-formula> be the read depth of <italic>b</italic> in sample <italic>s</italic> at a given position and let and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {N}_R^s $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq2.gif"/></alternatives></inline-formula> be the read depth of <italic>R</italic>.</p>
      <p id="Par40">Let <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {V}_b^s $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:msubsup><mml:mi>V</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq3.gif"/></alternatives></inline-formula> define the voting result for a base <italic>b</italic> by a sample <italic>s</italic></p>
      <p id="Par41"><disp-formula id="Equa"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {V}_b^s=\left\{\begin{array}{lll}\kern0.5em 1&amp;\ if\ \frac{N_b^s}{N_R^s}\ge \alpha, {N}_b^s+{N}_R^s\ge \beta &amp; \kern0.5em (1)\\ {}&amp; &amp; \\ {}\kern0.5em 1&amp;\ if\ \frac{N_b^s}{N_R^s}&lt;\alpha, {N}_b^s\ge \beta &amp; \kern0.5em (2)\\ {}&amp; &amp; \\ {}\kern0.5em 0&amp;\ otherwise\end{array}\right. $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msubsup><mml:mi>V</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:mfrac><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mfrac><mml:mo>≥</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>β</mml:mi></mml:mtd><mml:mtd><mml:mspace width="0.5em"/><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:mfrac><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>β</mml:mi></mml:mtd><mml:mtd><mml:mspace width="0.5em"/><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1673_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>α</italic> (0.2) and <italic>β</italic> (10x) are parameters for variant allele fraction and total read depth, determining which samples are qualified to vote. In the first case (1), reads from two alleles are observed, displaying sufficient variant allele fraction and total read depth. In the second case (2), the variant allele fraction is not sufficient; however, the sample displays sufficient read coverage supporting the alternative base, which represents another indication for a potentially true variant since amplification bias may result in dropout of the reference base.</p>
      <p id="Par42">Let <italic>V</italic><sub><italic>b</italic></sub> be the number of samples that voted for an alternative base <italic>b</italic>. If <italic>V</italic><sub><italic>b</italic></sub> &gt; 0, we may define the most probable alternative base <italic>A</italic> as</p>
      <p id="Par43">
        <disp-formula id="Equb">
          <alternatives>
            <tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ A=\left\{\begin{array}{ll}\kern0.5em {argmax}_b\left({V}_b|\forall b\in B\right)&amp; \kern3em if\ \frac{V_b}{\left|V\right|}\ge \gamma, \kern0.75em \left|V\right|\ge \varepsilon \\ {}&amp; \\ {}\kern0.5em undefined&amp; \kern3em otherwise\end{array}\right. $$\end{document}</tex-math>
            <mml:math id="M10" display="block">
              <mml:mi>A</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfenced close="" open="{">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mspace width="0.5em"/>
                      <mml:msub>
                        <mml:mtext mathvariant="italic">argmax</mml:mtext>
                        <mml:mi>b</mml:mi>
                      </mml:msub>
                      <mml:mfenced close=")" open="(" separators="|">
                        <mml:msub>
                          <mml:mi>V</mml:mi>
                          <mml:mi>b</mml:mi>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo>∀</mml:mo>
                          <mml:mi>b</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>B</mml:mi>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="3em"/>
                      <mml:mtext mathvariant="italic">if</mml:mtext>
                      <mml:mspace width="0.25em"/>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>V</mml:mi>
                          <mml:mi>b</mml:mi>
                        </mml:msub>
                        <mml:mfenced close="|" open="|">
                          <mml:mi>V</mml:mi>
                        </mml:mfenced>
                      </mml:mfrac>
                      <mml:mo>≥</mml:mo>
                      <mml:mi>γ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.75em"/>
                      <mml:mfenced close="|" open="|">
                        <mml:mi>V</mml:mi>
                      </mml:mfenced>
                      <mml:mo>≥</mml:mo>
                      <mml:mi>ε</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd/>
                    <mml:mtd/>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mspace width="0.5em"/>
                      <mml:mtext mathvariant="italic">undefined</mml:mtext>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="3em"/>
                      <mml:mtext mathvariant="italic">otherwise</mml:mtext>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1673_Article_Equb.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par44">where <italic>γ</italic> (0.9) and <italic>ε</italic> (2) define the fraction of samples required to vote for the same base and the number of samples required to vote at a given position, respectively. ∣<italic>V</italic>∣ is the number of samples that were qualified to vote.</p>
    </sec>
    <sec id="Sec13">
      <title>Analyze</title>
      <p id="Par45">The previous processing identified potential sSNV sites in near distance of gSNVs where multiple cells shared strong support for the same alternative base <italic>A</italic>. If we consider the alternative base <italic>A</italic> in the sSNV site in relation to the base observed in a gSNV site in the same read or read pair, we denote it as the following relation:<disp-formula id="Equc"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {X}_{mut}{Y}_{gsnv} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="italic">mut</mml:mi></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mtext mathvariant="italic">gsnv</mml:mtext></mml:msub></mml:math><graphic xlink:href="13059_2019_1673_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where the sSNV site <italic>X</italic><sub><italic>mut</italic></sub> either displays the same base observed in the reference genome (and the bulk sample) or the alternative base, and <italic>Y</italic> either displays the same base as the reference genome or the alternative base in the gSNV site (obtained from vcf output from variant calling in the bulk sample). For simplicity, we will further denote these relationships as <italic>RR</italic>, <italic>RA</italic>, <italic>AR</italic>, and <italic>AA</italic> where the first letter refers to the observation in the sSNV site and the second letter refers to the observation in the gSNV site (in both cases, we let <italic>R</italic> and <italic>A</italic> denote the reference and the alternative base, respectively). From here on, we will denote a given pair as a <italic>tuple</italic>. Furthermore, a tuple pair, <italic>tp</italic>, denotes the possible combination of tuples on a chromosome pair.</p>
      <p id="Par46">Considering both the maternal and paternal pair, there are only two plausible tuple pairs that could equal a true heterozygous genotype. Likewise, there is only one single type of tuple pair that constitutes a true homozygous genotype. Hence, only three tuples are relevant, namely<disp-formula id="Equd"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Heterozygous}\ \mathrm{genotype}=\left\{ RR, AA\right\},\left\{ RA, AR\right\} $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mtext>Heterozygous genotype</mml:mtext><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=","><mml:mi mathvariant="italic">RR</mml:mi><mml:mi mathvariant="italic">AA</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="}" open="{" separators=","><mml:mi mathvariant="italic">RA</mml:mi><mml:mi mathvariant="italic">AR</mml:mi></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1673_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Homozygous}\ \mathrm{genotype}=\left\{ RR, RA\Big\}\ \right. $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mtext>Homozygous genotype</mml:mtext><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=","><mml:mi mathvariant="italic">RR</mml:mi><mml:mrow><mml:mi mathvariant="italic">RA</mml:mi><mml:mo stretchy="true">}</mml:mo><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1673_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par47">Given that we expect a clonal mutation to be present in a subpopulation of the analyzed cells, we can collectively determine the expected coupling representing a true heterozygous genotype, either {<italic>RR</italic>, <italic>AA</italic>} or {<italic>RA</italic>, <italic>AA</italic>}, by analyzing tuple pairs in all the samples that qualifies for voting.</p>
      <p id="Par48">All samples that display reads covering the tuple (i.e., the reads contain the specific gSNV in mind and the sSNV) with a total read depth &gt;<italic>φ</italic> (see individual figures for the examined read depth cutoffs, Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>, and <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S7) are allowed to vote if they fulfill the following criteria: Let <italic>tp</italic><sub><italic>max</italic></sub>, <italic>tp</italic><sub><italic>min</italic></sub> be the tuple pairs with the highest and lowest depth out of the two possible tuple pairs for heterozygous positions. A sample is allowed to vote for <italic>tp</italic><sub><italic>max</italic></sub> if (i) the ratio between the read depth of <italic>tp</italic><sub><italic>max</italic></sub> and <italic>tp</italic><sub><italic>min</italic></sub> &lt; <italic>ρ</italic> (0.01) and (ii) either the ratio for the tuples in <italic>tp</italic><sub><italic>max</italic></sub> &gt; <italic>λ</italic> (0.1) or if the tuple covering the variant {<italic>AR or AA</italic>} is the maximum out of all tuples for that sample. Out of the entitled samples that voted for their local <italic>tp</italic><sub><italic>s</italic></sub>, the most probable tuple pair across all samples <italic>tp</italic><sup>∗</sup> is finalized if at least <italic>κ</italic> (see individual figures for the examined number of samples required to harbor the variant, Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>, and <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S7) samples voted and if <italic>tp</italic><sup>∗</sup> held a majority of at least <italic>ω</italic>% (90%) of the votes. If the voting samples do not manage to conclude the final tuple pair for a sSNV in connection to a specific gSNV that will dictate across all samples, the allelic origin of the alternative base is simply unknown.</p>
      <p id="Par49">By knowing the designated <italic>tp</italic><sup>∗</sup>, we also know which of the two alleles we expect to observe the variant on, either {<italic>AA</italic>} or {<italic>AR</italic>}. Consider the following: while we may jump to the conclusion of having found a variant as soon as we observe, e.g., tuple <italic>AA</italic> in a sample, if the <italic>tp</italic><sup>∗</sup> actually consists of tuples {<italic>AR</italic>, <italic>RA</italic>}, we actually know for certain that this cannot be a true variant as such observation would be contradictory. Moreover, given this <italic>tp</italic><sup>∗</sup>, if a sample only display reads supporting the tuple <italic>RA</italic>, we obviously cannot determine the genotype since RA is expected to be observed in both heterozygous and homozygous genotypes.</p>
      <p id="Par50">Let <italic>N</italic><sub><italic>x</italic></sub> be the read depth of the tuple <italic>x</italic> and <italic>N</italic><sub><italic>tot</italic></sub> the total read depth for all tuples. Consider the case when <italic>tp</italic><sup>∗</sup> = {<italic>RR</italic>, <italic>AA</italic>} and let<disp-formula id="Equf"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{llll}&amp; {d}_I^{het}&amp; =&amp; \frac{\min \left({N}_{RR},{N}_{AA}\right)}{N_{RR}+{N}_{AA}}\\ {}&amp; {d}_E^{het}&amp; =&amp; \frac{N_{RR}+{N}_{AA}}{N_{tot}}\\ {}&amp; {d}_I^{hom}&amp; =&amp; \frac{\min \left({N}_{RR},{N}_{RA}\right)}{N_{RR}+{N}_{RA}}\\ {}&amp; {d}_E^{hom}&amp; =&amp; \frac{N_{RR}+{N}_{RA}}{N_{tot}}\end{array}} $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mtable align="center" columnalign="left left left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1673_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par51">where <inline-formula id="IEq4"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {d}_I^x $$\end{document}</tex-math><mml:math id="M20" display="inline"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq4.gif"/></alternatives></inline-formula> is the (internal) ratio for the tuples and <inline-formula id="IEq5"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {d}_E^x $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq5.gif"/></alternatives></inline-formula> is the (external) ratio for a given tuple pair in relation to all of the tuples for a site from a homozygous and heterozygous perspective. These ratios will be used to determine the confidence in the allelic origin of the sSNV for a given site. The case when <italic>tp</italic><sup>∗</sup> = {<italic>RA</italic>, <italic>AR</italic>} is treated analogously.</p>
      <p id="Par52">If <italic>tp</italic><sup>∗</sup> is {<italic>RR</italic>, <italic>AA</italic>}, reads displaying <italic>A</italic> in the gSNV site is the informative allele, and reads originating from the informative allele are required for genotyping. If <italic>tp</italic><sup>∗</sup> is {<italic>RA</italic>, <italic>AR</italic>}, reads displaying <italic>R</italic> in the gSNV site is the informative allele.</p>
      <p id="Par53">Genotypes are classified as being supported by reads originating from both alleles or supported by reads originating from only the informative allele. This enables genotyping despite 100% allelic dropout, if reads originating from the informative allele are observed.</p>
      <p id="Par54">A genotype determination <inline-formula id="IEq6"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {GT}_{SNV}^s $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:msubsup><mml:mi mathvariant="italic">GT</mml:mi><mml:mi mathvariant="italic">SNV</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq6.gif"/></alternatives></inline-formula> for any of these two classes of genotypes (either supported by reads originating from two alleles or only supported by reads originating from the informative allele) for a given position in relation to a specific gSNV for a sample <italic>s</italic> will only be possible if there is a given <italic>tp</italic><sup>∗</sup> and total read depth of all tuples &gt;<italic>φ</italic> (see individual plots for the examined read depth cutoffs, Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>, and <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S7). If these initial conditions are met, <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {GT}_{gSNV}^s $$\end{document}</tex-math><mml:math id="M26" display="inline"><mml:msubsup><mml:mi mathvariant="italic">GT</mml:mi><mml:mtext mathvariant="italic">gSNV</mml:mtext><mml:mi>s</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq7.gif"/></alternatives></inline-formula> is computed as follows:<disp-formula id="Equg"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {GT}_{gSNV}^s=\left\{\begin{array}{ll}\kern0.5em {het}_{C1}&amp; \kern0.15em if\ {d}_E^{het}\ge \theta, {d}_I^{het}\ge \tau \\ {}&amp; \\ {}\kern0.5em {\mathit{\hom}}_{C1}&amp; \kern0.15em if\ {d}_E^{hom}\ge \theta, {d}_I^{hom}\ge \tau\ \\ {}&amp; \\ {}\kern0.5em {het}_{C2}&amp; \kern0.15em if\ {d}_I^{het},{d}_I^{hom}&gt;\tau, {d}_E^{het}\ge \theta, {d}_E^{hom}&lt;1-\theta \\ {}&amp; \\ {}\kern0.5em {\mathit{\hom}}_{C2}&amp; \kern0.15em if\ {d}_I^{het},{d}_I^{hom}&lt;\tau, {d}_E^{hom}\ge \theta, {d}_E^{het}&lt;1-\theta \\ {}&amp; \\ {}\kern0.5em conflict&amp; \kern0.15em if\ conditions\  met\  for\ {het}_{C1},{\mathit{\hom}}_{\mathrm{C}1}\\ {}&amp; \\ {}\kern0.5em conflict&amp; \kern0.15em if\ {tp}_s\ne {tp}^{\ast}\end{array}\right. $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:msubsup><mml:mi mathvariant="italic">GT</mml:mi><mml:mtext mathvariant="italic">gSNV</mml:mtext><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:msub><mml:mi mathvariant="italic">het</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mspace width="0.15em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="italic">het</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi mathvariant="italic">het</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:msub><mml:mi mathvariant="italic">hom</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mspace width="0.15em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="italic">hom</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi mathvariant="italic">hom</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi><mml:mspace width="0.25em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:msub><mml:mi mathvariant="italic">het</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mspace width="0.15em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi mathvariant="italic">het</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi mathvariant="italic">hom</mml:mi></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="italic">het</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="italic">hom</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:msub><mml:mi mathvariant="italic">hom</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mspace width="0.15em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:msubsup><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi mathvariant="italic">het</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi mathvariant="italic">hom</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="italic">hom</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="italic">het</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:mtext mathvariant="italic">conflict</mml:mtext></mml:mtd><mml:mtd><mml:mspace width="0.15em"/><mml:mtext mathvariant="italic">if conditions</mml:mtext><mml:mspace width="0.25em"/><mml:mi mathvariant="italic">met</mml:mi><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">for</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="italic">het</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">hom</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:mtext mathvariant="italic">conflict</mml:mtext></mml:mtd><mml:mtd><mml:mspace width="0.15em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="italic">tp</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msup><mml:mi mathvariant="italic">tp</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1673_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <italic>τ</italic> (0.1) is the internal ratio parameter and <italic>θ</italic> (0.9) is the external ratio parameter.</p>
      <p id="Par56">The reads covering the sSNV may cover multiple gSNVs, which is why a collectively decided final genotype can be defined by letting all qualified <inline-formula id="IEq8"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ G{T}_{SNV}^s $$\end{document}</tex-math><mml:math id="M30" display="inline"><mml:mi>G</mml:mi><mml:msubsup><mml:mi>T</mml:mi><mml:mi mathvariant="italic">SNV</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq8.gif"/></alternatives></inline-formula> vote for the final genotype. <inline-formula id="IEq9"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ G{T}_{max}^s $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:mi>G</mml:mi><mml:msubsup><mml:mi>T</mml:mi><mml:mi mathvariant="italic">max</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq9.gif"/></alternatives></inline-formula> is therefore the genotype with the most votes. Let <italic>N</italic><sub><italic>max</italic></sub> be the number of gSNVs that voted for <inline-formula id="IEq10"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ G{T}_{max}^s $$\end{document}</tex-math><mml:math id="M34" display="inline"><mml:mi>G</mml:mi><mml:msubsup><mml:mi>T</mml:mi><mml:mi mathvariant="italic">max</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1673_Article_IEq10.gif"/></alternatives></inline-formula>, and <italic>N</italic><sub><italic>vot</italic></sub> is the number of gSNVs that were qualified to vote (<italic>tp</italic><sup>∗</sup> is defined for this gSNV). Let <italic>N</italic><sub><italic>tot</italic></sub> be the number of gSNVs that were present in the same read or read pairs as the sSNV and let <italic>GT</italic><sup><italic>s</italic></sup> be defined as<disp-formula id="Equh"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {GT}^s=\left\{\begin{array}{ll}\kern0.5em {GT}_{max}^s&amp;\ if\kern0.75em \frac{N_{max}}{N_{vot}}\ge \psi, \frac{N_{vot}}{N_{tot}}\ge \sigma \\ {}&amp; \\ {}\kern0.5em conflict&amp;\ if\kern0.75em \frac{N_{max}}{N_{vot}}&lt;\psi \end{array}\right. $$\end{document}</tex-math><mml:math id="M36" display="block"><mml:msup><mml:mi mathvariant="italic">GT</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:msubsup><mml:mi mathvariant="italic">GT</mml:mi><mml:mi mathvariant="italic">max</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.75em"/><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">max</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">vot</mml:mi></mml:msub></mml:mfrac><mml:mo>≥</mml:mo><mml:mi>ψ</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">vot</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">tot</mml:mi></mml:msub></mml:mfrac><mml:mo>≥</mml:mo><mml:mi>σ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.5em"/><mml:mtext mathvariant="italic">conflict</mml:mtext></mml:mtd><mml:mtd><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.75em"/><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">max</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="italic">vot</mml:mi></mml:msub></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>ψ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1673_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>where <italic>ψ</italic> (0.9) is the fraction of gSNVs voting for the same genotype and <italic>σ</italic> (0.9) is the fraction of gSNVs qualified to vote for a genotype.</p>
      <p id="Par57">If <italic>N</italic><sub><italic>vot</italic></sub> = 0, any available read information is used to infer genotypes for samples displaying insufficient read depth. Support for an unmutated genotype is defined as either when the <italic>tp</italic><sup>∗</sup> = {<italic>AA</italic>, <italic>RR</italic>} and the sample displays a read depth supporting the tuple <italic>RA</italic> &gt; <italic>χ</italic> (1x) or when the <italic>tp</italic><sup>∗</sup> = {<italic>AR</italic>, <italic>RA</italic>} and the sample displays a read depth supporting the tuple <italic>RR</italic> &gt; <italic>χ</italic>, resulting in <italic>GT</italic><sup><italic>s</italic></sup> = <italic>hom</italic><sub><italic>C</italic>3</sub>. If there is no support for an unmutated genotype and the sample displays a read depth supporting the alternative base with a value &gt;<italic>ξ</italic> (1x), then <italic>GT</italic><sup><italic>s</italic></sup> = <italic>het</italic><sub><italic>C</italic>3</sub>. Samples displaying support for both a mutated and an unmutated genotype are considered <italic>GT</italic><sup><italic>s</italic></sup> = <italic>conflict</italic>.</p>
      <p id="Par58">In the current report, zero samples displaying conflicting genotypes were allowed per site. A common artifact in variant calling output is regions with clusters of false positive mutations, correlating with areas in the genome regions with poor mappability. In the current report, a maximum of one mutation per kilobase was allowed.</p>
    </sec>
    <sec id="Sec14">
      <title>Sequence alignment and data processing</title>
      <p id="Par59">Following whole genome sequencing and demultiplexing, the reads were trimmed from Illumina adapters using Cutadapt [<xref ref-type="bibr" rid="CR22">22</xref>]. WGA adapters were trimmed from MALBAC amplified samples using Cutadapt [<xref ref-type="bibr" rid="CR22">22</xref>]. Read pairs were aligned to the human genome (human g1k v37 with decoy) using Burrows-Wheeler aligner (BWA-MEM) [<xref ref-type="bibr" rid="CR23">23</xref>]. Processing of the mapped reads and sequencing data quality evaluation was performed using Picard Tools and FastQC. Read processing included removal PCR duplicates, optical duplicates, and reads with a mapping quality below 2, including multimappers. Indel realignment was performed with GATKs IndelRealigner [<xref ref-type="bibr" rid="CR24">24</xref>]. Variant calling was performed using FreeBayes with default settings [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    </sec>
    <sec id="Sec15">
      <title>gSNV filtering</title>
      <p id="Par60">Following variant calling in bulk samples using FreeBayes, variants were filtered by vcffilter (<ext-link ext-link-type="uri" xlink:href="https://github.com/vcflib/vcflib">https://github.com/vcflib/vcflib</ext-link>) to identify gSNVs. False gSNVs will result in false variant calls in the downstream analysis with Conbase. As such, we applied stringent filters on the vcf output from FreeBayes. With an average read depth of ≈ 40x in our bulk samples, we estimated a conservative maximum depth threshold of 55x at any position, as<disp-formula id="Equi"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ d+2.5\sqrt{d}, $$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>2.5</mml:mn><mml:msqrt><mml:mi>d</mml:mi></mml:msqrt><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2019_1673_Article_Equi.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic> is the average read depth across the genome.</p>
      <p id="Par61">We filtered variants on autosomes with a 15–55-fold read depth, quality score above 10 (QUAL), and reads originated from both strands (SAF and SAR); at least two reads were balanced on each side of the site (RPR &amp; RPL), and the alternative allele observation count was required to range between 20 and 80% (AO). The variants were further filtered to remove gSNVs present in suspected erroneous regions in the reference genome. This was done by running a separate script included in the Conbase package, which screens the bulk bam file around each gSNV, and excludes gSNVs present within a 1-kb window containing &gt; 10 “heterozygous” positions. A heterozygous position was defined as a position where &gt; 10% of the reads supported a non-reference base. In the fibroblast donor (donor 1), 1,634,933 gSNVs passed filters. In the T cell donor (donor 2), 1,789,830 gSNVs passed filters. Approximately 70% of gSNVs are present within 1200 bases of another gSNV (Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S2). Given the observed distribution of gSNVs in the two donors, ~ 50% (unique) genomic bases are present within 650 bases of a gSNV and can thus be phased with an average sequencing library insert size of 650 bp (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref> Figure S2).</p>
    </sec>
    <sec id="Sec16">
      <title>Generation of simulated data</title>
      <p id="Par62">We here provide a summary description of the simulations used to generate reads data for a set of loci in a population of cells. For a more formal and detailed description, please refer to Additional file <xref rid="MOESM2" ref-type="media">4</xref> We aimed to make our simulation as similar to real experimental conditions as possible, and we therefore based our generative model on experimental bulk DNA sequencing data from two human cell populations, the CD8<sup>+</sup> T cells, and the primary human fibroblast cell line C5RO (normal) used in our analyses of real experimental data. We identify a set of loci comprising two sites <italic>G</italic> and <italic>S</italic> such that for each locus, (1) <italic>G</italic> is a heterozygous gSNV in both the CD8+ T cell data and the fibroblast data. (2) <italic>S</italic> is a heterozygous gSNV in the CD8+ T cell data, but is homozygous for the reference allele in the fibroblast data. (3) <italic>G</italic> and <italic>S</italic> are on the same chromosome and are situated 11–50 bp apart. In the simulations, we let <italic>G</italic> represent a gSNV, while <italic>S</italic> represents a potential sSNV. We then collect all allele-specific reads from the CD8+ T cell data covering <italic>S</italic> and <italic>G</italic> for the different loci, into one read set for each allele and similarly for the fibroblast data. We refer to the pairs of allele-specific read sets from the CD8+ T cell data and from the fibroblast data as <italic>hetReads</italic> and <italic>homReads</italic>, respectively. Moreover, to be able to simulate realistic numbers of reads from different alleles, we obtain allele-specific read coverage distributions, <italic>d</italic><sub><italic>COV</italic></sub> from single-cell DNA sequencing data from the CD8+ T cell population. Here, we sampled coverage distributions in sites where at least 12 cells were covered by reads.</p>
      <p id="Par63">We now describe the generative model and the input variables used in the simulations. Read data is generated from a set <italic>L</italic> of loci in a population <italic>C</italic> of cells. A clonal population structure of <italic>C</italic> is modeled as a simplified tree <italic>T</italic> comprising two clones of 10 cells each. For a locus <italic>l</italic>, the parameter <italic>snv</italic><sub><italic>l</italic></sub> determines if <italic>l</italic> is a sSNVs, For a locus, <italic>l</italic>, if <italic>snv</italic><sub><italic>l</italic></sub> = 1, we set <italic>S</italic> as a sSNV, displaying heterozygote variants (with reads sampled from <italic>hetReads</italic>) in all cells of a randomly sampled clone from <italic>T</italic> (remaining cells are homozygous for the reference state), while if <italic>snv</italic><sub><italic>l</italic></sub> = 0, all cells are homozygous (with reads sampled from <italic>homReads</italic>) for the reference state. Except in the case of alignment errors (EAL) (see below), we set <italic>snv</italic><sub><italic>l</italic></sub> = 1 for all loci.</p>
      <p id="Par64">The input parameter <italic>p</italic><sub><italic>EAL</italic></sub> determines the probability of EAL, by generating a variable <italic>eal</italic><sub><italic>l</italic></sub>, such that <italic>eal</italic><sub><italic>l</italic></sub> = 1 with probability <italic>p</italic><sub><italic>EAL</italic></sub>; otherwise, <italic>eal</italic><sub><italic>l</italic></sub> = 0. For any locus <italic>l</italic> with <italic>eal</italic><sub><italic>l</italic></sub> = 1, we include an additional “paralogous” locus <italic>l</italic><sup>’</sup> with the opposite state, from which reads may also be sampled. Notice that in the case of EAL, there is generally no way to know whether the reads from <italic>l</italic> or <italic>l</italic><sup>’</sup> are the correct ones. To simplify evaluation, we arbitrarily choose to always simulate an EAL locus <italic>l</italic> such that <italic>snv</italic><sub><italic>l</italic></sub> = 0. Hence, reads for <italic>l</italic> are sampled from <italic>homReads</italic> and those for <italic>l</italic><sup>’</sup> from <italic>hetReads</italic>. Notice that the opposite case would yield the same read distribution.</p>
      <p id="Par65">The input parameter <italic>p</italic><sub><italic>DO</italic></sub> determines the frequency of allelic dropout among cells at a locus. For each cell <italic>c</italic> and locus <italic>l</italic>, it generates a variable <italic>do</italic><sub><italic>c</italic>, <italic>l</italic>, <italic>a</italic></sub> where <italic>a</italic> is an allele of either <italic>l</italic> or <italic>l</italic><sup>’</sup> (the latter only if <italic>eal</italic><sub><italic>l</italic></sub> = 1), such that <italic>do</italic><sub><italic>c</italic>, <italic>l</italic>, <italic>a</italic></sub> = 1 with probability <italic>p</italic><sub><italic>DO</italic></sub>; otherwise, <italic>do</italic><sub><italic>c</italic>, <italic>l</italic>, <italic>a</italic></sub> = 0. Only alleles <italic>a</italic> for any allele <italic>l</italic> and <italic>l</italic><sup>’</sup> in <italic>c</italic>, such that <italic>do</italic><sub><italic>c</italic>, <italic>l</italic>, <italic>a</italic></sub> = 0, are valid read sampling (i.e., <italic>do</italic><sub><italic>c</italic>, <italic>l</italic>, <italic>a</italic></sub> = 1 prevents all read sampling from that allele).</p>
      <p id="Par66">Finally, we generate reads; for each cell <italic>c</italic> ∈ <italic>C</italic> and for each valid allele of each <italic>l</italic> and <italic>l</italic><sup>’</sup>, as determined by <italic>eal</italic><sub><italic>l</italic></sub> and <italic>ado</italic><sub><italic>a</italic></sub>, we randomly sample <italic>N</italic> reads covering <italic>G</italic> and <italic>S</italic> from the corresponding read set determined by <italic>snv</italic><sub><italic>l</italic></sub>, where <italic>N</italic> is sampled randomly and <italic>i.i.d.</italic> from <italic>d</italic><sub><italic>COV</italic></sub>. All reads from individual cells are stored in separate bam files, which are then used as input to the tested methods.</p>
      <p id="Par67">We performed two different experiments with different statistics being recorded. In the first experiment, we focused on prediction of sSNVs in the population of cells, where we consider a sSNV as predicted if it is found in two or more cells. Here, we simulated read data, as described above, using all value combinations of <italic>p</italic><sub><italic>EAL</italic></sub> ∈ {0.1, 0.2, …0.9} and <italic>p</italic><sub><italic>DO</italic></sub> ∈ {0.1, 0.2,  … , 0.9}. We recorded loci correctly predicted as sSNVs (“true positives;” TP), correctly predicted not being sSNVs (“true negatives;” TN), incorrectly predicted as sSNVs (“false positives;” FP), and incorrectly predicted as not being sSNVs (“false negatives;” FN). Using these definitions, we calculated sensitivity (TP/(TP + FN)), specificity (TN/(TN + FP)), and FDR (FP/(FP + TP)). In the second experiment, we focused on genotype prediction in individual cells in sSNV sites. Hence, we set <italic>p</italic><sub><italic>EAL</italic></sub> = 0, but used the same range of <italic>p</italic><sub><italic>DO</italic></sub> values as in experiment 1. Here, we recorded loci correctly predicted as heterozygous (true heterozygous), correctly predicted as homozygous (true homozygous), incorrectly predicted as heterozygous (false heterozygous), incorrectly predicted as homozygous (false homozygous), and finally loci where a genotype was not predicted (no prediction—for generated heterozygous or homozygous genotypes, respectively). Since one of the tested methods, SCcaller, is sensitive to uneven read coverage (personal communication with authors of SCcaller), we performed additional simulations, where we repeated experiments 1 and 2, but instead of using the empirical <italic>d</italic><sub><italic>COV</italic></sub>, we enforced a coverage of 30 reads for each allele in all simulated loci.</p>
    </sec>
    <sec id="Sec17">
      <title>Clonal human fibroblast isolation and analysis</title>
      <p id="Par68">Single cells isolated from a primary human fibroblast cell line C5RO (normal) were expanded in vitro on a Leica frame slide. Clonally related cells (determined by time-lapse movie recording) were isolated by LCM. Eleven cells from clone1, three cells from clone2, and two unrelated cells were next subjected to WGA using MALBAC (Yikon Genomics). Samples were individually inspected using a bioanalyzer (Agilent), and library preparation was done using KAPA HTP Library Preparation kit Illumina Platform (KR0426,KAPABIOSYSTEMS) and whole genome sequencing. The cells belonging to clone 1 were sequenced to an average depth of 15x. The single cells belonging to clone 2 and unrelated cells were sequenced to an average depth of 10x. An unamplified bulk sample from the same primary cell line was sequenced to an average depth of 40x.</p>
    </sec>
    <sec id="Sec18">
      <title>T cell sample preparation and cell sorting</title>
      <p id="Par69">Study participants were recruited into an ongoing study to monitor immune responses to the yellow fever virus vaccine YFV-17D (approved by the Regional Ethical Review Board in Stockholm, Sweden: 2008/1881-31/4, 2013/216-32, and 2104/1890-32). A female subject was identified based on being positive for HLA-B7 and having a detectable T cell response to a minor peptide (RPIDDRFGL) presented by HLA-B7. Cryopreserved peripheral blood mononuclear cell (PBMC) samples taken at days 10, 30, and 148 post-vaccination were thawed at 37 <bold>°</bold>C and quickly washed in FACS buffer (PBS with 2% BSA/2 mM EDTA). Negative selection with magnetic beads was performed for each sample to purify CD8<sup>+</sup> T cells (Miltenyi Human CD8 Negative Selection kit, 130-096-495). Purified CD8<sup>+</sup> T cells were first incubated with an HLA-B7/RPIDDRFGL dextramer conjugated to Alexa fluor 647 (Immudex) for 15 min. Cells were subsequently incubated with a panel of antibodies to identify live CD3<sup>+</sup>CD8<sup>+</sup> T cells (CD3–Alexa Fluor 700 (UCHT1, BD Biosciences), CD8-APC-Cy7 (SK1, BD Biosciences), CD4-PE-Cy5 (RPA-T4, eBioscience), CD14–Horizon V500 (MΦP9, BD Biosciences), CD19–Horizon V500 (HIB19, BD Biosciences), and Live/Dead Fixable Aqua Dead Cell staining kit (Invitrogen, L34957)). Live, lineage-negative CD3<sup>+</sup>CD8<sup>+</sup>Dextramer<sup>+</sup> cells were sorted into 96 well PCR plates (Thermo Scientific, AB-0800) containing lysis buffer (200 mM KOH, 40 mM DTT, 5 mM EDTA). Single cells were incubated on ice for 10 min in lysis buffer; after which, neutralization buffer (400 mM HCL, 600 mM Tris-HCL pH 7.5) was added followed by an additional 10-min incubation on ice. Lysed cells were subsequently stored at − 80 <bold>°</bold>C until amplification reactions were performed.</p>
    </sec>
    <sec id="Sec19">
      <title>WGA by MDA</title>
      <p id="Par70">Lysed single T cells were subjected to multiple displacement amplification (MDA) as previously described [<xref ref-type="bibr" rid="CR25">25</xref>]. A mixture containing dNTPs (Invitrogen, 2 mM), random hexamer primers with 3′ thiophosphate linkers (5′-dNdNdNdN*dN*dN-3′, IDT (50uM)), and repliPHI polymerase (40 U) in phi29 reaction buffer (Epicenter) was added to each well to bring total volume to 20uL. Cells were incubated at 30 <bold>°</bold>C for 10 h followed by a 3-min incubation at 65 <bold>°</bold>C to inactivate the phi29 polymerase. The resulting libraries were diluted in H<sub>2</sub>O to 50uL and concentrations of double-stranded DNA were measured (Qubit, Broad Range dsDNA kit).</p>
    </sec>
    <sec id="Sec20">
      <title>Identification T cell receptors from single-cell MDA material</title>
      <p id="Par71">We adopted a previously published method [<xref ref-type="bibr" rid="CR26">26</xref>] so that we could screen large numbers of single-cell libraries to identify clonally related T cells by TCR rearrangements. Approximately 100 ng of amplified DNA was taken from each sample and touchdown PCR (Tm: 72 to &gt; 55 <bold>°</bold>C) was performed using a panel of primers designed upstream of each variable region and downstream of the joining regions for the human TCR α or β chain locus (Additional file <xref rid="MOESM5" ref-type="media">5</xref> Table S3). A dilution of each reaction was subsequently used to perform a second, nested-touchdown PCR with internal primers designed against each variable and joining region of the human TCR α or β chain locus. The internal primers contained handles which were used to index each well for the 96-well plate so that they could be pooled into a single reaction. Each plate was then prepared according to the Truseq (Illumina) protocol for sequencing on an Illumina Miseq (2 × 150bp reads). After demultiplexing of Illumina sample indexes, the reverse read (R2, 150bases) Fastq file was converted to Fasta format. Identical sequences were clustered using the FASTX-Toolkit (<ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/">http://hannonlab.cshl.edu/fastx_toolkit/</ext-link>) FASTA Collapser. Then, sequences were sorted by our 96-well indexes using the FASTX barcode splitter, and the first 44 bases were finally trimmed off using the FASTA trimmer to facilitate downstream sequence analysis. Because the internal primers targeting the joining regions were within 50 bp of the CDR3 region of the TCR, it was possible to identify clonal T cells based on shared CDR3 nucleotide sequences. All samples were individually analyzed using the IMGT database to identify the CDR3 sequence [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    </sec>
    <sec id="Sec21">
      <title>Selecting high-coverage libraries for Illumina sequencing</title>
      <p id="Par72">Clonal T cells were grouped, and high-quality libraries were identified using a panel of chromosome-specific PCR primers as described previously [<xref ref-type="bibr" rid="CR10">10</xref>]. High-quality T cell libraries were considered to be samples with detection at the majority of loci and were subsequently processed using a PCR-free TruSeq library preparation kit (Illumina) and sequenced with a HiSeq X using a theoretical coverage of 30x per sample (SciLifeLab, Karolinska Institute).</p>
    </sec>
    <sec id="Sec22">
      <title>Screening related clonal T cells by Sanger sequencing</title>
      <p id="Par73">Single-cell libraries that were included in the original screening which matched clones A or clone B were identified to be used for verifying selected mutants (summarized in Additional file <xref rid="MOESM6" ref-type="media">6</xref> Table S4). An additional clone (Clone C (TCRα: CAAHSPYSGNTPLVF, TCRβ: CASSSGTAYNEQFF) was used as a control to determine whether mutations could be found as artifacts in unrelated T cells. Primers were designed to span both the gSNV, and the putative variants and samples were subjected to 35 cycles of PCR (Tm: 67 <bold>°</bold>C) (PCRBIO HiFi Polymerase, PCR Biosystems) yielding approximately 1000 bp amplicons (Additional file <xref rid="MOESM6" ref-type="media">6</xref> Table S4). Additionally, primers contained handles (similar to those used for TCR screening) so that secondary amplification cycles could be used to index samples if necessary. Amplified samples were analyzed by gel electrophoresis, and bands were excised for DNA isolation (Nucleospin Gel Clean Up, Techtum). Gel-purified DNA samples were sent for Sanger sequencing (KI Gene Facility, CMM, Karolinska Institute) using primers specific for the universal handle incorporated onto each Forward primer (Additional file <xref rid="MOESM6" ref-type="media">6</xref> Table S4). Sanger sequencing results were analyzed visually using the software package 4peaks and are summarized in Additional file <xref rid="MOESM6" ref-type="media">6</xref> Table S4.</p>
    </sec>
    <sec id="Sec23">
      <title>Comparisons of single-cell variant calling algorithms</title>
      <p id="Par74">Monovar was run on single T cell amplified with MDA with default settings including consensus filtering. From the raw Monovar output, sites present within 10 bp of another site were removed. Sites overlapping with raw variants called in an unamplified bulk sample by FreeBayes were removed. Potential sSNVs were filtered on autosomes by requiring that at least two samples shared a variant (0/1 or 1/1) while at least one sample displayed the reference genotype (0/0). Samples in the same site which did not pass these cut offs were assigned an unknown genotype. We attempted to call variants in real data using SCcaller [<xref ref-type="bibr" rid="CR5">5</xref>]. The rate of amplification bias observed in the T cell dataset and the Fibroblast dataset resulted in eta-values that were too low to enable distinction between true mutations and artifacts (personal communication with authors of SCcaller [<xref ref-type="bibr" rid="CR5">5</xref>]). Thus, we did not move forward with variant calling using the SCcaller. LiRA [<xref ref-type="bibr" rid="CR9">9</xref>] was run with default settings, with minor fixes to allow us to run it on our server. dbSNP b151_GRCh37p13 was used and 1000 genomes haplotype reference panel from <ext-link ext-link-type="uri" xlink:href="https://mathgen.stats.ox.ac.uk/impute/1000GP_Phase3.tgz">https://mathgen.stats.ox.ac.uk/impute/1000GP_Phase3.tgz</ext-link>. Prior to LiRA the bam files were processed with GATK Haplotype caller with settings (--emitRefConfidence GVCF --variant_index_type LINEAR --variant_index_parameter 128,000). Joint variant calling was done for bulk and single cells using GATK GenotypeGVCFs.</p>
      <p id="Par75">For simulation data, a Snakemake pipeline was used to run all the four methods (Conbase, Monovar, SCcaller, and LiRA), see <ext-link ext-link-type="uri" xlink:href="https://github.com/joannahard/Genome_Biology_2019">https://github.com/joannahard/Genome_Biology_2019</ext-link>. All methods were run as described above for real data. For LiRA however, some fixes to the code were required, as the program could not handle chromosomes with no sSNVs. Hence, checkpoints were added at several points in the code and chromosomes with missing data were omitted at subsequent steps. In addition, our simulations did not involve larger regions with surrounding gSNVs, so we created a bulk with all reads 10Kb upstream/downstream of the gSNV and sSNV of interest and borrowed phasing information of the gSNV of interest to surrounding gSNVs from that bulk. The time to run these methods on our simulated data (20 cells for each of 100 different parameter combinations) using 50 cpus in parallel was as follows: 44 min for Monovar, 128 min for SCcaller, 129 min for Conbase, and 63 h for LiRA, not including preprocessing with GATK or Freebayes for LiRA and Conbase, respectively. The SHAPEIT2 [<xref ref-type="bibr" rid="CR20">20</xref>] step in LiRA is very time-consuming, hence the long run times.</p>
    </sec>
    <sec id="Sec24">
      <title>Hierarchical clustering</title>
      <p id="Par76">Clonal somatic variants called by Conbase, Monovar, and LiRA in real data were used to define distances between cells. For Conbase and Monovar, distances between cells were defined as unknown if no shared sites were detected. For shared sites, the distance was decreased with − 1 for each site where cells have the same call (mutated or non-mutated) and increased with + 1 for sites where the cells have different calls. Since LiRA only predicts the presence of variants, the distance was decreased with − 1 if cells shared a variant; otherwise, the distance was defined as not available. The distance matrix was then clustered using standard hclust with the distance “ward.D2.” For Monovar matrices with more than 45 K sites (no applied GQ filtering), 45 K randomly selected sites were included in the clustering analysis.</p>
    </sec>
    <sec id="Sec25">
      <title>Conbase output</title>
      <p id="Par77">The final output from Conbase includes a tsv file with phased variant calls and a complementary interactive html file where genotype predictions are color coded based on presence or absence of mutation, presence or absence of allelic dropout, and read depth support as well as summarized statistics about concordance of base observations in phased reads in the predicted variant sites for each sample.</p>
    </sec>
    <sec id="Sec26">
      <title>Software</title>
      <p id="Par78">Conbase is implemented in python and is only dependent on the pysam module. Conbase is licensed under the MIT license.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec27">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1673_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p>Supplementary figures. <bold>Figure S1-S9.</bold>, including figure legends. (PDF 3413 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1673_MOESM2_ESM.xlsx">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Table S1.</bold> (XLSX 11 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1673_MOESM3_ESM.xlsx">
            <label>Additional file 3:</label>
            <caption>
              <p><bold>Table S2.</bold> (XLSX 13 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2019_1673_MOESM4_ESM.pdf">
            <label>Additional file 4:</label>
            <caption>
              <p>Simulation model. A detailed description of the model used for generating the simulated data included in this study. (PDF 117 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2019_1673_MOESM5_ESM.xlsx">
            <label>Additional file 5:</label>
            <caption>
              <p><bold>Table S3.</bold> (XLSX 47 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2019_1673_MOESM6_ESM.xlsx">
            <label>Additional file 6:</label>
            <caption>
              <p><bold>Table S4.</bold> (XLSX 48 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="13059_2019_1673_MOESM7_ESM.docx">
            <label>Additional file 7:</label>
            <caption>
              <p>Review history. (DOCX 87 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DP</term>
        <def>
          <p id="Par2">Read depth field in Monovar variant calling format output</p>
        </def>
      </def-item>
      <def-item>
        <term>EAL</term>
        <def>
          <p id="Par3">Alignment error, caused by ambiguous read mapping</p>
        </def>
      </def-item>
      <def-item>
        <term>FACS</term>
        <def>
          <p id="Par4">Fluorescence-activated cell sorting</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par5">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>GQ</term>
        <def>
          <p id="Par6">Genotype quality field in Monovar variant calling format output</p>
        </def>
      </def-item>
      <def-item>
        <term>gSNV</term>
        <def>
          <p id="Par7">Germline single nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>i.i.d.</italic>
        </term>
        <def>
          <p id="Par8">Independent and identically distributed</p>
        </def>
      </def-item>
      <def-item>
        <term>MALBAC</term>
        <def>
          <p id="Par9">Multiple annealing and looping-based amplification cycles</p>
        </def>
      </def-item>
      <def-item>
        <term>MDA</term>
        <def>
          <p id="Par10">Multiple displacement amplification</p>
        </def>
      </def-item>
      <def-item>
        <term>sSNV</term>
        <def>
          <p id="Par11">Somatic single nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>WGA</term>
        <def>
          <p id="Par12">Whole genome amplification</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>J.H. would like to acknowledge bioinformatics advice through the Swedish Bioinformatics Advisory Program.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par79">The review history of this manuscript is available as Additional file <xref rid="MOESM7" ref-type="media">7</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Funding</title>
      <p id="Par80">This work was supported by the Swedish Research Council, the Swedish Cancer Society, the Swedish Society for Strategic Research, Knut and Alice Wallenberg Foundation, AFA Försäkringar, the Strategic Research Programme in Stem Cells and Regenerative Medicine at Karolinska Institutet (StratRegen), Torsten Söderbergs Stiftelse and the Swedish Genomes Program (Science for Life Laboratory). The Swedish Genomes Program has been made available by support from the Knut and Alice Wallenberg Foundation. Å.B. and B.S. are financially supported by the Knut and Alice Wallenberg Foundation as part of the National Bioinformatics Infrastructure Sweden at SciLifeLab.</p>
    </sec>
    <sec id="FPar3" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par81">The data supporting the conclusions of this article is available as one dataset in the European Genome-phenome Archive (EGA) accession number EGAS00001003108 [<xref ref-type="bibr" rid="CR28">28</xref>]. Conbase is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/conbase/conbase/releases">https://github.com/conbase/conbase/releases</ext-link> [<xref ref-type="bibr" rid="CR29">29</xref>] and 10.5281/zenodo.2584130 [<xref ref-type="bibr" rid="CR30">30</xref>] under the MIT license. Read processing and simulation analyses were performed using Snakemake pipelines available at <ext-link ext-link-type="uri" xlink:href="https://github.com/joannahard/Genome_Biology_2019">https://github.com/joannahard/Genome_Biology_2019</ext-link> and 10.5281/zenodo.2590454 [<xref ref-type="bibr" rid="CR31">31</xref>]. The simulated data used in this study is available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/2590437#.XIZt15NKjVo">https://zenodo.org/record/2590437#.XIZt15NKjVo</ext-link> [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JH and JEM devised the project. JH, MK, and EAH developed the software. JEM, ID, MP, PR, and JM generated data. JH, ÅB, and BS performed data analysis with support from EB, and PS. JH, JEM, ÅB, BS, MK, and EAH wrote the manuscript. JEM and JF supervised the project. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p>All human subjects involved in this study provided written, informed consent affirming their participation in this study. The ethical permit was approved by the Regional Ethical Review Board in Stockholm, Sweden: 2008/1881-31/4, 2013/216-32, and 2104/1890-32. The experimental methods comply with the Helsinki Declaration.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>All human subjects involved in this study provided written, informed consent acknowledging that any findings arising during this study would be submitted for publication and data would be deposited upon publication.</p>
    </sec>
    <sec id="FPar6">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar7">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lodato</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Woodworth</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Evrony</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Karger</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatic mutation in single human neurons tracks developmental and transcriptional history</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>350</volume>
        <issue>6256</issue>
        <fpage>94</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aab1785</pub-id>
        <pub-id pub-id-type="pmid">26430121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ju</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Petljak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Rahbari</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatic mutations reveal asymmetric cellular dynamics in the early human embryo</article-title>
        <source>Nature.</source>
        <year>2017</year>
        <volume>543</volume>
        <issue>7647</issue>
        <fpage>714</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="doi">10.1038/nature21703</pub-id>
        <pub-id pub-id-type="pmid">28329761</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gawad</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genome sequencing: current state of the science</article-title>
        <source>Nat Rev Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>175</fpage>
        <lpage>188</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2015.16</pub-id>
        <pub-id pub-id-type="pmid">26806412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Monovar: single-nucleotide variant detection in single cells</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>505</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3835</pub-id>
        <pub-id pub-id-type="pmid">27088313</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Milholland</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maslov</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate identification of single-nucleotide variants in whole-genome-amplified single cells</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>491</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4227</pub-id>
        <pub-id pub-id-type="pmid">28319112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell whole-genome analyses by Linear Amplification via Transposon Insertion (LIANTI)</article-title>
        <source>Science.</source>
        <year>2017</year>
        <volume>356</volume>
        <issue>6334</issue>
        <fpage>189</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aak9787</pub-id>
        <pub-id pub-id-type="pmid">28408603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Bourcy</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>De Vlaminck</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kanbar</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gawad</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A quantitative comparison of single-cell whole genome amplification methods</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>e105585</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0105585</pub-id>
        <pub-id pub-id-type="pmid">25136831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Toward better understanding of artifacts in variant calling from high-coverage samples</article-title>
        <source>Bioinformatics.</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>20</issue>
        <fpage>2843</fpage>
        <lpage>2851</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu356</pub-id>
        <pub-id pub-id-type="pmid">24974202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee-Six</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Obro</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Shepherd</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Grossmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Belmonte</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population dynamics of normal human blood inferred from somatic mutations</article-title>
        <source>Nature.</source>
        <year>2018</year>
        <volume>561</volume>
        <issue>7724</issue>
        <fpage>473</fpage>
        <lpage>478</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0497-0</pub-id>
        <pub-id pub-id-type="pmid">30185910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>CKY</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reliability of whole-exome sequencing for assessing intratumor genetic heterogeneity</article-title>
        <source>Cell Rep</source>
        <year>2018</year>
        <volume>25</volume>
        <issue>6</issue>
        <fpage>1446</fpage>
        <lpage>1457</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2018.10.046</pub-id>
        <pub-id pub-id-type="pmid">30404001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Bohrson CL, Barton AR, Lodato MA, Rodin RE, Viswanadham V, Gulhan D, et al. Linked-read analysis identifies mutations in single-cell DNA sequencing data. BioRxiv. 2017; Available from 10.1101/211169</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide detection of single-nucleotide and copy-number variations of a single human cell</article-title>
        <source>Science.</source>
        <year>2012</year>
        <volume>338</volume>
        <issue>6114</issue>
        <fpage>1622</fpage>
        <lpage>1626</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1229164</pub-id>
        <pub-id pub-id-type="pmid">23258894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Garrison E, Marth G. Haplotype-based variant detection from short-read sequencing. arXiv. 2012; Available from <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1207.3907">https://arxiv.org/abs/1207.3907</ext-link></mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The number of heterozygous nucleotide sites maintained in a finite population due to steady flux of mutations</article-title>
        <source>Genetics.</source>
        <year>1969</year>
        <volume>61</volume>
        <issue>4</issue>
        <fpage>893</fpage>
        <lpage>903</lpage>
        <?supplied-pmid 5364968?>
        <pub-id pub-id-type="pmid">5364968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reumers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>De Rijk</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liekens</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smeets</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cleary</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized filtering reduces the error rate in detecting genomic variants by short-read sequencing</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>61</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2053</pub-id>
        <pub-id pub-id-type="pmid">22178994</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lodato</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Rodin</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Bohrson</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Coulter</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kwon</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aging and neurodegeneration are associated with increased mutations in single human neurons</article-title>
        <source>Science.</source>
        <year>2018</year>
        <volume>359</volume>
        <issue>6375</issue>
        <fpage>555</fpage>
        <lpage>559</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aao4426</pub-id>
        <pub-id pub-id-type="pmid">29217584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altman</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Goulder</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Barouch</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>McHeyzer-Williams</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>JI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenotypic analysis of antigen-specific T lymphocytes</article-title>
        <source>Science.</source>
        <year>1996</year>
        <volume>274</volume>
        <issue>5284</issue>
        <fpage>94</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1126/science.274.5284.94</pub-id>
        <pub-id pub-id-type="pmid">8810254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blom</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ivarsson</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Falconer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moll</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Temporal dynamics of the primary human T cell response to yellow fever virus 17D as it matures from an effector- to a memory-type response</article-title>
        <source>J Immunol</source>
        <year>2013</year>
        <volume>190</volume>
        <issue>5</issue>
        <fpage>2150</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1202234</pub-id>
        <pub-id pub-id-type="pmid">23338234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mold</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ramskold</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Johnsson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Michaelsson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of allelic expression patterns in clonal somatic cells by single-cell RNA-seq</article-title>
        <source>Nat Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <issue>11</issue>
        <fpage>1430</fpage>
        <lpage>1435</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3678</pub-id>
        <pub-id pub-id-type="pmid">27668657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delaneau</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zagury</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>A linear complexity phasing method for thousands of genomes</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>179</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1785</pub-id>
        <pub-id pub-id-type="pmid">22138821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huddleston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>MJP</given-names>
          </name>
          <name>
            <surname>Steinberg</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hoekzema</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery and genotyping of structural variation from long-read haploid genome sequence data</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>677</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214007.116</pub-id>
        <pub-id pub-id-type="pmid">27895111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>
        <source>EMBnet.journal.</source>
        <year>2011</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics.</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evrony</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hills</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Elhosary</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Lehmann</surname>
            <given-names>HS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-neuron sequencing analysis of L1 retrotransposition and somatic mutation in the human brain</article-title>
        <source>Cell.</source>
        <year>2012</year>
        <volume>151</volume>
        <issue>3</issue>
        <fpage>483</fpage>
        <lpage>496</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.09.035</pub-id>
        <pub-id pub-id-type="pmid">23101622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Balazs</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Baltimore</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Patent (US8497071 B2)</source>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Duroux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jabado-Michaloud</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Folch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aouinti</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMGT(R), the international ImMunoGeneTics information system(R) 25 years on</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>Database issue</issue>
        <fpage>D413</fpage>
        <lpage>D422</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1056</pub-id>
        <pub-id pub-id-type="pmid">25378316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Hård J, Hakim EA, Kindblom M, Björklund AK, Sennblad B, Demirci I, Paterlini M, et al. Conbase: a software for unsupervised discovery of clonal somatic mutations in single cells through read phasing. Eur Genome Phenome Arch; 2019. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ega/studies/EGAS00001003108">https://www.ebi.ac.uk/ega/studies/EGAS00001003108</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Hård J, Hakim EA, Kindblom M, Björklund AK, Sennblad B, Demirci I, Paterlini M, et al. Conbase: a software for unsupervised discovery of clonal somatic mutations in single cells through read phasing. Github Repository; 2019. <ext-link ext-link-type="uri" xlink:href="https://github.com/conbase/conbase/releases">https://github.com/conbase/conbase/releases</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Hård J, Hakim EA, Kindblom M, Björklund AK, Sennblad B, Demirci I, Paterlini M, et al. Conbase: a software for unsupervised discovery of clonal somatic mutations in single cells through read phasing. Source Code; 2019. 10.5281/zenodo.2584130.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Hård J, Hakim EA, Kindblom M, Björklund AK, Sennblad B, Demirci I, Paterlini M, et al. Conbase: a software for unsupervised discovery of clonal somatic mutations in single cells through read phasing. Anal Pipelines; 2019. 10.5281/zenodo.2590454.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Hård J, Hakim EA, Kindblom M, Björklund AK, Sennblad B, Demirci I, Paterlini M, et al. Conbase: a software for unsupervised discovery of clonal somatic mutations in single cells through read phasing. Simulated Data; 2019. 10.5281/zenodo.2590437.</mixed-citation>
    </ref>
  </ref-list>
</back>
