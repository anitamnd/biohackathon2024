<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Synchrotron Radiat</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Synchrotron Radiat</journal-id>
    <journal-id journal-id-type="publisher-id">J. Synchrotron Rad.</journal-id>
    <journal-title-group>
      <journal-title>Journal of Synchrotron Radiation</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0909-0495</issn>
    <issn pub-type="epub">1600-5775</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8284402</article-id>
    <article-id pub-id-type="pmid">34212892</article-id>
    <article-id pub-id-type="publisher-id">gy5024</article-id>
    <article-id pub-id-type="doi">10.1107/S1600577521004951</article-id>
    <article-id pub-id-type="coden">JSYRES</article-id>
    <article-id pub-id-type="pii">S1600577521004951</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computer Programs</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">PyPhase</italic> – a Python package for X-ray phase imaging</article-title>
      <alt-title><italic toggle="yes">PyPhase</italic> for X-ray phase imaging</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5821-9617</contrib-id>
        <name>
          <surname>Langer</surname>
          <given-names>Max</given-names>
        </name>
        <xref rid="a" ref-type="aff">a</xref>
        <xref rid="cor" ref-type="corresp">*</xref>
        <xref rid="aunote1" ref-type="author-notes">‡</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-2718-6434</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yuhe</given-names>
        </name>
        <xref rid="b" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Figueirinhas</surname>
          <given-names>Diogo</given-names>
        </name>
        <xref rid="c" ref-type="aff">c</xref>
        <xref rid="d" ref-type="aff">d</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-9229-2455</contrib-id>
        <name>
          <surname>Forien</surname>
          <given-names>Jean-Baptiste</given-names>
        </name>
        <xref rid="e" ref-type="aff">e</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mom</surname>
          <given-names>Kannara</given-names>
        </name>
        <xref rid="a" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mouton</surname>
          <given-names>Claire</given-names>
        </name>
        <xref rid="a" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mokso</surname>
          <given-names>Rajmund</given-names>
        </name>
        <xref rid="f" ref-type="aff">f</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-4671-790X</contrib-id>
        <name>
          <surname>Villanueva-Perez</surname>
          <given-names>Pablo</given-names>
        </name>
        <xref rid="b" ref-type="aff">b</xref>
      </contrib>
      <aff id="a"><label>a</label><institution>Univ Lyon, INSA Lyon, Université Claude Bernard Lyon 1</institution>, UJM-Saint Etienne, CNRS, Inserm, CREATIS UMR 5220, U1206, F-69621 Villeurbanne, <country>France</country></aff>
      <aff id="b"><label>b</label>Division of Synchrotron Radiation Research and NanoLund, Department of Physics, <institution>Lund University</institution>, SE-221 00 Lund, <country>Sweden</country></aff>
      <aff id="c"><label>c</label>Division of Packaging Logistics, Faculty of Engineering, <institution>Lund University</institution>, SE-22100 Lund, <country>Sweden</country></aff>
      <aff id="d"><label>d</label>MAX IV Laboratory, <institution>Lund University</institution>, SE-22100 Lund, <country>Sweden</country></aff>
      <aff id="e"><label>e</label><institution>Lawrence Livermore National Laboratory</institution>, Livermore, CA 94550, <country>USA</country></aff>
      <aff id="f"><label>f</label>Division of Solid Mechanics, Faculty of Engineering, <institution>Lund University</institution>, SE-22100 Lund, <country>Sweden</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>max.langer@univ-grenoble-alpes.fr</email>
</corresp>
      <fn id="aunote1">
        <label>‡</label>
        <p>Currently at Université Grenoble Alpes, CNRS, Grenoble INP, TIMC, 38000 Grenoble, France.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>28</volume>
    <issue>Pt 4</issue>
    <issue-id pub-id-type="publisher-id">s210400</issue-id>
    <fpage>1261</fpage>
    <lpage>1266</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Max Langer et al. 2021</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.1107/S1600577521004951">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p><italic toggle="yes">PyPhase</italic> is a free and open-source Python package for propagation-based near-field phase reconstructions, which implements some of the most popular phase-retrieval algorithms in a highly modular framework supporting the deployment on large-scale computing facilities. This makes integration, development of new phase-retrieval algorithms, and the deployment on different computing infrastructures straightforward.</p>
    </abstract>
    <abstract>
      <p>X-ray propagation-based imaging techniques are well established at synchrotron radiation and laboratory sources. However, most reconstruction algorithms for such image modalities, also known as phase-retrieval algorithms, have been developed specifically for one instrument by and for experts, making the development and diffusion of such techniques difficult. Here, <italic toggle="yes">PyPhase</italic>, a free and open-source package for propagation-based near-field phase reconstructions, which is distributed under the CeCILL license, is presented. <italic toggle="yes">PyPhase</italic> implements some of the most popular phase-retrieval algorithms in a highly modular framework supporting its deployment on large-scale computing facilities. This makes the integration, the development of new phase-retrieval algorithms, and the deployment on different computing infrastructures straightforward. Its capabilities and simplicity are presented by application to data acquired at the synchrotron source MAX IV (Lund, Sweden).</p>
    </abstract>
    <kwd-group>
      <kwd>X-ray imaging</kwd>
      <kwd>phase contrast</kwd>
      <kwd>holography</kwd>
      <kwd>phase retrieval</kwd>
      <kwd>tomography</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>US Department. of Energy</funding-source>
        <award-id>DE-AC52-07NA27344</award-id>
        <principal-award-recipient>Jean-Baptiste Forien</principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>Office of Laboratory Directed Research and Development (LDRD)</funding-source>
        <award-id>19-ERD-022</award-id>
        <principal-award-recipient>Jean-Baptiste Forien</principal-award-recipient>
      </award-group>
      <funding-statement>This work was funded by <funding-source>US Department. of Energy</funding-source> grant <award-id>DE-AC52-07NA27344</award-id> to Jean-Baptiste Forien; <funding-source>Office of Laboratory Directed Research and Development (LDRD)</funding-source> grant <award-id>19-ERD-022</award-id> to Jean-Baptiste Forien.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="sec1">
    <label>1.</label>
    <title>Introduction   </title>
    <p>The unique penetration power and short wavelength of X-rays make them an excellent probe to explore nature in a non-destructive manner down to the atomic scale. However, the high penetration power can lead to low contrast in imaging, especially for microscopic samples when exploiting attenuation contrast. Propagation-based techniques can enhance the contrast and sensitivity by exploiting phase contrast. X-ray propagation-based phase-contrast imaging has seen a large increase in interest and development since its origins 25 years ago (Snigirev <italic toggle="yes">et al.</italic>, 1995<xref rid="bb38" ref-type="bibr"> ▸</xref>; Wilkins <italic toggle="yes">et al.</italic>, 1996<xref rid="bb42" ref-type="bibr"> ▸</xref>). These techniques have seen widespread use, particularly for soft tissues, and for weakly contrasting structures in a dense matrix. With the use of phase-retrieval algorithms together with computed tomography, the complex refractive index distribution in the imaged object can be reconstructed in 3D.</p>
    <p>Near-field propagation-based techniques record images that can be described as the intensity of the Fresnel transform of the exit wave as a function of energy, propagation distance, and length scale. The first images recorded with these approaches had resolutions not better than the optical domain. More recently, the advent of X-ray optics has offered the opportunity to image at higher resolutions than conventional light microscopy (Mokso <italic toggle="yes">et al.</italic>, 2007<xref rid="bb31" ref-type="bibr"> ▸</xref>). Figure 1<xref rid="fig1" ref-type="fig"> ▸</xref>(<italic toggle="yes">a</italic>) depicts a phase-contrast experimental setup using X-ray optics for high-resolution imaging. The images recorded by such experimental setups approach the holographic regime. In this regime, the direct interpretation of the images becomes more and more difficult with increasing resolution. Examples of holographic images of a test pattern, from higher to lower magnification, are shown in Figs. 1<xref rid="fig1" ref-type="fig"> ▸</xref>(<italic toggle="yes">b</italic>)–1(<italic toggle="yes">f</italic>). The images were acquired at beamline NanoMAX at the MAX IV synchrotron (Lund, Sweden). X-rays were focused using Kirkpatrick–Baez reflective optics (Johansson <italic toggle="yes">et al.</italic>, 2018<xref rid="bb19" ref-type="bibr"> ▸</xref>). The X-ray energy was set to 13 keV, yielding a focal spot of 70 nm. A CRYCAM microsystem camera from Crytur was used for detection, using a LuAG(Ce) scintillator, 10× visible light optics, and an Andor Zyla 4.2 Plus CCD camera yielding a detector pixel size of 650 nm. The detector was positioned at <italic toggle="yes">z</italic>
<sub>D</sub> = 1.12 m from the focal spot. For the highest-resolution image, the sample was placed at <italic toggle="yes">z</italic>
<sub>1</sub> = 10.1 mm yielding a geometric magnification factor of <italic toggle="yes">M</italic> = 110.9. The effective pixel size was measured to be 6 nm. Reconstructing the phase (and possibly the amplitude) of the exit wave using phase retrieval becomes a mandatory step for exploiting such images.</p>
    <p>The phase-retrieval step has proved to be a persistent challenge, as no general algorithm currently exists. The practitioner is instead left to pick from a large range of algorithms that have been proposed in the literature. Initially, phase-retrieval algorithms were based on linearizations of the Fresnel integral, <italic toggle="yes">e.g.</italic> with respect to the exit wave itself (Gabor, 1948<xref rid="bb10" ref-type="bibr"> ▸</xref>). However, this solution is not applicable to all the imaging conditions and samples.</p>
    <p>It is useful to classify propagation-based techniques into two regimes to understand their applicability and challenges. These two regimes are divided with respect to the relative propagation distance. Relatively short propagation distances with respect to the imaging length scale and wavelength yield what is sometimes called the <italic toggle="yes">edge-enhancement</italic> regime. This translates to a Fresnel number <italic toggle="yes">F</italic> = <italic toggle="yes">a</italic>
<sup>2</sup>/λ<italic toggle="yes">L</italic>, with <italic toggle="yes">a</italic> the size of the imaged feature, λ the wavelength, and <italic toggle="yes">L</italic> the propagation distance, corresponding to the smallest feature in the image that is <italic toggle="yes">F</italic> ≃ 1. In this regime, phase contrast mainly enhances interfaces between materials in the sample with a visible diffraction fringe. Relatively long distances, corresponding to <inline-formula><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="s-28-01261-efi1.jpg"/></inline-formula> but still within the validity of Fresnel diffraction, give rise to what is sometimes known as the <italic toggle="yes">holographic</italic> regime, where the diffraction fringes dominate the contrast and are spread over a long distance in the object.</p>
    <p>In the edge-enhancement regime, algorithms based on assumptions on the imaged object, <italic toggle="yes">e.g.</italic> homogeneity of the constituent materials (Paganin <italic toggle="yes">et al.</italic>, 2002<xref rid="bb32" ref-type="bibr"> ▸</xref>; Langer <italic toggle="yes">et al.</italic>, 2010<xref rid="bb25" ref-type="bibr"> ▸</xref>), have seen widespread use. Such algorithms are simple and require only a single frame. These algorithms have been very successful for nearly homogeneous objects with fine variations in a dense matrix, but limitations of use remain for many types of samples due to violation of the homogeneity assumption.</p>
    <p>More recently, algorithms taking into account the non-linearity of the problem have been proposed, which can be applied to the edge-enhancement and holographic regimes. Some take directly into account the specificity of the Fresnel framework (Davidoiu <italic toggle="yes">et al.</italic>, 2011<xref rid="bb5" ref-type="bibr"> ▸</xref>), whereas others borrow from the rich literature on reconstruction algorithms from coherent diffraction imaging and crystallography, based on projection onto sets type algorithms (Gerchberg &amp; Saxton, 1972<xref rid="bb11" ref-type="bibr"> ▸</xref>; Fienup, 1980<xref rid="bb9" ref-type="bibr"> ▸</xref>; Elser, 2003<xref rid="bb7" ref-type="bibr"> ▸</xref>).</p>
    <p>Recent developments in phase reconstruction consider the problem in 3D, either through regularization using prior information (Langer <italic toggle="yes">et al.</italic>, 2012<italic toggle="yes">a</italic>
<xref rid="bb24" ref-type="bibr"> ▸</xref>, 2014<xref rid="bb23" ref-type="bibr"> ▸</xref>; Kostenko <italic toggle="yes">et al.</italic>, 2013<xref rid="bb22" ref-type="bibr"> ▸</xref>), filtering (Brun <italic toggle="yes">et al.</italic>, 2019<xref rid="bb2" ref-type="bibr"> ▸</xref>), iterative schemes in the object domain (Ruhlandt &amp; Salditt, 2016<xref rid="bb36" ref-type="bibr"> ▸</xref>), or in both object and projection domain (Ruhlandt <italic toggle="yes">et al.</italic>, 2014<xref rid="bb35" ref-type="bibr"> ▸</xref>). This allows, for example, the use of constraints in the object domain in the phase-retrieval procedure, or improve the computational efficiency.</p>
    <p>Although there is a plethora of literature regarding phase-retrieval algorithms, access to implementations of those algorithms is relatively closed, with a few exceptions (Lohse <italic toggle="yes">et al.</italic>, 2020<xref rid="bb27" ref-type="bibr"> ▸</xref>; Weitkamp <italic toggle="yes">et al.</italic>, 2011<xref rid="bb41" ref-type="bibr"> ▸</xref>; Gürsoy <italic toggle="yes">et al.</italic>, 2014<xref rid="bb14" ref-type="bibr"> ▸</xref>). To address this limitation, we present a complete Python phase-retrieval package for X-ray phase-contrast imaging, named <italic toggle="yes">PyPhase</italic>. PyPhase is a fully open-source and modular package that relies solely on free and open-source tools.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Organization of the package   </title>
    <p>With <italic toggle="yes">PyPhase</italic>, we aim to provide:</p>
    <p>(i) A flexible phase-retrieval toolbox for expert users.</p>
    <p>(ii) An interface, currently a command-line interface and in the future a graphical user interface, for non-expert users.</p>
    <p>(iii) Tools for deployment on computer clusters and heterogeneous computing infrastructures.</p>
    <p>(iv) Tools for implementation and development of phase-retrieval algorithms.</p>
    <p>(v) High level of modularity to facilitate the integration of different packages, <italic toggle="yes">e.g.</italic> registration, tomography, fast Fourier transform (FFT), reading and writing data, and visualization.</p>
    <p>The package consists of a number of modules, namely:</p>
    <p>(i) <italic toggle="yes">Phaseretrieval</italic> contains functionality for phase-retrieval algorithms. Table 1<xref rid="table1" ref-type="table"> ▸</xref> lists the currently implemented algorithms.</p>
    <p>(ii) <italic toggle="yes">Propagator</italic> contains functionality for the propagation of a wavefield and generation of intensities. The propagators are typically used in iterative phase-retrieval algorithms. Currently, a Fresnel operator is implemented, as well as linear­ized versions based on transport of intensity (TIE) (Teague, 1983<xref rid="bb33" ref-type="bibr"> ▸</xref>) and contrast transfer function (CTF) equations (Guigay, 1977<xref rid="bb12" ref-type="bibr"> ▸</xref>).</p>
    <p>(iii) <italic toggle="yes">Tomography</italic> contains functionality for tomographic operations: forward projection, back-projection, as well as 3D image processing operators. The main part of this module wraps other codes for tomographic reconstruction, currently <italic toggle="yes">PyHST</italic> (Mirone <italic toggle="yes">et al.</italic>, 2014<xref rid="bb30" ref-type="bibr"> ▸</xref>), with a wrapper for <italic toggle="yes">TomoPy</italic> (Gürsoy <italic toggle="yes">et al.</italic>, 2014<xref rid="bb14" ref-type="bibr"> ▸</xref>) in development.</p>
    <p>(iv) <italic toggle="yes">Dataset</italic> contains functionality to read and write images in different formats and from different data sources. Current data sources are ESRF-style EDF data sets and NanoMAX-style HDF5 data sets, with support for TOMCAT-style TIF data sets in development. Compatibility with other data sources is planned, <italic toggle="yes">e.g.</italic> by interfacing DXChange (De Carlo <italic toggle="yes">et al.</italic>, 2014<xref rid="bb6" ref-type="bibr"> ▸</xref>).</p>
    <p>(v) <italic toggle="yes">Utilities</italic> contains supporting functionality, such as image registration and visualization. Registration is currently implemented as a wrapper of <italic toggle="yes">Elastix</italic> (Klein <italic toggle="yes">et al.</italic>, 2010<xref rid="bb21" ref-type="bibr"> ▸</xref>; Shamonin <italic toggle="yes">et al.</italic>, 2014<xref rid="bb37" ref-type="bibr"> ▸</xref>) via <italic toggle="yes">pyElastix</italic> (Klein, 2019<xref rid="bb20" ref-type="bibr"> ▸</xref>).</p>
    <p>(vi) <italic toggle="yes">Parallelizer</italic> contains functionality for parallelization. This is implemented as decorators decorating functions that take a range of projections as input. Currently, the supported infrastructures are OAR (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://oar.imag.fr/start" ext-link-type="uri">http://oar.imag.fr/start</ext-link>), SLURM (Yoo <italic toggle="yes">et al.</italic>, 2003<xref rid="bb43" ref-type="bibr"> ▸</xref>), and serial processing. Switching between infrastructures requires the modification of one line in the configuration file.</p>
    <p><italic toggle="yes">PyPhase</italic> is written in Python 3.</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Phase-retrieval algorithms   </title>
    <p>Several phase-retrieval algorithms are currently implemented in the package. On the one hand, some of the algorithms are appropriate for the edge-enhancement regime due to model limitations on relative propagation distance or the necessity of a contact-plane image. On the other hand, appropriate algorithms for the holographic regime are provided, <italic toggle="yes">e.g.</italic> algorithms where the contact plane radiograph is not necessary, capable of reconstructing the attenuation and improving the high-frequency content (necessary for high-resolution imaging). The algorithms currently implemented in <italic toggle="yes">PyPhase</italic>, suitable for both edge-enhancement and holographic regimes, are listed in Table 1<xref rid="table1" ref-type="table"> ▸</xref>.</p>
    <p>The algorithms more appropriate for the edge-enhancement regime currently implemented are based on linearization of the relationship between the exit wave and the contrast in the detection plane, which permits efficient, filtering-based algorithms to be derived, within some restrictions on the imaging conditions. The TIE-based algorithms are based on a linearization with respect to the propagation distance and are hence naturally limited to relatively short propagation distances (in other words large Fresnel numbers). Assuming a weakly attenuating object (WTIE) or a homogeneous object (TIEHOM) permits phase retrieval from a single measurement. If multiple images are used, the least-squares solution (Yu <italic toggle="yes">et al.</italic>, 2018<xref rid="bb44" ref-type="bibr"> ▸</xref>) is used. The TIEHOM method requires the ratio of the refractive index decrement over attenuation coefficient (δ/β) as a parameter. If multiple distances are used, a regularization parameter α can be given (Yu <italic toggle="yes">et al.</italic>, 2018<xref rid="bb44" ref-type="bibr"> ▸</xref>). The mixed approach combines aspects of the CTF and the TIE. It permits at the same time strong attenuation and relatively long propagation distances but requires at least two images: one without propagation between sample and detector (contact or attenuation image) and one with propagation. It also assumes the object to be slowly varying, which in some cases can reduce the achievable resolution in the reconstructed image (Guigay <italic toggle="yes">et al.</italic>, 2007<xref rid="bb13" ref-type="bibr"> ▸</xref>). The mixed approach can be used in conjunction with different image priors to regularize the low-frequency content in the retrieved image. Similarly to the TIEHOM algorithm, the mixed approach can be used with a homogeneous prior, but also with a multi-material prior and a heterogeneous object prior. The homogeneous object prior requires, like the TIEHOM, the δ/β ratio as parameter (Langer <italic toggle="yes">et al.</italic>, 2010<xref rid="bb25" ref-type="bibr"> ▸</xref>). This parameter can be determined empirically, either by trial and error or automatically (Rositi <italic toggle="yes">et al.</italic>, 2014<xref rid="bb34" ref-type="bibr"> ▸</xref>), or by using the theoretical value calculated with, for example, the <italic toggle="yes">XOP</italic> software (Sanchez del Rio &amp; Dejus, 2011<xref rid="bb39" ref-type="bibr"> ▸</xref>). The multi-material prior requires thresholds for the different materials (usually hard/soft tissue), and corresponding δ/β ratios (Langer <italic toggle="yes">et al.</italic>, 2012<italic toggle="yes">a</italic>
<xref rid="bb24" ref-type="bibr"> ▸</xref>). The heterogeneous object prior requires a functional relationship between δ and β (Langer <italic toggle="yes">et al.</italic>, 2014<xref rid="bb23" ref-type="bibr"> ▸</xref>). All three priors require a regularization parameter α.</p>
    <p>Holographic regime algorithms listed in Table 1<xref rid="table1" ref-type="table"> ▸</xref> can be used for this regime but also for the edge-enhancement regime. The CTF is also based on a linearization, but with respect to the variations in the wave itself. This means that the model is valid if attenuation is weak. This algorithm permits to reconstruct both attenuation and phase. It requires one or several images, although in practice usually at least three images are used. For very weakly attenuating samples, a pure phase version (<italic toggle="yes">CTFPurePhase</italic>) can be used.</p>
    <p>The remaining three algorithms are iterative schemes that can be used to refine a reconstruction from one of the other algorithms. They find local optima of the optimized function, so initialization from zero or from noise will usually not yield satisfactory results. Gradient descent (GD) is a simple steepest descent implementation. Error reduction (ER) is an iterative constraint satisfaction scheme in which each constraint in turn is imposed on the current solution. The measured images are considered one constraint. Currently implemented object domain constraints are support and non-negativity. Since the current version is more focused on simplicity and readability, we provide no performance benchmarks.</p>
    <p>There are many more algorithms presented in the literature than currently covered by <italic toggle="yes">PyPhase</italic>. Here, a selection of simple and tested algorithms are provided as a base for further developments. The aim, however, is to progressively include as many algorithms as possible. Planned additions include, but are not limited to, compressed-sensing approaches such as ADMM-CTF (Villanueva-Perez <italic toggle="yes">et al.</italic>, 2017<xref rid="bb321" ref-type="bibr"> ▸</xref>), non-linear conjugate gradient-based methods, Frechet derivative-based methods (Maretzke <italic toggle="yes">et al.</italic>, 2016<xref rid="bb29" ref-type="bibr"> ▸</xref>; Davidoiu <italic toggle="yes">et al.</italic>, 2011<xref rid="bb5" ref-type="bibr"> ▸</xref>), 3D phase-retrieval methods (Ruhlandt &amp; Salditt, 2016<xref rid="bb36" ref-type="bibr"> ▸</xref>), as well as other constraint satisfaction type iterative schemes (Elser, 2003<xref rid="bb7" ref-type="bibr"> ▸</xref>; Luke, 2004<xref rid="bb28" ref-type="bibr"> ▸</xref>) and domain constraints for these kinds of methods. Implementing a large range of algorithms would permit a fair evaluation of different algorithms in practice. Furthermore, it would help the practitioner choose the most suitable algorithm since different algorithms seem to work well in different circumstances.</p>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Basic operations   </title>
    <p>The package contains classes representing the building blocks of phase-retrieval algorithms. This modularity makes it simple to swap between different implementations, <italic toggle="yes">e.g.</italic> CPU, HPC or a future GPU implementation, without substantial changes to the code. The most basic operation for phase retrieval is arguably the FFT. For flexibility, the package contains a wrapper for the FFT functions (FFT, IFFT, fftshift, ifftshift, frequency variables). In the current version, the numpy FFT is used. Interfaces to other FFT packages, such as FFTW, can then be easily implemented and used with minimal modification of the code.</p>
    <p>Iterative phase-retrieval algorithms require the implementation of propagators. An implementation of the Fresnel transform as well as a linearized propagator based on the CTF are provided. The modular implementation makes it simple to interface with other codes and algorithms.</p>
    <p>For the implementation of 3D phase-retrieval algorithms, it is necessary to implement the Radon transform and its inverse transformation. These tomographic operations are provided as wrappers of specialized tomographic reconstruction packages. Currently <italic toggle="yes">PyHST2</italic> can be used and a <italic toggle="yes">TomoPy</italic> interface is in development. However, the modularity of <italic toggle="yes">PyPhase</italic> makes interfacing other packages straightforward.</p>
    <p>A limiting factor for the practical application of phase retrieval in tomography is efficient data handling. We implement this as a dataset class, with subclasses that interface different sources, which provides the basic reading and writing of images in a tomographic or near-field imaging setup. Currently, classes for ESRF-style EDF data, Tomcat-style TIF data, and NanoMAX-style HDF5 data are implemented. The modularity of the code makes it simple to add new data sources, <italic toggle="yes">e.g.</italic> by interfacing DXchange (De Carlo <italic toggle="yes">et al.</italic>, 2014<xref rid="bb6" ref-type="bibr"> ▸</xref>). This facilitates the treatment of data from different sources using the same reconstruction parameters.</p>
    <p>Another limiting factor for phase retrieval in tomography is the computation time. Parallelization efforts are often centered on GPU processing, neglecting the large availability of computing clusters and heterogeneous computing architectures. Since the projections in a tomographic data set are usually considered independent, parallelization over the projections is ‘embarrassingly parallel’. To leverage this, a function decorator <italic toggle="yes">@Parallelize</italic> is provided, which can be applied to all functions in the package that take a range of projections as an argument. It allows to automatically split the implicit <italic toggle="yes">for</italic> loop into appropriate chunks and farm them out on the desired number of CPUs. The infrastructure used can be switched with a centralized parameter in a configuration file, thus requiring no modification of the code to change from serial to parallel computing. Currently, supported infrastructures are serial computing, and SLURM and OAR resource and task managers. The modular implementation makes it straightforward to include other infrastructures such as processes-based parallelism on multi-core workstations.</p>
    <p>A certain number of auxiliary functionality important for phase retrieval are implemented. Most important is image registration, which is used to align the images at one projection angle. Phase-contrast images at different propagation distances and magnifications do not contain identical contrast. This effect precludes simple correlation-based approaches in all but the most trivial cases. For this case, registration algorithms based on mutual information (Weber <italic toggle="yes">et al.</italic>, 2018<xref rid="bb40" ref-type="bibr"> ▸</xref>) seem to be more appropriate. Image registration is implemented as a class <italic toggle="yes">Registrator</italic>. Currently, this is implemented as a wrapper for the <italic toggle="yes">Elastix</italic> software through the <italic toggle="yes">PyElastix</italic> interface. <italic toggle="yes">Elastix</italic> provides all the necessary functionality, but it might not be available on all platforms. In that case, the modularity makes it straightforward to integrate other image registration codes.</p>
    <p>A simple interface for the visualization of the different images is provided. This is to simplify the access to images, <italic toggle="yes">e.g.</italic> corrected and non-corrected projections, for verification purposes. Furthermore, it enables plotting curves related to the reconstruction process, <italic toggle="yes">e.g.</italic> the image alignment and regularization parameter choice. The current implementation relies on the <italic toggle="yes">Matplotlib</italic> package, but more advanced visualization could be used exploiting <italic toggle="yes">PyPhase</italic> modularity.</p>
    <p>The number of dependencies is kept as low as possible. All arrays and matrix-vector operations are implemented using NumPy (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://numpy.org/" ext-link-type="uri">https://numpy.org/</ext-link>). Other dependencies are currently (i) <italic toggle="yes">Elastix</italic> for image registration, since no adequate pure Python implementation is available, and (ii) <italic toggle="yes">PyHST2</italic> for tomographic operations.</p>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Usage example   </title>
    <p>The implementation choices yields extremely compact code. For example, the code for the reconstruction of the image in Fig. 2<xref rid="fig2" ref-type="fig"> ▸</xref>(<italic toggle="yes">a</italic>) using the CTF pure phase algorithm is:<xref rid="scheme1" ref-type="chem"/>
<chem-struct id="scheme1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="s-28-01261-scheme1.jpg" position="float"/></chem-struct>
</p>
    <p>Reconstructions obtained with <italic toggle="yes">PyPhase</italic> using a similar code for three different algorithms are depicted in Fig. 2<xref rid="fig2" ref-type="fig"> ▸</xref>. A documentation and API is available (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pyphase.readthedocs.io" ext-link-type="uri">https://pyphase.readthedocs.io</ext-link>). <italic toggle="yes">PyPhase</italic> can be installed from <italic toggle="yes">PyPI</italic> using PIP.</p>
  </sec>
  <sec sec-type="conclusions" id="sec6">
    <label>6.</label>
    <title>Conclusions   </title>
    <p>We have presented an open-source and modular Python package for phase retrieval, christened <italic toggle="yes">PyPhase. PyPhase</italic> has the potential to lower the entry barrier to phase retrieval in the Fresnel regime and thus make the technique more accessible to non-expert users. The package covers the most popular phase-retrieval algorithms presented in the literature. Furthermore, it provides tools and an interface that facilitate the implementation and deployment of other phase-retrieval algorithms. To improve usability by non-expert users, we will provide a command line interface and, in the future, a graphical user interface. Contributions are welcome: contact the authors for more information or go directly to the project repository (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gitlab.in2p3.fr/mlanger/pyPhase" ext-link-type="uri">https://gitlab.in2p3.fr/mlanger/pyPhase</ext-link>).</p>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to S. Kalbfleish and M. Kahnt for their support acquiring and implementing propagation-based phase-contrast imaging at NanoMAX, MAX IV, Lund, Sweden.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Bronnikov, A. V. (2002). <italic toggle="yes">J. Opt. Soc. Am. A</italic>, <bold>19</bold>, 472–480.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Brun, F., Brombal, L., Di Trapani, V., Delogu, P., Donato, S., Dreossi, D., Rigon, L. &amp; Longo, R. (2019). <italic toggle="yes">J. Synchrotron Rad.</italic>
<bold>26</bold>, 510–516.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Cloetens, P., Barrett, R., Baruchel, J., Guigay, J.-P. &amp; Schlenker, M. (1996). <italic toggle="yes">J. Phys. D Appl. Phys.</italic>
<bold>29</bold>, 133–146.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Cloetens, P., Ludwig, W., Baruchel, J., Van Dyck, D., Van Landuyt, J., Guigay, J. P. &amp; Schlenker, M. (1999). <italic toggle="yes">Appl. Phys. Lett.</italic>
<bold>75</bold>, 2912–2914.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Davidoiu, V., Sixou, B., Langer, M. &amp; Peyrin, F. (2011). <italic toggle="yes">Opt. Express</italic>, <bold>19</bold>, 22809–22819.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">De Carlo, F., Gürsoy, D., Marone, F., Rivers, M., Parkinson, D. Y., Khan, F., Schwarz, N., Vine, D. J., Vogt, S., Gleber, S.-C., Narayanan, S., Newville, M., Lanzirotti, T., Sun, Y., Hong, Y. P. &amp; Jacobsen, C. (2014). <italic toggle="yes">J. Synchrotron Rad.</italic>
<bold>21</bold>, 1224–1230.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Elser, V. (2003). <italic toggle="yes">J. Opt. Soc. Am. A</italic>, <bold>20</bold>, 40–55.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Fienup, J. R. (1978). <italic toggle="yes">Opt. Lett.</italic>
<bold>3</bold>, 27–29.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Fienup, J. R. (1980). <italic toggle="yes">Opt. Eng.</italic>
<bold>19</bold>, 193297.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Gabor, D. (1948). <italic toggle="yes">Nature</italic>, <bold>161</bold>, 777–778.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Gerchberg, R. W. &amp; Saxton, W. O. (1972). <italic toggle="yes">Optik</italic>, <bold>35</bold>, 237–246.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Guigay, J.-P. (1977). <italic toggle="yes">Optik</italic>, <bold>49</bold>, 121–125.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Guigay, J. P., Langer, M., Boistel, R. &amp; Cloetens, P. (2007). <italic toggle="yes">Opt. Lett.</italic>
<bold>32</bold>, 1617–1619.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Gürsoy, D., De Carlo, F., Xiao, X. &amp; Jacobsen, C. (2014). <italic toggle="yes">J. Synchrotron Rad.</italic>
<bold>21</bold>, 1188–1193.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Johansson, U., Carbone, D., Kalbfleisch, S., Bjorling, A., Rodriguez-Frenandez, A., Stankevic, T., Liebi, M., Bring, B., Mikkelsen, A. &amp; Vogt, U. (2018). <italic toggle="yes">Microsc. Microanal.</italic>
<bold>24</bold>, 252–253.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Klein, A. (2019). <italic toggle="yes">PyElastix – Python wrapper for the Elastix nonrigid registration toolkit</italic>, https://github.com/almarklein/pyelastix.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Klein, S., Staring, M., Murphy, K., Viergever, M. A. &amp; Pluim, J. P. W. (2010). <italic toggle="yes">IEEE Trans. Med. Imaging</italic>, <bold>29</bold>, 196–205.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Kostenko, A., Batenburg, K. J., Suhonen, H., Offerman, S. E. &amp; van Vliet, L. J. (2013). <italic toggle="yes">Opt. Express</italic>, <bold>21</bold>, 710–723.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Langer, M., Cloetens, P., Hesse, B., Suhonen, H., Pacureanu, A., Raum, K. &amp; Peyrin, F. (2014). <italic toggle="yes">Philos. Trans. R. Soc. A</italic>, <bold>372</bold>, 20130129.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Langer, M., Cloetens, P., Pacureanu, A. &amp; Peyrin, F. (2012<italic toggle="yes">a</italic>). <italic toggle="yes">Opt. Lett.</italic>
<bold>37</bold>, 2151–2153.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Langer, M., Cloetens, P. &amp; Peyrin, F. (2010). <italic toggle="yes">IEEE Trans. Image Process.</italic>
<bold>19</bold>, 2428–2436.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Langer, M., Pacureanu, A., Suhonen, H., Grimal, Q., Cloetens, P. &amp; Peyrin, F. (2012<italic toggle="yes">b</italic>). <italic toggle="yes">PLoS One</italic>, <bold>7</bold>, e35691.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Lohse, L. M., Robisch, A.-L., Töpperwien, M., Maretzke, S., Krenkel, M., Hagemann, J. &amp; Salditt, T. (2020). <italic toggle="yes">J. Synchrotron Rad.</italic>
<bold>27</bold>, 852–859.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Luke, D. R. (2004). <italic toggle="yes">Inverse Probl.</italic>
<bold>21</bold>, 37–50.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Maretzke, S., Bartels, M., Krenkel, M., Salditt, T. &amp; Hohage, T. (2016). <italic toggle="yes">Opt. Express</italic>, <bold>24</bold>, 6490–6506.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Mirone, A., Brun, E., Gouillart, E., Tafforeau, P. &amp; Kieffer, J. (2014). <italic toggle="yes">Nucl. Instrum. Methods Phys. Res. B</italic>, <bold>324</bold>, 41–48.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Mokso, R., Cloetens, P., Maire, E., Ludwig, W. &amp; Buffière, J.-Y. (2007). <italic toggle="yes">Appl. Phys. Lett.</italic>
<bold>90</bold>, 144104.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Paganin, D., Mayo, S. C., Gureyev, T. E., Miller, P. R. &amp; Wilkins, S. W. (2002). <italic toggle="yes">J. Microsc.</italic>
<bold>206</bold>, 33–40.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Rositi, H., Frindel, C., Wiart, M., Langer, M., Olivier, C., Peyrin, F. &amp; Rousseau, D. (2014). <italic toggle="yes">Phys. Med. Biol.</italic>
<bold>59</bold>, 7767–7775.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Ruhlandt, A., Krenkel, M., Bartels, M. &amp; Salditt, T. (2014). <italic toggle="yes">Phys. Rev. A</italic>, <bold>89</bold>, 033847.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Ruhlandt, A. &amp; Salditt, T. (2016). <italic toggle="yes">Acta Cryst.</italic> A<bold>72</bold>, 215–221.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Sánchez del Río, M. &amp; Dejus, R. J. (2011). <italic toggle="yes">Proc. SPIE</italic>, <bold>8141</bold>, 368–372.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Shamonin, D., Bron, E., Lelieveldt, B., Smits, M., Klein, S., Staring, M. &amp; Alzheimer’s Disease Neuroimaging Initiative (2014). <italic toggle="yes">Front. Neuroinform.</italic>
<bold>7</bold>, 50.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Snigirev, A., Snigireva, I., Kohn, V., Kuznetsov, S. &amp; Schelokov, I. (1995). <italic toggle="yes">Rev. Sci. Instrum.</italic>
<bold>66</bold>, 5486–5492.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Teague, M. R. (1983). <italic toggle="yes">J. Opt. Soc. Am.</italic>
<bold>73</bold>, 1434–1441.</mixed-citation>
    </ref>
    <ref id="bb321">
      <mixed-citation publication-type="other">Villanueva-Perez, P., Arcadu, F., Cloetens, P. &amp; Stampanoni, M. (2017). <italic toggle="yes">Opt. Lett.</italic>
<bold>42</bold>, 1133–1136.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Weber, L., HÄnsch, A., Wolfram, U., Pacureanu, A., Cloetens, P., Peyrin, F., Rit, S. &amp; Langer, M. (2018). <italic toggle="yes">J. Microsc.</italic>
<bold>269</bold>, 36–47.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Weitkamp, T., Haas, D., Wegrzynek, D. &amp; Rack, A. (2011). <italic toggle="yes">J. Synchrotron Rad.</italic>
<bold>18</bold>, 617–629.</mixed-citation>
    </ref>
    <ref id="bb42">
      <mixed-citation publication-type="other">Wilkins, S. W., Gureyev, T. E., Gao, D., Pogany, A. &amp; Stevenson, A. W. (1996). <italic toggle="yes">Nature</italic>, <bold>384</bold>, 335–338.</mixed-citation>
    </ref>
    <ref id="bb43">
      <mixed-citation publication-type="other">Yoo, A. B., Jette, M. A. &amp; Grondona, M. (2003). <italic toggle="yes">Job Scheduling Strategies for Parallel Processing</italic>, edited by D. Feitelson, L. Rudolph &amp; U. Schwiegelshohn, pp. 44–60. Berlin, Heidelberg: Springer.</mixed-citation>
    </ref>
    <ref id="bb44">
      <mixed-citation publication-type="other">Yu, B., Weber, L., Pacureanu, A., Langer, M., Olivier, C., Cloetens, P. &amp; Peyrin, F. (2018). <italic toggle="yes">Opt. Express</italic>, <bold>26</bold>, 11110–11124.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig position="float" id="fig1">
    <label>Figure 1</label>
    <caption>
      <p>Phase-contrast imaging. (<italic toggle="yes">a</italic>) Schematic of the experimental setup for high-resolution phase-contrast imaging. An X-ray beam is focused using reflective (Kirkpatrick–Baez) optics. The sample is placed at different positions <italic toggle="yes">z</italic>
<sub><italic toggle="yes">n</italic></sub> relative to the focus (<italic toggle="yes">z</italic>
<sub>f</sub>) and detector (<italic toggle="yes">z</italic>
<sub>D</sub>) positions for different amounts of magnification and consequently different effective propagation distances. (<italic toggle="yes">b</italic>)–(<italic toggle="yes">f</italic>) Phase-contrast images acquired at sample positions progressively further from the focus (and thus closer to the detector) showing the varying degree of magnification and phase contrast (acquired at NanoMAX, MAX IV, Lund, Sweden). The scale bar is shown for the highest-resolution image and corresponds to 2.5 µm.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="s-28-01261-fig1" position="float"/>
  </fig>
  <fig position="float" id="fig2">
    <label>Figure 2</label>
    <caption>
      <p>Phase-retrieved results obtained with <italic toggle="yes">PyPhase</italic> using (<italic toggle="yes">a</italic>) the CTF pure phase algorithm, (<italic toggle="yes">b</italic>) average of five iterations of successively 45 iterations of HIO, followed by five iterations of ER, separately on each acquired image, and (<italic toggle="yes">c</italic>) 20 iterations of gradient descent initialized with the CTF pure phase reconstruction. The colorbar represents the phase-reconstructed values in radians.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="s-28-01261-fig2" position="float"/>
  </fig>
  <table-wrap-group position="float" id="table1">
    <label>Table 1</label>
    <caption>
      <title>Phase-retrieval algorithms available in <italic toggle="yes">PyPhase</italic> with their main applicability domain</title>
    </caption>
    <table-wrap position="anchor" id="d64e868">
      <table frame="hsides" rules="groups">
        <thead valign="bottom">
          <tr>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Edge enhancement regime</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Class name</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Source</th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">TIE, weak object (WTIE)</td>
            <td rowspan="1" colspan="1" align="left" valign="top">WTIE</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Bronnikov, 2002<xref rid="bb1" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">TIE, homogeneous objects</td>
            <td rowspan="1" colspan="1" align="left" valign="top">TIE-HOM</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Paganin <italic toggle="yes">et al.</italic>, 2002<xref rid="bb32" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">Mixed approach, homogeneous</td>
            <td rowspan="1" colspan="1" align="left" valign="top">MixedApproach</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Langer <italic toggle="yes">et al.</italic>, 2010<xref rid="bb25" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">Mixed approach, multi-material</td>
            <td rowspan="1" colspan="1" align="left" valign="top">MixedApproach</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Langer <italic toggle="yes">et al.</italic>, 2012<italic toggle="yes">a</italic>
<xref rid="bb24" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">Mixed approach, heterogeneous</td>
            <td rowspan="1" colspan="1" align="left" valign="top">MixedApproach</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Langer <italic toggle="yes">et al.</italic>, 2014<xref rid="bb23" ref-type="bibr"> ▸</xref>)</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="anchor" id="d64e944">
      <table frame="hsides" rules="groups">
        <thead valign="bottom">
          <tr>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Holographic regime</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Class name</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Source</th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">Contrast transfer function (CTF)</td>
            <td rowspan="1" colspan="1" align="left" valign="top">CTF</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Cloetens <italic toggle="yes">et al.</italic>, 1999<xref rid="bb4" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">CTF, pure-phase object</td>
            <td rowspan="1" colspan="1" align="left" valign="top">CTFPurePhase</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Cloetens <italic toggle="yes">et al.</italic>, 1996<xref rid="bb3" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">Gradient descent</td>
            <td rowspan="1" colspan="1" align="left" valign="top">GD</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Langer <italic toggle="yes">et al.</italic>, 2012<italic toggle="yes">b</italic>
<xref rid="bb26" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">Hybrid Input–Output (HIO)</td>
            <td rowspan="1" colspan="1" align="left" valign="top">HIO_ER</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Fienup, 1978<xref rid="bb8" ref-type="bibr"> ▸</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">Error reduction (ER)</td>
            <td rowspan="1" colspan="1" align="left" valign="top">HIO_ER</td>
            <td rowspan="1" colspan="1" align="left" valign="top">(Gerchberg &amp; Saxton, 1972<xref rid="bb11" ref-type="bibr"> ▸</xref>)</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </table-wrap-group>
</floats-group>
