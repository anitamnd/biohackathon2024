<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7141873</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz869</article-id>
    <article-id pub-id-type="publisher-id">btz869</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Distance measures for tumor evolutionary trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>DiNardo</surname>
          <given-names>Zach</given-names>
        </name>
        <xref ref-type="aff" rid="btz869-aff1">1</xref>
        <xref ref-type="author-notes" rid="btz869-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tomlinson</surname>
          <given-names>Kiran</given-names>
        </name>
        <xref ref-type="aff" rid="btz869-aff1">1</xref>
        <xref ref-type="aff" rid="btz869-aff2">2</xref>
        <xref ref-type="author-notes" rid="btz869-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ritz</surname>
          <given-names>Anna</given-names>
        </name>
        <xref ref-type="aff" rid="btz869-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oesper</surname>
          <given-names>Layla</given-names>
        </name>
        <xref ref-type="aff" rid="btz869-aff1">1</xref>
        <xref ref-type="corresp" rid="btz869-cor1"/>
        <!--<email>loesper@carleton.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ponty</surname>
          <given-names>Yann</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz869-aff1"><label>1</label><institution>Department of Computer Science, Carleton College</institution>, Northfield, MN 55057, <country country="US">USA</country></aff>
    <aff id="btz869-aff2"><label>2</label><institution>Department of Computer Science, Cornell University</institution>, Ithaca, NY 14853, <country country="US">USA</country></aff>
    <aff id="btz869-aff3"><label>3</label><institution>Department of Biology, Reed College</institution>, Portland, OR 97202, <country country="US">USA</country></aff>
    <author-notes>
      <fn id="btz869-FM1">
        <p>The authors wish it to be known that, in their opinion, Zach DiNardo and Kiran Tomlinson should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btz869-cor1">To whom correspondence should be addressed. E-mail: <email>loesper@carleton.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-11-21">
      <day>21</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>7</issue>
    <fpage>2090</fpage>
    <lpage>2097</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz869.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>There has been recent increased interest in using algorithmic methods to infer the evolutionary tree underlying the developmental history of a tumor. Quantitative measures that compare such trees are vital to a number of different applications including benchmarking tree inference methods and evaluating common inheritance patterns across patients. However, few appropriate distance measures exist, and those that do have low resolution for differentiating trees or do not fully account for the complex relationship between tree topology and the inheritance of the mutations labeling that topology.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present two novel distance measures, <bold><italic>C</italic></bold>ommon <bold><italic>A</italic></bold>ncestor <bold><italic>Set</italic></bold> distance (CASet) and <bold><italic>D</italic></bold>istinctly <bold><italic>I</italic></bold>nherited <bold><italic>S</italic></bold>et <bold><italic>C</italic></bold>omparison distance (DISC), that are specifically designed to account for the subclonal mutation inheritance patterns characteristic of tumor evolutionary trees. We apply CASet and DISC to multiple simulated datasets and two breast cancer datasets and show that our distance measures allow for more nuanced and accurate delineation between tumor evolutionary trees than existing distance measures.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Implementations of CASet and DISC are freely available at: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/oesperlab/stereodist">https://bitbucket.org/oesperlab/stereodist</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>IIS-1657380</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The clonal theory of cancer (<xref rid="btz869-B25" ref-type="bibr">Nowell, 1976</xref>) states that a tumor is the result of an evolutionary process. The history of somatic mutation acquisition during this process is often represented using a rooted tree structure. The root represents the <italic>founding cell</italic> and every other vertex represents a distinct <italic>clone</italic>, or population of tumor cells sharing a set of mutations, that existed at some point during the tumor’s evolution. Directed edges represent direct ancestral relationships between populations. Vertices, or sometimes edges incident to those vertices, are labeled with the set of mutations that first appeared in that clone. In the most general case, these trees are referred to as <italic>clonal</italic> trees (<xref rid="btz869-B8" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2015</xref>). When exactly one mutation labels each vertex, they are instead called <italic>mutation</italic> trees (<xref rid="btz869-B17" ref-type="bibr">Kim and Simon, 2014</xref>). Mutation trees represent the highest resolution possible for viewing the complete temporal history of the tumor, barring trees representing ancestry at the cellular level.</p>
    <p>In recent years, a number of methods have been developed to infer either clonal or mutation trees from single nucleotide variants in bulk sequencing data (<xref rid="btz869-B8" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B11" ref-type="bibr">Husić <italic>et al.</italic>, 2018</xref>; <xref rid="btz869-B14" ref-type="bibr">Jiao <italic>et al.</italic>, 2014</xref>; <xref rid="btz869-B19" ref-type="bibr">Malikic <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B24" ref-type="bibr">Niknafs <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B26" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B32" ref-type="bibr">Satas and Raphael, 2017</xref>; <xref rid="btz869-B35" ref-type="bibr">Toosi <italic>et al.</italic>, 2017</xref>) and single cell sequencing data (<xref rid="btz869-B7" ref-type="bibr">El-Kebir, 2018</xref>; <xref rid="btz869-B12" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>; <xref rid="btz869-B23" ref-type="bibr">Miura <italic>et al.</italic>, 2018</xref>; <xref rid="btz869-B30" ref-type="bibr">Ross and Markowetz, 2016</xref>; <xref rid="btz869-B37" ref-type="bibr">Zafar <italic>et al.</italic>, 2017</xref>). See <xref rid="btz869-B33" ref-type="bibr">Schwartz and Schäffer (2017)</xref> for a more complete listing of such methods. The goal of tree inference is to gain a better understanding of tumor development. This understanding may reveal insights about the mutations that drive a tumor’s growth (<xref rid="btz869-B15" ref-type="bibr">Jolly and Van Loo, 2018</xref>; <xref rid="btz869-B28" ref-type="bibr">Raphael <italic>et al.</italic>, 2014</xref>) and may be targeted for patient treatment (<xref rid="btz869-B1" ref-type="bibr">Amirouchene-Angelozzi <italic>et al.</italic>, 2017</xref>; <xref rid="btz869-B3" ref-type="bibr">Blakely, 2017</xref>).</p>
    <p>Due to the ongoing development of tumor evolution inference methods, the similarity of two potential tumor histories often needs to be quantified. First, new methods need to be benchmarked against other methods or against a ground truth tree, and the ad hoc measures that have typically been used in these situations (<xref rid="btz869-B8" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B19" ref-type="bibr">Malikic <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B26" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>) have not been rigorously studied. Second, some methods themselves rely on the use of a distance measure when inferring a tumor’s evolutionary history. For example, the GraPhyC method (<xref rid="btz869-B10" ref-type="bibr">Govek <italic>et al.</italic>, 2018</xref>) uses a distance measure to create a consensus tumor history from several input histories. Third, some Bayesian methods (<xref rid="btz869-B12" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>; <xref rid="btz869-B13" ref-type="bibr">Jiang <italic>et al.</italic>, 2016</xref>; <xref rid="btz869-B30" ref-type="bibr">Ross and Markowetz, 2016</xref>) attempt to account for uncertainty in the inferred tree structure either through sampling procedures or inference of unobserved clones. These methods could benefit from analysis of the similarity of the trees considered. Lastly, there have been growing questions about the structure of the space of possible evolutionary histories consistent with the underlying sequence data (<xref rid="btz869-B9" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2016</xref>; <xref rid="btz869-B27" ref-type="bibr">Pradhan and El-Kebir, 2018</xref>; <xref rid="btz869-B34" ref-type="bibr">Tomlinson and Oesper, 2018</xref>) and how tumor evolutionary histories across patients can be used to identify patterns of tumor evolution (<xref rid="btz869-B21" ref-type="bibr">Matsui <italic>et al.</italic>, 2017</xref>). Further analysis of these questions would be aided by distance measures tuned to the key features of tumor evolution histories.</p>
    <p>For species trees, there are several well-known distance measures such as the method of <xref rid="btz869-B29" ref-type="bibr">Robinson and Foulds (1981)</xref> and triplet distance (<xref rid="btz869-B5" ref-type="bibr">Critchlow <italic>et al.</italic>, 1996</xref>), among others. However, there are substantial differences between species and cancer trees. One such difference is that the labels in tumor evolutionary trees represent mutations rather than species. Moreover, all vertices in these trees are labeled with mutations, in contrast to phylogenetic trees where only the leaves are labeled with species. So while methods designed to compare species trees may assume that both trees have identical sets of leaf labels, the same is not true for tumor evolutionary trees.</p>
    <p>Various distance measures also exist for labeled trees where each node in the tree has a single label from a finite set (for a review of such methods, see <xref rid="btz869-B2" ref-type="bibr">Bille, 2005</xref>). However, nodes in tumor evolutionary trees may contain multiple labels indicating mutations whose order of appearance cannot be readily identified (<xref rid="btz869-B10" ref-type="bibr">Govek <italic>et al.</italic>, 2018</xref>; <xref rid="btz869-B16" ref-type="bibr">Karpov <italic>et al.</italic>, 2018</xref>). Furthermore, the mutations in a tumor evolutionary tree are inherited by all descendant tumor populations, creating a complex underlying relationship between topology and mutation labeling. Distance measures for labeled trees cannot handle multiple labels, nor do they consider this complex pattern of mutation inheritance. Thus, there is a need for distance measures specifically tailored to the intricacies of tumor evolutionary trees.</p>
    <p>Despite this need for tumor tree distance measures, a limited number of such measures have been rigorously developed and comprehensively evaluated. Several simple distance measures on clonal trees described by <xref rid="btz869-B10" ref-type="bibr">Govek <italic>et al.</italic> (2018)</xref> generalized earlier ad hoc approaches that relied on the existence of a ground truth tree (<xref rid="btz869-B8" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B19" ref-type="bibr">Malikic <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B26" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>), but were not the focus of that work, and their effectiveness was not analyzed in depth. Additionally, each of these distance measures focused on a single aspect of similarity between trees, but failed to look at how these aspects affected the global structure of the constituent trees. Another recently proposed approach called MLTED uses an edit distance-based measure focused on handling multi-labeled nodes within clonal trees to count the minimum number of moves to convert both trees into a specific common tree (<xref rid="btz869-B16" ref-type="bibr">Karpov <italic>et al.</italic>, 2018</xref>). This distance allows trees observed at different levels of resolution to be considered identical (e.g. a clonal tree and its expanded mutation tree). While this may be desirable when comparing trees reconstructed using different resolution datasets, it may not work well for benchmarking new algorithms. In this use case, a distance measure is used to compare trees inferred by different methods against the true underlying tree. A method that is able to resolve more specific ancestral relationships should be considered a closer match to the underlying tree than one that simply groups descendants together without specifying an order.</p>
    <p>In this work, we formalize the definition of a <italic>tumor evolution distance measure</italic> by precisely defining the input and output of such a function and describing what features of such a measure are desirable in the context of tumor evolution. We then describe two novel tumor evolution distance measures, <italic>C</italic>ommon <italic>A</italic>ncestor <italic>Set</italic> distance (CASet) and <italic>D</italic>istinctly <italic>I</italic>nherited <italic>S</italic>et <italic>C</italic>omparison distance (DISC), which are specifically designed to account for structure of mutation inheritance by subsequent tumor populations. After defining these measures in a simple case, we extend them to trees that do not share the same set of mutations. We apply our distance measures to multiple simulated datasets and two breast cancer datasets. We find that CASet and DISC allow for more precision and are better able to identify groups of similar trees in a clustering scenario than existing distance measures. In testing this application, we find that CASet performs especially well in determining the clustering of sets of dissimilar trees while DISC is able to distinguish between relatively similar trees with very high granularity.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Tumor evolutionary trees</title>
      <p>We first make two common assumptions about tumor evolution. The first is the <italic>infinite sites assumption</italic> (ISA) which states that no mutation occurs more than once during a tumor’s history, and that once gained, a mutation is never lost. This has been a common assumption made by many methods that infer tumor evolutionary histories (<xref rid="btz869-B8" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B11" ref-type="bibr">Husić <italic>et al.</italic>, 2018</xref>, among others; <xref rid="btz869-B14" ref-type="bibr">Jiao <italic>et al.</italic>, 2014</xref>; <xref rid="btz869-B19" ref-type="bibr">Malikic <italic>et al.</italic>, 2015</xref>; <xref rid="btz869-B26" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>). While some recent phylogeny inference methods do allow for minor violations of the ISA (e.g. <xref rid="btz869-B4" ref-type="bibr">Bonizzoni <italic>et al.</italic>, 2018</xref>; <xref rid="btz869-B20" ref-type="bibr">Marass <italic>et al.</italic>, 2016</xref>), our work here will be most widely applicable if we assume the ISA. The second assumption is that all tumor cells are descended from a single founding tumor cell, and hence the tumor’s evolution can be described as <italic>monoclonal</italic>. This assumption is non-essential to our approaches and can easily be dropped by rooting evolution trees with healthy cells instead of founding tumor cells. Nonetheless, we make the monoclonal assumption to simplify our definitions. We now formally describe the evolutionary history of a monoclonal tumor adhering to the ISA as a clonal tree.</p>
      <p>A <italic>clonal tree</italic> is a rooted, directed tree T in which: (i) each vertex in the tree is labeled by one or more mutations and (ii) no mutation appears more than once. Here, mutation may mean any type of genomic variant (e.g. SNV, CNA etc.). We also define <inline-formula id="IE1"><mml:math id="IM1"><mml:mi mathvariant="script">T</mml:mi></mml:math></inline-formula> to be the set of all clonal trees. Given a tree <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>, we define <italic>M</italic>(<italic>T</italic>) to be the set of all mutations (i.e. vertex labels) in <italic>T</italic>. In this representation, every vertex represents a distinct tumor clone (or population) that existed at some point during the tumor’s evolution. The mutation labels indicate the clone in which the mutation first appeared. Thus, the complete set of mutations that exist in any particular clone, represented by vertex <italic>v</italic>, is the set of mutations that label all vertices on the path from the root to vertex <italic>v</italic>.</p>
      <p>We sometimes wish to restrict our attention to a predetermined set of mutations, so we also define <italic>m</italic>-clonal trees for this purpose. An <italic>m-clonal tree</italic> is a clonal tree <italic>T</italic> with <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We emphasize that this definition uses the variable <italic>m</italic> to refer to the number of mutations rather than the number of clones in the tree. We also define <inline-formula id="IE4"><mml:math id="IM4"><mml:msub><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to be the set of all <italic>m</italic>-clonal trees that share the same mutation set <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 Tumor evolution distances</title>
      <p>A <italic>tumor evolution distance measure</italic> is a function <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi>d</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for which a value of <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that is close to 0 indicates that the two input trees are very similar and progressively larger values of <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> indicate the clonal trees are more dissimilar. A tumor evolution distance measure must give a quantitative evaluation of how different two tumor histories are from each other, but how best to define ‘different’ is not immediately obvious. There are two main aspects of tumor evolutionary trees that should contribute to a distance measure: (i) the topology of the tree and (ii) the labels present in the vertices of the trees. Topology can be separated from labeling by simply ignoring all labels, and the labels can be separated from topology by considering only the set(s) of labels that appear or appear together. Thus, simple distance measures could certainly consider each of these aspects separately. However, these attributes are inherently intertwined.</p>
      <p>Since mutation labelings indicate in which vertex a mutation was first acquired, all descendants of that vertex also inherit that mutation. A difference in a vertex with many descendants should then contribute more to a distance measure than one in a vertex with few descendants, since it affects more clonal populations. Thus, a tumor evolution distance measure that simply counts the differences between trees (often referred to as a tree edit distance) does not fully address the impact any given label change may have. A distance measure should assign different weights to disagreements in different locations in order to appropriately address the relationship between topology and mutation labeling. These observations form the basis for the distance measures presented in the following section.</p>
    </sec>
    <sec>
      <title>2.3 Two new distance measures on <italic>m</italic>-clonal trees</title>
      <sec>
        <title>2.3.1 Notation</title>
        <p>Suppose <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula> is a clonal tree. Given a mutation <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we denote the vertex in <italic>T</italic> that is labeled with mutation <italic>i</italic> as <italic>v<sub>i</sub></italic>. We also define the <italic>ancestral set A</italic>(<italic>i</italic>) as the set of mutations that label the path from the root vertex <italic>r</italic> to <italic>v<sub>i</sub></italic> in <italic>T</italic>. Thus, <italic>A</italic>(<italic>i</italic>) gives the set of mutations that exist in the clone represented by vertex <italic>v<sub>i</sub></italic>. Given <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we define the <italic>common ancestor set C</italic>(<italic>i</italic>, <italic>j</italic>) to be <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∩</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. That is, <italic>C</italic>(<italic>i</italic>, <italic>j</italic>) is the set of mutations that are ancestral to both mutations <italic>i</italic> and <italic>j</italic>. Given <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we also define the <italic>distinctly inherited set D</italic>(<italic>i</italic>, <italic>j</italic>) to be <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∖</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. That is, <italic>D</italic>(<italic>i</italic>, <italic>j</italic>) is the set of mutations that are ancestral to mutation <italic>i</italic> but not mutation <italic>j</italic> in <italic>T</italic>. Note that under this definition it is almost always the case that <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, although both are empty when <italic>i </italic>=<italic> j</italic>. When we have more than one tree, we use subscripts to distinguish between them. For instance, <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> all refer to <italic>T<sub>k</sub></italic>. See <xref ref-type="fig" rid="btz869-F1">Figure 1</xref>, e.g. of ancestral sets, common ancestor sets and distinctly inherited sets. Given two sets of mutations <italic>A</italic> and <italic>B</italic>, we note that the <italic>Jaccard distance</italic> between them is defined as <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mtext>Jacc</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mtext>Jacc</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>∅</mml:mi><mml:mo>,</mml:mo><mml:mo>∅</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.
</p>
        <fig id="btz869-F1" orientation="portrait" position="float">
          <label>Fig. 1.</label>
          <caption>
            <p>Examples of ancestral sets, common ancestor sets and distinctly inherited sets on one tree </p>
          </caption>
          <graphic xlink:href="btz869f1"/>
        </fig>
      </sec>
      <sec>
        <title>2.3.2 Common ancestor set distance</title>
        <p>Given two <italic>m</italic>-clonal trees <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we define a new tumor evolutionary tree distance measure called CASet that computes a distance between <italic>T<sub>k</sub></italic> and <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="btz869-F2">Fig. 2</xref>). Informally, CASet distance is the average Jaccard distance between all corresponding common ancestor sets in <italic>T<sub>k</sub></italic> and <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Formally,
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mtext>CASet</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>⊆</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mtext>Jacc</mml:mtext></mml:mrow><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <fig id="btz869-F2" orientation="portrait" position="float">
          <label>Fig. 2.</label>
          <caption>
            <p>(<bold>A</bold>) A pair of 10-clonal trees. (<bold>B</bold>) Example of CASet distance applied to the 10-clonal trees in (A). (<bold>C</bold>) Example of DISC distance applied to the 10-clonal trees in (A)</p>
          </caption>
          <graphic xlink:href="btz869f2"/>
        </fig>
        <p><bold>Observation 2.1</bold> <italic>The running time to compute</italic> <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mtext>CASet</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula><italic>is</italic> <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p><bold>Observation 2.2</bold> <italic>CASet distance is a metric on</italic> <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p>Full proofs of Observations 2.1 and 2.2 are in <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>.</p>
      </sec>
      <sec>
        <title>2.3.3 Distinctly inherited set comparison</title>
        <p>CASet distance compares the common ancestor sets of all pairs of mutations, which emphasizes differences close to the root. However, we might also want to emphasize differences in more recently acquired mutations. Given two <italic>m</italic>-clonal trees <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we define a new tumor evolution distance measure between <italic>T<sub>k</sub></italic> and <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> called DISC that accounts for mutation differences in the more recent tumor clones (<xref ref-type="fig" rid="btz869-F2">Fig. 2</xref>). Informally, DISC distance is the average Jaccard distance between all corresponding distinctly inherited ancestor sets in <italic>T<sub>k</sub></italic> and <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Formally,
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtext>DISC  </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mrow><mml:mtext>Jacc</mml:mtext></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Note that this range of summation is different from CASet, which only considers unordered pairs {<italic>i</italic>, <italic>j</italic>}.</p>
        <p><bold>Observation 2.3</bold> <italic>The running time to compute</italic> <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mtext>DISC</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula><italic>is</italic> <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p><bold>Observation 2.4</bold> <italic>DISC distance is a metric on</italic> <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p>Full proofs of Observations 2.3 and 2.4 are similar to the CASet proofs and also appear in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>. The difference in runtime for CASet and DISC is related to the fact that there are fewer than <italic>m</italic> distinct common ancestor sets in an <italic>m</italic>-clonal tree, but the same is not true for distinctly inherited sets.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Extending CASet and DISC to clonal trees</title>
      <p>Thus far, we have assumed that any two tumor evolutionary trees to be compared have the exact same set of mutation labels (i.e. that they are both <italic>m</italic>-clonal). However, there are many scenarios in which this may not be the case. For instance, some methods such as <xref rid="btz869-B8" ref-type="bibr">El-Kebir <italic>et al.</italic> (2015)</xref> may not use all available mutations when creating a tumor evolutionary history tree. Furthermore, different trees may be reconstructed from different data types for the same tumor (e.g. single cell and bulk sequencing) that do not share the same set of observed mutations. In this section, we present two extensions to both of our distance measures that allow for the comparison of clonal trees with different sets of mutation labels.</p>
      <sec>
        <title>2.4.1 Intersection of mutation sets</title>
        <p>In the first extension to clonal trees, we consider the intersection of the mutation sets for the input trees. This allows us to compute a distance between two trees by only considering pairs of mutations that the two trees share. Let <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∩</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the intersection of the sets of mutations labeling <italic>T<sub>k</sub></italic> and <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Thus, we can modify both CASet and DISC distances as follows:
<disp-formula id="E3"><mml:math id="M3"><mml:mrow><mml:mtext>CASet</mml:mtext><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mo>∩</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>⊆</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mtext>Jacc</mml:mtext></mml:mrow><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>and
<disp-formula id="E4"><mml:math id="M4"><mml:msub><mml:mrow><mml:mtext>DISC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:msub><mml:mrow><mml:mtext>Jacc</mml:mtext></mml:mrow></mml:mrow><mml:mo> </mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>Note that the actual sets compared using the Jaccard distance may themselves contain mutations that exist in only one of the trees. Thus, these distances are not the same as removing all non-shared mutations from the trees, contracting the tree topology and computing the original version of the distances. See the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref> for analyses of these measures with regard to metric properties.</p>
        <p>This variation is most useful when differences in mutation labelings between trees should not strongly contribute to their distance value. For example, this method may be useful when trying to identify common patterns of evolution across different patients. A degenerate case arises if this approach is applied to two trees with disjoint mutation sets, resulting in both <inline-formula id="IE34"><mml:math id="IM34"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE35"><mml:math id="IM35"><mml:msub><mml:mrow><mml:mtext>DISC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> being 0.</p>
      </sec>
      <sec>
        <title>2.4.2 Union of mutation sets</title>
        <p>In the second extension to clonal trees, we consider the union of the mutation sets for the input trees. To do so, we need to address how to handle mutations that exist in only one tree. Let <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the union of the sets of mutations labeling <italic>T<sub>k</sub></italic> and <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>ℓ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. If <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mi>i</mml:mi><mml:menclose notation="updiagonalstrike"><mml:mo>∈</mml:mo></mml:menclose><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then we define <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula>. Thus, we can modify both CASet and DISC distances as follows:
<disp-formula id="E5"><mml:math id="M5"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>⊆</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mtext>Jacc</mml:mtext></mml:mrow></mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></disp-formula>and
<disp-formula id="E6"><mml:math id="M6"><mml:msub><mml:mrow><mml:mtext>DISC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:msub><mml:mrow><mml:mtext>Jacc</mml:mtext></mml:mrow></mml:mrow><mml:mo> </mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>This variation allows differences in the sets of mutation labels to contribute to the distance computed between two trees. Thus, this variation may be most useful for comparing tumor evolutionary trees generated by different data types, across samples taken at different times, or even across patients. Note that because <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mtext>Jacc</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mo>∅</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mi>X</mml:mi><mml:mo>≠</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula>, the distance between trees with disjoint labels is 0. In the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>, we describe a formula that relates <inline-formula id="IE42"><mml:math id="IM42"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE43"><mml:math id="IM43"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, allowing for computation of <inline-formula id="IE44"><mml:math id="IM44"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> with fewer operations, and examine the metric properties of both of these measures.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We analyze and compare CASet and DISC to existing distance measures on simulated datasets and two real datasets. We find that our methods allow for more granularity in comparing tumor evolutionary trees and outperform other methods when used in a clustering context.</p>
    <sec>
      <title>3.1 Edit location and tree structure effects</title>
      <p>We first evaluate how specific labeling and topology differences between trees affect CASet and DISC and then compare the effects for other distance measures. To measure the effect caused by labeling differences, we constructed a seven-node complete binary tree (the ‘base tree’) and then created a set of trees consisting of all possible pairwise label swaps of the base tree. <xref ref-type="fig" rid="btz869-F3">Figure 3A</xref> shows the computed distance between the base tree and all other trees for CASet, DISC, MLTED (<xref rid="btz869-B16" ref-type="bibr">Karpov <italic>et al.</italic>, 2018</xref>) and Ancestor–Descendant (A–D) (<xref rid="btz869-B10" ref-type="bibr">Govek <italic>et al.</italic>, 2018</xref>) distances. See the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref> for results including other distances from <xref rid="btz869-B10" ref-type="bibr">Govek <italic>et al.</italic> (2018)</xref>. We note that both CASet and DISC are able to completely distinguish all classes of mutation swaps based on the location of the swapped labels in the tree. In contrast, A–D is unable to distinguish some of these classes and MLTED computes the same distance for almost all classes. We do see a loose trend that swaps that include mutations labeling the leaves of the tree result in smaller distances than swaps that include mutations that label nodes closer to the root of the tree for both CASet and DISC. However, CASet and DISC do have different relative orderings of some classes of label swaps compared with the base tree. CASet most strongly penalizes swaps that include the label on the root of the tree and has a large corresponding jump in computed distance when comparing these trees to the base tree. On the other hand, DISC considers the tree that swaps the two children of the root to have the largest distance from the base tree. We see similar trends when we consider other base trees (<xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>).
</p>
      <fig id="btz869-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>(<bold>A</bold>) Effect of label swaps when comparing a tree to the base tree. Each point shows the distance between a tree with a single pair of label swaps and the base tree. Trees are ordered according to increasing CASet distance. The tree annotations show the type of label swap to which each data point corresponds. (<bold>B</bold>) Effect of a single topological changes to a tree when comparing a tree to the base tree. Node depth refers the height to which the leaf of the base tree was moved in the modified tree. The trees above the plot illustrate the movement of the leaf. In both (A) and (B), A–D distance is normalized by <italic>m</italic><sup>2</sup> to place it on the same scale as the other distances.</p>
        </caption>
        <graphic xlink:href="btz869f3"/>
      </fig>
      <p>We also perform an analogous experiment to assess the effect of topology rather than labeling. Specifically, we constructed a 10-node linear tree as the base tree and constructed a set of comparison trees by moving the leaf node of the base tree to every level of the tree (<xref ref-type="fig" rid="btz869-F3">Fig. 3B</xref>). We find that CASet, DISC and A–D all consider placement of the moved node closer to the root to have a larger distance from the base tree. This is as we might expect, since these represent older evolutionary differences. While the decrease in A–D is linear as the node is placed deeper, the curves for CASet and DISC are concave up and down, respectively. Intuitively, this means that CASet more heavily prioritizes topological changes higher up in the tree while assigning a lower weight to changes near the leaves. In contrast, DISC places higher relative weight on topological differences closer to the leaves.</p>
      <p>Having seen that the location of differences between trees affect our measures in accordance with evolutionary context, we also consider how global properties of tree structure affect our measures. To this end, we created a base 15-node complete binary tree and measured its distance to 5000 randomly generated 15-clonal trees. We compare the height, maximum branching factor and balance (as measured by total cophenetic index; <xref rid="btz869-B22" ref-type="bibr">Mir <italic>et al.</italic>, 2013</xref>) of the random trees to their distances from the base tree (full results in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>). We find that trees taller than the base tree tend to have higher CASet, DISC and A–D distances, but do not observe this effect in MLTED. On the other hand, we find that a higher maximum branching factor than the base tree correlates with decreased DISC and A–D distance, while the opposite is true for MLTED and CASet does not show a clear correlation with branching factor. Unbalanced trees tend to have higher CASet and A–D distances, but balance does not have a strong effect on DISC or MLTED.</p>
    </sec>
    <sec>
      <title>3.2 Clustering application</title>
      <p>Previous work has shown that many different trees can be consistent with data from a single patient (<xref rid="btz869-B27" ref-type="bibr">Pradhan and El-Kebir, 2018</xref>; <xref rid="btz869-B34" ref-type="bibr">Tomlinson and Oesper, 2018</xref>). Clustering these trees is a compelling use case for tumor evolution distance measures as it has the potential to reveal structure in the space of compatible trees of a single dataset. Clustering trees inferred from different patients can also be used to identify shared evolutionary patterns.</p>
      <sec>
        <title>3.2.1 Dataset generation</title>
        <p>We created two different simulated datasets for our clustering analysis. In the first dataset, we manually constructed 5 base clonal trees each with 15 mutations but different topologies and labelings (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>), and generated 5 variants of each base tree for a total of 25 trees. The second dataset was generated using the OncoLib (<xref rid="btz869-B27" ref-type="bibr">Pradhan and El-Kebir, 2018</xref>) tree generation tool, which simulates tumor evolutionary trees and read count data. We took the read count data from 5 OncoLib simulations (each with 3 sequenced samples and 10–20 mutations) and reconstructed all clonal trees that were consistent with the simulated data using the approach of <xref rid="btz869-B34" ref-type="bibr">Tomlinson and Oesper (2018)</xref>. Each of the five OncoLib simulations yielded a ‘tree family’ of between 50 and 10 000 clonal trees that were consistent with the simulated sequencing data, of which we randomly sampled 50 from each family to create a dataset of 250 trees from 5 families (labeled A–E). All trees within a family have the same set of mutations, but mutation sets differ across families. The true underlying clonal trees produced by OncoLib are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>. For an analysis of the correlation between CASet and DISC for the trees in these datasets, see the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>.</p>
      </sec>
      <sec>
        <title>3.2.2 Clustering clonal trees</title>
        <p>We perform hierarchical clustering with average linkage on both the manual and OncoLib datasets. On the manual dataset, we compare our distance measures to the following other methods: MLTED (<xref rid="btz869-B16" ref-type="bibr">Karpov <italic>et al.</italic>, 2018</xref>), the four distance measures, A–D, parent–child, clonal and path distances, described in <xref rid="btz869-B10" ref-type="bibr">Govek <italic>et al.</italic> (2018)</xref> (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref> for details on normalizations applied), and triplet distance (<xref rid="btz869-B5" ref-type="bibr">Critchlow <italic>et al.</italic>, 1996</xref>) (a modified version of a distance designed for phylogenetic trees, described in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>). For each method, we compute the average silhouette value (<xref rid="btz869-B31" ref-type="bibr">Rousseeuw, 1987</xref>) for different cuts of the resulting tree and use the cut with the highest such value to produce a clustering of the data. We find that several of the methods (including CASet and DISC) produce the correct number of clusters (five), and that CASet has the highest average silhouette score (0.85) for this cut (<xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>).</p>
        <p>We perform a similar analysis on the OncoLib dataset, but only compare <inline-formula id="IE45"><mml:math id="IM45"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE46"><mml:math id="IM46"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE47"><mml:math id="IM47"><mml:msub><mml:mrow><mml:mtext>DISC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE48"><mml:math id="IM48"><mml:msub><mml:mrow><mml:mtext>DISC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, MLTED and A–D distance. We do not test parent–child or clonal distance, since they performed poorly on the simpler manual dataset. We also do not apply triplet distance, since it does not have a natural extension to clonal trees with different mutation sets, as are present in the different OncoLib tree families. When the hierarchical clustering is cut at five clusters, all six distance measures correctly clustered the trees, but they did so with varying degrees of tightness (<xref ref-type="fig" rid="btz869-F4">Fig. 4A</xref>). Furthermore, if we consider the cut with the best silhouette score, all methods identified as the optimal hierarchical clustering cut except for <inline-formula id="IE49"><mml:math id="IM49"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, which had an optimal cut at three clusters (<xref ref-type="fig" rid="btz869-F4">Fig. 4B</xref>). <inline-formula id="IE50"><mml:math id="IM50"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> performed best in distinguishing trees belonging to different datasets, with an average silhouette score of 0.81 over the five tree families. While it performs worse at separating different families, <inline-formula id="IE51"><mml:math id="IM51"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> identifies that the pairs A, B and D, E have strong agreement about ancestral relationships among their shared mutations. This highlights the different useful features of <inline-formula id="IE52"><mml:math id="IM52"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE53"><mml:math id="IM53"><mml:msub><mml:mrow><mml:mtext>CASet</mml:mtext></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>.
</p>
        <fig id="btz869-F4" orientation="portrait" position="float">
          <label>Fig. 4.</label>
          <caption>
            <p>(<bold>A</bold>) Inter-dataset distance heatmaps of five tree families in the OncoLib dataset. The color of each cell represents the distance between two trees. Average silhouette scores for five clusters are displayed in parentheses to quantify clustering tightness and separation. We note that we normalized the A–D distance by dividing by the total number of possible ancestral relationships, so that all distances were in the interval [0, 1]. While this results in A–D distances that are all relatively small (&lt;0.4), the families still exhibit clear clustering. (<bold>B</bold>) Silhouette scores of clustering the 250 trees in the OncoLib dataset with different distance measures</p>
          </caption>
          <graphic xlink:href="btz869f4"/>
        </fig>
      </sec>
      <sec>
        <title>3.2.3 Intra-family clustering structure</title>
        <p><xref ref-type="fig" rid="btz869-F4">Figure 4</xref> shows that tree family E from the OncoLib dataset might have internal structure, so we took a closer look at the internal clustering structure for this tree family (<xref ref-type="fig" rid="btz869-F5">Fig. 5</xref>). In this dataset, CASet, DISC and MLTED all identify two primary clusters of trees, but CASet and DISC are both able to resolve more complex substructure. In particular, CASet distinguishes between eight strongly defined subfamilies, with an average silhouette score of 0.94. The same eight subfamilies are visible in the DISC heatmap along with a finer-grained resolution within each of these clusters. In contrast, the MLTED heatmap shows less resolution within the two primary categories. None of the other four tree families had internal structure as well-defined as family E, but for a similar analysis of tree family A, see the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>.
</p>
        <fig id="btz869-F5" orientation="portrait" position="float">
          <label>Fig. 5.</label>
          <caption>
            <p>Hierarchical clustering of tree family E shown with corresponding heatmap for pairwise distances. Note that the colormap range has been reduced to provide more contrast</p>
          </caption>
          <graphic xlink:href="btz869f5"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>3.3 Results on real datasets</title>
      <p>We apply our distance measures to two different breast cancer datasets: <xref rid="btz869-B36" ref-type="bibr">Wang <italic>et al.</italic> (2014</xref>) and <xref rid="btz869-B6" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref>. We first apply CASet and DISC to the three potential tumor evolutionary histories reported in <xref rid="btz869-B16" ref-type="bibr">Karpov <italic>et al.</italic> (2018)</xref> recovered using three different methods, PHiSCS (<xref rid="btz869-B18" ref-type="bibr">Malikic <italic>et al.</italic>, 2018</xref>), SciFit (<xref rid="btz869-B37" ref-type="bibr">Zafar <italic>et al.</italic>, 2017</xref>) and SCITE (<xref rid="btz869-B12" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>) applied to single cell sequencing data from a triple negative breast cancer patient (<xref rid="btz869-B36" ref-type="bibr">Wang <italic>et al.</italic>, 2014</xref>) (<xref ref-type="fig" rid="btz869-F6">Fig. 6</xref>). Since CASet and DISC are designed to evaluate the topology of trees in addition to their labels and inheritance, both measures are able to provide more granular information about the similarity of the trees making it possible to conclude that <italic>T</italic><sub>2</sub> is more similar to <italic>T</italic><sub>1</sub> than it is to <italic>T</italic><sub>3</sub>. This is in contrast to MLTED (<xref rid="btz869-B16" ref-type="bibr">Karpov <italic>et al.</italic>, 2018</xref>), which considers these pairs of trees to have the same similarity, and, furthermore, computes the distance between <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>3</sub> as 0 since they can be clonally expanded to match. While it may be useful to evaluate the similarity of trees with regard to such clonal expansion, a tumor evolutionary tree is categorized in part by subclonal populations that represent the evolutionary patterns of the tumor. Ignoring these does not fully take into account the information represented in a tumor evolutionary tree.
</p>
      <fig id="btz869-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>Tumor evolutionary trees inferred by PHiSCS (<italic>T</italic><sub>1</sub>), SciFit (<italic>T</italic><sub>2</sub>) and SCITE (<italic>T</italic><sub>3</sub>) from a triple negative breast cancer patient and corresponding pairwise distances. See the <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref> for full sized images of the trees</p>
        </caption>
        <graphic xlink:href="btz869f6"/>
      </fig>
      <p>We also emphasize the importance of using quantitative measures when comparing reconstructed trees. <xref rid="btz869-B11" ref-type="bibr">Husić <italic>et al.</italic> (2018)</xref> introduced a new tree reconstruction method MIPUP, and when they compare their results to those of another method, LICHeE (<xref rid="btz869-B26" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>), on breast cancer xenoengraftment data sample SA501 (<xref rid="btz869-B6" ref-type="bibr">Eirew <italic>et al.</italic>, 2015</xref>), they use only qualitative analysis to claim their method produces phylogenies closer to those in the original publication. We assess this claim quantitatively by running CASet, DISC, MLTED and A–D on the SA501 tree from <xref rid="btz869-B6" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> and the corresponding trees reconstructed by MIPUP and LICHeE, as reported by <xref rid="btz869-B11" ref-type="bibr">Husić <italic>et al.</italic> (2018)</xref> (<xref rid="btz869-T1" ref-type="table">Table 1</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix</xref>). We find that most of the distances measures reported that in fact the LICHeE tree is more similar to the phylogeny proposed by <xref rid="btz869-B6" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> than the MIPUP tree. The only measures to report the opposite are MLTED (by only a small margin) and <inline-formula id="IE54"><mml:math id="IM54"><mml:msub><mml:mrow><mml:mtext>DISC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>. The MIPUP tree contains many mutations not in the tree proposed by <xref rid="btz869-B6" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> that are clustered together in the tree. As a result, all pairs of these mutations have an empty distinctly inherited set, and therefore act to artificially lower the <inline-formula id="IE55"><mml:math id="IM55"><mml:msub><mml:mrow><mml:mtext>DISC</mml:mtext></mml:mrow><mml:mrow><mml:mo>∪</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> distance. Thus we can see that when considering ancestral patterns of inheritance, the LICHeE tree may in fact better match the original tree.
</p>
      <table-wrap id="btz869-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Pairwise distances between the base tree reported in <xref rid="btz869-B6" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> for sample SA501, and the trees inferred by LICHeE and MIPUP as reported in <xref rid="btz869-B11" ref-type="bibr">Husić <italic>et al.</italic> (2018)</xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Distance measure</th>
              <th rowspan="1" colspan="1">MIPUP to base tree</th>
              <th rowspan="1" colspan="1">LICHeE to base tree</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE56">
                  <mml:math id="IM56">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mtext>CASet</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>∪</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.88</td>
              <td rowspan="1" colspan="1">0.<bold>74</bold></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE57">
                  <mml:math id="IM57">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mtext>CASet</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>∩</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.84</td>
              <td rowspan="1" colspan="1">
                <bold>0.78</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE58">
                  <mml:math id="IM58">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mtext>DISC</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>∪</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.40</bold>
              </td>
              <td rowspan="1" colspan="1">0.60</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE59">
                  <mml:math id="IM59">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mtext>DISC</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>∩</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0.40</td>
              <td rowspan="1" colspan="1">
                <bold>0.38</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MLTED</td>
              <td rowspan="1" colspan="1">
                <bold>0.80</bold>
              </td>
              <td rowspan="1" colspan="1">0.81</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">A–D</td>
              <td rowspan="1" colspan="1">0.70</td>
              <td rowspan="1" colspan="1">
                <bold>0.46</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note</italic>: Bold text indicates which pair of trees are reported to be more similar.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this work, we argue that distance measures designed for tumor evolutionary trees are needed for assessing phylogeny inference methods and for exploring the relationships between sets of evolutionary trees. To this end, we introduce two new tumor evolution distance measures, CASet and DISC. By comparing the common ancestors of all mutation pairs, CASet incorporates differences in both mutation labeling and tree topology. In particular, CASet uses the number of clones that inherit common mutations when weighting the effect of mutation labeling differences between trees. In contrast, DISC pays special attention to the set of mutations that distinguish clones from each other, placing comparatively more emphasis on recently acquired mutations. We extend both distance measures to apply clonal trees with different sets of mutations.</p>
    <p>We demonstrate the differences between CASet and DISC on simulated data and use a clustering application to show that that CASet is better able to distinguish groups of trees than existing distance measures. Moreover, we find that both CASet and DISC can identify complex clustering structure in a space of trees that is missed by other distance measures.</p>
    <p>Using a breast cancer dataset, we show that CASet and DISC are able to differentiate between trees with differing clonal makeups, demonstrating their topological acuity. In addition, we use CASet and DISC to assess trees reconstructed by MIPUP (<xref rid="btz869-B11" ref-type="bibr">Husić <italic>et al.</italic>, 2018</xref>) and LICHeE (<xref rid="btz869-B26" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>) from a breast cancer xenograft dataset (<xref rid="btz869-B6" ref-type="bibr">Eirew <italic>et al.</italic>, 2015</xref>). Our results suggest that the MIPUP tree may not more closely resemble the original hypothesized tree than the LICHeE tree, as is suggested in <xref rid="btz869-B11" ref-type="bibr">Husić <italic>et al.</italic> (2018)</xref> based solely on qualitative analysis.</p>
    <p>Future work is needed to determine the benefits of using CASet or DISC in methods such as GraPhyC (<xref rid="btz869-B10" ref-type="bibr">Govek <italic>et al.</italic>, 2018</xref>) that rely explicitly on distance measures. Our findings on the internal clustering structure of the OncoLib tree families also invite further investigation. It remains to be seen whether the same kind of structure is found in real cancer data—either within sets of trees consistent with data from a single patient or across sets of patients with the same type of cancer. If so, this structure could provide insight into improved tumor phylogeny inference methods or common mutational patterns across patients.</p>
    <p>A number of different methodological extensions may make these distance measures more widely useful. As presented here, both CASet and DISC may allow for violations of the ISA in the form of mutation deletions by simply using a unique label for each deletion. However, future work is needed to allow for more complex violations of the ISA. Also, as currently implemented these distance measures treat all mutations equally. However, a user may wish to weight mutations differently, e.g. weighting mutations to a known driver gene more heavily. Our method could be extended to take a user defined weight for each mutation and then weighting each computed Jaccard distance relative to the sum of the weights of the mutations considered when computing the sets being compared. We also could explore the use of distance measures other than the Jaccard distance in our approach. Specifically, different evolutionary models that account for the difference in transversion rates may be useful when trees only contain SNVs.</p>
    <p>Our analysis indicates that CASet more strongly penalizes edits that have the biggest evolutionary impact, such as those including the root, than other distance measures including DISC. Therefore, we recommend that CASet be used for benchmarking new inference methods since mistakes in inference near the root should be much more costly than mistakes near the leaves. As far as clustering applications, our analysis indicates that CASet may be most useful when a user expects there are sets of trees that are very different from each other whereas DISC should be used to achieve more granularity when clustering sets of relatively similar trees. However, a distance measure that integrates these disparate properties would be very useful for clustering applications. Thus, future work will include development of a method that, rather than using common ancestor and distinctly inherited sets separately, uses a partition of all mutations in each tree. Specifically, each pair of mutations in a tree defines such a partition over all mutations in the tree where components in this partition correspond to the associated commonly and distinctly inherited sets for the mutations being considered. Then, an approach such as the Rand Index could be used to compare these partitions.</p>
    <p>For applications outside of clustering or benchmarking, we encourage users to consider what types of differences between trees they wish to prioritize. Users then should use our experimental results that show how labeling and topology affect the distance measures as a guide for choosing which distance measure is most appropriate for their application. For instance, if differences in labeling close to the root should be emphasized, CASet would be the appropriate choice. On the other hand, DISC would be better suited to comparing shallow trees whose differences occur near the leaves.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz869_Supplementary_Appendix</label>
      <media xlink:href="btz869_supplementary_appendix.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Jack Kupiers for useful conversations related to this work.</p>
    <sec>
      <title>Funding</title>
      <p>This work has been supported by National Science Foundation award IIS-1657380, Elledge, Eugster and Class of ’49 Fellowships from Carleton College. </p>
      <p><italic>Conflict of Interest</italic>: none declared. </p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz869-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Amirouchene-Angelozzi</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Tumor evolution as a therapeutic target</article-title>. <source>Cancer Discov</source>., <volume>7</volume>, <fpage>805</fpage>–<lpage>817</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bille</surname><given-names>P.</given-names></name></person-group> (<year>2005</year>) 
<article-title>A survey on tree edit distance and related problems</article-title>. <source>Theor. Comput. Sci</source>., <volume>337</volume>, <fpage>217</fpage>–<lpage>239</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blakely</surname><given-names>C.M.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Evolution and clinical impact of co-occurring genetic alterations in advanced-stage EGFR-mutant lung cancers</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>1693</fpage>–<lpage>1704</lpage>.<pub-id pub-id-type="pmid">29106415</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Bonizzoni</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) Does relaxing the infinite sites assumption give better tumor phylogenies? An ILP-based comparative approach. <italic>IEEE/ACM Trans. Comput. Biol. Bioinformatics</italic>
<bold>16, </bold>1410–1423. </mixed-citation>
    </ref>
    <ref id="btz869-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Critchlow</surname><given-names>D.E.</given-names></name></person-group><etal>et al</etal> (<year>1996</year>) 
<article-title>The triples distance for rooted bifurcating phylogenetic trees</article-title>. <source>Syst. Biol</source>., <volume>45</volume>, <fpage>323</fpage>–<lpage>334</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eirew</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Dynamics of genomic clones in breast cancer patient xenografts at single-cell resolution</article-title>. <source>Nature</source>, <volume>518</volume>, <fpage>422</fpage>.<pub-id pub-id-type="pmid">25470049</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>El-Kebir</surname><given-names>M.</given-names></name></person-group> (<year>2018</year>) 
<article-title>SPhyR: tumor phylogeny estimation from single-cell sequencing data under loss and error</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i671</fpage>–<lpage>i679</lpage>.<pub-id pub-id-type="pmid">30423070</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>El-Kebir</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>i62</fpage>–<lpage>i70</lpage>.<pub-id pub-id-type="pmid">26072510</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>El-Kebir</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Inferring the mutational history of a tumor using multi-state perfect phylogeny mixtures</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>43</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">27467246</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Govek</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) <chapter-title>A consensus approach to infer tumor evolutionary histories</chapter-title> In: <source>2018 ACM International Conference on Bioinformatics, Computational Biology, and Health Informatics, BCB’18</source>, pp. <fpage>63</fpage>–<lpage>72</lpage>. 
<publisher-name>ACM</publisher-name>, 
<publisher-loc>New York, NY, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz869-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Husić</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>MIPUP: minimum perfect unmixed phylogenies for multi-sampled tumors via branchings and ILP</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>769</fpage>–<lpage>777</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jahn</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>86</fpage>.<pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jiang</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Assessing intratumor heterogeneity and tracking longitudinal and spatial clonal evolutionary history by next-generation sequencing</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>113</volume>, <fpage>E5528</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">27573852</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jiao</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>35</fpage>.<pub-id pub-id-type="pmid">24484323</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jolly</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Van Loo</surname><given-names>P.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Timing somatic events in the evolution of cancer</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>95</fpage>.<pub-id pub-id-type="pmid">30041675</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Karpov</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) <chapter-title>A multi-labeled tree edit distance for comparing “clonal trees” of tumor progression</chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Parida</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Ukkonen</surname><given-names>E.</given-names></name></person-group> (eds) <source>18th International Workshop on Algorithms in Bioinformatics (WABI 2018), Volume 113 of Leibniz International Proceedings in Informatics (LIPIcs)</source>. 
<publisher-name>Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik</publisher-name>, 
<publisher-loc>Dagstuhl, Germany</publisher-loc>, pp. <fpage>22:1</fpage>–<lpage>22:19</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>K.I.</given-names></name>, <name name-style="western"><surname>Simon</surname><given-names>R.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Using single cell sequencing data to model the evolutionary history of a tumor</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>27</fpage>.<pub-id pub-id-type="pmid">24460695</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Malikic</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) PhISCS—a combinatorial approach for sub-perfect tumor phylogeny reconstruction via integrative use of single cell and bulk sequencing data. <italic>bioRxiv</italic>.</mixed-citation>
    </ref>
    <ref id="btz869-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Malikic</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Clonality inference in multiple tumor samples using phylogeny</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1349</fpage>–<lpage>1356</lpage>.<pub-id pub-id-type="pmid">25568283</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marass</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A phylogenetic latent feature model for clonal deconvolution</article-title>. <source>Ann. Appl. Stat</source>., <volume>10</volume>, <fpage>2377</fpage>–<lpage>2404</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Matsui</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>phyc: clustering cancer evolutionary trees</article-title>. <source>PLoS Comput. Biol</source>., <volume>13</volume>, <fpage>e1005509</fpage>.<pub-id pub-id-type="pmid">28459850</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mir</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>A new balance index for phylogenetic trees</article-title>. <source>Math. Biosci</source>., <volume>241</volume>, <fpage>125</fpage>–<lpage>136</lpage>.<pub-id pub-id-type="pmid">23142312</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Miura</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Computational enhancement of single-cell sequences for inferring tumor evolution</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i917</fpage>–<lpage>i926</lpage>.<pub-id pub-id-type="pmid">30423071</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Niknafs</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Subclonal hierarchy inference from somatic mutations: automatic reconstruction of cancer evolutionary trees from multi-region next generation sequencing</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004416</fpage>.<pub-id pub-id-type="pmid">26436540</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nowell</surname><given-names>P.C.</given-names></name></person-group> (<year>1976</year>) 
<article-title>The clonal evolution of tumor cell populations</article-title>. <source>Science</source>, <volume>194</volume>, <fpage>23</fpage>–<lpage>28</lpage>.<pub-id pub-id-type="pmid">959840</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Popic</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>91</fpage>.<pub-id pub-id-type="pmid">25944252</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B27">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Pradhan</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>El-Kebir</surname><given-names>M.</given-names></name></person-group> (<year>2018</year>) <chapter-title>On the non-uniqueness of solutions to the perfect phylogeny mixture problem</chapter-title> In: <source>RECOMB International Conference on Comparative Genomics</source>, RECOMB-CG’18, pp. <fpage>277</fpage>–<lpage>293</lpage>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>Berlin</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz869-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Raphael</surname><given-names>B.J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Identifying driver mutations in sequenced cancer genomes: computational approaches to enable precision medicine</article-title>. <source>Genome Med</source>., <volume>6</volume>, <fpage>5</fpage>.<pub-id pub-id-type="pmid">24479672</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>D.F.</given-names></name>, <name name-style="western"><surname>Foulds</surname><given-names>L.R.</given-names></name></person-group> (<year>1981</year>) 
<article-title>Comparison of phylogenetic trees</article-title>. <source>Math. Biosci</source>., <volume>53</volume>, <fpage>131</fpage>–<lpage>147</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ross</surname><given-names>E.M.</given-names></name>, <name name-style="western"><surname>Markowetz</surname><given-names>F.</given-names></name></person-group> (<year>2016</year>) 
<article-title>OncoNEM: inferring tumor evolution from single-cell sequencing data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>69</fpage>.<pub-id pub-id-type="pmid">27083415</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rousseeuw</surname><given-names>P.J.</given-names></name></person-group> (<year>1987</year>) 
<article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J. Comput. Appl. Math</source>., <volume>20</volume>, <fpage>53</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="btz869-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Satas</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Raphael</surname><given-names>B.J.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Tumor phylogeny inference using tree-constrained importance sampling</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>i152</fpage>–<lpage>i160</lpage>.<pub-id pub-id-type="pmid">28882002</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schwartz</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Schäffer</surname><given-names>A.A.</given-names></name></person-group> (<year>2017</year>) 
<article-title>The evolution of tumour phylogenetics: principles and practice</article-title>. <source>Nat. Rev. Genet</source>., <volume>18</volume>, <fpage>213</fpage>–<lpage>229</lpage>.<pub-id pub-id-type="pmid">28190876</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Tomlinson</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Oesper</surname><given-names>L.</given-names></name></person-group> (<year>2018</year>) <chapter-title>Examining tumor phylogeny inference in noisy sequencing data</chapter-title> In: <source>2018 IEEE International Conference on Bioinformatics and Biomedicine</source>, BIBM’18, pp. <fpage>36</fpage>–<lpage>43</lpage>. 
<publisher-name>IEEE</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btz869-B35">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Toosi</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) <chapter-title>BAMSE: Bayesian model selection for tumor phylogeny inference among multiple tumor samples</chapter-title> In: <source>2017 IEEE 7th International Conference on Computational Advances in Bio and Medical Sciences (ICCABS)</source>, pp. <fpage>1</fpage>–<lpage>1</lpage>. 
<publisher-name>IEEE</publisher-name>, Orlando, FL. </mixed-citation>
    </ref>
    <ref id="btz869-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Clonal evolution in breast cancer revealed by single nucleus genome sequencing</article-title>. <source>Nature</source>, <volume>512</volume>, <fpage>155</fpage>–<lpage>160</lpage>.<pub-id pub-id-type="pmid">25079324</pub-id></mixed-citation>
    </ref>
    <ref id="btz869-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zafar</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>178</fpage>.<pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
