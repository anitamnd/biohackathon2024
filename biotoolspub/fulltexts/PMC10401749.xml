<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10401749</article-id>
    <article-id pub-id-type="pmid">37537536</article-id>
    <article-id pub-id-type="publisher-id">5434</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05434-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Boosting variant-calling performance with multi-platform sequencing data using Clair3-MP</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Huijing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zheng</surname>
          <given-names>Zhenxian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Su</surname>
          <given-names>Junhao</given-names>
        </name>
        <address>
          <email>jhsu@cs.hku.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lam</surname>
          <given-names>Tak-Wah</given-names>
        </name>
        <address>
          <email>twlam@cs.hku.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Luo</surname>
          <given-names>Ruibang</given-names>
        </name>
        <address>
          <email>rbluo@cs.hku.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02zhqgq86</institution-id><institution-id institution-id-type="GRID">grid.194645.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 2174 2757</institution-id><institution>Department of Computer Science, </institution><institution>The University of Hong Kong, </institution></institution-wrap>Pok Fu Lam, Hong Kong SAR China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>308</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">With the continuous advances in third-generation sequencing technology and the increasing affordability of next-generation sequencing technology, sequencing data from different sequencing technology platforms is becoming more common. While numerous benchmarking studies have been conducted to compare variant-calling performance across different platforms and approaches, little attention has been paid to the potential of leveraging the strengths of different platforms to optimize overall performance, especially integrating Oxford Nanopore and Illumina sequencing data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We investigated the impact of multi-platform data on the performance of variant calling through carefully designed experiments with a deep learning-based variant caller named Clair3-MP (Multi-Platform). Through our research, we not only demonstrated the capability of ONT-Illumina data for improved variant calling, but also identified the optimal scenarios for utilizing ONT-Illumina data. In addition, we revealed that the improvement in variant calling using ONT-Illumina data comes from an improvement in difficult genomic regions, such as the large low-complexity regions and segmental and collapse duplication regions. Moreover, Clair3-MP can incorporate reference genome stratification information to achieve a small but measurable improvement in variant calling. Clair3-MP is accessible as an open-source project at: <ext-link ext-link-type="uri" xlink:href="https://github.com/HKU-BAL/Clair3-MP">https://github.com/HKU-BAL/Clair3-MP</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">These insights have important implications for researchers and practitioners alike, providing valuable guidance for improving the reliability and efficiency of genomic analysis in diverse applications.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05434-6.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Multi-platform sequencing data</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Variant calling</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Hong Kong Research Grants Council grants GRF</institution>
        </funding-source>
        <award-id>17113721</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>TRS</institution>
        </funding-source>
        <award-id>T21-705/20-N</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Shenzhen Municipal Government General Program</institution>
        </funding-source>
        <award-id>JCYJ20210324134405015</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the URC fund at HKU</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010890</institution-id>
            <institution>Oxford Nanopore Technologies</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par20">The increasing affordability of sequencing technologies and the rapid evolution of variant-calling methods has opened the door to more research and applications for small variant calling in the human genome [<xref ref-type="bibr" rid="CR1">1</xref>]. It has become more common to possess sequencing data from different sequencing platforms to address a broader range of biological problems, including constructing the pangenome in large population genomics projects and maximizing structural variation sensitivity [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Nowadays, the general approach to sequence a genome is through next-generation sequencing (NGS) technology and third-generation sequencing (TGS) technology. The distinct error profiles and read length on different sequencing platforms have prompted benchmarking and discussion of variant calling using different sequencing data [<xref ref-type="bibr" rid="CR8">8</xref>]. Reads generated from NGS technology, like Illumina, are usually short (about 250 bp) and accurate. The methods developed for variant calling using Illumina data, such as GATK [<xref ref-type="bibr" rid="CR9">9</xref>], have shown promising results in most of the human genome regions. However, due to the read length limitation, in regions that contain duplications longer than 1 kbp, it is difficult to further improve variant calling with NGS reads, even with the development of new methods [<xref ref-type="bibr" rid="CR8">8</xref>]. On the other hand, TGS technology like Oxford Nanopore Technologies (ONT) and Pacific Biosciences (PacBio) generate reads ranging from thousands to hundreds of thousands of bases. TGS can produce longer sequences across repetitive and complex genomic regions to which Illumina reads have difficulty being mapped accurately [<xref ref-type="bibr" rid="CR10">10</xref>], providing better coverage for the genome. DeepVariant [<xref ref-type="bibr" rid="CR11">11</xref>] and Clair3 [<xref ref-type="bibr" rid="CR12">12</xref>] are two leading deep-learning-based methods developed for variant calling supporting TGS data. However, ONT data provides lower indel-calling performance due to lower read accuracy, especially in the regions containing homopolymers [<xref ref-type="bibr" rid="CR8">8</xref>]. Therefore, researchers often utilize different platform data for different needs [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par21">There are studies that leverage the strength of different platforms to maximize the performance of variant calling [<xref ref-type="bibr" rid="CR13">13</xref>]. The DeepVariant hybrid model is the first variant caller that reported a case study for combining PacBio and Illumina sequencing data [<xref ref-type="bibr" rid="CR11">11</xref>]. It has shown improvements compared to variant-calling performance using single-platform sequencing data [<xref ref-type="bibr" rid="CR11">11</xref>]. Ratatosk, a later published method for error correction, corrects ONT long reads with short reads using a de Bruijn graph to carry information between the two technologies, thus leveraging the benefits of both [<xref ref-type="bibr" rid="CR14">14</xref>]. However, to the best of our knowledge, there is no thorough study investigating the integration of ONT-Illumina data and ONT-PacBio data in a deep-learning model for variant calling. On the other hand, although benchmarking for variant-calling approaches has revealed that ONT, Illumina PacBio data can lead to various types of performance in different genomic regions or at various coverage, the performance in these circumstances when data from different error profiles and read lengths are combined remains unanswered.</p>
    <p id="Par22">Here, we present Clair3-MP (Multi-Platform) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), which processes multi-platform data combinations, including ONT-Illumina, ONT-PacBio, and PacBio-Illumina, to perform variant calling. Clair3-MP features a neural network that supports multi-platform data and trains a series of new models, tailored to perform variant calling using different multi-platform data. In addition, Clair3-MP can incorporate reference genome stratification information by including a stratification channel in its input tensors. This channel encodes the platform preference into the neural network and enables better variant-calling performance for multi-platform data.<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of Clair3-MP with the ONT-Illumina module. We use ONT-Illumina as an example for calling using Clair3-MP. The platform mentioned in this example can be used on other platforms (e.g., Illumina, PacBio, and ONT). First, candidates from Samtools mpileup are extracted for both ONT and Illumina. Then, the ONT and Illumina pileup candidates are processed independently by the Clair3 pileup models using its respective and recommended parameters. The resulting high-quality candidates are used to phase the alignments in its respective platform, using WhatsHap. Finally, all the pileup candidates from the first step and the phased alignments are processed by the Clair3-MP model trained for ONT-Illumina data</p></caption><graphic xlink:href="12859_2023_5434_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par23">Through our experiments integrating ONT and Illumina reads in Clair3-MP, we observed that sufficient coverage of ONT data (i.e., 30 ×) improves variant-calling performance compared to using only data from either platform. Variant calling using multi-platform data containing 30 × ONT and Illumina data at 10 ×, 20 ×, and 30 × can achieve an F1 score of + 0.0545, + 0.0058, and + 0.0010, respectively, compared to Clair3 with Illumina data at 10 ×, 20 ×, and 30 ×. However, the improvement is not consistent when there is less ONT data in the multi-platform data. Therefore, we recommend performing variant calling using Clair3-MP with ONT-Illumina data with at least 30 × coverage of ONT data. On the other hand, variant calling using multi-platform data containing 10 × Illumina and ONT data at 10 ×, 20 ×, and 30 × can achieve an F1 score of + 0.0379, + 0.0520, + 0.0545, respectively, compared to Clair3 with 10 × Illumina data. This suggests that with low coverage of Illumina data, additional ONT data at any coverage can guarantee improved variant calling with Clair3-MP. We further stratified the variant-calling results of Clair3-MP with 30 × ONT and 30 × Illumina and compared them to Clair3 with 30 × ONT or 30 × Illumina to observe the area of improvement in a setting that contains enough data for both platforms. The stratification analysis reveals that the increased variant-calling performance in Clair3-MP with ONT and Illumina data stems from an improvement in difficult genomic regions. We observed that there are increased SNP and Indel F1 scores of Clair3-MP with ONT and Illumina data compared to Clair3 with ONT or Illumina in these difficult regions: large low-complexity regions (SNPs: from 0.9963 or 0.9844 to 0.9973, Indels: from 0.9392 or 0.9661 to 0.9679), segmental duplication regions (SNPs: from 0.9565 or 0.9177 to 0.9653, Indels: from 0.9022 or 0.9300 to 0.9566), and collapse duplication regions (SNPs: from 0.7797 or 0.4263 to 0.8578, Indels: from 0.8069 or 0.6686 to 0.8444). Therefore, the Clair3-MP model was adjusted to include a new feature about whether a variant candidate is in a difficult region. The adjusted Clair3-MP model resulted in a small improvement (SNPs: from 0.9984 to 0.9985, Indels: 0.9736 to 0.9745), showing that the indication of difficult regions further enhances variant-calling predictions. Our experiments containing data from PacBio revealed that variant-calling performance is high in most cases, with F1 scores of at least 0.9957 when using Clair3-MP with PacBio as part of the multi-platform data or Clair3 with PacBio data only. We also found that there was an improvement in Indels calling with additional Illumina data in Clair3-MP with PacBio data (Clair3 with PacBio: 0.9933, Clair3-MP with PacBio and Illumina: 0.9969). Our work found improvements in using multi-platform data in deep-learning neural networks for variant calling. Researchers are encouraged to use Clair3-MP when using sequencing data from different platforms for variant calling and to be aware of the efficiency of using multi-platforms under various coverage and genomic contexts.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par24">To find the best strategies for variant calling with multi-platform data, we performed whole-genome variant-calling experiments with various coverage of different combinations of Illumina, Pacbio, and ONT sequencing data downloaded from Genome-In-A-Bottle (GIAB) [<xref ref-type="bibr" rid="CR15">15</xref>]. We compared the results between Clair3 and Clair3-MP, and Clair3 call variants from single-platform data and Clair3-MP call variants from multi-platform data. The evaluation was also stratified to different genomic regions for deeper insights into variant-calling performance. We also benchmarked the impact of adding the stratification information into a neural network in this section. All running commands are available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <sec id="Sec3">
      <title>Data description</title>
      <p id="Par25">We conducted the experiments with the datasets collected in the GIAB Ashkenazi Jewish trio (HG002-child, HG003-father, and HG004-mother). The ONT sequencing data was obtained from the Human Pangenome Reference Consortium (HPRC) [<xref ref-type="bibr" rid="CR16">16</xref>] with r9.4.1 chemistry and PromthION flowcell, with high coverage in three samples, HG002 (~ 65 ×), HG003 (~ 77 ×), and HG004 (~ 80 ×), which were base-called via Guppy5. The Illumina sequencing data, obtained from precisionFDA [<xref ref-type="bibr" rid="CR8">8</xref>], were sequenced on the NovaSeq 6000 System with a 2 × 151 bp high coverage PCR-free library. All three samples had coverage of 35x. The PacBio HiFi sequencing data was also from precisionFDA [<xref ref-type="bibr" rid="CR8">8</xref>] from the Sequel II System with 2.0 chemistry and coverage of 35 × for all three samples. The BAM files were obtained using the respective alignment software based on the platform of the sequencing data. Minimap2 [<xref ref-type="bibr" rid="CR17">17</xref>] was applied to ONT data. Burrows-Wheeler Aligner (BWA) [<xref ref-type="bibr" rid="CR18">18</xref>] was used for Illumina data, and pbmm2 [<xref ref-type="bibr" rid="CR17">17</xref>] was used for PacBio data. All alignments used the GRCh38 human reference build. The commands for BAM files generation can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. For the Clair3-MP models, each multi-platform combination has its own trained model. For training each multi-platform model, we used the nine following coverages: 10 ×–10 ×, 10 ×–20 ×, 10 ×–30 ×, 20 ×–10 ×, 20 ×–20 ×, 20 ×–30 ×, 30 ×–10 ×, 30 ×–20 ×, and 30 ×–30 ×. We designed the training data in various coverage combinations to establish a model for improving robustness. HG002 and HG004 samples were used for training the Clair3-MP model. HG003 data were preserved for testing and were downsampled to 10 ×, 20 ×, and 30 ×. Downsampling operations for both training and testing datasets were carried out using Samtools [<xref ref-type="bibr" rid="CR19">19</xref>]. The related commands can also be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. We downloaded the GIAB benchmark variant set version 4.2.1 as the ground truth variant sets for HG002, HG003, and HG004. The training and benchmark were constrained in the high-confidence regions also provided by the GIAB 4.2.1 benchmark set for each GIAB sample.</p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation method</title>
      <p id="Par26">The results obtained by Clair3-MP on multi-platform data and Clair3 on single-platform data were evaluated using the Illumina’s Haplotype Comparison Tools (i.e., hap.py) [<xref ref-type="bibr" rid="CR20">20</xref>]. The code and parameters of hap.py can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/Illumina/hap.py">https://github.com/Illumina/hap.py</ext-link>. We used Precision, Recall, and F1 score metrics to assess the variant-calling performance. The results included performances at SNP and Indel and were stratified based on the genome stratification (version v3.1) defined by GIAB [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Performance on ONT-Illumina</title>
      <p id="Par27">First, we benchmarked the Clair3-MP performance using both ONT and Illumina data with single platform data via Clair3. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the overall performance of variant calling using Clair3-MP with ONT-Illumina data, Clair3 with Illumina data or ONT data at different coverages. Figure <xref rid="Fig2" ref-type="fig">2</xref>C indicates that with 30 × coverage of ONT as part of the multi-platform data, the variant-calling performance was better than using either ONT or Illumina data at any coverage. The F1 scores of variant calling using Clair3-MP with multi-platform data that contains 30 × ONT and Illumina data at 10 ×, 20 ×, and 30 ×, were 0.9880, 0.9938, and 0.9947, respectively (Table <xref rid="Tab1" ref-type="table">1</xref>). However, the F1 scores of variant calling using Clair3 with Illumina data at 10 ×, 20 ×, and 30 × were 0.9335, 0.988, and 0.9937, while the F1 scores using Clair3 with ONT data at 10 ×, 20 ×, and 30 × were 0.9301, 0.9631 and 0.9696, respectively. The improvement in variant calling demonstrates the capability of Clair3-MP to combine ONT and Illumina data for higher performance. On the other hand, a decrease in the performance for variant calling that contains less ONT data suggests that lower-coverage ONT data might introduce background noise to calling, as there could be less or even no read support for variant candidates (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B).<fig id="Fig2"><label>Fig. 2</label><caption><p>Overall F1 scores for variant calling using ONT-Illumina and single-platform sequencing datasets at different coverage. <bold>A</bold> 10 × ONT and Illumina at 10 ×, 20 × or 30 ×. <bold>B</bold> 20 × ONT and Illumina at 10 ×, 20 × or 30 ×. <bold>C</bold> 30 × ONT and Illumina at 10 ×, 20 × or 30 ×. Each subplot contains different coverage of ONT in the multi-platform data. The x-axis is the F1 score. The y-axis is the coverage of Illumina contained in the multi-platform data. The yellow row represents the F1 score of variant calling using only Illumina data with the coverage labeled on the y-axis. The red row represents the F1 score of variant calling using only ONT data with the coverage indicated by the subplot name. The green row indicates the F1 score of variant calling using ONT and Illumina data, together with the coverage indicated by the y-axis labels and subplot names</p></caption><graphic xlink:href="12859_2023_5434_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>The overall performance of variant calling using single- and multi-platform data (ONT and Illumina)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Caller</th><th align="left">ONT coverage</th><th align="left">Illumina coverage</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">F1 score</th></tr></thead><tbody><tr><td align="left">Single-platform data (ONT or Illumina)</td><td align="left">Clair3</td><td align="left">10 ×</td><td align="left">–</td><td char="." align="char">0.9605</td><td char="." align="char">0.9016</td><td char="." align="char">0.9301</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">–</td><td char="." align="char">0.9816</td><td char="." align="char">0.9453</td><td char="." align="char">0.9631</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">–</td><td char="." align="char">0.9857</td><td char="." align="char">0.9541</td><td char="." align="char">0.9696</td></tr><tr><td align="left"/><td align="left"/><td align="left">–</td><td align="left">10 ×</td><td char="." align="char">0.9240</td><td char="." align="char">0.9432</td><td char="." align="char">0.9335</td></tr><tr><td align="left"/><td align="left"/><td align="left">–</td><td align="left">20 ×</td><td char="." align="char">0.9893</td><td char="." align="char">0.9867</td><td char="." align="char">0.9880</td></tr><tr><td align="left"/><td align="left"/><td align="left">–</td><td align="left">30 ×</td><td char="." align="char">0.9950</td><td char="." align="char">0.9923</td><td char="." align="char">0.9937</td></tr><tr><td align="left">Multi-platform data (ONT-Illumina)</td><td align="left">Clair3-MP</td><td align="left">10 ×</td><td align="left">10 ×</td><td char="." align="char">0.9822</td><td char="." align="char">0.9609</td><td char="." align="char">0.9714</td></tr><tr><td align="left"/><td align="left"/><td align="left">10 ×</td><td align="left">20 ×</td><td char="." align="char">0.9852</td><td char="." align="char">0.9725</td><td char="." align="char">0.9788</td></tr><tr><td align="left"/><td align="left"/><td align="left">10 ×</td><td align="left">30 ×</td><td char="." align="char">0.9860</td><td char="." align="char">0.9739</td><td char="." align="char">0.9799</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">10 ×</td><td char="." align="char">0.9910</td><td char="." align="char">0.9800</td><td char="." align="char">0.9855</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">20 ×</td><td char="." align="char">0.9938</td><td char="." align="char">0.9894</td><td char="." align="char">0.9916</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">30 ×</td><td char="." align="char">0.9946</td><td char="." align="char">0.9906</td><td char="." align="char">0.9926</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">10 ×</td><td char="." align="char">0.9931</td><td char="." align="char">0.9830</td><td char="." align="char">0.9880</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">20 ×</td><td char="." align="char">0.9959</td><td char="." align="char">0.9917</td><td char="." align="char">0.9938</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">30 ×</td><td char="." align="char">0.9966</td><td char="." align="char">0.9929</td><td char="." align="char">0.9947</td></tr></tbody></table></table-wrap></p>
      <p id="Par28">The table shows the precision, recall and F1 score of variant calling using single-platform and multi-platform data at different coverage.</p>
      <p id="Par29">To investigate the impact of ONT or Illumina data as additional data for variant calling, we further present the benchmark results as a marginal graph and divide the results at the SNP and Indel level. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows marginal graphs of the F1 score of variant calling comparing Clair3 with single-platform data and Clair3-MP with ONT-Illumina data at different coverage by variant type. The complete results with recall and precision can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. As Fig. <xref rid="Fig3" ref-type="fig">3</xref>A, we concluded that with insufficient coverage of Illumina data (i.e., less than 15 ×), additional 10 × or more ONT data significantly improves variant-calling performance. With sufficient coverage of Illumina data (i.e., more than 15 ×), the additional ONT data is no longer favorable for variant calling unless there is relatively high coverage of ONT (i.e., 20 ×). When having more than sufficient coverage of Illumina data (i.e., 50 ×) and resulting in a high F1 score of 0.9957 with Clair3, additional high coverage of ONT does not lead to an improvement for variant calling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). An additional 10 × ONT even diminishes the performance due to the quality of the variant candidates generated by 10 × ONT data. However, SNPs and Indel have different performance trends (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, C). The addition of more than 10 × ONT data to any coverage of Illumina results in improved SNP-calling performance. On the other hand, we observed an improvement in Indel calling when there was insufficient coverage of Illumina data and high coverage of ONT data. When there is more than 15 × Illumina data, additional ONT data at any coverage decreases the Indel-calling performance. The different trends between SNPs and Indel calling suggest that the additional cover for the genome by long ONT reads can increase SNP-calling performance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), while the Indel errors in ONT data, even with high coverage, affect Indel calling in multi-platform variant calling. Figure <xref rid="Fig4" ref-type="fig">4</xref>A shows the alignments in the Integrative Genomics Viewer (IGV) [<xref ref-type="bibr" rid="CR21">21</xref>] that contain true SNP case, showing that ONT reads provide a broader range of cover for the regions that Illumina reads have trouble being mapped to. The IGV in Fig. <xref rid="Fig4" ref-type="fig">4</xref>B describes a true SNP case that was called in Clair3-MP but not called by Clair3 with ONT or Illumina data, demonstrating the capability of multi-platform data to recover SNP with Clair3-MP.<fig id="Fig3"><label>Fig. 3</label><caption><p>Marginal graph of the F1 score using single-platform data and ONT-Illumina data at different coverage. <bold>A</bold> Overall F1 score in a comparison between Illumina data and ONT-Illumina data. <bold>B</bold> SNP-calling F1 score in a comparison between Illumina data and ONT-Illumina data. <bold>C</bold> Indel-calling F1 score in a comparison between Illumina data and ONT-Illumina data. <bold>D</bold> Overall F1 score in a comparison between ONT data and ONT-Illumina data. <bold>E</bold> SNP-calling F1 score in a comparison between ONT data and ONT-Illumina data. <bold>F</bold> Indel-calling F1 score in a comparison between ONT data and ONT-Illumina data. The x-axis indicates the coverage of a single-platform data included in the variant calling for combining and not combining the various coverage of data from the other platform. Each trend line indicates the coverage of the other platform data added in the variant calling in Clair3-MP. The intersections of the trend lines reveal the optimal case for combining ONT and Illumina data for variant calling</p></caption><graphic xlink:href="12859_2023_5434_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Two true variants called by Clair3-MP with ONT and Illumina (both at 30 ×). <bold>A</bold> A true SNP that was called using ONT-Illumina data in Clair3-MP but not called using Illumina data in Clair3. This variant is at chr13:100081597; it is a homozygous T-to-C substitution. The region is not mapped by Illumina reads, even though there are reads supporting the allele sequence. By covering the regions that Illumina reads have trouble being aligned to, with ONT’s long reads, ONT-Illumina data increases the performance of SNP calling with Clair3-MP. <bold>B</bold> A true SNP that was called using ONT-Illumina data in Clair3-MP but not called using either ONT or Illumina data in Clair3. This variant is at chr10:54717216; it is a heterozygous C-to-T substitution. The region is mapped by ambiguous Illumina reads with mapping quality of 0, meaning that these reads can be mapped to other regions too. However, with only ONT data, there is not enough support for prediction. The variant was called when combining ONT and Illumina data, showing the capability of Clair3-MP to recover true variants that are not called using only ONT or Illumina data</p></caption><graphic xlink:href="12859_2023_5434_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par30">Figure <xref rid="Fig3" ref-type="fig">3</xref>D–F show line charts of the F1 score of variant calling comparing Clair3 with ONT data and Clair3-MP with ONT-Illumina data at different coverage by variant type. Other than in SNP calling using sufficient coverage of ONT data (i.e., 30 ×) with low coverage of Illumina data (i.e., 10 ×), any additional Illumina data can increase the variant-calling performance using only ONT data. This indicates that additional and accurate Illumina reads can improve calling by providing strong and positive signals, especially in Indel calling, unless the Illumina data is at such low coverage that it decreases the SNP calling performed by high coverage of ONT data.</p>
      <p id="Par31">To expand our understanding of using multi-platform data, we further ran all single-platform datasets with GATK, DeepVariant and PEPPER [<xref ref-type="bibr" rid="CR22">22</xref>], which are known as the state-of-the-art variant calling methods and compared them with Clair3-MP. Using ONT-Illumina data with Clair3-MP resulted in a higher overall F1 score than using Illumina data with GATK except when combining Illumina data with 10 × ONT data with Clair3-MP. On the other hand, compared to the overall high performance by Illumina data with DeepVariant, using ONT-Illumina data with Clair3-MP exhibited a better F1 score at low coverages (i.e., 10 × ONT and 10 × Illumina). As the overall F1 score of PEPPER using ONT data are very similar to that of Clair3, the observations also show us that additional Illumina data can improve variant calling when combined with ONT data. The complete results can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 and the commands for running the software are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec6">
      <title>Performance of various stratification regions on ONT-Illumina</title>
      <p id="Par32">We further divided the performance results for ONT-Illumina into different reference genome regions to explore the reference impact when using multi-platform data. The reference genome regions (stratification) were obtained from GIAB. There are 10 major types of stratification: Low Complexity, Functional Technically Difficult, Genome Specific, Functional Regions, GC Content, Mappability, Other Difficulties, Segmental Duplications, Union, Ancestry, and XY. The stratification analysis was conducted using a testing datasets of 30 × ONT and 30 × Illumina from GIAB HG003.</p>
      <p id="Par33">Figure <xref rid="Fig5" ref-type="fig">5</xref>A shows SNP-calling performance with Clair3-MP combining 30 × ONT and 30 × Illumina data compared to using either ONT or Illumina data in Clair3 in eight stratification regions. The complete figures and tables stratifying the results of SNP calling into all the different genomic regions are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 to S2 and Tables S2 to S4. Figure <xref rid="Fig5" ref-type="fig">5</xref>A shows that the SNP F1 score of Clair3-MP 30 × ONT-Illumina data (large repeat regions F1 score: 0.9973, satellites regions: 0.9965, segmental duplications regions: 0.9653, segmental duplications region longer than 10 Kbp: 0.9605) outperformed both Clair3 with 30 × ONT data (large repeat regions F1 score: 0.9963, satellites regions: 0.9936, segmental duplication regions: 0.9565, segmental duplication regions longer than 10 Kbp: 0.9501) and Clair3 with 30 × Illumina data (large repeat regions F1 score: 0.9844, satellites regions: 0.9861, segmental duplications regions: 0.9177, segmental duplications regions longer than 10 Kbp: 0.9087). The SNP F1 scores using either ONT or Illumina data with Clair3 have very similar values in the regions with GC content that is less than 30% or greater than 55%, which are 0.9947 and 0.9951. This shows that this region is well-covered by either ONT or Illumina and that SNP calling reaches a relatively high performance with Clair3. When ONT and Illumina are combined with Clair3-MP, the performance can be improved to 0.9975. This suggests that the integration of ONT and Illumina data in Clair3-MP can enhance SNP calling in regions using either data that already achieved relatively high performance. Also, compared to using only Illumina data for variant calling, Clair3-MP with ONT-Illumina data provides extra coverage for the genome from ONT’s long reads and leverages the strength of both datasets to further improve performance, even in difficult regions.<fig id="Fig5"><label>Fig. 5</label><caption><p>The performance in stratifications for 30 × ONT-Illumina data in comparison with ONT and Illumina data. <bold>A</bold> SNP-calling performance in eight stratifications. <bold>B</bold> Indel-calling performance in eight stratifications. The x-axis is the value for precision, recall and F1 score. The y-axis is the label for data used in the variant calling</p></caption><graphic xlink:href="12859_2023_5434_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par34">On the other hand, we also found a list of regions that are challenging for Clair3-MP. Collapsed duplication FP regions and population CNV FP regions are both related to collapsed duplications errors in the GRCh38, recently identified and corrected by the T2T consortium [<xref ref-type="bibr" rid="CR23">23</xref>]. These regions are populated with paralog-specific variants (PSV)—variation among paralogous sequences, which impact short-read variant calling [<xref ref-type="bibr" rid="CR24">24</xref>]. In addition, the long segmental duplications with high sequence identity are a challenge for long-read mapping accuracy [<xref ref-type="bibr" rid="CR24">24</xref>]. Therefore, we found lower SNPs F1 scores using only ONT or Illumina data (collapsed duplication FP regions for either ONT or Illumina: 0.7797, 0.4263; population CNV FP regions: 0.9115, 0.7720). Although challenges for ONT and Illumina reads vary in this region, the combination of ONT and Illumina data demonstrates great improvement in SNP F1 scores (collapsed duplication FP regions: 0.8578; population CNV FP regions: 0.9299). Moreover, other difficult regions that are enriched by variants with excess heterozygosity, which are defined by the InbreedingCoeff from the gnomAD database, were found to contain numerous false positives in variant calling [<xref ref-type="bibr" rid="CR23">23</xref>]. This is also reflected by our benchmark—the precision for SNP calling with only Illumina data is 0.5022. Like the collapsed duplication regions, the precision of SNP calling using ONT-Illumina data was increased to 0.9223 in this region, leading to an improvement in the F1 score from 0.6192 to 0.9261. This shows the capability of multi-platform data to improve variant-calling performance in difficult regions that are not accurately called by either single-platform dataset.</p>
      <p id="Par35">In contrast, Indel calling using both data sets decreased for most of the genomic regions due to the high indel error rate in ONT reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S3 to S4 and Tables S2 to S4). However, similar to the improvement for SNP calling, Fig. <xref rid="Fig5" ref-type="fig">5</xref>B shows that the indels F1 score of Clair3-MP 30 × ONT-Illumina data (large repeat regions F1 score: 0.9679, segmental duplication regions: 0.9566, segmental duplication regions longer than 10 Kbp: 0.9524, collapsed duplication regions: 0.8444, population CNV FP regions: 0.8995) outperformed both Clair3 with 30 × ONT data (large repeat regions F1 score: 0.9392, segmental duplication regions: 0.9022, segmental duplication regions longer than 10 Kbp: 0.8969, collapsed duplication regions: 0.8069, population CNV FP regions: 0.8667) and Clair3 with 30 × Illumina data (large repeat regions F1 score: 0.9661, segmental duplication regions: 0.9300, segmental duplication regions longer than 10 Kbp: 0.9232, collapsed duplication regions: 0.6686, population CNV FP regions: 0.7539). In addition, we found improvement in the indel F1 score in low mappability regions (Clair3 with ONT: 0.9066; Clair3 with Illumina: 0.9026; Clair3-MP with ONT-Illumina: 0.9422). The improvement of Indel calling in these regions indicates that ONT and Illumina data can compensate for each other and that ONT reads do not introduce misleading signals for incorrect prediction. More importantly, in the regions that do not overlap with any tandem repeats or homopolymers, the ONT-Illumina data results in a slight improvement in the indel F1 score (Clair3 with ONT: 0.9758; Clair3 with Illumina: 0.9935; Clair3-MP with ONT-Illumina: 0.9938). This hints that the noise/misleading signals of Indel calling caused by the Indel error rate lie in the regions with tandem repeats and homopolymers. Although there are regions with a higher F1 score using Clair3-MP with ONT-Illumina data in indel calling, these regions account for only small parts of the genome, and the improvement cannot compensate for the lower performance in the other genomic regions.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance with the addition of stratification information to Clair3-MP</title>
      <p id="Par36">This section describes the benchmarking results of adding stratification information as a feature to the Clair3-MP full-alignment model. Based on the “Stratification on ONT-Illumina” results, we observed that the performance of Clair3-MP with ONT-Illumina data varies across different genomic regions and improved in difficult regions. We investigated whether using various genomic information for multi-platform data can further improve variant-calling performance. We integrated the stratification information, which is interpreted as whether the variant candidate is in a difficult genomic region defined by the GIAB BED file, into Clair3-MP and trained a new ONT-Illumina model from GIAB HG002 data. We compared the newly trained model (with stratification information) with the original Clair3-MP model and tested their performance at the sequencing data of 30 × ONT and 30 × Illumina from HG003 chromosome 20, which has always been excluded from model training. Figure <xref rid="Fig6" ref-type="fig">6</xref> is the F1 score of SNPs and Indel calling using the original Clair3-MP model compared to the Clair3-MP model with the stratification information added. It shows that including the information about whether the variant candidate is in a difficult genomic region for prediction yields comparable results. Adding the stratification increases the performance of SNPs (original Clair3-MP: 0.9984, new Clair3-MP: 0.9985) and Indel calling in Clair3-MP (original Clair3-MP: 0.9736, new Clair3-MP: 0.9745). This small but measurable improvement provides the important message that if a variant candidate is in a difficult region, Clair3-MP not only combines the ONT and Illumina data, but also allocates them based on the difficulty of the region, for best variant-calling performance.<fig id="Fig6"><label>Fig. 6</label><caption><p>The F1 score for variant calling, original Clair3-MP model v.s.Clair3-MP model with the stratification channel. The red column is the F1 score for variant calling using the original Clair3-MP model, and the yellow column indicates the F1 score for variant calling using the Clair3-MP model trained with the stratification information</p></caption><graphic xlink:href="12859_2023_5434_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Performance on ONT-PacBio and PacBio-Illumina</title>
      <p id="Par37">In this section, we present variant-calling performance using Clair3-MP with multi-platform data involving PacBio data. Featuring long- and high-read accuracy, PacBio was benchmarked with a high F1 score (&gt; 0.99) in variant calling [<xref ref-type="bibr" rid="CR8">8</xref>]. We explored the effect of using PacBio data as a part of the data within a multi-platform framework. We trained two new models for ONT-PacBio and PacBio-Illumina data and tested the performance with HG003 data. We compared the performance of the newly trained models with Clair3. The execution commands are available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par38">Figure <xref rid="Fig7" ref-type="fig">7</xref> is a column chart that shows the F1 score in variant calling in three areas—overall performance, SNP calling and Indel calling—with different data combinations. We found that Clair3-MP with PacBio and other platform data achieved results comparable to Clair3 with PacBio data. Variant-calling performance was high, with at least a 0.9957 F1 score in most cases when PacBio was part of the multi-platform data or as single-platform data. Of note, Indel calling using Clair3-MP with PacBio-Illumina data had an F1 score of 0.9969, which was higher than 0.9933 using Clair3 with PacBio data. This suggests that due to the higher indel error rate in PacBio data compared to Illumina data, additional sufficient and accurate Illumina data containing fewer indel errors can improve the performance in Indel calling with Clair3-MP, but not in SNP calling. However, Clair3-MP with ONT-PacBio had a worse performance in variant calling than Clair3 with PacBio (PacBio: 0.9990, ONT-PacBio: 0.9986) and Indel calling (PacBio: 0.9933, ONT-PacBio: 0.9771). The decrease in indel-calling performance echoes back to the impact of ONT discussed earlier, whereby the indel error rate affected Indel calling in multi-platform data. The slight decrease in SNP calling suggests that Clair3-MP still has room for improvement to eliminate noise from the ONT reads.<fig id="Fig7"><label>Fig. 7</label><caption><p>The F1 score of variant calling using multi-platform data involving the PacBio and single-platform datasets. The red, yellow, and green columns indicate the F1 score of variant calling using only 30 × PacBio data, 30 × Illumina data, and 30 × ONT data, respectively. The blue column shows the F1 score of variant calling combining 30 × PacBio and 30 × Illumina data in Clair3-MP, and the pink column is the F1 score using 30 × PacBio and 30 × ONT data</p></caption><graphic xlink:href="12859_2023_5434_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec18" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par39">Through a series of extensive experimental investigations conducted in diverse scenarios, we demonstrated that the utilization of multi-platform data with Clair3-MP leads to a notable improvement in variant calling. Our results show that Clair3-MP exhibits robust performance across datasets of varying error profiles and coverage. By stratifying the variant calling results from Clair3-MP with ONT-Illumina data (both at 30 ×), we also found that an even higher performance in SNP calling by Clair3-MP with ONT-Illumina arises primarily from an improvement in large tandem repeat regions, satellite regions, segmental duplication regions, collapsed duplication regions, and GC content regions. The improvement shows that Clair3-MP can leverage the strength of both data sets to reach higher performance. Although overall Indel calling using Clair3-MP with ONT-Illumina data is affected by noise introduced by a higher indel error rate in the ONT reads, we found that Clair3-MP achieves better Indel calling in the large tandem repeat regions, low Illumina-read mappability regions, and segmental duplication and collapsed duplication regions. Based on our stratification analysis, we concluded that Clari3-MP with ONT-Illumina data can attain better variant-calling performance in challenging genomic regions than Clair3 with ONT or Illumina data can. Given this conclusion, we adjusted the Clair3-MP model to include information about whether a variant candidate is in a difficult region to further enhance the variant-calling performance. Adding stratification improves the capability of Clair3-MP with ONT-Illumina data for variant calling in the new model, and the capability to leverage both datasets can be adjusted based on the genomic region. The high performance in variant calling by Clair3 with PacBio data prompted us to investigate whether the inclusion of data from additional platforms could yield even better performance in Clair3-MP. We ensured that the combinations used in Clair3-MP provided sufficient data coverage. We observed that adding 30 × Illumina data to 30 × PacBio data in Clair3-MP resulted in higher performance in Indel calling than Clair3 with PacBio data. However, the impact of Illumina and ONT reads on SNP calling, and overall variant calling in ONT-PacBio data highlights the need for further refinement of the Clair3-MP model to mitigate noise from these sources. On the other hand, our analysis validated the high performance of PacBio data for SNP calling, and don't need to acquire additional other platforms data for SNP calling improvement. Our findings suggest that using PacBio data is suitable for usage scenarios that require top SNP variant calling performance at genomics projects.</p>
    <p id="Par40">The improvement in variant calling using Clair3-MP with ONT-Illumina validates the hypothesis that multi-platform data can leverage the strengths of different sequencing data. It has been previously discussed that for high coverage of ONT data, SNP calling demonstrated improved performance with developed methods due to its broader range of cover for the genome. Therefore, the additional 30 × ONT data to Illumina data in Clair3-MP can compensate for the limitations of Illumina data for SNP calling, resulting in an improvement in overall calling performance. However, with additional ONT data of lower than 20 ×, the performance for variant calling using Clair3-MP with ONT-Illumina is not as improved as with the additional 30 × ONT data. This indicates the relevance of coverage for the ONT data to variant-calling improvement in Clair3-MP. ONT data with lower coverage lacks read support for the allele sequence (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A) and even for the region (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5B), as it introduces background noise in the neural network. Moreover, the decreased indel-calling performance in most of the coverage combinations, even with 30 × ONT data, shows that the high indel error rate of ONT reads adversely impacts variant calling in Clair3-MP with ONT-Illumina data. We provide examples in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6 to illustrate how the presence of multiple insertion sequences supported by ONT data can introduce ambiguity to Illumina read signals, thereby affecting the quality of variant candidates. The histogram in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7 indicates how the quality scores have shifted in the indels called by all Clair3 with Illumina, Clair3 with ONT, and Clair3-MP with both data. The quality scores of indels from Clair3-MP show a decreasing trend compared to Clair3 with Illumina data, providing an overall understanding of how ambiguity among ONT data impacts the quality of indel calling. With the above conclusions and the message conveyed by Fig. <xref rid="Fig3" ref-type="fig">3</xref>, we recommend that researchers perform variant calling using Clair3-MP with ONT-Illumina data with at least 30 × coverage of ONT data. If there is low coverage of Illumina data, additional ONT data at any coverage also guarantees improvement in variant calling with Clair3-MP. Moreover, the acquisition of additional Illumina data at any coverage level can be useful when only ONT data is available, as it has been confirmed to improve variant-calling performance.</p>
    <p id="Par41">The stratification analysis provides valuable insights into variant calling using ONT-Illumina data. It is reasonable to believe that multi-platform data can leverage the strengths of the data and complement the weaknesses of each dataset. Through our stratification analysis, we found that the improvement in variant calling with Clair3-MP lies primarily in the difficult regions, which include the regions in which Illumina reads are susceptible to mapping and duplication resulting from incorrect mapping due to PSVs. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows two cases of true variants in the difficult regions of low mappability and collapse duplication. Figure <xref rid="Fig8" ref-type="fig">8</xref>A is a true SNP in the collapse duplication regions mapped by misaligned Illumina reads due to the PSA in the duplication sequences, and Fig. <xref rid="Fig8" ref-type="fig">8</xref>B is a true variant in a low mappability region, to which only ambiguous Illumina reads can map. In these cases, Clair3-MP leverages the strengths of confident variant candidates from the ONT data to compensate for the ambiguity in Illumina reads. In the regions in which Illumina data have sufficient coverage and high mapping quality, and in which variant calling in Clair3 with only Illumina reads already provides adequate performance, the additional ONT data leads to a decrease in Indel calling performance, such as smaller low complexity regions shorter than 200 bp (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Stratifying the performance of multi-platform data for variant calling in different genomic contexts allows researchers to make informed decisions regarding the use of multi-platform data to achieve optimal performance in their area of interest.<fig id="Fig8"><label>Fig. 8</label><caption><p>Two true variants in difficult regions, that were called using ONT-Illumina data in Clair3-MP. <bold>A</bold> This variant is at chr3:75772913; it is a homozygous C-to-G substitution in the collapse duplication region. The Illumina reads are mapped incorrectly in this region due to PSVs, therefore this variant were not called only using Illumina data, but the ONT read can cover the region. Variant calling in this region with Illumina reads is problematic, so the addition of ONT data helps recover the SNP. <bold>B</bold> This variant is at chr5: 176196642; it is a heterozygous C insertion in a low-mappability region. The region is mapped by ambiguous Illumina reads with mapping quality of 0, meaning that these reads, even with insertion sequences, can be mapped to other regions confidently as well</p></caption><graphic xlink:href="12859_2023_5434_Fig8_HTML" id="MO8"/></fig></p>
    <p id="Par42">The stratifying results clearly demonstrate the capability of Clair3-MP to improve variant calling in difficult genomic regions. To further leverage the strengths of multi-platform data, we adjusted the Clair3-MP model to incorporate information on whether a variant candidate is in a challenging genomic region. The success in improving variant-calling performance hints that a deep-learning network can take into account the genomic context information for higher accuracy. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows the feature activation of a true variant called using only the adjusted Clair3-MP model. No features in the ONT or Illumina reads were activated in the Clair3-MP model, but the features in the Illumina reads were activated intensely in the Clair3-MP stratification model. The re-activation of features suggests that the inclusion of stratification information allows the network to recover true SNPs that were previously missed in the multi-platform data. An additional graph including a true Indel illustrating the activation of features in multiple channels using the adjusted Clair3-MP model can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8.<fig id="Fig9"><label>Fig. 9</label><caption><p>Activation graph of a true variant. <bold>A</bold> The feature activation graph generated using the original Clair3-MP model. <bold>B</bold> The feature activation graph graph generated using the adjusted Clair3-MP model with the stratification channel. This variant was called by the adjusted Clair3-MP model with the stratification channel but was not called in the original Clair3-MP model. The top rows of both graphs are the ONT reads as indicated, and the bottom rows are the Illumina reads</p></caption><graphic xlink:href="12859_2023_5434_Fig9_HTML" id="MO9"/></fig></p>
    <p id="Par43">In our study, we trained the PacBio-involved model to illustrate multi-platform effects when including the PacBio data in Clair3-MP. Our findings demonstrate that the inclusion of data from other platforms with PacBio data leads to comparable results, as Clair3 with PacBio achieved high performance. Therefore, we did not train a three-platform model.</p>
    <p id="Par44">There are some challenges, and future work remains to be done to utilize multiple platform data. We benchmarked Clair3-MP only on whole genome sequencing (WGS) data. Other experiments combined both target region sequencing (like sequencing high-sequencing coverage at targeted sequencing regions) and WGS (like using ONT or PacBio WGS). These designs challenge Clair3-MP for its unbalanced data coverage across the reference genome. In our future research, we aim to enhance the versatility of Clair3-MP by enabling the automatic acceptance of unbalanced data, such as Illumina-only and ONT-only data, in training an ONT-Illumina MP model. However, the current design of Clair3-MP showed marginal improvement in in indel calling. This is due to the high indel error rate in ONT sequencing reads, which confuses the model from converging well. Some techniques, like sequence error correction, realignment, and alignment to consensus, may further improve the calling accuracy.</p>
  </sec>
  <sec id="Sec19" sec-type="conclusion">
    <title>Conclusions</title>
    <p id="Par45">Our studies demonstrate the capability of combining multi-platform data for improving variant calling, and validate the strengths and weaknesses of variant calling using ONT and Illumina data, through various experiments with Clair3-MP. Clair3-MP with ONT-Illumina data outperformed Clair3 with ONT or Illumina data in difficult regions. In addition, the experiments at different coverage provide insights for research involving variant calling using sequencing data from different platforms. Combined with stratification analysis, researchers can decide what the best scenarios are for performing variant calling with multi-platform data based on the nature of the study. Building on the stratification results, we further modified the deep-learning model to better process multi-platform data based on the genomic region, resulting in improvements for both SNPs and indel calling.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Clair3-MP workflow</title>
      <p id="Par46">Clair3-MP has two parts for variant callings: the first part generates high-quality candidates using Clair3’s pileup models to phase the input alignments independently based on the platform; and the second part takes all the phased alignments and pileup candidates extracted prior to the first part and loads them into the Clair3-MP full-alignment model for variant calling. As Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows, Clair3-MP took the alignments from two different sequencing platforms of the same sample. This approach extracts pileup candidates using Samtools mpileup [<xref ref-type="bibr" rid="CR19">19</xref>] and processes them separately in Clair3's pileup models, which are tailored to the specific sequencing platforms. Then, the pileup calls are organized into variant calls (genotypes 0/1, 1/1, and 1/2) and reference calls (0/0), and these two groups are ranked by variant quality (QUAL). The top 70% of heterozygous (genotype 0/1) SNP calls are used to phase the variants and haplotag the alignments using WhatsHap [<xref ref-type="bibr" rid="CR25">25</xref>]. The phased alignments are then fed as input for haplotype-aware full-alignment calling. Lastly, all the pileup candidates are processed again in the designated full-alignment model trained for the platform combination to output one final variant set for this sample. To support the processing of alignments from different platform combinations, Clair3-MP trained a series of full-alignment models, including ONT-Illumina, ONT-PacBio and PacBio-Illumina platform combinations.</p>
    </sec>
    <sec id="Sec13">
      <title>Clair3-MP’s input/output</title>
      <p id="Par47">As the pileup input is processed separately for each sequencing platform through Clair3’s pileup models, during the pileup calling, Clair3-MP utilizes the pileup input design as Clair3, which comprises 594 integers—33 genome positions with 18 features at each position. For full-alignment input, to incorporate details from different platforms, Clair3-MP designed a comprehensive full-alignment input comprising 46,992 integers—eight channels of 33 genome positions and a maximum 178 reads on two platforms. We also attempted to integrate stratification information into full-alignment input to determine the contribution of genomic context to variant-calling performance. Supported by the full-alignment model, which adds the stratification information channel, the input comprises 52,866 integers, with nine channels of features. The output of the pileup model contains only two tasks for efficiency, 21 genotypes, and zygosity, which are also included in the output of the full-alignment models with two more indel length tasks. The details of the pileup and full-alignment features and output tasks are described in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec14">
      <title>Clair3-MP full-alignment model</title>
      <p id="Par48">The Clair3-MP model is an N-to-1 model (N = the number of platforms) that can input all the alignments from different sequencing platforms for the same sample and output one set of variants [<xref ref-type="bibr" rid="CR26">26</xref>]. The Clair3-MP model contains multiple layers, including three standard residual blocks (ResBlock) and for each block, a convolutional layer(Conv) is added on top of it. A spatial pyramid pooling (SPP) layer is used after the third residual block. The details regarding the parameters of the model can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. For each platform, the full-alignment information is converted into eight different feature channels: reference base, alternative base, strand information, mapping quality, base quality, candidate proportion, insertion base, and phasing information channels. An additional stratification information channel is appended using the Clair3-MP stratification model. The information from each platform is aggregated for each channel and used as input for the Clair3-MP model.</p>
    </sec>
    <sec id="Sec15">
      <title>Training the Clair3-MP model</title>
      <p id="Par49">To train the Clair3-MP model with different platform combinations at various coverages, we first used the unified true variants from the Representation Unification module from Clair3 to phase the alignments of ONT, Illumina, and PacBio data. The phased alignments for each platform and each training sample were downsampled to 10 ×, 20 ×, and 30 × for multiple coverage combinations. Then, the Clair3 pileup calling was performed for each downsampled and phased alignment. Each pileup calling candidates group was selected based on the ratio of 1:5 for variant calls and reference calls to avoid introducing a massive number of negative samples in model training. To train the model for each platform combination (i.e., ONT-Illumina, ONT-PacBio, PacBio-Illumina), we used the nine following coverages: 10 ×–10 ×, 10 ×–20 ×, 10 ×–30 ×, 20 ×–10 ×, 20 ×–20 ×, 20 ×–30 ×, 30 ×–10 ×, 30 ×–20 ×, and 30 ×–30 ×. The details regarding the size of training/testing datasets are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. For the validation datasets, 10% of the training samples were randomly selected.</p>
    </sec>
    <sec id="Sec16">
      <title>Training the Clair3-MP model with stratification information</title>
      <p id="Par50">After conducting stratification analyses using the Clair3-MP pre-trained model, we found that the improvement in variant calling using Clair3-MP with ONT and Illumina data came mainly from improvements in difficult regions, which it is difficult to map accurately by the Illumina reads or contain true variants overlapped with the PSV. To account for this, an additional stratification channel was added to the Clair3-MP model, with a 50/100 value, indicating whether the variant candidate is in one of the difficult regions. The difficult regions are defined by ‘alldifficultregions.bed.gz’ from GIAB stratification v2 for the GRCh38 reference genome. This stratification contains a union of difficult genomic regions, such as all tandem repeat regions, difficult-to-map regions, and segmental duplication regions. This stratification was selected after a series of attempts to include different unions of difficulties in the model. We retrained the new Clair3-MP stratification channel from scratch. The results are shown in the section “Performance when stratification information is added to Clair3-MP”.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec17">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5434_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary Materials.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>Indels</term>
        <def>
          <p id="Par4">Insertions and deletions</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par5">Single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>Clair3-MP</term>
        <def>
          <p id="Par6">Clair3 Multi-Platform</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par7">Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TGS</term>
        <def>
          <p id="Par8">Third-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>GATK</term>
        <def>
          <p id="Par9">Genome analysis toolkit</p>
        </def>
      </def-item>
      <def-item>
        <term>ONT</term>
        <def>
          <p id="Par10">Oxford Nanopore Technologies</p>
        </def>
      </def-item>
      <def-item>
        <term>PacBio</term>
        <def>
          <p id="Par11">Pacific Biosciences</p>
        </def>
      </def-item>
      <def-item>
        <term>GIAB</term>
        <def>
          <p id="Par12">Genome-in-a-bottle</p>
        </def>
      </def-item>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par13">Binary alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>HPRC</term>
        <def>
          <p id="Par14">Human Pangenome Reference Consortium</p>
        </def>
      </def-item>
      <def-item>
        <term>BWA</term>
        <def>
          <p id="Par15">Burrows–Wheeler aligner</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par16">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ResBlock</term>
        <def>
          <p id="Par17">Residual blocks</p>
        </def>
      </def-item>
      <def-item>
        <term>Conv</term>
        <def>
          <p id="Par18">Convolutional layer</p>
        </def>
      </def-item>
      <def-item>
        <term>SPP</term>
        <def>
          <p id="Par19">Spatial pyramid pooling</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Huijing Yu and Zhenxian Zheng have contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>RL, TL, and JS conceived the study. HY, JS, and ZZ implemented Clair3-MP. HY and JS designed the experiments. HY analyzed the results and wrote the paper. All authors evaluated the results and revised the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>R.L. was supported by Hong Kong Research Grants Council Grants GRF (17113721) and TRS (T21-705/20-N and T12-703/19-R), the Shenzhen Municipal Government General Program (JCYJ20210324134405015), the URC fund at HKU and Oxford Nanopore Technologies.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Project Name: Clair3-MP</p>
    <p>Project homepage: <ext-link ext-link-type="uri" xlink:href="https://github.com/HKU-BAL/Clair3-MP">https://github.com/HKU-BAL/Clair3-MP</ext-link></p>
    <p>Operating system: Linux</p>
    <p>Programming languages: Python, Shell, C++, C</p>
    <p>License: BSD 3-Clause</p>
    <p>Data availability: The links to the reference genome, truth variant sets, benchmarking materials, and sequencing data from ONT, Illumina, and PacBio can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The commands used in the study are available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. All results, including VCFs and logs, are available at <ext-link ext-link-type="uri" xlink:href="http://www.bio8.cs.hku.hk/clair3_mp">http://www.bio8.cs.hku.hk/clair3_mp</ext-link>.</p>
    <p>Other requirements: Python 3.6.10 or above, pypy 3.6 or above, mpmath 1.2.1, tensorflow 2.2.0, pigz 2.4, zdtd 1.4.4, samtools 1.10 and whatshap 1.0 (these requirements can be installed via the instruction in Clair3-MP github).</p>
    <p>Restrictions for use by non-academics: Free to use.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par51">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par52">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par53">R.L. receives research funding from ONT. The remaining authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dwarshuis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Salit</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variant calling and benchmarking in an era of complete human genome sequences</article-title>
        <source>Nat Rev Genet</source>
        <year>2023</year>
        <volume>24</volume>
        <fpage>464</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-023-00590-0</pub-id>
        <?supplied-pmid 37059810?>
        <pub-id pub-id-type="pmid">37059810</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hassan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Johan</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Mohamed Hashim</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Abdullah</surname>
            <given-names>WZ</given-names>
          </name>
          <name>
            <surname>Esa</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation sequencing (NGS) and third-generation sequencing (TGS) for the diagnosis of thalassemia</article-title>
        <source>Diagnostics (Basel)</source>
        <year>2023</year>
        <volume>13</volume>
        <issue>3</issue>
        <fpage>373</fpage>
        <pub-id pub-id-type="doi">10.3390/diagnostics13030373</pub-id>
        <?supplied-pmid 36766477?>
        <pub-id pub-id-type="pmid">36766477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Antonacci-Fulton</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Human Pangenome Project: a global resource to map genomic diversity</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>604</volume>
        <issue>7906</issue>
        <fpage>437</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04601-8</pub-id>
        <?supplied-pmid 35444317?>
        <pub-id pub-id-type="pmid">35444317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The need for a human pangenome reference sequence</article-title>
        <source>Annu Rev Genom Hum Genet</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>81</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-120120-081921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A pangenome reference of 36 Chinese populations</article-title>
        <source>Nature</source>
        <year>2023</year>
        <volume>619</volume>
        <issue>7968</issue>
        <fpage>112</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-023-06173-7</pub-id>
        <?supplied-pmid 37316654?>
        <pub-id pub-id-type="pmid">37316654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJP</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malhotra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rausch</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1784</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08148-z</pub-id>
        <?supplied-pmid 30992455?>
        <pub-id pub-id-type="pmid">30992455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Brand</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Karczewski</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Alfoldi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Francioli</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A structural variation reference for medical and population genetics</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>581</volume>
        <issue>7809</issue>
        <fpage>444</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2287-8</pub-id>
        <?supplied-pmid 32461652?>
        <pub-id pub-id-type="pmid">32461652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McDaniel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Westreich</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Prasanna</surname>
            <given-names>AG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PrecisionFDA truth challenge V2: calling variants from short and long reads in difficult-to-map regions</article-title>
        <source>Cell Genom</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>5</issue>
        <fpage>100129</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100129</pub-id>
        <?supplied-pmid 35720974?>
        <pub-id pub-id-type="pmid">35720974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <issue>5</issue>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rang</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Kloosterman</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>de Ridder</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>From squiggle to basepair: computational approaches for improving nanopore sequencing read accuracy</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>90</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1462-9</pub-id>
        <?supplied-pmid 30005597?>
        <pub-id pub-id-type="pmid">30005597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Colthurst</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ku</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>10</issue>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <?supplied-pmid 30247488?>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>AW-S</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Symphonizing pileup and full-alignment for deep learning-based long-read variant calling</article-title>
        <source>Nat Comput Sci</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>12</issue>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-022-00387-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramachandran</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lumetta</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Klee</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>HELLO: improved neural network architectures and methodologies for small variant calling</article-title>
        <source>BMC Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>404</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04311-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holley</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Beyter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ingimundardottir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Moller</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Kristmundsdottir</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eggertsson</surname>
            <given-names>HP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ratatosk: hybrid error correction of long reads enables accurate variant calling and assembly</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>28</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02244-4</pub-id>
        <?supplied-pmid 33419473?>
        <pub-id pub-id-type="pmid">33419473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Farek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mahmoud</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking challenging small variants with linked and long reads</article-title>
        <source>Cell Genom</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>5</issue>
        <fpage>100128</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100128</pub-id>
        <?supplied-pmid 36452119?>
        <pub-id pub-id-type="pmid">36452119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pesout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lorig-Roach</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Haukness</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Bosworth</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>9</issue>
        <fpage>1044</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0503-6</pub-id>
        <?supplied-pmid 32686750?>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bonfield</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Liddle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ohan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>MO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Twelve years of SAMtools and BCFtools</article-title>
        <source>Gigascience.</source>
        <year>2021</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>giab008</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giab008</pub-id>
        <?supplied-pmid 33590861?>
        <pub-id pub-id-type="pmid">33590861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Trigg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>De La Vega</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>BL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Best practices for benchmarking germline small-variant calls in human genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>555</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0054-x</pub-id>
        <?supplied-pmid 30858580?>
        <pub-id pub-id-type="pmid">30858580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Thorvaldsdottir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative genomics viewer</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <?supplied-pmid 21221095?>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pesout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kolesnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goel</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-aware variant calling with PEPPER-Margin-DeepVariant enables high accuracy in nanopore long-reads</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1322</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01299-w</pub-id>
        <?supplied-pmid 34725481?>
        <pub-id pub-id-type="pmid">34725481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aganezov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Soto</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Kirsche</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zarate</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Avdeyev</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A complete reference genome improves analysis of human genetic variation</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <issue>6588</issue>
        <fpage>eabl3533</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abl3533</pub-id>
        <?supplied-pmid 35357935?>
        <pub-id pub-id-type="pmid">35357935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prodanov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Sensitive alignment using paralogous sequence variants improves long-read mapping and variant calling in segmental duplications</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>19</issue>
        <fpage>e114</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa829</pub-id>
        <?supplied-pmid 33035301?>
        <pub-id pub-id-type="pmid">33035301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marschall</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>van Iersel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stougie</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>WhatsHap: weighted haplotype assembly for future-generation sequencing reads</article-title>
        <source>J Comput Biol</source>
        <year>2015</year>
        <volume>22</volume>
        <issue>6</issue>
        <fpage>498</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2014.0157</pub-id>
        <?supplied-pmid 25658651?>
        <pub-id pub-id-type="pmid">25658651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Clair3-trio: high-performance nanopore long-read variant calling in family trios with trio-to-trio deep neural networks</article-title>
        <source>Brief Bioinform.</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>5</issue>
        <fpage>bbac301</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbac301</pub-id>
        <?supplied-pmid 35849103?>
        <pub-id pub-id-type="pmid">35849103</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10401749</article-id>
    <article-id pub-id-type="pmid">37537536</article-id>
    <article-id pub-id-type="publisher-id">5434</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05434-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Boosting variant-calling performance with multi-platform sequencing data using Clair3-MP</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Huijing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zheng</surname>
          <given-names>Zhenxian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Su</surname>
          <given-names>Junhao</given-names>
        </name>
        <address>
          <email>jhsu@cs.hku.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lam</surname>
          <given-names>Tak-Wah</given-names>
        </name>
        <address>
          <email>twlam@cs.hku.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Luo</surname>
          <given-names>Ruibang</given-names>
        </name>
        <address>
          <email>rbluo@cs.hku.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02zhqgq86</institution-id><institution-id institution-id-type="GRID">grid.194645.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 2174 2757</institution-id><institution>Department of Computer Science, </institution><institution>The University of Hong Kong, </institution></institution-wrap>Pok Fu Lam, Hong Kong SAR China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>308</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">With the continuous advances in third-generation sequencing technology and the increasing affordability of next-generation sequencing technology, sequencing data from different sequencing technology platforms is becoming more common. While numerous benchmarking studies have been conducted to compare variant-calling performance across different platforms and approaches, little attention has been paid to the potential of leveraging the strengths of different platforms to optimize overall performance, especially integrating Oxford Nanopore and Illumina sequencing data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We investigated the impact of multi-platform data on the performance of variant calling through carefully designed experiments with a deep learning-based variant caller named Clair3-MP (Multi-Platform). Through our research, we not only demonstrated the capability of ONT-Illumina data for improved variant calling, but also identified the optimal scenarios for utilizing ONT-Illumina data. In addition, we revealed that the improvement in variant calling using ONT-Illumina data comes from an improvement in difficult genomic regions, such as the large low-complexity regions and segmental and collapse duplication regions. Moreover, Clair3-MP can incorporate reference genome stratification information to achieve a small but measurable improvement in variant calling. Clair3-MP is accessible as an open-source project at: <ext-link ext-link-type="uri" xlink:href="https://github.com/HKU-BAL/Clair3-MP">https://github.com/HKU-BAL/Clair3-MP</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">These insights have important implications for researchers and practitioners alike, providing valuable guidance for improving the reliability and efficiency of genomic analysis in diverse applications.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05434-6.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Multi-platform sequencing data</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Variant calling</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Hong Kong Research Grants Council grants GRF</institution>
        </funding-source>
        <award-id>17113721</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>TRS</institution>
        </funding-source>
        <award-id>T21-705/20-N</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Shenzhen Municipal Government General Program</institution>
        </funding-source>
        <award-id>JCYJ20210324134405015</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the URC fund at HKU</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010890</institution-id>
            <institution>Oxford Nanopore Technologies</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par20">The increasing affordability of sequencing technologies and the rapid evolution of variant-calling methods has opened the door to more research and applications for small variant calling in the human genome [<xref ref-type="bibr" rid="CR1">1</xref>]. It has become more common to possess sequencing data from different sequencing platforms to address a broader range of biological problems, including constructing the pangenome in large population genomics projects and maximizing structural variation sensitivity [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Nowadays, the general approach to sequence a genome is through next-generation sequencing (NGS) technology and third-generation sequencing (TGS) technology. The distinct error profiles and read length on different sequencing platforms have prompted benchmarking and discussion of variant calling using different sequencing data [<xref ref-type="bibr" rid="CR8">8</xref>]. Reads generated from NGS technology, like Illumina, are usually short (about 250 bp) and accurate. The methods developed for variant calling using Illumina data, such as GATK [<xref ref-type="bibr" rid="CR9">9</xref>], have shown promising results in most of the human genome regions. However, due to the read length limitation, in regions that contain duplications longer than 1 kbp, it is difficult to further improve variant calling with NGS reads, even with the development of new methods [<xref ref-type="bibr" rid="CR8">8</xref>]. On the other hand, TGS technology like Oxford Nanopore Technologies (ONT) and Pacific Biosciences (PacBio) generate reads ranging from thousands to hundreds of thousands of bases. TGS can produce longer sequences across repetitive and complex genomic regions to which Illumina reads have difficulty being mapped accurately [<xref ref-type="bibr" rid="CR10">10</xref>], providing better coverage for the genome. DeepVariant [<xref ref-type="bibr" rid="CR11">11</xref>] and Clair3 [<xref ref-type="bibr" rid="CR12">12</xref>] are two leading deep-learning-based methods developed for variant calling supporting TGS data. However, ONT data provides lower indel-calling performance due to lower read accuracy, especially in the regions containing homopolymers [<xref ref-type="bibr" rid="CR8">8</xref>]. Therefore, researchers often utilize different platform data for different needs [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par21">There are studies that leverage the strength of different platforms to maximize the performance of variant calling [<xref ref-type="bibr" rid="CR13">13</xref>]. The DeepVariant hybrid model is the first variant caller that reported a case study for combining PacBio and Illumina sequencing data [<xref ref-type="bibr" rid="CR11">11</xref>]. It has shown improvements compared to variant-calling performance using single-platform sequencing data [<xref ref-type="bibr" rid="CR11">11</xref>]. Ratatosk, a later published method for error correction, corrects ONT long reads with short reads using a de Bruijn graph to carry information between the two technologies, thus leveraging the benefits of both [<xref ref-type="bibr" rid="CR14">14</xref>]. However, to the best of our knowledge, there is no thorough study investigating the integration of ONT-Illumina data and ONT-PacBio data in a deep-learning model for variant calling. On the other hand, although benchmarking for variant-calling approaches has revealed that ONT, Illumina PacBio data can lead to various types of performance in different genomic regions or at various coverage, the performance in these circumstances when data from different error profiles and read lengths are combined remains unanswered.</p>
    <p id="Par22">Here, we present Clair3-MP (Multi-Platform) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), which processes multi-platform data combinations, including ONT-Illumina, ONT-PacBio, and PacBio-Illumina, to perform variant calling. Clair3-MP features a neural network that supports multi-platform data and trains a series of new models, tailored to perform variant calling using different multi-platform data. In addition, Clair3-MP can incorporate reference genome stratification information by including a stratification channel in its input tensors. This channel encodes the platform preference into the neural network and enables better variant-calling performance for multi-platform data.<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of Clair3-MP with the ONT-Illumina module. We use ONT-Illumina as an example for calling using Clair3-MP. The platform mentioned in this example can be used on other platforms (e.g., Illumina, PacBio, and ONT). First, candidates from Samtools mpileup are extracted for both ONT and Illumina. Then, the ONT and Illumina pileup candidates are processed independently by the Clair3 pileup models using its respective and recommended parameters. The resulting high-quality candidates are used to phase the alignments in its respective platform, using WhatsHap. Finally, all the pileup candidates from the first step and the phased alignments are processed by the Clair3-MP model trained for ONT-Illumina data</p></caption><graphic xlink:href="12859_2023_5434_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par23">Through our experiments integrating ONT and Illumina reads in Clair3-MP, we observed that sufficient coverage of ONT data (i.e., 30 ×) improves variant-calling performance compared to using only data from either platform. Variant calling using multi-platform data containing 30 × ONT and Illumina data at 10 ×, 20 ×, and 30 × can achieve an F1 score of + 0.0545, + 0.0058, and + 0.0010, respectively, compared to Clair3 with Illumina data at 10 ×, 20 ×, and 30 ×. However, the improvement is not consistent when there is less ONT data in the multi-platform data. Therefore, we recommend performing variant calling using Clair3-MP with ONT-Illumina data with at least 30 × coverage of ONT data. On the other hand, variant calling using multi-platform data containing 10 × Illumina and ONT data at 10 ×, 20 ×, and 30 × can achieve an F1 score of + 0.0379, + 0.0520, + 0.0545, respectively, compared to Clair3 with 10 × Illumina data. This suggests that with low coverage of Illumina data, additional ONT data at any coverage can guarantee improved variant calling with Clair3-MP. We further stratified the variant-calling results of Clair3-MP with 30 × ONT and 30 × Illumina and compared them to Clair3 with 30 × ONT or 30 × Illumina to observe the area of improvement in a setting that contains enough data for both platforms. The stratification analysis reveals that the increased variant-calling performance in Clair3-MP with ONT and Illumina data stems from an improvement in difficult genomic regions. We observed that there are increased SNP and Indel F1 scores of Clair3-MP with ONT and Illumina data compared to Clair3 with ONT or Illumina in these difficult regions: large low-complexity regions (SNPs: from 0.9963 or 0.9844 to 0.9973, Indels: from 0.9392 or 0.9661 to 0.9679), segmental duplication regions (SNPs: from 0.9565 or 0.9177 to 0.9653, Indels: from 0.9022 or 0.9300 to 0.9566), and collapse duplication regions (SNPs: from 0.7797 or 0.4263 to 0.8578, Indels: from 0.8069 or 0.6686 to 0.8444). Therefore, the Clair3-MP model was adjusted to include a new feature about whether a variant candidate is in a difficult region. The adjusted Clair3-MP model resulted in a small improvement (SNPs: from 0.9984 to 0.9985, Indels: 0.9736 to 0.9745), showing that the indication of difficult regions further enhances variant-calling predictions. Our experiments containing data from PacBio revealed that variant-calling performance is high in most cases, with F1 scores of at least 0.9957 when using Clair3-MP with PacBio as part of the multi-platform data or Clair3 with PacBio data only. We also found that there was an improvement in Indels calling with additional Illumina data in Clair3-MP with PacBio data (Clair3 with PacBio: 0.9933, Clair3-MP with PacBio and Illumina: 0.9969). Our work found improvements in using multi-platform data in deep-learning neural networks for variant calling. Researchers are encouraged to use Clair3-MP when using sequencing data from different platforms for variant calling and to be aware of the efficiency of using multi-platforms under various coverage and genomic contexts.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par24">To find the best strategies for variant calling with multi-platform data, we performed whole-genome variant-calling experiments with various coverage of different combinations of Illumina, Pacbio, and ONT sequencing data downloaded from Genome-In-A-Bottle (GIAB) [<xref ref-type="bibr" rid="CR15">15</xref>]. We compared the results between Clair3 and Clair3-MP, and Clair3 call variants from single-platform data and Clair3-MP call variants from multi-platform data. The evaluation was also stratified to different genomic regions for deeper insights into variant-calling performance. We also benchmarked the impact of adding the stratification information into a neural network in this section. All running commands are available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <sec id="Sec3">
      <title>Data description</title>
      <p id="Par25">We conducted the experiments with the datasets collected in the GIAB Ashkenazi Jewish trio (HG002-child, HG003-father, and HG004-mother). The ONT sequencing data was obtained from the Human Pangenome Reference Consortium (HPRC) [<xref ref-type="bibr" rid="CR16">16</xref>] with r9.4.1 chemistry and PromthION flowcell, with high coverage in three samples, HG002 (~ 65 ×), HG003 (~ 77 ×), and HG004 (~ 80 ×), which were base-called via Guppy5. The Illumina sequencing data, obtained from precisionFDA [<xref ref-type="bibr" rid="CR8">8</xref>], were sequenced on the NovaSeq 6000 System with a 2 × 151 bp high coverage PCR-free library. All three samples had coverage of 35x. The PacBio HiFi sequencing data was also from precisionFDA [<xref ref-type="bibr" rid="CR8">8</xref>] from the Sequel II System with 2.0 chemistry and coverage of 35 × for all three samples. The BAM files were obtained using the respective alignment software based on the platform of the sequencing data. Minimap2 [<xref ref-type="bibr" rid="CR17">17</xref>] was applied to ONT data. Burrows-Wheeler Aligner (BWA) [<xref ref-type="bibr" rid="CR18">18</xref>] was used for Illumina data, and pbmm2 [<xref ref-type="bibr" rid="CR17">17</xref>] was used for PacBio data. All alignments used the GRCh38 human reference build. The commands for BAM files generation can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. For the Clair3-MP models, each multi-platform combination has its own trained model. For training each multi-platform model, we used the nine following coverages: 10 ×–10 ×, 10 ×–20 ×, 10 ×–30 ×, 20 ×–10 ×, 20 ×–20 ×, 20 ×–30 ×, 30 ×–10 ×, 30 ×–20 ×, and 30 ×–30 ×. We designed the training data in various coverage combinations to establish a model for improving robustness. HG002 and HG004 samples were used for training the Clair3-MP model. HG003 data were preserved for testing and were downsampled to 10 ×, 20 ×, and 30 ×. Downsampling operations for both training and testing datasets were carried out using Samtools [<xref ref-type="bibr" rid="CR19">19</xref>]. The related commands can also be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. We downloaded the GIAB benchmark variant set version 4.2.1 as the ground truth variant sets for HG002, HG003, and HG004. The training and benchmark were constrained in the high-confidence regions also provided by the GIAB 4.2.1 benchmark set for each GIAB sample.</p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation method</title>
      <p id="Par26">The results obtained by Clair3-MP on multi-platform data and Clair3 on single-platform data were evaluated using the Illumina’s Haplotype Comparison Tools (i.e., hap.py) [<xref ref-type="bibr" rid="CR20">20</xref>]. The code and parameters of hap.py can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/Illumina/hap.py">https://github.com/Illumina/hap.py</ext-link>. We used Precision, Recall, and F1 score metrics to assess the variant-calling performance. The results included performances at SNP and Indel and were stratified based on the genome stratification (version v3.1) defined by GIAB [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Performance on ONT-Illumina</title>
      <p id="Par27">First, we benchmarked the Clair3-MP performance using both ONT and Illumina data with single platform data via Clair3. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the overall performance of variant calling using Clair3-MP with ONT-Illumina data, Clair3 with Illumina data or ONT data at different coverages. Figure <xref rid="Fig2" ref-type="fig">2</xref>C indicates that with 30 × coverage of ONT as part of the multi-platform data, the variant-calling performance was better than using either ONT or Illumina data at any coverage. The F1 scores of variant calling using Clair3-MP with multi-platform data that contains 30 × ONT and Illumina data at 10 ×, 20 ×, and 30 ×, were 0.9880, 0.9938, and 0.9947, respectively (Table <xref rid="Tab1" ref-type="table">1</xref>). However, the F1 scores of variant calling using Clair3 with Illumina data at 10 ×, 20 ×, and 30 × were 0.9335, 0.988, and 0.9937, while the F1 scores using Clair3 with ONT data at 10 ×, 20 ×, and 30 × were 0.9301, 0.9631 and 0.9696, respectively. The improvement in variant calling demonstrates the capability of Clair3-MP to combine ONT and Illumina data for higher performance. On the other hand, a decrease in the performance for variant calling that contains less ONT data suggests that lower-coverage ONT data might introduce background noise to calling, as there could be less or even no read support for variant candidates (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B).<fig id="Fig2"><label>Fig. 2</label><caption><p>Overall F1 scores for variant calling using ONT-Illumina and single-platform sequencing datasets at different coverage. <bold>A</bold> 10 × ONT and Illumina at 10 ×, 20 × or 30 ×. <bold>B</bold> 20 × ONT and Illumina at 10 ×, 20 × or 30 ×. <bold>C</bold> 30 × ONT and Illumina at 10 ×, 20 × or 30 ×. Each subplot contains different coverage of ONT in the multi-platform data. The x-axis is the F1 score. The y-axis is the coverage of Illumina contained in the multi-platform data. The yellow row represents the F1 score of variant calling using only Illumina data with the coverage labeled on the y-axis. The red row represents the F1 score of variant calling using only ONT data with the coverage indicated by the subplot name. The green row indicates the F1 score of variant calling using ONT and Illumina data, together with the coverage indicated by the y-axis labels and subplot names</p></caption><graphic xlink:href="12859_2023_5434_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>The overall performance of variant calling using single- and multi-platform data (ONT and Illumina)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Caller</th><th align="left">ONT coverage</th><th align="left">Illumina coverage</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">F1 score</th></tr></thead><tbody><tr><td align="left">Single-platform data (ONT or Illumina)</td><td align="left">Clair3</td><td align="left">10 ×</td><td align="left">–</td><td char="." align="char">0.9605</td><td char="." align="char">0.9016</td><td char="." align="char">0.9301</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">–</td><td char="." align="char">0.9816</td><td char="." align="char">0.9453</td><td char="." align="char">0.9631</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">–</td><td char="." align="char">0.9857</td><td char="." align="char">0.9541</td><td char="." align="char">0.9696</td></tr><tr><td align="left"/><td align="left"/><td align="left">–</td><td align="left">10 ×</td><td char="." align="char">0.9240</td><td char="." align="char">0.9432</td><td char="." align="char">0.9335</td></tr><tr><td align="left"/><td align="left"/><td align="left">–</td><td align="left">20 ×</td><td char="." align="char">0.9893</td><td char="." align="char">0.9867</td><td char="." align="char">0.9880</td></tr><tr><td align="left"/><td align="left"/><td align="left">–</td><td align="left">30 ×</td><td char="." align="char">0.9950</td><td char="." align="char">0.9923</td><td char="." align="char">0.9937</td></tr><tr><td align="left">Multi-platform data (ONT-Illumina)</td><td align="left">Clair3-MP</td><td align="left">10 ×</td><td align="left">10 ×</td><td char="." align="char">0.9822</td><td char="." align="char">0.9609</td><td char="." align="char">0.9714</td></tr><tr><td align="left"/><td align="left"/><td align="left">10 ×</td><td align="left">20 ×</td><td char="." align="char">0.9852</td><td char="." align="char">0.9725</td><td char="." align="char">0.9788</td></tr><tr><td align="left"/><td align="left"/><td align="left">10 ×</td><td align="left">30 ×</td><td char="." align="char">0.9860</td><td char="." align="char">0.9739</td><td char="." align="char">0.9799</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">10 ×</td><td char="." align="char">0.9910</td><td char="." align="char">0.9800</td><td char="." align="char">0.9855</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">20 ×</td><td char="." align="char">0.9938</td><td char="." align="char">0.9894</td><td char="." align="char">0.9916</td></tr><tr><td align="left"/><td align="left"/><td align="left">20 ×</td><td align="left">30 ×</td><td char="." align="char">0.9946</td><td char="." align="char">0.9906</td><td char="." align="char">0.9926</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">10 ×</td><td char="." align="char">0.9931</td><td char="." align="char">0.9830</td><td char="." align="char">0.9880</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">20 ×</td><td char="." align="char">0.9959</td><td char="." align="char">0.9917</td><td char="." align="char">0.9938</td></tr><tr><td align="left"/><td align="left"/><td align="left">30 ×</td><td align="left">30 ×</td><td char="." align="char">0.9966</td><td char="." align="char">0.9929</td><td char="." align="char">0.9947</td></tr></tbody></table></table-wrap></p>
      <p id="Par28">The table shows the precision, recall and F1 score of variant calling using single-platform and multi-platform data at different coverage.</p>
      <p id="Par29">To investigate the impact of ONT or Illumina data as additional data for variant calling, we further present the benchmark results as a marginal graph and divide the results at the SNP and Indel level. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows marginal graphs of the F1 score of variant calling comparing Clair3 with single-platform data and Clair3-MP with ONT-Illumina data at different coverage by variant type. The complete results with recall and precision can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. As Fig. <xref rid="Fig3" ref-type="fig">3</xref>A, we concluded that with insufficient coverage of Illumina data (i.e., less than 15 ×), additional 10 × or more ONT data significantly improves variant-calling performance. With sufficient coverage of Illumina data (i.e., more than 15 ×), the additional ONT data is no longer favorable for variant calling unless there is relatively high coverage of ONT (i.e., 20 ×). When having more than sufficient coverage of Illumina data (i.e., 50 ×) and resulting in a high F1 score of 0.9957 with Clair3, additional high coverage of ONT does not lead to an improvement for variant calling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). An additional 10 × ONT even diminishes the performance due to the quality of the variant candidates generated by 10 × ONT data. However, SNPs and Indel have different performance trends (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, C). The addition of more than 10 × ONT data to any coverage of Illumina results in improved SNP-calling performance. On the other hand, we observed an improvement in Indel calling when there was insufficient coverage of Illumina data and high coverage of ONT data. When there is more than 15 × Illumina data, additional ONT data at any coverage decreases the Indel-calling performance. The different trends between SNPs and Indel calling suggest that the additional cover for the genome by long ONT reads can increase SNP-calling performance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), while the Indel errors in ONT data, even with high coverage, affect Indel calling in multi-platform variant calling. Figure <xref rid="Fig4" ref-type="fig">4</xref>A shows the alignments in the Integrative Genomics Viewer (IGV) [<xref ref-type="bibr" rid="CR21">21</xref>] that contain true SNP case, showing that ONT reads provide a broader range of cover for the regions that Illumina reads have trouble being mapped to. The IGV in Fig. <xref rid="Fig4" ref-type="fig">4</xref>B describes a true SNP case that was called in Clair3-MP but not called by Clair3 with ONT or Illumina data, demonstrating the capability of multi-platform data to recover SNP with Clair3-MP.<fig id="Fig3"><label>Fig. 3</label><caption><p>Marginal graph of the F1 score using single-platform data and ONT-Illumina data at different coverage. <bold>A</bold> Overall F1 score in a comparison between Illumina data and ONT-Illumina data. <bold>B</bold> SNP-calling F1 score in a comparison between Illumina data and ONT-Illumina data. <bold>C</bold> Indel-calling F1 score in a comparison between Illumina data and ONT-Illumina data. <bold>D</bold> Overall F1 score in a comparison between ONT data and ONT-Illumina data. <bold>E</bold> SNP-calling F1 score in a comparison between ONT data and ONT-Illumina data. <bold>F</bold> Indel-calling F1 score in a comparison between ONT data and ONT-Illumina data. The x-axis indicates the coverage of a single-platform data included in the variant calling for combining and not combining the various coverage of data from the other platform. Each trend line indicates the coverage of the other platform data added in the variant calling in Clair3-MP. The intersections of the trend lines reveal the optimal case for combining ONT and Illumina data for variant calling</p></caption><graphic xlink:href="12859_2023_5434_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Two true variants called by Clair3-MP with ONT and Illumina (both at 30 ×). <bold>A</bold> A true SNP that was called using ONT-Illumina data in Clair3-MP but not called using Illumina data in Clair3. This variant is at chr13:100081597; it is a homozygous T-to-C substitution. The region is not mapped by Illumina reads, even though there are reads supporting the allele sequence. By covering the regions that Illumina reads have trouble being aligned to, with ONT’s long reads, ONT-Illumina data increases the performance of SNP calling with Clair3-MP. <bold>B</bold> A true SNP that was called using ONT-Illumina data in Clair3-MP but not called using either ONT or Illumina data in Clair3. This variant is at chr10:54717216; it is a heterozygous C-to-T substitution. The region is mapped by ambiguous Illumina reads with mapping quality of 0, meaning that these reads can be mapped to other regions too. However, with only ONT data, there is not enough support for prediction. The variant was called when combining ONT and Illumina data, showing the capability of Clair3-MP to recover true variants that are not called using only ONT or Illumina data</p></caption><graphic xlink:href="12859_2023_5434_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par30">Figure <xref rid="Fig3" ref-type="fig">3</xref>D–F show line charts of the F1 score of variant calling comparing Clair3 with ONT data and Clair3-MP with ONT-Illumina data at different coverage by variant type. Other than in SNP calling using sufficient coverage of ONT data (i.e., 30 ×) with low coverage of Illumina data (i.e., 10 ×), any additional Illumina data can increase the variant-calling performance using only ONT data. This indicates that additional and accurate Illumina reads can improve calling by providing strong and positive signals, especially in Indel calling, unless the Illumina data is at such low coverage that it decreases the SNP calling performed by high coverage of ONT data.</p>
      <p id="Par31">To expand our understanding of using multi-platform data, we further ran all single-platform datasets with GATK, DeepVariant and PEPPER [<xref ref-type="bibr" rid="CR22">22</xref>], which are known as the state-of-the-art variant calling methods and compared them with Clair3-MP. Using ONT-Illumina data with Clair3-MP resulted in a higher overall F1 score than using Illumina data with GATK except when combining Illumina data with 10 × ONT data with Clair3-MP. On the other hand, compared to the overall high performance by Illumina data with DeepVariant, using ONT-Illumina data with Clair3-MP exhibited a better F1 score at low coverages (i.e., 10 × ONT and 10 × Illumina). As the overall F1 score of PEPPER using ONT data are very similar to that of Clair3, the observations also show us that additional Illumina data can improve variant calling when combined with ONT data. The complete results can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 and the commands for running the software are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec6">
      <title>Performance of various stratification regions on ONT-Illumina</title>
      <p id="Par32">We further divided the performance results for ONT-Illumina into different reference genome regions to explore the reference impact when using multi-platform data. The reference genome regions (stratification) were obtained from GIAB. There are 10 major types of stratification: Low Complexity, Functional Technically Difficult, Genome Specific, Functional Regions, GC Content, Mappability, Other Difficulties, Segmental Duplications, Union, Ancestry, and XY. The stratification analysis was conducted using a testing datasets of 30 × ONT and 30 × Illumina from GIAB HG003.</p>
      <p id="Par33">Figure <xref rid="Fig5" ref-type="fig">5</xref>A shows SNP-calling performance with Clair3-MP combining 30 × ONT and 30 × Illumina data compared to using either ONT or Illumina data in Clair3 in eight stratification regions. The complete figures and tables stratifying the results of SNP calling into all the different genomic regions are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 to S2 and Tables S2 to S4. Figure <xref rid="Fig5" ref-type="fig">5</xref>A shows that the SNP F1 score of Clair3-MP 30 × ONT-Illumina data (large repeat regions F1 score: 0.9973, satellites regions: 0.9965, segmental duplications regions: 0.9653, segmental duplications region longer than 10 Kbp: 0.9605) outperformed both Clair3 with 30 × ONT data (large repeat regions F1 score: 0.9963, satellites regions: 0.9936, segmental duplication regions: 0.9565, segmental duplication regions longer than 10 Kbp: 0.9501) and Clair3 with 30 × Illumina data (large repeat regions F1 score: 0.9844, satellites regions: 0.9861, segmental duplications regions: 0.9177, segmental duplications regions longer than 10 Kbp: 0.9087). The SNP F1 scores using either ONT or Illumina data with Clair3 have very similar values in the regions with GC content that is less than 30% or greater than 55%, which are 0.9947 and 0.9951. This shows that this region is well-covered by either ONT or Illumina and that SNP calling reaches a relatively high performance with Clair3. When ONT and Illumina are combined with Clair3-MP, the performance can be improved to 0.9975. This suggests that the integration of ONT and Illumina data in Clair3-MP can enhance SNP calling in regions using either data that already achieved relatively high performance. Also, compared to using only Illumina data for variant calling, Clair3-MP with ONT-Illumina data provides extra coverage for the genome from ONT’s long reads and leverages the strength of both datasets to further improve performance, even in difficult regions.<fig id="Fig5"><label>Fig. 5</label><caption><p>The performance in stratifications for 30 × ONT-Illumina data in comparison with ONT and Illumina data. <bold>A</bold> SNP-calling performance in eight stratifications. <bold>B</bold> Indel-calling performance in eight stratifications. The x-axis is the value for precision, recall and F1 score. The y-axis is the label for data used in the variant calling</p></caption><graphic xlink:href="12859_2023_5434_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par34">On the other hand, we also found a list of regions that are challenging for Clair3-MP. Collapsed duplication FP regions and population CNV FP regions are both related to collapsed duplications errors in the GRCh38, recently identified and corrected by the T2T consortium [<xref ref-type="bibr" rid="CR23">23</xref>]. These regions are populated with paralog-specific variants (PSV)—variation among paralogous sequences, which impact short-read variant calling [<xref ref-type="bibr" rid="CR24">24</xref>]. In addition, the long segmental duplications with high sequence identity are a challenge for long-read mapping accuracy [<xref ref-type="bibr" rid="CR24">24</xref>]. Therefore, we found lower SNPs F1 scores using only ONT or Illumina data (collapsed duplication FP regions for either ONT or Illumina: 0.7797, 0.4263; population CNV FP regions: 0.9115, 0.7720). Although challenges for ONT and Illumina reads vary in this region, the combination of ONT and Illumina data demonstrates great improvement in SNP F1 scores (collapsed duplication FP regions: 0.8578; population CNV FP regions: 0.9299). Moreover, other difficult regions that are enriched by variants with excess heterozygosity, which are defined by the InbreedingCoeff from the gnomAD database, were found to contain numerous false positives in variant calling [<xref ref-type="bibr" rid="CR23">23</xref>]. This is also reflected by our benchmark—the precision for SNP calling with only Illumina data is 0.5022. Like the collapsed duplication regions, the precision of SNP calling using ONT-Illumina data was increased to 0.9223 in this region, leading to an improvement in the F1 score from 0.6192 to 0.9261. This shows the capability of multi-platform data to improve variant-calling performance in difficult regions that are not accurately called by either single-platform dataset.</p>
      <p id="Par35">In contrast, Indel calling using both data sets decreased for most of the genomic regions due to the high indel error rate in ONT reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S3 to S4 and Tables S2 to S4). However, similar to the improvement for SNP calling, Fig. <xref rid="Fig5" ref-type="fig">5</xref>B shows that the indels F1 score of Clair3-MP 30 × ONT-Illumina data (large repeat regions F1 score: 0.9679, segmental duplication regions: 0.9566, segmental duplication regions longer than 10 Kbp: 0.9524, collapsed duplication regions: 0.8444, population CNV FP regions: 0.8995) outperformed both Clair3 with 30 × ONT data (large repeat regions F1 score: 0.9392, segmental duplication regions: 0.9022, segmental duplication regions longer than 10 Kbp: 0.8969, collapsed duplication regions: 0.8069, population CNV FP regions: 0.8667) and Clair3 with 30 × Illumina data (large repeat regions F1 score: 0.9661, segmental duplication regions: 0.9300, segmental duplication regions longer than 10 Kbp: 0.9232, collapsed duplication regions: 0.6686, population CNV FP regions: 0.7539). In addition, we found improvement in the indel F1 score in low mappability regions (Clair3 with ONT: 0.9066; Clair3 with Illumina: 0.9026; Clair3-MP with ONT-Illumina: 0.9422). The improvement of Indel calling in these regions indicates that ONT and Illumina data can compensate for each other and that ONT reads do not introduce misleading signals for incorrect prediction. More importantly, in the regions that do not overlap with any tandem repeats or homopolymers, the ONT-Illumina data results in a slight improvement in the indel F1 score (Clair3 with ONT: 0.9758; Clair3 with Illumina: 0.9935; Clair3-MP with ONT-Illumina: 0.9938). This hints that the noise/misleading signals of Indel calling caused by the Indel error rate lie in the regions with tandem repeats and homopolymers. Although there are regions with a higher F1 score using Clair3-MP with ONT-Illumina data in indel calling, these regions account for only small parts of the genome, and the improvement cannot compensate for the lower performance in the other genomic regions.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance with the addition of stratification information to Clair3-MP</title>
      <p id="Par36">This section describes the benchmarking results of adding stratification information as a feature to the Clair3-MP full-alignment model. Based on the “Stratification on ONT-Illumina” results, we observed that the performance of Clair3-MP with ONT-Illumina data varies across different genomic regions and improved in difficult regions. We investigated whether using various genomic information for multi-platform data can further improve variant-calling performance. We integrated the stratification information, which is interpreted as whether the variant candidate is in a difficult genomic region defined by the GIAB BED file, into Clair3-MP and trained a new ONT-Illumina model from GIAB HG002 data. We compared the newly trained model (with stratification information) with the original Clair3-MP model and tested their performance at the sequencing data of 30 × ONT and 30 × Illumina from HG003 chromosome 20, which has always been excluded from model training. Figure <xref rid="Fig6" ref-type="fig">6</xref> is the F1 score of SNPs and Indel calling using the original Clair3-MP model compared to the Clair3-MP model with the stratification information added. It shows that including the information about whether the variant candidate is in a difficult genomic region for prediction yields comparable results. Adding the stratification increases the performance of SNPs (original Clair3-MP: 0.9984, new Clair3-MP: 0.9985) and Indel calling in Clair3-MP (original Clair3-MP: 0.9736, new Clair3-MP: 0.9745). This small but measurable improvement provides the important message that if a variant candidate is in a difficult region, Clair3-MP not only combines the ONT and Illumina data, but also allocates them based on the difficulty of the region, for best variant-calling performance.<fig id="Fig6"><label>Fig. 6</label><caption><p>The F1 score for variant calling, original Clair3-MP model v.s.Clair3-MP model with the stratification channel. The red column is the F1 score for variant calling using the original Clair3-MP model, and the yellow column indicates the F1 score for variant calling using the Clair3-MP model trained with the stratification information</p></caption><graphic xlink:href="12859_2023_5434_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Performance on ONT-PacBio and PacBio-Illumina</title>
      <p id="Par37">In this section, we present variant-calling performance using Clair3-MP with multi-platform data involving PacBio data. Featuring long- and high-read accuracy, PacBio was benchmarked with a high F1 score (&gt; 0.99) in variant calling [<xref ref-type="bibr" rid="CR8">8</xref>]. We explored the effect of using PacBio data as a part of the data within a multi-platform framework. We trained two new models for ONT-PacBio and PacBio-Illumina data and tested the performance with HG003 data. We compared the performance of the newly trained models with Clair3. The execution commands are available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par38">Figure <xref rid="Fig7" ref-type="fig">7</xref> is a column chart that shows the F1 score in variant calling in three areas—overall performance, SNP calling and Indel calling—with different data combinations. We found that Clair3-MP with PacBio and other platform data achieved results comparable to Clair3 with PacBio data. Variant-calling performance was high, with at least a 0.9957 F1 score in most cases when PacBio was part of the multi-platform data or as single-platform data. Of note, Indel calling using Clair3-MP with PacBio-Illumina data had an F1 score of 0.9969, which was higher than 0.9933 using Clair3 with PacBio data. This suggests that due to the higher indel error rate in PacBio data compared to Illumina data, additional sufficient and accurate Illumina data containing fewer indel errors can improve the performance in Indel calling with Clair3-MP, but not in SNP calling. However, Clair3-MP with ONT-PacBio had a worse performance in variant calling than Clair3 with PacBio (PacBio: 0.9990, ONT-PacBio: 0.9986) and Indel calling (PacBio: 0.9933, ONT-PacBio: 0.9771). The decrease in indel-calling performance echoes back to the impact of ONT discussed earlier, whereby the indel error rate affected Indel calling in multi-platform data. The slight decrease in SNP calling suggests that Clair3-MP still has room for improvement to eliminate noise from the ONT reads.<fig id="Fig7"><label>Fig. 7</label><caption><p>The F1 score of variant calling using multi-platform data involving the PacBio and single-platform datasets. The red, yellow, and green columns indicate the F1 score of variant calling using only 30 × PacBio data, 30 × Illumina data, and 30 × ONT data, respectively. The blue column shows the F1 score of variant calling combining 30 × PacBio and 30 × Illumina data in Clair3-MP, and the pink column is the F1 score using 30 × PacBio and 30 × ONT data</p></caption><graphic xlink:href="12859_2023_5434_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec18" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par39">Through a series of extensive experimental investigations conducted in diverse scenarios, we demonstrated that the utilization of multi-platform data with Clair3-MP leads to a notable improvement in variant calling. Our results show that Clair3-MP exhibits robust performance across datasets of varying error profiles and coverage. By stratifying the variant calling results from Clair3-MP with ONT-Illumina data (both at 30 ×), we also found that an even higher performance in SNP calling by Clair3-MP with ONT-Illumina arises primarily from an improvement in large tandem repeat regions, satellite regions, segmental duplication regions, collapsed duplication regions, and GC content regions. The improvement shows that Clair3-MP can leverage the strength of both data sets to reach higher performance. Although overall Indel calling using Clair3-MP with ONT-Illumina data is affected by noise introduced by a higher indel error rate in the ONT reads, we found that Clair3-MP achieves better Indel calling in the large tandem repeat regions, low Illumina-read mappability regions, and segmental duplication and collapsed duplication regions. Based on our stratification analysis, we concluded that Clari3-MP with ONT-Illumina data can attain better variant-calling performance in challenging genomic regions than Clair3 with ONT or Illumina data can. Given this conclusion, we adjusted the Clair3-MP model to include information about whether a variant candidate is in a difficult region to further enhance the variant-calling performance. Adding stratification improves the capability of Clair3-MP with ONT-Illumina data for variant calling in the new model, and the capability to leverage both datasets can be adjusted based on the genomic region. The high performance in variant calling by Clair3 with PacBio data prompted us to investigate whether the inclusion of data from additional platforms could yield even better performance in Clair3-MP. We ensured that the combinations used in Clair3-MP provided sufficient data coverage. We observed that adding 30 × Illumina data to 30 × PacBio data in Clair3-MP resulted in higher performance in Indel calling than Clair3 with PacBio data. However, the impact of Illumina and ONT reads on SNP calling, and overall variant calling in ONT-PacBio data highlights the need for further refinement of the Clair3-MP model to mitigate noise from these sources. On the other hand, our analysis validated the high performance of PacBio data for SNP calling, and don't need to acquire additional other platforms data for SNP calling improvement. Our findings suggest that using PacBio data is suitable for usage scenarios that require top SNP variant calling performance at genomics projects.</p>
    <p id="Par40">The improvement in variant calling using Clair3-MP with ONT-Illumina validates the hypothesis that multi-platform data can leverage the strengths of different sequencing data. It has been previously discussed that for high coverage of ONT data, SNP calling demonstrated improved performance with developed methods due to its broader range of cover for the genome. Therefore, the additional 30 × ONT data to Illumina data in Clair3-MP can compensate for the limitations of Illumina data for SNP calling, resulting in an improvement in overall calling performance. However, with additional ONT data of lower than 20 ×, the performance for variant calling using Clair3-MP with ONT-Illumina is not as improved as with the additional 30 × ONT data. This indicates the relevance of coverage for the ONT data to variant-calling improvement in Clair3-MP. ONT data with lower coverage lacks read support for the allele sequence (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A) and even for the region (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5B), as it introduces background noise in the neural network. Moreover, the decreased indel-calling performance in most of the coverage combinations, even with 30 × ONT data, shows that the high indel error rate of ONT reads adversely impacts variant calling in Clair3-MP with ONT-Illumina data. We provide examples in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6 to illustrate how the presence of multiple insertion sequences supported by ONT data can introduce ambiguity to Illumina read signals, thereby affecting the quality of variant candidates. The histogram in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7 indicates how the quality scores have shifted in the indels called by all Clair3 with Illumina, Clair3 with ONT, and Clair3-MP with both data. The quality scores of indels from Clair3-MP show a decreasing trend compared to Clair3 with Illumina data, providing an overall understanding of how ambiguity among ONT data impacts the quality of indel calling. With the above conclusions and the message conveyed by Fig. <xref rid="Fig3" ref-type="fig">3</xref>, we recommend that researchers perform variant calling using Clair3-MP with ONT-Illumina data with at least 30 × coverage of ONT data. If there is low coverage of Illumina data, additional ONT data at any coverage also guarantees improvement in variant calling with Clair3-MP. Moreover, the acquisition of additional Illumina data at any coverage level can be useful when only ONT data is available, as it has been confirmed to improve variant-calling performance.</p>
    <p id="Par41">The stratification analysis provides valuable insights into variant calling using ONT-Illumina data. It is reasonable to believe that multi-platform data can leverage the strengths of the data and complement the weaknesses of each dataset. Through our stratification analysis, we found that the improvement in variant calling with Clair3-MP lies primarily in the difficult regions, which include the regions in which Illumina reads are susceptible to mapping and duplication resulting from incorrect mapping due to PSVs. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows two cases of true variants in the difficult regions of low mappability and collapse duplication. Figure <xref rid="Fig8" ref-type="fig">8</xref>A is a true SNP in the collapse duplication regions mapped by misaligned Illumina reads due to the PSA in the duplication sequences, and Fig. <xref rid="Fig8" ref-type="fig">8</xref>B is a true variant in a low mappability region, to which only ambiguous Illumina reads can map. In these cases, Clair3-MP leverages the strengths of confident variant candidates from the ONT data to compensate for the ambiguity in Illumina reads. In the regions in which Illumina data have sufficient coverage and high mapping quality, and in which variant calling in Clair3 with only Illumina reads already provides adequate performance, the additional ONT data leads to a decrease in Indel calling performance, such as smaller low complexity regions shorter than 200 bp (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Stratifying the performance of multi-platform data for variant calling in different genomic contexts allows researchers to make informed decisions regarding the use of multi-platform data to achieve optimal performance in their area of interest.<fig id="Fig8"><label>Fig. 8</label><caption><p>Two true variants in difficult regions, that were called using ONT-Illumina data in Clair3-MP. <bold>A</bold> This variant is at chr3:75772913; it is a homozygous C-to-G substitution in the collapse duplication region. The Illumina reads are mapped incorrectly in this region due to PSVs, therefore this variant were not called only using Illumina data, but the ONT read can cover the region. Variant calling in this region with Illumina reads is problematic, so the addition of ONT data helps recover the SNP. <bold>B</bold> This variant is at chr5: 176196642; it is a heterozygous C insertion in a low-mappability region. The region is mapped by ambiguous Illumina reads with mapping quality of 0, meaning that these reads, even with insertion sequences, can be mapped to other regions confidently as well</p></caption><graphic xlink:href="12859_2023_5434_Fig8_HTML" id="MO8"/></fig></p>
    <p id="Par42">The stratifying results clearly demonstrate the capability of Clair3-MP to improve variant calling in difficult genomic regions. To further leverage the strengths of multi-platform data, we adjusted the Clair3-MP model to incorporate information on whether a variant candidate is in a challenging genomic region. The success in improving variant-calling performance hints that a deep-learning network can take into account the genomic context information for higher accuracy. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows the feature activation of a true variant called using only the adjusted Clair3-MP model. No features in the ONT or Illumina reads were activated in the Clair3-MP model, but the features in the Illumina reads were activated intensely in the Clair3-MP stratification model. The re-activation of features suggests that the inclusion of stratification information allows the network to recover true SNPs that were previously missed in the multi-platform data. An additional graph including a true Indel illustrating the activation of features in multiple channels using the adjusted Clair3-MP model can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8.<fig id="Fig9"><label>Fig. 9</label><caption><p>Activation graph of a true variant. <bold>A</bold> The feature activation graph generated using the original Clair3-MP model. <bold>B</bold> The feature activation graph graph generated using the adjusted Clair3-MP model with the stratification channel. This variant was called by the adjusted Clair3-MP model with the stratification channel but was not called in the original Clair3-MP model. The top rows of both graphs are the ONT reads as indicated, and the bottom rows are the Illumina reads</p></caption><graphic xlink:href="12859_2023_5434_Fig9_HTML" id="MO9"/></fig></p>
    <p id="Par43">In our study, we trained the PacBio-involved model to illustrate multi-platform effects when including the PacBio data in Clair3-MP. Our findings demonstrate that the inclusion of data from other platforms with PacBio data leads to comparable results, as Clair3 with PacBio achieved high performance. Therefore, we did not train a three-platform model.</p>
    <p id="Par44">There are some challenges, and future work remains to be done to utilize multiple platform data. We benchmarked Clair3-MP only on whole genome sequencing (WGS) data. Other experiments combined both target region sequencing (like sequencing high-sequencing coverage at targeted sequencing regions) and WGS (like using ONT or PacBio WGS). These designs challenge Clair3-MP for its unbalanced data coverage across the reference genome. In our future research, we aim to enhance the versatility of Clair3-MP by enabling the automatic acceptance of unbalanced data, such as Illumina-only and ONT-only data, in training an ONT-Illumina MP model. However, the current design of Clair3-MP showed marginal improvement in in indel calling. This is due to the high indel error rate in ONT sequencing reads, which confuses the model from converging well. Some techniques, like sequence error correction, realignment, and alignment to consensus, may further improve the calling accuracy.</p>
  </sec>
  <sec id="Sec19" sec-type="conclusion">
    <title>Conclusions</title>
    <p id="Par45">Our studies demonstrate the capability of combining multi-platform data for improving variant calling, and validate the strengths and weaknesses of variant calling using ONT and Illumina data, through various experiments with Clair3-MP. Clair3-MP with ONT-Illumina data outperformed Clair3 with ONT or Illumina data in difficult regions. In addition, the experiments at different coverage provide insights for research involving variant calling using sequencing data from different platforms. Combined with stratification analysis, researchers can decide what the best scenarios are for performing variant calling with multi-platform data based on the nature of the study. Building on the stratification results, we further modified the deep-learning model to better process multi-platform data based on the genomic region, resulting in improvements for both SNPs and indel calling.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Clair3-MP workflow</title>
      <p id="Par46">Clair3-MP has two parts for variant callings: the first part generates high-quality candidates using Clair3’s pileup models to phase the input alignments independently based on the platform; and the second part takes all the phased alignments and pileup candidates extracted prior to the first part and loads them into the Clair3-MP full-alignment model for variant calling. As Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows, Clair3-MP took the alignments from two different sequencing platforms of the same sample. This approach extracts pileup candidates using Samtools mpileup [<xref ref-type="bibr" rid="CR19">19</xref>] and processes them separately in Clair3's pileup models, which are tailored to the specific sequencing platforms. Then, the pileup calls are organized into variant calls (genotypes 0/1, 1/1, and 1/2) and reference calls (0/0), and these two groups are ranked by variant quality (QUAL). The top 70% of heterozygous (genotype 0/1) SNP calls are used to phase the variants and haplotag the alignments using WhatsHap [<xref ref-type="bibr" rid="CR25">25</xref>]. The phased alignments are then fed as input for haplotype-aware full-alignment calling. Lastly, all the pileup candidates are processed again in the designated full-alignment model trained for the platform combination to output one final variant set for this sample. To support the processing of alignments from different platform combinations, Clair3-MP trained a series of full-alignment models, including ONT-Illumina, ONT-PacBio and PacBio-Illumina platform combinations.</p>
    </sec>
    <sec id="Sec13">
      <title>Clair3-MP’s input/output</title>
      <p id="Par47">As the pileup input is processed separately for each sequencing platform through Clair3’s pileup models, during the pileup calling, Clair3-MP utilizes the pileup input design as Clair3, which comprises 594 integers—33 genome positions with 18 features at each position. For full-alignment input, to incorporate details from different platforms, Clair3-MP designed a comprehensive full-alignment input comprising 46,992 integers—eight channels of 33 genome positions and a maximum 178 reads on two platforms. We also attempted to integrate stratification information into full-alignment input to determine the contribution of genomic context to variant-calling performance. Supported by the full-alignment model, which adds the stratification information channel, the input comprises 52,866 integers, with nine channels of features. The output of the pileup model contains only two tasks for efficiency, 21 genotypes, and zygosity, which are also included in the output of the full-alignment models with two more indel length tasks. The details of the pileup and full-alignment features and output tasks are described in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec14">
      <title>Clair3-MP full-alignment model</title>
      <p id="Par48">The Clair3-MP model is an N-to-1 model (N = the number of platforms) that can input all the alignments from different sequencing platforms for the same sample and output one set of variants [<xref ref-type="bibr" rid="CR26">26</xref>]. The Clair3-MP model contains multiple layers, including three standard residual blocks (ResBlock) and for each block, a convolutional layer(Conv) is added on top of it. A spatial pyramid pooling (SPP) layer is used after the third residual block. The details regarding the parameters of the model can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. For each platform, the full-alignment information is converted into eight different feature channels: reference base, alternative base, strand information, mapping quality, base quality, candidate proportion, insertion base, and phasing information channels. An additional stratification information channel is appended using the Clair3-MP stratification model. The information from each platform is aggregated for each channel and used as input for the Clair3-MP model.</p>
    </sec>
    <sec id="Sec15">
      <title>Training the Clair3-MP model</title>
      <p id="Par49">To train the Clair3-MP model with different platform combinations at various coverages, we first used the unified true variants from the Representation Unification module from Clair3 to phase the alignments of ONT, Illumina, and PacBio data. The phased alignments for each platform and each training sample were downsampled to 10 ×, 20 ×, and 30 × for multiple coverage combinations. Then, the Clair3 pileup calling was performed for each downsampled and phased alignment. Each pileup calling candidates group was selected based on the ratio of 1:5 for variant calls and reference calls to avoid introducing a massive number of negative samples in model training. To train the model for each platform combination (i.e., ONT-Illumina, ONT-PacBio, PacBio-Illumina), we used the nine following coverages: 10 ×–10 ×, 10 ×–20 ×, 10 ×–30 ×, 20 ×–10 ×, 20 ×–20 ×, 20 ×–30 ×, 30 ×–10 ×, 30 ×–20 ×, and 30 ×–30 ×. The details regarding the size of training/testing datasets are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. For the validation datasets, 10% of the training samples were randomly selected.</p>
    </sec>
    <sec id="Sec16">
      <title>Training the Clair3-MP model with stratification information</title>
      <p id="Par50">After conducting stratification analyses using the Clair3-MP pre-trained model, we found that the improvement in variant calling using Clair3-MP with ONT and Illumina data came mainly from improvements in difficult regions, which it is difficult to map accurately by the Illumina reads or contain true variants overlapped with the PSV. To account for this, an additional stratification channel was added to the Clair3-MP model, with a 50/100 value, indicating whether the variant candidate is in one of the difficult regions. The difficult regions are defined by ‘alldifficultregions.bed.gz’ from GIAB stratification v2 for the GRCh38 reference genome. This stratification contains a union of difficult genomic regions, such as all tandem repeat regions, difficult-to-map regions, and segmental duplication regions. This stratification was selected after a series of attempts to include different unions of difficulties in the model. We retrained the new Clair3-MP stratification channel from scratch. The results are shown in the section “Performance when stratification information is added to Clair3-MP”.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec17">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5434_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary Materials.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>Indels</term>
        <def>
          <p id="Par4">Insertions and deletions</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par5">Single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>Clair3-MP</term>
        <def>
          <p id="Par6">Clair3 Multi-Platform</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par7">Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TGS</term>
        <def>
          <p id="Par8">Third-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>GATK</term>
        <def>
          <p id="Par9">Genome analysis toolkit</p>
        </def>
      </def-item>
      <def-item>
        <term>ONT</term>
        <def>
          <p id="Par10">Oxford Nanopore Technologies</p>
        </def>
      </def-item>
      <def-item>
        <term>PacBio</term>
        <def>
          <p id="Par11">Pacific Biosciences</p>
        </def>
      </def-item>
      <def-item>
        <term>GIAB</term>
        <def>
          <p id="Par12">Genome-in-a-bottle</p>
        </def>
      </def-item>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par13">Binary alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>HPRC</term>
        <def>
          <p id="Par14">Human Pangenome Reference Consortium</p>
        </def>
      </def-item>
      <def-item>
        <term>BWA</term>
        <def>
          <p id="Par15">Burrows–Wheeler aligner</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par16">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ResBlock</term>
        <def>
          <p id="Par17">Residual blocks</p>
        </def>
      </def-item>
      <def-item>
        <term>Conv</term>
        <def>
          <p id="Par18">Convolutional layer</p>
        </def>
      </def-item>
      <def-item>
        <term>SPP</term>
        <def>
          <p id="Par19">Spatial pyramid pooling</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Huijing Yu and Zhenxian Zheng have contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>RL, TL, and JS conceived the study. HY, JS, and ZZ implemented Clair3-MP. HY and JS designed the experiments. HY analyzed the results and wrote the paper. All authors evaluated the results and revised the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>R.L. was supported by Hong Kong Research Grants Council Grants GRF (17113721) and TRS (T21-705/20-N and T12-703/19-R), the Shenzhen Municipal Government General Program (JCYJ20210324134405015), the URC fund at HKU and Oxford Nanopore Technologies.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Project Name: Clair3-MP</p>
    <p>Project homepage: <ext-link ext-link-type="uri" xlink:href="https://github.com/HKU-BAL/Clair3-MP">https://github.com/HKU-BAL/Clair3-MP</ext-link></p>
    <p>Operating system: Linux</p>
    <p>Programming languages: Python, Shell, C++, C</p>
    <p>License: BSD 3-Clause</p>
    <p>Data availability: The links to the reference genome, truth variant sets, benchmarking materials, and sequencing data from ONT, Illumina, and PacBio can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The commands used in the study are available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. All results, including VCFs and logs, are available at <ext-link ext-link-type="uri" xlink:href="http://www.bio8.cs.hku.hk/clair3_mp">http://www.bio8.cs.hku.hk/clair3_mp</ext-link>.</p>
    <p>Other requirements: Python 3.6.10 or above, pypy 3.6 or above, mpmath 1.2.1, tensorflow 2.2.0, pigz 2.4, zdtd 1.4.4, samtools 1.10 and whatshap 1.0 (these requirements can be installed via the instruction in Clair3-MP github).</p>
    <p>Restrictions for use by non-academics: Free to use.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par51">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par52">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par53">R.L. receives research funding from ONT. The remaining authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dwarshuis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Salit</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variant calling and benchmarking in an era of complete human genome sequences</article-title>
        <source>Nat Rev Genet</source>
        <year>2023</year>
        <volume>24</volume>
        <fpage>464</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-023-00590-0</pub-id>
        <?supplied-pmid 37059810?>
        <pub-id pub-id-type="pmid">37059810</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hassan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Johan</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Mohamed Hashim</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Abdullah</surname>
            <given-names>WZ</given-names>
          </name>
          <name>
            <surname>Esa</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation sequencing (NGS) and third-generation sequencing (TGS) for the diagnosis of thalassemia</article-title>
        <source>Diagnostics (Basel)</source>
        <year>2023</year>
        <volume>13</volume>
        <issue>3</issue>
        <fpage>373</fpage>
        <pub-id pub-id-type="doi">10.3390/diagnostics13030373</pub-id>
        <?supplied-pmid 36766477?>
        <pub-id pub-id-type="pmid">36766477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Antonacci-Fulton</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Human Pangenome Project: a global resource to map genomic diversity</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>604</volume>
        <issue>7906</issue>
        <fpage>437</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04601-8</pub-id>
        <?supplied-pmid 35444317?>
        <pub-id pub-id-type="pmid">35444317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The need for a human pangenome reference sequence</article-title>
        <source>Annu Rev Genom Hum Genet</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>81</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-120120-081921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A pangenome reference of 36 Chinese populations</article-title>
        <source>Nature</source>
        <year>2023</year>
        <volume>619</volume>
        <issue>7968</issue>
        <fpage>112</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-023-06173-7</pub-id>
        <?supplied-pmid 37316654?>
        <pub-id pub-id-type="pmid">37316654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJP</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malhotra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rausch</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1784</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08148-z</pub-id>
        <?supplied-pmid 30992455?>
        <pub-id pub-id-type="pmid">30992455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Brand</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Karczewski</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Alfoldi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Francioli</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A structural variation reference for medical and population genetics</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>581</volume>
        <issue>7809</issue>
        <fpage>444</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2287-8</pub-id>
        <?supplied-pmid 32461652?>
        <pub-id pub-id-type="pmid">32461652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McDaniel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Westreich</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Prasanna</surname>
            <given-names>AG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PrecisionFDA truth challenge V2: calling variants from short and long reads in difficult-to-map regions</article-title>
        <source>Cell Genom</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>5</issue>
        <fpage>100129</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100129</pub-id>
        <?supplied-pmid 35720974?>
        <pub-id pub-id-type="pmid">35720974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <issue>5</issue>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rang</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Kloosterman</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>de Ridder</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>From squiggle to basepair: computational approaches for improving nanopore sequencing read accuracy</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>90</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1462-9</pub-id>
        <?supplied-pmid 30005597?>
        <pub-id pub-id-type="pmid">30005597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Colthurst</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ku</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>10</issue>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <?supplied-pmid 30247488?>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>AW-S</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Symphonizing pileup and full-alignment for deep learning-based long-read variant calling</article-title>
        <source>Nat Comput Sci</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>12</issue>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-022-00387-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramachandran</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lumetta</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Klee</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>HELLO: improved neural network architectures and methodologies for small variant calling</article-title>
        <source>BMC Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>404</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04311-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holley</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Beyter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ingimundardottir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Moller</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Kristmundsdottir</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eggertsson</surname>
            <given-names>HP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ratatosk: hybrid error correction of long reads enables accurate variant calling and assembly</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>28</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02244-4</pub-id>
        <?supplied-pmid 33419473?>
        <pub-id pub-id-type="pmid">33419473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Farek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mahmoud</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking challenging small variants with linked and long reads</article-title>
        <source>Cell Genom</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>5</issue>
        <fpage>100128</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100128</pub-id>
        <?supplied-pmid 36452119?>
        <pub-id pub-id-type="pmid">36452119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pesout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lorig-Roach</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Haukness</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Bosworth</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>9</issue>
        <fpage>1044</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0503-6</pub-id>
        <?supplied-pmid 32686750?>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bonfield</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Liddle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ohan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>MO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Twelve years of SAMtools and BCFtools</article-title>
        <source>Gigascience.</source>
        <year>2021</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>giab008</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giab008</pub-id>
        <?supplied-pmid 33590861?>
        <pub-id pub-id-type="pmid">33590861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Trigg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>De La Vega</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>BL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Best practices for benchmarking germline small-variant calls in human genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>555</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0054-x</pub-id>
        <?supplied-pmid 30858580?>
        <pub-id pub-id-type="pmid">30858580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Thorvaldsdottir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative genomics viewer</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <?supplied-pmid 21221095?>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pesout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kolesnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goel</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-aware variant calling with PEPPER-Margin-DeepVariant enables high accuracy in nanopore long-reads</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1322</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01299-w</pub-id>
        <?supplied-pmid 34725481?>
        <pub-id pub-id-type="pmid">34725481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aganezov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Soto</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Kirsche</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zarate</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Avdeyev</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A complete reference genome improves analysis of human genetic variation</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <issue>6588</issue>
        <fpage>eabl3533</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abl3533</pub-id>
        <?supplied-pmid 35357935?>
        <pub-id pub-id-type="pmid">35357935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prodanov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Sensitive alignment using paralogous sequence variants improves long-read mapping and variant calling in segmental duplications</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>19</issue>
        <fpage>e114</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa829</pub-id>
        <?supplied-pmid 33035301?>
        <pub-id pub-id-type="pmid">33035301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marschall</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>van Iersel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stougie</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>WhatsHap: weighted haplotype assembly for future-generation sequencing reads</article-title>
        <source>J Comput Biol</source>
        <year>2015</year>
        <volume>22</volume>
        <issue>6</issue>
        <fpage>498</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2014.0157</pub-id>
        <?supplied-pmid 25658651?>
        <pub-id pub-id-type="pmid">25658651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Clair3-trio: high-performance nanopore long-read variant calling in family trios with trio-to-trio deep neural networks</article-title>
        <source>Brief Bioinform.</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>5</issue>
        <fpage>bbac301</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbac301</pub-id>
        <?supplied-pmid 35849103?>
        <pub-id pub-id-type="pmid">35849103</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
