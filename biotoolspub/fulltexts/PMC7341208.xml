<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Animals (Basel)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Animals (Basel)</journal-id>
    <journal-id journal-id-type="publisher-id">animals</journal-id>
    <journal-title-group>
      <journal-title>Animals : an Open Access Journal from MDPI</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2076-2615</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7341208</article-id>
    <article-id pub-id-type="doi">10.3390/ani10061001</article-id>
    <article-id pub-id-type="publisher-id">animals-10-01001</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GIBBSTHUR: Software for Estimating Variance Components and Predicting Breeding Values for Ranking Traits Based on a Thurstonian Model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6256-5478</contrib-id>
        <name>
          <surname>Varona</surname>
          <given-names>Luis</given-names>
        </name>
        <xref ref-type="aff" rid="af1-animals-10-01001">1</xref>
        <xref rid="c1-animals-10-01001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Legarra</surname>
          <given-names>Andrés</given-names>
        </name>
        <xref ref-type="aff" rid="af2-animals-10-01001">2</xref>
      </contrib>
    </contrib-group>
    <aff id="af1-animals-10-01001"><label>1</label>Departamento de Anatomía, Embriología y Genética Animal, Instituto Agroalimentario de Aragón (IA2), Universidad de Zaragoza, 50018 Zaragoza, Spain</aff>
    <aff id="af2-animals-10-01001"><label>2</label>Génétique Physiologie et Systèmes d’Elevage (GenPhySE), Institut National de la Recherche Agronomique de Toulouse, 31326 Castanet-Tolosan, France; <email>andres.legarra@inrae.fr</email></aff>
    <author-notes>
      <corresp id="c1-animals-10-01001"><label>*</label>Correspondence: <email>lvarona@unizar.es</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>08</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <issue>6</issue>
    <elocation-id>1001</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>04</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 by the authors.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="open-access">
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Simple Summary</title>
        <p>This article describes a new software (GIBBSTHUR) that provides Bayesian estimation of variance components and predictions of breeding values for ranking traits generated from equine competitions based on a Thurstonian approach. The GIBBSTHUR software was developed in FORTRAN 90 and can be executed in UNIX, OSX, or WINDOWS environments, and is freely available in a public repository (https://github.com/lvaronaunizar/Gibbsthur).</p>
      </sec>
      <sec>
        <title>Abstract</title>
        <p>(1) Background: Ranking traits are used commonly for breeding purposes in several equine populations; however, implementation is complex, because the position of a horse in a competition event is discontinuous and is influenced by the performance of its competitors. One approach to overcoming these limitations is to assume an underlying Gaussian liability that represents a horse’s performance and dictates the observed classification in a competition event. That approach can be implemented using Montecarlo Markov Chain (McMC) techniques with a procedure known as the Thurstonian model. (2) Methods: We have developed software (GIBBSTHUR) that analyses ranking traits along with other continuous or threshold traits. The software implements a Gibbs Sampler scheme with a data-augmentation step for the liability of the ranking traits and provides estimates of the variance and covariance components and predictions of the breeding values and the average performance of the competitors in competition events. (3) Results: The results of a simple example are presented, in which it is shown that the procedure can recover the simulated variance and covariance components. In addition, the correlation between the simulated and predicted breeding values and between the estimates of the event effects and the average additive genetic effect of the competitors demonstrates the ability of the software to produce useful predictions for breeding purposes. (4) Conclusions: the GIBBSTHUR software provides a useful tool for the breeding evaluation of ranking traits in horses and is freely available in a public repository (https://github.com/lvaronaunizar/Gibbsthur).</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>ranking traits</kwd>
      <kwd>horse</kwd>
      <kwd>breeding</kwd>
      <kwd>Thurstonian model</kwd>
      <kwd>Gibbs sampler</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-animals-10-01001">
    <title>1. Introduction</title>
    <p>Ranking traits are used frequently as selection criteria in competitive horse breeding programs [<xref rid="B1-animals-10-01001" ref-type="bibr">1</xref>,<xref rid="B2-animals-10-01001" ref-type="bibr">2</xref>]; however, the position of a horse in a competitive event has a discontinuous nature and is influenced by the performance of its competitors, which makes genetic evaluations based on standard linear models difficult. Several transformations for overcoming that limitation have been proposed—e.g., the squared root of ranks [<xref rid="B3-animals-10-01001" ref-type="bibr">3</xref>], the Snell transformation score [<xref rid="B4-animals-10-01001" ref-type="bibr">4</xref>,<xref rid="B5-animals-10-01001" ref-type="bibr">5</xref>], and the normalized score [<xref rid="B6-animals-10-01001" ref-type="bibr">6</xref>].</p>
    <p>Another interesting approach is to assume an underlying Gaussian liability that represents the horse’s performance and dictates the observed classification in competition events [<xref rid="B1-animals-10-01001" ref-type="bibr">1</xref>,<xref rid="B7-animals-10-01001" ref-type="bibr">7</xref>]. The original implementation of that approach involved a complex numerical integration [<xref rid="B1-animals-10-01001" ref-type="bibr">1</xref>], but Gianola and Simianer [<xref rid="B8-animals-10-01001" ref-type="bibr">8</xref>] proposed a Bayesian approach called the Thurstonian Model, which can be implemented using McMC methods such as the Gibbs Sampler [<xref rid="B9-animals-10-01001" ref-type="bibr">9</xref>]. In horse breeding, that model has been tested on simulated data [<xref rid="B10-animals-10-01001" ref-type="bibr">10</xref>] and has been applied to trotter horses [<xref rid="B11-animals-10-01001" ref-type="bibr">11</xref>] and the results of endurance competitions [<xref rid="B12-animals-10-01001" ref-type="bibr">12</xref>]. The practical use of the method has been limited, however, partly because of the absence of suitable and user-friendly software.</p>
    <p>The objective of this note is to present a new free software (GIBBSTHUR) that implements the Bayesian estimation of variance components and the prediction of breeding values for ranking traits based on a Thurstonian Model. In addition, the software can analyze continuous and threshold traits jointly with the underlying liability of the ranking traits.</p>
  </sec>
  <sec id="sec2-animals-10-01001">
    <title>2. Theoretical Background</title>
    <p>The Thurstonian Model assumes an underlying variable or liability (<bold><italic>l</italic></bold>) that is transformed into ranking in competitions (<bold><italic>t</italic></bold>). The model for the underlying variable can include systematic, random environmental and additive genetics effects, and a residual effect whose variance has to be predefined. Systematic effects generally include, among others, sex, year, or type of competition, but for ranking traits, it is interesting to include an “event” effect in order to take into account the heterogeneity of the level of the competitors linked with the prestige of the competitive events. The liability can be modelled alone or in conjunction with other continuous or threshold traits through the additive genetic, random environmental, or residual covariances between them.</p>
    <p>To illustrate the model, suppose a simple bivariate model composed of <bold><italic>l</italic></bold> and a continuous Gaussian trait (<bold><italic>y</italic></bold>) which includes systematic and random additive genetic effects only. The probability distribution of <bold><italic>l</italic></bold> and <bold><italic>y</italic></bold>, given the remaining parameters in the model, is the following multivariate Gaussian distribution (<italic>MVN</italic>):<disp-formula id="FD1-animals-10-01001"><mml:math id="mm1"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <bold><italic>b<sub>l</sub></italic></bold> and <bold><italic>b<sub>y</sub></italic></bold> and <bold><italic>a<sub>l</sub></italic></bold> and <bold><italic>a<sub>y</sub></italic></bold> are the systematic and additive genetic effects for the liability (<bold><italic>l</italic></bold>) and the continuous (<bold><italic>y</italic></bold>) traits, respectively. Furthermore, <bold><italic>X<sub>l</sub></italic></bold>, <bold><italic>X<sub>y</sub></italic></bold>, <bold><italic>Z<sub>l</sub></italic></bold>, and <bold><italic>Z<sub>y</sub></italic></bold> are the corresponding incidence matrices, and <bold><italic>R</italic></bold> is the residual covariance matrix. The prior distribution of the additive genetic effects is the following multivariate Gaussian distribution:<disp-formula id="FD2-animals-10-01001"><mml:math id="mm2"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <bold><italic>A</italic></bold> is the numerator relationship matrix and <bold><italic>G</italic></bold> is the additive genetic covariance matrix. In addition, the prior distributions of <bold><italic>R</italic></bold> and <bold><italic>G</italic></bold> are Inverted Wishart. The program uses a Gibbs Sampler approach [<xref rid="B9-animals-10-01001" ref-type="bibr">9</xref>] to obtain the posterior marginal estimates of all the unknowns in the model. The Gibbs sampler is an updating sampling scheme that requires sampling from the full conditional posterior distributions. The conditional distributions of systematic, random environmental, and additive genetic effects are univariate Gaussian, while the conditional distributions of the variance covariance matrices are Inverted Wishart. As with threshold traits, the Bayesian implementation of the model based on the Gibbs Sampler, after conditioning on liability, is similar to the bivariate model that has two continuous traits [<xref rid="B13-animals-10-01001" ref-type="bibr">13</xref>].</p>
    <p>Therefore, the key step for the implementation within a McMC Bayesian approach is the defining of the conditional predictive distribution of the liabilities given the observed ranking data, as follows:<disp-formula id="FD3-animals-10-01001"><mml:math id="mm3"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msubsup><mml:mstyle mathsize="80%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <italic>l<sub>kj</sub></italic> is the liability of the <italic>j</italic>th individual at the <italic>k</italic>th completion event and ELSE denotes the liabilities at the same and other competition events and the systematic and additive genetic effects for the ranking trait and the correlated Gaussian trait. Further,
<disp-formula id="FD4-animals-10-01001"><mml:math id="mm4"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
and
<disp-formula id="FD5-animals-10-01001"><mml:math id="mm5"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm6"><mml:mrow><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is the (<italic>i</italic>,<italic>j</italic>) element of <inline-formula><mml:math id="mm7"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm8"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm9"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm11"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are the corresponding rows of the <inline-formula><mml:math id="mm12"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm13"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm14"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm15"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> matrices that link the liability (<inline-formula><mml:math id="mm16"><mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the Gaussian (<inline-formula><mml:math id="mm17"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) trait for the <italic>j</italic>th data at the <italic>k</italic>th event with the vectors of systematic (<inline-formula><mml:math id="mm18"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm19"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) and additive genetic (<inline-formula><mml:math id="mm20"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm21"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) effects. In addition, <inline-formula><mml:math id="mm22"><mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is 1 if the <italic>j</italic>th competitor is present at the <italic>k</italic>th event and 0 otherwise, and <bold><italic>T<sub>k</sub></italic></bold> is an indicator set that denotes the order of liabilities within the <italic>k</italic>th competition. Therefore, the liabilities within each event are not independent, because the sample space is restricted by the ranking represented by <bold><italic>T<sub>k</sub></italic><sub>.</sub></bold> The conditional sampling of liabilities is performed sequentially. First, the liability of the horse that finishes in position one is set to 0 to achieve the identifiability of the model, whereas an “event” effect is estimated. An alternative, equivalent option used in [<xref rid="B10-animals-10-01001" ref-type="bibr">10</xref>] is to fix the “event” effect to 0 and sample the first horse from a truncated normal conditional on the other competitors. Second, the liabilities of the remaining individuals in the competition event are calculated by sampling from the truncated Gaussian distributions (TN) that have a mean <inline-formula><mml:math id="mm23"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and a variance <inline-formula><mml:math id="mm24"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, with limits defined by the liabilities of the preceding horse and of the horse classified just after it.</p>
  </sec>
  <sec id="sec3-animals-10-01001">
    <title>3. The Software: Input and Output Files</title>
    <p>The software (GIBBSTHUR) was developed in FORTRAN90 and is based on the TM software [<xref rid="B14-animals-10-01001" ref-type="bibr">14</xref>]. It is available at <uri xlink:href="https://github.com/lvaronaunizar/Gibbsthur">https://github.com/lvaronaunizar/Gibbsthur</uri>. Running the program requires a parameter file (‘parameters.txt’), which must include the names of the pedigree and data file; the number of additional traits and their nature (continuous, threshold, or ranking); the description of the model of analysis for all the traits (systematic, random, and genetic effects); and the hyperparameters of the Gibbs sampler implementation that comprise the total number of iterations, the number of burn-in iterations to discard, and the thin interval. The pedigree file must include a list of the individual, sire, and dam entries numbered from 1 to the number of individuals. The program allows the user to include genetic groups for unknown sires or dams. The data file must have an entry for each data, and should include the level for each systematic, random, and additive genetic effect, numbered from 1 to the maximum number of levels for each effect; and the performance for the continuous, threshold, and ranking traits. Missing data should be coded as 0. There is no limit to the number of competitors per competition. Empty positions are admitted in the results of competitions.</p>
    <p>The execution of the program generates the following files: “Results.txt”, “Breeding.txt”, “Solutions.txt”, and “Iterations.txt”. The file “Results.txt” includes a summary of the posterior mean and standard deviations for the variance and covariance components; the heritabilities; the ratios of variance; and the additive genetic, permanent environmental, and residual correlations. They are computed with the output of the Gibbs sampler iterations after the burn-in. The file “Breeding.txt” includes the posterior mean and standard deviations of the breeding values for the ranking traits and the additional traits, and they can be directly used for selection purposes. The file “Solutions.txt” includes the posterior mean and standard deviations of the systematic and random environmental effects for the ranking and the additional traits. The file “Iterations.txt” includes the samples of each iteration of the Gibbs sampler for the variance and covariance components, which can be used to analyze in detail the marginal posterior distributions. A more detailed description is available at <uri xlink:href="https://github.com/lvaronaunizar/Gibbsthur">https://github.com/lvaronaunizar/Gibbsthur</uri>.</p>
  </sec>
  <sec id="sec4-animals-10-01001">
    <title>4. Simulation Example</title>
    <p>A simple pedigree comprising 100 sires and 500 dams generates 2000 horses that compete randomly in 2000 events of 10 horses each. On average, each horse competes in 10 events. The liability was generated by a model that included a general mean, one additive genetic effect, and a residual. The additive genetic and residual variances were set to 0.25 and 1 (<inline-formula><mml:math id="mm25"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> = 0.2), respectively. In addition, we simulated a correlated continuous trait that had additive and residual variances of 1 and 2 (<inline-formula><mml:math id="mm26"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> = 0.33), respectively, and additive genetic and residual correlations with the liability of the ranking trait of 0.3 and −0.2, respectively. The model of analysis with the GIBBSTHUR software included two systematic effects (a general mean and an event effect), and the additive genetic and residual random effects. We used a Gibbs sampler chain of 100,000 iterations after discarding the first 10,000. The initial values of variance components were established by dividing the raw phenotypic variance by the number of variance components in the model. The convergence was checked by a visual inspection (see <xref ref-type="fig" rid="animals-10-01001-f001">Figure 1</xref>). The computing time was 51 min and 23 s with a i9-7960X processor (2.80 GHz).</p>
  </sec>
  <sec sec-type="results" id="sec5-animals-10-01001">
    <title>5. Results and Discussion</title>
    <p>The posterior distribution of the heritabilities and the genetic and residual correlations is presented in <xref ref-type="fig" rid="animals-10-01001-f002">Figure 2</xref>.</p>
    <p>The simulated values were within the Highest Posterior Density (HPD) at 95% of the posterior distributions, which confirmed that the software can retrieve the simulated parameters for continuous and ranking traits. Slight differences between the mode of the posterior distributions and the simulated values can be expected, given the small size of the dataset. <xref ref-type="fig" rid="animals-10-01001-f003">Figure 3</xref> shows the predicted and simulated breeding values for the continuous and ranking traits.</p>
    <p>The correlation between the predicted and the simulated breeding values was higher for the continuous (0.89) than it was for the liability of the ranking trait (0.83), although, in both cases, the correlation was very strong because the amount of information available for each horse was large (on average, 10 phenotypic records).</p>
    <p>The ability to discriminate between the performances of the individuals in competition events is illustrated in <xref rid="animals-10-01001-t001" ref-type="table">Table 1</xref>, which provides a detailed description of the phenotypic information for the ranking traits of the best and worst predicted breeding values. The best individual won 8 of 13 races, and the horse with the worst breeding values came last in 5 of 8 races.</p>
    <p>One of the main limitations of using ranking traits for the breeding evaluation of competitive horses is that competition events often are structured into categories based on their prestige or monetary reward and, therefore, the participation of horses in those events is not random, because the most prestigious events attract the best horses and the worst horses tend to participate in other events, which have a lower average performance. Gianola and Simianer [<xref rid="B8-animals-10-01001" ref-type="bibr">8</xref>] proposed including an “event” effect, although Legarra and Ricard [<xref rid="B10-animals-10-01001" ref-type="bibr">10</xref>] pointed out that “event” effects cannot be estimated from ranking data because the event does not have any influence on rankings, and they recommended removing them to achieve identifiability. Here, we used a different (but equivalent) approach that zeroed the liability of the best horse in each event, which forced the liabilities of the horses from the second to the last position to be negative. Therefore, the estimates of the event effects were also forced to be negative. In that approach, the systematic effect of the event is not an effect of the race per se (i.e., weather or track conditions), but is linked to the performance of the best horse and provides an indicator of the average level of the competitors in the event.</p>
    <p>The ability to capture the level of the competition events is illustrated by the results shown in <xref ref-type="fig" rid="animals-10-01001-f004">Figure 4</xref>, which represent the estimates of the event effects and the average true additive genetic effect for the liabilities of the horses competing in each event.</p>
    <p>As expected, there was a negative correlation (−0.55), which indicated that the most exigent events required a higher breeding value for the winner of the competition because the liability of the winner was set to zero. Therefore, competitions with the best horses (average genetic level) are associated with low “event” effects, while competitions of the worst horses have high “event” effects. In addition, <xref rid="animals-10-01001-t002" ref-type="table">Table 2</xref> shows the predicted breeding values and the percentile within their ranking of the horses that competed in the highest and lowest estimated events in the simulation study.</p>
    <p>In the event with the highest estimated effect, the predicted breeding values of 5 of 10 horses were ranked in the top 10%, and 8 out of 10 had a positive predicted breeding value. In contrast, in the event with the lowest estimated effect, all the horses had a negative predicted breeding value, and five had breeding values that were among the worst 10% of individuals. Nevertheless, the proposed approach might work well if the distribution of horses in events is random, as it was in the simulated example, or if the degree of structuring is small. In cases in which the structuring is high, Legarra and Ricard [<xref rid="B10-animals-10-01001" ref-type="bibr">10</xref>] proved with a simulation study that the results can be biased. Therefore, some other alternatives might be appropriate—e.g., the approach suggested by these authors, who proposed a mixture model in which horses are classified into several groups based on their performance. Further research is needed to adapt the GIBBSTHUR software for use in those scenarios.</p>
  </sec>
  <sec sec-type="conclusions" id="sec6-animals-10-01001">
    <title>6. Conclusions</title>
    <p>The GIBBSTHUR software provides a useful tool for the breeding evaluation of ranking traits in horses. It can analyze ranking traits jointly with other categorical or continuous traits.</p>
  </sec>
</body>
<back>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization, L.V.; methodology, L.V. and A.L.; software, L.V. and A.L.; validation, L.V.; writing—original draft preparation, L.V.; writing—review and editing, L.V. and A.L. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>This research received no external funding.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-animals-10-01001">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavernier</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Genetic evaluation of horses based on ranks in competitions</article-title>
        <source>Genet. Sel. Evol.</source>
        <year>1991</year>
        <volume>23</volume>
        <fpage>159</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-23-2-159</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-animals-10-01001">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ricard</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chanu</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Genetic parameters of eventing horse competition in France</article-title>
        <source>Genet. Sel. Evol.</source>
        <year>2001</year>
        <volume>33</volume>
        <fpage>175</fpage>
        <lpage>190</lpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-33-2-175</pub-id>
        <?supplied-pmid 11333833?>
        <pub-id pub-id-type="pmid">11333833</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-animals-10-01001">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lührs-Behnke</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Röehe</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Kalm</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Genetic analysis of riding test and their connections with traits of stallion performance and breeding mare tests</article-title>
        <source>Züchtungskunde</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>119</fpage>
        <lpage>128</lpage>
      </element-citation>
    </ref>
    <ref id="B4-animals-10-01001">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snell</surname>
            <given-names>E.J.</given-names>
          </name>
        </person-group>
        <article-title>A scaling procedure for ordered categorical data</article-title>
        <source>Biometrics</source>
        <year>1964</year>
        <volume>20</volume>
        <fpage>592</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.2307/2528498</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-animals-10-01001">
      <label>5.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gómez</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Cervántes</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bartolomé</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Molina</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Valera</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Genetic evaluation of show jumping performance in young Spanish Sport Horse Breed</article-title>
        <source>Book of Abstracts of the 57th Annual Meeting of the EAAP</source>
        <publisher-name>Wageningen Academic Publishers</publisher-name>
        <publisher-loc>Antalya, Turkey</publisher-loc>
        <year>2006</year>
      </element-citation>
    </ref>
    <ref id="B6-animals-10-01001">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aldridge</surname>
            <given-names>L.I.</given-names>
          </name>
          <name>
            <surname>Kelleher</surname>
            <given-names>D.L.</given-names>
          </name>
          <name>
            <surname>Reilly</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Brophy</surname>
            <given-names>P.O.</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the genetics correlation between performances at different levels of show jumping competitions in Ireland</article-title>
        <source>J. Anim. Breed. Genet.</source>
        <year>2000</year>
        <volume>117</volume>
        <fpage>65</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1439-0388.2000.00232.x</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-animals-10-01001">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavernier</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Estimation of breeding value of jumping horses from their ranks</article-title>
        <source>Lives. Prod. Sci.</source>
        <year>1990</year>
        <volume>26</volume>
        <fpage>277</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="doi">10.1016/0301-6226(90)90065-E</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-animals-10-01001">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gianola</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Simianer</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>A thurstonian model for quantitative genetic analysis of ranks: A Bayesian approach</article-title>
        <source>Genetics</source>
        <year>2006</year>
        <volume>174</volume>
        <fpage>1613</fpage>
        <lpage>1624</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.106.060673</pub-id>
        <?supplied-pmid 16980397?>
        <pub-id pub-id-type="pmid">16980397</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-animals-10-01001">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelfand</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>A.F.M.</given-names>
          </name>
        </person-group>
        <article-title>Sampling-based approaches to calculating marginal densities</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>1990</year>
        <volume>85</volume>
        <fpage>398</fpage>
        <lpage>409</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1990.10476213</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-animals-10-01001">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ricard</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Legarra</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Validation of models for analysis of ranks in horse breeding evaluation</article-title>
        <source>Genet. Sel. Evol.</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>3</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-42-3</pub-id>
        <?supplied-pmid 20109204?>
        <pub-id pub-id-type="pmid">20109204</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-animals-10-01001">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gómez</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Varona</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Molina</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Valera</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Genetic evaluation of racing performance in trotter horses by competitive models</article-title>
        <source>Lives. Sci.</source>
        <year>2011</year>
        <volume>140</volume>
        <fpage>155</fpage>
        <lpage>260</lpage>
        <pub-id pub-id-type="doi">10.1016/j.livsci.2011.03.024</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-animals-10-01001">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>García-Ballesteros</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Varona</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Valera</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gutierrez</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Cervántes</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Cross-validation analysis for genetic evaluation models for ranking in endurance horses</article-title>
        <source>Animal</source>
        <year>2018</year>
        <volume>12</volume>
        <fpage>20</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1017/S1751731117001331</pub-id>
        <?supplied-pmid 28633685?>
        <pub-id pub-id-type="pmid">28633685</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-animals-10-01001">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Varona</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Misztal</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>J.K.</given-names>
          </name>
        </person-group>
        <article-title>Threshold-linear versus linear-linear analysis of birth weight and calving ease using an animal model: I. Variance component estimation</article-title>
        <source>J. Anim. Sci.</source>
        <year>1999</year>
        <volume>77</volume>
        <fpage>1994</fpage>
        <lpage>2002</lpage>
        <pub-id pub-id-type="doi">10.2527/1999.7781994x</pub-id>
        <?supplied-pmid 10461973?>
        <pub-id pub-id-type="pmid">10461973</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-animals-10-01001">
      <label>14.</label>
      <element-citation publication-type="web">
        <person-group person-group-type="author">
          <name>
            <surname>Legarra</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Varona</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>López de Maturana</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Threshold Model (TM)</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://snp.toulouse.inrafr/~alegarra/manualtm.pdf">http://snp.toulouse.inrafr/~alegarra/manualtm.pdf</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2020-03-10">(accessed on 10 March 2020)</date-in-citation>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="animals-10-01001-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Plot of the Gibbs sampler iterations of the heritabilities of the continuous and ranking traits.</p>
    </caption>
    <graphic xlink:href="animals-10-01001-g001"/>
  </fig>
  <fig id="animals-10-01001-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Posterior distribution and simulated parameters (in red) of the heritabilities of the continuous and ranking traits and of the genetic and residual correlations.</p>
    </caption>
    <graphic xlink:href="animals-10-01001-g002"/>
  </fig>
  <fig id="animals-10-01001-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Two-dimensional plots of the simulated and predicted breeding values for the continuous and the liability of the ranking traits.</p>
    </caption>
    <graphic xlink:href="animals-10-01001-g003"/>
  </fig>
  <fig id="animals-10-01001-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Two-dimensional plot of the estimate of the event effects and the average true genetic level for the liability of the ranking trait of the horses competing in an event.</p>
    </caption>
    <graphic xlink:href="animals-10-01001-g004"/>
  </fig>
  <table-wrap id="animals-10-01001-t001" orientation="portrait" position="float">
    <object-id pub-id-type="pii">animals-10-01001-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>Phenotypic performance in the ranking trait of the horses with the highest and lowest predicted breeding value (EBV) for the liability of the ranking trait.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Place</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Highest EBV</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Lowest EBV</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">4</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">4</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">6</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">7</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">8</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">9</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">10</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">5</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="animals-10-01001-t002" orientation="portrait" position="float">
    <object-id pub-id-type="pii">animals-10-01001-t002_Table 2</object-id>
    <label>Table 2</label>
    <caption>
      <p>Predicted breeding values and percentile within their ranking (between brackets) of the participants in the highest or lowest estimated events.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Position</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Highest</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Lowest</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">1st</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1.55 (100.00)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.62 (9.64)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">2nd</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1.23 (99.50)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.69 (7.27)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">3rd</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.69 (92.60)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.03 (48.19)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">4th</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.86 (96.20)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.06 (46.19)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">5th</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.73 (93.73)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.64 (9.03)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">6th</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.46 (82.88)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.12 (40.58)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">7th</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.03 (53.92)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.92 (2.65)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">8th</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.32 (75.80)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.51 (13.73)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">9th</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.35 (22.00)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">−0.31 (24.50)</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">10th</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">−0.15 (34.15)</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">−0.89 (3.07)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
