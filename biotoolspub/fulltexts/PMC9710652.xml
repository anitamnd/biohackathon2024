<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9710652</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbab029</article-id>
    <article-id pub-id-type="publisher-id">vbab029</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CCWeights: an R package and web application for automated evaluation and selection of weighting factors for accurate quantification using linear calibration curve</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0534-3868</contrib-id>
        <name>
          <surname>Dong</surname>
          <given-names>Yonghui</given-names>
        </name>
        <xref rid="vbab029-aff1" ref-type="aff"/>
        <xref rid="vbab029-cor1" ref-type="corresp"/>
        <!--yonghui.dong@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wachsman</surname>
          <given-names>Tal</given-names>
        </name>
        <xref rid="vbab029-aff1" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morgan</surname>
          <given-names>Liat</given-names>
        </name>
        <xref rid="vbab029-aff1" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gazit</surname>
          <given-names>Ehud</given-names>
        </name>
        <xref rid="vbab029-aff1" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Birkler</surname>
          <given-names>Rune Isak Dupont</given-names>
        </name>
        <xref rid="vbab029-aff1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="vbab029-aff1"><institution>Blavatnik Center for Drug Design, Tel Aviv University</institution>, Tel Aviv 69978, <country country="IL">Israel</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ouangraoua</surname>
          <given-names>Aida</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbab029-cor1">To whom correspondence should be addressed. <email>yonghui.dong@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-10-28">
      <day>28</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>1</volume>
    <issue>1</issue>
    <elocation-id>vbab029</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>23</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>09</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbab029.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The accuracy of any analytical method is highly dependent on the selection of an appropriate calibration model. Here, we present CCWeights, an R package for automated assessment and selection of weighting factors for accurate quantification using linear calibration curve. Additionally, CCWeights includes a web application that allows users to analyze their data using an interactive graphical user interface, without any programming requirements. The workflow and features of CCWeights are illustrated by the analyses of two datasets acquired by liquid chromatography-mass spectrometry (LC-MS). The resulting quantification table can be directly utilized for further model assessment and subsequent data analysis.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>CCWeights is publicly available on CRAN repository (<ext-link xlink:href="https://cran.r-project.org/web/packages/CCWeights" ext-link-type="uri">https://cran.r-project.org/web/packages/CCWeights</ext-link>), with source code available on GitHub (<ext-link xlink:href="https://github.com/YonghuiDong/CCWeights" ext-link-type="uri">https://github.com/YonghuiDong/CCWeights</ext-link>) under a GPL-3 license. The web application can be run locally from R console using a simple command “runGui()”. Alternatively, the web application can be freely accessed for direct online use at <ext-link xlink:href="https://bcdd.shinyapps.io/CCWeights/" ext-link-type="uri">https://bcdd.shinyapps.io/CCWeights/</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Blavatnik Family Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100011643</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The accuracy of any analytical method is highly dependent on the selection of an appropriate calibration model. The most widely adopted model is unweighted linear regression (ULR), where the response (<italic toggle="yes">y</italic>-axis) is plotted against the corresponding concentration (<italic toggle="yes">x</italic>-axis) (<xref rid="vbab029-B9" ref-type="bibr">da Silva <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbab029-B6" ref-type="bibr">Logue and Manandhar, 2018</xref>; <xref rid="vbab029-B7" ref-type="bibr">Moosavi and Ghassabian, 2018</xref>). However, the wide concentration range used in modern bioanalytical assays (typically more than one order of magnitude) is susceptible to heteroscedasticity, where the variance increases with rising concentrations (<xref rid="vbab029-B10" ref-type="bibr">Sonawane <italic toggle="yes">et al.</italic>, 2019</xref>). Larger variances associated with higher concentrations tend to influence (weight) the regression line more than that of the smaller variances present at lower concentrations. As a consequence, the accuracy of the analytical results, particularly at a lower concentration range, is impaired (<xref rid="vbab029-B1" ref-type="bibr">Almeida <italic toggle="yes">et al.</italic>, 2002</xref>). For instance, it has been estimated that heteroscedasticity could lead to up to one order of magnitude precision loss in the low concentration region (<xref rid="vbab029-B11" ref-type="bibr">Tellinghuisen, 2007</xref>).</p>
    <p>A simple and effective way to account for heteroscedasticity and improve the accuracy over the selected concentration range is to use weighted linear regression (WLR) with an appropriate weighting factor (<xref rid="vbab029-B1" ref-type="bibr">Almeida <italic toggle="yes">et al.</italic>, 2002</xref>; <xref rid="vbab029-B10" ref-type="bibr">Sonawane <italic toggle="yes">et al.</italic>, 2019</xref>). Although WLR is a well-established statistics approach, the ‘Test-and-Fit’ strategy is still commonly used for the selection of calibration curves and weighting factors in the bioanalytical community due to its simplicity (<xref rid="vbab029-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="vbab029-B7" ref-type="bibr">Moosavi and Ghassabian, 2018</xref>). Unfortunately, an improper weighting factor could be easily selected with the ‘Test-and-Fit’ strategy because it is based on the user’s subjective choice (<xref rid="vbab029-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic>, 2014</xref>). The correlation coefficient (<italic toggle="yes">r</italic><sup>2</sup>) should not be used as the criteria in selecting weighting factor because the large variances present at high concentrations dominate the correlation coefficient calculation. In addition, it is suggested that a weighting factor should only be used for heteroscedastic data (<xref rid="vbab029-B1" ref-type="bibr">Almeida <italic toggle="yes">et al.</italic>, 2002</xref>).</p>
    <p>Although many commercial software, such as TraceFinder™ (Thermo Fisher, USA) and Targetlynx™ (Waters, USA), offer different weighting factors for users to choose for their gas chromatography or liquid chromatography mass spectrometry (GC- or LC-MS)-based targeted analyses, they do not provide functions to evaluate and select the appropriate weighting factor. To this end, we have developed CCWeights for automated selection of proper weighting factor for each individual compound, and analyte quantification using linear calibration curve. In particular, apart from the build-in weighting factors, CCWeights allows users to define their own weighting factors for model evaluation and analyte quantification. Furthermore, it provides a web interface which does not require any coding expertise.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>CCWeights is developed using R statistical language (<xref rid="vbab029-B8" ref-type="bibr">R Core Team, 2020</xref>) and is released on both CRAN and GitHub. Additionally, a web application is built using R package Shiny (<xref rid="vbab029-B2" ref-type="bibr">Beeley and Sukhdeve, 2018</xref>), allowing users to interactively analyze their data in a web browser without the need to download R or type any R commands. The analytical assay readout, exported as comma-separated values (.csv) or Microsoft Excel (.xls or .xlsx) format, is the starting point for the CCWeights pipeline (<xref rid="vbab029-F1" ref-type="fig">Fig. 1a</xref>). In order to help users familiarize themselves with the workflow and data format requirements, CCWeights is accompanied by two example datasets (<xref rid="vbab029-F1" ref-type="fig">Fig. 1a</xref>). The analyses of the two datasets are illustrated in Section 3. To make the web application more user-friendly, instructions are provided for each step.</p>
    <fig position="float" id="vbab029-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Schematic overview of CCWeights workflow. (a) Data can be uploaded in csv, xls or xlsx format in Data Upload panel. (b) Homoscedasticity test is then performed for each analyte. (c) Next, five default and one user-defined weighting factors (if available) are evaluated in order to select the optimum weighting factor for each analyte. (d) Finally weighted linear regression is performed for analyte quantification.</p>
      </caption>
      <graphic xlink:href="vbab029f1" position="float"/>
    </fig>
    <p>As has been suggested that a weighting factor should only be used when homoscedasticity is not met for analytical data (<xref rid="vbab029-B1" ref-type="bibr">Almeida <italic toggle="yes">et al.</italic>, 2002</xref>), CCWeights first tests data homoscedasticity by calculating the probability that the variance of measurements at the highest concentration level is smaller than the variance of measurements at the lowest concentration level using an <italic toggle="yes">F</italic>-test (<xref rid="vbab029-B3" ref-type="bibr">Desharnais <italic toggle="yes">et al.</italic>, 2017a</xref>,<xref rid="vbab029-B4" ref-type="bibr">b</xref>). The test of homoscedasticity is accepted when experimental <italic toggle="yes">F</italic>-value (<italic toggle="yes">F</italic><sub>exp</sub>) is smaller than corresponding <italic toggle="yes">F</italic>-table value (<italic toggle="yes">F</italic><sub>tab</sub>) at confidence of 99% (default value). Users can customize the confidence levels according to their studies (<xref rid="vbab029-F1" ref-type="fig">Fig. 1b</xref>). If the data are homoscedastic, weighting factor = 1 (1/<italic toggle="yes">x</italic><sup>0</sup>, unweight linear regression) is suggested. Otherwise, five commonly used weighting factors, that is 1/<italic toggle="yes">x</italic><sup>0</sup>, 1/<italic toggle="yes">x</italic>, 1/<italic toggle="yes">x</italic><sup>2</sup>, 1/<italic toggle="yes">y</italic> and 1/<italic toggle="yes">y</italic><sup>2</sup>, together with user-defined weighting factors (if present) are tested. By applying regression with different weighting factors on a set of calibration curve standard data, the best weighting factor could be identified by choosing the one generating the smallest sum of the absolute relative errors (SRE%) (<xref rid="vbab029-B1" ref-type="bibr">Almeida <italic toggle="yes">et al.</italic>, 2002</xref>; <xref rid="vbab029-B10" ref-type="bibr">Sonawane <italic toggle="yes">et al.</italic>, 2019</xref>). Interactive linear regression and residual plots are also provided for the user to evaluate different weighting factors. The figures can be downloaded in SVG format for further usage (<xref rid="vbab029-F1" ref-type="fig">Fig. 1c</xref>). Although CCWeights chooses the best weighting factor for the user, each targeted analyte is still quantified using all the tested weighting factors, which offers users the flexibility for further model evaluation. The resulting quantification table can be downloaded in csv format for subsequent data analysis (<xref rid="vbab029-F1" ref-type="fig">Fig. 1d</xref>).</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>The features of CCWeights are illustrated by two examples: (i) targeted analysis without using any internal standards and (ii) targeted analysis with isotopically labeled counterparts as internal standards (Supplementary Files S1 and S2). Detailed sample preparation and data processing methods are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary File S3</xref>. Calibration results can be acquired by few clicks in the web application. In order to validate CCWeights results, the calibration curves were constructed using TraceFinder™ software (V5.1, Thermo) by manually selecting different weighting factors, that is 1/<italic toggle="yes">x</italic><sup>0</sup>, 1/<italic toggle="yes">x</italic>, 1/<italic toggle="yes">x</italic><sup>2</sup>, 1/<italic toggle="yes">y</italic>, 1/<italic toggle="yes">y</italic><sup>2</sup>, and samples were quantified with each calibration model accordingly. The resulting linear regression models and quantification results were used to compare to those obtained from CCWeights, and CCWeights results are consistent with the ones obtained by TraceFinder™ (<xref rid="sup1" ref-type="supplementary-material">Supplementary File S4</xref>).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>CCWeights is an efficient and easy-to-use R package and web application allowing automated optimized weighting factor selection for accurate quantification using linear calibration curve. It provides a user-friendly output which can be used for further model assessment and subsequent data analysis. It is important to note that although the workflow and features of CCWeights are illustrated using two LC-MS datasets, it can be used for any analytical data in practice.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This study was supported by the Blavatnik Center for Drug Discovery, Tel Aviv University, funded by the Blavatnik Family Foundation.</p>
    <p><italic toggle="yes">Conflict of Interest:</italic> none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbab029_Supplementary_Data</label>
      <media xlink:href="vbab029_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbab029-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almeida</surname><given-names>A.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <article-title>Linear regression for calibration lines revisited: weighting schemes for bioanalytical methods</article-title>. <source>J. Chromatogr. B</source>, <volume>774</volume>, <fpage>215</fpage>–<lpage>222</lpage>.</mixed-citation>
    </ref>
    <ref id="vbab029-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Beeley</surname><given-names>C.</given-names></string-name>, <string-name><surname>Sukhdeve</surname><given-names>S.R.</given-names></string-name></person-group> (<year>2018</year>) Web Application Development with R Using Shiny: Build stunning graphics and interactive data visualizations to deliver cutting-edge analytics. Packt Publishing Ltd.</mixed-citation>
    </ref>
    <ref id="vbab029-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Desharnais</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2017a</year>) <article-title>Procedure for the selection and validation of a calibration model I—description and application</article-title>. <source>J. Anal. Toxicol</source>., <volume>41</volume>, <fpage>261</fpage>–<lpage>226</lpage>.<pub-id pub-id-type="pmid">28137730</pub-id></mixed-citation>
    </ref>
    <ref id="vbab029-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Desharnais</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2017b</year>) <article-title>Procedure for the selection and validation of a calibration model II—theoretical basis</article-title>. <source>J. Anal. Toxicol</source>., <volume>41</volume>, <fpage>269</fpage>–<lpage>276</lpage>.<pub-id pub-id-type="pmid">28158619</pub-id></mixed-citation>
    </ref>
    <ref id="vbab029-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gu</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Selecting the correct weighting factors for linear and quadratic calibration curves with least-squares regression algorithm in bioanalytical LC-MS/MS assays and impacts of using incorrect weighting factors on curve stability, data quality, and assay performance</article-title>. <source>Anal. Chem</source>., <volume>86</volume>, <fpage>8959</fpage>–<lpage>8966</lpage>.<pub-id pub-id-type="pmid">25157966</pub-id></mixed-citation>
    </ref>
    <ref id="vbab029-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Logue</surname><given-names>B.A.</given-names></string-name>, <string-name><surname>Manandhar</surname><given-names>E.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Percent residual accuracy for quantifying goodness-of-fit of linear calibration curves</article-title>. <source>Talanta</source>, <volume>189</volume>, <fpage>527</fpage>–<lpage>533</lpage>.<pub-id pub-id-type="pmid">30086955</pub-id></mixed-citation>
    </ref>
    <ref id="vbab029-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Moosavi</surname><given-names>S.M.</given-names></string-name>, <string-name><surname>Ghassabian</surname><given-names>S.</given-names></string-name></person-group> (<year>2018</year>) <part-title>Linearity of calibration curves for analytical methods: A review of criteria for assessment of method reliability</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Stauffer</surname><given-names>M.T.</given-names></string-name></person-group> (ed.) <source>Calibration and Validation of Analytical Methods A Sampling of Current Approaches</source>. <publisher-name>IntechOpen Limited</publisher-name>, <publisher-loc>London, UK</publisher-loc>, pp. <fpage>109</fpage>–<lpage>127</lpage>.</mixed-citation>
    </ref>
    <ref id="vbab029-B8">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. (<year>2020</year>) <source>R: A Language and Environment for Statistical Computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna</publisher-loc>, <publisher-name>Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbab029-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>da Silva</surname><given-names>C.P.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Method validation using weighted linear regression models for quantification of UV filters in water samples</article-title>. <source>Talanta</source>, <volume>131</volume>, <fpage>221</fpage>–<lpage>227</lpage>.<pub-id pub-id-type="pmid">25281096</pub-id></mixed-citation>
    </ref>
    <ref id="vbab029-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sonawane</surname><given-names>S.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>An approach to select linear regression model in bioanalytical method validation</article-title>. <source>J. Anal. Sci. Technol</source>., <volume>10</volume>, <fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="vbab029-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tellinghuisen</surname><given-names>J.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Weighted least-squares in calibration: What difference does it make?</article-title><source>Analyst</source>, <volume>132</volume>, <fpage>536</fpage>–<lpage>543</lpage>.<pub-id pub-id-type="pmid">17525810</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
