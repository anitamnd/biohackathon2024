<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6788989</article-id>
    <article-id pub-id-type="publisher-id">12493</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-019-12493-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Longshot enables accurate variant calling in diploid genomes from single-molecule long read sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Edge</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bansal</surname>
          <given-names>Vikas</given-names>
        </name>
        <address>
          <email>vibansal@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>University of California, San Diego, </institution></institution-wrap>La Jolla, California 92093 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Department of Pediatrics, School of Medicine, </institution><institution>University of California, San Diego, </institution></institution-wrap>La Jolla, California 92093 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>4660</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Whole-genome sequencing using sequencing technologies such as Illumina enables the accurate detection of small-scale variants but provides limited information about haplotypes and variants in repetitive regions of the human genome. Single-molecule sequencing (SMS) technologies such as Pacific Biosciences and Oxford Nanopore generate long reads that can potentially address the limitations of short-read sequencing. However, the high error rate of SMS reads makes it challenging to detect small-scale variants in diploid genomes. We introduce a variant calling method, Longshot, which leverages the haplotype information present in SMS reads to accurately detect and phase single-nucleotide variants (SNVs) in diploid genomes. We demonstrate that Longshot achieves very high accuracy for SNV detection using whole-genome Pacific Biosciences data, outperforms existing variant calling methods, and enables variant detection in duplicated regions of the genome that cannot be mapped using short reads.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Single-molecule sequencing (SMS) such as Pacific Biosciences and Oxford Nanopore generate long reads with high error rate. Here, the authors develop Longshot, a computational method that detects and phases single nucleotide variants (SNV) in diploid genomes using SMS data.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome informatics</kwd>
      <kwd>Software</kwd>
      <kwd>Genetic variation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000051</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Human Genome Research Institute (NHGRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG010149</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bansal</surname>
            <given-names>Vikas</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">The availability of second-generation DNA sequencing technologies such as Illumina short reads has made the resequencing of human genomes routine<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Both single-nucleotide variants (SNVs), the most abundant form of variation in the human genome, and small indel variants can be reliably detected using whole-genome Illumina sequencing using sequence coverage of 30–40×<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. Nevertheless, sequencing human genomes using short-read sequencing technologies has many limitations. First, humans are diploid organisms with two copies (maternal and paternal) of each autosomal chromosome. Haplotypes, or the sequence of alleles that occur on an individual chromosome, can be computationally assembled from whole-genome sequencing (WGS) using overlaps between reads that span multiple heterozygous variants<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref></sup>. However, due to the low rate of heterozygosity of human genomes<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, Illumina reads derived from paired-end sequencing of short fragment libraries (200–500 bp in length) typically cover only a single variant site and do not provide long-range haplotype information. Second, ~<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.6 \text{\%}$$\end{document}</tex-math><mml:math id="M2"><mml:mn>3.6</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq1.gif"/></alternatives></inline-formula> of the genome consists of long and highly similar duplicated sequences where short reads cannot be uniquely mapped and hence SNVs cannot be detected. These regions overlap hundreds of coding genes, including many disease-associated genes such as <italic>PMS2</italic> and <italic>STRC</italic><sup><xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    <p id="Par4">Third-generation single-molecule sequencing (SMS) technologies such as Pacific Biosciences (PacBio) and Oxford Nanopore Technologies (ONT) generate long sequence reads; average read lengths for the PacBio single-molecule real-time (SMRT) technology are 10–30 kb<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. These long reads have the potential to overcome many of the limitations of short-read sequencing technologies including haplotyping and detection of structural variation. Indeed, SMS data have been successfully used for de novo assembly of human genomes<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>, identifying complex structural variation<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> and haplotype assembly of human genomes<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>. However, compared with short-read sequencing technologies such as Illumina, the per-base accuracy of SMS reads is low with an error rate exceeding 10% (primarily due to insertion/deletion errors)<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. This high error rate makes the detection of small sequence variants such as SNVs, particularly heterozygous variants, difficult.</p>
    <p id="Par5">With the decreasing cost of SMS technologies and their increasing use for sequencing human genomes, accurate short variant calling methods for long-read SMS data can be valuable in many ways. Current benchmarks for variant calling in human genomes, developed by the the Genome in a Bottle (GIAB) Consortium<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>, are based on short-read sequence data and cover <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M4"><mml:mo>~</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq2.gif"/></alternatives></inline-formula>90.8% of the reference human genome sequence. These high-confidence variant calls are immensely valuable for developing new variant calling methods and sequencing technologies. However, these variant call sets are biased towards regions of the genome that are easy-to-call using short reads<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Accurate SNV calling using long-read SMS data can provide independent validation of short-read SNV calls leading to reduction in false positives and increased understanding of systematic errors and artifacts. Furthermore, SNV calling using SMS reads can enable the generation of high-confidence variant calls in repetitive regions of the genome that include segmental duplications. The ability to call variants in repetitive regions that are inaccessible to short-read sequencing technologies can also advance the use of SMS technologies for detection of disease-causing mutations in duplicated genes via whole-genome or targeted sequencing<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>.</p>
    <p id="Par6">Haplotype-resolved SNV detection from SMS reads can also enable the discovery of other types of human genetic variation, such as structural variants (SVs) via separation of reads using haplotypes. Huddleston et al.<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> used an assembly-based approach, SMRT-SV, to identify thousands of SVs from whole-genome PacBio data of two haploid genomes, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$89 \text{\%}$$\end{document}</tex-math><mml:math id="M6"><mml:mn>89</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq3.gif"/></alternatives></inline-formula> of which were not reported by the 1000 Genomes Project<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. However, the sensitivity of SV detection using SMRT-SV was only 41% in diploid genomes. Chaisson et al.<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> performed dense whole-genome haplotyping of a human genome using multiple sequencing technologies, and were able to call SVs successfully on each group of haplotype-separated SMS reads.</p>
    <p id="Par7">Variant calling tools such as GATK HaplotyperCaller<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and FreeBayes<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> developed for short-read data analysis are not well-suited for SNV detection using PacBio data for two reasons as follows: (i) short reads have low error rates (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 0.5 {\%}$$\end{document}</tex-math><mml:math id="M8"><mml:mo>&lt;</mml:mo><mml:mn>0.5</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq4.gif"/></alternatives></inline-formula>) and these methods do not model the high indel error rate of SMS reads, which makes it difficult to distinguish true SNVs from errors, and (ii) these methods analyze reads in short windows (typically a few hundred bases) and are not designed to leverage the haplotype information present in SMS reads. This haplotype information can be invaluable in distinguishing true variants from errors, as observations of a true variant segregate with the reads originating from the haplotype on which it occurs, whereas sequencing errors are unlikely to segregate. Recently, several methods for variant calling from long reads and deep-learning-based variant calling methods have been developed<sup><xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>. However, the accuracy of these methods for SNV calling on SMS data is currently much lower than that using Illumina WGS<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup>.</p>
    <p id="Par8">We describe a diploid SNV calling method, Longshot, which harnesses long SMS reads to jointly perform SNV detection and haplotyping. For this, it uses our read-based haplotype phasing method HapCUT2<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. To overcome the high error rate of SMS reads, it utilizes a pair-Hidden Markov Model (pair-HMM) to average over the uncertainty in the local alignments and estimate accurate base quality values that can be used for calculating genotype likelihoods. We benchmarked Longshot using simulated data and whole-genome SMS data for multiple human individuals sequenced using the PacBio SMRT and Oxford Nanopore sequencing technologies<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>. LongShot achieves very high accuracy for SNV detection (precision <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.992$$\end{document}</tex-math><mml:math id="M10"><mml:mo>≥</mml:mo><mml:mn>0.992</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq5.gif"/></alternatives></inline-formula> and recall <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.96$$\end{document}</tex-math><mml:math id="M12"><mml:mo>≥</mml:mo><mml:mn>0.96</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq6.gif"/></alternatives></inline-formula>) on PacBio SMS datasets and outperforms current variant calling methods in accuracy and run time. We find that Longshot can also call SNVs with high accuracy using whole-genome Oxford Nanopore data.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of the method</title>
      <p id="Par9">Alignments of SMS reads suffer from reference bias, which can cause an SNV allele to be obscured by gaps (insertions and deletions) in the alignments (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). Nevertheless, a true SNV is likely to have at least a few correctly aligned reads with the alternate allele. The first step in the Longshot algorithm identifies potential SNV sites using a standard pileup-based genotyping calculation<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). A low variant quality threshold is used to select SNVs to minimize false negatives. Next, for each candidate SNV, we determine the most likely allele for each read covering the SNV and the corresponding estimate of the quality of the allele call (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). This allelotyping is done by local realignment of a segment of the read to short haplotype sequences (one for each of the two alleles at a biallelic SNV site). In low-complexity regions of the genome (e.g., homopolymers), there is significant ambiguity in the placement of gaps for SMS reads and many alignments are equally likely<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Therefore, we use the forward algorithm on a sequence alignment pair-HMM<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> to perform the local realignment by averaging all possible local alignments of a read to a given haplotype.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the Longshot algorithm. <bold>a</bold> Candidate variants are identified using the pileup of the original alignments and a standard genotype likelihood calculation is used to determine whether the site is a potential variant. <bold>b</bold> To determine the allele for each read at each potential SNV site it overlaps, a window is formed around the variant and the probability of the observed read sequence given each allele is calculated using the forward algorithm on a Pair-Hidden Markov Model. The most likely allele and quality score is chosen based on the relative likelihoods of the two alleles. <bold>c</bold> Using the alleles and quality values for each read at variant sites, phased genotypes for all variants are determined jointly by performing haplotype assembly using HapCUT2 (on heterozygous variants) and local updates of the phased genotypes in an iterative manner</p></caption><graphic xlink:href="41467_2019_12493_Fig1_HTML" id="d29e474"/></fig></p>
      <p id="Par10">After estimating the allele call and quality value for each read overlapping an SNV site, we estimate phased genotypes for all SNVs simultaneously using a haplotype-based likelihood model (see Methods). SMS reads typically cover multiple heterozygous sites and this haplotype information is useful, as an SNV on a haplotype is expected to segregate with reads from the same haplotype (although random sequencing errors are not). In Longshot, heterozygous SNVs are assembled into haplotypes using HapCUT2 and a local update procedure is used to estimate the most likely phased genotype for each SNV given the current haplotypes for all other SNVs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). This procedure is repeated for a few iterations until the likelihood stops improving. Finally, the variants are filtered for maximum read coverage, excessive variant density, and minimum Genotype Quality (GQ) score, where the GQ score is estimated using the phased genotype likeli   hoods.</p>
    </sec>
    <sec id="Sec4">
      <title>Accurate SNV calling using simulated data</title>
      <p id="Par11">First, we used simulations to assess the accuracy of SNV calling using Longshot and also compared the precision and recall with short-read variant calling. We simulated a diploid genome by adding SNVs to the reference human genome and simulated paired-end Illumina reads and PacBio SMS reads from this genome (maximum coverage of 60 ×). Subsequently, we aligned the reads to the reference genome using BWA-MEM<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> (Illumina) and BLASR<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>(PacBio), and called SNVs using FreeBayes and Longshot, respectively. Across the entire genome, the precision was consistently high (≥0.9999) at all read coverages (20–60×) for both short read and SMS read-based SNV calling (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). Short reads achieved greater recall than SMS reads at lower coverage (≤30×), whereas SMS reads had marginally greater recall at higher coverage (≥40×). SMS reads are expected to have better mappability in repetitive regions of the genome compared with Illumina reads, particularly in long segmental duplications with high sequence identity. Indeed, the recall for SMS reads in segmental duplications with high sequence similarity (≥95%, 127.5 Mb of DNA sequence) was significantly higher (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.86$$\end{document}</tex-math><mml:math id="M14"><mml:mn>0.86</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq7.gif"/></alternatives></inline-formula> at <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$40\times$$\end{document}</tex-math><mml:math id="M16"><mml:mn>40</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq8.gif"/></alternatives></inline-formula> coverage) compared with that using short reads (<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.57$$\end{document}</tex-math><mml:math id="M18"><mml:mn>0.57</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq9.gif"/></alternatives></inline-formula> at <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$40\times$$\end{document}</tex-math><mml:math id="M20"><mml:mn>40</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq10.gif"/></alternatives></inline-formula> coverage) and increased with increasing coverage (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>).</p>
      <p id="Par12">We also compared the precision/recall of SNV calling using BLASR with several long-read mapping tools: NGMLR<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, BWA-MEM<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, and MINIMAP2<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. All tools showed high precision and recall when considering SNVs across the whole genome, but BLASR had significantly higher recall (maximum of <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.88$$\end{document}</tex-math><mml:math id="M22"><mml:mn>0.88</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq11.gif"/></alternatives></inline-formula>) than all other aligners (<inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.72$$\end{document}</tex-math><mml:math id="M24"><mml:mn>0.72</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq12.gif"/></alternatives></inline-formula> using Minimap2) in segmental duplications (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). Therefore, we utilized BLASR for the analysis of real datasets.</p>
      <p id="Par13">We used the simulated datasets to estimate the theoretical fraction of the genome that is callable with SMS long reads compared with short reads at <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\times$$\end{document}</tex-math><mml:math id="M26"><mml:mn>60</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq13.gif"/></alternatives></inline-formula> coverage. We found that SMS reads were able to span <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$99.4 \text{\%}$$\end{document}</tex-math><mml:math id="M28"><mml:mn>99.4</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq14.gif"/></alternatives></inline-formula> of the genome (non-N bases on chromosomes 1–22 with at least 30× coverage and at least <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$90 \text{\%}$$\end{document}</tex-math><mml:math id="M30"><mml:mn>90</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq15.gif"/></alternatives></inline-formula> of reads well-mapped at each position (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>)). In comparison, Illumina reads covered <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$96.3 \text{\%}$$\end{document}</tex-math><mml:math id="M32"><mml:mn>96.3</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq16.gif"/></alternatives></inline-formula> of the genome under these same criteria, a difference of <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.1 \text{\%}$$\end{document}</tex-math><mml:math id="M34"><mml:mn>3.1</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq17.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec5">
      <title>Accurate SNV calling using whole-genome PacBio data</title>
      <p id="Par14">We used Longshot to call SNVs using whole-genome human PacBio data for four human genomes from GIAB consortium<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Specifically, we used WGS data for the NA12878 individual (45 ×) and a mother–father–child trio of Ashkenazi ancestry (NA24385 at 64 ×, NA24149 at 29 ×, and NA24143 at 27 ×). For each dataset, a GQ threshold that was linearly proportional to the median read depth was used for filtering variants (see Methods). For comparison, we also called SNVs using Illumina short-read WGS data (∼30 × coverage) for each individual.</p>
      <p id="Par15">Longshot identified 3.51 to 3.65 million SNVs per genome (on chromosomes 1–22 only) and required 35 h on average to process ∼28× whole-genome data on a single core (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). To assess the precision and recall of SNV calling, we utilized the GIAB high-confidence variant call set for each individual<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. The comparison of SNV calls was limited to GIAB high-confidence regions for each genome<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. The precision and recall for NA12878 were <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.9942$$\end{document}</tex-math><mml:math id="M36"><mml:mn>0.9942</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.9592$$\end{document}</tex-math><mml:math id="M38"><mml:mn>0.9592</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq19.gif"/></alternatives></inline-formula>, respectively, at <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$30\times$$\end{document}</tex-math><mml:math id="M40"><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq20.gif"/></alternatives></inline-formula> coverage and the recall improved to <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.9734$$\end{document}</tex-math><mml:math id="M42"><mml:mn>0.9734</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq21.gif"/></alternatives></inline-formula> at <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$45\times$$\end{document}</tex-math><mml:math id="M44"><mml:mn>45</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq22.gif"/></alternatives></inline-formula> coverage. The precision and recall, and the precision-recall curves (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>) were highly consistent across the four genomes at 27–30 coverage (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a,b), demonstrating the robustness of our method. To assess the improvement in precision/recall as a function of sequence coverage, we sub-sampled data for the AJ son individual (NA24385), who was sequenced to <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$64\times$$\end{document}</tex-math><mml:math id="M46"><mml:mn>64</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq23.gif"/></alternatives></inline-formula> coverage. The recall improved steadily from 0.9608 (28×) to 09798 (64×), whereas the precision only changed moderately with increasing coverage (<inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.9930$$\end{document}</tex-math><mml:math id="M48"><mml:mn>0.9930</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq24.gif"/></alternatives></inline-formula> to <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.9936$$\end{document}</tex-math><mml:math id="M50"><mml:mn>0.9936</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq25.gif"/></alternatives></inline-formula>). The precision and recall for SNV calling using SMS reads was slightly lower than Illumina-based variant calling (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Nevertheless, the ability of Longshot to consistently achieve high recall (only 2–3% lower than Illumina WGS for the same depth of coverage), while achieving a low false discovery rate (FDR; average = <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.7 \text{\%}$$\end{document}</tex-math><mml:math id="M52"><mml:mn>0.7</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq26.gif"/></alternatives></inline-formula>) was remarkable given the significantly high error rate of SMS reads (<inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M54"><mml:mo>~</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq27.gif"/></alternatives></inline-formula>10%) compared with Illumina reads.<fig id="Fig2"><label>Fig. 2</label><caption><p>Accuracy and completeness of LongShot SNV calls on whole-genome SMS data. Longshot was used to call single nucleotide variants (SNVs) using SMS data from the GIAB project for four human genomes: NA12878 (<inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$30\times$$\end{document}</tex-math><mml:math id="M56"><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$45\times$$\end{document}</tex-math><mml:math id="M58"><mml:mn>45</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq29.gif"/></alternatives></inline-formula> coverage), NA24385 (<inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$28\times$$\end{document}</tex-math><mml:math id="M60"><mml:mn>28</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq30.gif"/></alternatives></inline-formula>, <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$37\times$$\end{document}</tex-math><mml:math id="M62"><mml:mn>37</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$46\times$$\end{document}</tex-math><mml:math id="M64"><mml:mn>46</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq32.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$64\times$$\end{document}</tex-math><mml:math id="M66"><mml:mn>64</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq33.gif"/></alternatives></inline-formula> coverage), NA24149 (<inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$29\times$$\end{document}</tex-math><mml:math id="M68"><mml:mn>29</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq34.gif"/></alternatives></inline-formula> coverage), and NA24143 (<inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$27\times$$\end{document}</tex-math><mml:math id="M70"><mml:mn>27</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq35.gif"/></alternatives></inline-formula> coverage). For each individual, variants were also called using FreeBayes applied to <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 30\times$$\end{document}</tex-math><mml:math id="M72"><mml:mo>~</mml:mo><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq36.gif"/></alternatives></inline-formula> coverage Illumina short reads. <bold>a</bold> Precision of the SNV calls calculated using the GIAB high-confidence variant call set. <bold>b</bold> Recall of the SNV calls. <bold>c</bold> The combined switch error rate (total rate of switch errors and mismatch errors) of the Longshot and Illumina short-read-based haplotypes. <bold>d</bold> N50 length of the haplotypes. <bold>e</bold> The fraction of heterozygous variants phased in each dataset</p></caption><graphic xlink:href="41467_2019_12493_Fig2_HTML" id="d29e927"/></fig></p>
      <p id="Par16">In contrast with simulated data, the precision of of Longshot on real SMS reads was slightly lower than short-read variant calling. To determine the source of false-positive calls, we analyzed whether such calls were enriched in specific sequence contexts or overlapped with indels. For the NA12878 dataset (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>), we observed that the vast majority (<inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$71.4 \text{\%}$$\end{document}</tex-math><mml:math id="M74"><mml:mn>71.4</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq37.gif"/></alternatives></inline-formula>) of false-positive SNVs are located within 5 bp of a true indel. These false-positive SNVs are called, as the current implementation of Longshot does not consider indels as potential variants. Filtering SNV calls located near known indels (using the Mills + 1000 Genomes Gold Standard Indels set from the GATK resource bundle<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>), reduced the number of false positives by 34–45% for the four GIAB genomes (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>), while only slightly decreasing the recall. Analysis of false-negative SNVs showed that <inline-formula id="IEq39"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$19.5 \text{\%}$$\end{document}</tex-math><mml:math id="M76"><mml:mn>19.5</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq39.gif"/></alternatives></inline-formula> of the false-negative SNVs occurred inside homopolymer sequences of length 5 or greater, which is <inline-formula id="IEq40"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.4\times$$\end{document}</tex-math><mml:math id="M78"><mml:mn>3.4</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq40.gif"/></alternatives></inline-formula> the expected value. This follows naturally from the fact that these regions have low information content; insertion and deletion errors could plausibly lie anywhere along the length of a homopolymer. Therefore, allele calls inside homopolymers receive lower quality scores from the pair-HMM realignment, which reduces the power to call SNVs in such regions.</p>
      <p id="Par17">To compare Longshot’s accuracy on SMS data with other methods, we considered existing variant calling methods for short-read data including GATK and FreeBayes. However, the GATK HC tool did not generate variant calls on the NA12878 PacBio dataset, consistent with previous evaluations of these methods on SMS data<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Recently, a deep-learning-based method for variant calling has been developed that can process both Illumina and SMS long-read data<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Although we were unable to perform a direct comparison with DeepVariant due to unavailability of trained models for PacBio continuous long read (CLR) data, comparison of the reported precision and recall for DeepVariant on the NA12878 dataset (aligned with the same tool) showed that Longshot had better precision than DeepVariant, while the recall was similar (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>). At a GQ cutoff of 36, Longshot had the same recall as DeepVariant but higher precision (0.9939 vs. 0.9819).</p>
      <p id="Par18">We directly compared the accuracy of Longshot with a deep-learning-based method Clairvoyante<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> and WhatsHap<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, using whole-genome SMS data for four individual genomes. We used reads aligned with the NGMLR aligner<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> for evaluation, as Clairvoyante provides trained models for this aligner (see Supplementary Methods for details). For WhatsHap, we used the potential variants identified in step 1 of Longshot as input, as the current version of this tool (version 0.18) does not support potential variant identification. On the NA12878 dataset, the precision and recall for Longshot were higher than both Clairvoyante and WhatsHap (Table <xref rid="Tab1" ref-type="table">1</xref>). In particular, Longshot achieved very high precision or a low FDR of 0.5%. In comparison, the FDR for Clairvoyante was threefold higher, <inline-formula id="IEq41"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.6 \text{\%}$$\end{document}</tex-math><mml:math id="M80"><mml:mn>1.6</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq41.gif"/></alternatives></inline-formula>. Comparison of the precision-recall curves for three methods on the NA12878 dataset showed that Longshot outperforms both competing methods for all precision values &gt;<inline-formula id="IEq42"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.98$$\end{document}</tex-math><mml:math id="M82"><mml:mn>0.98</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq42.gif"/></alternatives></inline-formula> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). Similarly, analysis of variant calls for two other GIAB genomes (NA24143 and NA24149) showed that Longshot had the best precision and recall among the three methods (1). On the high-coverage NA24385, Clairvoyante’s recall and precision were marginally better than Longshot (0.3–0.4% higher). Nevertheless, the precision (0.994) and recall (0.980) for Longshot on this dataset using the BLASR alignments were better than Clairvoyante (0.990 and 0.969, respectively). Longshot was also the most computationally efficient of three methods in terms of run time (1). For the NA12878 dataset, the maximum memory usage for Longshot was 5.5 GB compared with 6.2 and 12.7 GB for WhatsHap and Clairvoyante, respectively.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of accuracy for variant calling methods on whole-genome SMS data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Genome</th><th>Read</th><th>Method</th><th>Precision</th><th>Recall</th><th>Runtime</th></tr><tr><th/><th>Coverage</th><th/><th/><th/><th>(h)</th></tr></thead><tbody><tr><td/><td/><td>Longshot</td><td><inline-formula id="IEq43"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.995$$\end{document}</tex-math><mml:math id="M84"><mml:mn>0.995</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq43.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq44"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.968$$\end{document}</tex-math><mml:math id="M86"><mml:mn>0.968</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq44.gif"/></alternatives></inline-formula></td><td>23:31</td></tr><tr><td>NA12878</td><td>44</td><td>WhatsHap</td><td><inline-formula id="IEq45"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.972$$\end{document}</tex-math><mml:math id="M88"><mml:mn>0.972</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq45.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq46"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.975$$\end{document}</tex-math><mml:math id="M90"><mml:mn>0.975</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq46.gif"/></alternatives></inline-formula></td><td>27:47</td></tr><tr><td/><td/><td>Clairvoyante</td><td><inline-formula id="IEq47"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.984$$\end{document}</tex-math><mml:math id="M92"><mml:mn>0.984</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq47.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq48"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.957$$\end{document}</tex-math><mml:math id="M94"><mml:mn>0.957</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq48.gif"/></alternatives></inline-formula></td><td>21:44 (×4)</td></tr><tr><td/><td/><td>Longshot</td><td><inline-formula id="IEq49"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.987$$\end{document}</tex-math><mml:math id="M96"><mml:mn>0.987</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq49.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq50"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.965$$\end{document}</tex-math><mml:math id="M98"><mml:mn>0.965</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq50.gif"/></alternatives></inline-formula></td><td>41:55</td></tr><tr><td>NA24385</td><td>62</td><td>WhatsHap</td><td><inline-formula id="IEq51"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.976$$\end{document}</tex-math><mml:math id="M100"><mml:mn>0.976</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq51.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq52"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.974$$\end{document}</tex-math><mml:math id="M102"><mml:mn>0.974</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq52.gif"/></alternatives></inline-formula></td><td>32:09</td></tr><tr><td/><td/><td>Clairvoyante</td><td><inline-formula id="IEq53"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.990$$\end{document}</tex-math><mml:math id="M104"><mml:mn>0.990</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq53.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq54"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.969$$\end{document}</tex-math><mml:math id="M106"><mml:mn>0.969</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq54.gif"/></alternatives></inline-formula></td><td>22:25 (×4)</td></tr><tr><td/><td/><td>Longshot</td><td><inline-formula id="IEq55"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.981$$\end{document}</tex-math><mml:math id="M108"><mml:mn>0.981</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq55.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq56"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.927$$\end{document}</tex-math><mml:math id="M110"><mml:mn>0.927</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq56.gif"/></alternatives></inline-formula></td><td>20:03</td></tr><tr><td>NA24385</td><td>27</td><td>WhatsHap</td><td><inline-formula id="IEq57"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.959$$\end{document}</tex-math><mml:math id="M112"><mml:mn>0.959</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq57.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq58"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.941$$\end{document}</tex-math><mml:math id="M114"><mml:mn>0.941</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq58.gif"/></alternatives></inline-formula></td><td>22:54</td></tr><tr><td/><td/><td>Clairvoyante</td><td><inline-formula id="IEq59"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.960$$\end{document}</tex-math><mml:math id="M116"><mml:mn>0.960</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq59.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq60"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.927$$\end{document}</tex-math><mml:math id="M118"><mml:mn>0.927</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq60.gif"/></alternatives></inline-formula></td><td>21:09 (×4)</td></tr><tr><td/><td/><td>Longshot</td><td><inline-formula id="IEq61"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.993$$\end{document}</tex-math><mml:math id="M120"><mml:mn>0.993</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq61.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq62"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.941$$\end{document}</tex-math><mml:math id="M122"><mml:mn>0.941</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq62.gif"/></alternatives></inline-formula></td><td>18:51</td></tr><tr><td>NA24143</td><td>27</td><td>WhatsHap</td><td><inline-formula id="IEq63"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.962$$\end{document}</tex-math><mml:math id="M124"><mml:mn>0.962</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq63.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq64"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.949$$\end{document}</tex-math><mml:math id="M126"><mml:mn>0.949</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq64.gif"/></alternatives></inline-formula></td><td>22:06</td></tr><tr><td/><td/><td>Clairvoyante</td><td><inline-formula id="IEq65"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.960$$\end{document}</tex-math><mml:math id="M128"><mml:mn>0.960</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq65.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq66"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.920$$\end{document}</tex-math><mml:math id="M130"><mml:mn>0.920</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq66.gif"/></alternatives></inline-formula></td><td>21:42 (×4)</td></tr><tr><td/><td/><td>Longshot</td><td><inline-formula id="IEq67"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.993$$\end{document}</tex-math><mml:math id="M132"><mml:mn>0.993</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq67.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq68"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.924$$\end{document}</tex-math><mml:math id="M134"><mml:mn>0.924</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq68.gif"/></alternatives></inline-formula></td><td>16:59</td></tr><tr><td>NA24149</td><td>23</td><td>WhatsHap</td><td><inline-formula id="IEq69"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.959$$\end{document}</tex-math><mml:math id="M136"><mml:mn>0.959</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq69.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq70"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.934$$\end{document}</tex-math><mml:math id="M138"><mml:mn>0.934</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq70.gif"/></alternatives></inline-formula></td><td>20:30</td></tr><tr><td/><td/><td>Clairvoyante</td><td><inline-formula id="IEq71"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.938$$\end{document}</tex-math><mml:math id="M140"><mml:mn>0.938</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq71.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq72"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.904$$\end{document}</tex-math><mml:math id="M142"><mml:mn>0.904</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq72.gif"/></alternatives></inline-formula></td><td>23:59 (×4)</td></tr></tbody></table><table-wrap-foot><p>All methods were run on BAM files generated using the NGMLR aligner, and precision and recall values were calculated using the GIAB high-confidence variant calls. The runtime listed is the total walltime to process all chromosomes individually. Clairvoyante supports multi-threading and was run using four threads per chromosome</p></table-wrap-foot></table-wrap></p>
      <p id="Par19">The phased genotyping or haplotype assembly step of Longshot distinguishes it from state-of-the-art variant callers for short-read data<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup> and recent deep-learning-based methods for variant calling<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup>. We investigated the importance of the phased genotyping for the accuracy of Longshot by running it on the NA12878 PacBio dataset (downsampled to 30<inline-formula id="IEq73"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M144"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq73.gif"/></alternatives></inline-formula> coverage) without phased genotyping (essentially skipping step 3 of the algorithm). We found that skipping the phased genotyping reduced Longshot’s recall significantly from 0.959 to 0.905 (GQ threshold of 30), while the precision remained virtually unchanged (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Accuracy of Longshot haplotypes</title>
      <p id="Par20">Next, we assessed the accuracy and completeness of haplotype assembly using Longshot for two GIAB individuals, NA12878 and NA24385, by comparison with gold-standard haplotypes for these individuals inferred using pedigree data (see Methods). The median read lengths for these two datasets were <inline-formula id="IEq74"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3587$$\end{document}</tex-math><mml:math id="M146"><mml:mn>3587</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$7235$$\end{document}</tex-math><mml:math id="M148"><mml:mn>7235</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq75.gif"/></alternatives></inline-formula> bp, respectively. The Longshot haplotypes for NA12878 had an N50 length of <inline-formula id="IEq76"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$217.4$$\end{document}</tex-math><mml:math id="M150"><mml:mn>217.4</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq76.gif"/></alternatives></inline-formula> kb (with respect to the phased portion of the genome) and were very accurate, with a combined switch error rate of <inline-formula id="IEq77"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.05 \text{\%}$$\end{document}</tex-math><mml:math id="M152"><mml:mn>0.05</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq77.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c,d). Similarly, the haplotypes for NA24385 (<inline-formula id="IEq78"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$30\times$$\end{document}</tex-math><mml:math id="M154"><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq78.gif"/></alternatives></inline-formula> coverage) had an N50 length of <inline-formula id="IEq79"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$299.9$$\end{document}</tex-math><mml:math id="M156"><mml:mn>299.9</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq79.gif"/></alternatives></inline-formula> kb and a combined switch error rate equal to <inline-formula id="IEq80"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.04 \text{\%}$$\end{document}</tex-math><mml:math id="M158"><mml:mn>0.04</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq80.gif"/></alternatives></inline-formula>. In comparison, haplotypes assembled using short reads had a N50 length &lt;<inline-formula id="IEq81"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2$$\end{document}</tex-math><mml:math id="M160"><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq81.gif"/></alternatives></inline-formula> kb for both genomes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). We also used HapCUT2 and WhatsHap to assemble haplotypes for NA12878 and NA24385 using SMS reads and SNVs identified using <inline-formula id="IEq82"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 30\times$$\end{document}</tex-math><mml:math id="M162"><mml:mo>~</mml:mo><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq82.gif"/></alternatives></inline-formula> coverage Illumina sequencing<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. We found that the haplotype accuracy and completeness were comparable between the three methods, whereas HapCUT2 had the lowest switch and mismatch error rates (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). Separation of SMS reads using SNV haplotypes can enable discovery of non-SNV variants such as indels and SVs using methods such as SMRT-SV<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, which work well on haploid genomes. For the NA12878 dataset (chromosome 1 only), 51.1% of reads (weighted by length) could be assigned to a haplotype with high confidence. The ability to assign reads to haplotypes was dependent on read length: the haplotype-assigned reads had a median length of <inline-formula id="IEq83"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4.3$$\end{document}</tex-math><mml:math id="M164"><mml:mn>4.3</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq83.gif"/></alternatives></inline-formula> kb, whereas the unassigned reads had a median length of <inline-formula id="IEq84"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.6$$\end{document}</tex-math><mml:math id="M166"><mml:mn>2.6</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq84.gif"/></alternatives></inline-formula> kb only.</p>
    </sec>
    <sec id="Sec7">
      <title>SNV calling using Oxford Nanopore reads</title>
      <p id="Par21">Recently, reads from Oxford Nanopore Technologies’ (ONT) MinION sequencer were used to assemble a human genome<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Nanopore reads have a similar error profile to PacBio SMRT reads; however, the total per-base error rate of ONT reads is reported to be higher than for PacBio SMRT<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and the errors are dependent on sequence context<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. We applied the Longshot algorithm to call SNVs using a whole-genome Oxford Nanopore dataset for a human individual (NA12878, <inline-formula id="IEq85"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$37\times$$\end{document}</tex-math><mml:math id="M168"><mml:mn>37</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq85.gif"/></alternatives></inline-formula> coverage). We observed that the candidate set of SNVs considered by Longshot contained a significant fraction of false positives due to the context-specific errors in Nanopore reads. To amelioriate this, we implemented a simple filter to remove potential SNVs for which the allele observations show a significant strand bias (Fisher’s exact test <italic>p</italic>-value &lt; 0.01), prior to haplotype assembly. On the latest version of this ONT dataset, LongShot achieved a precision equal to <inline-formula id="IEq86"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.991$$\end{document}</tex-math><mml:math id="M170"><mml:mn>0.991</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq86.gif"/></alternatives></inline-formula> and recall value equal to <inline-formula id="IEq87"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.933$$\end{document}</tex-math><mml:math id="M172"><mml:mn>0.933</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq87.gif"/></alternatives></inline-formula> at a GQ threshold of 65 for SNV calling (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref> for a precision-recall curve). For comparison, we called variants using Nanopolish, a software tool for signal-level analysis of Oxford Nanopore data<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. Nanopolish required more than 43 h to call variants on chromosome 20 using 4 cores and achieved a best F1 score of <inline-formula id="IEq88"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.93$$\end{document}</tex-math><mml:math id="M174"><mml:mn>0.93</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq88.gif"/></alternatives></inline-formula> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). In contrast, Longshot had a best F1 score of <inline-formula id="IEq89"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.967$$\end{document}</tex-math><mml:math id="M176"><mml:mn>0.967</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq89.gif"/></alternatives></inline-formula> and took only 5 h and 13 min for variant calling (using a single core). In addition, the accuracy of Longshot on Oxford Nanopore data was better than the reported accuracy of other methods (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>).</p>
    </sec>
    <sec id="Sec8">
      <title>Analysis of SNV calls in repetitive regions</title>
      <p id="Par22">As demonstrated with simulations, the recall of variant calling using SMS reads in segmental duplications with high sequence similarity (<inline-formula id="IEq90"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M178"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq90.gif"/></alternatives></inline-formula>95%, Fig. <xref rid="Fig2" ref-type="fig">2</xref>) is significantly higher (0.86) compared with short reads (0.57). These regions correspond to <inline-formula id="IEq91"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$102.8$$\end{document}</tex-math><mml:math id="M180"><mml:mn>102.8</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq91.gif"/></alternatives></inline-formula> Mb of the genome (excluding the sex chromosomes). However, <inline-formula id="IEq92"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$97.7 \text{\%}$$\end{document}</tex-math><mml:math id="M182"><mml:mn>97.7</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq92.gif"/></alternatives></inline-formula> of these regions are excluded from the GIAB high-confidence variants, making it challenging to assess the accuracy of SNV calling using real SMS data. We compared SNV calls in segmental duplications for the NA12878 genome made using short-read Illumina data (33 × coverage) and SMS reads (30 × coverage). In segmental duplications with ≥95% similarity, <inline-formula id="IEq93"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$180,889$$\end{document}</tex-math><mml:math id="M184"><mml:mn>180</mml:mn><mml:mo>,</mml:mo><mml:mn>889</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq93.gif"/></alternatives></inline-formula> SNVs were called using SMS reads, 55.0% more than those using Illumina reads (Table <xref rid="Tab2" ref-type="table">2</xref>). The fewer calls using Illumina reads likely reflect the inability to map in segmental duplications. For example, Illumina reads cannot be mapped uniquely in a significant portion of the <italic>STRC</italic> gene, resulting in 52.3% fewer variants called compared with SMS reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We found that in total, 1.66 Mb of the bases in segmental duplications with ≥95% similarity overlap with coding exons and 90.3% of these bases were well-mapped in the 45<inline-formula id="IEq95"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M186"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq95.gif"/></alternatives></inline-formula> PacBio dataset (each position having at least <inline-formula id="IEq96"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20\times$$\end{document}</tex-math><mml:math id="M188"><mml:mn>20</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq96.gif"/></alternatives></inline-formula> coverage and ≥90% of reads aligned to the position having MAPQ ≥30). The difference was more stark in segmental duplications with ≥99% similarity: <inline-formula id="IEq97"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$78,851$$\end{document}</tex-math><mml:math id="M190"><mml:mn>78</mml:mn><mml:mo>,</mml:mo><mml:mn>851</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq97.gif"/></alternatives></inline-formula> SNVs were called with SMS reads compared with only <inline-formula id="IEq98"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$18,684$$\end{document}</tex-math><mml:math id="M192"><mml:mn>18</mml:mn><mml:mo>,</mml:mo><mml:mn>684</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq98.gif"/></alternatives></inline-formula> with Illumina reads (4.2-fold difference). The Transition/Transversion (Ts/Tv) ratio for the SNVs called only using SMS reads in these regions was 1.99, slightly lower than the ratio for the SNV calls in GIAB confident regions (∼2.1). This is consistent with the expectation that the Ts/Tv ratio is usually ∼2.0–2.1 for SNVs across the whole genome<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. In contrast, the Ts/Tv ratio for Illumina-only calls in segmental duplications with ≥99% similarity was <inline-formula id="IEq99"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.55$$\end{document}</tex-math><mml:math id="M194"><mml:mn>1.55</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq99.gif"/></alternatives></inline-formula>, much lower than the expected value (Table <xref rid="Tab2" ref-type="table">2</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of PacBio and Illumina SNV calls for NA12878</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th>Genome</th><th>Inside GIAB</th><th>Outside GIAB</th><th>Segmental Dup.</th><th>Segmental Dup.</th></tr><tr><th/><th/><th>(1–22)</th><th>Confident</th><th>Confident</th><th>(≥95% similar)</th><th>(≥99% similar)</th></tr></thead><tbody><tr><td>Region size</td><td/><td>2.8 Gb</td><td>2.4 Gb</td><td>330.7 Mb</td><td>102.8 Mb</td><td>47.5 Mb</td></tr><tr><td/><td># SNVs</td><td>3,518,530</td><td>3,002,660</td><td>515,870</td><td>180,889</td><td>78,851</td></tr><tr><td>PacBio</td><td>Ts/Tv</td><td>2.08</td><td>2.14</td><td>1.75</td><td>1.95</td><td>1.99</td></tr><tr><td/><td># SNVs</td><td>3,563,787</td><td>3,065,573</td><td>498,214</td><td>116,649</td><td>18,684</td></tr><tr><td>Illumina</td><td>Ts/Tv</td><td>2.03</td><td>2.1</td><td>1.66</td><td>1.84</td><td>1.79</td></tr><tr><td/><td># SNVs</td><td>254,428</td><td>63,848</td><td>190,580</td><td>103,621</td><td>69,705</td></tr><tr><td>Unique to PacBio</td><td>Ts/Tv</td><td>1.63</td><td>1.83</td><td>1.57</td><td>1.9</td><td>1.99</td></tr><tr><td/><td># SNVs</td><td>299,733</td><td>126,763</td><td>172,970</td><td>39,409</td><td>9538</td></tr><tr><td>Unique to Illumina</td><td>Ts/Tv</td><td>1.3</td><td>1.26</td><td>1.33</td><td>1.53</td><td>1.55</td></tr><tr><td>Shared</td><td># SNVs</td><td>3,264,078</td><td>2,938,812</td><td>325,266</td><td>77,241</td><td>9146</td></tr><tr><td>Illumina &amp; PacBio</td><td>Ts/Tv</td><td>2.12</td><td>2.15</td><td>1.85</td><td>2.01</td><td>2.04</td></tr></tbody></table><table-wrap-foot><p>Variants were called using short reads (33× coverage) with FreeBayes and using SMS long reads (30× coverage) with Longshot. The number of variants called by each technology, the number of variants shared between the two technologies, and the corresponding transition/transversion (Ts/Tv) ratios are shown for the whole genome and various subsets of the genome including GIAB high-confidence regions and segmental duplications with high sequence identity</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><p>Accurate variant calling using SMS reads and Longshot in the duplicated gene <italic>STRC</italic>. An Integrated Genomics Viewer (IGV) view of mapped reads shows that a long segment of the gene (circled in black) has low coverage using uniquely mapped Illumina reads due to the presence of a long segmental duplication with high sequence similarity (<inline-formula id="IEq100"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; \ 99.8 \%$$\end{document}</tex-math><mml:math id="M196"><mml:mo>&gt;</mml:mo><mml:mspace width="0.33em"/><mml:mn>99.8</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq100.gif"/></alternatives></inline-formula>) that spans the entire gene. PacBio reads (separated by haplotype using Longshot phased SNVs) have consistent coverage of mapped reads across the entire gene, allowing Longshot to call 42 SNVs of which 20 are shared with short reads, and 22 are unique to Longshot</p></caption><graphic xlink:href="41467_2019_12493_Fig3_HTML" id="d29e2334"/></fig></p>
      <p id="Par23">Next, we assessed the Mendelian consistency of SNV calls for the mother–father–child trio of Ashkenazi ancestry from the GIAB project. To minimize discordance due to false negative calls, only sites with at least <inline-formula id="IEq101"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20\times$$\end{document}</tex-math><mml:math id="M198"><mml:mn>20</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq101.gif"/></alternatives></inline-formula> read coverage in every individual were considered. SMS calls in the high-confidence GIAB regions had higher concordancy (<inline-formula id="IEq102"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$98.88 \text{\%}$$\end{document}</tex-math><mml:math id="M200"><mml:mn>98.88</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq102.gif"/></alternatives></inline-formula>) compared with calls outside GIAB confident regions (<inline-formula id="IEq103"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$96.17 \text{\%}$$\end{document}</tex-math><mml:math id="M202"><mml:mn>96.17</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq103.gif"/></alternatives></inline-formula>). Within segmental duplications (≥95% similarity), <inline-formula id="IEq104"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4.99 \text{\%}$$\end{document}</tex-math><mml:math id="M204"><mml:mn>4.99</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq104.gif"/></alternatives></inline-formula> of the SNVs in the child were discordant with Mendelian inheritance. Many of the discordant SNVs were clustered in contiguous blocks, indicating that they are the result of mismatched reads or structural variation in one or more individuals.</p>
      <p id="Par24">Finally, we compared Longshot SNV calls for NA12878 to the Platinum Genomes small variant call set for this genome that have been generated using Illumina WGS and validated using haplotype inheritance on a 17-member pedigree<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. In GIAB high-confidence regions, 95.2% of the PG SNVs were also called by Longshot. The PG calls cover a significant fraction of the genome (330.7 Mb) that is excluded from the GIAB high-confidence calls. In these regions, only 79.6% of the PG SNVs were shared with Longshot and 74,641 SNVs were unique to the PG calls (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>). The low concordance in regions outside the GIAB high-confidence regions highlights the challenge of accurate variant calling in these regions. Longshot’s ability to call SNVs accurately using SMS reads provides an orthogonal validation for SNVs called using short reads. In-depth analysis of variant calls made using short-read and SMS data in these regions can enable the expansion of confidently called regions for reference human genomes.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par25">Our results demonstrate that highly accurate detection of SNVs is feasible even from long-read sequence data with high error rates. Combined with recent work demonstrating the ability to detect and genotype SVs from SMRT-seq data, our results indicate that long-read sequencing can be used to accurately detect all forms of genetic variation in human genomes. Recently, Li et al.<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> wrote that “although PacBio assembly is accurate at the base-pair level for haploid genomes, it is currently not accurate enough to confidently call heterozygotes in diploid mammalian genomes.” We have demonstrated that heterozygous SNVs can be called accurately in diploid genomes, by combining sensitive allelotyping of reads at SNV sites with haplotype-informed genotyping. Our method has a very low FDR (<inline-formula id="IEq105"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.5$$\end{document}</tex-math><mml:math id="M206"><mml:mn>0.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq105.gif"/></alternatives></inline-formula>–<inline-formula id="IEq106"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.8 \text{\%}$$\end{document}</tex-math><mml:math id="M208"><mml:mn>0.8</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq106.gif"/></alternatives></inline-formula>) across multiple whole-genome PacBio datasets that is two- to fourfold lower than other variant calling methods. Furthermore, we find that the FDR can be reduced further to <inline-formula id="IEq107"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.3 \text{\%}$$\end{document}</tex-math><mml:math id="M210"><mml:mn>0.3</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq107.gif"/></alternatives></inline-formula> by filtering out known common indels.</p>
    <p id="Par26">We have also demonstrated that SMS reads can be used to call SNVs in segmental duplications and other regions of the genome with low short-read mappability. However, correctly mapping PacBio reads in highly similar segmental duplications remains a challenge. As Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref> shows, there is a wide variance in the ability of SMS read mappers to map reads in segmental duplications. This is likely due to the mappers having different strategies for dealing with highly similar mappings that are differentiated by a small number of paralog-specific variants. Despite BLASR performing relatively well using simulated reads, many of the discordant SNVs observed between the AJ trio in segmental duplications appeared to be caused by the presence of multiple mismapped reads. SMS read mapping methods with specific optimizations for segmental duplications could improve the ability to call variants in segmental duplications<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p>
    <p id="Par27">The GIAB and Platinum Genomes variant sets used to assess variant-calling accuracy in this study were generated using short-read datasets, are therefore biased in favor of short-read technologies<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, and exclude regions where long reads are likely to have better precision and recall. Therefore, in an unbiased genome-wide comparison, Longshot may achieve even better accuracy than short-read variant calling methods. Furthermore, some of the false-positive calls by Longshot may actually correspond to false negatives in the GIAB high-confidence call sets. A recent graph-based read alignment approach identified thousands of variants that were absent in the GIAB call sets<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. In the NA12878 genome, Longshot identified 5900 SNVs that are located in GIAB high-confidence regions and do not overlap indels present in the GIAB variant calls. Many of these variants are located in variant-dense genomic regions that are problematic for mapping using short reads but should be callable using long single-molecule reads. Further analysis of these variants will be helpful in improving the recall of gold-standard variant call sets for human genomes.</p>
    <p id="Par28">Longshot offers the ability to assemble haplotypes without prior knowledge of SNVs and leverage the haplotypes to separate SMS reads by haplotype. This opens up a wide range of possibilities for SMS read analysis, given that many SMS analysis tools work much better on haploid samples. For example, the haplotype-separated reads could be used to call SVs with greater sensitivity using a tool such as SMRT-SV<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. A similar approach was recently used to profile structural variation genome-wide after extensive haplotype assembly with multiple sequencing technologies and computational separation of the SMS reads by haplotype<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Currently, Longshot uses the read pileups to identify candidate SNVs and the vast majority (∼72%) of false-positive SNVs identified with Longshot correspond to misclassified indel variants. Using a genomic consensus of haplotype-separated reads should improve the accuracy of variant calling using Longshot.</p>
    <p id="Par29">LongShot was also able to call SNVs with high accuracy from Oxford Nanopore long-read data without any modification to the likelihood model. Although the precision and recall was lower than PacBio reads at a similar coverage, this is expected due to the higher error rate of Nanopore reads. Continued improvements in the sequencing technology and the raw basecalling, and the use of context-specific error models for local realignment are expected to further improve the accuracy of variant calling using Nanopore reads.</p>
    <p id="Par30">In this study, we focused on the detection and phasing of SNVs alone, as accurate calling of short indels using SMS reads is challenging due to the high insertion/deletion error rate. A recently developed deep-learning-based variant caller<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> had low precision (0.589) and recall (0.12) for short indel calling on PacBio WGS data. In comparison with CLR reads, PacBio circular consensus sequencing (CCS) produces reads with greater accuracy by sequencing multiple times around the same DNA template. Recent improvements have enabled the generation of highly accurate long reads (10–15 kb read lengths and error rates <inline-formula id="IEq108"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1 \text{\%}$$\end{document}</tex-math><mml:math id="M212"><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq108.gif"/></alternatives></inline-formula>) using CCS<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. We expect that using Longshot with these low-error reads will improve the accuracy of SNV calling and also enable accurate short indel calling. As the cost of SMS technologies continues to decrease, these technologies are likely to see widespread use in human disease studies in the near future. In particular, whole-genome SMS can enable the detection of disease-associated SVs and variants in repetitive regions of the genome that cannot be identified using standard Illumina WGS<sup><xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR43">43</xref></sup>. Tools such as LongShot will be valuable for realizing the potential of SMS technologies for the comprehensive detection of all forms of genetic variation in such studies.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Identification of candidate SNVs</title>
      <p id="Par31">The first step in the Longshot algorithm is to identify positions in the genome that may contain an SNV. Potential SNVs are identified from the pileup of aligned reads by performing a genotype likelihood calculation similar to Samtools or other NGS variant calling methods<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> (see Supplementary Methods). The prior probabilities for genotypes are defined using a slight modification of the approach of Li et al.<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> (see Supplementary Methods). SNV sites for which the posterior probability of a non-reference genotype is &gt;<inline-formula id="IEq109"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.01$$\end{document}</tex-math><mml:math id="M214"><mml:mn>0.01</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq109.gif"/></alternatives></inline-formula> are considered as candidate SNVs for the next step of the algorithm. The sites are also filtered for mininum read coverage (6 by default), minimum alternate allele count and fraction (3 and 0.125 by default).</p>
    </sec>
    <sec id="Sec12">
      <title>Local realignment using pair-HMMs</title>
      <p id="Par32">For an SMS read that overlaps a candidate biallelic SNV site with two alleles “ref” and “alt,” we want to determine which allele is the most likely observation (allele call) and also assign a probability of error to this observation (quality value). To accomplish this, we perform local realignment of a short sequence from the read to the reference and to the alternate sequence (with the SNV allele added, see Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). This local realignment is performed using a pair-HMM<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. The parameters for the HMM are estimated directly from the aligned reads prior to realignment (see Supplementary Methods).</p>
      <p id="Par33">It is sufficient to perform the local realignment within a short window covering the SNV site. This window is defined using the nearest non-repetitive anchor sequences of length <inline-formula id="IEq110"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M216"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq110.gif"/></alternatives></inline-formula> (default <inline-formula id="IEq111"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=6$$\end{document}</tex-math><mml:math id="M218"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq111.gif"/></alternatives></inline-formula>), to the left and right of the SNV where the read sequence matches the reference sequence perfectly (see Supplementary Methods). Once the window <inline-formula id="IEq112"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}</tex-math><mml:math id="M220"><mml:mi>W</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq112.gif"/></alternatives></inline-formula> is identified, we use the forward algorithm to calculate <inline-formula id="IEq113"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{{\rm{ref}}}=P({\rm{read}}({\rm{W}})\ | \ {\rm{ref}}({\rm{W}}))$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">read</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mo>∣</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">ref</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq113.gif"/></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{\text{alt}}=P({\rm{read}}({\rm{W}})\ | \ {\rm{alt}}({\rm{W}}))$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">read</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mo>∣</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="normal">alt</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq114.gif"/></alternatives></inline-formula> where <inline-formula id="IEq115"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{read}}({\rm{W}})$$\end{document}</tex-math><mml:math id="M226"><mml:mi mathvariant="normal">read</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq115.gif"/></alternatives></inline-formula> is the sequence of the read in the window <inline-formula id="IEq116"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W$$\end{document}</tex-math><mml:math id="M228"><mml:mi>W</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq116.gif"/></alternatives></inline-formula> defined by the two anchors. We select the allele <inline-formula id="IEq117"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${a}_{max}\in \{{\rm{ref}},{\rm{alt}}\}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq117.gif"/></alternatives></inline-formula> for which the probability is higher, as the observed allele, and use <inline-formula id="IEq118"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{phred}}\left(1-\frac{{p}_{{a}_{max}}}{{p}_{{\rm{ref}}}+{p}_{{\rm{alt}}}}\right)$$\end{document}</tex-math><mml:math id="M232"><mml:mi mathvariant="normal">phred</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq118.gif"/></alternatives></inline-formula> as the allele quality score.</p>
      <p id="Par34">When multiple candidate SNVs are located in close proximity, we define the window to include all such SNVs and use a generalization of the calculation described above to determine alleles and estimate base-quality values (see Supplementary Methods). For computational efficiency, a banded version of the forward algorithm is used. This reduces the complexity to <inline-formula id="IEq119"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(mb)$$\end{document}</tex-math><mml:math id="M234"><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq119.gif"/></alternatives></inline-formula> where <inline-formula id="IEq120"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b$$\end{document}</tex-math><mml:math id="M236"><mml:mi>b</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq120.gif"/></alternatives></inline-formula> is the width of the band and <inline-formula id="IEq121"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M238"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq121.gif"/></alternatives></inline-formula> is the length of the window (50–200 bp). Allele observations with phred-scaled quality score below a threshold (<inline-formula id="IEq122"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$7.0$$\end{document}</tex-math><mml:math id="M240"><mml:mn>7.0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq122.gif"/></alternatives></inline-formula> by default) are discarded. This reduces the effective read depth for SMS reads (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>).</p>
      <p id="Par35">In order to remove false variants resulting from strand-specific sequencing errors, we filter potential SNVs whose allele observations are over-represented in reads from one strand. For each potential SNV, we build a contingency table of the counts of the reference and alternate allele on reads from the forward strand and reverse strand, respectively. Variants for which the Fisher’s exact test <italic>p</italic>-value (two-tailed) is &lt;<inline-formula id="IEq123"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.01$$\end{document}</tex-math><mml:math id="M242"><mml:mn>0.01</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq123.gif"/></alternatives></inline-formula> are not considered for haplotype-informed genotyping.</p>
    </sec>
    <sec id="Sec13">
      <title>Haplotype-informed genotyping</title>
      <p id="Par36">Longshot achieves accurate variant calling using SMS reads by performing phased genotyping for all candidate SNVs jointly. Given a set of candidate SNVs <inline-formula id="IEq124"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><mml:math id="M244"><mml:mi>V</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq124.gif"/></alternatives></inline-formula> and the allele calls (and quality values) for each read <inline-formula id="IEq125"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\in R$$\end{document}</tex-math><mml:math id="M246"><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq125.gif"/></alternatives></inline-formula>, we aim to maximize the likelihood <inline-formula id="IEq126"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(R| H)$$\end{document}</tex-math><mml:math id="M248"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq126.gif"/></alternatives></inline-formula> where <inline-formula id="IEq127"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H$$\end{document}</tex-math><mml:math id="M250"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq127.gif"/></alternatives></inline-formula> is a pair of haplotypes (<inline-formula id="IEq128"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{1},{H}_{2}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq128.gif"/></alternatives></inline-formula>) over the variant set <inline-formula id="IEq129"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><mml:math id="M254"><mml:mi>V</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq129.gif"/></alternatives></inline-formula>. Longshot optimizes the likelihood function using an iterative approach that uses (i) the HapCUT2 algorithm<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> to estimate the most likely pair of haplotypes for variants with heterozygous genotypes and (ii) local updates to estimate the most likely phased genotype for each variant given the current haplotype pair (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c).</p>
      <p id="Par37">Assuming independence between reads, the likelihood function <inline-formula id="IEq130"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(R| H)$$\end{document}</tex-math><mml:math id="M256"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq130.gif"/></alternatives></inline-formula> can we written as<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>:<disp-formula id="Equa"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(R| H)=\prod _{r}p(r| H)=\prod _{r}\frac{p(r| {H}_{1})+p(r| {H}_{2})}{2}$$\end{document}</tex-math><mml:math id="M258"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big"> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big"> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2019_12493_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq131"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(r| {H}_{1})$$\end{document}</tex-math><mml:math id="M260"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq131.gif"/></alternatives></inline-formula> for any read <inline-formula id="IEq132"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M262"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq132.gif"/></alternatives></inline-formula> can be calculated using the pair-HMM probabilities for each (read, variant) pair. Let <inline-formula id="IEq133"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M264"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq133.gif"/></alternatives></inline-formula> be the set of possible phased genotypes for a biallelic variant: <inline-formula id="IEq134"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{0| 0,0| 1,1| 0,1| 1\}$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>∣</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>∣</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq134.gif"/></alternatives></inline-formula> (homozygous reference, the two heterozygous states, and homozygous alternate). Let <inline-formula id="IEq135"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H$$\end{document}</tex-math><mml:math id="M268"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq135.gif"/></alternatives></inline-formula> refer to the current estimate of the most likely haplotype pair and <inline-formula id="IEq136"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}^{i,g}$$\end{document}</tex-math><mml:math id="M270"><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq136.gif"/></alternatives></inline-formula> refer to the haplotype pair <inline-formula id="IEq137"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H$$\end{document}</tex-math><mml:math id="M272"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq137.gif"/></alternatives></inline-formula> with the <inline-formula id="IEq138"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M274"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq138.gif"/></alternatives></inline-formula>th SNV altered to have the phased genotype <inline-formula id="IEq139"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M276"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq139.gif"/></alternatives></inline-formula>. Given <inline-formula id="IEq140"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H$$\end{document}</tex-math><mml:math id="M278"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq140.gif"/></alternatives></inline-formula>, we can calculate the posterior probability for the phased genotype <inline-formula id="IEq141"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M280"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq141.gif"/></alternatives></inline-formula> as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(H[i]=g| R,H)=\frac{p(g)p(R| {H}^{i,g})}{{\sum }_{g{\prime} \in G}p(g{\prime} )p(R| {H}^{i,g{\prime} })}$$\end{document}</tex-math><mml:math id="M282"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2019_12493_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>The optimization starts with the initial set of variants identified from the pileup-based likelihood calculation and the unphased genotypes for each variant estimated using the local realignment. The iterative phase of the Longshot algorithm consists of the following steps:</p>
      <p id="Par38">For <inline-formula id="IEq142"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1\ldots k$$\end{document}</tex-math><mml:math id="M284"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq142.gif"/></alternatives></inline-formula><list list-type="order"><list-item><p id="Par39"><inline-formula id="IEq143"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L=p(R| H)$$\end{document}</tex-math><mml:math id="M286"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq143.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par40">Let <inline-formula id="IEq144"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V{\prime}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq144.gif"/></alternatives></inline-formula> be the set of heterozygous SNVs in <inline-formula id="IEq145"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V$$\end{document}</tex-math><mml:math id="M290"><mml:mi>V</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq145.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par41"><inline-formula id="IEq146"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H(V{\prime} )=$$\end{document}</tex-math><mml:math id="M292"><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq146.gif"/></alternatives></inline-formula> HapCUT2<inline-formula id="IEq147"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(R,V^{\prime} )$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq147.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par42">Repeat: <list list-type="alpha-lower"><list-item><p id="Par43">For each variant <inline-formula id="IEq148"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v\in V$$\end{document}</tex-math><mml:math id="M296"><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq148.gif"/></alternatives></inline-formula>: update <inline-formula id="IEq149"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H[v]$$\end{document}</tex-math><mml:math id="M298"><mml:mi>H</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq149.gif"/></alternatives></inline-formula> using Eq. (<xref rid="Equ1" ref-type="">1</xref>)</p></list-item><list-item><p id="Par44">If no genotype was updated in (a), BREAK</p></list-item></list></p></list-item><list-item><p id="Par45"><inline-formula id="IEq150"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L{\prime} =p(R| H)$$\end{document}</tex-math><mml:math id="M300"><mml:mi>L</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>∣</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq150.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par46">If <inline-formula id="IEq151"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\rm{log}}(L{\prime} )-{\rm{log}}(L)}{{\rm{log}}(L)}\,&lt;\,\Delta$$\end{document}</tex-math><mml:math id="M302"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Δ</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq151.gif"/></alternatives></inline-formula>: BREAK</p></list-item></list></p>
      <p id="Par47">In Step 3, HapCUT2 is used to phase the current set of heterozygous variants. Then, the haplotype scaffold is used to refine the genotypes of each variant in Step 4. This serves to remove false heterozygous variants and identify new heterozygous variants that can be phased by HapCUT2 in the next iteration. Steps 1–5 are repeated until the relative log-likelihood of the data between consecutive iterations is smaller than <inline-formula id="IEq152"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta$$\end{document}</tex-math><mml:math id="M304"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq152.gif"/></alternatives></inline-formula> (default <inline-formula id="IEq153"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$=1\times 1{0}^{-5}$$\end{document}</tex-math><mml:math id="M306"><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq153.gif"/></alternatives></inline-formula>).</p>
    </sec>
    <sec id="Sec14">
      <title>Variant filtering</title>
      <p id="Par48">The raw variant calls were subjected to three types of filters to reduce false positives. SNVs were first filtered according to the GQ estimated by the variant caller. The GQ cutoff was fixed at 50 for short reads. For Longshot, we used a variable GQ cutoff (matched to the median read coverage) for filtering variants. This was done to reduce the number of false SNVs due to true indel variants that have high GQ. For simulations, which do not have indel variants, we used a fixed GQ cutoff of 50.</p>
      <p id="Par49">To filter false SNVs due to copy number amplifications, a maximum read depth filter similar to what has been used previously for short-read-based variant calling was used<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. Variants with read depth &gt;<inline-formula id="IEq154"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d+5\sqrt{d}$$\end{document}</tex-math><mml:math id="M308"><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msqrt><mml:mi>d</mml:mi></mml:msqrt></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq154.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq155"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M310"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq155.gif"/></alternatives></inline-formula> is the median read depth across the entire dataset were filtered out. We also observed that for SMS reads, many false-positive SNVs occur nearby each other in dense clusters. These dense clusters may result from systematically mismapped reads due to missing sequence in the reference genome or are indicative of structural variations such as copy number variants (CNVs). We used a simple density filter (&gt;10 SNVs in a window of <inline-formula id="IEq156"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$500$$\end{document}</tex-math><mml:math id="M312"><mml:mn>500</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq156.gif"/></alternatives></inline-formula> bp) to filter out such false variants for variants called with Longshot. For the AJ trio, variants in the Delly exclusion regions (available from <ext-link ext-link-type="uri" xlink:href="https://github.com/tobiasrausch/delly/blob/master/excludeTemplates/human.hg38.excl.tsv">https://github.com/tobiasrausch/delly/blob/master/excludeTemplates/human.hg38.excl.tsv</ext-link>) were also filtered out for the analysis of Mendelian consistency.</p>
    </sec>
    <sec id="Sec15">
      <title>Simulations</title>
      <p id="Par50">We simulated a diploid genome using the reference human genome sequence with heterozygous SNVs (rate = <inline-formula id="IEq157"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.001$$\end{document}</tex-math><mml:math id="M314"><mml:mn>0.001</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq157.gif"/></alternatives></inline-formula>) and homozygous SNVs (rate = <inline-formula id="IEq158"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.0005$$\end{document}</tex-math><mml:math id="M316"><mml:mn>0.0005</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq158.gif"/></alternatives></inline-formula>) (see Supplementary Methods for details). Paired-end 100 bp reads were generated from the simulated genome with a substitution error rate of <inline-formula id="IEq159"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.001$$\end{document}</tex-math><mml:math id="M318"><mml:mn>0.001</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq159.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. The short reads were aligned to the human reference (hs37d5) using BWA-MEM and variants were called using FreeBayes<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Similarly, we used SimLoRD<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> to generate PacBio SMS reads (median length = 7.5 kb) from the simulated genome using the default error rates of <inline-formula id="IEq160"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.11$$\end{document}</tex-math><mml:math id="M320"><mml:mn>0.11</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq160.gif"/></alternatives></inline-formula> for insertion, <inline-formula id="IEq161"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.04$$\end{document}</tex-math><mml:math id="M322"><mml:mn>0.04</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq161.gif"/></alternatives></inline-formula> for deletion, and <inline-formula id="IEq162"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.01$$\end{document}</tex-math><mml:math id="M324"><mml:mn>0.01</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq162.gif"/></alternatives></inline-formula> for substitution<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. The -mp 1 option was used to force each read to only have a single sequencing pass, so that the error profile of the reads resembles PacBio CLRs (lower accuracy) as opposed to circular consensus reads (greater accuracy). We aligned the SMS reads to the human reference (hs37d5) using the long-read alignment tools BLASR (v5.3.2, options –nproc 16 –bestn 1 –bam), MiniMap2 (v2.11-r797, options -t 16 -ax map-pb), BWA-MEM (v0.7.17, options -x pacbio -t 16 -T 0), and NGMLR (v0.2.7, options -t 16 -x pacbio).</p>
    </sec>
    <sec id="Sec16">
      <title>Whole-genome sequencing data</title>
      <p id="Par51">The <inline-formula id="IEq163"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$45\times$$\end{document}</tex-math><mml:math id="M326"><mml:mn>45</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq163.gif"/></alternatives></inline-formula> coverage PacBio SMRT reads for NA12878, aligned to the hs37d5 reference genome using BLASR, were obtained from the GIAB consortium<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. PacBio read data for the AJ trio was also obtained from the GIAB ftp site and aligned to the hg38 reference genome using BLASR<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, using the same parameters used for aligning the simulated reads. Oxford Nanopore reads for NA12878 were obtained from the Nanopore WGS Consortium<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> and aligned to hg38 using minimap2. Illumina WGS data for NA12878 and the AJ Trio (NA24385, NA24143, and NA24149), sequenced on the HiSeq 2500 (<inline-formula id="IEq164"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$30\times$$\end{document}</tex-math><mml:math id="M328"><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq164.gif"/></alternatives></inline-formula> and <inline-formula id="IEq165"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\times$$\end{document}</tex-math><mml:math id="M330"><mml:mn>60</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq165.gif"/></alternatives></inline-formula> coverage, respectively, 148 bp paired-end reads), was obtained from the GIAB. The <inline-formula id="IEq166"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\times$$\end{document}</tex-math><mml:math id="M332"><mml:mn>60</mml:mn><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq166.gif"/></alternatives></inline-formula> coverage datasets were downsampled to half coverage. The reads were downloaded in BAM format aligned to as hs37d5 using bwa-mem (NA12878) and hg38 using NovoAlign (AJ trio). Variant calling on Illumina WGS data was performed using FreeBayes<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> (v1.0.2-33-gdbb6160) with –standard-filters and –genotype-qualities turned on). BED files for segmental duplications and repeat elements in the human genome were obtained from the UCSC table browser<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>.</p>
    </sec>
    <sec id="Sec17">
      <title>Assessment of variant calling and phasing accuracy</title>
      <p id="Par52">High-confidence variant call sets generated by the GIAB project were used for assessing accuracy of SNV calling<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. For NA12878, SNVs were compared against the GrCh37 (for Illumina and PacBio) or GrCh38 (for Oxford Nanopore) version of the GIAB high-confidence call set (release v3.3.2). For the AJ trio, SNVs were compared against the GrCh38 version of the GIAB high-confidence call set (release v3.3.2). For comparing the accuracy of Longshot with Clairvoyante and WhatsHap, the GrCh37 version of the calls were used (release v3.3.2). For each individual, the comparison of SNV calls was limited to high-confidence regions (provided in a bed file). Precision and Recall were calculated using RTGtools (v3.9.1) vcfeval.</p>
      <p id="Par53">For NA12878, we compared the accuracy of the Longshot haplotypes using the Platinum Genomes haplotypes for the same individual as ground truth. For NA24385, we generated high-quality haplotypes from a consensus of the GIAB trio-based phased genotypes and 10× Genomics phased variant calls and used the resulting haplotypes for assessment of haplotyping accuracy. The haplotypes were compared at all unfiltered SNVs that were called heterozygous in both the assembled haplotypes and the ground truth. The errors were tabulated in terms of the total combined rate of switch and mismatch errors, also known as long-switch and short-switch errors, respectively<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup>. The N50 metric—defined as the length <inline-formula id="IEq167"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M334"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq167.gif"/></alternatives></inline-formula> in base pairs such that half of the phased portion of the genome is in haplotype blocks of length <inline-formula id="IEq168"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M336"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq168.gif"/></alternatives></inline-formula> or greater—was used to measure the completeness of haplotype blocks.</p>
      <p id="Par54">For the AJ trio, Mendelian consistency of the SNV calls was assessed using RTGtools<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. For this, SAMtools<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> and BEDtools<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> were used to obtain a set of regions that have high coverage (&gt;20×) of well-mapped SMS reads (<italic>MAPQ</italic> &gt; 30 and filter -F 3844 applied) in all three individuals. These regions were further intersected with a bed file for the region being investigated (either GIAB confident regions, outside GIAB confident regions, or <inline-formula id="IEq169"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$95 \text{\%}$$\end{document}</tex-math><mml:math id="M338"><mml:mn>95</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12493_Article_IEq169.gif"/></alternatives></inline-formula> similar segmental duplications). The individual VCF (variant call format) files for the trio were merged into a single VCF and filtered so that all records have a GQ &gt; 50.</p>
    </sec>
    <sec id="Sec18">
      <title>Server configuration</title>
      <p id="Par55">All experiments in this study were performed on CentOS 6.6 with Intel Xeon CPU E5-2670 0 @ 2.60 GHz, with jobs managed by a Torque/PBS system.</p>
    </sec>
    <sec id="Sec19">
      <title>Reporting summary</title>
      <p id="Par56">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2019_12493_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2019_12493_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2019_12493_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2019_12493_MOESM4_ESM.txt">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold>  <italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-12493-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The research was supported by the National Human Genome Research Institute of the National Institute of Health (award number R01HG010149).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>P.E. designed and implemented the algorithm, performed the analyses, and wrote the manuscript. V.B. conceived the project, designed the algorithm, performed analyses, and wrote the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The PacBio and Illumina sequence datasets and variant calls used in this study are publicly available from the GIAB ftp site: <ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/</ext-link>. The sub-folders for each individual are as follows:</p>
    <p><bold>NA12878:</bold> data/NA12878/NA12878_PacBio_MtSinai, release/NA12878_HG001/NISTv3.3.2/GRCh37/, data/NA12878/NIST_NA12878_HG001_HiSeq_300x</p>
    <p><bold>NA24385:</bold> data/AshkenazimTrio/HG002_NA24385_son/PacBio_MtSinai_NIST, release/AshkenazimTrio/HG002_NA24385_son/NISTv3.3.2/GRCh38, data/AshkenazimTrio/HG002_NA24385_son/NIST_HiSeq_HG002_Homogeneity-10953946</p>
    <p><bold>NA24149:</bold> data/AshkenazimTrio/HG003_NA24149_father/PacBio_MtSinai_NIST/, release/AshkenazimTrio/HG003_NA24149_father/NISTv3.3.2/GRCh38, data/AshkenazimTrio/HG003_NA24149_father/NIST_HiSeq_HG003_Homogeneity-12389378</p>
    <p><bold>NA24143:</bold> /data/AshkenazimTrio/HG003_NA24143_mother/PacBio_MtSinai_NIST, release/AshkenazimTrio/HG004_NA24143_mother/NISTv3.3.2/GRCh38, data/AshkenazimTrio/HG004_NA24143_mother/NIST_HiSeq_HG004_Homogeneity-14572558</p>
    <p>For the direct comparison between methods, BAMs aligned using NGMLR from the Clairvoyante study were used<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The BAMs were obtained from <ext-link ext-link-type="uri" xlink:href="http://www.bio8.cs.hku.hk/clairvoyante/bamUsed/">http://www.bio8.cs.hku.hk/clairvoyante/bamUsed/</ext-link>.</p>
    <p>The Oxford Nanopore sequence dataset is publicly available from the Nanopore WGS Consortium: <ext-link ext-link-type="uri" xlink:href="https://github.com/nanopore-wgs-consortium/NA12878/blob/master/Genome.md">https://github.com/nanopore-wgs-consortium/NA12878/blob/master/Genome.md</ext-link>. The NA12878 genome was sequenced using the Oxford Nanopore MinION with version R9.4 of the chemistry on 39 flowcells. We used the rel6 version of the base calls (called using ONT Guppy basecalling software version 2.3.8 + 498297c). All other relevant data are available upon request. The source data underlying Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref> is provided as a Source Data file.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Longshot is implemented in the Rust programming language, uses the rust-bio and rust-htslib libraries<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>, and the HapCUT2 C code<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. It is freely available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/pjedge/longshot">https://github.com/pjedge/longshot</ext-link>. It is also available on Bioconda<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. A Snakemake workflow<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> for automatically generating all of the results of the paper is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pjedge/longshot_study">https://github.com/pjedge/longshot_study</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par57">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodwin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>McCombie</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Coming of age: ten years of next-generation sequencing technologies</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>333</fpage>
        <lpage>351</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.49</pub-id>
        <pub-id pub-id-type="pmid">27184599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sims</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sudbery</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ilott</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <article-title>Sequencing depth and coverage: key considerations in genomic analyses</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>121</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg3642</pub-id>
        <pub-id pub-id-type="pmid">24434847</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Albrechtsen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>YS</given-names>
          </name>
        </person-group>
        <article-title>Genotype and SNP calling from next-generation sequencing data</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>443</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2986</pub-id>
        <pub-id pub-id-type="pmid">21587300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>HapCUT: an efficient and accurate algorithm for the haplotype assembly problem</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>i153</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn298</pub-id>
        <pub-id pub-id-type="pmid">18689818</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levy</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The diploid genome sequence of an individual human</article-title>
        <source>PLoS Biol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e254</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0050254</pub-id>
        <pub-id pub-id-type="pmid">17803354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duitama</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fosmid-based whole genome haplotyping of a HapMap trio child: evaluation of Single Individual Haplotyping techniques</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>2041</fpage>
        <lpage>2053</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1042</pub-id>
        <pub-id pub-id-type="pmid">22102577</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bryc</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A novel approach to estimating heterozygosity from low-coverage genome sequence</article-title>
        <source>Genetics</source>
        <year>2013</year>
        <volume>195</volume>
        <fpage>553</fpage>
        <lpage>561</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.113.154500</pub-id>
        <pub-id pub-id-type="pmid">23934885</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mandelker</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Navigating highly homologous genes in a molecular diagnostic setting: a resource for clinical next-generation sequencing</article-title>
        <source>Genet. Med.</source>
        <year>2016</year>
        <volume>18</volume>
        <fpage>1282</fpage>
        <lpage>1289</lpage>
        <pub-id pub-id-type="doi">10.1038/gim.2016.58</pub-id>
        <pub-id pub-id-type="pmid">27228465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ardui</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ameur</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vermeesch</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hestand</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Single molecule real-time (SMRT) sequencing comes of age: applications and utilities for medical diagnostics</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>2159</fpage>
        <lpage>2168</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky066</pub-id>
        <pub-id pub-id-type="pmid">29401301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pendleton</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly and diploid architecture of an individual human genome via single-molecule technologies</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>780</fpage>
        <lpage>786</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3454</pub-id>
        <pub-id pub-id-type="pmid">26121404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving the complexity of the human genome using single-molecule sequencing</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>517</volume>
        <fpage>608</fpage>
        <lpage>611</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13907</pub-id>
        <pub-id pub-id-type="pmid">25383537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kannan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Resolving multicopy duplications de novo using polyploid phasing</article-title>
        <source>Res. Comput. Mol. Biol.</source>
        <year>2017</year>
        <volume>10229</volume>
        <fpage>117</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-56970-3_8</pub-id>
        <pub-id pub-id-type="pmid">28808695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edge</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Hapcut2: robust and accurate haplotype assembly for diverse sequencing technologies</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>801</fpage>
        <lpage>812</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.213462.116</pub-id>
        <pub-id pub-id-type="pmid">27940952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>246</fpage>
        <lpage>251</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2835</pub-id>
        <pub-id pub-id-type="pmid">24531798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Zook, J. et al. Reproducible integration of multiple sequencing datasets to form high-confidence snp, indel, and reference calls for five human genome reference materials. Preprint at 10.1101/281006 (2018).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A synthetic-diploid benchmark for accurate variant-calling evaluation</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>595</fpage>
        <lpage>597</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0054-7</pub-id>
        <pub-id pub-id-type="pmid">30013044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borras</surname>
            <given-names>DM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detecting PKD1 variants in polycystic kidney disease patients by single-molecule long-read sequencing</article-title>
        <source>Hum. Mutat.</source>
        <year>2017</year>
        <volume>38</volume>
        <fpage>870</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="doi">10.1002/humu.23223</pub-id>
        <pub-id pub-id-type="pmid">28378423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huddleston</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery and genotyping of structural variation from long-read haploid genome sequence data</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>677</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214007.116</pub-id>
        <pub-id pub-id-type="pmid">27895111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sudmant</surname>
            <given-names>PH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated map of structural variation in 2,504 human genomes</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>526</volume>
        <fpage>75</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1038/nature15394</pub-id>
        <pub-id pub-id-type="pmid">26432246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1784</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08148-z</pub-id>
        <pub-id pub-id-type="pmid">30992455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Garrison, E. &amp; Marth, G. Haplotype-based variant detection from short-read sequencing. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1207.3907">https://arxiv.org/abs/1207.3907</ext-link> (2012).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Progressive approach for snp calling and haplotype assembly using single molecular sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2012</fpage>
        <lpage>2018</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty059</pub-id>
        <pub-id pub-id-type="pmid">29474523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haukness</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pesout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Marschall</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-aware diplotyping from noisy long reads</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>116</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1709-0</pub-id>
        <pub-id pub-id-type="pmid">31159868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4060</pub-id>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and samtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved data analysis for the MinION nanopore sequencer</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>351</fpage>
        <lpage>356</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3290</pub-id>
        <pub-id pub-id-type="pmid">25686389</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Durbin, R., Eddy, S. R., Krogh, A. &amp; Mitchison, G. Biological sequence analysis: probabilistic models of proteins and nucleic acids (Cambridge Univ. Press, 1998).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Li, H. Aligning sequence reads, clone sequences and assembly contigs with bwa-mem. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1303.3997">https://arxiv.org/abs/1303.3997</ext-link> (2013).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mapping single molecule sequencing reads using basic local alignment with successive refinement (blasr): application and theory</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-238</pub-id>
        <pub-id pub-id-type="pmid">22988817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate detection of complex structural variations using single-molecule sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>461</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0001-7</pub-id>
        <pub-id pub-id-type="pmid">29713083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>A multi-task convolutional deep neural network for variant calling in single molecule sequencing</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>998</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09025-z</pub-id>
        <pub-id pub-id-type="pmid">30824707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lärkeryd</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sjödin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Forsman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stenberg</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Scaffolding of a bacterial genome using minion nanopore sequencing</article-title>
        <source>Sci. Rep.</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>11996</fpage>
        <pub-id pub-id-type="doi">10.1038/srep11996</pub-id>
        <pub-id pub-id-type="pmid">26149338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>A complete bacterial genome assembled de novo using only nanopore sequencing data</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>733</fpage>
        <lpage>735</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3444</pub-id>
        <pub-id pub-id-type="pmid">26076426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation dna sequencing data</article-title>
        <source>Nat. Genet.</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eberle</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference data set of 5.4 million phased human variants validated by genetic inheritance from sequencing a three-generation 17-member pedigree</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>157</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210500.116</pub-id>
        <pub-id pub-id-type="pmid">27903644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rakocevic</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast and accurate genomic analyses using genome graphs</article-title>
        <source>Nat. Genet.</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>354</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0316-4</pub-id>
        <pub-id pub-id-type="pmid">30643257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Wenger, A. M., et al. Accurate circular consensus long-read sequencing improves variant detection and assembly of a human genome. <italic>Nat. Biotechnol</italic>. (2019).</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merker</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Long-read genome sequencing identifies causal structural variation in a Mendelian disease</article-title>
        <source>Genet. Med.</source>
        <year>2018</year>
        <volume>20</volume>
        <fpage>159</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="doi">10.1038/gim.2017.86</pub-id>
        <pub-id pub-id-type="pmid">28640241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mizuguchi</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 12-kb structural variation in progressive myoclonic epilepsy was newly identified by long-read whole-genome sequencing</article-title>
        <source>J. Hum. Genet.</source>
        <year>2019</year>
        <volume>64</volume>
        <fpage>359</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="doi">10.1038/s10038-019-0569-5</pub-id>
        <pub-id pub-id-type="pmid">30760880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ishiura</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expansions of intronic TTTCA and TTTTA repeats in benign adult familial myoclonic epilepsy</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>581</fpage>
        <lpage>590</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0067-2</pub-id>
        <pub-id pub-id-type="pmid">29507423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SNP detection for massively parallel whole-genome resequencing</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1124</fpage>
        <lpage>1132</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.088013.108</pub-id>
        <pub-id pub-id-type="pmid">19420381</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Toward better understanding of artifacts in variant calling from high-coverage samples</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2843</fpage>
        <lpage>2851</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu356</pub-id>
        <pub-id pub-id-type="pmid">24974202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Homer, N. Dwgsim: whole genome simulator for next-generation sequencing. <ext-link ext-link-type="uri" xlink:href="https://github.com/nh13/DWGSIM">https://github.com/nh13/DWGSIM</ext-link> (2010).</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stöcker</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Simlord: simulation of long read data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2704</fpage>
        <lpage>2706</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw286</pub-id>
        <pub-id pub-id-type="pmid">27166244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extensive sequencing of seven human genomes to characterize benchmark reference materials</article-title>
        <source>Sci. Data</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>160025</fpage>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.25</pub-id>
        <pub-id pub-id-type="pmid">27271295</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>The UCSC genome browser and associated tools</article-title>
        <source>Brief. Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>144</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs038</pub-id>
        <pub-id pub-id-type="pmid">22908213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuleshov</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic single-individual haplotyping</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>i379</fpage>
        <lpage>385</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu484</pub-id>
        <pub-id pub-id-type="pmid">25161223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleary</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Joint variant and de novo mutation identification on pedigrees from high-throughput sequencing data</article-title>
        <source>J. Comput. Biol.</source>
        <year>2014</year>
        <volume>21</volume>
        <fpage>405</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2014.0029</pub-id>
        <pub-id pub-id-type="pmid">24874280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>Bedtools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Rust-bio: a fast and safe bioinformatics library</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>32</volume>
        <fpage>444</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv573</pub-id>
        <pub-id pub-id-type="pmid">26446134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>475</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0046-7</pub-id>
        <pub-id pub-id-type="pmid">29967506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake–a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2520</fpage>
        <lpage>2522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
        <pub-id pub-id-type="pmid">22908215</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
