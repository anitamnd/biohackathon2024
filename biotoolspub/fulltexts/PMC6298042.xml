<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6298042</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty645</article-id>
    <article-id pub-id-type="publisher-id">bty645</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cryfa: a secure encryption tool for genomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hosseini</surname>
          <given-names>Morteza</given-names>
        </name>
        <xref ref-type="corresp" rid="bty645-cor1"/>
        <!--<email>seyedmorteza@ua.pt</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pratas</surname>
          <given-names>Diogo</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pinho</surname>
          <given-names>Armando J</given-names>
        </name>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
        <xref ref-type="aff" rid="bty645-aff1"/>
      </contrib>
    </contrib-group>
    <aff id="bty645-aff1">IEETA, Department of Electronics, Telecommunications and Informatics, University of Aveiro, Aveiro, Portugal</aff>
    <author-notes>
      <corresp id="bty645-cor1">To whom correspondence should be addressed. <email>seyedmorteza@ua.pt</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-07-18">
      <day>18</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>1</issue>
    <fpage>146</fpage>
    <lpage>148</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>7</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty645.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The ever-increasing growth of high-throughput sequencing technologies has led to a great acceleration of medical and biological research and discovery. As these platforms advance, the amount of information for diverse genomes increases at unprecedented rates. Confidentiality, integrity and authenticity of such genomic information should be ensured due to its extremely sensitive nature. In this paper, we propose Cryfa, a fast secure encryption tool for genomic data, namely in Fasta, Fastq, VCF, SAM and BAM formats, which is also capable of reducing the storage size of Fasta and Fastq files. Cryfa uses advanced encryption standard (AES) encryption combined with a shuffling mechanism, which leads to a substantial enhancement of the security against low data complexity attacks. Compared to AES Crypt, a general-purpose encryption tool, Cryfa is an industry-oriented tool, which is able to provide confidentiality, integrity and authenticity of data at four times more speed; in addition, it can reduce the file sizes to 1/3. Due to the absence of a method similar to Cryfa, we have simulated its behavior with a combination of encryption and compression tools, for comparison purpose. For instance, our tool is nine times faster than its fastest competitor in Fasta files. Also, Cryfa has a very low memory usage (only a few megabytes), which makes it feasible to run on any computer.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Source codes and binaries are available, under GPLv3, at <ext-link ext-link-type="uri" xlink:href="https://github.com/pratas/cryfa">https://github.com/pratas/cryfa</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Fund for Regional Development</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Operational Program Competitiveness Factors</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Portuguese Foundation for Science and Technology</named-content>
        </funding-source>
        <award-id>UID/CEC/00127/2013</award-id>
        <award-id>PTCD/EEI-SII/6608/2014</award-id>
        <award-id>PD/BD/113969/2015</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The rapid advancement in high-throughput sequencing technologies has triggered a revolution in personalized medicine, biotechnology and ancient DNA studies (<xref rid="bty645-B9" ref-type="bibr">Kumar-Sinha and Chinnaiyan, 2018</xref>; <xref rid="bty645-B11" ref-type="bibr">Porter and Hajibabaei, 2018</xref>). However, it raises critical issues regarding preserving security of the genomic data, which is highly sensitive due to its nature.</p>
    <p>Authenticated encryption has the potential to address the issues of genomic data security, by allowing only authorized parties to access such data. This cryptographic scheme is able to appropriately ensure the key criteria of integrity, confidentiality and authenticity of the genomic data, under a single and easy-to-use programing interface (<xref rid="bty645-B2" ref-type="bibr">Bradley <italic>et al.</italic>, 2017</xref>; <xref rid="bty645-B8" ref-type="bibr">Jagadeesh <italic>et al.</italic>, 2017</xref>). Secure encryption of genomic data is of great significance not only for macro-organisms, e.g. humans, but also for microbial species, such as outbreak microorganisms, e.g. Ebola and Zika viruses (<xref rid="bty645-B7" ref-type="bibr">Graham and Sullivan, 2018</xref>), ancient viruses (<xref rid="bty645-B6" ref-type="bibr">Duggan et al., 2016</xref>), exobiology sources (<xref rid="bty645-B10" ref-type="bibr">Martins <italic>et al.</italic>, 2008</xref>), forensics applications (<xref rid="bty645-B3" ref-type="bibr">Budowle <italic>et al.</italic>, 2014</xref>) and synthetic biology (<xref rid="bty645-B5" ref-type="bibr">Deane, 2018</xref>).</p>
    <p>General-purpose encryption methods, although directly applicable, do not take into consideration specific properties of genomic data files; for instance, Fasta files contain headers, beginning with the ‘&gt;’ character, and DNA bases, including ‘A’, ‘C’, ‘G’, ‘T’ and ‘N’ symbols; Fastq files comprise headers, beginning with the ‘@’ character, bases, ‘+’ separators and quality scores; VCF files begin with ‘##fileformat=VCF’ string. Thus, a specific-purpose encryption approach is required, that is able to protect the genomic data against known-plaintext attacks (KPA) (<xref rid="bty645-B12" ref-type="bibr">Zhang <italic>et al.</italic>, 2018</xref>), as well as low data complexity attacks (<xref rid="bty645-B1" ref-type="bibr">Bouillaguet <italic>et al.</italic>, 2012</xref>).</p>
    <p>In this paper, we present the Cryfa tool, that follows industry recommendations for upholding security of in-transit and at-rest genomic data. This tool addresses secure encryption of such data, along with compacting Fasta/Fastq sequences by a block transformation, followed by shuffling the transformed information and ultimately, performing a fast authenticated encryption on the shuffled content. The encryption is performed with the advanced encryption standard (AES), which is announced by the US. National Institute of Standards and Technology. AES is a symmetric-key algorithm; it uses cipher keys to process data blocks based on a substitution-permutation network (<xref rid="bty645-B4" ref-type="bibr">Daemen and Rijmen, 2002</xref>).</p>
    <p>Applying the AES method distributes the information uniformly, thus it is needed to perform the compacting phase before encryption. We perform a fixed-size compacting, i.e. we pack equally sized blocks of symbols in Fasta/Fastq files, independently of their redundancy. Moreover, operating the shuffling before encryption is crucial, since it prevents an adversary to break the encryption by low data complexity or KPA attacks. Also, it enormously increases the time for breaking encryption by performing an exhaustive search on the password. For a discussion on the importance of applying the shuffling phase, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Note</xref> S1.2.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The schema of Cryfa is demonstrated in Supplementary Figure S1. For the purpose of encrypting and compacting a Fastq file by Cryfa, it is first split into headers, bases and quality scores. Similarly, a Fasta file is split into headers and bases. In the next step, packing of these split segments is performed in different fixed-size blocks, in a way that each block maps a tuple of symbols into an ASCII character. The number of symbols considered for each tuple can be different for headers, bases and quality scores. The next step is employing a key file, containing a password, to shuffle the packed content that is obtained by joining the outputs of different packing blocks. <xref ref-type="supplementary-material" rid="sup1">Supplementary Note</xref> S4 provides with a guideline for making the key file, which can be carried out by the ‘keygen’ tool that we have provided alongside the Cryfa tool. As the result of shuffling, the content becomes uniformly permuted and transformed into pseudo high-data complexity; hence, it becomes resistant against low data complexity and KPA attacks. In the final step, an authenticated encryption, which simultaneously provides data confidentiality and integrity, is carried out on the shuffled content, by the AES method in Galois/counter mode (GCM). The output of this final step is an encrypted and compact Fasta/Fastq file.</p>
    <p>In order to decrypt and unpack a file, it is first decrypted by the AES method in GCM mode. Then, the decrypted content is unshuffled using the key file that is restored to order from the shuffled state. Note that the key file used in this phase needs to be the same as the one used for shuffling. Finally, the unshuffled content is unpacked using a lookup table, and the decrypted and unpacked file is obtained. This file is the same as the original Fasta/Fastq file which had been encrypted and compacted, due to the lossless nature of the Cryfa tool.</p>
    <p>Cryfa is capable of preserving the privacy of any genomic data in Fasta, Fastq, VCF, SAM and BAM formats. In this way, if a genomic file, e.g. in VCF format, is passed to Cryfa, it can be efficiently shuffled and encrypted. <xref ref-type="supplementary-material" rid="sup1">Supplementary Note</xref> S1 describes the methods in greater detail.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We have tested Cryfa and AES Crypt, a general-purpose encryption software, on a collection of Fasta, Fastq, VCF, SAM and BAM datasets. A description of the datasets used, the results obtained and a manual for running Cryfa are provided in <xref ref-type="supplementary-material" rid="sup1">Supplementary Note</xref>s S2–S4, respectively. The results of comparing Cryfa and AES Crypt are demonstrated in <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S4 and S5</xref> and Supplementary Figure S7. Although Cryfa shuffles, efficiently preserves security and integrity and compacts the files, it is 2.2–4 times faster than AES Crypt on Fasta/Fastq datasets. Moreover, it is able to reduce 47–66% of the space required to store a file, whilst AES Crypt does not compress the data. Also, Cryfa performs shuffling and secure encryption of VCF/SAM/BAM datasets at 1.7–2.6 times more speed than AES Crypt. In this case, Cryfa uses only 1 MB of RAM.</p>
    <p>We have carried out several general-purpose and specific-purpose compression plus encryption on the mentioned Fasta and Fastq datasets. Comparing our tool with these methods, demonstrated in <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S6–S8</xref> and Supplementary Figure S8, Cryfa is nine times faster than its fastest competitor on Fasta datasets that is bzip2 plus AES Crypt. This value is 1.4 for Fastq datasets, compared with DSRC 2 plus AES Crypt, due to the more complex nature of the Fastq format. Note that since there was no method that can simultaneously compress and encrypt genomic data, similar to what Cryfa does, we simulated Cryfa’s behavior with a combination of compression methods and an encryption tool.</p>
    <p>To evaluate the cost-effectiveness of running Cryfa on multi-core computing resources, e.g. in the cloud, we have carried it out using a different number of threads on two sample datasets. The results are shown in Supplementary Figure S9. Running with eight threads, compared to one thread, is 2.4 times faster, in terms of real time, and it takes 1.4 times more CPU time, as an aggregation of user and system times, on average. The difference between memory usages while running with one thread and eight threads is 10 MB, which is insignificant. Cryfa uses, at most, 31 MB of RAM.</p>
    <p>State-of-the-art genomic sequence compressors explore redundancy in files to further compress them. This can be exploited by security attacks to differentiate species. Supplementary Figure S10 shows that DELIMINATE and MFCompress have diverse normalized compression values, which makes them vulnerable against the mentioned exploitations. Contrarily, Cryfa behaves similarly in datasets from different species, since it does not explore redundancy in the files. This way, Cryfa is able to further preserve the confidentiality of genomic data. For a more detailed description of results, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Note</xref> S3.</p>
    <p>In conclusion, we have proposed Cryfa, an industry-oriented tool to securely encrypt genomic data in Fasta/Fastq/VCF/SAM/BAM formats, and also, compact data in Fasta/Fastq formats. The security of such data is substantially improved by a straightforward mechanism, shuffling. We further preserve the security of genomic data by not exploring complexity in those files. Therefore, Cryfa cannot be exploited for species differentiation. Our tool is approximately one order of magnitude faster than the fastest state-of-the-art compression plus encryption tools, including general-purpose and specific-purpose ones. Cryfa not only is high-speed and provides a high level of security, as also has a very low memory usage (only a few megabytes).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by European Fund for Regional Development (FEDER) through the Operational Program Competitiveness Factors (COMPETE); and by national funds through the Portuguese Foundation for Science and Technology (FCT), in the context of the projects [UID/CEC/00127/2013, PTCD/EEI-SII/6608/2014] and the grant [PD/BD/113969/2015].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty645_suppl_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bty645-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bouillaguet</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Low-data complexity attacks on AES</article-title>. <source>IEEE Trans. Inf. Theory</source>, <volume>58</volume>, <fpage>7002</fpage>–<lpage>7017</lpage>.</mixed-citation>
    </ref>
    <ref id="bty645-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bradley</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Genomic security (lest we forget)</article-title>. <source>IEEE Security Privacy Mag</source>., <volume>15</volume>, <fpage>38.</fpage></mixed-citation>
    </ref>
    <ref id="bty645-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Budowle</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Validation of high throughput sequencing and microbial forensics applications</article-title>. <source>Investig. Genet</source>., <volume>5</volume>, <fpage>9.</fpage></mixed-citation>
    </ref>
    <ref id="bty645-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Daemen</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Rijmen</surname><given-names>V.</given-names></name></person-group> (<year>2002</year>). <source>The Design of Rijndael: AES—the Advanced Encryption Standard</source>. 
<publisher-name>Springer-Verlag, Berlin, Heidelberg</publisher-name>.</mixed-citation>
    </ref>
    <ref id="bty645-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Deane</surname><given-names>C.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Synthetic biology: license to kill</article-title>. <source>Nat. Chem. Biol</source>., <volume>14</volume>, <fpage>107.</fpage></mixed-citation>
    </ref>
    <ref id="bty645-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duggan</surname><given-names>A.T.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>17th century variola virus reveals the recent history of smallpox</article-title>. <source>Curr. Biol</source>., <volume>26</volume>, <fpage>3407</fpage>–<lpage>3412</lpage>.<pub-id pub-id-type="pmid">27939314</pub-id></mixed-citation>
    </ref>
    <ref id="bty645-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Graham</surname><given-names>B.S.</given-names></name>, <name name-style="western"><surname>Sullivan</surname><given-names>N.J.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Emerging viral diseases from a vaccinology perspective: preparing for the next pandemic</article-title>. <source>Nature Immunol</source>., <volume>19</volume>, <fpage>20.</fpage><pub-id pub-id-type="pmid">29199281</pub-id></mixed-citation>
    </ref>
    <ref id="bty645-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jagadeesh</surname><given-names>K.A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Deriving genomic diagnoses without revealing patient genomes</article-title>. <source>Science</source>, <volume>357</volume>, <fpage>692</fpage>–<lpage>695</lpage>.<pub-id pub-id-type="pmid">28818945</pub-id></mixed-citation>
    </ref>
    <ref id="bty645-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kumar-Sinha</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Chinnaiyan</surname><given-names>A.M.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Precision oncology in the age of integrative genomics</article-title>. <source>Nature Biotechnol</source>., <volume>36</volume>, <fpage>46.</fpage><pub-id pub-id-type="pmid">29319699</pub-id></mixed-citation>
    </ref>
    <ref id="bty645-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Martins</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Extraterrestrial nucleobases in the murchison meteorite</article-title>. <source>Earth Planet. Sci. Lett</source>., <volume>270</volume>, <fpage>130</fpage>–<lpage>136</lpage>.</mixed-citation>
    </ref>
    <ref id="bty645-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Porter</surname><given-names>T.M.</given-names></name>, <name name-style="western"><surname>Hajibabaei</surname><given-names>M.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Scaling up: a guide to high throughput genomic approaches for biodiversity analysis</article-title>. <source>Mol. Ecol</source>., <volume>27</volume>, <fpage>313</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">29292539</pub-id></mixed-citation>
    </ref>
    <ref id="bty645-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>L.Y.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Improved known-plaintext attack to permutation-only multimedia ciphers</article-title>. <source>Inf. Sci</source>., <volume>430–431</volume>, <fpage>228</fpage>–<lpage>239</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
