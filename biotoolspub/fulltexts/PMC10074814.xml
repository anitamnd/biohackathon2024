<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10074814</article-id>
    <article-id pub-id-type="publisher-id">5169</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05169-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PSReliP: an integrated pipeline for analysis and visualization of population structure and relatedness based on genome-wide genetic variant data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Solovieva</surname>
          <given-names>Elena</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sakai</surname>
          <given-names>Hiroaki</given-names>
        </name>
        <address>
          <email>hirsakai@affrc.go.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.416835.d</institution-id><institution-id institution-id-type="ISNI">0000 0001 2222 0432</institution-id><institution>Research Center for Advanced Analysis, </institution><institution>National Agriculture and Food Research Organization, </institution></institution-wrap>Tsukuba, Ibaraki Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>135</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Population structure and cryptic relatedness between individuals (samples) are two major factors affecting false positives in genome-wide association studies (GWAS). In addition, population stratification and genetic relatedness in genomic selection in animal and plant breeding can affect prediction accuracy. The methods commonly used for solving these problems are principal component analysis (to adjust for population stratification) and marker-based kinship estimates (to correct for the confounding effects of genetic relatedness). Currently, many tools and software are available that analyze genetic variation among individuals to determine population structure and genetic relationships. However, none of these tools or pipelines perform such analyses in a single workflow and visualize all the various results in a single interactive web application.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed PSReliP, a standalone, freely available pipeline for the analysis and visualization of population structure and relatedness between individuals in a user-specified genetic variant dataset. The analysis stage of PSReliP is responsible for executing all steps of data filtering and analysis and contains an ordered sequence of commands from PLINK, a whole-genome association analysis toolset, along with in-house shell scripts and Perl programs that support data pipelining. The visualization stage is provided by Shiny apps, an R-based interactive web application. In this study, we describe the characteristics and features of PSReliP and demonstrate how it can be applied to real genome-wide genetic variant data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The PSReliP pipeline allows users to quickly analyze genetic variants such as single nucleotide polymorphisms and small insertions or deletions at the genome level to estimate population structure and cryptic relatedness using PLINK software and to visualize the analysis results in interactive tables, plots, and charts using Shiny technology. The analysis and assessment of population stratification and genetic relatedness can aid in choosing an appropriate approach for the statistical analysis of GWAS data and predictions in genomic selection. The various outputs from PLINK can be used for further downstream analysis. The code and manual for PSReliP are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/solelena/PSReliP">https://github.com/solelena/PSReliP</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05169-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Population stratification</kwd>
      <kwd>Cryptic relatedness</kwd>
      <kwd>Population structure analysis</kwd>
      <kwd>Genetic relatedness investigation</kwd>
      <kwd>Data visualization</kwd>
      <kwd>PLINK</kwd>
      <kwd>Shiny application</kwd>
      <kwd>Bioinformatics pipeline</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <sec id="Sec2">
      <title>Overview of topics of PSReliP</title>
      <p id="Par18">Population structure (or population stratification) (PS) and cryptic relatedness (CR) are two basic aspects of population genetics. PS refers to the presence of systematic differences in allele frequencies between subpopulations that arise from non-random mating. CR (unknown to the investigators) occurs when some individuals are closely related, but this close relatedness is unreported. PS and CR can lead to the problem of confounding in genetic association studies [<xref ref-type="bibr" rid="CR1">1</xref>]. A genome-wide association study (GWAS) is an approach used to evaluate the associations between specific genetic variants and particular phenotypes or diseases.</p>
      <p id="Par19">Principal components analysis (PCA) is the most widely used method to adjust for PS in GWAS [<xref ref-type="bibr" rid="CR2">2</xref>]. In genetic studies, PCA is generally applied to a genomic relationship matrix (GRM). The method used in the PLINK 1.9 [<xref ref-type="bibr" rid="CR3">3</xref>] and 2.0 [<xref ref-type="bibr" rid="CR4">4</xref>] for the computation of the variance-standardized GRM is similar to the method implemented in the GCTA [<xref ref-type="bibr" rid="CR5">5</xref>] (genome-wide complex trait analysis) tool [<xref ref-type="bibr" rid="CR6">6</xref>]. The GRM, estimated using GCTA and PLINK software, can be interpreted as a matrix representation of genetic relationships between individuals in a specified dataset of genetic variants (<ext-link ext-link-type="uri" xlink:href="https://cnsgenomics.com/software/gcta/#Overview">https://cnsgenomics.com/software/gcta/#Overview</ext-link>).</p>
      <p id="Par20">Related approaches, such as multidimensional scaling (MDS) performed on identity-by-state (IBS) pairwise distances, can also be applied to control PS in GWAS [<xref ref-type="bibr" rid="CR7">7</xref>]. Several examples of using MDS for PS analysis have been presented in scientific literature. For example, Linge et al. [<xref ref-type="bibr" rid="CR8">8</xref>] used MDS to investigate PS using a dataset of 620 individuals from several peach cultivars. In that study, PS was analyzed using MDS and clustering analyses.</p>
      <p id="Par21">Both MDS and cluster analyses can be performed based on IBS pairwise distances (the genome-wide average proportion of alleles sharing IBS between any two individuals) [<xref ref-type="bibr" rid="CR9">9</xref>]. IBS analysis is a widely used and easily applicable method to measure genetic similarity (similarity of alleles) between pairs of individuals in a population (IBS alleles are not necessarily a consequence of identity by descent (IBD)). This analysis may help understand the degree of genetic diversity in the whole population and different subpopulations.</p>
      <p id="Par22">The kinship coefficient, defined as the probability that two homologous alleles, one from each of two individuals, are identical by descent (IBD), is a classic measurement of relatedness (genetic relationships among individuals resulting from shared ancestry) and is important in many fields of biology [<xref ref-type="bibr" rid="CR10">10</xref>]. Genetic relatedness can be calculated from the pedigree (the pedigree-based kinship) or can be estimated using genetic marker data (the marker-based kinship). Pedigree-free (marker-based) methods are preferred for estimating kinship coefficients when there are difficulties in restoring pedigrees in natural populations, or when the results of kinship analysis are used to infer relatedness in GWAS with unavailable or inaccurate pedigree information [<xref ref-type="bibr" rid="CR1">1</xref>]. Several methods have been developed to estimate kinship coefficients from the genotypic data [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR11">11</xref>].</p>
      <p id="Par23">Common estimation approaches use allele frequencies for kinship estimation, meaning that an appropriate reference population is required [<xref ref-type="bibr" rid="CR11">11</xref>]. Other kinship estimation methods, such as the KING-robust estimator [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], do not use allele frequencies and can provide robust relationship inference in the presence of an unknown population substructure.</p>
      <p id="Par24">Marker-based kinship coefficient matrices (a matrix that contains the pairwise kinship coefficient between all individuals) can be used to correct hidden relatedness as a random effect in a mixed-model approach for GWAS analysis [<xref ref-type="bibr" rid="CR14">14</xref>]. The mixed-model approach, which accounts for confounding factors such as fixed effects (for PS) and random effects (kinship matrix), has been widely used in GWAS [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref>], particularly in GWAS conducted in plants and animals. In addition, PS and CR are factors that can influence the prediction of genomic selection (GS) [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR20">20</xref>]. Wright’s F-statistics, including Wright's fixation index (FST), is one of the most used statistics in population and evolutionary genetics [<xref ref-type="bibr" rid="CR21">21</xref>]. F-statistics, particularly FST, is commonly used to measure genetic variation in different populations (PS or the genetic differentiation of populations) [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p id="Par25">The coefficient of inbreeding (F) of an individual is a measure of inbreeding and can be defined as the probability that two alleles at any given locus in an individual are IBD [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>]. Estimating the inbreeding coefficients of individuals in GWAS data is important for quality control (QC) when deciding whether to remove individuals with highly positive or highly negative inbreeding coefficients. Highly positive inbreeding coefficients indicated many homozygous genotypes and high levels of inbreeding. The inclusion of these individuals can influence GWAS results because the random mating assumption required for the standard GWAS test is violated. Highly negative inbreeding coefficients, which can be calculated by some estimators, indicate too many heterozygous genotypes and suggest the possibility of contamination.</p>
    </sec>
    <sec id="Sec3">
      <title>Integrated approach to data analysis and visualization</title>
      <p id="Par26">In population genetics research and GWAS analysis, several analytical tools and software packages have been developed to investigate the stratification and relatedness in the population genetics studies. PLINK [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] is a popular and commonly used program for analyzing genetic variant data, including the detection of PS and CR. However, PLINK (like many other bioinformatics tools) provides the user with many commands to perform various analyses that require a deep understanding of the available parameters, their combinations, supported file formats, etc. To perform an in-depth computational analysis, it is necessary to execute several commands sequentially, with additional steps for data selection and filtering, changing data formats, etc.</p>
      <p id="Par27">In addition, visualization techniques and their applications are often required to interpret the results of the analyses performed. Many tools and packages with different implementations can be used to visualize biological datasets, including genetic and genomic data [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. One popular web application framework widely used in various research fields is Shiny [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>] (<ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/products/shiny/">https://www.rstudio.com/products/shiny/</ext-link>). Shiny is an open-source R package that offers the ability to develop interactive web applications (apps) with a dynamic user interface (UI) that can be run locally or deployed over the Internet. Shiny can be used in combination with Plotly's R graphing library [<xref ref-type="bibr" rid="CR32">32</xref>] (<ext-link ext-link-type="uri" xlink:href="https://plotly.com/r/">https://plotly.com/r/</ext-link>) to create interactive web-based graphical representations of data, such as plots, charts, histograms, heatmaps, etc.</p>
      <p id="Par28">Integration of analysis and visualization functionalities into the same application or pipeline is an important approach used in various biomedical research areas, including genetics and genomics. There are some examples of pipelines that combine a comprehensive analysis of sequencing data and visualization capabilities. For example, Wang et al. [<xref ref-type="bibr" rid="CR33">33</xref>] created the “CRISPR-DAV: CRISPR NGS data analysis and visualization pipeline,” which analyzes the CRISPR (clustered regularly interspaced short palindromic repeat) NGS (next generation sequencing) data and visualizes the analysis results. The pipeline itself is implemented in Perl and R and uses a set of common bioinformatics tools. Buza et al. [<xref ref-type="bibr" rid="CR34">34</xref>] developed the “iMAP: an integrated bioinformatics and visualization pipeline for microbiome data analysis,” which performs the analysis of marker-based microbiome data using several publicly available tools and generates graphics and progress reports using various R packages and R-markdown. There are also several applications for PS and genetic relatedness analyses and the visualization of their results. However, as discussed later, these applications differ from the pipeline we have developed in terms of the types of analysis performed, functions offered to users, and their implementation.</p>
      <p id="Par29">In this study, we developed a PS and relatedness integrated pipeline, PSReliP, which analyzes and visualizes the PS and relatedness between individuals (samples) based on genome-wide genetic variant data. All analyses are performed at high speed using PLINK software in a sequential manner with programs and scripts written in-house. The Shiny web application allows users to interactively visualize the analysis results in a web browser. Herein, we described the structure of PSReliP, explained the functionality of its analysis and visualization stages and UI as well as demonstrated its application in genome-wide genetic variant data of rice varieties and Malawi cichlids.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Implementation</title>
    <sec id="Sec5">
      <title>Pipeline structure and implementation</title>
      <p id="Par30">The PSReliP pipeline combines analysis techniques with an interactive visualization of the analysis results. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows a conceptual overview of the pipeline structure with distinct steps and associated output files.<fig id="Fig1"><label>Fig. 1</label><caption><p>Conceptual overview of the pipeline structure. A schematic representation showing all major steps of the pipeline, with input and output data types and corresponding elements in the user interface. The first pre-analysis step in the pipeline is to convert variant call format (VCF) file or binary variant call format (BCF) file to PLINK files. The analysis phase performs all types of analysis, and the results of each step are visualized in interactive web-based tables, charts, plots, and heatmaps</p></caption><graphic xlink:href="12859_2023_5169_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par31">The proposed integrated pipeline can be divided into two stages: (1) the analysis stage, which includes a pre-analysis step and (2) the visualization stage. The analysis stage is performed by two bash shell scripts that are executed from the command line on Linux-based operating systems and take several arguments from the configuration file (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1 for details). The first step in the analysis stage is the conversion of the variant call format (VCF) or binary variant call format (BCF) files into PLINK format files, which are later used in the data analysis process. The main steps of the analysis stage of the pipeline are: (1) QC and filtering of samples and variants; (2) calculation of basic sample statistics, such as the types of observed variants, inbreeding coefficients, etc., which is performed before and after data filtering; (3) analysis of PS using PCA and MDS, and complete-linkage hierarchical clustering of samples based on the IBS distance matrix, if selected; (4) calculation of Wright's FST; (5) calculation of the IBS distance matrix and analysis of genetic relatedness by estimating the KING kinship coefficient matrix and GRM. All the steps are performed sequentially.</p>
      <p id="Par32">To visualize the results of the analyses, we created a web-based visualization stage for PSReliP. We implemented this stage using Shiny technology (<ext-link ext-link-type="uri" xlink:href="https://shiny.rstudio.com/">https://shiny.rstudio.com/</ext-link>), which provides a dynamic and interactive UI, and developed the Shiny application, an interactive R-based web application. Users can run the created Shiny application locally in Rstudio or deploy it in two main ways: in their own Shiny Server or in the cloud: shinyapps.io (<ext-link ext-link-type="uri" xlink:href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson7/">https://shiny.rstudio.com/tutorial/written-tutorial/lesson7/</ext-link>). Running the Shiny application produces interactive tables, plots, and charts of data and displays them through a web browser. In addition, the Shiny application allows the user to download the PLINK result files for evaluation and further use in other tools and software. All steps of the data analysis and visualization of our pipeline are elaborated in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 1. In this study, we used the results of several runs of our pipeline applied to two datasets, which are described in the following sections. The time required to complete each of these runs is shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2 (runs of the first shell script) and 3 (runs of the second shell script).</p>
      <p id="Par33">Figure <xref rid="Fig2" ref-type="fig">2</xref> outlines the implementation of PSReliP and shows the major parts of the pipeline implemented in Shell, Perl, and R using the PLINK software and several publicly available R packages.<fig id="Fig2"><label>Fig. 2</label><caption><p>Implementation of the PSReliP pipeline. A schematic representation showing the required software and R packages used to develop the PSReliP pipeline and those that must be installed by the user before running the pipeline. The user must also edit the configuration file, which contains information about the pipeline installation directory, the working directory, input files, and parameter values used in the analysis and visualization processes. The created Shiny application can be viewed in several ways, such as sharing as a web page using Shiny Server or Shinyapps.io or running from RStudio Desktop</p></caption><graphic xlink:href="12859_2023_5169_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>User interface</title>
      <p id="Par34">To describe the functionality and application of our pipeline, along with the UI of its visualization stage, we used screenshots of the UI that appeared in the Google Chrome browser when PSReliP was run on a Shiny Server installed on our CentOS Linux. The data used in these screenshots were derived from the genome-wide genetic variant data of 143 worldwide rice samples registered in the Rice Annotation Project Database [<xref ref-type="bibr" rid="CR35">35</xref>] (RAP-DB; <ext-link ext-link-type="uri" xlink:href="https://rapdb.dna.affrc.go.jp">https://rapdb.dna.affrc.go.jp</ext-link>) (details are described in the Results section). Additional details of the user interface shown in the following figures are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 2.</p>
      <p id="Par35">As described above, the pipeline visualization stage generates tables, plots, charts, and heatmaps to show the results of the analysis stage. Visualizing the analysis results in a user-friendly manner is important for interpretation and optimization of the analysis process. The main functionalities of the visualization stage are shown in Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>. The parameters used in the analyses are listed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run A).<fig id="Fig3"><label>Fig. 3</label><caption><p>User interface for basic sample statistics with table representation of missing data. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run A). ① The parameters used in the analysis stage, which are specified in the configuration file; ② the numbers of analyzed samples, loaded variants, and variants remaining after filtering and LD pruning, which were calculated at the analysis stage; ③ a download button for the PLINK 1.9.bim file; ④ four tabs in the main menu of the user interface with the ‘Basic statistics’ tab selected; ⑤ a radio button with two values: ‘Original’ and ‘After filtering’, corresponding to the datasets displayed on this tab; ⑥ a radio button labeled ‘Reports’ whose values correspond to the types of reports displayed and its two values for the ‘Original’ dataset; ⑦ a radio button labeled ‘Views’ for the two types of data presentation such as ‘Table’ and ‘Chart’; ⑧ a button to download the results of the basic statistics analysis as a ZIP file. The Sample-based missing data report for 143 accessions of rice varieties is represented as an interactive table with sorting and searching features. The symbol prime (′) at the upper right of the numbers indicates selected items</p></caption><graphic xlink:href="12859_2023_5169_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>User interface for basic sample statistics with chart representation of inbreeding coefficients. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run A). ① Four tabs in the main menu of the user interface with the ‘Basic statistics’ tab selected; ② a radio button with two values: ‘Original’ and ‘After filtering’, corresponding to the datasets displayed on this tab; ③ a radio button labeled ‘Reports’ whose values correspond to the types of reports displayed and its four values for the ‘After filtering’ dataset; ④ a radio button labeled ‘Views’ for the two types of data presentation such as ‘Table’ and ‘Char’; ⑤ a button to download the displayed chart as a single standalone HTML file. The GCTA inbreeding coefficient report for 141 accessions of rice varieties is represented in the form of multiple interactive subplots, namely the bar chart for missing data and three scatter plots with lines for inbreeding coefficients. The symbol prime (′) at the upper right of the numbers indicates selected items</p></caption><graphic xlink:href="12859_2023_5169_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par36">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows a screenshot of the web page shown when the Shiny app was accessed for the first time, with one exception: in this example, the [sample-based missing data reports ⑥′] value was selected after the page was loaded. Figures <xref rid="Fig3" ref-type="fig">3</xref> ④ and <xref rid="Fig4" ref-type="fig">4</xref> ① show the main menu of the PSReliP UI. The four tabs on this menu correspond to the types of analysis performed in our pipeline. The tabs are as follows: (1) ‘Basic statistics’; (2) ‘Population Stratification analysis’; (3) ‘Wright's FST estimation’; and 4) ‘IBS and GRM calculation &amp; Kinship Coefficients estimation’. In both figures (Figs. <xref rid="Fig3" ref-type="fig">3</xref> ④′ and <xref rid="Fig4" ref-type="fig">4</xref> ①′), the ‘Basic statistics’ tab is selected, and the basic sample statistics are displayed. Figures <xref rid="Fig3" ref-type="fig">3</xref> ⑤ and <xref rid="Fig4" ref-type="fig">4</xref> ② show the radio button labeled ‘Datasets’ with two values: “original” and “after filtering.” These values correspond to the datasets displayed in this tab:</p>
      <p id="Par37">Original: the original dataset with no applied filters, which contains all the samples and variants included in the input VCF/BCF files. An example of this is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> ⑤′.</p>
      <p id="Par38">After filtering: all the filters specified in the configuration file were applied to the dataset.</p>
      <p id="Par39">An example of this is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> ②′.</p>
      <p id="Par40">The original PLINK result files can be downloaded as ZIP files so that users can evaluate the analysis results and further use them in other tools and software (Fig. <xref rid="Fig3" ref-type="fig">3</xref> ⑧). The button labeled ‘Save the chart as a standalone HTML file’ shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> ⑤ allows the user to download the displayed chart as a single standalone HTML file. In addition, using the features provided by Plotly, the user can export the displayed image from the browser as an image file in the format specified in the configuration file, such as PNG, JPEG, WebP, SVG, and PDF. Other UI features of our pipeline are illustrated in the Results section.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <sec id="Sec8">
      <title>Preparing data for case studies</title>
      <p id="Par41">To demonstrate the application of the proposed pipeline, validate its efficiency in assessing PS and CR, and illustrate its functionalities and capabilities, two case studies were conducted on rice varieties and Malawi cichlids. To prepare the data for these case studies, we first downloaded the sequencing data with associated metadata from the NCBI and EBI databases and then performed sequence alignment and variant calling using the procedure described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 3. To create the dataset of rice varieties, we selected BioSample accessions of cultivars, landraces, and wild species, registered in the Rice Annotation Project Database [<xref ref-type="bibr" rid="CR35">35</xref>] (RAP-DB, <ext-link ext-link-type="uri" xlink:href="http://rapdb.dna.affrc.go.jp/">http://rapdb.dna.affrc.go.jp/</ext-link>) [<xref ref-type="bibr" rid="CR36">36</xref>], with an average depth of sequencing coverage greater than 30. To create the dataset of Malawi cichlids, we selected BioSample accessions from BioProject PRJEB1254 and PRJEB15289, for which the sampling locations were recorded in the NCBI BioSample database. All raw sequencing reads were obtained from a previous study [<xref ref-type="bibr" rid="CR37">37</xref>]. We compared the data obtained by running our pipeline with the data published in that article, which is discussed in the following subsections. Details of selecting BioSample accessions and reference genomes [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], downloading nucleotide sequence data, and preparing genetic variant data are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 4. Accessions from the BioProject, BioSample, and European Nucleotide Archive databases are listed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S4 and S5.</p>
    </sec>
    <sec id="Sec9">
      <title>Results obtained in case studies</title>
      <p id="Par42">
        <list list-type="bullet">
          <list-item>
            <p id="Par43">Analysis of genetic variants of rice varieties</p>
          </list-item>
        </list>
      </p>
      <p id="Par44">The results of the analyses performed five times using different filtering and pruning options (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3) are described here.</p>
      <p id="Par45">The four tabs on the main menu, corresponding to the types of analysis performed in our pipeline, are shown at the top of Fig. <xref rid="Fig5" ref-type="fig">5</xref> (indicated by ①), of which the ‘Population Stratification analysis’ tab was selected (Fig. <xref rid="Fig5" ref-type="fig">5</xref> ①′). The parameter values used in the PS analysis are listed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run A).<fig id="Fig5"><label>Fig. 5</label><caption><p>User interface for results of Population Stratification analysis with the two-component PCA plot. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run A). ① Four tabs in the main menu of the user interface with the ‘Population Stratification analysis’ tab selected; ② a radio button with a choice of three methods, namely PCA, Normalized PCs (each eigenvector is multiplied by the square root of its eigenvalue), and MDS; ③ two drop-down lists with values of principal components for which the PCA plot is drawn; ④ a drop-down list with the value ‘ALL’ or the ID/Name of the sample, which is displayed in a larger size compared to rest of the values; ⑤ a radio button with values ‘Hide’ and ‘Display’, which allows users to hide or show sample IDs/names; ⑥ the colors legend that matches groups/clusters with corresponding marker colors; ⑦ a button to download the results of the population stratification analysis as a ZIP file. The interactive two-component PCA plot displays the first and second principal components (PC1/PC2) for 141 accessions of rice varieties, with data point colors corresponding to 14 rice type groups. The symbol prime (′) at the upper right of the numbers indicates selected items</p></caption><graphic xlink:href="12859_2023_5169_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par46">The scatter plot in Fig. <xref rid="Fig5" ref-type="fig">5</xref> is an interactive 2-component PCA plot in which the first principal component (PC1) is represented by the horizontal axis and explains 10.4% of the variance, and the second principal component (PC2) is represented by the vertical axis and explains 5.2% of the variance. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 5 for details on calculating the percentage of variance explained by each PC. The 2-component PCA plot for the other PCs can be drawn by selecting the corresponding components from the two drop-down lists, as shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref> ③. Users can highlight one of the samples on the PCA plot by selecting it from the drop-down list (Fig. <xref rid="Fig5" ref-type="fig">5</xref> ④), and the selected sample will be shown to be larger than the others (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a). The interactive scatter plot can display annotation information, such as sample ID, PC values, and the group or cluster number to which the sample belongs, by hovering the mouse pointer over the markers (samples) in the scatter plot (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a, Run A in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). Users can “Hide” or “Display” the IDs or names of the samples by changing the checked value in the radio buttons (Fig. <xref rid="Fig5" ref-type="fig">5</xref> ⑤, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b). In this figure, the ‘Hide’ value was checked (Fig. <xref rid="Fig5" ref-type="fig">5</xref> ⑤′), and accordingly the names of the samples were hidden. Additionally, users can zoom in and out of the plot using Plotly's zoom functionality (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b, Run A in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3).</p>
      <p id="Par47">In our pipeline, a PCA plot is a scatter plot that maps marker colors to a categorical variable (user-defined groups or clusters calculated using PLINK). Figure <xref rid="Fig5" ref-type="fig">5</xref> ⑥ shows the color legend that matches the groups defined by us with the corresponding marker colors. We grouped 143 rice varieties into 16 groups based on the rice types (e.g., indica, aus, temperate japonica, tropical japonica, and aromatic) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S6), similar to the way they were grouped in the RAP-DB. As mentioned earlier, after filtering by maximum missing genotype rates per-sample (—mind with a value of 0.2), the number of samples decreased to 141 and the number of groups decreased to 14 (“MER: Oryza meridionalis” and “PUN: Oryza punctata" were excluded) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The japonica varieties (JP: Oryza sativa Japonica Group, TEJ: Oryza sativa temperate japonica subgroup, TRJ: Oryza sativa tropical japonica subgroup) and indica varieties (IND: Oryza sativa Indica Group, AUS: Oryza sativa aus subgroup) were separated from each other along PC1, whereas the TRJ and TEJ groups as well as the TRJ group and indica varieties were separated along PC2 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The same can be observed in the MDS plot (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S2 and S3, Run A in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). Plotly provides functions to show/hide data from each group individually by clicking on corresponding legend items. We used this feature on all charts and plots in our pipeline.</p>
      <p id="Par48">For a more complete overview of the results of the PCA and MDS analyses, along with the projections of the samples on the plane defined by the first two PCs, plots of PC1 and PC3 are often used. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4 shows plots of PC1 and PC3 obtained from the same analysis, as illustrated in Fig. <xref rid="Fig5" ref-type="fig">5</xref> (Run A in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). PC3 explains 3.2% of the variance. Samples from groups such as BAR (Oryza barthii), GLA (Oryza glaberrima), and GLU (Oryza glumaepatula) as well as some samples from the RUF (Oryza rufipogon) group, which are indicated in the figure by an oval, were separated along PC3 from that of other groups, including the Oryza sativa groups mentioned above (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4).</p>
      <p id="Par49">To analyze PS and CR in japonica and indica varieties used in our case study, we selected samples belonging only to five groups (JP, TEJ, TRJ, IND, and AUS) and performed the analysis stage. The resulting PCA plots are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a (Run C in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3) and Fig. <xref rid="Fig6" ref-type="fig">6</xref>b (Run E in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3).<fig id="Fig6"><label>Fig. 6</label><caption><p>An illustration showing two ways of dividing samples into groups that are performed in PSReIP. <bold>a</bold>, <bold>b</bold> The two-component PCA plots for the first and second principal components (PC1/PC2) for 110 accessions of rice varieties from five groups: JP, TEJ, TRJ, IND, and AUS. <bold>a</bold> An example of using user-defined groups. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run C). The colors of the data points correspond to these 5 groups of rice type. ① Most samples from the TEJ group; ② almost all samples from the TRJ group; ③ almost all samples from the indica varieties, which include the IND and AUS groups. <bold>b</bold> An example of using complete-linkage hierarchical clustering performed by PLINK 1.9. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run E). The colors of the data points correspond to the 5 calculated clusters</p></caption><graphic xlink:href="12859_2023_5169_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par50">As described above, during the analysis stage of our pipeline, the PLINK—fst command is executed, and the results are visualized in the ‘Wright's FST estimates’ tab (Fig. <xref rid="Fig7" ref-type="fig">7</xref> ①′, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5) of the tabs panel (Fig. <xref rid="Fig7" ref-type="fig">7</xref> ①). The parameter values used in FST analysis are listed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run C).<fig id="Fig7"><label>Fig. 7</label><caption><p>User interface for results of FST estimation with the Manhattan plot of FST values for variants. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run C). ① Four tabs in the main menu of the user interface with the ‘Wright's FST estimation’ tab selected; ② a drop-down list for selecting a pair of subpopulations to be shown on the Manhattan plot; ③ a drop-down list with the value ‘ALL’ or the name of the chromosome/contig containing the variants ≥ 100 and ≤ 100,000; ④ a drop-down list with range of FST values (0–0.9) to filter the data displayed in the Manhattan plot; ⑤ the legend colors on the plot corresponding to the chromosome number; ⑥ a button to download the results of the Wright's FST estimation as a ZIP file. The interactive Manhattan plot showing Wright's FST values for variants on all chromosomes that were calculated between the IND and TEJ rice groups. The symbol prime (′) at the upper right of the numbers indicates selected items</p></caption><graphic xlink:href="12859_2023_5169_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par51">Users can select one of the pairs of subpopulations (groups or clusters of samples) by choosing the pair from the drop-down list (Fig. <xref rid="Fig7" ref-type="fig">7</xref> ② and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5 ①), and Wright's FST value between the pairs of selected subpopulations (pairwise FST) is displayed in the text box immediately below this drop-down list. In this example, this value was 0.235 for the IND and TEJ groups.</p>
      <p id="Par52">The PLINK—fst command with the 'report-variants' modifier calculates the per-variant FST estimates, which is used in our pipeline if the number of groups/clusters is ≤ 5 (to control the output size). The FST values for each variant between pairs of the selected subpopulations are shown in the Manhattan plot (Fig. <xref rid="Fig7" ref-type="fig">7</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). Variants with 'nan' Fst values were removed from the FST plot, and negative FST values were set to zero. For a particular variant, an FST value near 1 indicated that each of the two populations was fixed for a different allele at that locus, similar to the variant shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5 ④. The legend colors in the plot (Fig. <xref rid="Fig7" ref-type="fig">7</xref> ⑤) correspond to chromosome numbers. The download button labeled ‘Save original data for a selected pair of subpopulations as a zip file’ (Fig. <xref rid="Fig7" ref-type="fig">7</xref> ⑥) allows the user to download files obtained with the PLINK—fst command and containing FST estimates between the two selected subpopulations.</p>
      <p id="Par53">To illustrate how the FST values depend on the variants used in the analysis, we ran our pipeline on the same input subset (Run C in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3) without LD-based pruning and with the—maf parameter of 0.01 (Run D in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). For comparison, we placed the HUDSON_FST values (between-population FST estimates) obtained from the two runs in Table <xref rid="Tab1" ref-type="table">1</xref>, which shows that the FST values are significantly lower in the LD pruned data, and this result is consistent with those presented in the scientific literature, which is discussed in the Discussion section.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Pairwise Hudson's FST between groups in the dataset of genetic variants of rice varieties</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">POP1</th><th align="left">POP2</th><th align="left">HUDSON_FST<sup>a</sup></th><th align="left">HUDSON_FST (LD pruned variants set<sup>b</sup>)</th></tr></thead><tbody><tr><td align="left">AUS</td><td align="left">IND</td><td char="." align="char">0.34</td><td char="." align="char">0.094</td></tr><tr><td align="left">AUS</td><td align="left">JP</td><td char="." align="char">0.569</td><td char="." align="char">0.202</td></tr><tr><td align="left">AUS</td><td align="left">TEJ</td><td char="." align="char">0.72</td><td char="." align="char">0.29</td></tr><tr><td align="left">AUS</td><td align="left">TRJ</td><td char="." align="char">0.615</td><td char="." align="char">0.202</td></tr><tr><td align="left">IND</td><td align="left">JP</td><td char="." align="char">0.46</td><td char="." align="char">0.161</td></tr><tr><td align="left">IND</td><td align="left">TEJ</td><td char="." align="char">0.605</td><td char="." align="char">0.235</td></tr><tr><td align="left">IND</td><td align="left">TRJ</td><td char="." align="char">0.486</td><td char="." align="char">0.15</td></tr><tr><td align="left">JP</td><td align="left">TEJ</td><td char="." align="char">0.124</td><td char="." align="char">0.053</td></tr><tr><td align="left">JP</td><td align="left">TRJ</td><td char="." align="char">0.259</td><td char="." align="char">0.149</td></tr><tr><td align="left">TEJ</td><td align="left">TRJ</td><td char="." align="char">0.412</td><td char="." align="char">0.203</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Data were not pruned for LD and the—maf value was set to 0.01 (Run D in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3)</p><p><sup>b</sup>The parameters used are listed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run C)</p></table-wrap-foot></table-wrap></p>
      <p id="Par54">A Fig. <xref rid="Fig8" ref-type="fig">8</xref> shows an example of the genetic similarity between individuals (samples) and the genetic relatedness between them (Run A in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3).<fig id="Fig8"><label>Fig. 8</label><caption><p>User interface for results of IBS, GRM, and Kinship coefficient calculations with heatmap of IBS displayed. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run A). ① Four tabs in the main menu of the user interface with the ‘IBS and GRM calculation &amp; Kinship Coefficients estimation’ tab selected; ② a radio button for choosing any of the three methods, namely the IBS matrix calculation, the Genomic Relationship Matrix calculation, and the KING-robust kinship estimation; ③ a radio button to select the order of the samples, which can be the same as in the matrix obtained by the corresponding PLINK command (‘PLINK Sample ID’) or can be remade according to the groups/clusters to which the samples are assigned (‘Group/Cluster number’); ④ a gradient color bar that maps colors to their corresponding values; ⑤ the corresponding value for pairs of samples and their IDs/names displayed by hovering the mouse over the colored square; ⑦ a button to download the results of the IBS, GRM, and kinship calculation as a ZIP file. The interactive heatmap represents the genetic similarity between samples, namely the IBS matrix calculated for 141 accessions of rice varieties, in which the samples are ordered by ‘Group/Cluster number’. The symbol prime (′) at the upper right of the numbers indicates selected items</p></caption><graphic xlink:href="12859_2023_5169_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par55">Users can display the results of these analyses by selecting the tab ‘IBS and GRM calculation and Kinship Coefficients estimation’ (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ①′) on the main menu (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ①). For this type of analysis, we prepared three methods (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ②): IBS matrix calculation (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ②′), GRM, and KING-robust kinship estimation. The results of these three types of calculations are displayed on interactive heatmaps, where samples can be ordered in two ways, ‘PLINK Sample ID’ and ‘Group/Cluster number’ (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ③). The list of sample IDs/Names on the heatmap can be in the same order as in the matrix derived from the corresponding PLINK command, or samples can be reordered according to the groups/clusters to which they are assigned (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ③′). The gradient color bar in the heatmap (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ④) maps the colors to their corresponding values. The individual values for the two samples and the IDs/Names for these samples are displayed when the mouse is hovered over the colored square (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ⑤). Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6 shows a heatmap of the GRM (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6 ①) for the same data, as shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref> (Run A in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). The samples are also ordered by ‘Group/Cluster number’ (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6 ②).</p>
      <p id="Par56">Scientific literature suggests that pruning data based on LD values is an important step for IBS and GRM calculations (see Discussion section). To illustrate how the values of IBS and GRM depend on the variants used in the analysis, we ran our pipeline on the same input subset (Run A in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3) without using LD-based pruning and with the—maf parameter of 0.01 (Run B in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). The resulting IBS matrix (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7 ①), reordered by the ‘Group/Cluster number’ (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7 ②), is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7. As can be observed from the two heatmaps (Fig. <xref rid="Fig8" ref-type="fig">8</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7), without LD-based pruning, the overall values of the IBS matrix are higher, as in the example of the same pair of samples (Fig. <xref rid="Fig8" ref-type="fig">8</xref> ⑤ and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7 ③).</p>
      <p id="Par57">Unlike the calculation of IBS and GRM, LD-based pruning is not recommended for estimating KING-robust kinship coefficients (see Discussion section). Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8 shows an example of a heatmap of KING-robust kinship coefficients (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8 ①) for data that were not pruned for LD, and the—maf value was set to 0.01 (Run B in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). The samples on the heatmap were ordered by ‘Group/Cluster number’ (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8 ②). Note that the KING kinship coefficients are scaled so that duplicate samples have a kinship of 0.5, rather than 1 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8 ③). In this heatmap, most of the individual pairs had a kinship coefficient of 0, and only a few pairs had a kinship coefficient &gt; 0.25, such as a pair of accessions of the Koshihikari variety with a KING kinship coefficient of 0.358 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8 ④). As described above, to explore CR between individuals, we prepared GRM and the kinship matrix with pairwise KING kinship coefficients, so that users can choose between them depending on the objectives of the study and the type of downstream analysis.<list list-type="bullet"><list-item><p id="Par58">Analysis of genetic variants of Malawi cichlids</p></list-item></list></p>
      <p id="Par59">In this subsection, we present the results of the analysis of the dataset containing the genetic variants of Malawian cichlids. These results can be viewed in the following tables: ‘Basic statistics,’ ‘Population Stratification analysis,’ and ‘Wright's FST estimation.’ We ran our pipeline multiple times using different filtering and pruning options (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 Dataset of genetic variants of Malawi cichlids). The parameters used in Runs F and G differed in the number of groups, whereas the parameters used in Run H differed from those used in Run I by using LD-based pruning and values of the—maf parameter.</p>
      <p id="Par60">In the stacked bar chart of a ‘Sample variant-count report’ for the original dataset (Run F in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3), most of the observed variants belonged to the class of ‘Hom-REF genotype’ (homozygous reference allele; reference: M_zebra_UMD2a) (blue color), and only a small number of observed variants belong to other classes, such as ‘Hom-ALT SNP’ (orange), ‘Het. SNP genotype’ (green), and ‘diploid non-SNP variant’ (red) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). This result is consistent with that observed in a previous study showing that the genetic diversity in cichlid fish species is low [<xref ref-type="bibr" rid="CR37">37</xref>]. Ten samples had more variants other than the ‘Hom-REF genotype’ class than the other samples. All were samples of the outgroup Astatotilapia species.</p>
      <p id="Par61">In the “Basic statistics” tab, the inbreeding coefficient (F) of each sample estimated based on the expected and observed individual heterozygosity can be shown in the grouped bar chart and line plot (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10, Run F in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). These multiple subplots can be displayed by selecting the “Method-of-moments F coefficient estimates” report for the “After filtering” dataset on the “Basic statistics” tab. For most samples, the observed number of heterozygous genotypes was significantly lower than the expected number of heterozygous genotypes, and these values were approximately equal in few samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). Conversely, the observed number of homozygous genotypes was higher than expected in most samples. The low expected heterozygosity found in this analysis indicates high homozygosity and low genetic diversity in Malawi cichlids [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
      <p id="Par62">Given the information on sampling locations, we divided the samples into 17 groups according to their geographic locations (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7 for details). We also grouped the samples into seven eco-morphological groups in the same way as described in the article [<xref ref-type="bibr" rid="CR37">37</xref>] and in an additional “outgroup Astatotilapia” (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7 for details). By applying these two sets of groups, we analyzed the same input dataset using the same filtering and pruning parameters. The PCA plots for PC1 and PC2 obtained from these runs are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11 (Run F in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3, 17 groups) and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12 (Run G in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3, eight groups). The groups separated from each other by the first and second PCs correlated well with the eco-morphological groups indicated by colors (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12). In contrast, positions in the PCA plot and sampling locations were not correlated, possibly because the species used in the case study belonged to different genera and were genetically diverged despite living in the same region (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11). However, when examining individuals only from the species Astatotilapia calliptera of the genus Astatotilapia, the PCA plot showed some association between genetic similarity among these individuals and sampling locations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13). The PCA plot shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13 is an enlarged view of the region shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11, indicated by an oval in the upper-right corner. All samples from this region belonged to the Astatotilapia calliptera species, as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12 (indicated by ①).</p>
      <p id="Par63">It is interesting to note that individuals from the A. calliptera species group from the Lake Malawi catchment (green) are closer to individuals from the mbuna group (red) compared to those from the “outgroup Astatotilapia” (orange) that belonged to the same species of A. calliptera but were sampled from outside Lake Malawi (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12). This is in agreement with the observations of Malinsky et al. [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
      <p id="Par64">We ran PSReliP on the samples without “outgroup Astatotilapia” (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12 ②) and compared the results of PCA with those of Malinsky et al. [<xref ref-type="bibr" rid="CR37">37</xref>] (Fig. <xref rid="Fig9" ref-type="fig">9</xref>, Run H in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3).<fig id="Fig9"><label>Fig. 9</label><caption><p>Principal Components Analysis (PCA) of genome-wide genetic variant data of Malawi cichlids. The parameters used are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run H). The interactive two-component PCA plot displaying the first and second principal components (PC1/PC2) for 109 accessions of Malawi cichlids, with data point colors corresponding to seven eco-morphological groups</p></caption><graphic xlink:href="12859_2023_5169_Fig9_HTML" id="MO9"/></fig></p>
      <p id="Par65">The results were in agreement in terms of the distribution of groups relative to each other and to both axes of the PCs, the values of eigenvectors, and the percentage of variance explained by each component. For example, PC1 explained 9.7% of the variance in our case (7.9% in Malinsky et al. [<xref ref-type="bibr" rid="CR37">37</xref>]), whereas PC2 explained 4.2% of the variance in both cases. We also created pairwise PCA plots of the top 3–10 PCs for 109 accessions of Malawi cichlids (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14a–d) and found that our results were similar to those reported by Malinsky et al. [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
      <p id="Par66">A comparison of the FST values obtained from the two runs (Runs H and I in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3) with those presented by Malinsky et al. [<xref ref-type="bibr" rid="CR37">37</xref>] showed that the FST values between the A. calliptera group and other groups shown in Malinsky et al. [<xref ref-type="bibr" rid="CR37">37</xref>] were between the values obtained from the two runs (Table <xref rid="Tab2" ref-type="table">2</xref>). Regarding the FST values between other groups, the values presented by Malinsky et al. [<xref ref-type="bibr" rid="CR37">37</xref>] were slightly lower than the values we obtained for the data pruned for LD (Run H in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Pairwise Hudson's FST between groups in the dataset of genetic variants of Malawi cichlids</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">POP1</th><th align="left">POP2</th><th align="left">HUDSON_FST<sup>a</sup></th><th align="left">HUDSON_FST (LD pruned variants set<sup>b</sup>)</th></tr></thead><tbody><tr><td align="left">Astatotilapia_calliptera</td><td align="left">deep_benthic</td><td char="." align="char">0.319</td><td char="." align="char">0.216</td></tr><tr><td align="left">Astatotilapia_calliptera</td><td align="left">Diplotaxodon</td><td char="." align="char">0.416</td><td char="." align="char">0.338</td></tr><tr><td align="left">Astatotilapia_calliptera</td><td align="left">mbuna</td><td char="." align="char">0.278</td><td char="." align="char">0.217</td></tr><tr><td align="left">Astatotilapia_calliptera</td><td align="left">Rhamphochromis</td><td char="." align="char">0.507</td><td char="." align="char">0.451</td></tr><tr><td align="left">Astatotilapia_calliptera</td><td align="left">shallow_benthic</td><td char="." align="char">0.308</td><td char="." align="char">0.197</td></tr><tr><td align="left">Astatotilapia_calliptera</td><td align="left">utaka</td><td char="." align="char">0.350</td><td char="." align="char">0.250</td></tr><tr><td align="left">deep_benthic</td><td align="left">Diplotaxodon</td><td char="." align="char">0.283</td><td char="." align="char">0.241</td></tr><tr><td align="left">deep_benthic</td><td align="left">mbuna</td><td char="." align="char">0.262</td><td char="." align="char">0.230</td></tr><tr><td align="left">deep_benthic</td><td align="left">Rhamphochromis</td><td char="." align="char">0.416</td><td char="." align="char">0.359</td></tr><tr><td align="left">deep_benthic</td><td align="left">shallow_benthic</td><td char="." align="char">0.103</td><td char="." align="char">0.081</td></tr><tr><td align="left">deep_benthic</td><td align="left">utaka</td><td char="." align="char">0.135</td><td char="." align="char">0.106</td></tr><tr><td align="left">Diplotaxodon</td><td align="left">mbuna</td><td char="." align="char">0.354</td><td char="." align="char">0.317</td></tr><tr><td align="left">Diplotaxodon</td><td align="left">Rhamphochromis</td><td char="." align="char">0.477</td><td char="." align="char">0.402</td></tr><tr><td align="left">Diplotaxodon</td><td align="left">shallow_benthic</td><td char="." align="char">0.300</td><td char="." align="char">0.261</td></tr><tr><td align="left">Diplotaxodon</td><td align="left">utaka</td><td char="." align="char">0.312</td><td char="." align="char">0.260</td></tr><tr><td align="left">mbuna</td><td align="left">Rhamphochromis</td><td char="." align="char">0.461</td><td char="." align="char">0.425</td></tr><tr><td align="left">mbuna</td><td align="left">shallow_benthic</td><td char="." align="char">0.258</td><td char="." align="char">0.224</td></tr><tr><td align="left">mbuna</td><td align="left">utaka</td><td char="." align="char">0.290</td><td char="." align="char">0.253</td></tr><tr><td align="left">Rhamphochromis</td><td align="left">shallow_benthic</td><td char="." align="char">0.417</td><td char="." align="char">0.360</td></tr><tr><td align="left">Rhamphochromis</td><td align="left">utaka</td><td char="." align="char">0.456</td><td char="." align="char">0.390</td></tr><tr><td align="left">shallow_benthic</td><td align="left">utaka</td><td char="." align="char">0.143</td><td char="." align="char">0.118</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Data were not pruned for LD and the—maf value was set to 0.01 (Run I in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3)</p><p><sup>b</sup>The parameters used are listed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3 (Run H)</p></table-wrap-foot></table-wrap></p>
      <p id="Par67">Thus, we conclude that the results obtained by our pipeline are consistent with those shown in the original study, which confirms the ability of our pipeline to perform reliable analyses.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion</title>
    <p id="Par68">Understanding PS and CR is important in many application areas, including population genetics research, GWAS, and GS. There are several examples in the literature in which tools or pipelines have been created to visualize PC and/or CR after performing appropriate analyses based on genetic variant data. Steinig et al. [<xref ref-type="bibr" rid="CR40">40</xref>] have developed “NETVIEW P” that is a comprehensive implementation of NETVIEW (the network analysis and visualization pipeline, Neuditschko et al. [<xref ref-type="bibr" rid="CR41">41</xref>]) in Python. NETVIEW P combines data QC with the construction of population networks that can efficiently visualize the genetic structure within and between populations, including relationships and structure at the family level. In the NETVIEW P tool, the parameters and options can be set via the command line, and the input formats are the PED and MAP files from the PLINK software or a simple SNP matrix. The final network visualizations were based on the layouts provided by Cytoscape (<ext-link ext-link-type="uri" xlink:href="https://cytoscape.org/">https://cytoscape.org/</ext-link>), and the final network files were loaded into a compatible visualization platform.</p>
    <p id="Par69">Another example of such tools is “KinVis” [<xref ref-type="bibr" rid="CR42">42</xref>], which was designed to analyze GWAS input data to identify relatedness. The KinVis tool was developed as an R-Shiny application; in this respect, it is similar to the implementation of the visualization stage of our pipeline. However, KinVis differs from our pipeline in terms of the types of analyses performed, their implementation, and the functions offered to the users.</p>
    <p id="Par70">In contrast to the tools mentioned above, in our pipeline, QC and a wide range of analyses such as PCA, MDS, Wright's FST estimation, calculation of IBS and GRM, inbreeding and kinship coefficient estimation, and some other calculations for the analysis process are executed in the same single workflow using PLINK software as well as the in-house shell scripts and PERL programs for data pipelining.</p>
    <p id="Par71">However, combining such diverse analyses in one workflow has its own challenges because different filtering criteria and, accordingly, different sets of genetic variants are considered optimal for different analyses. For example, for some analyses used in GWAS, such as IBD Estimation, inbreeding coefficient estimation (f), and PCA, better results can be obtained by selecting and analyzing markers that are not in LD with each other [<xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>]. Hence, LD-based pruning is effective in these types of analyses.</p>
    <p id="Par72">However, LD-based pruning is not recommended for some kinship estimation methods, such as the estimation of KING-robust kinship [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par73">Regarding FST estimation, an inappropriate choice of criteria for the selection of genetic variants can lead to different FST values, particularly in cases where the population harbors a large number of rare variants [<xref ref-type="bibr" rid="CR22">22</xref>], and LD-based pruned data underestimates FST values [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
    <p id="Par74">With our pipeline, users can set criteria for filtering and pruning samples and genetic variants by modifying parameters and performing the analysis multiple times, thereby overcoming these challenges. Visualization of the results of the various analyses is also performed by a single interactive web application implemented in R using the Shiny, Plotly, and other packages. Using the interactive features of Plotly inside a Shiny app allows researchers and developers to quickly create various visualizations commonly used in bioinformatics, such as dendrograms, heatmaps, Manhattan, volcano plots, etc., and publish or share them as an interactive web application.</p>
    <p id="Par75">The visualization stage of our pipeline allows users to view detailed analysis results in a web browser in the form of interactive tables, plots, and charts, which helps them quickly understand and interpret their data and decide which approaches are best for downstream analysis.</p>
    <p id="Par76">In this paper, we described the application of PSReliP in genome-wide genetic variant data of rice varieties and Malawi cichlids. While sample sizes of the two case studies were relatively small, PSReliP pipeline can handle larger dataset and data created in the pipeline can be directly used for downstream analysis such as GWAS (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 6 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S15–S19). Our pipeline not only allows users to analyze PS and CR in the target population but also helps conduct further molecular genetics studies.</p>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par77">In this study, we developed a computational and visualization pipeline that enables users to infer PS and estimate CR at high speeds and to visualize processed input and output data interactively. To build the pipeline, existing software and R packages, such as PLINK, Shiny, Plotly, and others, were used together with our self-written programs and scripts. In addition, various parameters were prepared using PSReliP for analysis and visualization processes. Therefore, it is expected that by changing the parameters and repeatedly performing the corresponding analysis, it will be easier to select a suitable set of variants and samples and the most appropriate PCA and kinship coefficients for further use in downstream analyses, including GWAS and GS. To facilitate this process, PSReliP provides the functionality to download all the original PLINK results as ZIP files, in addition to the ability to download tables, plots, and charts of the analyzed data as image files. To validate PSReliP, investigate its performance, and illustrate its various features, we conducted case studies on rice and Malawi cichlid accessions. The findings from these case studies demonstrate the ability of the proposed pipeline to correctly estimate PS and CR in the datasets provided. Designed as an integrated platform for data analysis and visualization, we hope that this pipeline becomes a useful tool for analyzing genome-wide genetic variant data (single-nucleotide polymorphisms and small insertions and deletions) to identify PS and CR and help avoid potential problems associated with them that may arise in further analysis.</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p id="Par78">Project name: PSReliP.</p>
    <p id="Par79">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/solelena/PSReliP">https://github.com/solelena/PSReliP</ext-link></p>
    <p id="Par80">Operating system(s): Linux-based operating systems.</p>
    <p id="Par81">Programming language: Bash, R, Perl.</p>
    <p id="Par82">Tool: PLINK 1.9: 2 Apr 2022 or later, PLINK 2.0: 24 Oct 2022 or later.</p>
    <p id="Par83">R and R packages: R (3.6 +), shiny (1.4.0.2+), plotly (4.9.2.1+), manhattanly (0.2.0+), heatmaply (1.1.0+), ggplot2 (3.3.0+), DT (0.16+), stringr (1.4.0).</p>
    <p id="Par84">Web browsers: Google Chrome, Mozilla Firefox, and Microsoft Edge.</p>
    <p id="Par85">License: GNU GPL v3.0</p>
    <p id="Par86">Any restrictions to use by non-academics: license needed.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5169_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1</bold>. <bold>Notes 1-6.</bold> Detailed information about the datasets used, all stages of data analysis and visualisation, their implementation and the user interface.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5169_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2</bold>. <bold>Tables S1-S7.</bold> Detailed information about the parameters used in the pipeline configuration file, the parameter values and the required time to analyze example datasets, and the accession numbers for data used in the case studies.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BCF</term>
        <def>
          <p id="Par4">Binary variant call format</p>
        </def>
      </def-item>
      <def-item>
        <term>CR</term>
        <def>
          <p id="Par5">Cryptic relatedness</p>
        </def>
      </def-item>
      <def-item>
        <term>FST</term>
        <def>
          <p id="Par6">Fixation Index</p>
        </def>
      </def-item>
      <def-item>
        <term>GRM</term>
        <def>
          <p id="Par7">Genomic relationship matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>GS</term>
        <def>
          <p id="Par8">Genomic selection</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par9">Genome-Wide Association Studies</p>
        </def>
      </def-item>
      <def-item>
        <term>IBS</term>
        <def>
          <p id="Par10">Identity-by-state</p>
        </def>
      </def-item>
      <def-item>
        <term>IBD</term>
        <def>
          <p id="Par11">Identity-by-descent</p>
        </def>
      </def-item>
      <def-item>
        <term>LD</term>
        <def>
          <p id="Par12">Linkage disequilibrium</p>
        </def>
      </def-item>
      <def-item>
        <term>MDS</term>
        <def>
          <p id="Par13">Multidimensional scaling</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par14">Principal components analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>PCs</term>
        <def>
          <p id="Par15">Principal components</p>
        </def>
      </def-item>
      <def-item>
        <term>PS</term>
        <def>
          <p id="Par16">Population structure</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p id="Par17">Variant call format</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This study was supported by a grant from the Ministry of Agriculture, Forestry and Fisheries of Japan [Smart-breeding system for Innovative Agriculture] (BAC1001).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>ES and HS designed the pipeline. ES implemented the pipeline, performed the analyses, and drafted the manuscript. HS supervised this study and revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The documentation and the source code of PSReliP are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/solelena/PSReliP">https://github.com/solelena/PSReliP</ext-link>. Detailed instructions on installing the pipeline can be found in the main README file of the PSReliP repository on GitHub. To prepare the datasets on rice varieties and Malawian cichlids used as input data for PSReliP, the raw sequence data in FASTQ format were downloaded from the European Nucleotide Archive (ENA) database by accession number, as listed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S4 and S5. In these tables, the ‘BioSample accession’ represents the BioSample accession numbers from the BioSample database (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/biosample/">https://www.ncbi.nlm.nih.gov/biosample/</ext-link>); the ‘BioProject accession’ represents the BioProject accession numbers from BioProject (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/">https://www.ncbi.nlm.nih.gov/bioproject/</ext-link>); and the ‘Run accession’ represents the SRA accession numbers from the Sequence Read Archive (SRA) based on the source database (SRA, European Bioinformatics Institute (EBI), or DNA Data Bank of Japan (DDBJ)). The SRA run accessions that were used for to create the dataset of rice varieties: DRR018360, DRR018358, DRR018356–DRR018357, DRR018359, DRR018355, DRR008446–DRR008447, DRR001185, DRR000719–DRR000720, DRR003661, DRR003656–DRR003657, DRR003660, DRR003652, DRR003655, DRR003650–DRR003651, DRR003659, DRR003653–DRR003654, DRR003648–DRR003649, DRR003658, DRR004451–DRR004453, DRR125602, DRR054198, DRR054216, DRR099981–DRR099990, DRR093954–DRR093956, DRR093959, DRR093961–DRR093970, DRR092498, DRR092500, DRR128976–DRR128981, ERR2240123–ERR2240128, ERR2241054–ERR2241058, ERR2241060, ERR2242620–ERR2242626, ERR2245512–ERR2245513, ERR2245515–ERR2245520, ERR2245522–ERR2245525, ERR2245527–ERR2245529, ERR2245533–ERR2245540, ERR2245542–ERR2245544, ERR2245546–ERR2245557, ERR157947, ERR161560, ERR161567–ERR158568, ERR161564, SRR1614244, SRR546420, SRR546695, SRR921498, SRR921505, SRR923809, SRR925387, SRR933669, SRR1016473–SRR1016474, SRR1016489–SRR1016491, SRR3056468, SRR1328207, SRR1328218, SRR1328220, SRR1328233, SRR1328254, SRR1450213–SRR1450215, SRR1450217, SRR1450219, SRR1450197–SRR1450198, SRR1528301, SRR1528330, SRR1528440, SRR1528449, SRR1712585, SRR1712645–SRR1712647, SRR1712649, SRR1712651, SRR1712653, SRR1712656, SRR1712898–SRR1712901, SRR1712903–SRR1712907, SRR1712909–SRR1712910, SRR1712953, SRR1712964–SRR1712970, SRR1712971–SRR1712981, SRR3056114, SRR3056466, SRR3056278, SRR3133641, SRR5880534, SRR6166428. The SRA run accessions that were used for to create the dataset of Malawi cichlids: ERR266450–ERR266461, ERR266464–ERR266485, ERR266488–ERR266493, ERR266496–ERR266498, ERR266502, ERR266505, ERR266508–ERR266509, ERR266511, ERR266513, ERR271651, ERR271655, ERR271658–ERR271659, ERR271663, ERR271666, ERR271669, ERR271670, ERR271672, ERR271674, ERR271677–ERR271678, ERR271680, ERR271682, ERR295124–ERR295132, ERR299198–ERR299215, ERR303339–ERR303340, ERR303342–ERR303343, ERR303345–ERR303346, ERR303348–ERR303349, ERR303351–ERR303352, ERR303354–ERR303355, ERR303357–ERR303358, ERR303360–ERR303361, ERR303363–ERR303364, ERR303366–ERR303367, ERR303369–ERR303370, ERR303372–ERR303373, ERR303375–ERR303376, ERR303378–ERR303379, ERR303381–ERR303382, ERR303384–ERR303385, ERR303387–ERR303388, ERR303390–ERR303391, ERR303393–ERR303394, ERR303396–ERR303397, ERR303399–ERR303400, ERR303402–ERR303403, ERR303405–ERR303406, ERR303408–ERR303409, ERR315227–ERR315228, ERR315230–ERR315231, ERR315233–ERR315234, ERR702304–ERR702307, ERR715499–ERR715501, ERR702308, ERR715502–ERR715504, ERR715506–ERR715513, ERR702309, ERR715476, ERR715514–ERR715515, ERR715477, ERR715516–ERR715519, ERR715521, ERR715523–ERR715524, ERR715478–ERR715487, ERR715530–ERR715540, ERR1081365–ERR1081371, ERR1081373–ERR1081376, ERR1081378–ERR1081388, ERR1081372, ERR3634107–ERR3634110, ERR3634112–ERR3634115.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par87">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par88">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par89">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Astle</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Population structure and cryptic relatedness in genetic association studies</article-title>
        <source>Stat Sci</source>
        <year>2009</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>451</fpage>
        <lpage>471</lpage>
        <pub-id pub-id-type="doi">10.1214/09-STS307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Plenge</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Weinblatt</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Shadick</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <issue>8</issue>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1847</pub-id>
        <?supplied-pmid 16862161?>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Chang C. PLINK 1.90 beta. 2022. <ext-link ext-link-type="uri" xlink:href="https://www.cog-genomics.org/plink/1.9/">https://www.cog-genomics.org/plink/1.9/</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Chang C. PLINK 2.00 alpha. 2022. <ext-link ext-link-type="uri" xlink:href="https://www.cog-genomics.org/plink/2.0/">https://www.cog-genomics.org/plink/2.0/</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Westlake University: Yang Lab. GCTA: a tool for genome-wide complex trait analysis (2021). <ext-link ext-link-type="uri" xlink:href="https://yanglab.westlake.edu.cn/software/gcta/#Overview">https://yanglab.westlake.edu.cn/software/gcta/#Overview</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>
        <source>Am J Hum Genet</source>
        <year>2011</year>
        <volume>88</volume>
        <issue>1</issue>
        <fpage>76</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id>
        <?supplied-pmid 21167468?>
        <pub-id pub-id-type="pmid">21167468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hellwege</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Keaton</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Giri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Velez Edwards</surname>
            <given-names>DRV</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>TL</given-names>
          </name>
        </person-group>
        <article-title>Population stratification in genetic association studies</article-title>
        <source>Curr Protoc Hum Genet</source>
        <year>2017</year>
        <volume>95</volume>
        <issue>1</issue>
        <fpage>1.22.1</fpage>
        <lpage>1.22.23</lpage>
        <pub-id pub-id-type="doi">10.1002/cphg.48</pub-id>
        <?supplied-pmid 29044472?>
        <pub-id pub-id-type="pmid">29044472</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>da Silva Linge</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Worthington</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rawandoozi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Byrne</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Gasic</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Multi-locus genome-wide association studies reveal fruit quality hotspots in peach genome</article-title>
        <source>Front Plant Sci</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>644799</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2021.644799</pub-id>
        <?supplied-pmid 33732279?>
        <pub-id pub-id-type="pmid">33732279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>MAR</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="doi">10.1086/519795</pub-id>
        <?supplied-pmid 17701901?>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Speed</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Relatedness in the post-genomic era: is it still useful?</article-title>
        <source>Nat Rev Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>33</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3821</pub-id>
        <?supplied-pmid 25404112?>
        <pub-id pub-id-type="pmid">25404112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goudet</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
        </person-group>
        <article-title>How to estimate kinship</article-title>
        <source>Mol Ecol</source>
        <year>2018</year>
        <volume>27</volume>
        <issue>20</issue>
        <fpage>4121</fpage>
        <lpage>4135</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.14833</pub-id>
        <?supplied-pmid 30107060?>
        <pub-id pub-id-type="pmid">30107060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Chen WM. KING tutorial: relationship inference. In: KING: Kinship-Based INference for Gwas. 2021. <ext-link ext-link-type="uri" xlink:href="https://www.kingrelatedness.com/manual.shtml">https://www.kingrelatedness.com/manual.shtml</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manichaikul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mychaleckyj</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Rich</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sale</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Robust relationship inference in genome-wide association studies</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>22</issue>
        <fpage>2867</fpage>
        <lpage>2873</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq559</pub-id>
        <?supplied-pmid 20926424?>
        <pub-id pub-id-type="pmid">20926424</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Sul</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Service</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Freimer</surname>
            <given-names>NB</given-names>
          </name>
          <name>
            <surname>Sabatti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>42</volume>
        <issue>4</issue>
        <fpage>348</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.548</pub-id>
        <?supplied-pmid 20208533?>
        <pub-id pub-id-type="pmid">20208533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>GX</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>Genetic studies: the linear mixed models in genome-wide association studies</article-title>
        <source>TOBIOIJ</source>
        <year>2013</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.2174/1875036201307010027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>New approaches to population stratification in genome-wide association studies</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>459</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2813</pub-id>
        <?supplied-pmid 20548291?>
        <pub-id pub-id-type="pmid">20548291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pressoir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Briggs</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Vroh Bi</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Yamasaki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doebley</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>203</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1702</pub-id>
        <?supplied-pmid 16380716?>
        <pub-id pub-id-type="pmid">16380716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Windhausen</surname>
            <given-names>VS</given-names>
          </name>
          <name>
            <surname>Atlin</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Hickey</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Crossa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jannink</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Sorrells</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Effectiveness of genomic prediction of maize hybrid performance in different breeding populations and environments</article-title>
        <source>G3 Bethesda</source>
        <year>2012</year>
        <volume>2</volume>
        <issue>11</issue>
        <fpage>1427</fpage>
        <lpage>1436</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.112.003699</pub-id>
        <?supplied-pmid 23173094?>
        <pub-id pub-id-type="pmid">23173094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Dekkers</surname>
            <given-names>JCM</given-names>
          </name>
        </person-group>
        <article-title>The impact of genetic relationship information on genome-assisted breeding values</article-title>
        <source>Genetics</source>
        <year>2007</year>
        <volume>177</volume>
        <issue>4</issue>
        <fpage>2389</fpage>
        <lpage>2397</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.107.081190</pub-id>
        <?supplied-pmid 18073436?>
        <pub-id pub-id-type="pmid">18073436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Werner</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Gaynor</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Gorjanc</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hickey</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Kox</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Abbadi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>How population structure impacts genomic selection accuracy in cross-validation: implications for practical breeding</article-title>
        <source>Front Plant Sci</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>592977</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2020.592977</pub-id>
        <?supplied-pmid 33391305?>
        <pub-id pub-id-type="pmid">33391305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holsinger</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
        </person-group>
        <article-title>Genetics in geographically structured populations: defining, estimating and interpreting F(ST)</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>9</issue>
        <fpage>639</fpage>
        <lpage>650</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2611</pub-id>
        <?supplied-pmid 19687804?>
        <pub-id pub-id-type="pmid">19687804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhatia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sankararaman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Estimating and interpreting FST: the impact of rare variants</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>9</issue>
        <fpage>1514</fpage>
        <lpage>1521</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.154831.113</pub-id>
        <?supplied-pmid 23861382?>
        <pub-id pub-id-type="pmid">23861382</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Cockerham</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Estimating F-statistics for the analysis of population structure</article-title>
        <source>Evolution</source>
        <year>1984</year>
        <volume>38</volume>
        <issue>6</issue>
        <fpage>1358</fpage>
        <lpage>1370</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1558-5646.1984.tb05657.x</pub-id>
        <?supplied-pmid 28563791?>
        <pub-id pub-id-type="pmid">28563791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ochoa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Estimating FST and kinship for arbitrary population structures</article-title>
        <source>PLOS Genet</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>e1009241</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1009241</pub-id>
        <?supplied-pmid 33465078?>
        <pub-id pub-id-type="pmid">33465078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leutenegger</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Prum</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Génin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Verny</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lemainque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clerget-Darpoux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the inbreeding coefficient through use of genomic data</article-title>
        <source>Am J Hum Genet</source>
        <year>2003</year>
        <volume>73</volume>
        <issue>3</issue>
        <fpage>516</fpage>
        <lpage>523</lpage>
        <pub-id pub-id-type="doi">10.1086/378207</pub-id>
        <?supplied-pmid 12900793?>
        <pub-id pub-id-type="pmid">12900793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousset</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Inbreeding and relatedness coefficients: what do they measure?</article-title>
        <source>Heredity</source>
        <year>2002</year>
        <volume>88</volume>
        <issue>5</issue>
        <fpage>371</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.hdy.6800065</pub-id>
        <?supplied-pmid 11986874?>
        <pub-id pub-id-type="pmid">11986874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Tellier</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Vattikuti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Purcell</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>
        <source>GigaScience</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0047-8</pub-id>
        <?supplied-pmid 25722852?>
        <pub-id pub-id-type="pmid">25722852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development of interactive biological web applications with R/Shiny</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>bbab415</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab415</pub-id>
        <?supplied-pmid 34642739?>
        <pub-id pub-id-type="pmid">34642739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nusrat</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harbig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gehlenborg</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Tasks, techniques, and tools for genomic data visualization</article-title>
        <source>Comput Graph Forum</source>
        <year>2019</year>
        <volume>38</volume>
        <issue>3</issue>
        <fpage>781</fpage>
        <lpage>805</lpage>
        <pub-id pub-id-type="doi">10.1111/cgf.13727</pub-id>
        <?supplied-pmid 31768085?>
        <pub-id pub-id-type="pmid">31768085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">RStudio, PBC: Shiny (2022). <ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/products/shiny/">https://www.rstudio.com/products/shiny/</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">RStudio, PBC: Shiny from RStudio (2020). <ext-link ext-link-type="uri" xlink:href="https://shiny.rstudio.com/">https://shiny.rstudio.com/</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Plotly. Plotly R Open source graphing Library (2022). <ext-link ext-link-type="uri" xlink:href="https://plotly.com/r/">https://plotly.com/r/</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tilford</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Neuhaus</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mintier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Feder</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Kirov</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CRISPR-DAV: CRISPR NGS data analysis and visualization pipeline</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>23</issue>
        <fpage>3811</fpage>
        <lpage>3812</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx518</pub-id>
        <?supplied-pmid 28961906?>
        <pub-id pub-id-type="pmid">28961906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buza</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Tonui</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stomeo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tiambo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Katani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Imap: an integrated bioinformatics and visualization pipeline for microbiome data analysis</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>374</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-2965-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">National Agriculture and Food Research Organization: Rice Annotation Project Database (RAP-DB) (2017). <ext-link ext-link-type="uri" xlink:href="https://rapdb.dna.affrc.go.jp">https://rapdb.dna.affrc.go.jp</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Numa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kawahara</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rice annotation project database (RAP-DB): an integrative and interactive database for rice genomics</article-title>
        <source>Plant Cell Physiol</source>
        <year>2013</year>
        <volume>54</volume>
        <issue>2</issue>
        <fpage>e6</fpage>
        <pub-id pub-id-type="doi">10.1093/pcp/pcs183</pub-id>
        <?supplied-pmid 23299411?>
        <pub-id pub-id-type="pmid">23299411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malinsky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Svardal</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tyers</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Miska</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Genner</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome sequences of Malawi cichlids reveal multiple radiations interconnected by gene flow</article-title>
        <source>Nat Ecol Evol</source>
        <year>2018</year>
        <volume>2</volume>
        <issue>12</issue>
        <fpage>1940</fpage>
        <lpage>1955</lpage>
        <pub-id pub-id-type="doi">10.1038/s41559-018-0717-x</pub-id>
        <?supplied-pmid 30455444?>
        <pub-id pub-id-type="pmid">30455444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kawahara</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>de la Bastide</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Kanamori</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>McCombie</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improvement of the <italic>Oryza sativa</italic> Nipponbare reference genome using next generation sequence and optical map data</article-title>
        <source>Rice (N Y)</source>
        <year>2013</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>4</fpage>
        <pub-id pub-id-type="doi">10.1186/1939-8433-6-4</pub-id>
        <?supplied-pmid 24280374?>
        <pub-id pub-id-type="pmid">24280374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conte</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kocher</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>An improved genome reference for the African cichlid, <italic>Metriaclima zebra</italic></article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>724</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1930-5</pub-id>
        <?supplied-pmid 26394688?>
        <pub-id pub-id-type="pmid">26394688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinig</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Neuditschko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khatkar</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Raadsma</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Zenger</surname>
            <given-names>KR</given-names>
          </name>
        </person-group>
        <article-title>Netview p: a network visualization tool to unravel complex population structure using genome-wide SNPs</article-title>
        <source>Mol Ecol Resour</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>216</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="doi">10.1111/1755-0998.12442</pub-id>
        <?supplied-pmid 26129944?>
        <pub-id pub-id-type="pmid">26129944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neuditschko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khatkar</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Raadsma</surname>
            <given-names>HW</given-names>
          </name>
        </person-group>
        <article-title>NetView: a high-definition network-visualization approach to detect fine-scale population structures from genome-wide patterns of variation</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>10</issue>
        <fpage>e48375</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0048375</pub-id>
        <?supplied-pmid 23152744?>
        <pub-id pub-id-type="pmid">23152744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ullah</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aupetit</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Patil</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Al Muftah</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Rawi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Saad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bensmail</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>KinVis: a visualization tool to detect cryptic relatedness in genetic datasets</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>15</issue>
        <fpage>2683</fpage>
        <lpage>2685</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1028</pub-id>
        <?supplied-pmid 30590437?>
        <pub-id pub-id-type="pmid">30590437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malomane</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Reimer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weigend</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weigend</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sharifi</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Simianer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Efficiency of different strategies to mitigate ascertainment bias when using SNP panels in diversity studies</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-4416-9</pub-id>
        <?supplied-pmid 29304727?>
        <pub-id pub-id-type="pmid">29304727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Double Helix Inc, The Golden Helix Blog: Determining the best LD Pruning options (2016). <ext-link ext-link-type="uri" xlink:href="http://blog.goldenhelix.com/jbartole/determining-best-ld-pruning-options/">http://blog.goldenhelix.com/jbartole/determining-best-ld-pruning-options/</ext-link>. Accessed 9 Feb 2022.</mixed-citation>
    </ref>
  </ref-list>
</back>
