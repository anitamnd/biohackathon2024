<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3018818</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq635</article-id>
    <article-id pub-id-type="publisher-id">btq635</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Control-free calling of copy number alterations in deep-sequencing data using GC-content normalization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zinovyev</surname>
          <given-names>Andrei</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bleakley</surname>
          <given-names>Kevin</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vert</surname>
          <given-names>Jean-Philippe</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Janoueix-Lerosey</surname>
          <given-names>Isabelle</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Delattre</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barillot</surname>
          <given-names>Emmanuel</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Institut Curie, <sup>2</sup>INSERM, U900, Paris, F-75248, <sup>3</sup>Mines ParisTech, Fontainebleau, F-77300 and <sup>4</sup>INSERM, U830, Paris, F-75248 France</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>11</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>11</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>2</issue>
    <fpage>268</fpage>
    <lpage>269</lpage>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>6</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>10</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>11</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> We present a tool for control-free copy number alteration (CNA) detection using deep-sequencing data, particularly useful for cancer studies. The tool deals with two frequent problems in the analysis of cancer deep-sequencing data: absence of control sample and possible polyploidy of cancer cells. FREEC (control-FREE Copy number caller) automatically normalizes and segments copy number profiles (CNPs) and calls CNAs. If ploidy is known, FREEC assigns absolute copy number to each predicted CNA. To normalize raw CNPs, the user can provide a control dataset if available; otherwise GC content is used. We demonstrate that for Illumina single-end, mate-pair or paired-end sequencing, GC-contentr normalization provides smooth profiles that can be further segmented and analyzed in order to predict CNAs.</p>
      <p><bold>Availability:</bold> Source code and sample data are available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo-out.curie.fr/projects/freec/">http://bioinfo-out.curie.fr/projects/freec/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>freec@curie.fr</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq635/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>In many studies that apply deep sequencing to cancer genomes, one has to calculate copy number profiles (CNPs) and predict regions of gain and loss. There exist two frequent obstacles in the analysis of cancer genomes: absence of an appropriate control sample for normal tissue and possible polyploidy. Most current tools do not take these points into account (Supplementary Table 1). For various reasons, sequencing of an appropriate control sample is not always possible. There is therefore a need for a bioinformatics tool able to automatically detect copy number alterations (CNAs) without use of a control dataset. Several programs have been published that allow automatic calculation and analysis of CNPs (<xref ref-type="bibr" rid="B4">Chiang <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B7">Xie and Tammi, 2009</xref>). However, both CNV-seq (<xref ref-type="bibr" rid="B7">Xie and Tammi, 2009</xref>) and SegSeq (<xref ref-type="bibr" rid="B4">Chiang <italic>et al.</italic>, 2009</xref>) need datasets for the given tumor and its paired normal DNA. Moreover, both programs predict CNAs without providing information about how many copies were lost or gained. An interesting approach for predicting copy number variants was suggested by <xref ref-type="bibr" rid="B8">Yoon <italic>et al.</italic> (2009</xref>), where GC content is used to normalize data. However, to estimate the ‘normal’ copy number, they rely on the assumption that there are similar percentages of amplified and deleted regions, which is not true in general for cancer cells. Moreover, their tool was designed to analyze normal human genomes and is unable to take into account possible polyploidy.</p>
    <p>Here, we propose an algorithm to call CNAs with or without a control sample. The algorithm is implemented in the C++ program FREEC (control-FREE Copy number caller). FREEC uses a sliding window approach to calculate read count (RC) in non-overlapping windows (raw CNP). Then, if a control sample is available, the program normalizes raw CNP using the control profile. Otherwise, the program calculates GC content in the same set of windows and performs normalization by GC content. Since this removes a major source of variability in raw CNPs (<xref ref-type="bibr" rid="B4">Chiang <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B8">Yoon <italic>et al.</italic>, 2009</xref>), the resulting normalized profile becomes sufficiently smooth to apply segmentation. This is followed by the analysis of predicted regions of gains and losses in order to assign copy numbers to these regions.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <p>The algorithm includes several steps. First, it calculates the raw CNP by counting reads in non-overlapping windows. If not provided by the user, window size can be automatically selected using depth of coverage information to optimize accuracy of CNA prediction. The second step is profile normalization. If a control is not provided by the user, we compute the GC-content profile. The normalization procedure of RC by GC content (or by control RC) is described below. The third step is segmentation of the normalized CNP. To do this, we implemented a LASSO-based algorithm suggested by <xref ref-type="bibr" rid="B5">Harchaoui and Lévy-Leduc (2008</xref>). Segmentation provided by this algorithm is robust against outliers, which makes it suitable for segmentation of deep-sequencing CNPs. The last step involves analysis of segmented profiles. This includes identification of regions of genomic gains and losses and prediction of copy number changes in these regions.</p>
    <p>To normalize a raw CNP, we fit the observed RC by the GC content (or the control RC if it is available). We base our fitted model on several assumptions: (i) the sample main ploidy <italic>P</italic> is provided, (ii) the observed RC in <italic>P</italic>-copy regions (i.e. regions with copy number equal to <italic>P</italic>) can be modeled as a polynomial of GC content (or of control RC), (iii) the observed RC in a region with altered copy number is linearly proportional to the RC in <italic>P</italic>-copy regions and (iv) the interval of measured GC contents (respectively control RCs when a control dataset is available) in the <italic>main ploidy regions</italic> must include the interval of <italic>all</italic> measured GC contents (respectively control RC). The polynomial's degree is a user-defined parameter with a default value of three. We provide an initial estimate of the polynomial's parameters and then optimize these parameters by iteratively selecting data points related to <italic>P</italic>-copy regions and making a least-square fit on these points only (See Supplementary Methods for more details). The resulting polynomial is then used to normalize the CNP (<xref ref-type="fig" rid="F1">Fig. 1</xref>). The user has an option to include mappability information into the normalization procedure (See Supplementary Methods).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Normalization of CNPs using only information about average GC content in a window. (<bold>A</bold>–<bold>D</bold>) GC content versus RC in 50 kb windows for COLO-829BL (normal diploid genome), COLO-829, NCI-H2171 and HCC1143, respectively. The result of the least-square fit for <italic>P</italic>-copy regions is shown in black. Curves corresponding to other frequent copy numbers are shown in gray. Values of copy numbers are given at the right of each panel. Chromosomes X and Y were not included. (<bold>E–H</bold>) GC-content normalized CNPs for chromosome 1 for COLO-829BL, COLO-829, NCI-H2171 and HCC1143, respectively. Automatically predicted copy numbers are shown in black.</p></caption><graphic xlink:href="btq635f1"/></fig></p>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <p>We applied the method to predict CNAs in mate-pair datasets for the melanoma cell line COLO-829 and matched normal cell line COLO-829BL (<xref ref-type="bibr" rid="B6">Pleasance <italic>et al.</italic>, 2010</xref>), a paired-end dataset for the small-cell lung cancer cell line NCI-H2171 (<xref ref-type="bibr" rid="B3">Campbell <italic>et al.</italic>, 2008</xref>) and a single-end dataset for the breast cancer cell line HCC1143 (<xref ref-type="bibr" rid="B4">Chiang <italic>et al.</italic>, 2009</xref>). All four samples were sequenced using the Illumina Genome Analyzer platform. The number of reads in samples varied from 14 to 20 million (Supplementary Table 2).</p>
    <p>The polynomial fit by GC content explained well the observed RC (<xref ref-type="fig" rid="F1">Fig. 1</xref>A–D). Using CNPs normalized by GC content, we identified regions of gain and loss in the four samples (<xref ref-type="fig" rid="F1">Fig. 1</xref>E–H, Supplementary <xref ref-type="fig" rid="F1">Fig. 1</xref>–4). We also assessed true positive and false positive rate for a normal diploid sample NA18507 (<xref ref-type="bibr" rid="B1">Alkan <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B2">Bentley <italic>et al.</italic>, 2008</xref>; Supplemenary Table 3).</p>
    <p>We compared FREEC with three other existing tools: CNV-seq, SegSeq and RDXplorer (Supplementary Tables 1 and 4). As well as providing other additional functionalities, FREEC understands more input formats than any other tool. It can be used to analyze data produced for any organism and for polyploid genomes. Being implemented in C++, FREEC shows excellent performance and operating system portability.</p>
  </sec>
  <sec sec-type="conclusions" id="SEC4">
    <title>4 CONCLUSION</title>
    <p>We have presented a tool for automatic detection of CNAs and calculation of CNA frequency. FREEC provides more functionalities than existing tools; in particular, it can deal with the situation when no control experiment is available and when the genome is polyploid, frequent problems in cancer studies. The main steps are (i) normalization of the CNP using GC content (or control CNP if available), (ii) segmentation of normalized profiles and (iii) assignment of copy number changes to losses and gains. The program is fast, accurate and freely available.</p>
    <p><italic>Funding</italic>: The Ligue Nationale contre le Cancer (V.B., A.Z., E.B., I.J.-L. and O.D. are members of a labeled team).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_2_268__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btq635_boeva_SupplementaryMaterials.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Personalized copy number and segmental duplication maps using next-generation sequencing</article-title>
        <source>Nat. Genet.</source>
        <year>2009</year>
        <volume>41</volume>
        <fpage>1061</fpage>
        <lpage>1067</lpage>
        <pub-id pub-id-type="pmid">19718026</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate whole human genome sequencing using reversible terminator chemistry</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>53</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="pmid">18987734</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of somatically acquired rearrangements in cancer using genome-wide massively parallel paired-end sequencing</article-title>
        <source>Nat. Genet.</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>722</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="pmid">18438408</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiang</surname>
            <given-names>DY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution mapping of copy-number alterations with massively parallel sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>99</fpage>
        <lpage>103</lpage>
        <pub-id pub-id-type="pmid">19043412</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harchaoui</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lévy-Leduc</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Catching change-points with lasso</article-title>
        <source>Adv. Neural Inform. Process. Syst.</source>
        <year>2008</year>
        <volume>20</volume>
        <fpage>617</fpage>
        <lpage>624</lpage>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pleasance</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comprehensive catalogue of somatic mutations from a human cancer genome</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>463</volume>
        <fpage>191</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="pmid">20016485</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tammi</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>CNV-seq, a new method to detect copy number variation using high-throughput sequencing</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>80</fpage>
        <pub-id pub-id-type="pmid">19267900</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoon</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sensitive and accurate detection of copy number variants using read depth of coverage</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1586</fpage>
        <lpage>1592</lpage>
        <pub-id pub-id-type="pmid">19657104</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
