<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4919878</article-id>
    <article-id pub-id-type="publisher-id">1132</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-1132-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EmpPrior: using outside empirical data to inform branch-length priors for Bayesian phylogenetics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Andersen</surname>
          <given-names>John J.</given-names>
        </name>
        <address>
          <email>jjanders@us.ibm.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nelson</surname>
          <given-names>Bradley J.</given-names>
        </name>
        <address>
          <email>bnelsj@uw.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Brown</surname>
          <given-names>Jeremy M.</given-names>
        </name>
        <address>
          <email>jembrown@lsu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Biological Sciences and Museum of Natural Science, Louisiana State University, 202 Life Sciences Building, Baton Rouge, LA 70803 USA </aff>
      <aff id="Aff2"><label/>Present Address: IBM, 11501 Burnet Rd., Austin, TX 78758 USA </aff>
      <aff id="Aff3"><label/>Present Address: Department of Genome Sciences, University of Washington, Foege Building S-250, Seattle, WA 98195 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>253</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>2</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>6</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Branch-length parameters are a central component of phylogenetic models and of intrinsic biological interest. Default branch-length priors in some Bayesian phylogenetic software can be unintentionally informative and lead to branch- and tree-length estimates that are unreasonable. Alternatively, priors may be uninformative, but lead to diffuse posterior estimates. Despite the widespread availability of relevant datasets from other groups, biologists rarely leverage outside information to specify branch-length priors that are specific to the analysis they are conducting.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We developed the software package EmpPrior to facilitate the collection and incorporation of relevant, outside information when setting branch-length priors for phylogenetics. EmpPrior efficiently queries TreeBASE to find data that are similar to focal data, in terms of taxonomic and genetic sampling, and uses them to inform branch-length priors for the focal analysis. EmpPrior consists of two components: EmpPrior-search, written in Java to query TreeBASE, and EmpPrior-fit, written in R to parameterize branch-length distributions. In an example analysis, we show how the use of relevant, outside data is made possible by EmpPrior and improves tree-length estimates from a focal dataset.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>EmpPrior is easy to use, fast, and improves both the accuracy and precision of branch-length estimates in many circumstances. While EmpPrior’s focus is on branch lengths, the strategy it employs could easily be extended to address other prior parameterization problems in phylogenetics.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Bayesian phylogenetics</kwd>
      <kwd>Informed priors</kwd>
      <kwd>Branch lengths</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005289</institution-id>
            <institution>National Institute of Justice</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2011-DN-BX-K534</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Default branch-length priors for Bayesian phylogenetic analyses can lead to branch- and tree-length estimates that are incongruent with maximum-likelihood estimates (MLEs) [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Brown <italic>et al.</italic> [<xref ref-type="bibr" rid="CR1">1</xref>] and Rannala <italic>et al.</italic> [<xref ref-type="bibr" rid="CR3">3</xref>] investigated this issue and hypothesized that for these datasets a poorly specified prior can favor unreasonably long branch lengths and/or cause branch-length mixing problems. This behavior is troubling, because default priors are often thought to exert minimal influence on posterior estimates. In practice, the specification of non-informative priors may be essentially impossible for many parameters in phylogenetics.</p>
    <p>Brown <italic>et al.</italic> [<xref ref-type="bibr" rid="CR1">1</xref>] suggested an empirical Bayesian approach to alleviate these problems, where prior distributions are parameterized using focal data. While this method usually recovers ML tree lengths in resulting credible intervals, it has been criticized for being non-Bayesian and artificially reducing uncertainty. Rannala <italic>et al.</italic> [<xref ref-type="bibr" rid="CR3">3</xref>] proposed, and Zhang <italic>et al.</italic> [<xref ref-type="bibr" rid="CR4">4</xref>] evaluated, the use of a compound Dirichlet prior on branch- and tree-lengths that generally improves upon the default exponential branch-length prior. However, default settings did not recover the ML estimate for all datasets examined, which is problematic for non-informative priors.</p>
    <p>For many phylogenetic questions, previously collected datasets are available that use the same genes and sample similar numbers of taxa in other clades. These outside data can be leveraged to inform prior distributions for analysis of focal data sets. Some previous work has attempted to incorporate outside molecular data into phylogenetic analyses in a principled manner [<xref ref-type="bibr" rid="CR5">5</xref>], but exploration has been limited and has employed hierarchical modeling strategies not currently available in popular Bayesian phylogenetic software packages (e.g., MrBayes [<xref ref-type="bibr" rid="CR6">6</xref>] and BEAST [<xref ref-type="bibr" rid="CR7">7</xref>]).</p>
    <p>The use of outside data to parameterize prior distributions in a focal analysis is relatively straightforward in principle (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), but several procedural challenges arise in practice. First, available phylogenetic databases (e.g., TreeBase and Dryad) can be difficult to query, especially according to the criteria that might be important for establishing relevance of an outside dataset to a focal dataset (e.g., the number of taxa sampled). Also, the inclusion of branch-length information is uneven across deposited trees. Branch lengths might be missing entirely, they might have been estimated using a concatenated dataset, or an inappropriate method of inference might have been used. Second, once relevant trees with branch lengths have been obtained, no software exists to estimate relevant parameter values for the branch-length distributions that are used as priors in most Bayesian phylogenetic software. To alleviate these procedural challenges, we developed EmpPrior.<fig id="Fig1"><label>Fig. 1</label><caption><p>Flowchart for generating informed branch-length priors with EmpPrior. EmpPrior-search queries TreeBASE to find data similar to the focal data. Outside data are then used as input for maximum-likelihood (ML) tree searches. Branch-length distributions are fit to ML trees in EmpPrior-fit and parameter estimates are used to set priors for analysis of the focal data</p></caption><graphic xlink:href="12859_2016_1132_Fig1_HTML" id="MO1"/></fig></p>
    <p>Beyond the procedural challenges, the process of informing priors with relevant data also requires some judgement by the researcher. Specifically for branch lengths, relevant outside datasets should contain sequences with similar evolutionary properties to the focal dataset and should employ similar patterns of taxonomic sampling, both in the number of sequences included in analysis and in the distribution of their relatedness. EmpPrior does not obviate the need for judgement in these areas, nor should it. Establishing relevance requires expertise and serves as an opportunity for researchers to apply their knowledge of the taxa in question to improve the accuracy and precision of their results. Rather, EmpPrior serves as a toolkit to marry the available outside information contained in both existing datasets and researcher expertise.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>We developed EmpPrior to streamline the process of finding relevant, outside datasets and using them to set informed priors on branch lengths in ways consistent with the available options in widely used Bayesian phylogenetic software packages. EmpPrior consists of two components: EmpPrior-search and EmpPrior-fit (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). EmpPrior-search queries TreeBASE with a user-defined gene name (or other user-chosen search term) and restrictions on dataset size, then parses and formats returned Nexus files for ML phylogeny inference. EmpPrior-fit optimizes parameters of branch-length distributions using ML phylogenies from outside datasets. Resulting parameter estimates can be copied directly into branch-length priors in Bayesian phylogenetic software.</p>
    <p>EmpPrior-search is written in Java, so it is platform independent and requires no external dependencies. Users can supply EmpPrior-search with a list of gene name synonyms and the program will search titles and abstracts in TreeBASE for these terms. In preliminary tests, searches of the title and abstract fields gave the best tradeoff in returning a reasonable number of datasets, while maintaining their relevance to the original search terms. Nexus files associated with relevant studies will be filtered according to user-supplied maximum and minimum values for the number of sequences. EmpPrior-search will then process data files by replacing TreeBASE ambiguity codes (e.g., {A,C}) with standard International Union of Pure and Applied Chemistry (IUPAC) codes (e.g., M), removing all Nexus blocks not associated with the alignment, and, if possible, excising the gene of interest from a concatenated dataset. Processed data files are ready to be used as input for any standard ML phylogeny inference program (e.g., Garli, RAxML, PhyML).</p>
    <p>EmpPrior-search utilizes the Java Swing class library to create a graphical user interface (GUI; Fig. <xref rid="Fig2" ref-type="fig">2</xref>) in which users can supply search terms to identify relevant datasets available in TreeBase. After identifying datasets with user-specified gene names in the titles and abstracts of TreeBase entries, EmpPrior-search uses independent threads to read each Nexus file from TreeBase using its corresponding uniform resource locator (URL). After downloading, the number of taxa in each data file is compared to user specifications and datasets not in the acceptable range are deleted. Remaining files are checked for duplicate Study IDs, in case the same dataset was returned by searches with different gene name synonyms, and duplicates are deleted. Datasets are then renamed to indicate both Study ID and the gene name by which they were identified. In the case of duplicates, only the first gene synonym in the list provided by the user will be used. In situations where titles and abstracts frequently contain multiple gene name synonyms, many more datasets will be downloaded than will be kept after post-processing. Nonetheless, EmpPrior-search usually only takes a few minutes to complete the process of downloading and post-processing, even when using multiple synonyms for popular genes. After file download and processing with EmpPrior-search, the user will need to make decisions about which datasets are relevant to the focal dataset and then perform ML phylogenetic inference using their preferred software.<fig id="Fig2"><label>Fig. 2</label><caption><p>EmpPrior-search graphical user interface (GUI). The EmpPrior-search GUI allows users to specify the gene name and constraints on the number of taxa in a series of text fields at the bottom. These restrictions help to ensure that datasets returned from the search can provide relevant information to inform analysis of the focal data. A window in the middle of the GUI logs information about the progress of the TreeBase search and post-processing of datasets. A progress bar at the top provides users with a rough idea of EmpPrior-search’s progress. An optional post-processing step can be turned on with a radio button at the bottom, causing EmpPrior-search to attempt to extract the gene of interest from a multi-gene dataset. Due to inconsistencies in gene naming and data file formatting, this step can sometimes produce unreliable results. Users should always manually inspect relevant datasets to ensure that they have been parsed properly</p></caption><graphic xlink:href="12859_2016_1132_Fig2_HTML" id="MO2"/></fig></p>
    <p>EmpPrior-fit is written in R, making both components of the software platform independent. EmpPrior-fit harvests branch lengths from ML phylogenies inferred with outside datasets (from any source) and provides ML parameter estimates for common branch-length prior distributions (e.g., the exponential and compound Dirichlet). To read trees, EmpPrior-fit employs the R package ape [<xref ref-type="bibr" rid="CR8">8</xref>] and to perform ML parameter estimation it uses the bbmle package [<xref ref-type="bibr" rid="CR9">9</xref>]. Probability densities (i.e., likelihoods) for simple distributions (e.g., the exponential) employ R’s built-in functionality. Likelihoods for the compound Dirichlet are calculated according to equation 36 from Rannala <italic>et al.</italic> [<xref ref-type="bibr" rid="CR3">3</xref>]. Likelihoods are reported by EmpPrior-fit, although we caution that better fit of a particular distribution to the branch lengths estimated from an outside dataset does not necessarily mean that the same distribution has desirable properties as a prior for the analysis of a focal dataset. Other potential distributions for branch lengths can easily be added to EmpPrior-fit, should they be of interest or become available in future implementations of Bayesian phylogenetic software. All of the calculations implemented in EmpPrior-fit are fast, so even large tree sets can be rapidly processed with modest computing resources.</p>
  </sec>
  <sec id="Sec3" sec-type="discussion">
    <title>Results and discussion</title>
    <p>We ran EmpPrior-search on three gene names commonly found in phylogeographic studies (cytochrome b [using “cytb”, “cyt_b”, “cytochromeb”, and “cytochrome_b”], cytochrome oxidase I [using “COI” and “cytochrome_oxidase_I”], and ribulose-bisphosphate carboxylase [using “rbcL”]), because analyses of datasets consisting mainly of intraspecific samples seem particularly sensitive to the chosen branch-length prior. The three runs were performed on a 2.8 GHz Intel Core i7 MacBook Pro laptop and took 19 s (returning 59 datasets), 134 s (returning 93 datasets), and 135 s (returning 111 datasets), respectively.</p>
    <p>The time required to infer ML trees from outside datasets will depend on the size of the dataset and the chosen software, but will always be the slowest step in the informed prior procedure as we have framed it here. Conveniently, the ML trees that we use to fit branch-length distributions do not require support values. By avoiding the need to bootstrap, or estimate posterior probabilities, for outside datasets the time required to infer ML trees is much faster than it would be for a standard empirical analysis. However, our preliminary analyses do suggest that thorough, model-based inference of branch lengths is necessary to find fitted parameter estimates that perform well in focal analyses.</p>
    <p>Fitting branch-length distributions to ML trees with EmpPrior-fit is very fast (&lt;1 s per tree) and adds only a trivial amount of time when compared with ML tree inference. Likelihood surfaces are often smooth and unimodal for the parameters of interest (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), so EmpPrior-fit is able to robustly find maximum-likelihood estimates. To our knowledge, no other software is designed to specifically estimate the parameters of branch-length distributions, although the numerical capabilities certainly exist in other programming languages and platforms.<fig id="Fig3"><label>Fig. 3</label><caption><p>Log-likelihood surfaces for <italic>c</italic> and <italic>α</italic> of the compound Dirichlet branch-length distribution. Both log-likelihood surfaces were calculated using maximum-likelihood (ML) branch lengths based on a dataset of cytochrome <italic>b</italic> and 16S sequences from alpine newts (<italic>Mesotriton alpestris</italic>) with TreeBase Study ID S1777 [<xref ref-type="bibr" rid="CR11">11</xref>]. The left plot shows log-likelihoods based on the compound Dirichlet distribution [<xref ref-type="bibr" rid="CR3">3</xref>] for different values of the internal:external branch-length ratio (<italic>c</italic>) with all other parameters fixed. The right plot shows log-likelihoods for different values of the concentration parameter (<italic>α</italic>) with all other parameters fixed. The dashed line in each plot shows the ML estimate for each parameter returned by EmpPrior-fit</p></caption><graphic xlink:href="12859_2016_1132_Fig3_HTML" id="MO3"/></fig></p>
    <p>Some professional judgement will always be necessary to choose which of the datasets returned from EmpPrior-search would be most appropriate for informing priors used in the analysis of a focal dataset. In the context of a Bayesian analysis, the prior serves as the point where such judgement can naturally and appropriately be exercised. We are of the opinion that researchers are better equipped to judge the relevance of outside datasets that are then used to parameterize branch-length distributions, than they are to judge the appropriateness of parameter estimates directly. This difference in judgement ability may become more pronounced as preferred branch-length priors become more complex (e.g., the compound Dirichlet) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>] and employ distributions less familiar to many biologists (e.g., the Dirichlet). By exercising judgement in the choice of outside datasets, and then fitting relevant distributions to those data, our approach allows researchers to specify an informed prior in a principled manner.</p>
    <p>To demonstrate the utility of informed priors parameterized using the approach we outline, EmpPrior was used to set informed branch-length priors for a dataset of 65 mtDNA sequences (COII and 16S) from the brittle star, <italic>Astrotoma agassizii</italic>. This dataset has previously been shown to return spurious tree-length estimates under the default exponential branch-length prior in MrBayes [<xref ref-type="bibr" rid="CR2">2</xref>]. MrBayes 3.2.2 [<xref ref-type="bibr" rid="CR6">6</xref>] was used to estimate tree length under both default and informed parameterizations of the exponential and compound Dirichlet [<xref ref-type="bibr" rid="CR3">3</xref>] branch-length priors. Informed parameter estimates were based on two relevant outside datasets, each containing one of the genes in the focal dataset (COII: S2043, 16S: S1777). These datasets had a depth and pattern of sampling (intraspecific) similar to the focal data. Informed parameter values were estimated for both the exponential and compound Dirichlet distributions (with <italic>α</italic> and <italic>c</italic> estimated both singly and jointly for the compound Dirichlet). For both prior distributions and both outside datasets, tree-length estimates from informed priors were closer to the MLEs than default estimates (Table <xref rid="Tab1" ref-type="table">1</xref>). For compound Dirichlet priors with informed values of <italic>α</italic>, 95 % highest posterior density intervals of tree length included the MLE (Table <xref rid="Tab1" ref-type="table">1</xref>). Elsewhere, we describe more widespread testing of the informed prior approach and discuss its strengths and limitations [<xref ref-type="bibr" rid="CR10">10</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption><p>Default and informed tree-length estimates</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Outside Dataset</th><th><italic>λ</italic></th><th><italic>α</italic></th><th><italic>c</italic></th><th>MLE</th><th>95 % HPD</th></tr></thead><tbody><tr><td>None (default)</td><td align="center">10</td><td/><td/><td align="center">0.40</td><td align="center">[10.54–14.94]</td></tr><tr><td/><td/><td align="center">1</td><td align="center">1</td><td align="center">0.40</td><td align="center">[0.24–0.34]</td></tr><tr><td>S1777</td><td align="center">95.6</td><td/><td/><td align="center">0.40</td><td align="center">[0.83–1.25]</td></tr><tr><td/><td/><td align="center"><bold>0.12</bold></td><td align="center"><bold>1</bold></td><td align="center">0.40</td><td align="center"><bold>[0.30–0.48]</bold></td></tr><tr><td/><td/><td align="center">1</td><td align="center">0.18</td><td align="center">0.40</td><td align="center">[0.26–0.39]</td></tr><tr><td/><td/><td align="center"><bold>0.11</bold></td><td align="center"><bold>1.35</bold></td><td align="center">0.40</td><td align="center"><bold>[0.30–0.49]</bold></td></tr><tr><td>S2043</td><td align="center">80.7</td><td/><td/><td align="center">0.40</td><td align="center">[1.03–1.53]</td></tr><tr><td/><td/><td align="center"><bold>0.13</bold></td><td align="center"><bold>1</bold></td><td align="center">0.40</td><td align="center"><bold>[0.30–0.49]</bold></td></tr><tr><td/><td/><td align="center">1</td><td align="center">0.27</td><td align="center">0.40</td><td align="center">[0.26–0.38]</td></tr><tr><td/><td/><td align="center"><bold>0.10</bold></td><td align="center"><bold>1.93</bold></td><td align="center">0.40</td><td align="center"><bold>[0.29–0.46]</bold></td></tr></tbody></table><table-wrap-foot><p>Highest posterior density intervals (95 % HPDs) of tree length (TL) for analyses of a focal dataset from brittle stars [<xref ref-type="bibr" rid="CR12">12</xref>]. Each individual row corresponds to a Bayesian analysis of the focal data with different prior settings for branch- and tree-lengths. We used both default and informed parameterizations of the exponential (<italic>λ</italic>) and compound Dirichlet (<italic>α</italic>, <italic>c</italic>) branch-length priors. The top set of two shaded rows show default settings and focal inferences. Below that, alternate shadings indicate prior settings parameterized with different outside datasets (S1777 and S2043). The focal TL MLE was produced with Garli [<xref ref-type="bibr" rid="CR13">13</xref>]. Focal HPDs in bold contain the MLE</p></table-wrap-foot></table-wrap></p>
    <p>While the informed approach to setting branch-length priors that we describe has been applied primarily to datasets with a small number of loci, it may also be used for large datasets with similar levels of divergence across loci (e.g., ultraconserved elements). In fact, such large datasets allow for an even more direct application of informed priors, if a small subset of the data is used to inform priors that are then applied to analyses of the remaining data. Future work with EmpPrior will explore the performance of this approach for datasets generated by targeted sequence capture. Increases in the number of publicly available multiple sequence alignments, generated both through Sanger and high-throughput sequencing methods, will facilitate more widespread use of informed priors for branch lengths and other parameters of interest.</p>
  </sec>
  <sec id="Sec4">
    <title>Conclusions</title>
    <p>By using outside datasets with sampling depths (e.g., species-level) and evolutionary properties that are similar to a focal dataset, researchers can avoid the circularity of empirical Bayesian approaches and improve upon default prior performance [<xref ref-type="bibr" rid="CR10">10</xref>]. Despite the appeal of this approach, several procedural hurdles make it difficult to apply in practice. We developed EmpPrior to help overcome these hurdles and have shown that it can improve the accuracy and precision of branch-length estimates when compared to the default settings of popular Bayesian phylogenetic software. We hope that informed priors see more widespread use in Bayesian phylogenetics.</p>
  </sec>
  <sec id="Sec5">
    <title>Availability and requirements</title>
    <p><italic>Project name:</italic> EmpPrior</p>
    <p>
      <italic>Project home page:</italic>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/jembrown/EmpPrior">https://github.com/jembrown/EmpPrior</ext-link>
    </p>
    <p><italic>Operating systems:</italic> Platform independent</p>
    <p><italic>Programming language</italic>: Java and R</p>
    <p><italic>Other requirements:</italic> EmpPrior-search: Java version 1.8; EmpPrior-fit: R version 3.2, CRAN packages ape and bbmle.</p>
    <p><italic>License</italic>: GNU GPL v3</p>
    <p><italic>Any restrictions to use by non-academics</italic>: None</p>
  </sec>
  <sec id="Sec6">
    <title>Abbreviations</title>
    <p>GUI, graphical user interface; IUPAC, International Union of Pure and Applied Chemistry; ML, maximum likelihood; MLE, maximum-likelihood estimate; URL, uniform resource locator.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank M. Holder, W. Ludt, M. Harvey, V. Doyle, B. Faircloth, and anonymous reviewers for helpful comments. Some analyses were conducted with computational resources provided by HPC@LSU (<ext-link ext-link-type="uri" xlink:href="http://hpc.lsu.edu/">http://hpc.lsu.edu</ext-link>).</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>This work was supported by award 2011-DN-BX-K534 from the National Institute of Justice and startup funds from Louisiana State University to JMB.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p>Software and manual: <ext-link ext-link-type="uri" xlink:href="https://github.com/jembrown/EmpPrior">https://github.com/jembrown/EmpPrior</ext-link></p>
      <p>Empirical example data: <ext-link ext-link-type="uri" xlink:href="https://treebase.org/treebase-web/search/study/summary.html?id=2013">https://treebase.org/treebase-web/search/study/summary.html?id=2013</ext-link></p>
    </sec>
    <sec id="FPar3">
      <title>Authors’ contributions</title>
      <p>JJA, BJN, and JMB were all involved in designing the software and writing the manuscript. JJA and JMB both contributed to the EmpPrior-search code. BJN and JMB both contributed to the EmpPrior-fit code. All authors contributed to, read, and approved the final version of this manuscript.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hedtke</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lemmon</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Lemmon</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>When trees grow too long: Investigating the causes of highly inaccurate Bayesian branch-length estimates</article-title>
        <source>Syst Biol</source>
        <year>2010</year>
        <volume>59</volume>
        <fpage>145</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syp081</pub-id>
        <?supplied-pmid 20525627?>
        <pub-id pub-id-type="pmid">20525627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marshall</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>Cryptic failure of partitioned Bayesian phylogenetic analyses: lost in the land of long trees</article-title>
        <source>Syst Biol</source>
        <year>2010</year>
        <volume>59</volume>
        <fpage>108</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syp080</pub-id>
        <?supplied-pmid 20525623?>
        <pub-id pub-id-type="pmid">20525623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Tail paradox, partial identifiability and influential priors in Bayesian branch length inference</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>325</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr210</pub-id>
        <?supplied-pmid 21890479?>
        <pub-id pub-id-type="pmid">21890479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Robustness of compound Dirichlet priors for Bayesian inference of branch lengths</article-title>
        <source>Syst Biol</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>779</fpage>
        <lpage>784</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/sys030</pub-id>
        <?supplied-pmid 22328570?>
        <pub-id pub-id-type="pmid">22328570</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Redelings</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Improving phylogenetic analyses by incorporating additional information from genetic sequence databases</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2530</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp473</pub-id>
        <?supplied-pmid 19661240?>
        <pub-id pub-id-type="pmid">19661240</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Teslenko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Der Mark</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ayres</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Höhna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>MrBayes 3.2: Efficient Bayesian phylogenetic inference and model choice across a large model space</article-title>
        <source>Syst Biol</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>539</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/sys029</pub-id>
        <?supplied-pmid 22357727?>
        <pub-id pub-id-type="pmid">22357727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>BEAST: Bayesian evolutionary analysis by sampling trees</article-title>
        <source>BMC Evol Biol</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>214</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-7-214</pub-id>
        <?supplied-pmid 17996036?>
        <pub-id pub-id-type="pmid">17996036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paradis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Claude</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>APE: Analyses of phylogenetics and evolution in R language</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>289</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id>
        <?supplied-pmid 14734327?>
        <pub-id pub-id-type="pmid">14734327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Bolker B. bbmle: Tools for General Maximum Likelihood Estimation. R package version 1.0.17 based on stats4 by the R development core team. 2014. Available from: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/bbmle/">https://cran.r-project.org/web/packages/bbmle/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelson</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Deflating trees: improving Bayesian branch-length estimates using informed priors</article-title>
        <source>Syst Biol</source>
        <year>2015</year>
        <volume>64</volume>
        <fpage>441</fpage>
        <lpage>447</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syv003</pub-id>
        <?supplied-pmid 25595363?>
        <pub-id pub-id-type="pmid">25595363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sotiropoulos</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Eleftherakos</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dzukic</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kalezic</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Legakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Polymeni</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Phylogeny and biogeography of the alpine newt Mesotriton alpestris (Salamandridae, Caudata), inferred from mtDNA sequences</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2007</year>
        <volume>45</volume>
        <fpage>211</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2007.03.012</pub-id>
        <?supplied-pmid 17467298?>
        <pub-id pub-id-type="pmid">17467298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Halanych</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Evaluating connectivity in the brooding brittle star Astrotoma agassizii across the Drake Passage in the Southern Ocean</article-title>
        <source>J Hered</source>
        <year>2008</year>
        <volume>99</volume>
        <fpage>137</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1093/jhered/esm119</pub-id>
        <?supplied-pmid 18245798?>
        <pub-id pub-id-type="pmid">18245798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zwickl</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <source>Genetic algorithm approaches for the phylogenetic analysis of large biological sequence data sets under the maximum likelihood criterion. Ph.D. Dissertation. The University of Texas at Austin</source>
        <year>2006</year>
        <publisher-loc>Austin</publisher-loc>
        <publisher-name>The University of Texas</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
