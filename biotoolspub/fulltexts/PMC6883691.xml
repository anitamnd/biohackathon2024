<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6883691</article-id>
    <article-id pub-id-type="publisher-id">1827</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1827-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>methylCC: technology-independent estimation of cell type composition using differentially methylated regions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hicks</surname>
          <given-names>Stephanie C.</given-names>
        </name>
        <address>
          <email>shicks19@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Irizarry</surname>
          <given-names>Rafael A.</given-names>
        </name>
        <address>
          <email>rafa@ds.dfci.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Biostatistics, Johns Hopkins Bloomberg School of Public Health, </institution></institution-wrap>615 N Wolfe St,, Baltimore, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution>Department Data Sciences, Dana-Farber Cancer Institute, </institution></institution-wrap>450 Brookline Ave,, Boston, USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Biostatistics, Harvard T.H. Chan School of Public Health, </institution></institution-wrap>677 Huntington Ave, Boston, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>261</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">A major challenge in the analysis of DNA methylation (DNAm) data is variability introduced from intra-sample cellular heterogeneity, such as whole blood which is a convolution of DNAm profiles across a unique cell type. When this source of variability is confounded with an outcome of interest, if unaccounted for, false positives ensue. Current methods to estimate the cell type proportions in whole blood DNAm samples are only appropriate for one technology and lead to technology-specific biases if applied to data generated from other technologies. Here, we propose the technology-independent alternative: <italic>methylCC</italic>, which is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/stephaniehicks/methylCC">https://github.com/stephaniehicks/methylCC</ext-link>.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA methylation</kwd>
      <kwd>Whole blood</kwd>
      <kwd>Cell composition</kwd>
      <kwd>Microarray</kwd>
      <kwd>HumanMethylation27 BeadChip</kwd>
      <kwd>HumanMethylation450 BeadChip</kwd>
      <kwd>Whole genome bisulfite-sequencing</kwd>
      <kwd>Reduced representation bisulfite-sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GM083084</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GM103552</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HG005220</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>DNA methylation (DNAm) is a type of chemical modification occurring at CpG dinucleotide sites that is involved in controlling gene expression and has been shown to play an important role in distinguishing cell lineages [<xref ref-type="bibr" rid="CR1">1</xref>]. High-throughput DNAm assays have been widely applied among researchers as well as large consortia to further our understanding of basic biology and health implications [<xref ref-type="bibr" rid="CR2">2</xref>]. However, a major challenge in extracting information from these DNAm datasets is variability introduced from intra-sample cellular heterogeneity observed in samples of heterogeneous cell composition. Specifically, individual cell types encode unique cell type-specific DNAm signatures to distinguish between the cell lineages. Therefore, when we measure DNAm on samples with a heterogeneous cell composition, we actually observe a convolution of the DNAm profiles of each cell type [<xref ref-type="bibr" rid="CR3">3</xref>]. It is common for variability in cell type proportions to explain most of the observed sample-to-sample variability.</p>
    <p>Cell composition induced variability is particularly problematic in epigenome-wide association studies (EWAS) [<xref ref-type="bibr" rid="CR4">4</xref>] because, due to convenience, these are most frequently performed on whole blood, a highly heterogeneous tissue. In a seminal paper, Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>] describe a statistical method that accurately estimates the relative proportions of cell type components in whole blood. Jaffe et al. [<xref ref-type="bibr" rid="CR5">5</xref>] used this approach to demonstrate that reported age-related changes of blood DNAm profiles [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR12">12</xref>] could be explained with high levels of confounding between age-related variability and cell composition, demonstrating the importance of accounting for this source of variability. As the consequential effect of this source of variability started to be recognized, interest in statistical methods for estimating and accounting for intra-sample cellular heterogeneity grew accordingly. There are currently two major types of approaches. The first, originally developed by Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>], assumes that the observed heterogeneous blood profiles are a linear combination of the cell type-specific DNAm profiles, assumes these DNAm profiles are known, and then estimates the unknown proportions using a standard estimation procedures. To be able to assume cell type-specific DNAm profiles are known, a rather complex experiment, in which cells of the same cell type are sorted and then used to obtain high-throughput measurements of the reference samples, is conducted. Methods that make use of the sorted cell type-specific DNAm profiles are referred to as <italic>reference-based</italic>. Alternatively, other methods that do not use external reference profiles, referred to as <italic>reference-free</italic> methods, have been developed for DNAm data [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] and for more general types of data such as Surrogate Variable Analysis (SVA) [<xref ref-type="bibr" rid="CR15">15</xref>], or Remove Unwanted Variability (RUV) [<xref ref-type="bibr" rid="CR16">16</xref>] to account for batch effects [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p>Reference-based approaches have been shown to greatly outperform reference-free procedures [<xref ref-type="bibr" rid="CR18">18</xref>]. Here, we consider them to be the state of the art. However, in this paper, we demonstrate that a limitation of reference-based approaches is the presence of a technology-specific bias, which can influence the estimates of cell composition; namely, when using cell type-specific DNAm profiles measured using one technology, for example a microarray platform, to estimate the cell type proportions in samples measured from another technology, for example a sequencing platform. Here, we introduce a statistical method, referred to as <italic>methylCC</italic>, that removes this technical bias using a latent variable model and accurately estimates the cell composition in a platform-agnostic manner. To achieve this, we identify regions of the genome in which each cell type are either clearly methylated or unmethylated, and we model these as latent states. These latent states are biologically driven and therefore technology-independent, which allows us to estimate binary, platform-independent profiles that can be successfully be applied across technologies. To study the improvements in estimates of cell composition using methylCC, we evaluated the difference between the true and estimated proportions of cell types with a Monte Carlo simulation. Specifically, we studied how using cell type-specific DNAm profiles measured on a microarray platform to estimate the cell type proportions in samples measured on a sequencing platform can lead to inaccurate estimates of cell composition. Furthermore, we demonstrate how our platform-agnostic approach provides an overall improvement in estimates of cell composition. Although due to the availability of data all our examples are from whole blood, the approach can be generalized to other tissues.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p>Consider a set of high-throughput data <italic>Y</italic><sub><italic>ij</italic></sub> representing a heterogeneous tissue sample, such as whole blood, from <italic>i</italic>∈(1,…,<italic>N</italic>) individuals containing DNAm measurements at CpG sites <italic>j</italic>∈(1,…,<italic>J</italic>). Suppose the heterogeneous tissue is a combination of <italic>K</italic> cell types, which we index with <italic>k</italic>∈(1…<italic>K</italic>). Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>] proposed the following statistical model to estimate the proportions of <italic>K</italic> cell types in whole blood DNAm samples, for each individual <italic>i</italic>:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \boldsymbol{Y}_{i} = \sum_{k=1}^{K} \pi_{ik} \boldsymbol{X}_{k} + \boldsymbol{\varepsilon_{i}}.  $$ \end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2019_1827_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>Here <italic>π</italic><sub><italic>ik</italic></sub> represents the proportion of cell type <italic>k</italic> in individual <italic>i</italic>, which is the parameter of interest. The <bold><italic>X</italic></bold><sub><italic>k</italic></sub> represents the <italic>k</italic>th cell type-specific DNAm profile with measurements at the same <italic>J</italic> CpG sites as <bold><italic>Y</italic></bold><sub><italic>i</italic></sub>. The measurement error and other unexplained biological variability is represented by <bold><italic>ε</italic></bold><sub><italic>i</italic></sub>. The cell type proportions for individual <italic>i</italic> are assumed to be nonnegative, <italic>π</italic><sub><italic>ik</italic></sub>≥0, and sum to 1, <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{k=1}^{K} \pi _{ik} = 1$\end{document}</tex-math><mml:math id="M4"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq1.gif"/></alternatives></inline-formula>. To develop a practical tool, Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>] sorted whole blood samples into <italic>K</italic>=6 cell types that make up the majority of this tissue and obtained a DNAm profile for each cell type. They used Illumina’s HumanMethylation27 BeadChip (Illumina 27K), which measures DNAm at approximately 27,000 CpG sites [<xref ref-type="bibr" rid="CR19">19</xref>]. This experimental data provided plug-in estimates for the cell type-specific DNAm profile, <bold><italic>X</italic></bold><sub><italic>k</italic></sub>, and with these in place then they estimated the <italic>π</italic><sub><italic>ik</italic></sub> using a constrained least square algorithm. Soon after the development of this method, Illumina released a new platform that measured approximately 450,000 CpG sites: the HumanMethylation450 BeadChip (Illumina 450K) [<xref ref-type="bibr" rid="CR20">20</xref>]. Jaffe et al. [<xref ref-type="bibr" rid="CR5">5</xref>] leveraged publicly available data of sorted cell types measured with this new Illumina 450K platform [<xref ref-type="bibr" rid="CR1">1</xref>] to implement the Houseman et al. method [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>Although the Illumina 450K microarray platform has been the most widely used platform, two new sequencing technologies are being increasingly adapted by the research community: Whole-genome Bisulfite Sequencing (WGBS) and Reduced Representation Bisulfite Sequencing (RRBS) [<xref ref-type="bibr" rid="CR21">21</xref>]. Furthermore, Illumina has recently released a new version of their BeadChip, which measures approximately 850,000 CpG sites. However, similar experiments with sorted cells processed at the same time are not yet available from these new platforms, which implies we do not have plug-in estimates for <bold><italic>X</italic></bold><sub><italic>k</italic></sub> on these platform technologies. Currently, the only way the Houseman et al. approach [<xref ref-type="bibr" rid="CR3">3</xref>] can be applied to DNAm data measured on these new platforms is by assuming that the cell type-specific DNAm profiles <bold><italic>X</italic></bold><sub><italic>k</italic></sub> derived for the 450K platform applies to others. Here, we show this assumption does not hold.</p>
    <sec id="Sec3">
      <title>Across platforms estimates are inaccurate</title>
      <p>To determine if the Houseman et al. method [<xref ref-type="bibr" rid="CR3">3</xref>], as implemented by Jaffe et al. [<xref ref-type="bibr" rid="CR5">5</xref>], which was specifically developed for the Illumina 450K array platform, is applicable across platforms, we obtained a dataset for which whole blood samples from <italic>N</italic>=10 adult males were run on both the Illumina 450K and RRBS platforms (referred to below as the <italic>two-platform dataset</italic>). We applied the Houseman method to the whole blood samples in the <italic>two-platform dataset</italic> and expected similar cell composition estimates for each individual across platforms as these were the same whole blood samples just measured on two platforms. Because the Houseman method has been shown to provide reliable cell composition estimates for DNAm data measured on the Illumina 450K platform, in this specific case we considered the cell composition estimates from the Houseman method to be the gold-standard or ground truth, as done by Rahmani et al. [<xref ref-type="bibr" rid="CR22">22</xref>]. However, we found that the resulting cell composition estimates between the <italic>N</italic>=10 whole blood samples measured on the Illumina 450K and RRBS platforms did not agree (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Across platforms estimates are inaccurate. Cell composition estimates (<italic>K</italic>=6 cell types) from <italic>N</italic>= 10 whole blood samples (<italic>two-platform dataset</italic> – GEO Accession GSE95163) measured on the Illumina 450k microarray platform (<italic>x</italic>-axis) and the RRBS platform<italic>(y-</italic>axis). The statistical method proposed by Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>], as implemented by Jaffe et al. [<xref ref-type="bibr" rid="CR5">5</xref>], and was used to estimate the cell composition</p></caption><graphic xlink:href="13059_2019_1827_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>To determine the cause of this disagreement, we examined this dataset more closely and found two limitations with the Houseman approach when applied to technologies other than the Illumina microarrays: (1) DNAm measurements vary across platforms and (2) different platforms measure different CpGs. These two limitations are discussed in the following two sections, respectively. We then describe a statistical solution to overcome these two limitations using a general latent class model to estimate the cell composition of heterogeneous samples agnostic to platform technology. We also provide a software implementation of our method available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/methylCC">https://bioconductor.org/packages/release/methylCC</ext-link>.</p>
    </sec>
    <sec id="Sec4">
      <title>DNAm measurements vary across platforms</title>
      <p>The first limitation is that there is a platform-dependent bias. We can observe this bias by simply plotting and comparing the raw DNAm measurements using the whole blood samples in the <italic>two-platform dataset</italic>. We commonly observe genomic regions in which both platforms seem to indicate a change from unmethylated to methylated states, but the observed DNAm levels differ substantially across platforms (for example, Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). A more systematic demonstration is obtained by first using the reference cell sorted dataset [<xref ref-type="bibr" rid="CR1">1</xref>] to identify regions that are clearly unmethylated in all purified cell types and regions that are clearly methylated in all purified cell types, and then plotting the empirical DNAm distribution across all whole blood samples within these regions for both platforms (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) and noting the different distributions. We note in particular that observed DNAm levels measured on RRBS tends to have values closer to 0 and 1, compared to the Illumina 450K array attenuating these values away from the edges.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Evidence for platform-dependent bias. <bold>a</bold> Observed DNAm levels from one region in same <italic>N</italic>=10 individuals (<italic>two-platform dataset</italic> – GEO Accession GSE95163) measured on two platform technologies: Illumina 450k (red) and RRBS (blue). <bold>b</bold> Density of DNAm levels measured on the 450k platform (red) and RRBS platform (blue) in regions that are either methylated (dashed line) or not methylated (solid line). Regions were identified by searching for regions in purified whole blood cell types from Reinius et al. [<xref ref-type="bibr" rid="CR1">1</xref>] that appeared either methylated or not methylated in all six purified cell types</p></caption><graphic xlink:href="13059_2019_1827_Fig2_HTML" id="MO2"/></fig>
</p>
    </sec>
    <sec id="Sec5">
      <title>Different platforms measure different CpGs</title>
      <p>The second limitation is that different platforms measure different CpGs. The human genome contains over 20,000,000 CpG sites, and each platform includes a subset of these which, for logistical reasons, differs across platforms. For example, RRBS [<xref ref-type="bibr" rid="CR21">21</xref>] uses restriction enzymes to enrich for the areas of the genome that have a high CpG content, while the Illumina 450k platform selects CpG sites that are more uniformly distributed across the genome. Therefore, to apply the Houseman model to samples measured on platforms other than the Illumina 450K array, we have to restrict ourselves to the intersection of the CpGs measured Illumina 450K array and the alternative platform, because the <italic>j</italic><sup><italic>t</italic><italic>h</italic></sup> CpG in the whole blood sample <bold><italic>Y</italic></bold><sub><italic>i</italic></sub> must match the <italic>j</italic><sup><italic>t</italic><italic>h</italic></sup> CpG in the cell type-specific DNAm profile <bold><italic>X</italic></bold><sub><italic>k</italic></sub>. As a result, in our 10 RRBS samples we only have measurements from 102 of the 600 CpGs in the cell type-specific DNAm profiles used by the 450K implementation of the Houseman method. This results in a loss of power since informative cell type-specific CpGs may be left out (for example Fig. <xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Example of Houseman cell type-specific CpGs measured on the 450k microarray platform, but not measured on the RRBS platform. <bold>a</bold> The cell type-specific CpG and the cell type-specific region of CpGs (or differentially methylated regions, DMR) were both identified using the purified CD8T cell, CD4T cell, Natural Killer (NK), B cell, Monocytes (Mono) and Granulocytes (Gran) cell types from [<xref ref-type="bibr" rid="CR1">1</xref>]. <bold>b</bold> In the whole blood DNAm data from one individual (GEO Accession GSE95163) measured on two platforms (450k and RRBS), the cell type-specific CpG from Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>] is not measured on the RRBS platform. However, using a cell type-specific region (DMR), we are able to measure the methylation level by averaging across the region in both the 450k and RRBS platform for this sample (dotted lines)</p></caption><graphic xlink:href="13059_2019_1827_Fig3_HTML" id="MO3"/></fig>
</p>
    </sec>
    <sec id="Sec6">
      <title>methylCC estimates cell composition in DNAm samples agnostic to platform technology</title>
      <p>To adjust for the platform-specific biases, we introduce a model that accounts for these biases directly and models methylation states using latent variables. To account for the fact that different platforms measure different CpG sites, we model the latent classes at the region level rather than the CpG level. Specifically, we propose the following statistical model:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \boldsymbol{Y}_{i} = \sum_{k=1}^{K} \pi_{ik} \left\{ (1-\boldsymbol{Z}_{k}) \boldsymbol{\delta}_{0} + \boldsymbol{Z}_{k} \boldsymbol{\delta}_{1} \right\} + \boldsymbol{\varepsilon}_{i}  $$ \end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="13059_2019_1827_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold><italic>Y</italic></bold><sub><italic>i</italic></sub> is the observed DNAm level in the heterogeneous tissue, in this case whole blood, for the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> individual <italic>i</italic>∈(1,…,<italic>N</italic>), but now measured DNAm levels in <italic>R</italic> genomic regions <italic>r</italic>∈(1,…,<italic>R</italic>), as opposed to <italic>J</italic> individual CpGs in the Houseman model. Similar to the Houseman model, <italic>π</italic><sub><italic>ik</italic></sub> represents the proportion of cell type <italic>k</italic> in individual <italic>i</italic>, which is the parameter of interest. In addition, we assume that the cell type proportions for individual <italic>i</italic> are nonnegative, <italic>π</italic><sub><italic>ik</italic></sub>≥0, and sum to 1, <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{k=1}^{K} \pi _{ik} = 1$\end{document}</tex-math><mml:math id="M8"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq2.gif"/></alternatives></inline-formula>. Here, <bold><italic>Z</italic></bold><sub><italic>k</italic></sub>=(<italic>Z</italic><sub>1<italic>k</italic></sub>,…,<italic>Z</italic><sub><italic>Rk</italic></sub>) is a vector of latent variables for the <italic>k</italic><sup><italic>t</italic><italic>h</italic></sup> cell type where each latent variable, <italic>Z</italic><sub><italic>rk</italic></sub>, is an indicator that is equal to 1 if the region <italic>r</italic> is methylated in cell type <italic>k</italic> and 0 otherwise. The platform-specific biases are represented with random effects <bold><italic>δ</italic></bold><sub>0</sub>=(<italic>δ</italic><sub>0,1</sub>,…,<italic>δ</italic><sub>0,<italic>R</italic></sub>) and <bold><italic>δ</italic></bold><sub>1</sub>=(<italic>δ</italic><sub>1,1</sub>,…,<italic>δ</italic><sub>1,<italic>R</italic></sub>), which are assumed to follow multivariate normal distributions <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N\left (\alpha _{0} \boldsymbol {1}, \sigma _{0}^{2} I_{(R\times R)}\right)$\end{document}</tex-math><mml:math id="M10"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N\left (\alpha _{1} \boldsymbol {1}, \sigma _{1}^{2} I_{(R\times R)}\right)$\end{document}</tex-math><mml:math id="M12"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq4.gif"/></alternatives></inline-formula>, respectively. Measurement error and other unexplained biological variability is represented with <bold><italic>ε</italic></bold><sub><italic>i</italic></sub>, which we assume follows a multivariate normal distribution <italic>N</italic>(0,<italic>τ</italic><sup>2</sup><italic>I</italic><sub>(<italic>R</italic>×<italic>R</italic>)</sub>). Note that in our model the random effects <bold><italic>δ</italic></bold><sub>0</sub> and <bold><italic>δ</italic></bold><sub>1</sub> are assumed to be platform-dependent: they represent the technology-dependent bias with different mean and variances in different platforms (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). However, the <bold><italic>Z</italic></bold><sub><italic>k</italic></sub>s are not platform-dependent: they are latent classes determined by biology.</p>
      <p>The statistical model in Eq. <xref rid="Equ2" ref-type="">2</xref> can be thought of as a generalization of Eq. <xref rid="Equ1" ref-type="">1</xref> if we restrict the Houseman approach to only include CpGs that are either methylated or unmethylated in each cell type. In this case, region <italic>r</italic> would simply be a single CpG site and the <italic>k</italic><sup><italic>t</italic><italic>h</italic></sup> cell type-specific DNAm profile, <bold><italic>X</italic></bold><sub><italic>k</italic></sub>, would be defined by <italic>X</italic><sub><italic>rk</italic></sub>=<italic>δ</italic><sub>0,<italic>r</italic></sub> if region <italic>r</italic> is unmethylated and <italic>X</italic><sub><italic>rk</italic></sub>=<italic>δ</italic><sub>1,<italic>r</italic></sub> if region <italic>r</italic> is methylated.</p>
      <p>A significant advantage of our model is that instead of directly measuring the cell type-specific DNAm profiles, <bold><italic>X</italic></bold><sub><italic>k</italic></sub>, for each platform, we account for region-to-region variability using a latent random variable and therefore do not need to measure it directly with each new platform. Instead, all we need is to identify <italic>R</italic> regions for which each <italic>k</italic><sup><italic>t</italic><italic>h</italic></sup> cell type is either clearly methylated (<italic>Z</italic><sub><italic>rk</italic></sub>=1), or not methylated (<italic>Z</italic><sub><italic>rk</italic></sub>=0) for <italic>r</italic>∈(1,…,<italic>R</italic>). We define <bold><italic>Z</italic></bold> to be the matrix with entries <italic>Z</italic><sub><italic>rk</italic></sub> in the <italic>r</italic>th row and <italic>k</italic>th column, which needs to be full rank for the parameters of interest, <italic>π</italic><sub><italic>ik</italic></sub> to be identifiable. Because <bold><italic>Z</italic></bold> is entirely determined by biology, not by the platform technology, we only have to identify these regions once for each type of heterogeneous (biological) sample. This requires experimental data from cell sorted samples measured on only one platform. To demonstrate the utility this approach for estimating cell composition in whole blood samples, we searched for these genomic regions in the purified cell type data described in [<xref ref-type="bibr" rid="CR1">1</xref>], which were measured on the Illumina 450K array platform. This dataset includes B cells, monocytes, granulocytes, CD8T cells, CD4T cells and natural killer (NK) cells. We identified <italic>R</italic>=210 regions satisfying our criteria (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Finally, with the <italic>R</italic> regions in place, the estimation of the proportion of cell types, <italic>π</italic><sub><italic>ik</italic></sub>, reduces to a missing data problem. We use an EM algorithm with a constrained linear model to estimate the parameters <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\theta } = \left (\alpha _{0}, \alpha _{1}, \sigma _{0}^{2}, \sigma _{1}^{2}, \tau ^{2}\right)$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq5.gif"/></alternatives></inline-formula> and <bold><italic>π</italic></bold><sub><italic>i</italic></sub>=(<italic>π</italic><sub><italic>i</italic>1</sub>,…,<italic>π</italic><sub><italic>iK</italic></sub>) for individuals <italic>i</italic>∈(1,…,<italic>N</italic>) (see the "Methods" section for complete details on estimation procedure).</p>
    </sec>
    <sec id="Sec7">
      <title>methylCC improves estimates of cell composition of DNAm samples measured on other platform technologies</title>
      <p>To demonstrate the improvements in the estimates of cell composition provided by our platform-agnostic approach, we applied our method to the <italic>two-platform dataset</italic>. Specifically, we fit our model to the 10 whole blood samples measured on both the Illumina 450K array and RRBS platforms. Similar to Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we considered the estimates of cell composition from the Houseman model in the Illumina 450K samples to be the gold-standard reference. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we demonstrated that directly applying the Houseman approach [<xref ref-type="bibr" rid="CR3">3</xref>], as implemented by Jaffe et al. [<xref ref-type="bibr" rid="CR5">5</xref>], to the RRBS data led to biased cell composition estimates. However, our new approach substantially improves estimates of cell composition (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>methylCC: A latent variable model with region-specific and platform-dependent random effects improves estimates of cell composition. Cell composition estimates from <italic>N</italic>= 10 whole blood samples (<italic>K</italic> = 6 cell types) measured on the Illumina 450k microarray platform (<italic>x</italic>-axis) and the RRBS platform (<italic>y</italic>-axis). Two methods were used to estimate the cell composition: (1) the model proposed by Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>], as implemented by Jaffe et al. [<xref ref-type="bibr" rid="CR5">5</xref>], that was developed for samples measured on the Illumina 450k microarray platform (left), and (2) our proposed method that is independent of platform technology (right). Root mean squared error (RMSE) is the difference between the cell composition estimates for whole blood DNAm samples measured on the Illumina 450k array platform and on the RRBS platform (averaged across cell types). Within each plot, the RMSE is shown for the reference-based method from Houseman et al. [<xref ref-type="bibr" rid="CR3">3</xref>] (left) and our proposed model (methylCC) (right)</p></caption><graphic xlink:href="13059_2019_1827_Fig4_HTML" id="MO4"/></fig>
</p>
      <p>Furthermore, we evaluate the performance of our platform-agnostic approach with the goal of estimating the proportion of cell types in heterogeneous tissue samples. Here, we performed a Monte Carlo simulation study to illustrate the improvements in estimates of cell composition by our platform-agnostic approach compared to the Houseman approach for heterogeneous samples measured on a sequencing platform (described in detail in the Methods Section). For the simulations study, we created cell type-specific DNAm profiles for a microarray platform, <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}_{k}^{450K}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>450</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq6.gif"/></alternatives></inline-formula>, and a sequencing platform, <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}_{k}^{RRBS}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RRBS</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq7.gif"/></alternatives></inline-formula>, by simulating platform-dependent random effects with different means and variances (Additional file <xref rid="MOESM1" ref-type="media">1</xref>1: Figure S2A). Then, we simulate whole blood samples with a relative proportion of cell types <bold><italic>π</italic></bold><sub><italic>i</italic></sub> and measurement error <bold><italic>ε</italic></bold><sub><italic>i</italic></sub> to create the observed DNAm level in whole blood samples measured on in the 450k array platform <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {Y}_{i}^{450k}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>450</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq8.gif"/></alternatives></inline-formula> and the RRBS platform <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {Y}_{i}^{RRBS}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RRBS</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq9.gif"/></alternatives></inline-formula>. We estimate the cell composition in the whole blood samples measured on both platform using the reference-based Houseman method and our platform-agnostic method. Then, we evaluate the difference between the true and estimated proportion of cell types using either our approach or the Houseman approach.</p>
      <p>For whole blood samples measured on the 450K array platform, we found the Houseman approach, which was specifically developed for the array platform, and our approach perform similarly (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2B). However, for whole blood samples measured on a sequencing platform, our platform-agnostic model results in significantly improved estimates of cell composition (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2C). This is because our model accounts for the platform-specific biases directly and models methylation states using latent variables.</p>
    </sec>
    <sec id="Sec8">
      <title>methylCC accurately estimates cell composition of DNAm samples measured on WGBS platforms</title>
      <p>We evaluated our platform-agnostic approach using WGBS reference methylome data from the BLUEPRINT Epigenome Database [<xref ref-type="bibr" rid="CR23">23</xref>]. We downloaded <italic>N</italic>=44 samples from seven purified whole blood cell types, specifically B cells, CD4T cells, CD8T cells, neutrophils, eosinophils, monocytes, and natural killer cells. For a given WGBS sample (e.g., CD8T cells), we assumed the “gold standard” cell composition to be 100% CD8T cells and 0% for the other cell types. We fit our model to <italic>N</italic>=44 purified cell types measured on the WGBS platform. We found our platform-agnostic approach closely matches the expected cell composition estimates from the purified whole blood WGBS samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>methylCC accurately estimates cell composition of DNAm samples measured on WGBS platforms. Cell composition estimates using <italic>N</italic>=44 WGBS samples from the BLUEPRINT Epigenome Database [<xref ref-type="bibr" rid="CR23">23</xref>] from seven purified whole blood cell types, specifically B cells, CD4T cells, CD8T cells, neutrophils, eosinophils, monocytes, and natural killer cells. For a given WGBS sample (e.g., CD8T cells), we assumed the “gold standard” cell composition to be 100% CD8T cells and 0% for the other cell types. We fit our model to <italic>N</italic>=44 purified cell types measured on the WGBS platform</p></caption><graphic xlink:href="13059_2019_1827_Fig5_HTML" id="MO5"/></fig>
</p>
      <p>Next, we used the BLUEPRINT reference methylomes to construct a set of cell type-specific DMRs to investigate whether DMRs identified with the purified cell types measured on the WGBS platform can lead to improved estimates of cell composition with methylCC as opposed to DMRs identified with the purified cell types measured on the Illumina 450K array platform. Using the WGBS “gold standard” data, we found the DMRs identified with the purified cell types measured on the WGBS platform resulted performed better than DMRs identified with the purified cell types measured on the Illumina 450K array platform (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Using the <italic>two-platform dataset</italic>, we found methylCC results in a substantial improvement over the Houseman approach with either set of DMRs, but using the DMRs identified with the 450K reference methylomes performs slightly better (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Data exploration of the BLUEPRINT data reveals that this is likely due to a batch effect in the BLUEPRINT data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5).</p>
    </sec>
    <sec id="Sec9">
      <title>methylCC accurately estimates cell composition of DNAm samples measured on Illumina 450K array platforms</title>
      <p>To validate the results of our simulation study using whole blood samples measured on the Illumina 450K array platform, we compared the cell composition estimates from our model and the Houseman model using two publicly available data sets with DNAm whole blood samples measured on the Illumina 450K array platform. In the first data set [<xref ref-type="bibr" rid="CR24">24</xref>], the <italic>N</italic>=78 whole blood samples had their cell composition independently estimated using flow cytometry, which can be considered as a “gold standard” [<xref ref-type="bibr" rid="CR22">22</xref>]. We found our platform-agnostic approach closely matches the independent cell composition measurements (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6).</p>
      <p>Next, we used a second data set [<xref ref-type="bibr" rid="CR25">25</xref>] with <italic>N</italic>=689 whole blood samples, which did not have independent measurements of cell composition. Here, we considered the cell composition estimates from the Houseman model to be the “gold standard” for the purposes of this assessment because the Houseman model was specifically designed for the Illumina 450K array platform and it has been previously considered as a “gold standard" [<xref ref-type="bibr" rid="CR22">22</xref>]. Using this data, we found our platform-agnostic approach closely matches the referenced-based approach (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7).</p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p>A major challenge in measuring DNAm is variability introduced from intra-sample cellular heterogeneity, which is a convolution of DNAm profiles across cell types. This is particularly problematic in epigenome-wide association studies for human disease performed on whole blood, a heterogeneous tissue. Accounting for this source of variability is a first step to determine the actual cell proportions of each sample. Currently, the most effective approach is based on fitting a linear model in which one assumes the DNAm profiles of the representative cell types are known for a specific platform technology, the Illumina microarray platform. Although this method works well in practice, we have demonstrated that if the DNAm data was generated on a new platform technology, such as RRBS or WGBS, this can lead to technology-specific biases in the cell composition estimates.</p>
    <p>To address this, we have developed a latent variable model with region-specific and platform-dependent random effects to accurately estimate the cell composition in DNAm whole blood samples measured from any platform technology. By using informative genomic regions that are either methylated or unmethylated for each purified cell type, our model can account for the platform-specific biases directly and model methylation states using latent variables. We have illustrated how we can estimate the cell composition across platform technologies as cell types preserve their methylation state in regions independent of platform, despite observed measurements being platform-dependent. Note that, our current model assumes that the random effects and measurement error are normally distributed. Although these assumptions were a practical approximation that led to an improvement for RRBS data and accurately identified purified cell types in WGBS data, the model may need to be generalized to other distributions, such as count data for which negative binomial models may be more appropriate. Given that sequencing platform technologies are poised to become more widely used for studies measuring DNAm in whole blood, this suggests that our method is an needed contribution.</p>
  </sec>
  <sec id="Sec11" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We demonstrated that our method accurately estimates the cell composition from whole blood samples and is applicable across multiple platforms, including microarray and sequencing platforms. Specifically, we illustrated how our method significantly improves the estimates of the cell composition compared to the reference-based method in whole blood samples measured on a sequencing platform using real and simulated whole blood samples, in addition to purified whole blood cell types measured on a sequencing platform. Our approach is agnostic to platform because it first uses experimental data to identify regions in which each cell type is clearly methylated or unmethylated, and then models these as latent states. While the continuous measurements used in the linear model approaches are affected by platform-specific biases, the latent states are biologically driven and therefore technology independent, implying that experimental data only needs to be collected once. We have implemented our method into the <italic>methylCC</italic> R-package providing researchers a tool to estimate the cell composition in the analysis of their own whole blood DNAm data.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Using cell sorted experimental data to identify informative genomic regions in <bold><italic>Z</italic></bold></title>
      <p>Cell sorted experimental data is needed to identify <italic>R</italic> informative genomic regions for which the <italic>k</italic>th cell type is either clearly methylated (<italic>Z</italic><sub><italic>rk</italic></sub>=1) or not methylated (<italic>Z</italic><sub><italic>rk</italic></sub>=0) for regions <italic>r</italic>∈(1,…,<italic>R</italic>). This is step is done only once for each type of heterogeneous (biological) sample, such as whole blood, and does not depend on the platform technology. In addition, this matrix <bold><italic>Z</italic></bold> needs to be full rank for the parameters of interest, <italic>π</italic><sub><italic>ik</italic></sub> to be identifiable.</p>
      <p>In application for estimating the cell composition in whole blood samples, we used cell sorted data described in [<xref ref-type="bibr" rid="CR1">1</xref>], which were measured on the Illumina 450K array platform. This dataset includes six biological replicates for each of the six purified cell type (B cells, monocytes, granulocytes, CD8T cells, CD4T cells, and natural killer (NK) cells). We used the bumphunter [<xref ref-type="bibr" rid="CR26">26</xref>] Bioconductor [<xref ref-type="bibr" rid="CR27">27</xref>] package to identify differentially methylated regions (DMRs) across cell types. For example, to search for DMRs such that the six granulocytes samples are unmethylated and the other cell types are methylated (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), we fit a linear model <italic>Y</italic><sub><italic>ij</italic></sub>=<italic>β</italic><sub>0</sub>(<italic>l</italic><sub><italic>j</italic></sub>)+<italic>β</italic><sub>1</sub>(<italic>l</italic><sub><italic>j</italic></sub>)<italic>X</italic><sub><italic>j</italic></sub>+<italic>ε</italic><sub><italic>ij</italic></sub> at each <italic>j</italic>th genomic position (or CpG site) where <italic>Y</italic><sub><italic>ij</italic></sub> represents observed DNAm level in the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> biological replicate for a purified cell type at position <italic>j</italic> with a covariate of interest, <italic>X</italic><sub><italic>j</italic></sub>, (for example <italic>X</italic><sub><italic>j</italic></sub>=0 for granulocytes and <italic>X</italic><sub><italic>j</italic></sub>=1 for other cell types). Then, we searched for regions of CpGs such that <italic>β</italic><sub>1</sub>(<italic>l</italic>)≠0. For more details on identifying DMRs, we refer the reader to [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR28">28</xref>].</p>
      <p>We searched for regions that were not overlapping so they would be considered independent observations. In certain pairwise cell type comparisons, the only regions found contained just one CpG; however, we prioritized regions with more than one CpG whenever possible. In addition to these cell type-specific DMRs, our method has the option for a user to search for and include additional cell type-specific CpGs along with the DMRs, if too few DMRs are found. Following these steps, we identified <italic>R</italic>=210 regions satisfying our criteria (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
      <p>We also used the reference methylomes from the BLUEPRINT Epigenome Database (<ext-link ext-link-type="uri" xlink:href="http://www.blueprint-epigenome.eu">http://www.blueprint-epigenome.eu</ext-link>) [<xref ref-type="bibr" rid="CR23">23</xref>], which contained <italic>N</italic>=44 samples from seven purified whole blood cell types, specifically B cells, CD4T cells, CD8T cells, neutrophils, eosinophils, monocytes, and natural killer cells. We combined neutrophils, eosinophils as one group called granulocytes. We used the bsseq [<xref ref-type="bibr" rid="CR29">29</xref>] Bioconductor [<xref ref-type="bibr" rid="CR27">27</xref>] package to store the WGBS data and we used the dmrseq [<xref ref-type="bibr" rid="CR30">30</xref>] package to identify DMRs across the six cell types.</p>
      <p>In the next section, we describe our estimation procedure to obtain the cell composition estimates, <bold><italic>π</italic></bold><sub><italic>i</italic></sub>=(<italic>π</italic><sub><italic>i</italic>1</sub>,…,<italic>π</italic><sub><italic>iK</italic></sub>), and we note that we assume these regions <bold><italic>Z</italic></bold> are known here. This is because if we fit the model only to these regions, then the estimation procedure reduces to a missing data problem with random effects <bold><italic>δ</italic></bold><sub>0</sub> and <bold><italic>δ</italic></bold><sub>1</sub>.</p>
    </sec>
    <sec id="Sec14">
      <title>Estimation procedure</title>
      <p>Using the <italic>R</italic>=210 informative genomic regions identified above, we estimate the parameters of interest, namely the proportion of cell types <bold><italic>π</italic></bold><sub><italic>i</italic></sub>=(<italic>π</italic><sub><italic>i</italic>1</sub>,…,<italic>π</italic><sub><italic>iK</italic></sub>) for the <italic>i</italic>∈(1,…,<italic>N</italic>) individuals, and the parameters <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\theta } = \left (\alpha _{0}, \alpha _{1}, \sigma _{0}^{2}, \sigma _{1}^{2}, \tau ^{2}\right)$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq10.gif"/></alternatives></inline-formula> in the proposed latent variable model (Eq. <xref rid="Equ2" ref-type="">2</xref>) using an EM algorithm with constraints <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{k=1}^{K} \pi _{ik} = 1$\end{document}</tex-math><mml:math id="M26"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq11.gif"/></alternatives></inline-formula> and <italic>π</italic><sub><italic>ik</italic></sub>≥0 for all <italic>k</italic>.</p>
      <sec id="Sec15">
        <title>Obtain initial parameter estimates <bold><italic>θ</italic></bold><sup>(0)</sup> and <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\pi }_{i}^{(0)}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq12.gif"/></alternatives></inline-formula> at step <italic>t</italic>=0</title>
        <p>To obtain initial parameter estimates for the <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{0}^{(0)}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\sigma _{0}^{2}\right)^{(0)}$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq14.gif"/></alternatives></inline-formula> at step <italic>t</italic>=0, we use the reference cell sorted dataset [<xref ref-type="bibr" rid="CR1">1</xref>], which has six biological replicates for each cell type, to identify a set of <italic>R</italic><sup>0</sup> genomic regions that are clearly unmethylated (<italic>Z</italic><sub><italic>rk</italic></sub>=0) in all <italic>K</italic> purified whole blood cell types. In these unmethylated regions, the expected DNAm level is
<disp-formula id="Equa"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$E(Y_{ir}) = \sum_{k=1}^{K} \pi_{ik} E(\delta_{0,r}) + E(\varepsilon_{ir}) = \sum_{k=1}^{K} \pi_{ik} \alpha_{0} = \alpha_{0} $$ \end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> and we use Jensen’s inequality to estimate an upper bound on the variance of <italic>Y</italic><sub><italic>ir</italic></sub>:
<disp-formula id="Equb"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} Var(Y_{ir}) &amp;= Var\left(\sum_{k=1}^{K} \pi_{ik} \delta_{0,r}\right) + Var(\varepsilon_{ir})\\ &amp;\leq \sum_{k=1}^{K} \pi_{ik} Var(\delta_{0,r}) + Var(\varepsilon_{ir}) = \sigma_{0}^{2} + \tau^{2} \end{aligned} $$ \end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≤</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> Therefore, we obtain initial parameter estimates
<disp-formula id="Equc"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \hat{\alpha}_{0}^{(0)} &amp;= \frac{1}{N} \sum_{i=1}^{N} \left[ \frac{1}{R^{0}} \sum_{r=1}^{R^{0}} Y_{ir} \right] \\ (\hat{\sigma}_{0}^{2})^{(0)} &amp;\geq \frac{1}{N} \sum_{i=1}^{N} \left[ \frac{1}{R^{0}-1} \sum_{r=1}^{R^{0}} (Y_{ir} -\bar{Y}_{i})^{2} \right] \end{aligned} $$ \end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>≥</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where the measurement error <italic>τ</italic><sup>2</sup> is assumed to be small. The argument is similar for the initial parameter estimates of <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{1}^{(0)}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\sigma _{1}^{2}\right)^{(0)}$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq16.gif"/></alternatives></inline-formula> by identifying genomic regions (<italic>R</italic><sup>1</sup>) where the CpGs are all methylated (<italic>Z</italic><sub><italic>rk</italic></sub>=1) for all <italic>K</italic> purified cell types.</p>
        <p>To obtain initial parameter estimates for the proportion of cell types, <inline-formula id="IEq17"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\pi }_{i}^{(0)}$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq17.gif"/></alternatives></inline-formula> with constraints <inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{k=1}^{K} \pi _{ik}^{(0)} = 1$\end{document}</tex-math><mml:math id="M46"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\pi _{ik}^{(0)} \geq 0$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq19.gif"/></alternatives></inline-formula>, we use the fact that <inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat{{\pi}}_{i} = \text{argmin}_{{\pi}_{i}} \log L = \text{argmax}_{{\pi}_{i}} (-\log L)$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>argmin</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>argmax</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq20.gif"/></alternatives></inline-formula> and − log<italic>L</italic>∝(<italic>Y</italic>−<italic>X</italic><italic>π</italic>)<sup><italic>T</italic></sup>(<italic>Y</italic>−<italic>X</italic><italic>π</italic>). This non-negative least squares (NNLS) problem with constraints is equivalent to the quadratic programming problem <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text{argmin}_{{\pi}_{i}} \left (\frac {1}{2} {\pi}_{i}^{T} Q{\pi}_{i} + a^{T} {\pi}_{i}\right)$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mo>argmin</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>Q</mml:mi><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq21.gif"/></alternatives></inline-formula> where <italic>Q</italic>=(<italic>X</italic><sup><italic>T</italic></sup><italic>X</italic>) and <italic>a</italic>=(−<italic>X</italic><sup><italic>T</italic></sup><italic>Y</italic>) [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Therefore, we calculate <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat {X}}^{(0)} = (1-\boldsymbol {Z}) \hat {\alpha }_{0}^{(0)} + \boldsymbol {Z} \hat {\alpha }_{1}^{(0)}$\end{document}</tex-math><mml:math id="M54"><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq22.gif"/></alternatives></inline-formula> and apply quadratic programming [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] to solve for <inline-formula id="IEq23"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ \hat {\boldsymbol {\pi }}_{i}^{(0)}= \left (\pi _{i1}^{(0)}, \ldots, \pi _{iK}^{(0)}\right)$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iK</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq23.gif"/></alternatives></inline-formula>. We use the solve.QP() function from the R package quadprog [<xref ref-type="bibr" rid="CR33">33</xref>] to implement the quadratic programming. Finally, to obtain an initial parameter estimate for (<italic>τ</italic><sup>2</sup>)<sup>(0)</sup>, we calculate
<disp-formula id="Equd"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$(\hat{\tau}^{2})^{(0)} = \frac{1}{RN} \sum_{i=1}^{N} \sum_{r=1}^{R} \left(Y_{ir} - \sum_{k=1}^{K} \hat{X}_{rk}^{(0)} \hat{\pi}_{ik}^{(0)}\right)^{2} $$ \end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RN</mml:mtext></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">rk</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec16">
        <title>EM algorithm to estimate <bold><italic>θ</italic></bold> and <bold><italic>π</italic></bold></title>
        <p>To construct an EM algorithm to obtain maximum likelihood estimates of <bold><italic>θ</italic></bold> and <bold><italic>π</italic></bold>, we define the complete-data vector <bold><italic>Y</italic></bold><sup>∗</sup>=(<bold><italic>Y</italic></bold>,<bold><italic>δ</italic></bold><sub>0</sub>,<bold><italic>δ</italic></bold><sub>1</sub>) where <bold><italic>Y</italic></bold>=(<bold><italic>Y</italic></bold><sub>1</sub>,…,<bold><italic>Y</italic></bold><sub><italic>N</italic></sub>) represents the observed DNAm levels for individuals <italic>i</italic>∈(1,…,<italic>N</italic>) each of length <italic>R</italic> regions. The complete-data likelihood is given by
<disp-formula id="Eque"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$f(\boldsymbol{Y}^{*} | \boldsymbol{\theta}, \boldsymbol{\pi}) = \prod_{i=1}^{N} f_{1}(\boldsymbol{Y}_{i} | \boldsymbol{\delta}_{0}, \boldsymbol{\delta}_{1}, \boldsymbol{\theta}, \boldsymbol{\pi}_{i}) f_{2}(\boldsymbol{\delta}_{0} | \boldsymbol{\theta}) f_{3}(\boldsymbol{\delta}_{1} | \boldsymbol{\theta}) $$ \end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$f_{1} \sim N\left (\sum _{k=1}^{K} \pi _{ik} \{(1-\boldsymbol {Z}_{k}) \boldsymbol {\delta }_{0} + \boldsymbol {Z}_{k} \boldsymbol {\delta }_{1}\}, \tau ^{2} I_{(R \times R)}\right), f_{2} \sim N\left (\alpha _{0}, \sigma _{0}^{2} I_{(R \times R)}\right)$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq24.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$f_{3} \sim N\left (\alpha _{1}, \sigma _{1}^{2} I_{(R \times R)}\right)$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq25.gif"/></alternatives></inline-formula>. It is easy to show the log of the complete-data likelihood is linear in the following complete-data sufficient statistics: <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{1} = \sum _{r=1}^{R} \delta _{0,r}, T_{2} = \sum _{r=1}^{R} \delta _{1,r}, T_{3} = \sum _{r=1}^{R} (\delta _{0,r})^{2}, T_{4} = \sum _{r=1}^{R} (\delta _{1,r})^{2}$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq26.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{5} = \sum _{r=1}^{R} (u_{ir})^{2}$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq27.gif"/></alternatives></inline-formula> where <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$u_{ir} = Y_{ir} - \sum _{k=1}^{K} \pi _{ik} \{(1-Z_{rk}) \delta _{0,r} + Z_{rk} \delta _{1,r}\}$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">rk</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">rk</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq28.gif"/></alternatives></inline-formula>.</p>
        <p>The EM algorithm alternates between the following two steps:
<list list-type="order"><list-item><p><bold>E-Step</bold></p><p>We can consider the two joint distributions <bold><italic>Y</italic></bold><sup>∗</sup>=(<bold><italic>Y</italic></bold>,<bold><italic>δ</italic></bold><sub>0</sub>) and <bold><italic>Y</italic></bold><sup>∗</sup>=(<bold><italic>Y</italic></bold>,<bold><italic>δ</italic></bold><sub>1</sub>) separately since <bold><italic>δ</italic></bold><sub>0</sub> and <bold><italic>δ</italic></bold><sub>1</sub> are independent. The joint distributions are also normally distributed
<disp-formula id="Equf"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}{\begin{aligned} \boldsymbol{Y}^{*} = (\boldsymbol{Y}, \boldsymbol{\delta}_{0}) \sim N \left(\left[ \begin{array}{c} \boldsymbol{X} \boldsymbol{\pi} \\ \alpha_{0} \boldsymbol{1} \end{array} \right]_{((RN + R) \times 1)}, \left[ \begin{array}{cc} \Sigma_{11} &amp; \Sigma_{12} \\ \Sigma_{21} &amp; \Sigma_{22} \\ \end{array} \right]_{((RN+R) \times (RN+R))} \right) \end{aligned}}$$ \end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RN</mml:mtext><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RN</mml:mtext><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RN</mml:mtext><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equf.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equg"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}{\begin{aligned} \boldsymbol{Y}^{*} = (\boldsymbol{Y}, \boldsymbol{\delta}_{1}) \sim N \left(\left[ \begin{array}{c} \boldsymbol{X} \boldsymbol{\pi} \\ \alpha_{1} \boldsymbol{1} \end{array} \right]_{((RN + R) \times 1)}, \left[ \begin{array}{cc} \Sigma_{11} &amp; \Sigma_{12} \\ \Sigma_{21} &amp; \Sigma_{22} \\ \end{array} \right]_{((RN+R) \times (RN+R))} \right) \end{aligned}}$$ \end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RN</mml:mtext><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RN</mml:mtext><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RN</mml:mtext><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> where <bold><italic>Y</italic></bold> is a matrix of dimension <italic>R</italic>×<italic>N</italic>, but we convert this into a vector of length <italic>RN</italic>, <bold><italic>X</italic></bold>=(1−<bold><italic>Z</italic></bold>)<italic>α</italic><sub>0</sub>+<bold><italic>Z</italic></bold><italic>α</italic><sub>1</sub> is an <italic>R</italic>×<italic>K</italic> matrix and <bold><italic>π</italic></bold> is a <italic>K</italic>×<italic>N</italic> matrix. We convert the <bold><italic>X</italic></bold><bold><italic>π</italic></bold> matrix into a vector of length <italic>RN</italic>. To derive the conditional distributions of <bold><italic>δ</italic></bold><sub>0</sub>|<bold><italic>Y</italic></bold> and <bold><italic>δ</italic></bold><sub>1</sub>|<bold><italic>Y</italic></bold>, we use Theorem 3.2.3 and 3.2.4 in [<xref ref-type="bibr" rid="CR34">34</xref>]:
<disp-formula id="Equh"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}{\begin{aligned} \boldsymbol{\delta}_{0} | \boldsymbol{Y} \sim N\left(\alpha_{0} \boldsymbol{1} + \Sigma_{21} \Sigma_{11}^{-1} [\boldsymbol{Y} - \boldsymbol{X} \boldsymbol{\pi}], \Sigma_{22} - \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12}\right) \end{aligned}} $$ \end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> where
<list list-type="bullet"><list-item><label/><p><bold><italic>X</italic></bold>=(1−<bold><italic>Z</italic></bold>)<italic>α</italic><sub>0</sub>+<bold><italic>Z</italic></bold><italic>α</italic><sub>1</sub> is an <italic>R</italic>×<italic>K</italic> matrix. <bold><italic>π</italic></bold> is a <italic>K</italic>×<italic>N</italic> matrix.</p></list-item><list-item><label/><p><italic>Σ</italic><sub>11</sub>=<italic>C</italic><italic>o</italic><italic>v</italic>(<bold><italic>Y</italic></bold>) is an <italic>R</italic><italic>N</italic>×<italic>R</italic><italic>N</italic> covariance matrix with entries
<disp-formula id="Equi"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}{\begin{aligned} Cov(Y_{ir}, Y_{i^{'}r^{'}}) &amp; = W_{0ri}^{2} \sigma_{0}^{2} + W_{1ri}^{2} \sigma_{1}^{2} + \tau^{2} &amp; \texttt{if}\ r=r^{'}, i=i^{'} \\ &amp; = W_{0ri} W_{0ri^{'}} \sigma_{0}^{2} + W_{1ri} W_{1ri^{'}} \sigma_{1}^{2} &amp;\texttt{if}\ r=r^{'}, i \neq i^{'} \\ &amp; = 0 &amp; \texttt{if}\ r\neq r^{'}, i \neq i^{'} \end{aligned}} $$ \end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext mathvariant="monospace">if</mml:mtext><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>r</mml:mi><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>r</mml:mi><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mtext mathvariant="monospace">if</mml:mtext><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext mathvariant="monospace">if</mml:mtext><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq29"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{0ri} = \sum _{k=1}^{K} \pi _{ik} (1-Z_{rk})$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">rk</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq29.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq30"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{1ri} = \sum _{k=1}^{K} \pi _{ik} Z_{rk}$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">rk</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq30.gif"/></alternatives></inline-formula></p></list-item><list-item><label/><p><italic>Σ</italic><sub>12</sub>=<italic>C</italic><italic>o</italic><italic>v</italic>(<bold><italic>Y</italic></bold>,<bold><italic>δ</italic></bold><sub>0</sub>) is an <italic>R</italic><italic>N</italic>×<italic>R</italic> covariance matrix with entries
<disp-formula id="Equj"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} Cov(Y_{ir}, \delta_{0,r^{'}}) &amp; = &amp; W_{0ri} \sigma_{0}^{2} \hspace{.5in} \texttt{if}\ r=r^{'} \\ &amp; = &amp; 0 \hspace{0.87in} \texttt{if}\ r\neq r^{'} \end{array} $$ \end{document}</tex-math><mml:math id="M84"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="36.135pt"/><mml:mtext mathvariant="monospace">if</mml:mtext><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mn>0</mml:mn><mml:mspace width="62.87454pt"/><mml:mtext mathvariant="monospace">if</mml:mtext><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1827_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p><p>Note: <inline-formula id="IEq31"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{12}^{T} = \Sigma _{21}$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq31.gif"/></alternatives></inline-formula>.</p></list-item><list-item><label/><p><italic>Σ</italic><sub>22</sub>=<italic>C</italic><italic>o</italic><italic>v</italic>(<bold><italic>δ</italic></bold><sub>0</sub>) is an <italic>R</italic>×<italic>R</italic> matrix with <inline-formula id="IEq32"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Var(\delta _{0,r}) = \sigma _{0}^{2}$\end{document}</tex-math><mml:math id="M88"><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}Cov(\delta _{0,r}, \delta _{0,r^{'}}) = 0$\end{document}</tex-math><mml:math id="M90"><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq33.gif"/></alternatives></inline-formula></p></list-item></list></p><p>We use the conditional distribution <bold><italic>δ</italic></bold><sub>0</sub>|<bold><italic>Y</italic></bold> to calculate the <italic>t</italic>th iteration in the E-Step when computing <italic>E</italic><sub><italic>θ</italic></sub>(<italic>T</italic><sub>1</sub>|<bold><italic>Y</italic></bold>) and <italic>E</italic><sub><italic>θ</italic></sub>(<italic>T</italic><sub>3</sub>|<bold><italic>Y</italic></bold>).
<disp-formula id="Equk"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}{\begin{aligned}T_{1}^{(t)} &amp; = \sum_{r=1}^{R} \left[ \hat{\alpha}_{0}^{(t)} \boldsymbol{1} + \hat{\Sigma}_{21}^{(t)} \left(\hat{\Sigma}_{11}^{(t)}\right)^{-1} \left[\boldsymbol{Y}_{i} - \left\{(1-\boldsymbol{Z}) \hat{\alpha}_{0}^{(t)} + \boldsymbol{Z} \hat{\alpha}_{1}^{(t)} \right\} \hat{\boldsymbol{\pi}}\right] \right] \\ T_{3}^{(t)} &amp; = \sum_{r=1}^{R} \left[ \hat{\alpha}_{0}^{(t)} \boldsymbol{1} + \hat{\Sigma}_{21}^{(t)} \left(\hat{\Sigma}_{11}^{(t)}\right)^{-1} [\boldsymbol{Y}_{i} - \left\{(1-\boldsymbol{Z}) \hat{\alpha}_{0}^{(t)} + \boldsymbol{Z} \hat{\alpha}_{1}^{(t)} \right\} \hat{\boldsymbol{\pi}}] \right]^{2}\\ &amp;\quad+ diag\left(\hat{\Sigma}_{22}^{(t)} - \hat{\Sigma}_{21}^{(t)} \left(\hat{\Sigma}_{11}^{(t)}\right)^{-1} \hat{\Sigma}_{12}^{(t)} \right) \end{aligned}} $$ \end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>]</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">diag</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> Similarly, we can show
<disp-formula id="Equl"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}\boldsymbol{\delta}_{1} | \boldsymbol{Y} \sim N\left(\alpha_{1} \boldsymbol{1} + \Sigma_{21} \Sigma_{11}^{-1} [\boldsymbol{Y} - \boldsymbol{X} \boldsymbol{\pi}], \Sigma_{22} - \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12}\right) $$ \end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> where
<list list-type="bullet"><list-item><label/><p><bold><italic>X</italic></bold>=(1−<bold><italic>Z</italic></bold>)<italic>α</italic><sub>0</sub>+<bold><italic>Z</italic></bold><italic>α</italic><sub>1</sub> is an <italic>R</italic>×<italic>K</italic> matrix. <bold><italic>π</italic></bold> is a <italic>K</italic>×<italic>N</italic> matrix.</p></list-item><list-item><label/><p><italic>Σ</italic><sub>11</sub>=<italic>C</italic><italic>o</italic><italic>v</italic>(<bold><italic>Y</italic></bold>) is same as defined above.</p></list-item><list-item><label/><p><italic>Σ</italic><sub>12</sub>=<italic>C</italic><italic>o</italic><italic>v</italic>(<bold><italic>Y</italic></bold>,<bold><italic>δ</italic></bold><sub>1</sub>) is an <italic>R</italic><italic>N</italic>×<italic>R</italic> covariance matrix with entries
<disp-formula id="Equm"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} Cov(Y_{ir}, \delta_{1,r^{'}}) &amp; = &amp; W_{1ri} \sigma_{1}^{2} \hspace{.5in} \texttt{if}\ r=r^{'} \\ &amp; = &amp; 0 \hspace{0.87in} \texttt{if}\ r\neq r^{'} \end{array} $$ \end{document}</tex-math><mml:math id="M96"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">ri</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="36.135pt"/><mml:mtext mathvariant="monospace">if</mml:mtext><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mn>0</mml:mn><mml:mspace width="62.87454pt"/><mml:mtext mathvariant="monospace">if</mml:mtext><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1827_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p><p>Note: <inline-formula id="IEq34"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{12}^{T} = \Sigma _{21}$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq34.gif"/></alternatives></inline-formula>.</p></list-item><list-item><label/><p><italic>Σ</italic><sub>22</sub>=<italic>C</italic><italic>o</italic><italic>v</italic>(<bold><italic>δ</italic></bold><sub>1</sub>) is an <italic>R</italic>×<italic>R</italic> matrix with <inline-formula id="IEq35"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Var(\delta _{1,r}) = \sigma _{1}^{2}$\end{document}</tex-math><mml:math id="M100"><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq35.gif"/></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}Cov(\delta _{1,r}, \delta _{1,r^{'}}) = 0$\end{document}</tex-math><mml:math id="M102"><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq36.gif"/></alternatives></inline-formula></p></list-item></list></p><p>We use the conditional distribution <bold><italic>δ</italic></bold><sub>1</sub>|<bold><italic>Y</italic></bold> to calculate the <italic>t</italic><sup><italic>t</italic><italic>h</italic></sup> iteration in the E-Step when computing <italic>E</italic><sub><italic>θ</italic></sub>(<italic>T</italic><sub>2</sub>|<bold><italic>Y</italic></bold>) and <italic>E</italic><sub><italic>θ</italic></sub>(<italic>T</italic><sub>4</sub>|<bold><italic>Y</italic></bold>).
<disp-formula id="Equn"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}{\begin{aligned} T_{2}^{(t)} &amp; = \sum_{r=1}^{R} \left[ \hat{\alpha}_{1}^{(t)} \boldsymbol{1} + \hat{\Sigma}_{21}^{(t)} \left(\hat{\Sigma}_{11}^{(t)}\right)^{-1} \left[\boldsymbol{Y} - \left\{(1-\boldsymbol{Z}) \hat{\alpha}_{0}^{(t)} + \boldsymbol{Z} \hat{\alpha}_{1}^{(t)} \right\} \hat{\boldsymbol{\pi}}\right] \right] \\ T_{4}^{(t)} &amp; = \sum_{r=1}^{R} \left[ \hat{\alpha}_{1}^{(t)} \boldsymbol{1} + \hat{\Sigma}_{21}^{(t)} \left(\hat{\Sigma}_{11}^{(t)}\right)^{-1} \left[\boldsymbol{Y} - \left\{(1-\boldsymbol{Z}) \hat{\alpha}_{0}^{(t)} + \boldsymbol{Z} \hat{\alpha}_{1}^{(t)} \right\} \hat{\boldsymbol{\pi}}\right] \right]^{2}\\&amp;\quad + diag\left(\hat{\Sigma}_{22}^{(t)} - \hat{\Sigma}_{21}^{(t)} \left(\hat{\Sigma}_{11}^{(t)}\right)^{-1} \hat{\Sigma}_{12}^{(t)} \right) \end{aligned}} $$ \end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">diag</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equn.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p><bold>M-Step</bold></p><p>The complete-data maximum likelihood estimates (MLEs) were calculated by using the log of the complete-data likelihood, taking the derivative with respect to the individual parameters, setting the likelihood equal to zero and solving for the MLEs.
<disp-formula id="Equo"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \hat{\alpha}_{0} &amp; = &amp; \frac{T_{1}}{R} \\ \hat{\alpha}_{1} &amp; = &amp; \frac{T_{2}}{R} \\ \hat{\sigma}_{0}^{2} &amp; = &amp; \frac{T_{3}}{R} - (\hat{\alpha}_{0})^{2} \\ \hat{\sigma}_{1}^{2} &amp; = &amp; \frac{T_{4}}{R} - (\hat{\alpha}_{1})^{2} \end{array} $$ \end{document}</tex-math><mml:math id="M106"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1827_Article_Equo.gif" position="anchor"/></alternatives></disp-formula></p><p>Using these MLEs, we can substitute the sufficient statistics calculated in the E-Step:
<disp-formula id="Equp"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \hat{\alpha}_{0}^{(t+1)} &amp; = &amp; \frac{T_{1}^{(t)}}{R} \\ \hat{\alpha}_{1}^{(t+1)} &amp; = &amp; \frac{T_{2}^{(t)}}{R} \\ (\hat{\sigma}_{0}^{2})^{(t+1)} &amp; = &amp; \frac{T_{3}^{(t)}}{R} - \left(\hat{\alpha}_{0}^{(t+1)}\right)^{2} \\ (\hat{\sigma}_{1}^{2})^{(t+1)} &amp; = &amp; \frac{T_{4}^{(t)}}{R} - \left(\hat{\alpha}_{1}^{(t+1)}\right)^{2} \end{array} $$ \end{document}</tex-math><mml:math id="M108"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1827_Article_Equp.gif" position="anchor"/></alternatives></disp-formula></p><p>To estimate <bold><italic>π</italic></bold><sub><italic>i</italic></sub>, we apply quadratic programming [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] (see section on “<xref rid="Sec15" ref-type="sec">Obtain initial parameter estimates <bold><italic>θ</italic></bold><sup>(0)</sup> and <inline-formula id="IEq37"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bgroup \relax \unhbox \voidb@x \special {t4ht=&lt;mstyle mathvariant="bold-italic"&gt;}\pi \relax \unhbox \voidb@x \special {t4ht=&lt;/mstyle&gt;}\egroup _{i}^{(0)}$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq37.gif"/></alternatives></inline-formula> at step <italic>t</italic>=0</xref>” for details) with the constraints <inline-formula id="IEq38"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{k=1}^{K} \pi _{ik} = 1$\end{document}</tex-math><mml:math id="M112"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq38.gif"/></alternatives></inline-formula> and <italic>π</italic><sub><italic>ik</italic></sub>≥0 for all <italic>k</italic>. We calculate <bold><italic>X</italic></bold><sup>(<italic>t</italic>)</sup> using the <italic>t</italic><sup><italic>t</italic><italic>h</italic></sup> iteration of the conditional expectations <italic>E</italic><sub><italic>θ</italic></sub>(<bold><italic>δ</italic></bold><sub>0</sub>|<bold><italic>Y</italic></bold>) and <italic>E</italic><sub><italic>θ</italic></sub>(<bold><italic>δ</italic></bold><sub>1</sub>|<bold><italic>Y</italic></bold>) then apply quadratic programming [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] to solve for <inline-formula id="IEq39"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ \hat {\boldsymbol {\pi }}_{i}^{(t+1)}= \left (\pi _{i1}^{(t+1)}, \ldots, \pi _{iK}^{(t+1)}\right)$\end{document}</tex-math><mml:math id="M114"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iK</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq39.gif"/></alternatives></inline-formula>. We use the solve.QP() function from the R package quadprog [<xref ref-type="bibr" rid="CR33">33</xref>] to implement the quadratic programming.</p><p>Finally, the MLE for <italic>τ</italic><sup>2</sup>, was calculated by using the log of the complete-data likelihood, taking derivative with respect to <italic>τ</italic><sup>2</sup>, setting likelihood equal to zero and solving.
<disp-formula id="Equq"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$(\hat{\tau}^{2})^{(t+1)} = \frac{1}{R*N} \sum_{i=1}^{N} \sum_{r=1}^{R} \left(Y_{ir} - \sum_{k=1}^{K} X_{rk}^{(t)} \pi_{ik}^{(t+1)}\right)^{2} $$ \end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>∗</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">rk</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equq.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Details for simulation studies</title>
      <p>We created platform-dependent cell type-specific DNAm profiles for the <italic>k</italic><sup><italic>t</italic><italic>h</italic></sup> cell type (<inline-formula id="IEq40"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}_{k}^{450K}$\end{document}</tex-math><mml:math id="M118"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>450</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}_{k}^{RRBS}$\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RRBS</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq41.gif"/></alternatives></inline-formula>) where <inline-formula id="IEq42"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}_{k}^{*} = (1-\boldsymbol {Z}_{k}) \boldsymbol {\delta }_{0}^{*} + \boldsymbol {Z}_{k} \boldsymbol {\delta }_{1}^{*}$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq42.gif"/></alternatives></inline-formula> by simulating platform-dependent random effects <inline-formula id="IEq43"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\boldsymbol {\delta }_{l}^{*} \sim N(\alpha _{l}^{*}, (\sigma _{l}^{2})^{*} I_{(R \times R)}\right)$\end{document}</tex-math><mml:math id="M124"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq43.gif"/></alternatives></inline-formula> for both <italic>l</italic>=0,1 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). For each whole blood DNAm sample (<italic>N</italic>=200), we simulate a relative proportion of cell types (<bold><italic>π</italic></bold><sub><italic>i</italic></sub>) and measurement error (<bold><italic>ε</italic></bold><sub><italic>i</italic></sub>) to create the observed DNAm level in the 450k array platform <inline-formula id="IEq44"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\boldsymbol {Y}_{i}^{450k} = \sum _{k=1}^{K} \boldsymbol {\pi }_{ik} \boldsymbol {X}_{k}^{450k} + \boldsymbol {\varepsilon }_{i}\right)$\end{document}</tex-math><mml:math id="M126"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>450</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>450</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq44.gif"/></alternatives></inline-formula> and the RRBS platform <inline-formula id="IEq45"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\boldsymbol {Y}_{i}^{RRBS} = \sum _{k=1}^{K} \boldsymbol {\pi }_{ik} \boldsymbol {X}_{k}^{RRBS} + \boldsymbol {\varepsilon }_{i}\right)$\end{document}</tex-math><mml:math id="M128"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RRBS</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RRBS</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq45.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec18">
      <title>Assessment of performance</title>
      <p>Next, we estimate the cell composition of, for example, the 450k array and RRBS samples using both the reference-based Houseman method and our platform-agnostic method. We do not scale the cell compositions estimates to 1 to allow for potential unaccounted cell types.</p>
      <p>We calculate the cell type-specific <italic>R</italic><italic>M</italic><italic>S</italic><italic>E</italic><sub><italic>k</italic></sub> as
<disp-formula id="Equr"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$RMSE_{k} = \sqrt{\frac{1}{N} \sum_{i=1}^{N} (\hat{\pi}_{ik} - \pi_{ik})^{2}} $$ \end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mtext mathvariant="italic">RMS</mml:mtext><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="13059_2019_1827_Article_Equr.gif" position="anchor"/></alternatives></disp-formula> where <italic>π</italic><sub><italic>ik</italic></sub> is the true cell composition and <inline-formula id="IEq46"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{ik}$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1827_Article_IEq46.gif"/></alternatives></inline-formula> is the estimated cell composition (using either Houseman model or our proposed model) in the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> sample and <italic>k</italic>th cell type. The cell type-specific <italic>R</italic><italic>M</italic><italic>S</italic><italic>E</italic><sub><italic>k</italic></sub> is averaged across cell types and recorded as the mean RMSE. We repeat the above <italic>n</italic><sub><italic>sims</italic></sub>=100 times to calculate the distribution of mean RMSE.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1827_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary Figures S1-S7.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1827-8.</p>
  </sec>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>SCH and RAI developed the method methylCC. SCH wrote the methylCC R package, analyzed DNAm data and performed the simulation studies. SCH and RAI wrote the manuscript. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>SCH and RAI were supported by NIH R01 grants GM083084 and RR021967/GM103552 and HG005220.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>All results in this paper are based only on publicly available data and do not require ethics approval.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinius</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Acevedo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Joerink</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pershagen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dahlén</surname>
            <given-names>S-E</given-names>
          </name>
          <name>
            <surname>Greco</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Söderhäll</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Scheynius</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kere</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Differential DNA methylation in purified human blood cells: implications for cell lineage and studies on disease susceptibility</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>7</issue>
        <fpage>41361</fpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schübeler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Epigenomics: Methylation matters</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>462</volume>
        <issue>7271</issue>
        <fpage>296</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 19924205?>
        <pub-id pub-id-type="pmid">19924205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Accomando</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Koestler</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Wiencke</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>KT</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation arrays as surrogate measures of cell mixture distribution</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>86</fpage>
        <?supplied-pmid 22568884?>
        <pub-id pub-id-type="pmid">22568884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rakyan</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Down</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Epigenome-wide association studies for common human diseases</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>8</issue>
        <fpage>529</fpage>
        <lpage>41</lpage>
        <?supplied-pmid 21747404?>
        <pub-id pub-id-type="pmid">21747404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Accounting for cellular heterogeneity is critical in epigenome-wide association studies</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>31</fpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rakyan</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Down</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Maslau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andrew</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>T. -P.</given-names>
          </name>
          <name>
            <surname>Beyan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McCann</surname>
            <given-names>OT</given-names>
          </name>
          <name>
            <surname>Finer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Valdes</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Deloukas</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Spector</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>Human aging-associated DNA hypermethylation occurs preferentially at bivalent chromatin domains</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>434</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 20219945?>
        <pub-id pub-id-type="pmid">20219945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Gentry-Maharaj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramus</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Weisenberger</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Campan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Noushmehr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Maxwell</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Savage</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Mueller-Holzner</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kocjan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gayther</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Widschwendter</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Age-dependent DNA methylation of genes that are suppressed in stem cells is a hallmark of cancer</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>440</fpage>
        <lpage>6</lpage>
        <?supplied-pmid 20219944?>
        <pub-id pub-id-type="pmid">20219944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alisch</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Barwick</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Chopra</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Myrick</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Satten</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Conneely</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>ST</given-names>
          </name>
        </person-group>
        <article-title>Age-associated dna methylation in pediatric populations</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>4</issue>
        <fpage>623</fpage>
        <lpage>32</lpage>
        <?supplied-pmid 22300631?>
        <pub-id pub-id-type="pmid">22300631</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bell</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>P-C</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>T-P</given-names>
          </name>
          <name>
            <surname>Pidsley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nisbet</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mangino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Valdes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>S-Y</given-names>
          </name>
          <name>
            <surname>Dempster</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Grundberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hedman</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Nica</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Small</surname>
            <given-names>KS</given-names>
          </name>
          <collab>MuTHER Consortium</collab>
          <name>
            <surname>Dermitzakis</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Mill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spector</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Deloukas</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Epigenome-wide scans identify differentially methylated regions for age and age-related phenotypes in a healthy ageing population</article-title>
        <source>PLoS Genet</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>1002629</fpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hannum</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Guinney</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sadda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Klotzle</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bibikova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J. -B.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Deconde</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rajapakse</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Friend</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ideker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide methylation profiles reveal quantitative views of human aging rates</article-title>
        <source>Mol Cell</source>
        <year>2013</year>
        <volume>49</volume>
        <issue>2</issue>
        <fpage>359</fpage>
        <lpage>367</lpage>
        <?supplied-pmid 23177740?>
        <pub-id pub-id-type="pmid">23177740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kahn</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Boks</surname>
            <given-names>MPM</given-names>
          </name>
          <name>
            <surname>van Eijk</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>van den Berg</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Ophoff</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Aging effects on DNA methylation modules in human brain and blood tissue</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>97</fpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johansson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Enroth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gyllensten</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Continuous Aging of the Human DNA Methylome Throughout the Human Lifespan</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>67378</fpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houseman</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Molitor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marsit</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Reference-free cell mixture adjustments in analysis of DNA methylation data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>10</issue>
        <fpage>1431</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 24451622?>
        <pub-id pub-id-type="pmid">24451622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lippert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Listgarten</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Epigenome-wide association studies without the need for cell-type composition</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>309</fpage>
        <lpage>11</lpage>
        <?supplied-pmid 24464286?>
        <pub-id pub-id-type="pmid">24464286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>
        <source>PLoS Genet</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>9</issue>
        <fpage>1724</fpage>
        <lpage>35</lpage>
        <?supplied-pmid 17907809?>
        <pub-id pub-id-type="pmid">17907809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagnon-Bartsch</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Using control genes to correct for unwanted variation in microarray data</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>3</issue>
        <fpage>539</fpage>
        <lpage>52</lpage>
        <?supplied-pmid 22101192?>
        <pub-id pub-id-type="pmid">22101192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McGregor</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bernatsky</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Colmegna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hudson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pastinen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Labbe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Greenwood</surname>
            <given-names>CMT</given-names>
          </name>
        </person-group>
        <article-title>An evaluation of methods correcting for cell-type heterogeneity in DNA methylation studies</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>84</fpage>
        <?supplied-pmid 27142380?>
        <pub-id pub-id-type="pmid">27142380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Koestler</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Houseman</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Correcting for cell-type heterogeneity in epigenome-wide association studies: revisiting previous analyses</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>216</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 28245219?>
        <pub-id pub-id-type="pmid">28245219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bibikova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Saedinia-Melnyk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gunderson</surname>
            <given-names>KL</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide DNA methylation profiling using Infinium® assay</article-title>
        <source>Epigenomics</source>
        <year>2009</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>177</fpage>
        <lpage>200</lpage>
        <?supplied-pmid 22122642?>
        <pub-id pub-id-type="pmid">22122642</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bibikova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tsan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Klotzle</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Delano</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Gunderson</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>High density DNA methylation array with single CpG site resolution</article-title>
        <source>Genomics</source>
        <year>2011</year>
        <volume>98</volume>
        <issue>4</issue>
        <fpage>288</fpage>
        <lpage>95</lpage>
        <?supplied-pmid 21839163?>
        <pub-id pub-id-type="pmid">21839163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Ramsahoye</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Jaenisch</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Reduced representation bisulfite sequencing for comparative high-resolution DNA methylation analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <issue>18</issue>
        <fpage>5868</fpage>
        <lpage>77</lpage>
        <?supplied-pmid 16224102?>
        <pub-id pub-id-type="pmid">16224102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahmani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schweiger</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shenhav</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wingert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hofer</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gabel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>BayesCCE: a Bayesian framework for estimating cell-type composition from DNA methylation without the need for methylation reference</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>141</fpage>
        <?supplied-pmid 30241486?>
        <pub-id pub-id-type="pmid">30241486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>BLUEPRINT consortium</collab>
        </person-group>
        <article-title>Quantitative comparison of DNA methylation assays for biomarker development and clinical applications</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>7</issue>
        <fpage>726</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="pmid">27347756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahmani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Baran</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Galanter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Oh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burchard</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Sparse PCA corrects for cell type heterogeneity in epigenome-wide association studies</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>443</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 27018579?>
        <pub-id pub-id-type="pmid">27018579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Padyukov</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fallin</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Hesselberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Runarsson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Acevedo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Taub</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ronninger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shchetynsky</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Scheynius</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kere</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alfredsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Klareskog</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ekström</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Epigenome-wide association data implicate DNA methylation as an intermediary of genetic risk in rheumatoid arthritis</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>142</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 23334450?>
        <pub-id pub-id-type="pmid">23334450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Murakami</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Fallin</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Bump hunting to identify differentially methylated regions in epigenetic epidemiology studies</article-title>
        <source>Int J Epidemiol</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>1</issue>
        <fpage>200</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 22422453?>
        <pub-id pub-id-type="pmid">22422453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carvalho</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gatto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Girke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>MacDonald</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Obenchain</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Oleś</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shannon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Tenenbaum</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>115</fpage>
        <lpage>21</lpage>
        <?supplied-pmid 25633503?>
        <pub-id pub-id-type="pmid">25633503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Corrada-Bravo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ladd-Acosta</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Minfi: a flexible and comprehensive Bioconductor package for the analysis of Infinium DNA methylation microarrays</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>10</issue>
        <fpage>1363</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 24478339?>
        <pub-id pub-id-type="pmid">24478339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>83</fpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korthauer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chakraborty</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Detection and accurate false discovery rate control of differentially methylated regions from whole genome bisulfite sequencing</article-title>
        <source>Biostatistics</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>367</fpage>
        <lpage>383</lpage>
        <?supplied-pmid 29481604?>
        <pub-id pub-id-type="pmid">29481604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Goldfarb</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Idnani</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Dual and primal-dual methods for solving strictly convex quadratic programs</article-title>
        <source>Lecture Notes in Mathematics</source>
        <year>1982</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
        <fpage>226</fpage>
        <lpage>239</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldfarb</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Idnani</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A numerically stable dual method for solving strictly convex quadratic programs</article-title>
        <source>Math Program</source>
        <year>1983</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>33</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">Turlach BA, Weingessel A. Quadprog: Functions to Solve Quadratic Programming Problems. 2013. R package version 1.5-5. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=quadprog">https://CRAN.R-project.org/package=quadprog</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mardia</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Bibby</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <source>Multivariate Analysis</source>
        <year>1979</year>
        <publisher-loc>San Diego</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <mixed-citation publication-type="other">Hicks SC, Irizarry RA. stephaniehicks/methylCC: Estimate the cell composition of whole blood in DNA methylation samples. GitHub. 2019. 10.5281/zenodo.3408423.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <mixed-citation publication-type="other">Jaffe AE. FlowSorted.Blood.450k: Illumina HumanMethylation Data on Sorted Blood Cell Populations. 2018. R package version 1.20.0. 10.18129/B9.bioc.FlowSorted.Blood.450k. <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/FlowSorted.Blood.450k">https://www.bioconductor.org/packages/FlowSorted.Blood.450k</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pino-Yanes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thakur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gignoux</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Galanter</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nishimura</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Oh</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Vora</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huntsman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Conti</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Moreno-Estrada</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sandoval</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Borrell</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Lurmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Islam</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Farber</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Meade</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Avila</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Serebrisky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bibbins-Domingo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lenoir</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Brigino-Buenaventura</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rodriguez-Cintron</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Thyne</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Sen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rodriguez-Santana</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Gilliland</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Gauderman</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Torgerson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Burchard</surname>
            <given-names>EG</given-names>
          </name>
        </person-group>
        <article-title>Genetic ancestry influences asthma susceptibility and lung function among Latinos</article-title>
        <source>J Allergy Clin Immunol</source>
        <year>2015</year>
        <volume>135</volume>
        <issue>1</issue>
        <fpage>228</fpage>
        <lpage>35</lpage>
        <?supplied-pmid 25301036?>
        <pub-id pub-id-type="pmid">25301036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carmona</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Accomando Jr.</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Binder</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Hutchinson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Pantano</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Izzi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Just</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vokonas</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Amr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Baccarelli</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Michels</surname>
            <given-names>KB</given-names>
          </name>
        </person-group>
        <article-title>Empirical comparison of reduced representation bisulfite sequencing and Infinium BeadChip reproducibility and coverage of DNA methylation in humans</article-title>
        <source>NPJ Genom Med</source>
        <year>2017</year>
        <volume>2</volume>
        <fpage>13</fpage>
        <?supplied-pmid 29263828?>
        <pub-id pub-id-type="pmid">29263828</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
