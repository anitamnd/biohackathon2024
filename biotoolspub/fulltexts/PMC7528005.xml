<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7528005</article-id>
    <article-id pub-id-type="pmid">32999342</article-id>
    <article-id pub-id-type="publisher-id">72979</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-72979-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Efficient microbial colony growth dynamics quantification with ColTapp, an automated image analysis application</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Bär</surname>
          <given-names>Julian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Boumasmoud</surname>
          <given-names>Mathilde</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kouyos</surname>
          <given-names>Roger D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zinkernagel</surname>
          <given-names>Annelies S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Vulin</surname>
          <given-names>Clément</given-names>
        </name>
        <address>
          <email>clement.vulin@usz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.7400.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0650</institution-id><institution>Department of Infectious Diseases and Hospital Epidemiology, University Hospital Zurich, </institution><institution>University of Zurich, </institution></institution-wrap>Zurich, Switzerland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7400.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0650</institution-id><institution>Institute of Medical Virology, </institution><institution>University of Zurich, </institution></institution-wrap>Zurich, Switzerland </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution>Institute of Biogeochemistry and Pollutant Dynamics, </institution><institution>ETH Zurich, </institution></institution-wrap>8092 Zurich, Switzerland </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.418656.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 1551 0562</institution-id><institution>Department of Environmental Microbiology, </institution></institution-wrap>8600 Eawag, Dubendorf Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>16084</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Populations of genetically identical bacteria are phenotypically heterogeneous, giving rise to population functionalities that would not be possible in homogeneous populations. For instance, a proportion of non-dividing bacteria could persist through antibiotic challenges and secure population survival. This heterogeneity can be studied in complex environmental or clinical samples by spreading the bacteria on agar plates and monitoring time to growth resumption in order to infer their metabolic state distribution. We present ColTapp, the Colony Time-lapse application for bacterial colony growth quantification. Its intuitive graphical user interface allows users to analyze time-lapse images of agar plates to monitor size, color and morphology of colonies. Additionally, images at isolated timepoints can be used to estimate lag time. Using ColTapp, we analyze a dataset of <italic>Staphylococcus aureus</italic> time-lapse images including populations with heterogeneous lag time. Colonies on dense plates reach saturation early, leading to overestimation of lag time from isolated images. We show that this bias can be corrected by taking into account the area available to each colony on the plate. We envision that in clinical settings, improved analysis of colony growth dynamics may help treatment decisions oriented towards personalized antibiotic therapies.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Microbiology</kwd>
      <kwd>Applied microbiology</kwd>
      <kwd>Clinical microbiology</kwd>
      <kwd>Environmental microbiology</kwd>
      <kwd>Biological techniques</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id>
            <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31003A_176252</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Delayed and insufficient clearance of bacterial infections leading to treatment failure is associated with antibiotic resistance as well as antibiotic persistence. In antibiotic persistence, a subpopulation of bacteria, termed persister cells, can survive antibiotic challenges due to their phenotypic state of metabolic inactivity and then reconstitute the population by resuming growth when the stress is relieved<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. This manifestation of phenotypic heterogeneity exists even in homogeneous liquid cultures, where each bacterial cell experiences the same local conditions<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. On top of this, bacteria often aggregate in dense communities such as biofilms, where environmental conditions are highly heterogeneous and further promote wide phenotypic distributions<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>.</p>
    <p id="Par3">The clinical relevance of antibiotic persistence remains poorly understood. The main reason for this is that the existence and extent of persistence is difficult to assess because it is a transient phenotype and only concerns a small fraction of the bacterial population. However, these inactive bacteria are lagging longer than already actively dividing bacteria when plated on nutrient-rich agar medium, and the bacterial colonies’ macroscopic appearance time is a good proxy of single-cell lag time<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>. For this reason, Levin-Reisman and co-authors proposed ScanLag, a platform to monitor colony growth dynamics with time-lapse imaging<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup>.</p>
    <p id="Par4">In clinical settings, the direct observation of colony growth dynamics from bacteria recovered from infection sites is rare<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>. Typically, in clinical microbiology laboratories the patient’s samples are plated and observed at a single timepoint, e.g. after 18 h of incubation. Colonies which are smaller than the bulk at that timepoint have been associated with antibiotic tolerance, persister cells and relapsing infections<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Small colonies can result either from mutations that affect growth rate (small colony variants<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>) or from heterogeneous growth resumption<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>. Reading solely the colony size at a given timepoint does not allow to distinguish between these two phenomena. Moreover, while a bimodal classification, e.g. small or “normal”, may be appropriate to describe differences in colony size due to genetic changes<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>, it fails to be quantitative when the range of observed colony sizes is not bimodal. This is a problem because phenotypic heterogeneity in single cell lag times typically results in unimodal colony size distributions with long tails of small colonies, and the experimenter is left with defining subjective cutoff values.</p>
    <p id="Par5">We anticipate that investigation of the antibiotic persistence phenomenon’s clinical relevance will greatly rely on colony growth dynamics analyses. Therefore, we propose to bridge the technical gap with a new analysis tool, the Colony Time-lapse application (ColTapp). Its goal is to promote wide access to colony growth dynamics quantification and enable diagnostic microbiology laboratories to further improve their routines. ColTapp is an image analysis pipeline embedded in an intuitive graphical user interface, which allows any user to derive colony sizes, growth rates and appearance times from time-lapse images of bacterial colonies. It also includes the possibility to estimate colony growth parameters from endpoint images. Additionally, it can report metrics characterizing colony color, outline and texture (morphology descriptors), and proximity of neighboring colonies (spatial metrics). We speculate that ColTapp will prove useful in a broad spectrum of microbiology applications, such as species identification in environmental samples as shown by Ernebjerg and Kishony<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p>
    <p id="Par6">A technical problem common to both clinical and environmental samples is the difficulty to assess their initial bacterial density: samples can be accidentally plated at high or uneven densities. Yet, colonies compete for nutrients on the agar plates and thus the total number of colonies and their spatial distribution impacts their size at an endpoint<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. This results in difficult appearance time estimation. To address this problem, as well as demonstrate the applicability of ColTapp, we present a dataset of <italic>Staphylococcus aureus</italic> bacterial colony time-lapse images and explore their response to density. The colonies’ Voronoi cell areas, one of the spatial metrics computed by ColTapp and previously explored in the context of colony growth<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, can be taken into account to minimize the bias in appearance time estimation due to density.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>A user-friendly application implementing image- and downstream analysis</title>
      <p id="Par7">ColTapp takes images as input and implements image analysis functions to detect microbial colonies and track colony radius over time when images are part of a time-lapse sequence. Common formats (png, single page tiff, jpeg, and bmp) and either color (Red Green Blue) or grayscale images are supported. ColTapp also includes downstream analysis steps, to extract biologically relevant data such as colony growth rate and appearance time. A graphical user interface (GUI) provides access to all functionalities, displays the images and enables early visual evaluation of the results with simple data visualization options (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). An <italic>Options</italic> menu allows the user to change parameter values and access optional functionalities (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref>, Supplementary text <xref rid="MOESM1" ref-type="media">8</xref>) The generated data can be exported in a standard csv file (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3</xref>, Supplementary text <xref rid="MOESM1" ref-type="media">9</xref>).<fig id="Fig1"><label>Figure 1</label><caption><p>ColTapp graphical user interface and analysis workflow. (<bold>a</bold>) For visualization, results are overlaid onto the images: typically, the circles representing detected colonies and the edges of the Voronoi tessellation shown here in blue on the image. The main analysis panel, on the left of the image, is separated in three tabs. Here the <italic>Detect</italic> tab, which allows the user to detect colonies on a plate, is visualized. The <italic>Main</italic> tab, which allows the user to analyze either time-lapse or endpoint images and the <italic>Visualize</italic> tab are displayed on the Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>. (<bold>b</bold>) Schematic of simple image acquisition setups including a camera holder. An Arduino board (blue icon) can be used to trigger the camera automatically for time-lapse imaging of a plate (<xref rid="Sec9" ref-type="sec">Materials and methods</xref>, Image acquisition, for implementation). ColTapp operates in two modes: either <italic>Time-lapse</italic> (TL) or <italic>Endpoint</italic> (EP) mode, depending on input data, illustrated by the two different folders (turquoise and yellow respectively). The turquoise highlighted functionalities are specific to the <italic>Time-lapse</italic> mode, while the yellow highlighted ones are specific to <italic>Endpoint</italic> mode. In the middle, the green highlighted functionalities are common to both modes. Note that each step of the workflow (apart from the two which are detailed in the following sections) has a corresponding section in the Supplementary text, which may serve as a guide to the user. For example, the “Analysis set-up” is described in the Supplementary text <xref rid="MOESM1" ref-type="media">2</xref>: a user may define the area of analysis on its images, as shown here in turquoise on the 3 example images. The implementation of the “colony detection” and “radius tracking over time” algorithms are described in the <xref rid="Sec9" ref-type="sec">Materials and methods</xref> and illustrated here with small subsets of Figs. <xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig">7</xref> respectively. The colony characteristics are illustrated here with a small subset of the Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4</xref>.</p></caption><graphic xlink:href="41598_2020_72979_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">The application’s workflow from raw images to exported data is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b. The program operates in two different modes, depending on the user input data: endpoint images or time-lapse images. In the first mode, <italic>Time-Lapse</italic> (TL), images in a folder are considered as an ordered time-lapse image series of a single plate. In the second mode, <italic>Endpoint</italic> (EP), all images in a folder are considered independent from each other. Typically, they are an aggregate of images from several plated samples or from replicates of the same sample, captured at a single timepoint.</p>
      <p id="Par9">The implementation of the two main image analysis algorithms is described in the <xref rid="Sec9" ref-type="sec">Materials and methods</xref> (Colony detection algorithm implementation and Radius tracking algorithm implementation). The user is referred to the supplementary information for more detailed directives concerning interaction with the interface, quality control functionalities, parameters optimization and performance assessment of the algorithms.</p>
      <p id="Par10">In the following sections, the downstream analyses to derive growth parameters from the resulting data are demonstrated on a dataset of 22 time-lapse movies of <italic>S. aureus</italic> colonies growing on blood agar plates, designed to include both homogeneous and heterogenous colony lag time and various colony densities. Note that in addition to growth parameters, a palette of colony characteristics may be exported by the user for further analysis, including spatial metrics and morphology descriptors (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4</xref>, Supplementary text <xref rid="MOESM1" ref-type="media">4</xref>). Although we focus on <italic>S. aureus</italic> grown on blood agar in this work, ColTapp can process images of many different bacterial species growing on different colored agar media (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5</xref> and S6, Supplementary text <xref rid="MOESM1" ref-type="media">3</xref>.4).</p>
      <p id="Par11">In conclusion, an example is given to show how the ColTapp-derived measurements of radius, growth rate and appearance time can be used to assess the influence of colony density on appearance time estimation from endpoint images and how spatial metrics can be used to correct for density effects.</p>
    </sec>
    <sec id="Sec4">
      <title>Appearance time and growth rate determination from time-lapse images</title>
      <p id="Par12">Colonies formed by non-swimming bacteria pass through three growth phases (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Initially, when all bacteria forming the colony can access nutrients and thus contribute to its expansion, the colony radius increases exponentially while the colony also increases in height. Eventually, bacteria at the center of the colony do not have access to nutrients diffusing from the edge of the colony. The zone of growth at the edge of the colony becomes constant and the radial growth rate becomes linear (at this point radius = R<sub>lin</sub>, see Fig. <xref rid="Fig2" ref-type="fig">2</xref>b)<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. Finally, when the nutrients become scarce, or when growth byproducts reach an inhibitory concentration, the colony enters the saturation phase, during which the radial growth rate starts decreasing towards 0<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. Supplementary Fig. <xref rid="MOESM1" ref-type="media">S7</xref> shows the exponential phase of <italic>S. aureus</italic> colonies grown on sheep blood agar captured by time-lapse imaging with a macro lens. However, in typical settings where the entire plate is captured (see <xref rid="Sec9" ref-type="sec">Materials and methods</xref>, Image acquisition), the resolution is not high enough to observe the exponential phase.<fig id="Fig2"><label>Figure 2</label><caption><p>Typical colony radial growth curves. (<bold>a</bold>) Schematic cross section of a colony in the three growth phases. The 3 colors represent the phases (green: exponential phase, blue: linear phase, light red: saturation phase). The grey depicted areas represent bacterial cells which do not contribute to colony expansion. The arrows represent the flow of the diffusing growth substrate, steady during the linear phase and decreasing during the saturation phase. (<bold>b</bold>) Typical radial growth curve, with the three phases highlighted with colors corresponding to (<bold>a</bold>). R<sub>lin</sub>, displayed by the solid line, is the radius at which the radial growth rate becomes linear. R<sub>thresh</sub>, displayed by the dashed line, is the threshold below which a forming colony is not yet macroscopically visible. (<bold>c</bold>) The typical radial growth curves obtained by time-lapse image analysis in settings where the whole plate is captured (represented by the camera holder and agar plate icon). On the graph, the dashed horizontal line represents the threshold radius (R<sub>thresh</sub>) used for appearance time calculation and thick colored line segments represent the linear regression. Appearance time is the intersection of bold regression lines with the threshold line.</p></caption><graphic xlink:href="41598_2020_72979_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par13">Heterogeneity of the distribution of colony appearance times can be an indication of phenotypic heterogeneity in dormancy. For this reason, appearance time is a widely used proxy for single cell lag time until first division. We define a detectable size threshold in micrometers (R<sub>thresh</sub>), and the time at which a colony reaches this threshold as the <italic>appearance time</italic> (t<sub>app</sub>). The minimal possible R<sub>thresh</sub> depends on the image quality and needs to be set at the same value for comparisons of t<sub>app</sub> in different experiments. In our analysis setting, we assume that colonies reaching this size are already in the linear growth phase (R<sub>lin </sub>&lt; R<sub>thresh</sub>, Fig. <xref rid="Fig2" ref-type="fig">2</xref>b,c).</p>
      <p id="Par14">Tracking the colony radius over time using time-lapse imaging makes it possible to directly determine colony t<sub>app</sub> and linear radial growth rate (GR). ColTapp determines t<sub>app</sub> and GR by detecting the first of 6 consecutive frames for which a colony radius is bigger than R<sub>thresh</sub> (default: 200 µm). The following radius measurements within a user-specified timespan in hours (Fr<sub>lin</sub>, default: 10 h) are used for a linear regression to determine GR and t<sub>app</sub> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Fr<sub>lin</sub> might need to be reduced to only use a timespan in which radial growth is approximately linear. Additionally, R<sub>thresh</sub> can be adjusted depending on the image resolution and bacterial species investigated. The reason to perform a linear regression to determine t<sub>app</sub> instead of simply observing the time when a colony radius reaches R<sub>thresh</sub> is that it reduces artificial noise, to be expected if camera resolutions are low (for example if 1 pixel = 50 µm). Note that a low rate of image acquisition (long interval between time-lapse frames) might result in under-sampling of the linear growth phase, which could impact both growth rate and appearance time determination.</p>
      <p id="Par15">Growth parameters such as the duration of the exponential phase and the colony GR depend on strain characteristic properties such as replication frequency, metabolic yield<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, cell-to-cell adhesion<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> and surfactant production<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. In addition, growth dynamics depend on the nutrient medium and physical properties of the agar surface such as substrate roughness<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> or water activity<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>.</p>
      <p id="Par16">Therefore, for downstream analyses, reference growth parameters need to be measured with a control dataset (Supplementary text <xref rid="MOESM1" ref-type="media">6</xref>). The reference lag time is the minimal colony appearance time and can be observed by plating bacteria from a liquid culture in exponential phase which show little to no delay in growth resumption<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The reference linear radial growth rate is the maximal growth rate (GR<sub>max</sub>) observed in any experiment before competition between neighboring colonies starts to affect it.</p>
      <p id="Par17">The average colony growth rate derived from our control dataset (plates with less than 150 colonies) is 60.4 µm/h (SD = 4.7 µm/h). We define GR<sub>max</sub> taking the 95th percentile (65.0 µm/h) of the growth rate distribution.</p>
    </sec>
    <sec id="Sec5">
      <title>Appearance time and growth rate estimation from endpoint images</title>
      <p id="Par18">In some laboratories, setting-up high-throughput time-lapse imaging might not be possible, thus ColTapp proposes to estimate colony lag time from endpoint images. This is possible because when bacterial cells with a lag resume growth, they rapidly reach their maximal replication rate and the resulting colonies have linear radial growth rates (GR) similar to those of colonies emerging from cells with no lag<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Therefore, a reference linear radial growth rate (GR) (Supplementary text <xref rid="MOESM1" ref-type="media">6</xref>) can be used to estimate the colony appearance time t<sub>app</sub> based on colony radius R at a given timepoint (t<sub>f</sub>) by means of a linear extrapolation:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{i}={t}_{f}-\frac{R\left({t}_{f}\right)-R({t}_{i})}{GR}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="italic">GR</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="41598_2020_72979_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>with R<sub>thresh</sub> defining the radius (R) at time t<sub>i</sub> = t<sub>app</sub>.</p>
      <p id="Par19">Note that using a linear extrapolation with a reference growth rate to estimate the appearance time has two strong assumptions: first, that all colonies are still in the linear phase of their growth and second, that they all have the same linear radial growth rate.</p>
      <p id="Par20">To allow users to evaluate the validity of these two assumptions, or to estimate a reference growth rate if a time-lapse imaging setup is unavailable, ColTapp proposes a functionality to analyze a sequence of endpoint images (Supplementary text <xref rid="MOESM1" ref-type="media">7</xref>.1 and 7.2). By taking endpoint images at multiple timepoints and performing colony detection at each timepoint one can create a timeseries of colony radius. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, we exemplify this functionality by analyzing independently four frames extracted from the time-lapse image sequences of three plates. Two of these plates belong to our demonstration dataset (plate 18 and plate 11, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9</xref>, S10). With the third plate, we illustrate differences in growth rates, as it includes colonies from both a <italic>S. aureus</italic> laboratory strain and a <italic>S.aureus</italic> small colony variant clinical isolate, which exhibits a slow growth rate (plate MX, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S8</xref>). ColTapp computes the slope between colonies’ radii at different timepoints (Eq. <xref rid="Equ1" ref-type="">1</xref>), which results in an individual colony radial growth rate GR<sub>col</sub> for each time interval (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b).<fig id="Fig3"><label>Figure 3</label><caption><p>Growth rate and appearance time estimation from endpoint images. (<bold>a</bold>) Four images corresponding to the timepoints 12 h, 24 h, 36 h and 48 h were extracted from the full time-lapse image sequences of three independent plates and separately analyzed. Color indicates plate ID. Each dot represents radius of one colony at the given timepoint and all dots corresponding to the same colony are connected by lines (n = 44, 162 and 34 on Plate 11, 18 and MX respectively). Three colonies for each plate were highlighted. (<bold>b</bold>) Growth rate was estimated for each of the three intervals between the four timepoints for each colony. Crossbars indicate mean ± SD per timepoint and plate ID. When the radius was null at one of the timepoints involved in the interval, growth rate was not calculated. Therefore, only two growth rate values are shown for Plate 11 at the first interval. (<bold>c</bold>,<bold>e</bold>) Estimation of appearance time from radius at 24 h by linear extrapolation for the three colonies highlighted in (a) for each plate. The dashed line represents R<sub>thresh</sub> (200 µm). The usage of either the same GR<sub>max</sub> (65 µm/h) for all colonies, or individual colony GR<sub>col</sub> leads to different results. (<bold>d</bold>,<bold>f</bold>) Bland-Altman<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> comparison plots of the appearance time (t<sub>app</sub>) determined by full time-lapse analysis (real t<sub>app</sub>) and the appearance time estimated by linear extrapolation (predicted t<sub>app</sub>) with GR<sub>max</sub> or GR<sub>col</sub> respectively. The x-axis is the mean of the two measurements (obtained by full time-lapse analysis and linear extrapolation). The y-axis is the difference between the real t<sub>app</sub> and the estimated t<sub>app</sub>. Positive values indicate underestimation and negative values an overestimation of appearance time by the linear extrapolation method. The dotted line is the average bias of the linear extrapolation method and the two dashed lines are showing the lower and upper limits of agreement.</p></caption><graphic xlink:href="41598_2020_72979_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par21">This time-series analysis enables assessment of the entry time to saturation phase, identified by a decrease in growth rate (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Moreover, should colonies have different growth rates, the individual colony radial growth rate can be used to estimate the appearance time, rather than a fixed reference growth rate for all colonies (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c–f). Using individual colony growth rates increased overall agreement between appearance times determined by the full time-lapse analysis and appearance times estimated from endpoint images (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d,f).</p>
      <p id="Par22">However, note that using individual colony growth rates for appearance time estimation is appropriate to correct for differences in size which are independent from saturation, for example when a subpopulation on the plate has mutations affecting growth rate or a different genetic background (e.g. Plate MX in Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Should colonies be past the linear growth phase, growth rate estimations are inaccurate, thus appearance time cannot be accurately predicted (e. g. Plate 18 at 24 h in Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In these cases, one needs to take saturation into account. We introduce an approach to density-based corrections of saturation in the next section.</p>
    </sec>
    <sec id="Sec6">
      <title>Response to density</title>
      <p id="Par23">One typical problem for environmental or clinical samples is that the number of colony-forming-units per milliliter of sample is often unknown before plating, resulting in unpredictable colony densities on the plates. Yet, colony growth dynamics are affected by the presence of neighboring colonies, which compete locally for nutrients and are affected by the total number and proximity of colonies on the plate<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>. As soon as the effects of competition with neighboring colonies become strong enough<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, a colony enters the saturation phase of its growth, meaning that its radial growth rate decreases over time until it reaches 0 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Therefore, colonies on denser plates are expected to be smaller than colonies on less dense plates at a given point (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a).<fig id="Fig4"><label>Figure 4</label><caption><p>Plate density affects colony size. (<bold>a</bold>) At a given time (here 68 h), colonies on a dense plate have a smaller radius than colonies plated at low density. This effect is visible if colonies all grow at the same time (Control, blue) or after a delay (Rifa, orange). (<bold>b</bold>) This relationship between radius and appearance time at a given time can be visualized as a drop of the colony radius (yellow) from the ideal growth line (blue). An example of one colony is shown, represented by the orange dot. Its appearance time (t<sub>app</sub>) is given by its x-coordinate, and the appearance time estimated using a linear extrapolation with GR<sub>max</sub> is given by the x coordinate of its projection on the ideal growth line (t<sub>app,GRmax</sub>). The error (E) is the difference between these two values along the x-axis. (<bold>c</bold>) In our control dataset, the linear relationship expected between the colonies’ appearance time and their radius (red line defined by GR<sub>max</sub> = 65 µm/h) was lost when colonies grew on dense plates (here with warmer colors) and was heterogeneous within a plate at a given time. Here, at 24 h, while some colonies were still following a linear growth, other colonies from the same plate had already entered saturation phase. (<bold>d</bold>) The effect of plate density was also visible in the rifa dataset, with a larger variance in colonies’ appearance times and radii.</p></caption><graphic xlink:href="41598_2020_72979_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par24">On top of this, if the plating is heterogeneous, not all colonies have access to the same amount of resources. They therefore differ in size within a plate as soon as they enter the saturation phase. Thus, experiments aiming to compare either colony size or appearance time are biased by colony density.</p>
      <p id="Par25">We explored the response to density using our purposely designed demonstration dataset of colonies formed by the <italic>S. aureus</italic> lab strain JE2 on Columbia sheep blood agar. Of the 22 time-lapse movies, eight were plated from a single liquid culture at exponential phase to obtain a homogeneously growing population (control dataset, Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). The other fourteen were plated from another culture immediately after 24 h exposure to the antibiotic rifampicin (further referred to as rifa dataset, Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Rifampicin arrests bacterial cell growth by stopping protein synthesis, resulting in a bacterial population with a wide appearance time distribution<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. In order to observe the impact of density on colony radius over time and elaborate a method to correct this bias, the replicates were plated at different densities over two orders of magnitude (ranging from 16 to 1509 colonies per plate) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9</xref>, S10).</p>
      <p id="Par26">The effect of high densities on the colony growth rate is shown on Fig. <xref rid="Fig4" ref-type="fig">4</xref>c,d displaying the colonies’ radii against their observed appearance times at a given timepoint. One may follow the evolution of this relationship over time (Supplementary movie <xref rid="MOESM1" ref-type="media">2</xref>). At low densities, colonies grow at the maximal linear radial growth rate, GR<sub>max</sub>, which depends on strain and culture conditions (here 65.0 µm/h, see section <xref rid="Sec4" ref-type="sec">Appearance time and growth rate determination from time-lapse images</xref>). Colonies that deviate from the GR<sub>max</sub> appear below the expected linear regression line (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Therefore, when performing a linear extrapolation using GR<sub>max</sub>, the appearance time of colonies which are already in the saturation phase are overestimated (i.e. colonies on plate 18, Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). The systematic error (E) introduced by saturation corresponds to the difference between t<sub>app, GRmax</sub> (the result of the linear extrapolation with GR<sub>max</sub>) and the appearance time (t<sub>app</sub>) determined by the full time-lapse analysis (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{app} = t_{{app,GR_{max} }} - E.$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">app</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2020_72979_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par27">The error depended both on the local density of the plates and on the age of the colonies on the plate. Colonies in denser plates (warmer colors) deviated more than colonies on less dense plates (colder colors). Also, at a given time point, colonies on plates with earlier appearance time (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c) deviated more than the ones on plates with later appearance times (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d).</p>
    </sec>
    <sec id="Sec7">
      <title>Density correction</title>
      <p id="Par28">Chacón et al.<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> proposed that the amount of nutrients available to each colony on the agar plate can be approximated with Voronoi cell areas, obtained by drawing equidistant lines between neighbor colonies centers. The correlation between the radius at the time of observation and colony Voronoi cell area is time dependent and strongest at a late growth stage, as colonies approach their maximal size<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>.</p>
      <p id="Par29">Aiming to use the Voronoi cell area (V<sub>a</sub>) to approximate the error in appearance time estimation introduced by saturation (E), we evaluated the mathematical relation between log(V<sub>a</sub>) and E in the control dataset. At 24 h, E was close to 0 for colonies with large V<sub>a</sub> and increased for colonies with smaller V<sub>a</sub> (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, we attribute negative values to noise in colony detection at very high density). The relation E(V<sub>a</sub>) was fitted with a modified logistic model (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a):<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E\left({V}_{a}\right)={E}_{max}-\frac{{E}_{max}}{1+{e}^{b\left(c-\mathrm{log}\left({V}_{a}\right)\right)}}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>V</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="41598_2020_72979_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where E<sub>max</sub>, b and c are fitted parameters using the least square method. E<sub>max</sub>, depends on the control dataset. In theory, one could imagine that maximal error would increase indefinitely, but E<sub>max</sub> exists because even for infinitely small values of V<sub>a</sub>, colonies still grow by using nutrients immediately below them, even though they do not receive flux from the sides. b and c are shape parameters for the transition from no error to E<sub>max</sub>.<fig id="Fig5"><label>Figure 5</label><caption><p>Iterative correction of density effects. (<bold>a</bold>) For a given timepoint (here 24 h, control dataset), the error between appearance time estimated by linear extrapolation and appearance time determined by the full time-lapse analysis correlates with the Voronoi cell area (V<sub>a</sub>) and can be fitted using a logistic model (black line). Each dot represents one colony, colored by density (log values on the color bar, left side of figure) same as in (<bold>c</bold>, <bold>d</bold>, <bold>g</bold>, <bold>h</bold>). (<bold>b</bold>) The relation E(V<sub>a</sub>) observed at 24 h on the control dataset (blue dots underlaid on this plot) depends on the median lag time. Here it can be seen that E(V<sub>a</sub>) observed at 24 h on the rifa dataset (red dots, fitted by the purple line) is systematically smaller. (<bold>c</bold>) Here the relation E(V<sub>a</sub>) observed at 15.6 h on the control dataset is shown. The fit of this data (black solid line) is very close to the fit of E(V<sub>a</sub>) observed at 24 h on the rifa dataset (dashed purple line). Dashed black line is the fit of E(V<sub>a</sub>) observed at 24 h on the control dataset. (<bold>d</bold>) The result of the iterative correction for the control dataset observed at 24 h (shown in (<bold>a</bold>) before iterative correction). (<bold>e</bold>,<bold>f</bold>). Visualization of the improvement of appearance time estimation by iterative corrections depending on time difference between median estimated t<sub>app</sub> and the known median t<sub>app</sub> of the control dataset (vertical blue line), yielding predictions closer to the appearance time determined by the full time-lapse analysis (real, bold black line). The initial guess (Iteration 0, bold dark green line) is corrected (thin lines) over 20 iterations to yield final corrected t<sub>app</sub> (Iteration 20, bold light green line). Histograms of the probabilities p are binned in 2 h bins. (<bold>g</bold>,<bold>h</bold>) Estimated appearance time of the rifa dataset (shown without correction in <bold>b</bold>) is either corrected using E(V<sub>a</sub>) observed at 24 h on the control dataset (no iterations), or through 20 iterations (abbreviated it. on figure).</p></caption><graphic xlink:href="41598_2020_72979_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par30">As expected, the relation E(V<sub>a</sub>) was time dependent. When fitted through time, a linear increase of E<sub>max</sub> was observed starting as soon as the first colonies enter saturation phase (Supplementary movie <xref rid="MOESM1" ref-type="media">3</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S11</xref>). In addition to being time-dependent, E(V<sub>a</sub>) was observed to depend on the general lag time of the plate: at a given timepoint, colonies originating from populations with a large median lag time (e.g. rifa dataset) were in an earlier phase of their growth as compared to colonies originating from populations without lag (e.g. control dataset) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Ideally, one would adapt the relation E(V<sub>a</sub>) to take into account the median lag time of the plate, so that the correction applied to the rifa dataset observed at a given timepoint (t<sub>obs</sub>) corresponds to E(V<sub>a</sub>) fitted on the control dataset at an earlier timepoint, when the colonies were still at that stage of growth.</p>
      <p id="Par31">The difference in appearance time between the control dataset (median appearance time: 9 h) and the rifa dataset (median appearance time: 17.4 h) was Δt<sub>app</sub> = 8.4 h. The correction applied to the rifa dataset when observing colonies at t<sub>obs</sub> = 24 h should thus correspond to E(V<sub>a</sub>) fitted on the control dataset at t<sub>obs</sub>-Δt<sub>app</sub> = 15.6 h (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). However, the median appearance time is not known a priori when observing colonies on a plate at an endpoint.</p>
      <p id="Par32">Let us assume that we know the radius at 24 h but do not know the appearance time of the rifa dataset. We propose to use an iterative process to estimate the appearance time based on the knowledge acquired from the (strain and condition dependent) control dataset with known appearance time. An initial guess of the appearance time (t<sub>app,i</sub>) was obtained with Eq. (<xref rid="Equ2" ref-type="">2</xref>) where E(V<sub>a</sub>) was fitted on the control dataset at t<sub>obs</sub>. Then the difference between the known median t<sub>app</sub> of the control dataset and the median t<sub>app,i</sub> of the observed rifa plate (Δt<sub>app,i</sub>) was calculated. A new t<sub>app,i</sub> was estimated with Eq. (<xref rid="Equ2" ref-type="">2</xref>) where E(V<sub>a</sub>) was fitted on the control dataset at t<sub>obs</sub>—Δt<sub>app,i</sub>, which in turn gave a new Δt<sub>app,i</sub>. This process was iterated until stabilization for a final estimate of t<sub>app</sub> (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d–h, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S11</xref>).</p>
      <p id="Par33">Note that the shown approach tended to overcorrect the appearance time of colonies on dense plates due to the nature of the data: fully saturated colonies have little information left regarding their appearance time since the radius does not change with time anymore. Thus, this correction cannot perform well if many colonies have reached late saturation phase (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S11</xref>). For this reason, in populations with very large variance of appearance time, one single image may not allow a proper appearance time estimation, especially if some colonies stop growing before the late ones appear. In such cases, we recommend using several pictures of the same plate at different timepoints in order to minimize possible biases in estimations of lag time distributions.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par34">We developed ColTapp, a user-friendly application with a graphical interface. This application extracts biologically relevant data from images of microbial colonies including size, growth rate and appearance time as well as morphology descriptors and spatial metrics. Colony growth dynamics parameters are derived from time-lapse images. As it might not always be feasible to utilize high-throughput time-lapse imaging, ColTapp also includes a framework to estimate appearance time from endpoint images. Colony size at an endpoint is affected by colony density, resulting in a bias in appearance time estimation. Thus, we propose an iterative correction utilizing local plate density to moderate this bias. The correction is based on a control dataset and applied to a dataset with different growth characteristics (generalized long lag time).</p>
    <p id="Par35">In the past decades, the existence of phenotypic heterogeneity in bacterial populations has gained interest. Mathematical modeling of bacterial population dynamics in their ecosystems used to rely on average behavior. Advances in single cell microscopy and the development of models that can take into account the phenotypic state of thousands of individual bacteria shed light on the ecological function of phenotypic heterogeneity<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. In medicine, while most bacterial infections can successfully be treated with antibiotics, treatment failure occurs even if the bacteria are not resistant to the antibiotics that are given. The existence of subpopulations unresponsive to treatment is thought to ultimately be the cause for these treatment failures.</p>
    <p id="Par36">Under standard laboratory conditions, the established methods to investigate phenotypic heterogeneity in bacterial populations are single cell microscopy and flow cytometry, but these methods are often expensive and technically difficult to setup and maintain. Moreover, many medical and environmental samples are too complex to study with these methods, either because they consist of complex substrates (e.g. viscous fluids) or they contain contaminating particles that may hinder proper quantification. The high fluctuation in quality and bacterial load in natural samples might also not justify the time and money investment required to carry those experiments out. In the case of microscopy, rare phenotypes are difficult to quantify if the setup does not allow the observation of very large number of bacteria. Therefore, plating bacteria on nutrient media offers a cheap and easy way to assess lag time heterogeneity, as previously proposed<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>. While time to growth resumption on undefined nutrient media reflects the dormancy state of the bacterial cells upon plating, one may be interested in following time to growth resumption of an active population upon plating on selective media. Indeed, this can be an opportunity to investigate the ability of a population to switch metabolic states (e.g. to a new carbon source)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
    <p id="Par37">Note that although colony formation can be seen as a good alternative to single cell behavior assessment, it is not a direct single cell observation. For example, clumped bacteria or an inhomogeneous spreading of cells on a surface, resulting in deposition of aggregates of cells instead of single cells on the agar, will likely result in an underestimation of single cell lag time. This needs to be kept in mind even when calibrating data to optimize analysis. Assessing the effect of the studied condition on clumping of bacteria might help avoiding false discoveries.</p>
    <p id="Par38">With ColTapp, we propose an easy to use graphical user interface, so that any laboratory, regardless of the technical equipment and image analysis expertise accessible, can approach single cell growth phenotypes by monitoring colony growth dynamics. Usage of colony size determined by image analysis to assess stressor effects is a long-established method<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and various end-user applications to facilitate colony counting and size assessment were developed over the years (e.g. a standalone GUI by Clarke et al.<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> or an ImageJ plugin by Cai et al.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>), of which OpenCFU is one of the best known applications<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Image analysis algorithms implemented by the various applications are usually very similar and consist of a combination of pre-processing steps to clean raw images, a variety of thresholding algorithms to derive binary images and optional watershed segmentation to finally count and measure isolated objects. Variations exist, with for example multiple rounds of pre-processing<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> or a two-step colony detection algorithm for plate border and center<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Modern colony counter image analysis applications are using smartphones to acquire and process images all in one simple app<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup> or are starting to use the power of deep learning algorithms<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    <p id="Par39">OpenCFU was the best operating tool at the time of writing this manuscript, while many other programs are not maintained. We compared its performance to detect colonies with ColTapp, using our image dataset of colonies from multiple species plated on multiple media (Table <xref rid="Tab1" ref-type="table">1</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">S2</xref>). The average ratio between found colonies and actual colonies on an image (not accounting for false positive or false negative detections) was 0.75 (SD = 0.26) indicating a general underestimation of colony numbers. ColTapp on the other hand has ratio of 1.09 (SD = 0.28) between initially detected and actual colonies. ColTapp, on average, overestimates number of colonies. OpenCFU has no option for manual correction of detected colonies which limits the usability of it.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison with other colony image analysis tools.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="2">Availability</th><th align="left" colspan="5">Data extracted from colonies on images</th><th align="left" rowspan="2">Aim</th></tr><tr><th align="left">Code</th><th align="left">GUI</th><th align="left">Count</th><th align="left">Position</th><th align="left">Size</th><th align="left">Growth kinetics</th><th align="left">Additional characteristics</th></tr></thead><tbody><tr><td align="left">Levin-Reisman et al. 2010 (ScanLag)</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">None</td><td align="left">Analysis of colony time-lapse images</td></tr><tr><td align="left">Geissmann 2013 (OpenCFU)</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">No</td><td align="left">Morphology descriptors, number of adjacent colonies</td><td align="left">Analysis of colony endpoint images</td></tr><tr><td align="left">ColTapp</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Morphology descriptors, spatial metrics</td><td align="left">Analysis of colony endpoint and time-lapse images</td></tr></tbody></table><table-wrap-foot><p>Here, we qualitatively compare ColTapp with two tools dedicated to image analysis of pictures of bacterial colonies grown on solid agar. We summarize the availability of code and a graphical user interface (GUI), the output data provided (colony counts, position, size and growth kinetics, i.e. appearance time and linear radial growth rate) as well as the aim of the three tools. For details and more publications, see main text.</p></table-wrap-foot></table-wrap></p>
    <p id="Par40">The above mentioned applications (Table <xref rid="Tab1" ref-type="table">1</xref>) are meant to analyze endpoint images, which do not capture colony growth dynamics. Levin-Reisman, et al.<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> released the ScanLag code package to analyze colony time-lapse images. Yet, although multiple groups use this type of analysis for their research<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup>, there is no comprehensive and flexible application including a graphical user interface currently available for this purpose. ScanLag works best on a specific imaging setup and we were not able to compare it with ColTapp. Therefore, by bringing together the standard endpoint analysis with time-lapse image analysis, our user-friendly ColTapp fills a gap in the collection of existing dedicated image analysis tools.</p>
    <p id="Par41">As for any image analysis tool, the quality of the analysis will highly depend on the quality of the images themselves. We recommend users to maintain homogenous lighting, avoid light flares and reflections and create good contrast using background modifications and proper focusing. ColTapp is flexible enough to allow processing of colored and grayscale images acquired either through dedicated platforms or with simple camera solutions. For endpoint images, this can be best achieved using a dedicated white box with diffused, indirect light, but recent phone cameras can also give decent results on a bench.</p>
    <p id="Par42">We propose an analysis of the linear radial growth phase, assuming a colony has already reached this stage upon appearance. It is not difficult to observe the initial exponential part of the colony growth (occurring before a colony reaches a radius of ~ 100 µm) by using commercially available photographic macro lenses (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S7</xref>, see methods). However, one should be aware that defining appearance time with a linear extrapolation is incorrect in this case as the exponential growth phase is actually observed and should be taken into account. Similarly, our estimation of appearance time from endpoint images assumes that colonies are in the linear growth phase.</p>
    <p id="Par43">As soon as the steady flow of nutrients sustaining colony growth decreases (timing is dependent on proximity of competing neighbors and the total number of colonies on the plate), the colony enters saturation phase, which impacts the linear appearance time estimation. Density may even affect the observed appearance time if colonies enter saturation phase before they are visible<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. However, in the presented <italic>S. aureus</italic> dataset (including extremely dense plates), only a marginal correlation was observed between colony appearance time and density (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S12</xref>). Colony growth is a complex biological process and different species on different growth substrates will respond differently to density<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. For this reason, it is impossible to propose a universally valid method to take density into account. Nevertheless, the explored correction based on spatial metrics, which can easily be exported with ColTapp, might be used as a starting point to develop suitable correction methods for the investigated species.</p>
    <p id="Par44">We wrote the ColTapp application using the classical programming language MATLAB, and the code is designed as a modular shell that can host further image analysis methods that may meet specific needs, while benefiting from the easy to operate graphical interface. Typically, we envision that the introduction of more sophisticated morphology descriptors could facilitate the study of intra- and inter-species colony interactions.</p>
  </sec>
  <sec id="Sec9">
    <title>Materials and methods</title>
    <sec id="Sec10">
      <title>Hardware and software details</title>
      <p id="Par45">We programmed the ColTapp application with MATLAB 2020a (MathWorks). Very preliminary code of the GUI and time-lapse radius tracking was proposed earlier<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. All algorithm accuracy and computational efficiency tests were performed on a computer with Windows 10 OS, i7-8700K @4.70 GHz, 32 GB RAM.</p>
      <p id="Par46">We used external code acquired from the File Exchange server of MathWorks for certain functions. Namely, these were a Voronoi tessellation function by Sievers<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, an image zoom and pan function by Cabrera<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, multiple directory acquisition function by Cannell<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, a smoothing function tolerant to missing values by Pittam<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> and a function to fit a circle through three points by Malyuta<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>.</p>
      <p id="Par47">Additionally, we used ggplot2<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> within R and R Studio<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> as well as Inkscape (<ext-link ext-link-type="uri" xlink:href="http://www.inkscape.org">www.inkscape.org</ext-link>) for certain figures.</p>
    </sec>
    <sec id="Sec11">
      <title>Image acquisition</title>
      <p id="Par48">ColTapp does not rely on a specific image format or quality. Achieving homogenous lighting is undoubtedly critical for successful image analysis, but image acquisition itself can be operated using any kind of device. For correct image capture (Supplementary text <xref rid="MOESM1" ref-type="media">2</xref>.1), the camera should be positioned perpendicular to the plate. For time-lapse imaging, acquisition triggering at defined time intervals is necessary. Typical systems include scanners, dedicated applications and cameras or commercially available consumer-grade camera, provided they include a time-lapse mode or can be triggered by an external controller.</p>
      <p id="Par49">The time-lapse series presented in this paper were generated acquiring images every 10 min for ~ 70 h, resulting in series of either 410 or 423 images. Monitoring colony growth for this duration ensured that bacteria experiencing long lag time became eventually visible and that the colonies reached the saturation phase on all plates to permit our analysis of density.</p>
      <p id="Par50">Plates were either captured individually with Canon EOS 1200D reflex cameras generating .jpg files of size 5184 × 3456 pixels triggered through an Arduino controller (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a) or four plates at a time with Basler acA5472-17um 20MP cameras (Fujinon Objectives CF16ZA-1S 16 mm/1.8M37.5 × 0.5) generating .tiff files of size 5472 × 3648 pixels triggered with Basler’s pylon software suite (Version: 6.0.1). The spatial calibration factor was around 1 pixel to 25 µm using the Canon EOS 1200D and 1 pixel to 50 µm using Basler acA5472-17um 20MP cameras. When using an EF100mm f/2.8L IS USM macro lens on the Canon camera, we obtained a 1 pixel to 5 µm spatial calibration factor. The plates were laid on a black background surface upside-up below the cameras and the whole system was set inside an incubator at 37 °C. To prevent drying out of agar plates and airborne contamination, lids were kept on the plates. To avoid condensation, lids were pre-warmed to 37 °C. Best image analysis quality was observed when special attention was brought to the illumination method: indirect, homogeneous white illumination was obtained by covering the incubator walls with white paper and using a LED based light source (Philips Hue Lightstrips Basis, operating in warm-white mode) emitting minimal heat (temperature of LED aluminum encasing: 45.1 °C ± 2.4 °C (mean ± standard deviation, n = 7); temperature of agar plate surface: 37.5 °C ± 0.51 °C. Temperature measured with a Stanley STHT0-77365 infrared thermometer). Endpoint images were acquired manually with a Canon EOS 1200D reflex camera and lids were temporarily removed. Plates were placed in a custom-built box with light diffusing sides and a fixed plate- and camera-holder.</p>
    </sec>
    <sec id="Sec12">
      <title>Colony detection algorithm implementation</title>
      <p id="Par51">Colony detection uses a series of image analysis operations starting from a grayscale image (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a) and depends on user-specified minimal and maximal expected radius of colonies (see Supplementary text <xref rid="MOESM1" ref-type="media">3</xref>.1 and 3.2 for additional pre-processing possibilities). ColTapp uses top-hat filtering with a disk-shaped structuring element based on the minimal expected radius to reduce lighting gradients and other inhomogeneities of the agar background (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). Local adaptive thresholding is then used to create a binary image (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). This image is cleaned from artifacts and unwanted objects by discarding small and big isolated objects (threshold defined by minimal and maximal expected radius, respectively). Objects with a low extent (foreground/background pixel ratio), are discarded as well (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). Next, distance transformation is used to derive local minima, which are subsequently filtered by minima imposition. Overlapping colonies are separated with watershed segmentation (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e). Sequentially, ColTapp extracts images containing an isolated object (img<sub>crop</sub>) from the top-hat filtered grayscale image and further performs circular filtering and contrast enhancement (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). Objects are discarded if the proportion of low intensity pixels within img<sub>crop</sub> is above a threshold defined by the median intensity of all objects. A two-step circular Hough transform is applied to img<sub>crop</sub> by the <italic>imfindcircles</italic> function<sup><xref ref-type="bibr" rid="CR46">46</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup> available in MATLAB to detect all probable colony circles within the given radius range (all circles in Fig. <xref rid="Fig6" ref-type="fig">6</xref>g). False positive circles may be detected (red circles in Fig. <xref rid="Fig6" ref-type="fig">6</xref>g) and sequential quality control functions are used to exclude these. Circles are excluded based on their distance from the image boundaries of img<sub>crop</sub>, proportion of pixels categorized as foreground within the circle, proportion of overlap with each other, distance between each other and relative fitting quality. After every img<sub>crop</sub> is processed, a final quality control round is deployed to remove circles with extremely close centers (Fig. <xref rid="Fig6" ref-type="fig">6</xref>h). Several parameters involved in circle detection and quality control can be tuned to potentially improve performance (Supplementary text <xref rid="MOESM1" ref-type="media">3</xref>.2). In addition, the user may intervene directly to correct the results (Supplementary text <xref rid="MOESM1" ref-type="media">3</xref>.3).<fig id="Fig6"><label>Figure 6</label><caption><p>Image analysis steps for colony detection. (<bold>a</bold>) Original grayscale image. (<bold>b</bold>) Top-hat filtering of image in (<bold>a</bold>). (<bold>c</bold>) A binary image is obtained by adaptive local thresholding. (<bold>d</bold>) Noise is filtered out of binary image. (<bold>e</bold>) Distance transformation and watershed segmentation are used to identify isolated objects. (<bold>f</bold>) Sequentially, each minimal sized image containing an isolated object is extracted. (<bold>g</bold>) Potential circles are detected with a two-step Hough transform (all circles). A series of automatic quality control functions are used to discard false positive circles (red circles). Only circles passing the quality control are kept (blue circles). (<bold>h</bold>) Final detected circles. The small rectangle in (<bold>a</bold>,<bold>b</bold>,<bold>c</bold>,<bold>d</bold>,<bold>e</bold>,<bold>h</bold>) marks the region of the extracted object shown in (<bold>f</bold>, <bold>g</bold>).</p></caption><graphic xlink:href="41598_2020_72979_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par52">In <italic>Endpoint</italic> mode, colony detection is done independently on each frame. In <italic>Timelapse</italic> mode, it is done on a single frame, as the colony radius can subsequently be tracked over time.</p>
      <p id="Par53">We tested the accuracy and computation speed of the colony detection algorithm with 30 images acquired with different cameras, including smartphones (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5</xref>). Images of the bacterial species <italic>S. aureus</italic>, <italic>Escherichia coli</italic>, <italic>Staphylococcus epidermidis</italic>, <italic>Pseudomonas putida</italic><sup><xref ref-type="bibr" rid="CR48">48</xref></sup><italic>, Acinetobacter johnsonii</italic><sup><xref ref-type="bibr" rid="CR48">48</xref></sup> and <italic>Alteromonas macleodii</italic><sup><xref ref-type="bibr" rid="CR49">49</xref></sup> as well as bacteriophage plaques on <italic>E. coli</italic><sup><xref ref-type="bibr" rid="CR48">48</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup> using the standard agar media necessary for optimal growth of the respective species (Colombia sheep blood, tryptic soy broth, lysogeny broth, marine broth, etc.) were included. ColTapp successfully detects colonies from various bacterial species on distinctly colored agar plates. Adapting imaging conditions towards homogeneous light and reduced reflections can reduce the amount of manual correction required (Supplementary text <xref rid="MOESM1" ref-type="media">3</xref>.4, Supplementary table <xref rid="MOESM1" ref-type="media">S2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5</xref>).</p>
    </sec>
    <sec id="Sec13">
      <title>Radius tracking algorithm implementation</title>
      <p id="Par54">Executing the above described colony detection method on each frame to generate time-lapse data of growing colonies creates several potential problems: (1) manual correction would be tedious, (2) colony to colony center matching between frames needs high accuracy, (3) radius range search of ColTapp is not time dependent, (4) the colony detection algorithm does not operate well with an expected minimal radius below 3 pixels. This would impose a detection limit. Therefore, ColTapp proposes to initially detect all colonies on a frame corresponding to a late timepoint, which is set as the <italic>reference frame</italic>. Once colonies have been detected on a late frame of the time-lapse series, their radius is tracked on the previous frames. For each time frame, ColTapp extracts sub-images of each colony from the main image. Intensity of each sub-image is scaled based on minimal and maximal intensity values of the last image of the time-lapse. These sub-images are then unwrapped with a polar transformation (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a). The placement of the colony center position is important in this step since a misplaced center’s distance to the edge of the colony is not equal to the radius. Image drift correction as well as center correction functions are implemented in ColTapp to improve centering (Supplementary text <xref rid="MOESM1" ref-type="media">5</xref>.1 and 5.2). Each transformed sub-image is averaged into a single intensity vector representing the intensity gradient from the colony center towards its edge. This averaging step reduces the noise introduced by slight off-centering of colonies and reduces file sizes. Finally, all vectors resulting from the corresponding sub-images of each time frame are combined into a kymograph, which represents the colony radial growth as a curve in intensity (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a). The kymograph’s highest contrast edge corresponds to the colony radius over time. Since the presence of neighboring colonies would create blurry regions in the top of kymographs and thus hinder edge detection (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b), ColTapp ignores the angle ranges corresponding to adjacent colonies for kymograph creation (Supplementary text <xref rid="MOESM1" ref-type="media">5</xref>.3).<fig id="Fig7"><label>Figure 7</label><caption><p>Time-lapse processing. (<bold>a</bold>) A polar transformation is applied to grayscale sub-images of each colony and intensity values are averaged over the radius for each frame in the time-lapse. These radial average intensity vectors are combined into a kymograph representing colony radius growth. (<bold>b</bold>) Overlapping colonies result in blurry regions in the top part of the kymograph. The angle range corresponding to overlapping colonies is excluded to reduce this effect. Kymographs can be processed either by (<bold>c</bold>) <italic>Global thresholding</italic> or (<bold>d</bold>) <italic>Edge detection</italic> method. (<bold>c</bold>) In the <italic>Global thresholding</italic> method, a threshold is applied to a filtered version of the kymograph to derive a binary image. (<bold>d</bold>) The <italic>Edge detection</italic> method uses a series of filtering steps, edge detection algorithms and morphological operations to optimize the binary image.</p></caption><graphic xlink:href="41598_2020_72979_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par55">In order to detect the kymograph edge to derive colony radius over time, two methods are implemented: <italic>Global thresholding</italic> and <italic>Edge detection</italic>. Both methods first apply an automatic contrast enhancement function, then a pixel-wise adaptive low-pass Wiener filter<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> followed by a circular averaging filter (pillbox) to the kymograph to derive a smoother image. Additionally, a low-pass threshold for maximal intensity may be applied.</p>
      <p id="Par56">These pre-processed images are then further transformed with either a <italic>Global thresholding</italic> or <italic>Edge detection</italic> method to create binary images. The default <italic>Global thresholding</italic> method uses Otsu’s method<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> to derive a global threshold from which a user-defined constant is subtracted to prevent biasing towards background (Fig. <xref rid="Fig7" ref-type="fig">7</xref>c).The <italic>Edge detection</italic> method uses a series of edge detection and morphological operations (Fig. <xref rid="Fig7" ref-type="fig">7</xref>d). In brief, the method by Canny<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> is used for initial edge detection. Subsequently, small isolated foreground pixels are removed with area opening operations. Straight vertical and horizontal lines, typically originating from light artifacts and particles on the agar respectively, are removed. Two iterative morphological closing operations are used with line- and disk-shaped kernels, respectively. Additionally, active contouring using the Chan-Vese method<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> is applied to the pre-processed kymograph to derive a second binary image with a filled region of probable colony area. The two binary images are merged, and morphological closing is performed to close potential gaps to successfully fill connected regions afterwards. A final morphological opening is applied to remove jagged edges. The fully connected object located in the lower right side of the kymograph (corresponds to end of time-lapse and close to colony center) is kept as the only foreground object in the binary image.</p>
      <p id="Par57">ColTapp includes automatic error detection and manual correction tools for the kymograph derived radius growth curves (Supplementary text <xref rid="MOESM1" ref-type="media">5</xref>.4, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S13</xref>).</p>
      <p id="Par58">The <italic>Edge detection</italic> method is more complex and is suggested when the default <italic>Global thresholding</italic> method fails. Switching to the <italic>Edge detection</italic> method for the incorrect growth curves resulted in a reduction of the number of growth curves requiring further manual correction to 3.1% (SD = 2.7%) (Supplementary text <xref rid="MOESM1" ref-type="media">5</xref>.5, Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref>). Generally, computational time increases with the number of frames in a time-lapse series, number of colonies to track, image file size and final colony size (Supplementary text <xref rid="MOESM1" ref-type="media">5</xref>.5, Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref>).</p>
    </sec>
    <sec id="Sec14">
      <title>Bacterial strains and cultivation</title>
      <p id="Par59">To generate our 22 demonstration time-lapse movies (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9</xref>, S10), the <italic>Staphylococcus aureus</italic> strain JE2 was grown overnight at 37 °C in shaking (220 rpm) test tubes containing tryptic soy broth (TSB, Difco), inoculated from a single colony picked from blood agar plates. These cultures were diluted to an optical density (600 nm) of 0.2 in fresh TSB containing rifampicin (1 µg/ml) to generate the Rifa dataset and without rifampicin to generate the control dataset. After 24 h rifampicin exposure, cultures were pelleted (10,000 g, 3 min), resuspended twice in phosphate buffered saline solution and then plated on blood agar plates (Columbia, 5% sheep blood, BioMérieux) at dilutions ranging from undiluted to a 10<sup>–4</sup> dilution in 2/3rd dilution steps. For the control dataset, after 2 h of incubation in TSB (corresponding approximately to mid-exponential growth phase), bacteria were serially diluted (2/3rd dilution steps) and plated on blood agar plates.</p>
      <p id="Par60">To generate the extra time-lapse movie of a plate including colonies from two different genetic backgrounds, the <italic>S. aureus</italic> strain Cowan I and a <italic>S. aureus</italic> small colony variant clinical isolate were picked from a plate, set to an optical density (600 nm) of 0.5, diluted to 10<sup>–6</sup>. 50 µl of each of these dilutions were plated on the same blood agar plate.</p>
      <p id="Par61">To generate the 30 images on which we assess the performance of the colony detection algorithm (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5</xref>) the strains and growth conditions specified in Supplementary table <xref rid="MOESM1" ref-type="media">S1</xref> were used.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2020_72979_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary information</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Julian Bär and Mathilde Boumasmoud.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>3/9/2021</p>
      <p>A Correction to this paper has been published: 10.1038/s41598-021-85033-8</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-020-72979-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Alejandra Rodriguez Verdugo, Anna-Karina Pitol and Florien Gorter for providing the pictures of plates with phage and bacteria of Supplementary Fig <xref rid="MOESM1" ref-type="media">S5</xref>. We thank Srikanth Mairpady Shambat for providing feedback on the manuscript. We thank Martin Ackermann for insightful discussions at the onset of the project.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.B., M.B. and C.V. wrote the ColTapp code, performed experiments and analysis and wrote the manuscript. R.K., A.Z. and C.V. conceived and planned the project, R.K and A.Z. supervised research, A.Z. acquired funding, all authors reviewed the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Funding from Swiss National Science Foundation, Project Grants 31003A_176252 was given to A.Z. The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The ColTapp MATLAB source code and standalone executable (macOS/Windows) can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/ColTapp">https://github.com/ColTapp</ext-link> under the GNU General Public License 3 and freely downloaded, together with a package of demo images, the code to trigger cameras with an Arduino board and experimental data analysis files. Raw images are accessible on Figshare at 10.6084/m9.figshare.12951152.v1.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par62">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balaban</surname>
            <given-names>NQ</given-names>
          </name>
          <name>
            <surname>Merrin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chait</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kowalik</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Leibler</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Bacterial persistence as a phenotypic switch</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>305</volume>
        <fpage>1622</fpage>
        <lpage>1625</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1099390</pub-id>
        <?supplied-pmid 15308767?>
        <pub-id pub-id-type="pmid">15308767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ackermann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A functional perspective on phenotypic heterogeneity in microorganisms</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>497</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro3491</pub-id>
        <?supplied-pmid 26145732?>
        <pub-id pub-id-type="pmid">26145732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Franklin</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Physiological heterogeneity in biofilms</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2008</year>
        <volume>6</volume>
        <fpage>199</fpage>
        <lpage>210</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1838</pub-id>
        <?supplied-pmid 18264116?>
        <pub-id pub-id-type="pmid">18264116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guillier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pardon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Augustin</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Automated image analysis of bacterial colony growth as a tool to study individual lag time distributions of immobilized cells</article-title>
        <source>J. Microbiol. Methods</source>
        <year>2006</year>
        <volume>65</volume>
        <fpage>324</fpage>
        <lpage>334</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mimet.2005.08.007</pub-id>
        <?supplied-pmid 16185781?>
        <pub-id pub-id-type="pmid">16185781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levin-Reisman</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated imaging with ScanLag reveals previously undetectable bacterial growth phenotypes</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>737</fpage>
        <lpage>739</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1485</pub-id>
        <?supplied-pmid 20676109?>
        <pub-id pub-id-type="pmid">20676109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levin-Reisman</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Fridman</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Balaban</surname>
            <given-names>NQ</given-names>
          </name>
        </person-group>
        <article-title>ScanLag: High-throughput quantification of colony growth and lag time</article-title>
        <source>J. Vis. Exp.</source>
        <year>2014</year>
        <pub-id pub-id-type="doi">10.3791/51456</pub-id>
        <?supplied-pmid 25077667?>
        <pub-id pub-id-type="pmid">25077667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barr</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Serial image analysis of <italic>Mycobacterium tuberculosis</italic> colony growth reveals a persistent subpopulation in sputum during treatment of pulmonary TB</article-title>
        <source>Tuberculosis (Edinb)</source>
        <year>2016</year>
        <volume>98</volume>
        <fpage>110</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2016.03.001</pub-id>
        <pub-id pub-id-type="pmid">27156626</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vulin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Leimer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Huemer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zinkernagel</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Prolonged bacterial lag time results in small colony variants that represent a sub-population of persisters</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>4074</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-06527-0</pub-id>
        <?supplied-pmid 30287875?>
        <pub-id pub-id-type="pmid">30287875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Proctor</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Small colony variants: A pathogenic form of bacteria that facilitates persistent and recurrent infections</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2006</year>
        <volume>4</volume>
        <fpage>295</fpage>
        <lpage>305</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1384</pub-id>
        <?supplied-pmid 16541137?>
        <pub-id pub-id-type="pmid">16541137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kahl</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Loffler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Clinical significance and pathogenesis of <italic>Staphylococcal</italic> small colony variants in persistent infections</article-title>
        <source>Clin. Microbiol. Rev.</source>
        <year>2016</year>
        <volume>29</volume>
        <fpage>401</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1128/CMR.00069-15</pub-id>
        <?supplied-pmid 26960941?>
        <pub-id pub-id-type="pmid">26960941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Proctor</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>van Langevelde</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kristjansson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maslow</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Arbeit</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Persistent and relapsing infections associated with small-colony variants of <italic>Staphylococcus aureus</italic></article-title>
        <source>Clin. Infect. Dis.</source>
        <year>1995</year>
        <volume>20</volume>
        <fpage>95</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1093/clinids/20.1.95</pub-id>
        <?supplied-pmid 7727677?>
        <pub-id pub-id-type="pmid">7727677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joers</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kaldalu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tenson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The frequency of persisters in <italic>Escherichia coli</italic> reflects the kinetics of awakening from dormancy</article-title>
        <source>J. Bacteriol.</source>
        <year>2010</year>
        <volume>192</volume>
        <fpage>3379</fpage>
        <lpage>3384</lpage>
        <pub-id pub-id-type="doi">10.1128/Jb.00056-10</pub-id>
        <?supplied-pmid 20435730?>
        <pub-id pub-id-type="pmid">20435730</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Eiff</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>The small colony variant (SCV) concept—the role of staphylococcal SCVs in persistent infections</article-title>
        <source>Injury</source>
        <year>2006</year>
        <volume>37</volume>
        <fpage>26</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1016/j.injury.2006.04.006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guerillot</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unstable chromosome rearrangements in <italic>Staphylococcus aureus</italic> cause phenotype switching associated with persistent infections</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>20135</fpage>
        <lpage>20140</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1904861116</pub-id>
        <?supplied-pmid 31527262?>
        <pub-id pub-id-type="pmid">31527262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernebjerg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kishony</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Distinct growth strategies of soil bacteria as revealed by large-scale colony tracking</article-title>
        <source>Appl. Environ. Microbiol.</source>
        <year>2012</year>
        <volume>78</volume>
        <fpage>1345</fpage>
        <lpage>1352</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.06585-11</pub-id>
        <?supplied-pmid 22194284?>
        <pub-id pub-id-type="pmid">22194284</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chacón</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Möbius</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Harcombe</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>The spatial and metabolic basis of colony size variation</article-title>
        <source>ISME J.</source>
        <year>2018</year>
        <volume>12</volume>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1038/s41396-017-0038-0</pub-id>
        <?supplied-pmid 29367665?>
        <pub-id pub-id-type="pmid">29367665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pirt</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>A kinetic study of the mode of growth of surface colonies of bacteria and fungi</article-title>
        <source>J. Gen. Microbiol.</source>
        <year>1967</year>
        <volume>47</volume>
        <fpage>181</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1099/00221287-47-2-181</pub-id>
        <?supplied-pmid 6045659?>
        <pub-id pub-id-type="pmid">6045659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Be'er</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deadly competition between sibling bacterial colonies</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>428</fpage>
        <lpage>433</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0811816106</pub-id>
        <?supplied-pmid 19129489?>
        <pub-id pub-id-type="pmid">19129489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Upadhyaya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Elastic instability in growing yeast colonies</article-title>
        <source>Biophys. J.</source>
        <year>2004</year>
        <volume>86</volume>
        <fpage>2740</fpage>
        <lpage>2747</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(04)74327-1</pub-id>
        <?supplied-pmid 15111392?>
        <pub-id pub-id-type="pmid">15111392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angelini</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Roper</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kolter</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title><italic>Bacillus subtilis</italic> spreads by surfing on waves of surfactant</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>18109</fpage>
        <lpage>18113</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0905890106</pub-id>
        <?supplied-pmid 19826092?>
        <pub-id pub-id-type="pmid">19826092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gralka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hallatschek</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Environmental heterogeneity can tip the population genetics of range expansions</article-title>
        <source>eLife</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>44359</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.44359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stecchini</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Del Torre</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Donda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Maltini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pacor</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Influence of agar content on the growth parameters of <italic>Bacillus cereus</italic></article-title>
        <source>Int. J. Food Microbiol.</source>
        <year>2001</year>
        <volume>64</volume>
        <fpage>81</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1016/S0168-1605(00)00436-0</pub-id>
        <pub-id pub-id-type="pmid">11252514</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bland</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Statistical methods for assessing agreement between two methods of clinical measurement</article-title>
        <source>Lancet</source>
        <year>1986</year>
        <volume>327</volume>
        <fpage>307</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1016/S0140-6736(86)90837-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dervaux</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Magniez</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Libchaber</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>On growth and form of <italic>Bacillus subtilis</italic> biofilms</article-title>
        <source>Interface Focus</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>20130051</fpage>
        <pub-id pub-id-type="doi">10.1098/rsfs.2013.0051</pub-id>
        <?supplied-pmid 25485075?>
        <pub-id pub-id-type="pmid">25485075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeanson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Floury</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gagnaire</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lortal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thierry</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bacterial colonies in solid media and foods: A review on their growth and interactions with the micro-environment</article-title>
        <source>Front. Microbiol.</source>
        <year>2015</year>
        <pub-id pub-id-type="doi">10.3389/fmicb.2015.01284</pub-id>
        <?supplied-pmid 26733979?>
        <pub-id pub-id-type="pmid">26733979</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwan</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Valenta</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Benedik</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>TK</given-names>
          </name>
        </person-group>
        <article-title>Arrested protein synthesis increases persister-like cell formation</article-title>
        <source>Antimicrob. Agents Chemother.</source>
        <year>2013</year>
        <volume>57</volume>
        <fpage>1468</fpage>
        <lpage>1473</lpage>
        <pub-id pub-id-type="doi">10.1128/AAC.02135-12</pub-id>
        <pub-id pub-id-type="pmid">23295927</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lennon</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>Microbial seed banks: The ecological and evolutionary implications of dormancy</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2011</year>
        <volume>9</volume>
        <fpage>119</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2504</pub-id>
        <?supplied-pmid 21233850?>
        <pub-id pub-id-type="pmid">21233850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Solopova</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bet-hedging during bacterial diauxic shift</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>7427</fpage>
        <lpage>7432</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1320063111</pub-id>
        <?supplied-pmid 24799698?>
        <pub-id pub-id-type="pmid">24799698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dykes</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Image analysis of colony size for investigating sublethal injury in <italic>Listeria monocytogenes</italic></article-title>
        <source>J. Rapid Meth. Aut. Mic.</source>
        <year>1999</year>
        <volume>7</volume>
        <fpage>223</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1745-4581.1999.tb00395.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>ML</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Low-cost, high-throughput, automated counting of bacterial colonies</article-title>
        <source>Cytometry Part A</source>
        <year>2010</year>
        <volume>77A</volume>
        <fpage>790</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cai</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized digital counting colonies of clonogenic assays using ImageJ software and customized macros: Comparison with manual counting</article-title>
        <source>Int. J. Radiat. Biol.</source>
        <year>2011</year>
        <volume>87</volume>
        <fpage>1135</fpage>
        <lpage>1146</lpage>
        <pub-id pub-id-type="doi">10.3109/09553002.2011.622033</pub-id>
        <pub-id pub-id-type="pmid">21913819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geissmann</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>OpenCFU, a new free and open-source software to count cell colonies and other circular objects</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e54072</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0054072</pub-id>
        <?supplied-pmid 23457446?>
        <pub-id pub-id-type="pmid">23457446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brugger</surname>
            <given-names>SD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated counting of bacterial colony forming units on agar plates</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e33695</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0033695</pub-id>
        <?supplied-pmid 22448267?>
        <pub-id pub-id-type="pmid">22448267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiang</surname>
            <given-names>P-J</given-names>
          </name>
          <name>
            <surname>Tseng</surname>
            <given-names>M-J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Z-S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C-H</given-names>
          </name>
        </person-group>
        <article-title>Automated counting of bacterial colonies by image analysis</article-title>
        <source>J. Microbiol. Methods</source>
        <year>2015</year>
        <volume>108</volume>
        <fpage>74</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mimet.2014.11.009</pub-id>
        <?supplied-pmid 25451456?>
        <pub-id pub-id-type="pmid">25451456</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Wong, C.-F., Joshua Yi, Y. &amp; Samuel Ken-En, G. APD colony counter app: Using Watershed algorithm for improved colony counting. (2016).</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Austerjost</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A smart device application for the automated determination of <italic>E. coli</italic> colonies on agar plates</article-title>
        <source>Eng. Life Sci.</source>
        <year>2017</year>
        <volume>17</volume>
        <fpage>959</fpage>
        <lpage>966</lpage>
        <pub-id pub-id-type="doi">10.1002/elsc.201700056</pub-id>
        <?supplied-pmid 32624845?>
        <pub-id pub-id-type="pmid">32624845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Andreini, P., Bonechi, S., Bianchini, M., Mecocci, A. &amp; Scarselli, F. 522–533 (Springer International Publishing).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gefen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ronin</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bar-Meir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Balaban</surname>
            <given-names>NQ</given-names>
          </name>
        </person-group>
        <article-title>Effect of tolerance on the evolution of antibiotic resistance under drug combinations</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>367</volume>
        <fpage>200</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aay3041</pub-id>
        <?supplied-pmid 31919223?>
        <pub-id pub-id-type="pmid">31919223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">VoronoiLimit(varargin) v. 3.0.1.5 (Matlab Central File Exchange, Retrieved March 20, 2020, <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/matlabcentral/fileexchange/34428-voronoilimit-varargin">https://www.mathworks.com/matlabcentral/fileexchange/34428-voronoilimit-varargin</ext-link>, 2020).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">imgzoompan v. 1.2.0.0 (GitHub. Retrieved May 25, 2020, <ext-link ext-link-type="uri" xlink:href="https://www.github.com/danyalejandro/imgzoompan">https://www.github.com/danyalejandro/imgzoompan</ext-link>, 2020).</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">uigetdir2 v. 1.0.0.0 (MATLAB Central File Exchange. Retrieved May 25, 2020, <ext-link ext-link-type="uri" xlink:href="https://ch.mathworks.com/matlabcentral/fileexchange/9521-uigetdir2">https://ch.mathworks.com/matlabcentral/fileexchange/9521-uigetdir2</ext-link>, 2020).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">NaN Tolerant Fast Smooth v. 1.1.0.0 (MATLAB Central File Exchange. Retrieved May 25, 2020, <ext-link ext-link-type="uri" xlink:href="https://ch.mathworks.com/matlabcentral/fileexchange/34428-voronoilimit-varargin">https://ch.mathworks.com/matlabcentral/fileexchange/34428-voronoilimit-varargin</ext-link>, 2020).</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Fit circle through 3 points v. 3.0.2.1 (MATLAB Central File Exchange. Retrieved May 25, 2020, <ext-link ext-link-type="uri" xlink:href="https://ch.mathworks.com/matlabcentral/fileexchange/57668-fit-circle-through-3-points">https://ch.mathworks.com/matlabcentral/fileexchange/57668-fit-circle-through-3-points</ext-link>, 2020).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: Elegant Graphics for Data Analysis</source>
        <year>2016</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">R: A language and environment for statistical computing. R Foundation for Statistical Computing v. 3.5.1 (R Foundation for Statistical Computing, 2018).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuen</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Princen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Illingworth</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kittler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Comparative-study of Hough transform methods for circle finding</article-title>
        <source>Image Vis. Comput.</source>
        <year>1990</year>
        <volume>8</volume>
        <fpage>71</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/0262-8856(90)90059-E</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Davies, E. (Ed. Morgan Kaufmann, San Francisco, 2005).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodríguez-Verdugo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vulin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The rate of environmental fluctuations shapes ecological dynamics in a two-species microbial system</article-title>
        <source>Ecol. Lett.</source>
        <year>2019</year>
        <volume>22</volume>
        <fpage>838</fpage>
        <lpage>846</lpage>
        <pub-id pub-id-type="doi">10.1111/ele.13241</pub-id>
        <?supplied-pmid 30790416?>
        <pub-id pub-id-type="pmid">30790416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Datta</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Sliwerska</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gore</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Polz</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Cordero</surname>
            <given-names>OX</given-names>
          </name>
        </person-group>
        <article-title>Microbial interactions lead to rapid micro-scale successions on model marine particles</article-title>
        <source>Nat. Commun.</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11965</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11965</pub-id>
        <?supplied-pmid 27311813?>
        <pub-id pub-id-type="pmid">27311813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pitol</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Bischel</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>Kohn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Julian</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>Virus transfer at the skin-liquid interface</article-title>
        <source>Environ. Sci. Technol.</source>
        <year>2017</year>
        <volume>51</volume>
        <fpage>14417</fpage>
        <lpage>14425</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.est.7b04949</pub-id>
        <pub-id pub-id-type="pmid">29161027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Lim, J. S. Two-dimensional signal and image processing. <italic>ph</italic> (1990).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Otsu</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A threshold selection method from gray-level histograms</article-title>
        <source>IEEE Trans. Syst. Man Cybern.</source>
        <year>1979</year>
        <volume>9</volume>
        <fpage>62</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Canny, J. A computational approach to edge detection. <italic>IEEE Transactions on pattern analysis and machine intelligence</italic>, 679–698 (1986).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Vese</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Active contours without edges</article-title>
        <source>IEEE Trans. Image Process.</source>
        <year>2001</year>
        <volume>10</volume>
        <fpage>266</fpage>
        <lpage>277</lpage>
        <pub-id pub-id-type="doi">10.1109/83.902291</pub-id>
        <?supplied-pmid 18249617?>
        <pub-id pub-id-type="pmid">18249617</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
