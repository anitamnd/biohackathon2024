<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1010091.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9154102</article-id>
    <article-id pub-id-type="pmid">35584140</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-01648</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010091</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Assessment</subject>
          <subj-group>
            <subject>Research Errors</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Microbiome</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Probability Distribution</subject>
              <subj-group>
                <subject>Normal Distribution</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Microbial Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Microbial Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Forecasting</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Forecasting</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Statistical Distributions</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Cloning</subject>
              <subj-group>
                <subject>DNA cloning</subject>
                <subj-group>
                  <subject>Shotgun Sequencing</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Cloning</subject>
            <subj-group>
              <subject>DNA cloning</subject>
              <subj-group>
                <subject>Shotgun Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Shotgun Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Shotgun Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Gastroenterology and Hepatology</subject>
          <subj-group>
            <subject>Inflammatory Bowel Disease</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CBEA: Competitive balances for taxonomic enrichment analysis</article-title>
      <alt-title alt-title-type="running-head">CBEA: Competitive balances for taxonomic enrichment analysis</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2072-3279</contrib-id>
        <name>
          <surname>Nguyen</surname>
          <given-names>Quang P.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hoen</surname>
          <given-names>Anne G.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6794-9945</contrib-id>
        <name>
          <surname>Frost</surname>
          <given-names>H. Robert</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Biomedical Data Science, Geisel School of Medicine at Dartmouth College, Hanover, New Hampshire, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Epidemiology, Geisel School of Medicine at Dartmouth College, Hanover, New Hampshire, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Trento, ITALY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="other" id="econtrib001">
        <p>‡ These authors jointly supervised this work.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hildreth.r.frost@dartmouth.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>5</issue>
    <elocation-id>e1010091</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Nguyen et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Nguyen et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010091.pdf"/>
    <abstract>
      <p>Research in human-associated microbiomes often involves the analysis of taxonomic count tables generated via high-throughput sequencing. It is difficult to apply statistical tools as the data is high-dimensional, sparse, and compositional. An approachable way to alleviate high-dimensionality and sparsity is to aggregate variables into pre-defined sets. Set-based analysis is ubiquitous in the genomics literature and has demonstrable impact on improving interpretability and power of downstream analysis. Unfortunately, there is a lack of sophisticated set-based analysis methods specific to microbiome taxonomic data, where current practice often employs abundance summation as a technique for aggregation. This approach prevents comparison across sets of different sizes, does not preserve inter-sample distances, and amplifies protocol bias. Here, we attempt to fill this gap with a new single-sample taxon enrichment method that uses a novel log-ratio formulation based on the competitive null hypothesis commonly used in the enrichment analysis literature. Our approach, titled competitive balances for taxonomic enrichment analysis (CBEA), generates sample-specific enrichment scores as the scaled log-ratio of the subcomposition defined by taxa within a set and the subcomposition defined by its complement. We provide sample-level significance testing by estimating an empirical null distribution of our test statistic with valid p-values. Herein, we demonstrate, using both real data applications and simulations, that CBEA controls for type I error, even under high sparsity and high inter-taxa correlation scenarios. Additionally, CBEA provides informative scores that can be inputs to downstream analyses such as prediction tasks.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>The study of human-associated microbiomes relies on genomic surveys via high-throughput sequencing. However, microbiome taxonomic data is sparse and high-dimensional which prevents the application of standard statistical techniques. One approach to address this problem is to perform analyses at the level of taxon sets. Set-based analysis has a long history in the genomics literature, with demonstrable impact on improving both power and interpretability. Unfortunately, there is limited interest in developing new set-based tools tailored for microbiome taxonomic data given its unique features compared to other ‘omics data types. We developed a new tool to generate taxon set enrichment scores at the sample level through a novel log-ratio formulation based on the competitive null hypothesis. Our scores can be used for statistical inference at both the sample and population levels, and as inputs to other downstream analyses such as prediction models. We demonstrate the performance of our method against competing approaches across both real data analyses and simulation studies.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21CA253408</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2072-3279</contrib-id>
          <name>
            <surname>Nguyen</surname>
            <given-names>Quang P.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P20GM130454</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2072-3279</contrib-id>
          <name>
            <surname>Nguyen</surname>
            <given-names>Quang P.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P30CA023108</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2072-3279</contrib-id>
          <name>
            <surname>Nguyen</surname>
            <given-names>Quang P.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01LM012723</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hoen</surname>
            <given-names>Anne G.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>Funding for HRF provided by National Institutes of Health grants R21CA253408, P20GM130454 and P30CA023108 to QPN. Funding for AGH provided by National Institutes of Health grant R01LM012723. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <page-count count="24"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-05-31</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>There are no primary data in the paper. All code for primary analyses are available at <ext-link xlink:href="https://github.com/qpmnguyen/CBEA_analysis" ext-link-type="uri">https://github.com/qpmnguyen/CBEA_analysis</ext-link> and we have archived our code on Zenodo (DOI: <ext-link xlink:href="https://doi.org/10.5281/zenodo.5483198" ext-link-type="uri">10.5281/zenodo.5483198</ext-link>) at <ext-link xlink:href="https://zenodo.org/record/5483198#.YmmZe9pBw2x" ext-link-type="uri">https://zenodo.org/record/5483198#.YmmZe9pBw2x</ext-link>. An R package implementation of the method can be found on GitHub (<ext-link xlink:href="https://github.com/qpmnguyen/CBEA" ext-link-type="uri">https://github.com/qpmnguyen/CBEA</ext-link>) and on Bioconductor.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>There are no primary data in the paper. All code for primary analyses are available at <ext-link xlink:href="https://github.com/qpmnguyen/CBEA_analysis" ext-link-type="uri">https://github.com/qpmnguyen/CBEA_analysis</ext-link> and we have archived our code on Zenodo (DOI: <ext-link xlink:href="https://doi.org/10.5281/zenodo.5483198" ext-link-type="uri">10.5281/zenodo.5483198</ext-link>) at <ext-link xlink:href="https://zenodo.org/record/5483198#.YmmZe9pBw2x" ext-link-type="uri">https://zenodo.org/record/5483198#.YmmZe9pBw2x</ext-link>. An R package implementation of the method can be found on GitHub (<ext-link xlink:href="https://github.com/qpmnguyen/CBEA" ext-link-type="uri">https://github.com/qpmnguyen/CBEA</ext-link>) and on Bioconductor.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The microbiome is the collection of microorganisms (bacteria, protozoa, archaea, fungi, and viruses) which co-exists with its host. Previous research has shown that changes in the composition of the human gut microbiome are associated with important health outcomes such as inflammatory bowel disease [<xref rid="pcbi.1010091.ref001" ref-type="bibr">1</xref>], type II diabetes [<xref rid="pcbi.1010091.ref002" ref-type="bibr">2</xref>], and obesity [<xref rid="pcbi.1010091.ref003" ref-type="bibr">3</xref>]. To understand the central role of the microbiome in human health, researchers have relied on high-throughput sequencing methods, either by targeting a specific representative gene (i.e. amplicon sequencing) or by profiling all the genomic content of the sample (i.e. whole-genome shotgun sequencing) [<xref rid="pcbi.1010091.ref004" ref-type="bibr">4</xref>]. Raw sequencing data is then processed through a variety of bioinformatic pipelines [<xref rid="pcbi.1010091.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1010091.ref006" ref-type="bibr">6</xref>], yielding various data products, including taxonomic tables which can be used to study associations between members of the microbiome and an exposure or outcome of interest.</p>
    <p>However, there are unique challenges in the analysis of these taxonomic count tables [<xref rid="pcbi.1010091.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1010091.ref008" ref-type="bibr">8</xref>]. The data is sparse, high-dimensional, and likely compositional [<xref rid="pcbi.1010091.ref007" ref-type="bibr">7</xref>–<xref rid="pcbi.1010091.ref009" ref-type="bibr">9</xref>]. Even though these problems are challenging, a very approachable solution is to use set-based analysis methods, also termed gene set testing in the genomics literature [<xref rid="pcbi.1010091.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1010091.ref011" ref-type="bibr">11</xref>]. Aggregated variables can be less sparse, and testing on a smaller number of features can reduce the multiple-testing burden. As such, gene set testing methods have been shown to increase power and reproducibility of genomic analyses. Furthermore, through the usage of functionally informative sets defined <italic toggle="yes">a priori</italic> based on historical experiments (for example, MSigDB [<xref rid="pcbi.1010091.ref012" ref-type="bibr">12</xref>], and Gene Ontology [<xref rid="pcbi.1010091.ref013" ref-type="bibr">13</xref>]), gene set analysis also allows for more biologically informative interpretations.</p>
    <p>A diverse set of methods has already been developed in this field. Traditional methods utilize the hypergeometric distribution to test for the overrepresentation of a gene set using a candidate list of genes screened based on a marginal model [<xref rid="pcbi.1010091.ref011" ref-type="bibr">11</xref>]. Unfortunately, these approaches are sensitive to the differential expression test as well as the chosen threshold when trying to select genes for the candidate list. Aggregate score methods, which are generally preferred [<xref rid="pcbi.1010091.ref014" ref-type="bibr">14</xref>], instead assign a score for each gene set based on gene-specific statistics such as z-scores or fold change. Of these approaches, methods such as GSEA [<xref rid="pcbi.1010091.ref012" ref-type="bibr">12</xref>] perform a test for each gene set at the population level, summarizing information across all samples. Conversely, methods such as GSVA [<xref rid="pcbi.1010091.ref015" ref-type="bibr">15</xref>] and VAM [<xref rid="pcbi.1010091.ref016" ref-type="bibr">16</xref>], generate enrichment scores at the sample level and are more akin to a transformation. In addition to being able to screen for enriched sets per sample, this strategy also allows for the flexible incorporation of different downstream analyses, such as fitting prediction models, or performing dimension reduction.</p>
    <p>In microbiome research, even when no explicit enrichment analysis is performed, researchers often aggregate taxa to higher Linnean classification levels such as genus, family, or phylum. However, there is limited research done to extend existing set-based methods to microbiome relative abundance data. Some software suites, such as <italic toggle="yes">MicrobiomeAnalyst</italic>, do offer tools to perform enrichment testing with curated taxon sets [<xref rid="pcbi.1010091.ref017" ref-type="bibr">17</xref>]. However, the approach used in <italic toggle="yes">MicrobiomeAnalyst</italic> is a form of overrepresentation analysis at the population level and therefore similarly sensitive to the differential abundance approach used and the p-value threshold. One of the primary challenges for adapting gene set analysis to the microbiome context is the compositional nature of the data. Sequencing technologies constrain the total number of reads, and samples are expected to have the same number of reads instead of DNA content [<xref rid="pcbi.1010091.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1010091.ref019" ref-type="bibr">19</xref>]. However, different samples still yield arbitrarily different total read counts [<xref rid="pcbi.1010091.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1010091.ref020" ref-type="bibr">20</xref>], which suggests the usage of normalization methods to allow for proper comparison of feature abundances across samples. However, microbiome data sets do not follow certain assumptions that enable the cross-application of methods from similar fields (such as RNA-seq) [<xref rid="pcbi.1010091.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1010091.ref019" ref-type="bibr">19</xref>]. For example, DESeq2’s <italic toggle="yes">estimateSizeFactors</italic> [<xref rid="pcbi.1010091.ref021" ref-type="bibr">21</xref>] assumes that the majority of genes act as housekeeping genes with constant expression levels across samples. As such, practitioners often rely on total sum normalization to transform count data into relative proportions that sum to one [<xref rid="pcbi.1010091.ref022" ref-type="bibr">22</xref>]. Some studies have provided emprical performance evaluations supporting this normalization schema [<xref rid="pcbi.1010091.ref023" ref-type="bibr">23</xref>]. Since this approach imposes a sum constraint on the data, post normalization microbiome data sets are compositional [<xref rid="pcbi.1010091.ref009" ref-type="bibr">9</xref>], which means that the abundance of any taxon can only be interpreted relative to another. Under this scenario, log-ratio based approaches from the compositional data analysis (CoDA) literature [<xref rid="pcbi.1010091.ref024" ref-type="bibr">24</xref>] are motivated to address this issue.</p>
    <p>Unfortunately, the standard practice for aggregating variables using element-wise summations (referred to as “amalgamations” in the CoDA literature), does not adequately address the compositional issue [<xref rid="pcbi.1010091.ref025" ref-type="bibr">25</xref>]. First, inter-sample Aitchison distances computed on original parts are not preserved after amalgamation [<xref rid="pcbi.1010091.ref026" ref-type="bibr">26</xref>]. This means that cluster analyses might show different results depending on the level of amalgamation and differ from the those computed from original variables. Second, amalgamations do not allow for comparison between sets of different sizes within the same experimental condition since larger sets will have larger means and variances. Third, considering that each taxa has specific measurement biases [<xref rid="pcbi.1010091.ref025" ref-type="bibr">25</xref>], an amalgamation-based approach would make the bias of the amalgamated variable dependent on the relative abundance of its constituents. In other words, if taxon 1 has abundance <italic toggle="yes">A</italic><sub>1</sub> and bias <italic toggle="yes">B</italic><sub>1</sub>, while taxon 2 has abundance <italic toggle="yes">A</italic><sub>2</sub> and bias <italic toggle="yes">B</italic><sub>2</sub>, then the bias of the aggregate variable (for example, a genus) is (<italic toggle="yes">A</italic><sub>1</sub><italic toggle="yes">B</italic><sub>1</sub> + <italic toggle="yes">A</italic><sub>2</sub><italic toggle="yes">B</italic><sub>2</sub>)/(<italic toggle="yes">A</italic><sub>1</sub> + <italic toggle="yes">A</italic><sub>2</sub>) (see Appendix 1. from McLaren et al. [<xref rid="pcbi.1010091.ref025" ref-type="bibr">25</xref>]). This means that bias invariant approaches (such as analyses of ratios) would no longer be invariant when applied to amalgamated variables, as bias now varies across samples. The alternative would be to multiply the proportions rather than to sum them [<xref rid="pcbi.1010091.ref026" ref-type="bibr">26</xref>].</p>
    <p>Here, we present a taxon-set testing method for microbiome relative abundance data that addresses the aforementioned issues. Our approach generates enrichment scores at the sample level similar to GSVA [<xref rid="pcbi.1010091.ref015" ref-type="bibr">15</xref>] and VAM [<xref rid="pcbi.1010091.ref016" ref-type="bibr">16</xref>]. We leverage the concept of the <italic toggle="yes">Q</italic><sub>1</sub> competitive hypothesis presented in Tian et al. [<xref rid="pcbi.1010091.ref027" ref-type="bibr">27</xref>] to formulate the enrichment of a set as the compositional balance [<xref rid="pcbi.1010091.ref028" ref-type="bibr">28</xref>] of taxa within the set and remainder taxa using multiplication as the method of aggregating proportions [<xref rid="pcbi.1010091.ref026" ref-type="bibr">26</xref>]. This well-defined null hypothesis allows us to perform significance testing with interpretable results through estimating the empirical distribution of our statistic under the null that can also account for variance inflation due to inter-taxa correlation [<xref rid="pcbi.1010091.ref029" ref-type="bibr">29</xref>].</p>
    <p>In the following sections, we present our approach, titled competitive balances for taxonomic erichment analysis (CBEA). First, we present the step-by-step formulation of CBEA and discuss its statistical properties. Second, we detail our evaluation strategy using both real data and parametric simulations and the methods we are comparing. Third, we present results on enrichment testing using CBEA for single samples as well as at the population level. Fourth, we show the performance of CBEA in downstream disease prediction. Finally, we discuss our results and the limitations of our method. An R package implementation of CBEA can be installed via Bioconductor. The development version can be found on GitHub (<ext-link xlink:href="http://www.github.com/qpmnguyen/CBEA" ext-link-type="uri">www.github.com/qpmnguyen/CBEA</ext-link>).</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Competitive balances for taxonomic enrichment analysis (CBEA)</title>
      <p>The CBEA method generates sample-specific enrichment scores for microbial sets using products of proportions [<xref rid="pcbi.1010091.ref030" ref-type="bibr">30</xref>]. Details on the computational implementation of CBEA can be found in <xref rid="pcbi.1010091.s008" ref-type="supplementary-material">S1 File</xref>. The CBEA method takes two inputs:</p>
      <list list-type="bullet">
        <list-item>
          <p><bold>X</bold>: <italic toggle="yes">n</italic> by <italic toggle="yes">p</italic> matrix of positive proportions for <italic toggle="yes">p</italic> taxa and <italic toggle="yes">n</italic> samples measured through either targeted sequencing (such as of the 16S rRNA gene) or whole genome shotgun sequencing. Usually, <bold>X</bold> is generated from standard taxonomic profiling pipelines such as DADA2 [<xref rid="pcbi.1010091.ref005" ref-type="bibr">5</xref>] for 16S rRNA sequencing, or MetaPhlAn2 [<xref rid="pcbi.1010091.ref006" ref-type="bibr">6</xref>] for whole genome shotgun sequencing. CBEA does not accept <italic toggle="yes">X</italic> matrices with zeroes since they invalidate the log-ratio transformation. Users can generate a dense matrix <italic toggle="yes">X</italic> using their method of choice, however, by default CBEA will add a pseudocount of 10<sup>−5</sup> if zeroes are detected in the matrix.</p>
        </list-item>
        <list-item>
          <p><bold>A</bold>: <italic toggle="yes">p</italic> by <italic toggle="yes">m</italic> indicator matrix annotating the membership of each taxon <italic toggle="yes">p</italic> to <italic toggle="yes">m</italic> sets of interest. These sets can be Linnean taxonomic classifications annotated using databases such as SILVA [<xref rid="pcbi.1010091.ref031" ref-type="bibr">31</xref>], or those based on more functionally driven categories such as tropism or ecosystem roles (<italic toggle="yes">A</italic><sub><italic toggle="yes">i</italic>,<italic toggle="yes">j</italic></sub> = 1 indicates that microbe <italic toggle="yes">i</italic> belongs to set <italic toggle="yes">j</italic>).</p>
        </list-item>
      </list>
      <p>The CBEA method generates one output:</p>
      <list list-type="bullet">
        <list-item>
          <p><bold>E</bold>: <italic toggle="yes">n</italic> by <italic toggle="yes">m</italic> matrix indicating the enrichment score of <italic toggle="yes">m</italic> pre-defined sets identified in <bold>A</bold> across <italic toggle="yes">n</italic> samples.</p>
        </list-item>
      </list>
      <p>The procedure is as follows:</p>
      <list list-type="order">
        <list-item>
          <p><bold>Compute the CBEA statistic</bold>: Let <bold>M</bold> be a <italic toggle="yes">n</italic> by <italic toggle="yes">m</italic> matrix of CBEA scores. Let <bold>M</bold><sub><italic toggle="yes">i</italic>,<italic toggle="yes">k</italic></sub> be the CBEA score for set <italic toggle="yes">k</italic> and sample <italic toggle="yes">i</italic>:
<disp-formula id="pcbi.1010091.e001"><alternatives><graphic xlink:href="pcbi.1010091.e001.jpg" id="pcbi.1010091.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>p</mml:mi></mml:mfrac></mml:msqrt><mml:mtext>ln</mml:mtext><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">g</italic>(.) is the geometric mean. This represents the ratio of the geometric mean of the relative abundance of taxa assigned to set <italic toggle="yes">k</italic> and the remainder taxa.</p>
        </list-item>
        <list-item>
          <p><bold>Estimate the empirical null distribution</bold>: Enrichment scores represent the test statistic for the <italic toggle="yes">Q</italic><sub>1</sub> null hypothesis <italic toggle="yes">H</italic><sub><italic toggle="yes">o</italic></sub> that relative abundances in <bold>X</bold> of members of set <italic toggle="yes">k</italic> are not enriched compared to those not in set <italic toggle="yes">k</italic>. Since the distribution of CBEA under the null varies depending on data characteristics (<xref rid="pcbi.1010091.g001" ref-type="fig">Fig 1</xref>), an empirical null distribution will be estimated from data.</p>
          <list list-type="bullet">
            <list-item>
              <p><bold>Compute the CBEA statistic on permuted and un-permuted X</bold>. Let <bold>X</bold><sub><italic toggle="yes">perm</italic></sub> be the column permuted relative abundance matrix, and <bold>M</bold><sub><italic toggle="yes">perm</italic></sub> be the corresponding CBEA scores generated from <bold>X</bold><sub><italic toggle="yes">perm</italic></sub>. Similarly, we let <bold>M</bold><sub><italic toggle="yes">unperm</italic></sub> be CBEA scores generated from <bold>X</bold>.</p>
            </list-item>
            <list-item>
              <p><bold>Estimate the correlation-adjusted empirical distribution for each set</bold>. For each set, a fit a parametric distribution to both <bold>M</bold><sub><italic toggle="yes">perm</italic></sub> and <bold>M</bold><sub><italic toggle="yes">unperm</italic></sub>. The location measure estimated from <bold>M</bold><sub><italic toggle="yes">perm</italic></sub> and the spread measure estimated from <bold>M</bold><sub><italic toggle="yes">unperm</italic></sub> will be combined as the correlation-adjusted empirical null distribution <bold>P</bold><sub><italic toggle="yes">emp</italic></sub> for each set. Two available options are the normal distribution and the mixture normal distribution. For the normal distribution, parameters were estimated using the method of maximum likelihood implemented in the <italic toggle="yes">fitdistr</italic> package [<xref rid="pcbi.1010091.ref032" ref-type="bibr">32</xref>]. For the mixture normal distribution, parameters were estimated using an expectation-maximization algorithm implemented in the <italic toggle="yes">mixtools</italic> package [<xref rid="pcbi.1010091.ref033" ref-type="bibr">33</xref>].</p>
            </list-item>
          </list>
        </list-item>
        <list-item>
          <p><bold>Calculate finalized CBEA scores with respect to the empirical null</bold>: Enrichment scores <bold>E</bold><sub><italic toggle="yes">i</italic>,<italic toggle="yes">k</italic></sub> are calculated as the cumulative distribution function (CDF) values or z-scores with respect to <bold>P</bold><sub><italic toggle="yes">emp</italic></sub> distribution. Raw p-values can be calculated by subtracting <bold>E</bold> from 1.</p>
        </list-item>
      </list>
      <fig position="float" id="pcbi.1010091.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010091.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Properties of the null distribution of CBEA under the global null simulations.</title>
          <p>Panel <bold>(B)</bold> presents kurtosis and skewness of CBEA scores while panel <bold>(A)</bold> presents the goodness of fit (as Kolmogorov-Smirnov D statistic) for mixture normal and normal distributions. Panel <bold>(C)</bold> is a density plot of the shape of the null distribution. Results indicated the necessity of estimating an empirical null and demonstrating that the mixture distribution was the better fit compared to the basic normal.</p>
        </caption>
        <graphic xlink:href="pcbi.1010091.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Properties of CBEA</title>
      <sec id="sec005">
        <title>CBEA and balances between groups of parts</title>
        <p>The CBEA statistic is based on the multiplication-based aggregation approach used to calculate balances between groups of parts [<xref rid="pcbi.1010091.ref026" ref-type="bibr">26</xref>]. These balances are computed using the isometric log-ratio (ILR) transformation [<xref rid="pcbi.1010091.ref030" ref-type="bibr">30</xref>] formula. For a given balance <italic toggle="yes">i</italic> splitting variables across sets <italic toggle="yes">R</italic> and <italic toggle="yes">S</italic>, we have the balance coordinate <inline-formula id="pcbi.1010091.e002"><alternatives><graphic xlink:href="pcbi.1010091.e002.jpg" id="pcbi.1010091.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> as:
<disp-formula id="pcbi.1010091.e003"><alternatives><graphic xlink:href="pcbi.1010091.e003.jpg" id="pcbi.1010091.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mspace width="4pt"/><mml:mtext>log</mml:mtext><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic toggle="yes">r</italic> and <italic toggle="yes">s</italic> are the cardinalities of sets <italic toggle="yes">R</italic> and <italic toggle="yes">S</italic> respectively, <italic toggle="yes">g</italic>(<italic toggle="yes">z</italic>) is the geometric mean, and <italic toggle="yes">X</italic><sub><italic toggle="yes">j</italic></sub> are values of the original predictors with indexes defined by membership in <italic toggle="yes">R</italic> and <italic toggle="yes">S</italic>.</p>
        <p>CBEA belongs to a set of methods that seeks to leverage compositional balances for the analysis of microbiome data [<xref rid="pcbi.1010091.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1010091.ref034" ref-type="bibr">34</xref>–<xref rid="pcbi.1010091.ref036" ref-type="bibr">36</xref>]. Unlike methods such as PhILR [<xref rid="pcbi.1010091.ref035" ref-type="bibr">35</xref>], CBEA does not present an orthonormal basis for the complete ILR transformation (such as a a sequential binary partition) [<xref rid="pcbi.1010091.ref030" ref-type="bibr">30</xref>]. Therefore, it is not a subclass of the ILR transformation and is adjacent to this approach. A similar method to CBEA would be phylofactor [<xref rid="pcbi.1010091.ref034" ref-type="bibr">34</xref>]. However, instead of performing an optimization procedure to identify interesting balances, CBEA constructs balances <italic toggle="yes">a priori</italic> using pre-defined sets, and formulates the enrichment of a set as the scaled log-ratio between the center of the subcomposition represented by microbes within the set and the center of the subcomposition represented by remainder taxa. This formulation aligns with the <italic toggle="yes">Q</italic><sub>1</sub> null hypothesis from the gene set testing literature [<xref rid="pcbi.1010091.ref027" ref-type="bibr">27</xref>].</p>
      </sec>
      <sec id="sec006">
        <title>Estimating the null distribution</title>
        <p>We can assume that the CBEA statistic, similar to other log-ratio based transforms, follows a normal distribution [<xref rid="pcbi.1010091.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1010091.ref037" ref-type="bibr">37</xref>]. However, when applying CBEA for hypothesis testing at the sample level, it is expected that the researcher will be testing a large number of hypotheses. Under the assumption that the number of truly significant hypotheses is low, Efron [<xref rid="pcbi.1010091.ref038" ref-type="bibr">38</xref>] showed that estimating the null distribution of the test statistic directly (termed the “empirical null distribution”) is much more preferable than using the theoretical null due to unobserved confounding effects inherently part of observational studies. As such, to perform significance testing using CBEA, we also estimated the null distribution from observed raw CBEA variables.</p>
        <p>This assumption is also supported by preliminary simulation studies (detailed below). We simulated microbiome taxonomic count data under the global null across different data features and compute raw CBEA scores as well as kurtosis and skewness of the distribution under the null in <xref rid="pcbi.1010091.g001" ref-type="fig">Fig 1A</xref>. We found that the characteristics of the distribution change depending on sparsity and inter-taxa correlation. Sparsity seems to drive it to be more positively skewed while inter-taxa correlation encourages platykurtic (negative kurtosis) behaviour. The effect is most dramatic under both high inter-taxa correlation and sparsity. This heterogeneity further supports the decision to estimate an empirical null distribution, as suggested by Efron [<xref rid="pcbi.1010091.ref038" ref-type="bibr">38</xref>].</p>
        <p>Additionally, the degree of kurtosis and skewness also suggests that the normal distribution itself might not be a good approximation of the null. To address this issue, we also evaluated a two-component normal mixture distribution. <xref rid="pcbi.1010091.g001" ref-type="fig">Fig 1B</xref> showed the goodness of fit each distribution form using the Kolmogorov-Smirnov (KS) test statistic comparing each fitted distribution to CBEA scores generated under global null simulation scenarios. We can see that the mixture normal distribution is a better fit (lower KS scores) than the normal distribution (across both sparsity and correlation settings).</p>
        <p>We performed our empirical null estimation by fitting our distribution of choice and computing relevant parameters on raw CBEA scores on taxa-permuted data (equivalent to gene permutation in the gene expression literature). As such, the null distribution is characterized by scores computed on sets of equal size with randomly drawn taxa.</p>
      </sec>
      <sec id="sec007">
        <title>Variance inflation due to inter-taxa correlation</title>
        <p>When taxa within a set are highly correlated, the variance of the sample mean of taxon-wise statistics is inflated. Without loss of generalizability, for a set of taxa with taxon-specific statistics <italic toggle="yes">x</italic><sub>1</sub>, …, <italic toggle="yes">x</italic><sub><italic toggle="yes">p</italic></sub>, we have the variance of the mean <inline-formula id="pcbi.1010091.e004"><alternatives><graphic xlink:href="pcbi.1010091.e004.jpg" id="pcbi.1010091.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> to be:
<disp-formula id="pcbi.1010091.e005"><alternatives><graphic xlink:href="pcbi.1010091.e005.jpg" id="pcbi.1010091.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <italic toggle="yes">σ</italic><sub><italic toggle="yes">i</italic></sub> is the standard deviation of taxon <italic toggle="yes">i</italic> and <italic toggle="yes">ρ</italic><sub><italic toggle="yes">ij</italic></sub> is the correlation between <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>. The second term of (<xref rid="pcbi.1010091.e005" ref-type="disp-formula">3</xref>) is the correlation dependent variance component, which goes to 0 if there is no correlation. The CBEA statistic follows a similar pattern. Since the geometric mean of a set of variables is equivalent to the exponential of the arithmetic mean of their logarithms, we can re-write CBEA score for a set <italic toggle="yes">k</italic> with size <italic toggle="yes">K</italic> as follows:
<disp-formula id="pcbi.1010091.e006"><alternatives><graphic xlink:href="pcbi.1010091.e006.jpg" id="pcbi.1010091.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>(</mml:mo><mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mspace width="-1.111pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mspace width="-11.111pt"/></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mspace width="11.111pt"/><mml:mo>-</mml:mo><mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mspace width="-1.111pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mi>j</mml:mi><mml:mo>∉</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mspace width="-11.111pt"/></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic toggle="yes">p</italic> is the overall number of taxa, <italic toggle="yes">j</italic> is the index of a taxa, and <italic toggle="yes">K</italic> is the set of indices of taxa in set <italic toggle="yes">k</italic>. The CBEA statistic then looks similar to a t-statistic for difference in means of log-transformed proportions. As such, the pooled variance of CBEA is dependent on the variance inflation of both mean components <inline-formula id="pcbi.1010091.e007"><alternatives><graphic xlink:href="pcbi.1010091.e007.jpg" id="pcbi.1010091.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mspace width="-1.111pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mspace width="-11.111pt"/></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010091.e008"><alternatives><graphic xlink:href="pcbi.1010091.e008.jpg" id="pcbi.1010091.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mspace width="-1.111pt"/><mml:mtext>log</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mi>j</mml:mi><mml:mo>∉</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mspace width="-11.111pt"/></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. The result of this variance inflation is an inflated type I error since highly correlated sets are also detected as significantly enriched.</p>
        <p>However, as Wu et al. [<xref rid="pcbi.1010091.ref029" ref-type="bibr">29</xref>] showed, performing column permutations to estimate the null distribution of a competitive test statistic does not allow for adequate capture of this variance inflation factor since the permutation procedure disrupts the natural correlation structure of the original variables. It is important to address this problem since there is strong inter-taxa correlation within the microbiome [<xref rid="pcbi.1010091.ref039" ref-type="bibr">39</xref>]. Our strategy for addressing this issue is to use the location (or mean) estimate from the column permuted raw score matrix, with the spread (or variance) estimate taken from the original un-permuted scores. This still allows us to leverage the null distribution generated via column permutation while using the proper variance estimate taken from scores where the correlation structure has not been disrupted. As such, this procedure assumes that the variance of the test statistic under the alternate hypothesis is the same as that of the null. Details of the computational implementation to this estimation process can be found in <xref rid="pcbi.1010091.s008" ref-type="supplementary-material">S1 File</xref>.</p>
        <p>However, set-based analysis is an exploratory approach that can help generate functionally informative hypotheses, and as such users might not want strict type I error control in favor of higher power. This is especially true for competitive hypotheses where its stricter formulation compared to the self-contained approach implies that the test naturally has lower power [<xref rid="pcbi.1010091.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1010091.ref040" ref-type="bibr">40</xref>]. Furthermore, sets that are highly correlated compared to background can be biologically relevant. Therefore, CBEA provides an option for users to specify whether correlation adjustment is desired.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec008">
    <title>Evaluation</title>
    <p>We based our evaluation strategy on gene set testing benchmarking standards set by Geistlinger et al. [<xref rid="pcbi.1010091.ref041" ref-type="bibr">41</xref>] and utilized the same approaches whenever possible. All data sets are obtained from either the <italic toggle="yes">curatedMetagenomicData</italic> [<xref rid="pcbi.1010091.ref042" ref-type="bibr">42</xref>] and <italic toggle="yes">HMP16SData</italic> [<xref rid="pcbi.1010091.ref043" ref-type="bibr">43</xref>] R packages (2020–10-02 snapshot), or downloaded from the Qiita platform [<xref rid="pcbi.1010091.ref044" ref-type="bibr">44</xref>]. All code and data sets used for evaluation of this method are publicly available and can be found on GitHub (<ext-link xlink:href="https://www.github.com/qpmnguyen/CBEA_analysis" ext-link-type="uri">qpmnguyen/CBEA_analysis</ext-link>). Additional packages used to support this analysis includes: <italic toggle="yes">tidyverse</italic> [<xref rid="pcbi.1010091.ref045" ref-type="bibr">45</xref>], <italic toggle="yes">pROC</italic> [<xref rid="pcbi.1010091.ref046" ref-type="bibr">46</xref>], <italic toggle="yes">phyloseq</italic> [<xref rid="pcbi.1010091.ref047" ref-type="bibr">47</xref>], <italic toggle="yes">mia</italic> [<xref rid="pcbi.1010091.ref048" ref-type="bibr">48</xref>], <italic toggle="yes">targets</italic> [<xref rid="pcbi.1010091.ref049" ref-type="bibr">49</xref>].</p>
    <sec id="sec009">
      <title>Statistical significance</title>
      <p>We evaluated the inference procedure of CBEA compared to alternate methods using two approaches: randomly sampled taxa sets and sample label permutation. These analyses were performed on the 16S rRNA gene sequencing of the oral microbiome from the Human Microbiome Project [<xref rid="pcbi.1010091.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1010091.ref050" ref-type="bibr">50</xref>]. This data set contains 369 samples split into two subsites: supragingival and subgingival. We processed this data set by removing all samples with total read counts less than 1000 and OTUs whose presence (at least 1 count) is in 10% of samples or less.</p>
      <sec id="sec010">
        <title>Sample-level inference</title>
        <p>Due to CBEA’s self-contained null hypothesis, we can perform inference at the sample level for the enrichment of a set. We evaluated this application by generating one random taxon-set of different sizes <italic toggle="yes">S</italic> ∈ {20, 50, 100, 150, 200} across 500 iterations. Random sets can act as our estimate for type I error since they match the CBEA null hypothesis stated in Materials and methods, where we expect that within each sample sets of randomly drawn taxa should not be significantly enriched compared to the remainder background taxa. For this evaluation, we estimated type I error as the fraction of samples in which our random set is detected as significant at a p-value threshold of 0.05 with confidence bands computed from the standard error across all iterations. Additionally, this analysis also tests whether CBEA is sensitive to different set sizes.</p>
      </sec>
      <sec id="sec011">
        <title>Population-level inference</title>
        <p>We can perform enrichment testing at the population level by generating corresponding sample level CBEA scores and performing a two-sample test such as Welch’s t-test. In order to evaluate CBEA under this context, we generated CBEA scores of sets representing genus-level annotation in the above gingival data set [<xref rid="pcbi.1010091.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1010091.ref050" ref-type="bibr">50</xref>] and applied a t-test to test for enrichment (similar to GSVA [<xref rid="pcbi.1010091.ref015" ref-type="bibr">15</xref>]) across a randomly generated variable indicating case/control status (repeated 500 times). Type I error is estimated as the fraction of sets per iteration found to be significantly enriched with confidence bands computed from the standard error across all iterations. In addition, we performed a random set analysis assessment, where we generated 100 sets of different set sizes <italic toggle="yes">S</italic> ∈ {20, 50, 100, 150, 200} and evaluated the fraction of genera that were found to be differentially abundant across the original labels (supragingival versus subgingival subsite). 95% confidence intervals were computed using the Agresti-Couli approach [<xref rid="pcbi.1010091.ref051" ref-type="bibr">51</xref>].</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>Phenotype relevance</title>
      <p>We want to evaluate whether sets found to be significantly enriched by CBEA are relevant to the research question. To perform this assessment, we relied on the gingival data set mentioned above [<xref rid="pcbi.1010091.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1010091.ref050" ref-type="bibr">50</xref>]. This data set was chosen because its clear biological interpretation can serve as the ground truth. Specifically, we expect aerobic microbes to be enriched in the supragingival subsite where the biofilm is exposed to the open air, while conversely anaerobic microbes should thrive in the subgingival site [<xref rid="pcbi.1010091.ref052" ref-type="bibr">52</xref>]. Genus-level annotations for microbial metabolism from Beghini et al. [<xref rid="pcbi.1010091.ref053" ref-type="bibr">53</xref>] were obtained from the GitHub repository associated with Calagaro et al. [<xref rid="pcbi.1010091.ref054" ref-type="bibr">54</xref>]. For sample-level inference, we assessed power as the fraction of supragingival samples whereby aerobic microbes are significantly enriched. For population-level inference, power is the fraction of sets representing genus-level taxonomic assignments that were significant across subsite labels.</p>
      <p>In addition to statistical power, we also assessed phenotype relevance through evaluating whether highly ranked sets based on CBEA scores were more likely to be enriched according to the ground truth. This is represented by the area under the receiving operator curve (AUROC/AUC) scores computed on CBEA scores against true labels (similar approach was used to evaluate VAM [<xref rid="pcbi.1010091.ref016" ref-type="bibr">16</xref>]). DeLong 95% confidence intervals for AUROC [<xref rid="pcbi.1010091.ref055" ref-type="bibr">55</xref>] were obtained for each estimate.</p>
    </sec>
    <sec id="sec013">
      <title>Disease prediction</title>
      <p>CBEA scores can also be used for downstream analyses such as disease prediction tasks. We utilized two data sets for this evaluation:</p>
      <list list-type="order">
        <list-item>
          <p>Whole genome sequencing of stool samples from inflammatory bowel disease (IBD) patients in the MetaHIT consortium [<xref rid="pcbi.1010091.ref056" ref-type="bibr">56</xref>]. This data set contains 396 samples from a cohort of European adults, of whom 195 adults were classified as having IBD (which includes patients diagnosed with either ulcerative colitis or Crohn’s disease). We processed this data by removing all samples with less than 1,000 total read counts as well as any OTU that was present (with non-zero proportions) in 10% of the samples or fewer. Prior to model fitting, we back-transformed relative abundances into count data (to align the format with our 16S rRNA gene sequencing data set), using the provided total number of reads aligned to MetaPhlan marker genes (per sample).</p>
        </list-item>
        <list-item>
          <p>16S rRNA gene sequencing of stool samples from IBD patients in the RISK cohort [<xref rid="pcbi.1010091.ref057" ref-type="bibr">57</xref>]. This data set contains 16S rRNA gene sequencing samples from a cohort of pediatric patients (ages &lt; 17) from the RISK cohort enrolled in the United States and Canada. Of the 671 samples obtained, 500 samples belong to patients with IBD. We processed this data set by removing all samples with less than 1,000 total read counts as well as any OTU that was present (at least 1 count) in 10% of the samples or fewer.</p>
        </list-item>
      </list>
      <p>We evaluate disease prediction performance by fitting a random forest model [<xref rid="pcbi.1010091.ref058" ref-type="bibr">58</xref>] using CBEA scores as inputs to classify samples of patients with IBD or as healthy controls. Random forest was chosen as a baseline learner due to its flexibility as an out-of-the-box model that is easy to fit. In this instance, we evaluated predictive performance of a default random forest model (without hyperparameter tuning) AUROC after 10-fold cross validation. Additionally, we utilized SMOTE to correct for class imbalances [<xref rid="pcbi.1010091.ref059" ref-type="bibr">59</xref>]. Implementation was done using the <italic toggle="yes">tidymodels</italic> suite of packages [<xref rid="pcbi.1010091.ref060" ref-type="bibr">60</xref>].</p>
    </sec>
    <sec id="sec014">
      <title>Comparison methods</title>
      <p>We benchmarked the statistical properties of CBEA against existing baseline approaches. For sample-level inference analyses, we utilized the Wilcoxon rank-sum test, which non-parametrically tests the difference in mean counts between taxa from a pre-defined set and its remainder similar to CBEA. For assessments at the population level, we compared CBEA against the performance of a standard test for differential abundance with set-level features generated via element-wise summations instead. We chose DESeq2 [<xref rid="pcbi.1010091.ref021" ref-type="bibr">21</xref>] and corncob [<xref rid="pcbi.1010091.ref061" ref-type="bibr">61</xref>] because they represent methods extrapolated from RNA-seq [<xref rid="pcbi.1010091.ref047" ref-type="bibr">47</xref>] and those developed specifically for microbiome data.</p>
      <p>Since disease prediction models and rankings-based phenotype relevance analyses seek to evaluate the informativeness of CBEA scores instead of relying on computing p-values, we compared performance against other single-sample-based approaches from the gene set testing literature, specifically ssGSEA [<xref rid="pcbi.1010091.ref062" ref-type="bibr">62</xref>] and GSVA [<xref rid="pcbi.1010091.ref015" ref-type="bibr">15</xref>]. Additionally, for evaluating predictions, we also compared performance against a standard analysis plan where inputs are count-aggregated sets with the centered log-ratio (CLR) transformation.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec015">
    <title>Results</title>
    <p>In this section, we present results for evaluating statistical significance, phenotype relevance, and predictive performance. In addition to real data, we also evaluated models based on parametric simulations. Results can be found in the Supplemental Materials (<xref rid="pcbi.1010091.s001" ref-type="supplementary-material">S1</xref>–<xref rid="pcbi.1010091.s005" ref-type="supplementary-material">S5</xref> Figs).</p>
    <sec id="sec016">
      <title>Statistical significance</title>
      <sec id="sec017">
        <title>Inference at the sample level</title>
        <p>CBEA provides significance testing at the sample level through a self-contained competitive null hypothesis. Generating random sets approximates the global null setting where within each sample, sets generated by randomly sampling taxa should not be significantly more enriched than remainder taxa.</p>
        <p><xref rid="pcbi.1010091.g002" ref-type="fig">Fig 2</xref> demonstrates type I error of sample-level inference evaluated using the random set approach. The Wilcoxon rank sum test and unadjusted CBEA under mixture normal assumption demonstrated good type I error control at the appropriate <italic toggle="yes">α</italic> level. This fits with our expectations since the mixture normal distribution, has a much better fit than the normal distribution especially at the tails of the empirical distribution (<xref rid="pcbi.1010091.g001" ref-type="fig">Fig 1</xref>). However, other variants of CBEA demonstrated inflated type I error, especially correlation adjusted variants compared to their unadjusted counter parts. Encouragingly, all methods demonstrate consistent performance across all set sizes, with a slight increase in type I error at the highest levels.</p>
        <fig position="float" id="pcbi.1010091.g002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010091.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Random taxa set analyses for inference at the sample level of CBEA under different parametric assumptions compared against a Wilcoxon rank-sum test.</title>
            <p>Type I error (<italic toggle="yes">y</italic>-axis) was evaluated by generating random sets of different sizes (<italic toggle="yes">x</italic>-axis) (500 replications per size) and computing the fraction of samples in which the set was found to be significantly enriched at <italic toggle="yes">α</italic> = 0.05. Error bars represent the mean type I error ± sample standard error computed across 500 replications of the experiment. Only the unadjusted CBEA with the mixture normal distribution and the Wilcoxon rank sum test were able to control for type I error at 0.05. All approaches are invariant to set sizes.</p>
          </caption>
          <graphic xlink:href="pcbi.1010091.g002" position="float"/>
        </fig>
        <p>Interestingly, simulation results (<xref rid="pcbi.1010091.s001" ref-type="supplementary-material">S1 Fig</xref>) showed an opposite pattern. Adjusted approaches were good at controlling for type I error, especially under the low inter-taxa correlation values within the set (similar to generating random sets where the natural correlation structure is disrupted). In these simulations, unadjusted approaches and the Wilcoxon rank sum test had significant type I error inflation with increasing correlation. All approaches seems to be invariant to the level of data sparsity.</p>
      </sec>
      <sec id="sec018">
        <title>Inference at the population level</title>
        <p>Similar to other single-sample approaches to gene set testing such as GSVA [<xref rid="pcbi.1010091.ref015" ref-type="bibr">15</xref>], we can perform inference at the population level by utilizing a two-sample difference in means test. Here, we evaluated using CBEA scores generated under different settings with Welch’s t-test in a supervised manner to assess whether a set is enriched across case/control status.</p>
        <p><xref rid="pcbi.1010091.g003" ref-type="fig">Fig 3</xref> shows results for this scenario using both random sample label and random set evaluations. The random sample label approach (<xref rid="pcbi.1010091.g003" ref-type="fig">Fig 3A</xref>) provided a controlled setting where we can estimate type I error rate controlled at <italic toggle="yes">α</italic> = 0.05. Across all replications, CBEA methods were able to control for type I error at the nominal threshold of 0.05, with CBEA raw scores being the most performant. Neither output types, correlation adjustment, nor distributional assumption improved performance values. Surprisingly, DESeq2 and corncob both exhibited significantly inflated type I error.</p>
        <fig position="float" id="pcbi.1010091.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010091.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <p>Random sample label (A) and random set (B) analyses for population level inference. (<bold>A</bold>) Type I error (<italic toggle="yes">x</italic>-axis) was estimated as the overall fraction of sets found to be enriched <italic toggle="yes">α</italic> = 0.05 using randomly generated sample labels (500 permutations). Error bars represent the mean type I error ± sample standard error. (<bold>B</bold>) Proportion of significant sets (<italic toggle="yes">y</italic>-axis) using 100 randomly generated sets of different set sizes (<italic toggle="yes">x</italic>-axis). Confidence intervals computed using Agresti-Couli method for binomial proportions. For sample label permutation (<bold>A</bold>), all CBEA approaches were able to control for type I error but not for corncob and DESeq2. For random set analyses (<bold>B</bold>), all approaches demonstrated similar rates of accepting significant sets and were invariant to overall set size.</p>
          </caption>
          <graphic xlink:href="pcbi.1010091.g003" position="float"/>
        </fig>
        <p>We also assessed the impact of set-size on the inference procedure by testing for enrichment using the original sample labels, but with randomly sampled sets of different sizes (<xref rid="pcbi.1010091.g003" ref-type="fig">Fig 3B</xref>). Overall, we observed very similar values across CBEA as well as corncob and DESeq2, suggesting that no individual method was systematically identifying too many significant sets. Additionally, similar to analogous analyses at the sample level, no approach was significantly sensitive to changes in set sizes.</p>
      </sec>
    </sec>
    <sec id="sec019">
      <title>Phenotype relevance</title>
      <sec id="sec020">
        <title>Inference at the sample level</title>
        <p>In <xref rid="pcbi.1010091.g004" ref-type="fig">Fig 4</xref>, we evaluated whether sets found to be significant by CBEA are relevant to the phenotype of interest. We leveraged the gingival data set as stated in Properties of CBEA section knowing beforehand that aerobic microbes were more likely to be enriched in supragingival subsite samples and vice versa.</p>
        <fig position="float" id="pcbi.1010091.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010091.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <p>Statistical power (A) and score rankings (B) to assess phenotype relevance. (<bold>A</bold>) Power (<italic toggle="yes">x</italic>-axis) was estimated as the overall fraction of aerobic microbes found to be enriched in supragingival samples at <italic toggle="yes">α</italic> = 0.05. 95% confidence intervals were computed using the Agresti-Couli approach for binomial proportions. (<bold>B</bold>) Score rankings were evaluated by comparing computed scores against true values using AUROC (<italic toggle="yes">x</italic>-axis). DeLong 95% confidence intervals for AUROC were computed.</p>
          </caption>
          <graphic xlink:href="pcbi.1010091.g004" position="float"/>
        </fig>
        <p>We estimated statistical power using this data set as the fraction of supragingival samples where the set representing aerobic microbes was significantly enriched. We observed that adjusted CBEA approaches demonstrated much lower power compared to the Wilcoxon rank-sum test and unadjusted variants. This is surprising given the fact that in statistical significance analyses, the adjusted CBEA approach provides inflated type I error, especially if the normal distribution assumption was chosen. This indicated a mismatch in estimating the null distribution since a high type I error did not result in increased power.</p>
        <p>We also evaluated phenotype relevance by assessing whether enriched sets according to ground truth are preferentially ranked higher using assigned continuous scores (instead of performing a hypothesis test). This aspect was captured through computing AUROC values comparing computed enrichment scores and true labels. Consistent with the previous type I error evaluation, adjusting for correlation did not improve performance, whereas obtained AUROC were around 0.5 and at the same level as the benchmark Wilcoxon rank sum statistic. Unadjusted methods were much better at ranking true enriched sets, however the mean AUROC values were lower than alternate single-sample enrichment methods (GSVA [<xref rid="pcbi.1010091.ref015" ref-type="bibr">15</xref>] and ssGSEA [<xref rid="pcbi.1010091.ref062" ref-type="bibr">62</xref>]) even though this difference is not significant due to overlapping confidence intervals.</p>
        <p>The above results were replicated in simulation studies where we observed that adjusted approaches were very conservative and demonstrated significantly lower power (<xref rid="pcbi.1010091.s003" ref-type="supplementary-material">S3 Fig</xref>), with increasing correlation even at the highest evaluated effect sizes. When assessing score rankings, the performance of CBEA was closer to ssGSEA and GSVA compared to real data evaluations, however all single-sample approaches were much better than using the W statistic from the Wilcoxon Rank Sum test.</p>
      </sec>
      <sec id="sec021">
        <title>Inference at the population level</title>
        <p>We also assessed statistical power for population level inference scenarios using a similar approach. Here, enrichment scores for sets representing all identified genera were computed, and power was estimated as the fraction of sets found to be differentially enriched across sample site labels (supragingival or subgingival). We compared these results against performing a differential abundance test of genus level features generated via sum-based approaches. Results are shown in <xref rid="pcbi.1010091.g005" ref-type="fig">Fig 5</xref>. Some CBEA variants, such as CDF outputs for the mixture normal distributional assumption, did not correctly detect as many significant sets as DESeq2 or corncob despite very close performance values. Using raw CBEA scores was best approach, however, it did not exceed values obtained from DESeq2 and corncob.</p>
        <fig position="float" id="pcbi.1010091.g005">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010091.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Statistical power to assess phenotype relevance of inference tasks at the population level.</title>
            <p>Power (<italic toggle="yes">x</italic>-axis) was estimated as the overall fraction of sets representing genera that are aerobic or anaerobic microbes found to be differentially enriched across sample type (supragingival or subgingival). 95% confidence intervals were computed using the Agresti-Couli approach for binomial proportions.</p>
          </caption>
          <graphic xlink:href="pcbi.1010091.g005" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec022">
      <title>Disease prediction</title>
      <p>Since CBEA can generate informative scores that can discriminate between samples with inflated counts for a set (<xref rid="pcbi.1010091.g004" ref-type="fig">Fig 4</xref>), we wanted to assess whether these scores can also act as useful inputs to predictive models. In this section we assessed the predictive performance of a standard baseline random forest model [<xref rid="pcbi.1010091.ref058" ref-type="bibr">58</xref>] with different single-sample enrichment scoring methods as inputs (CBEA, ssGSEA, and GSVA). Additionally, we also compared the predictive performance of using these scores against a standard approach of using the centered log-ratio transformation (CLR) on taxon sets aggregated via abundance summations.</p>
      <p>We fit our model to two data sets with a similar disease classification task of discriminating patients who were diagnosed with IBD (includes both Crohn’s disease and ulcerative colitis) using only microbiome taxonomic composition. The two data sets represent different microbiome sequencing approaches: the Gevers et al. [<xref rid="pcbi.1010091.ref057" ref-type="bibr">57</xref>] data set uses 16S rRNA gene sequencing, while the Nielsen et al [<xref rid="pcbi.1010091.ref056" ref-type="bibr">56</xref>] data set uses whole genome shotgun sequencing.</p>
      <p><xref rid="pcbi.1010091.g006" ref-type="fig">Fig 6</xref> illustrates the performance of our model with AUROC as the evaluation criteria. In the 16S rRNA data set, the best performing CBEA variant (CDF values computed from an unadjusted mixture normal distribution) outperforms both GSVA and ssGSEA but not the standard CLR approach. Interestingly, in the whole genome sequencing data set, CBEA outperformed CLR, but was similar in performance to GSVA. However, due to large confidence intervals, no method significantly out-performed other evaluated approaches. As such, these results indicate that, for a given pre-determined collection of sets, CBEA generated scores can be informative and provide competitive performance when acting as inputs to disease predictive models. Simulation studies (<xref rid="pcbi.1010091.s005" ref-type="supplementary-material">S5 Fig</xref>) showed similar results, however CBEA more consistently underperformed compared to CLR across all scenarios. Interestingly, the performance gap decreased with increasing sparsity levels and correlation.</p>
      <fig position="float" id="pcbi.1010091.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010091.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Predictive performance of a naive random forest model trained on CBEA, ssGSEA, and GSVA generated scores, as well as the standard CLR approach on predicting patients with inflammatory bowel disease versus controls using genus level taxonomic profiles.</title>
          <p>The data sets used span both 16S rRNA gene sequencing (Gevers et al. [<xref rid="pcbi.1010091.ref057" ref-type="bibr">57</xref>]) and whole-genome shotgun sequencing (Nielsen et al. [<xref rid="pcbi.1010091.ref056" ref-type="bibr">56</xref>]). CBEA performs better than GSVA and ssGSEA but not as well as CLR, with the exception of the whole genome sequencing data set.</p>
        </caption>
        <graphic xlink:href="pcbi.1010091.g006" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec023">
    <title>Discussion</title>
    <sec id="sec024">
      <title>Inference with CBEA</title>
      <p>CBEA is a microbiome-specific approach to generating sample-specific enrichment scores for taxonomic sets defined <italic toggle="yes">a priori</italic>. The formulation of CBEA as a comparison between taxa within the set and its complement corresponds to the competitive null hypothesis in the gene set testing literature [<xref rid="pcbi.1010091.ref027" ref-type="bibr">27</xref>]. Since this null hypothesis is self-contained per sample, it allows users perform enrichment testing at the sample level. Additionally, in combination with a difference in means test, CBEA can also test for enrichment at the population level across case/control status similar to GSVA [<xref rid="pcbi.1010091.ref015" ref-type="bibr">15</xref>].</p>
      <p>For single-sample analyses, we demonstrated that the CBEA approach (unadjusted with mixture normal parametric assumption) was able to control for type I error at the nominal level of 0.05 under the global null (<xref rid="pcbi.1010091.g002" ref-type="fig">Fig 2</xref>), while also demonstrating adequate power (<xref rid="pcbi.1010091.g004" ref-type="fig">Fig 4</xref>). This performance is consistent across different set sizes as well as our prior distributional fit analyses (<xref rid="pcbi.1010091.g001" ref-type="fig">Fig 1</xref>), in which the mixture normal displayed superior fit to the null distribution. Unfortunately, other variants of CBEA demonstrated neither good type I error control nor power. Interestingly, while the adjusted methods showed poor performance in real data evaluations (<xref rid="pcbi.1010091.g002" ref-type="fig">Fig 2</xref>), in simulation studies (<xref rid="pcbi.1010091.s001" ref-type="supplementary-material">S1</xref> and <xref rid="pcbi.1010091.s003" ref-type="supplementary-material">S3</xref> Figs) these approaches were able to control for type I error well with the trade-off of much lower power. For the population-level inference task, CBEA also performed very well. Under the permutation global null, representing genera abundance using CBEA scores in combination with Welch’s t-test controls for type I error at the correct <italic toggle="yes">α</italic> threshold while also keeping respectable power. Since the population level enrichment test is equivalent to a differential abundance test using set-based features, we compared the CBEA approach against using element-wise summations with corncob [<xref rid="pcbi.1010091.ref061" ref-type="bibr">61</xref>] and DESeq2 [<xref rid="pcbi.1010091.ref021" ref-type="bibr">21</xref>] to test for set-level differential abundance. We chose DESeq2 because it is an older approach from the bulk RNA-seq literature that has strong support for usage in microbiome taxonomic data [<xref rid="pcbi.1010091.ref047" ref-type="bibr">47</xref>]. Alternately, corncob is a newer method developed specifically for microbiome taxonomic data sets, which models taxonomic counts directly using a beta-binomial distribution instead of relying on normalization via size factor estimation. We observed that using this approach resulted in an inflated type I error compared to all variants of CBEA (<xref rid="pcbi.1010091.g002" ref-type="fig">Fig 2</xref>), yet did not improve power (<xref rid="pcbi.1010091.g004" ref-type="fig">Fig 4</xref>). Results for CBEA approaches were replicated in simulation analyses, however, for corncob and DESeq2 we observed an opposite effect: in simulation experiments, both methods show good type I error control but low power (<xref rid="pcbi.1010091.s002" ref-type="supplementary-material">S2</xref> and <xref rid="pcbi.1010091.s004" ref-type="supplementary-material">S4</xref> Figs).</p>
      <p>We hypothesized that the discrepancy between simulation and real data evaluations could be due to differences in our assumptions regarding the data generating process that informed our simulation schema. For the non-zero component of each taxon, we sampled from the same negative binomial distribution where designated enriched taxa were generated with inflated means (but the same dispersion). These marginals were simulated to account for block exchangable correlation within the enriched set only. This might have affected our results in two ways. First, our simulation scenario ensures that all designated non-enriched taxa are identical to each other. This is not the case for real data, because our null scenario involves randomly sampled sets that might by chance all have taxa with inflated means compared to remainder taxa. This is represented in <xref rid="pcbi.1010091.s007" ref-type="supplementary-material">S7 Fig</xref>, where the distribution of type I error across 500 replications is right skewed for underperforming CBEA variants, indicating that these approaches are much more sensitive compared to the Wilcoxon rank sum test or unadjusted CBEA with mixture normal distribution. Second, as described in the Introduction section, we did not consider taxon-specific biases that distort the observed relative abundance of taxa compared to true values [<xref rid="pcbi.1010091.ref025" ref-type="bibr">25</xref>]. In the context of sum-based aggregations, the resulting bias of the aggregated taxon-set is dependent on the relative abundances of the contributing taxa (Appendix I in [<xref rid="pcbi.1010091.ref025" ref-type="bibr">25</xref>]). Conceptually, this means that measurement error for a taxon-set is different across samples as the relative abundances of contributing taxa change, leading to issues when attempting to perform inference. As such, we expect methods like corncob or DESeq2, when performed on such sum aggregates in the presence of taxon-specific biases, to have inflated type I error compared to our multiplication based approach. This also explains why conversely in simulation studies, where taxon-specific biases are absent, corncob and DESeq2 performed better.</p>
    </sec>
    <sec id="sec025">
      <title>Downstream analysis using predictive models</title>
      <p>The sample-level enrichment scores generated by the CBEA method can be used in downstream analyses such as disease prediction. We evaluated whether CBEA can be used to generate set-based features for disease prediction models.</p>
      <p>We fit a basic random forest model [<xref rid="pcbi.1010091.ref058" ref-type="bibr">58</xref>] to predict continuous and binary outcomes using CBEA generated scores as inputs. Similar to our inference analysis, we compared CBEA against both ssGSEA and GSVA. Additionally, we evaluated CBEA against a standard approach where counts of a set were aggregated using sums and applied the centered log-ratio transformation (CLR). This is because CLR is considered standard practice in using microbiome variables as predictors for a model [<xref rid="pcbi.1010091.ref009" ref-type="bibr">9</xref>]. Results showed that CBEA generates scores perform well across both real data and simulation scenarios. Since predictive models consider the effect of variables jointly (and in the case of random forest, consider interactions as well), good performance indicates that CBEA scores can capture joint distribution of sets, enabling both uniset and multi-set type analyses. Comparatively, CBEA generated scores outperformed other enrichment score methods (GSVA and ssGSEA), suggesting that CBEA is more tailored for microbiome taxonomic data sets. This is consistent with our sample ranking analysis (<xref rid="pcbi.1010091.g004" ref-type="fig">Fig 4</xref>), showing that CBEA scores are on average more informative when used to rank samples based on their propensity to have inflated counts. However, CBEA did not outperform the CLR approach across our simulation studies, and only marginally performed better in the real data analysis with WGS data. Fortunately, in simulation studies, this performance gap between CLR and CBEA decreases with higher sparsity and correlation, especially in low effect saturation scenarios.</p>
    </sec>
    <sec id="sec026">
      <title>Limitations and future directions</title>
      <p>These above results demonstrate the applicability of CBEA under different data analysis scenarios. If researchers are interested in performing inference, they can decide between an unsupervised sample level approach (i.e. screen samples for enrichment of certain characteristics) or a supervised population level approach (i.e. identifying characteristics that are differentially abundant across case/control status). For the unsupervised approach, utilizing the unadjusted CBEA with the mixture normal distribution provides a good initial starting point. In the case where researchers only want to screen samples with mean-inflated taxon sets (instead of additionally detecting taxon sets with increased correlation), they can apply the adjusted approach, which can be effective at conserving type I error even for high correlation scenarios. However, the trade-off for this adjustment is power, which decreases with increasing correlation. For the supervised analysis, all CBEA variants control for type I error and provide adequate statistical power. However, using raw CBEA scores with a difference-in-means test such as Welch’s t-test is preferable since is the least computationally expensive (no estimation process) while still outperforming the use of a sum-based approach with a standard differential abundance test.</p>
      <p>Beyond inference, CBEA scores are flexible and can be useful for downstream analysis. We demonstrated that for a given number of set-based features, CBEA can produce informative scores that contribute to competitive performance of prediction models even in low signal-to-noise ratios with high inter-taxa correlation and sparsity. This is especially true for whole genome sequencing data sets, where CBEA outperfrorms the standard approach of applying a CLR transformation. Researchers might find CBEA useful under situations of high sparsity and inter-taxa correlation, or if the property of a singular covariance matrix (a byproduct of the CLR transformation [<xref rid="pcbi.1010091.ref009" ref-type="bibr">9</xref>]) is undesired. Even though we only evaluated prediction models, researchers can benchmark their own usage of CBEA for other downstream tasks such as sample ordination.</p>
      <p>However, there are various limitations to our evaluation of CBEA. First, our simulation analysis may not capture the appropriate data-generating distributions underlying microbiome taxonomic data. There is strong evidence to suggest that our zero-inflated negative binomial distribution is representative [<xref rid="pcbi.1010091.ref063" ref-type="bibr">63</xref>], however other distributions such as the Dirichlet multinomial distribution [<xref rid="pcbi.1010091.ref064" ref-type="bibr">64</xref>] have been used in the evaluation of prior studies. More recent studies have suggested utilizing the hierarchical multinomial logistic normal distribution to model microbiome data sets [<xref rid="pcbi.1010091.ref065" ref-type="bibr">65</xref>, <xref rid="pcbi.1010091.ref066" ref-type="bibr">66</xref>]. As such, there is space to evaluate and adapt CBEA to these different distributional assumptions that underlie the data generating process. Second, we were not able to evaluate the phenotype relevance of enrichment results as in Geistlinger et al. [<xref rid="pcbi.1010091.ref041" ref-type="bibr">41</xref>] due to limited consistent annotations for microbiome signatures in health and disease, especially those that are experimentally verified (and not just from differential abundance studies). We attempted to perform this evaluation by leveraging the gingival data set similar to [<xref rid="pcbi.1010091.ref063" ref-type="bibr">63</xref>]. However, we acknowledge that this is not a perfect solution, since the oxygen usage label of each microbe in the data set is only available at the genus level, and the difference in counts for obligate aerobes and anaerobes across the supragingival and subgingival sites might not be as clear-cut. As such, results from power analyses using this data set are only relative between the comparison methods and cannot be treated as absolute measures of power or phenotype relevance. Third, fitting the mixture normal distribution to raw CBEA scores using the expectation-maximization algorithm is difficult, as the convergence rate is slow when there is high overlap between the mixtures, resulting in a small mixing coefficient for one of the components and increased runtime (<xref rid="pcbi.1010091.s006" ref-type="supplementary-material">S6 Fig</xref>) [<xref rid="pcbi.1010091.ref067" ref-type="bibr">67</xref>]. In our implementation, we attempted to account for this by increasing the maximum number of iterations and relaxing the tolerance threshold. Finally, we assumed that taxa within a set are all equally associated with the outcome. This limits our ability to evaluate the performance of CBEA when only a small number of taxa within the set are associated with the outcome, or if there is variability in effect sizes or association direction of taxa within a set.</p>
      <p>Our evaluation also showed various drawbacks of the CBEA method itself. First, inference with CBEA at the sample level is limited, and can be affected by inter-taxa correlation if users wish to detect mean-inflated sets only. Second, for downstream analyses, CBEA might not always perform better than competing methods, especially when being used to generate inputs to predictive models. We hypothesized that this might be due to the lack of fit for the underlying null distribution in high correlation settings, especially the identifiability problem associated with the estimation procedure while adjusting the mixture normal distribution. As such, we hope to refine the null distribution estimating procedure by either choosing a better distributional form, or to further constrain the optimization procedure of the mixture normal distribution by fixing the third and fourth moments.</p>
      <p>In addition, CBEA itself did not consider other aspects of microbiome data. First, across all analyses, we relied on adding a pseudocount to ensure log operations are valid. Users can directly address this by incorporating model-based zero correction methods prior to modelling such as in [<xref rid="pcbi.1010091.ref068" ref-type="bibr">68</xref>] or [<xref rid="pcbi.1010091.ref069" ref-type="bibr">69</xref>]. However, in our simulation studies, sparsity seems to not have a significant impact on the overall performance of our approach. Second, CBEA also treated all taxa within the set as equally contributing to the set. Incorporation of taxa-specific weights (similar to PhILR [<xref rid="pcbi.1010091.ref035" ref-type="bibr">35</xref>]) could reduce the influence of outliers, such as rare or highly invariant taxa. Finally, even though for a given set of <italic toggle="yes">a priori</italic> annotations CBEA can generate useful summary scores, such values are limited in their utility if the annotations themselves are not meaningful. As such, curating and validating sets (similar to MSigDB [<xref rid="pcbi.1010091.ref012" ref-type="bibr">12</xref>]) based on physiological or genomic characteristics of microbes [<xref rid="pcbi.1010091.ref070" ref-type="bibr">70</xref>] or their association with human disease (in beta BugSigDB <ext-link xlink:href="https://bugsigdb.org/Main_Page" ext-link-type="uri">https://bugsigdb.org/Main_Page</ext-link>) can allow for incorporating functional insights into microbiome-outcome analyses.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec027">
    <title>Conclusion</title>
    <p>Gene set testing, or pathway analysis, is an important tool in the analysis of high-dimensional genomics data sets; however, limited work has been done developing set based methods specifically for microbiome relative abundance data. We introduced a new microbiome-specific method to generate set-based enrichment scores at the sample level. We demonstrated that our method can control for type I error for significance testing at the sample level, while generated scores are also valid inputs in downstream analyses, including disease prediction and differential abundance.</p>
  </sec>
  <sec id="sec028" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010091.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Simulation results for type I error evaluation for CBEA sample-level inference.</title>
        <p>Type I error rate (<italic toggle="yes">y</italic> axis) was estimated for each approach across data sparsity levels (<italic toggle="yes">x</italic> axis) across different set sizes (horizontal) and inter-taxa correlation within the set (vertical). We compared variatns of CBEA against a Wilcoxon rank sum test at <italic toggle="yes">α</italic> of 0.05. For each scenario, a data set of 10,000 samples (equivalent to 10,000 hypotheses) was utilized. Confidence bounds were obtained using Agresti-Couli approach.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s001.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010091.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Simulation results for type I error evaluation for CBEA population-level inference.</title>
        <p>Type I error (<italic toggle="yes">y</italic>-axis) was estimated as the average proportion of sets with significant enrichment at 0.05 across 10 replications per simulation condition under the global null. Error bars were estimated using standard errors computed across 10 replicated data sets. Performance was evaluated across different sparsity (<italic toggle="yes">x</italic>-axis) and inter-taxa correlation levels. For CBEA methods, enrichment analysis was performed using a Welch’s t-test across case/control status with single-sample scores representing set-based features generated by CBEA (across different output types and distributional assumptions). For corncob and DESeq2, set-based features were constructed using element-wise summations.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s002.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010091.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Simulation results for phenotype relevance evaluation for CBEA sample-level inference.</title>
        <p><bold>(A)</bold> demonstrate statistical power (<italic toggle="yes">y</italic>-axis) across different data sparsity levels (<italic toggle="yes">x</italic>-axis) and power <bold>(B)</bold> for differential abundance test across different parametric simulation scenarios. For CBEA methods, differential abundance analysis was performed using a difference in means test (either Wilcoxon rank-sum test or Welch’s t-test) across case/control status using single-sample scores generated by CBEA (across different output types and distributional assumptions). CBEA associated methods demonstrated similar type I error to conventional differential abundance analysis methods but with more power to detect differences even at small effect sizes.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s003.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010091.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Simulation results for phenotype relevance evaluation for CBEA population-level inference.</title>
        <p>Power (<italic toggle="yes">y</italic>-axis) was estimated as the average proportion of sets correctly identified as significantly enriched (at 0.05) across 10 replications per simulation condition under the global null. Error bars were estimated using standard errors computed across 10 replicated data sets. Performance was evaluated across different sparsity (<italic toggle="yes">x</italic>-axis) and inter-taxa correlation levels. For CBEA methods, enrichment analysis was performed using a Welch’s t-test across case/control status with single-sample scores representing set-based features generated by CBEA (across different output types and distributional assumptions). For corncob and DESeq2, set-based features were constructed using element-wise summations.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s004.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010091.s005" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>Simulation results for predictive pefromance evaluation for CBEA.</title>
        <p>Predictive performance of a random forest model (with no hyperparameter tuning) trained on set-based features as inputs. Methods to generate these features include CBEA, ssGSEA, GSVA, and the CLR transformation applied on sum-aggregated sets. Simulation data was generated across different levels of data sparsity, inter-taxa correlation, effect saturation, and signal-to-noise ratio. Panel <bold>(A)</bold> presents performance on a regression task using RMSE (root mean squared error) as the evaluation measure. Panel <bold>(B)</bold> presents performance on a classification task with AUROC as the evaluation measure.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s005.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010091.s006" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>Runtime performance.</title>
        <p>Overall runtime of CBEA under different parameters for a data set of 500 samples, 800 taxa (40 sets of size 20 each). This data set was generated via simulations.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s006.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010091.s007" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>Distribution of type I error values across all replications in real data random set evaluations for CBEA inference at the sample-level.</title>
        <p>Density (<italic toggle="yes">y</italic>-axis) for type I error values (<italic toggle="yes">x</italic>-axis) of each evaluated approach for sample-level inference using real data across 500 replications. Here, type I error was estimated as the proportion of samples where a randomly sampled set of different sizes where identified to be statistically significant at <italic toggle="yes">p</italic>-value threshold of 0.05.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s007.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010091.s008" position="float" content-type="local-data">
      <label>S1 File</label>
      <caption>
        <title>Supplemental derivations.</title>
        <p>Includes additional details on addressing variance inflation due to correlation in CBEA, simulation analyses, and run-time performance.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010091.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Becky Lebeaux, Modupe Coker, Erika Dade, Jie Zhou, and Weston Viles for insightful comments and suggestions that greatly improved the paper.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010091.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Proctor</surname><given-names>LM</given-names></name>, <name><surname>Creasy</surname><given-names>HH</given-names></name>, <name><surname>Fettweis</surname><given-names>JM</given-names></name>, <name><surname>Lloyd-Price</surname><given-names>J</given-names></name>, <name><surname>Mahurkar</surname><given-names>A</given-names></name>, <name><surname>Zhou</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>The Integrative Human Microbiome Project</article-title>. <source>Nature</source>. <year>2019</year>;<volume>569</volume>(<issue>7758</issue>):<fpage>641</fpage>–<lpage>648</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-1238-8</pub-id><pub-id pub-id-type="pmid">31142853</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Sharma</surname><given-names>S</given-names></name>, <name><surname>Tripathi</surname><given-names>P</given-names></name>. <article-title>Gut Microbiome and Type 2 Diabetes: Where We Are and Where to Go?</article-title><source>The Journal of Nutritional Biochemistry</source>. <year>2019</year>;<volume>63</volume>:<fpage>101</fpage>–<lpage>108</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jnutbio.2018.10.003</pub-id><?supplied-pmid 30366260?><pub-id pub-id-type="pmid">30366260</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Aoun</surname><given-names>A</given-names></name>, <name><surname>Darwish</surname><given-names>F</given-names></name>, <name><surname>Hamod</surname><given-names>N</given-names></name>. <article-title>The Influence of the Gut Microbiome on Obesity in Adults and the Role of Probiotics, Prebiotics, and Synbiotics for Weight Loss</article-title>. <source>Preventive Nutrition and Food Science</source>. <year>2020</year>;<volume>25</volume>(<issue>2</issue>):<fpage>113</fpage>–<lpage>123</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3746/pnf.2020.25.2.113</pub-id><?supplied-pmid 32676461?><pub-id pub-id-type="pmid">32676461</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Cho</surname><given-names>I</given-names></name>, <name><surname>Blaser</surname><given-names>MJ</given-names></name>. <article-title>The Human Microbiome: At the Interface of Health and Disease</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>13</volume>(<issue>4</issue>):<fpage>260</fpage>–<lpage>270</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg3182</pub-id><?supplied-pmid 22411464?><pub-id pub-id-type="pmid">22411464</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Callahan</surname><given-names>BJ</given-names></name>, <name><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name><surname>Rosen</surname><given-names>MJ</given-names></name>, <name><surname>Han</surname><given-names>AW</given-names></name>, <name><surname>Johnson</surname><given-names>AJA</given-names></name>, <name><surname>Holmes</surname><given-names>SP</given-names></name>. <article-title>DADA2: High-resolution Sample Inference from Illumina Amplicon Data</article-title>. <source>Nature Methods</source>. <year>2016</year>;<volume>13</volume>(<issue>7</issue>):<fpage>581</fpage>–<lpage>583</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id><?supplied-pmid 27214047?><pub-id pub-id-type="pmid">27214047</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Truong</surname><given-names>DT</given-names></name>, <name><surname>Franzosa</surname><given-names>EA</given-names></name>, <name><surname>Tickle</surname><given-names>TL</given-names></name>, <name><surname>Scholz</surname><given-names>M</given-names></name>, <name><surname>Weingart</surname><given-names>G</given-names></name>, <name><surname>Pasolli</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>MetaPhlAn2 for Enhanced Metagenomic Taxonomic Profiling</article-title>. <source>Nature Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>10</issue>):<fpage>902</fpage>–<lpage>903</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.3589</pub-id><?supplied-pmid 26418763?><pub-id pub-id-type="pmid">26418763</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref007">
      <label>7</label>
      <mixed-citation publication-type="book"><name><surname>Li</surname><given-names>H</given-names></name>. <part-title>Statistical and Computational Methods in Microbiome and Metagenomics</part-title>. In: <source>Handbook of Statistical Genomics</source>. <publisher-name>John Wiley &amp; Sons, Ltd</publisher-name>; <year>2019</year>. p. <fpage>977</fpage>–<lpage>550</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>. <article-title>Microbiome, Metagenomics, and High-Dimensional Compositional Data Analysis</article-title>. <source>Annual Review of Statistics and Its Application</source>. <year>2015</year>;<volume>2</volume>(<issue>1</issue>):<fpage>73</fpage>–<lpage>94</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev-statistics-010814-020351</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Gloor</surname><given-names>GB</given-names></name>, <name><surname>Macklaim</surname><given-names>JM</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name>, <name><surname>Egozcue</surname><given-names>JJ</given-names></name>. <article-title>Microbiome Datasets Are Compositional: And This Is Not Optional</article-title>. <source>Frontiers in Microbiology</source>. <year>2017</year>;<volume>8</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id><?supplied-pmid 29187837?><pub-id pub-id-type="pmid">29187837</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Khatri</surname><given-names>P</given-names></name>, <name><surname>Sirota</surname><given-names>M</given-names></name>, <name><surname>Butte</surname><given-names>AJ</given-names></name>. <article-title>Ten Years of Pathway Analysis: Current Approaches and Outstanding Challenges</article-title>. <source>PLOS Computational Biology</source>. <year>2012</year>;<volume>8</volume>(<issue>2</issue>):<fpage>e1002375</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id><?supplied-pmid 22383865?><pub-id pub-id-type="pmid">22383865</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Goeman</surname><given-names>JJ</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>. <article-title>Analyzing Gene Expression Data in Terms of Gene Sets: Methodological Issues</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>8</issue>):<fpage>980</fpage>–<lpage>987</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btm051</pub-id><?supplied-pmid 17303618?><pub-id pub-id-type="pmid">17303618</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>A</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Mootha</surname><given-names>VK</given-names></name>, <name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>Ebert</surname><given-names>BL</given-names></name>, <name><surname>Gillette</surname><given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Gene Set Enrichment Analysis: A Knowledge-Based Approach for Interpreting Genome-Wide Expression Profiles</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>15550</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><?supplied-pmid 16199517?><pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Ashburner</surname><given-names>M</given-names></name>, <name><surname>Ball</surname><given-names>CA</given-names></name>, <name><surname>Blake</surname><given-names>JA</given-names></name>, <name><surname>Botstein</surname><given-names>D</given-names></name>, <name><surname>Butler</surname><given-names>H</given-names></name>, <name><surname>Cherry</surname><given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Gene Ontology: Tool for the Unification of Biology</article-title>. <source>Nature genetics</source>. <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>29</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/75556</pub-id><?supplied-pmid 10802651?><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Irizarry</surname><given-names>RA</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Speed</surname><given-names>TP</given-names></name>. <article-title>Gene Set Enrichment Analysis Made Simple</article-title>. <source>Statistical methods in medical research</source>. <year>2009</year>;<volume>18</volume>(<issue>6</issue>):<fpage>565</fpage>–<lpage>575</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1177/0962280209351908</pub-id><?supplied-pmid 20048385?><pub-id pub-id-type="pmid">20048385</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Hänzelmann</surname><given-names>S</given-names></name>, <name><surname>Castelo</surname><given-names>R</given-names></name>, <name><surname>Guinney</surname><given-names>J</given-names></name>. <article-title>GSVA: Gene Set Variation Analysis for Microarray and RNA-Seq Data</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>7</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id><?supplied-pmid 23323831?><pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Frost</surname><given-names>HR</given-names></name>. <article-title>Variance-Adjusted Mahalanobis (VAM): A Fast and Accurate Method for Cell-Specific Gene Set Scoring</article-title>. <source>Nucleic Acids Research</source>. <year>2020</year>;<volume>48</volume>(<issue>16</issue>):<fpage>e94</fpage>–<lpage>e94</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa582</pub-id><?supplied-pmid 32633778?><pub-id pub-id-type="pmid">32633778</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Chong</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>P</given-names></name>, <name><surname>Zhou</surname><given-names>G</given-names></name>, <name><surname>Xia</surname><given-names>J</given-names></name>. <article-title>Using MicrobiomeAnalyst for Comprehensive Statistical, Functional, and Meta-Analysis of Microbiome Data</article-title>. <source>Nature Protocols</source>. <year>2020</year>;<volume>15</volume>(<issue>3</issue>):<fpage>799</fpage>–<lpage>821</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41596-019-0264-1</pub-id><?supplied-pmid 31942082?><pub-id pub-id-type="pmid">31942082</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Quinn</surname><given-names>TP</given-names></name>, <name><surname>Erb</surname><given-names>I</given-names></name>, <name><surname>Gloor</surname><given-names>G</given-names></name>, <name><surname>Notredame</surname><given-names>C</given-names></name>, <name><surname>Richardson</surname><given-names>MF</given-names></name>, <name><surname>Crowley</surname><given-names>TM</given-names></name>. <article-title>A Field Guide for the Compositional Analysis of Any-Omics Data</article-title>. <source>GigaScience</source>. <year>2019</year>;<volume>8</volume>(<issue>giz107</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gigascience/giz107</pub-id><?supplied-pmid 31544212?><pub-id pub-id-type="pmid">31544212</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Quinn</surname><given-names>TP</given-names></name>, <name><surname>Erb</surname><given-names>I</given-names></name>, <name><surname>Richardson</surname><given-names>MF</given-names></name>, <name><surname>Crowley</surname><given-names>TM</given-names></name>. <article-title>Understanding Sequencing Data as Compositions: An Outlook and Review</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>16</issue>):<fpage>2870</fpage>–<lpage>2878</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty175</pub-id><?supplied-pmid 29608657?><pub-id pub-id-type="pmid">29608657</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>JT</given-names></name>, <name><surname>Marotz</surname><given-names>C</given-names></name>, <name><surname>Washburne</surname><given-names>A</given-names></name>, <name><surname>Silverman</surname><given-names>J</given-names></name>, <name><surname>Zaramela</surname><given-names>LS</given-names></name>, <name><surname>Edlund</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Establishing Microbial Composition Measurement Standards with Reference Frames</article-title>. <source>Nature Communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-10656-5</pub-id><?supplied-pmid 31222023?><pub-id pub-id-type="pmid">31222023</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Love</surname><given-names>MI</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>, <name><surname>Anders</surname><given-names>S</given-names></name>. <article-title>Moderated Estimation of Fold Change and Dispersion for RNA-seq Data with DESeq2</article-title>. <source>Genome Biology</source>. <year>2014</year>;<volume>15</volume>(<issue>12</issue>):<fpage>550</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id><?supplied-pmid 25516281?><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>S</given-names></name>, <name><surname>Xu</surname><given-names>ZZ</given-names></name>, <name><surname>Peddada</surname><given-names>S</given-names></name>, <name><surname>Amir</surname><given-names>A</given-names></name>, <name><surname>Bittinger</surname><given-names>K</given-names></name>, <name><surname>Gonzalez</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Normalization and Microbial Differential Abundance Strategies Depend upon Data Characteristics</article-title>. <source>Microbiome</source>. <year>2017</year>;<volume>5</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-017-0237-y</pub-id><?supplied-pmid 28253908?><pub-id pub-id-type="pmid">28253908</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>McKnight</surname><given-names>DT</given-names></name>, <name><surname>Huerlimann</surname><given-names>R</given-names></name>, <name><surname>Bower</surname><given-names>DS</given-names></name>, <name><surname>Schwarzkopf</surname><given-names>L</given-names></name>, <name><surname>Alford</surname><given-names>RA</given-names></name>, <name><surname>Zenger</surname><given-names>KR</given-names></name>. <article-title>Methods for Normalizing Microbiome Data: An Ecological Perspective</article-title>. <source>Methods in Ecology and Evolution</source>. <year>2019</year>;<volume>10</volume>(<issue>3</issue>):<fpage>389</fpage>–<lpage>400</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/2041-210X.13115</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Aitchison</surname><given-names>J</given-names></name>. <article-title>Principles of Compositional Data Analysis</article-title>. <source>Lecture Notes-Monograph Series</source>. <year>1994</year>; p. <fpage>73</fpage>–<lpage>81</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1214/lnms/1215463786</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>McLaren</surname><given-names>MR</given-names></name>, <name><surname>Willis</surname><given-names>AD</given-names></name>, <name><surname>Callahan</surname><given-names>BJ</given-names></name>. <article-title>Consistent and Correctable Bias in Metagenomic Sequencing Experiments</article-title>. <source>eLife</source>. <year>2019</year>;<volume>8</volume>:<fpage>e46923</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.46923</pub-id><?supplied-pmid 31502536?><pub-id pub-id-type="pmid">31502536</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Egozcue</surname><given-names>JJ</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name>. <article-title>Groups of Parts and Their Balances in Compositional Data Analysis</article-title>. <source>Mathematical Geology</source>. <year>2005</year>;<volume>37</volume>(<issue>7</issue>):<fpage>795</fpage>–<lpage>828</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11004-005-7381-9</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Tian</surname><given-names>L</given-names></name>, <name><surname>Greenberg</surname><given-names>SA</given-names></name>, <name><surname>Kong</surname><given-names>SW</given-names></name>, <name><surname>Altschuler</surname><given-names>J</given-names></name>, <name><surname>Kohane</surname><given-names>IS</given-names></name>, <name><surname>Park</surname><given-names>PJ</given-names></name>. <article-title>Discovering Statistically Significant Pathways in Expression Profiling Studies</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>38</issue>):<fpage>13544</fpage>–<lpage>13549</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0506577102</pub-id><?supplied-pmid 16174746?><pub-id pub-id-type="pmid">16174746</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Rivera-Pinto</surname><given-names>J</given-names></name>, <name><surname>Egozcue</surname><given-names>JJ</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name>, <name><surname>Paredes</surname><given-names>R</given-names></name>, <name><surname>Noguera-Julian</surname><given-names>M</given-names></name>, <name><surname>Calle</surname><given-names>ML</given-names></name>. <article-title>Balances: A New Perspective for Microbiome Analysis</article-title>. <source>mSystems</source>. <year>2018</year>;<volume>3</volume>(<issue>4</issue>):<fpage>e00053</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.00053-18</pub-id><?supplied-pmid 30035234?><pub-id pub-id-type="pmid">30035234</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>D</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>Camera: A Competitive Gene Set Test Accounting for Inter-Gene Correlation</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>17</issue>):<fpage>e133</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gks461</pub-id><?supplied-pmid 22638577?><pub-id pub-id-type="pmid">22638577</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Egozcue</surname><given-names>JJ</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name>, <name><surname>Mateu-Figueras</surname><given-names>G</given-names></name>, <name><surname>Barceló-Vidal</surname><given-names>C</given-names></name>. <article-title>Isometric Logratio Transformations for Compositional Data Analysis</article-title>. <source>Mathematical Geology</source>. <year>2003</year>;<volume>35</volume>(<issue>3</issue>):<fpage>279</fpage>–<lpage>300</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1023/A:1023818214614</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Quast</surname><given-names>C</given-names></name>, <name><surname>Pruesse</surname><given-names>E</given-names></name>, <name><surname>Yilmaz</surname><given-names>P</given-names></name>, <name><surname>Gerken</surname><given-names>J</given-names></name>, <name><surname>Schweer</surname><given-names>T</given-names></name>, <name><surname>Yarza</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The SILVA Ribosomal RNA Gene Database Project: Improved Data Processing and Web-Based Tools</article-title>. <source>Nucleic Acids Research</source>. <year>2013</year>;<volume>41</volume>(<issue>D1</issue>):<fpage>D590</fpage>–<lpage>D596</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id><?supplied-pmid 23193283?><pub-id pub-id-type="pmid">23193283</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Delignette-Muller</surname><given-names>ML</given-names></name>, <name><surname>Dutang</surname><given-names>C</given-names></name>. <article-title>Fitdistrplus: An R Package for Fitting Distributions</article-title>. <source>Journal of Statistical Software</source>. <year>2015</year>;<volume>64</volume>(<issue>4</issue>):<fpage>1</fpage>–<lpage>34</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.18637/jss.v064.i04</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Benaglia</surname><given-names>T</given-names></name>, <name><surname>Chauveau</surname><given-names>D</given-names></name>, <name><surname>Hunter</surname><given-names>DR</given-names></name>, <name><surname>Young</surname><given-names>D</given-names></name>. <article-title>Mixtools: An R Package for Analyzing Finite Mixture Models</article-title>. <source>Journal of Statistical Software</source>. <year>2009</year>;<volume>32</volume>(<issue>6</issue>):<fpage>1</fpage>–<lpage>29</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.18637/jss.v032.i06</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Washburne</surname><given-names>AD</given-names></name>, <name><surname>Silverman</surname><given-names>JD</given-names></name>, <name><surname>Leff</surname><given-names>JW</given-names></name>, <name><surname>Bennett</surname><given-names>DJ</given-names></name>, <name><surname>Darcy</surname><given-names>JL</given-names></name>. <article-title>Phylogenetic Factorization of Compositional Data Yields Lineage-Level Associations in Microbiome Datasets</article-title>. <source>PeerJ</source>. <year>2017</year>; p. <fpage>26</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7717/peerj.2969</pub-id><?supplied-pmid 28289558?><pub-id pub-id-type="pmid">28289558</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Silverman</surname><given-names>JD</given-names></name>, <name><surname>Washburne</surname><given-names>AD</given-names></name>, <name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>David</surname><given-names>LA</given-names></name>. <article-title>A Phylogenetic Transform Enhances Analysis of Compositional Microbiota Data</article-title>. <source>eLife</source>. <year>2017</year>;<volume>6</volume>:<fpage>e21887</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.21887</pub-id><?supplied-pmid 28198697?><pub-id pub-id-type="pmid">28198697</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>JT</given-names></name>, <name><surname>Sanders</surname><given-names>J</given-names></name>, <name><surname>Quinn</surname><given-names>RA</given-names></name>, <name><surname>McDonald</surname><given-names>D</given-names></name>, <name><surname>Gonzalez</surname><given-names>A</given-names></name>, <name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Balance Trees Reveal Microbial Niche Differentiation</article-title>. <source>mSystems</source>. <year>2017</year>;<volume>2</volume>(<issue>1</issue>):<fpage>e00162</fpage>–<lpage>16</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mSystems.00162-16</pub-id><?supplied-pmid 28144630?><pub-id pub-id-type="pmid">28144630</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Aitchison</surname><given-names>J</given-names></name>, <name><surname>Shen</surname><given-names>SM</given-names></name>. <article-title>Logistic-Normal Distributions:Some Properties and Uses</article-title>. <source>Biometrika</source>. <year>1980</year>;<volume>67</volume>(<issue>2</issue>):<fpage>261</fpage>–<lpage>272</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/2335470</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Efron</surname><given-names>B</given-names></name>. <article-title>Large-Scale Simultaneous Hypothesis Testing</article-title>. <source>Journal of the American Statistical Association</source>. <year>2004</year>;<volume>99</volume>(<issue>465</issue>):<fpage>96</fpage>–<lpage>104</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1198/016214504000000089</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Kurtz</surname><given-names>ZD</given-names></name>, <name><surname>Müller</surname><given-names>CL</given-names></name>, <name><surname>Miraldi</surname><given-names>ER</given-names></name>, <name><surname>Littman</surname><given-names>DR</given-names></name>, <name><surname>Blaser</surname><given-names>MJ</given-names></name>, <name><surname>Bonneau</surname><given-names>RA</given-names></name>. <article-title>Sparse and Compositionally Robust Inference of Microbial Ecological Networks</article-title>. <source>PLOS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e1004226</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id><?supplied-pmid 25950956?><pub-id pub-id-type="pmid">25950956</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Ackermann</surname><given-names>M</given-names></name>, <name><surname>Strimmer</surname><given-names>K</given-names></name>. <article-title>A General Modular Framework for Gene Set Enrichment Analysis</article-title>. <source>BMC bioinformatics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-10-47</pub-id><?supplied-pmid 19192285?><pub-id pub-id-type="pmid">19118496</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Geistlinger</surname><given-names>L</given-names></name>, <name><surname>Csaba</surname><given-names>G</given-names></name>, <name><surname>Santarelli</surname><given-names>M</given-names></name>, <name><surname>Ramos</surname><given-names>M</given-names></name>, <name><surname>Schiffer</surname><given-names>L</given-names></name>, <name><surname>Turaga</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Toward a Gold Standard for Benchmarking Gene Set Enrichment Analysis</article-title>. <source>Briefings in bioinformatics</source>. <year>2021</year>;<volume>22</volume>(<issue>1</issue>):<fpage>545</fpage>–<lpage>556</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbz158</pub-id><?supplied-pmid 32026945?><pub-id pub-id-type="pmid">32026945</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Pasolli</surname><given-names>E</given-names></name>, <name><surname>Schiffer</surname><given-names>L</given-names></name>, <name><surname>Manghi</surname><given-names>P</given-names></name>, <name><surname>Renson</surname><given-names>A</given-names></name>, <name><surname>Obenchain</surname><given-names>V</given-names></name>, <name><surname>Truong</surname><given-names>DT</given-names></name>, <etal>et al</etal>. <article-title>Accessible, Curated Metagenomic Data through ExperimentHub</article-title>. <source>Nature Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>11</issue>):<fpage>1023</fpage>–<lpage>1024</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.4468</pub-id><?supplied-pmid 29088129?><pub-id pub-id-type="pmid">29088129</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Schiffer</surname><given-names>L</given-names></name>, <name><surname>Azhar</surname><given-names>R</given-names></name>, <name><surname>Shepherd</surname><given-names>L</given-names></name>, <name><surname>Ramos</surname><given-names>M</given-names></name>, <name><surname>Geistlinger</surname><given-names>L</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>HMP16SData: Efficient Access to the Human Microbiome Project through Bioconductor</article-title>. <source>American Journal of Epidemiology</source>. <year>2019</year>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/aje/kwz006</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Gonzalez</surname><given-names>A</given-names></name>, <name><surname>Navas-Molina</surname><given-names>JA</given-names></name>, <name><surname>Kosciolek</surname><given-names>T</given-names></name>, <name><surname>McDonald</surname><given-names>D</given-names></name>, <name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name>, <name><surname>Ackermann</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Qiita: Rapid, Web-Enabled Microbiome Meta-Analysis</article-title>. <source>Nature Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>10</issue>):<fpage>796</fpage>–<lpage>798</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-018-0141-9</pub-id><?supplied-pmid 30275573?><pub-id pub-id-type="pmid">30275573</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Wickham</surname><given-names>H</given-names></name>, <name><surname>Averick</surname><given-names>M</given-names></name>, <name><surname>Bryan</surname><given-names>J</given-names></name>, <name><surname>Chang</surname><given-names>W</given-names></name>, <name><surname>McGowan</surname><given-names>LD</given-names></name>, <name><surname>François</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Welcome to the Tidyverse</article-title>. <source>Journal of Open Source Software</source>. <year>2019</year>;<volume>4</volume>(<issue>43</issue>):<fpage>1686</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.21105/joss.01686</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Robin</surname><given-names>X</given-names></name>, <name><surname>Turck</surname><given-names>N</given-names></name>, <name><surname>Hainard</surname><given-names>A</given-names></name>, <name><surname>Tiberti</surname><given-names>N</given-names></name>, <name><surname>Lisacek</surname><given-names>F</given-names></name>, <name><surname>Sanchez</surname><given-names>JC</given-names></name>, <etal>et al</etal>. <article-title>pROC: An Open-Source Package for R and S+ to Analyze and Compare ROC Curves</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;12:<fpage>77</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-12-77</pub-id><?supplied-pmid 21414208?><pub-id pub-id-type="pmid">21414208</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name><surname>Holmes</surname><given-names>S</given-names></name>. <article-title>Waste Not, Want Not: Why Rarefying Microbiome Data Is Inadmissible</article-title>. <source>PLOS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003531</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id><?supplied-pmid 24699258?><pub-id pub-id-type="pmid">24699258</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref048">
      <label>48</label>
      <mixed-citation publication-type="other">Ernst FGM, Shetty SA, Borman T, Lahti L. Mia: Microbiome Analysis; 2021.</mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Landau</surname><given-names>WM</given-names></name>. <article-title>The Targets R Package: A Dynamic Make-like Function-Oriented Pipeline Toolkit for Reproducibility and High-Performance Computing</article-title>. <source>Journal of Open Source Software</source>. <year>2021</year>;<volume>6</volume>(<issue>57</issue>):<fpage>2959</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.21105/joss.02959</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>THMP</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>, <name><surname>Gevers</surname><given-names>D</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <name><surname>Abubucker</surname><given-names>S</given-names></name>, <name><surname>Badger</surname><given-names>JH</given-names></name>, <etal>et al</etal>. <article-title>Structure, Function and Diversity of the Healthy Human Microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature11234</pub-id><pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Agresti</surname><given-names>A</given-names></name>, <name><surname>Coull</surname><given-names>BA</given-names></name>. <article-title>Approximate Is Better than “Exact” for Interval Estimation of Binomial Proportions</article-title>. <source>The American Statistician</source>. <year>1998</year>;<volume>52</volume>(<issue>2</issue>):<fpage>119</fpage>–<lpage>126</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/2685469</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Thurnheer</surname><given-names>T</given-names></name>, <name><surname>Bostanci</surname><given-names>N</given-names></name>, <name><surname>Belibasakis</surname><given-names>GN</given-names></name>. <article-title>Microbial Dynamics during Conversion from Supragingival to Subgingival Biofilms in an in Vitro Model</article-title>. <source>Molecular Oral Microbiology</source>. <year>2016</year>;<volume>31</volume>(<issue>2</issue>):<fpage>125</fpage>–<lpage>135</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/omi.12108</pub-id><?supplied-pmid 26033167?><pub-id pub-id-type="pmid">26033167</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Beghini</surname><given-names>F</given-names></name>, <name><surname>Renson</surname><given-names>A</given-names></name>, <name><surname>Zolnik</surname><given-names>CP</given-names></name>, <name><surname>Geistlinger</surname><given-names>L</given-names></name>, <name><surname>Usyk</surname><given-names>M</given-names></name>, <name><surname>Moody</surname><given-names>TU</given-names></name>, <etal>et al</etal>. <article-title>Tobacco Exposure Associated with Oral Microbiota Oxygen Utilization in the New York City Health and Nutrition Examination Study</article-title>. <source>Annals of Epidemiology</source>. <year>2019</year>;<volume>34</volume>:<fpage>18</fpage>–<lpage>25.e3</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.annepidem.2019.03.005</pub-id><?supplied-pmid 31076212?><pub-id pub-id-type="pmid">31076212</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref054">
      <label>54</label>
      <mixed-citation publication-type="other">Calgaro M. Mcalgaro93/Sc2meta: Paper Release; 2020. Zenodo.</mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>DeLong</surname><given-names>ER</given-names></name>, <name><surname>DeLong</surname><given-names>DM</given-names></name>, <name><surname>Clarke-Pearson</surname><given-names>DL</given-names></name>. <article-title>Comparing the Areas under Two or More Correlated Receiver Operating Characteristic Curves: A Nonparametric Approach</article-title>. <source>Biometrics</source>. <year>1988</year>;<volume>44</volume>(<issue>3</issue>):<fpage>837</fpage>–<lpage>845</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/2531595</pub-id><?supplied-pmid 3203132?><pub-id pub-id-type="pmid">3203132</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Nielsen</surname><given-names>HB</given-names></name>, <name><surname>Almeida</surname><given-names>M</given-names></name>, <name><surname>Juncker</surname><given-names>AS</given-names></name>, <name><surname>Rasmussen</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Identification and Assembly of Genomes and Genetic Elements in Complex Metagenomic Samples without Using Reference Genomes</article-title>. <source>Nature Biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>8</issue>):<fpage>822</fpage>–<lpage>828</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.2939</pub-id><?supplied-pmid 24997787?><pub-id pub-id-type="pmid">24997787</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Gevers</surname><given-names>D</given-names></name>, <name><surname>Kugathasan</surname><given-names>S</given-names></name>, <name><surname>Denson</surname><given-names>LA</given-names></name>, <name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name>, <name><surname>Van Treuren</surname><given-names>W</given-names></name>, <name><surname>Ren</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>The Treatment-Naive Microbiome in New-Onset Crohn’s Disease</article-title>. <source>Cell Host &amp; Microbe</source>. <year>2014</year>;<volume>15</volume>(<issue>3</issue>):<fpage>382</fpage>–<lpage>392</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.chom.2014.02.005</pub-id><?supplied-pmid 24629344?><pub-id pub-id-type="pmid">24629344</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Breiman</surname><given-names>L</given-names></name>. <article-title>Random Forests</article-title>. <source>Machine Learning</source>. <year>2001</year>;<volume>45</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>32</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Chawla</surname><given-names>NV</given-names></name>, <name><surname>Bowyer</surname><given-names>KW</given-names></name>, <name><surname>Hall</surname><given-names>LO</given-names></name>, <name><surname>Kegelmeyer</surname><given-names>WP</given-names></name>. <article-title>SMOTE: Synthetic Minority Over-sampling Technique</article-title>. <source>Journal of Artificial Intelligence Research</source>. <year>2002</year>;<volume>16</volume>:<fpage>321</fpage>–<lpage>357</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1613/jair.953</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref060">
      <label>60</label>
      <mixed-citation publication-type="other">Kuhn M, Wickham H. Tidymodels: A Collection of Packages for Modeling and Machine Learning Using Tidyverse Principles.; 2020.</mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>BD</given-names></name>, <name><surname>Witten</surname><given-names>D</given-names></name>, <name><surname>Willis</surname><given-names>AD</given-names></name>. <article-title>Modeling Microbial Abundances and Dysbiosis with Beta-Binomial Regression</article-title>. <source>The Annals of Applied Statistics</source>. <year>2020</year>;<volume>14</volume>(<issue>1</issue>):<fpage>94</fpage>–<lpage>115</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1214/19-aoas1283</pub-id><?supplied-pmid 32983313?><pub-id pub-id-type="pmid">32983313</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Barbie</surname><given-names>DA</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Boehm</surname><given-names>JS</given-names></name>, <name><surname>Kim</surname><given-names>SY</given-names></name>, <name><surname>Moody</surname><given-names>SE</given-names></name>, <name><surname>Dunn</surname><given-names>IF</given-names></name>, <etal>et al</etal>. <article-title>Systematic RNA Interference Reveals That Oncogenic <italic toggle="yes">KRAS</italic>-Driven Cancers Require TBK1</article-title>. <source>Nature</source>. <year>2009</year>;<volume>462</volume>(<issue>7269</issue>):<fpage>108</fpage>–<lpage>112</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature08460</pub-id><?supplied-pmid 19847166?><pub-id pub-id-type="pmid">19847166</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Calgaro</surname><given-names>M</given-names></name>, <name><surname>Romualdi</surname><given-names>C</given-names></name>, <name><surname>Waldron</surname><given-names>L</given-names></name>, <name><surname>Risso</surname><given-names>D</given-names></name>, <name><surname>Vitulo</surname><given-names>N</given-names></name>. <article-title>Assessment of Statistical Methods from Single Cell, Bulk RNA-seq, and Metagenomics Applied to Microbiome Data</article-title>. <source>Genome Biology</source>. <year>2020</year>;<volume>21</volume>(<issue>1</issue>):<fpage>191</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-020-02104-1</pub-id><?supplied-pmid 32746888?><pub-id pub-id-type="pmid">32746888</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>C</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Pan</surname><given-names>W</given-names></name>. <article-title>An Adaptive Association Test for Microbiome Data</article-title>. <source>Genome Medicine</source>. <year>2016</year>;<volume>8</volume>(<issue>1</issue>):<fpage>56</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13073-016-0302-3</pub-id><?supplied-pmid 27198579?><pub-id pub-id-type="pmid">27198579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>JT</given-names></name>, <name><surname>Silverman</surname><given-names>J</given-names></name>, <name><surname>Tikhonov</surname><given-names>G</given-names></name>, <name><surname>Lähdesmäki</surname><given-names>H</given-names></name>, <name><surname>Bonneau</surname><given-names>R</given-names></name>. <article-title>Scalable Estimation of Microbial Co-Occurrence Networks with Variational Autoencoders</article-title>. <source>Bioinformatics</source>; <year>2021</year>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btab438</pub-id><?supplied-pmid 34125875?><pub-id pub-id-type="pmid">34125875</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>S</given-names></name>, <name><surname>Ren</surname><given-names>B</given-names></name>, <name><surname>Mallick</surname><given-names>H</given-names></name>, <name><surname>Moon</surname><given-names>YS</given-names></name>, <name><surname>Schwager</surname><given-names>E</given-names></name>, <name><surname>Maharjan</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>A Statistical Model for Describing and Simulating Microbial Community Profiles</article-title>. <source>PLOS Computational Biology</source>. <year>2021</year>;<volume>17</volume>(<issue>9</issue>):<fpage>e1008913</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008913</pub-id><?supplied-pmid 34516542?><pub-id pub-id-type="pmid">34516542</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref067">
      <label>67</label>
      <mixed-citation publication-type="other">Naim I, Gildea D. Convergence of the EM Algorithm for Gaussian Mixtures with Unbalanced Mixing Coefficients. Proceedings of the 29th International Coference on International Conference on Machine Learning. 2012; p. 8.</mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Martín-Fernández</surname><given-names>JA</given-names></name>, <name><surname>Hron</surname><given-names>K</given-names></name>, <name><surname>Templ</surname><given-names>M</given-names></name>, <name><surname>Filzmoser</surname><given-names>P</given-names></name>, <name><surname>Palarea-Albaladejo</surname><given-names>J</given-names></name>. <article-title>Model-Based Replacement of Rounded Zeros in Compositional Data: Classical and Robust Approaches</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2012</year>;<volume>56</volume>(<issue>9</issue>):<fpage>2688</fpage>–<lpage>2704</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.csda.2012.02.012</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Kaul</surname><given-names>A</given-names></name>, <name><surname>Davidov</surname><given-names>O</given-names></name>, <name><surname>Peddada</surname><given-names>SD</given-names></name>. <article-title>Structural Zeros in High-Dimensional Data with Applications to Microbiome Studies</article-title>. <source>Biostatistics</source>. <year>2017</year>;<volume>18</volume>(<issue>3</issue>):<fpage>422</fpage>–<lpage>433</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biostatistics/kxw053</pub-id><?supplied-pmid 28065879?><pub-id pub-id-type="pmid">28065879</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010091.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Weissman</surname><given-names>JL</given-names></name>, <name><surname>Dogra</surname><given-names>S</given-names></name>, <name><surname>Javadi</surname><given-names>K</given-names></name>, <name><surname>Bolten</surname><given-names>S</given-names></name>, <name><surname>Flint</surname><given-names>R</given-names></name>, <name><surname>Davati</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Exploring the Functional Composition of the Human Microbiome Using a Hand-Curated Microbial Trait Database</article-title>. <source>BMC Bioinformatics</source>. <year>2021</year>;<volume>22</volume>(<issue>1</issue>):<fpage>306</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-021-04216-2</pub-id><?supplied-pmid 34098872?><pub-id pub-id-type="pmid">34098872</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010091.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010091.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Patil</surname>
          <given-names>Kiran Raosaheb</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Patil, Segata</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Patil, Segata</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010091" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">22 Oct 2021</named-content>
    </p>
    <p>Dear Dr. Frost,</p>
    <p>Thank you very much for submitting your manuscript "cILR: Competitive isometric log-ratio for taxonomic enrichment analysis" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Nicola Segata</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Kiran Patil</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: </p>
    <p>1 Summary</p>
    <p>=========</p>
    <p>  In this manuscript Nguyen et al propose cILR for a set-enrichment-like</p>
    <p>  analysis of microbiome sequencing data. This is a scale invariant</p>
    <p>  alternative to the more standard (and problematic) approach of</p>
    <p>  applying GSEA to DESeq2 output or other such approaches. Overall its a</p>
    <p>  nice idea and is fairly well executed. The statistical analysis is</p>
    <p>  largely appropriate and it could be a nice contribution. My largest</p>
    <p>  comments relate to the lack of precision in the authors' writing, the</p>
    <p>  extent of the authors claims, and the authors handling of zeros and</p>
    <p>  count variation.</p>
    <p>2 Detailed Comments</p>
    <p>===================</p>
    <p>2.1 Precision of Writing:</p>
    <p>~~~~~~~~~~~~~~~~~~~~~~~~~</p>
    <p>  + The authors repeatedly state this data is "compositional" or</p>
    <p>    "strictly compositional". First, what is "strictly compositional" is</p>
    <p>    there non-scrictly compositional data? Second, the data is clearly</p>
    <p>    not compositional; this is a cliche that has been amplified in the</p>
    <p>    literature and is incorrect. The data is count data, it has zeros</p>
    <p>    and is integer valued, both of those features are in strict contrast</p>
    <p>    to the standard definition of compositional data (i.e., positive</p>
    <p>    multivariate continuous data that sums to a constant value and</p>
    <p>    typically is an open set excluding zero to avoid issues with</p>
    <p>    log-ratio transforms). This distinction is non-trivial as the direct</p>
    <p>    application of log-ratio transforms to this data is poorly motivated</p>
    <p>    in this case and fraught with problems (See later comments on</p>
    <p>    handling of the data).</p>
    <p>  + What the authors propose is not an ILR transform. Unless I am</p>
    <p>    mistaken, there is no constraint on the matrix A such that the the</p>
    <p>    coordinate system is cartesian with an orthonormal basis. In fact,</p>
    <p>    if k does not equal p-1 then it cannot possibly be isomorphic let</p>
    <p>    alone isometric with respect to the Aitchison metric. Unless I am</p>
    <p>    mistaken, the authors should change the name of their method and</p>
    <p>    modify their discussion to be more accurate. I would relate this</p>
    <p>    method is not an ILR transform but it is very similar to phylofactor</p>
    <p>    which takes a similar approach (in phylofactor set membership is</p>
    <p>    dictated by the topology of the tree).</p>
    <p>  + The authors state that the "data is zero-inflated" this is another</p>
    <p>    cliche that I would encourage the authors to remove. Zero-inflation</p>
    <p>    is a particular family of models for these zeros not a objective</p>
    <p>    characteristic of the data. Simply saying there are many zeros would</p>
    <p>    likely suffice in this article. They could argue that the data</p>
    <p>    generating mechanism is well represented by a zero-inflation process</p>
    <p>    but this has been called into question (see Silverman et al. Naught</p>
    <p>    all zeros in sequence count data are the same.)</p>
    <p>  + The authors state that the data is compositional because the number</p>
    <p>    of reads obtained is constrained by the sequencing instrument. Would</p>
    <p>    an instrument that didn't have this constraint lead to</p>
    <p>    "non-compositional data"? This seems unlikely. For example standard</p>
    <p>    equimolar pooling protocols explicitly dilute concentrated DNA from</p>
    <p>    each sample to try to equalize sequencing depth. Its not just an</p>
    <p>    issue of the sequencer. Even sampling from an environment (e.g.,</p>
    <p>    taking 5 grams of stool from a larger stool sample) looses the</p>
    <p>    notion of absolute abundance.</p>
    <p>  + The GSEA method cited on line 51 is not a random-walk like</p>
    <p>    statistic. I think it may be a brownian bridge but its constrained</p>
    <p>    to be zero at either end -- not a random walk.</p>
    <p>  + Between lines 73 and 85 the authors do not properly motivate the</p>
    <p>    multiplicative rather than additive amalgamation. They mention the</p>
    <p>    downsides of the "naive summation-based method" but this is unclear.</p>
    <p>    From later in the manuscript I gather that this statement reflects</p>
    <p>    the perturbation invariance of multiplicative amalgamation: given</p>
    <p>    that some have argued that measurement bias can be modeled as a</p>
    <p>    constant compositional perturbation. This needs to be made explicit.</p>
    <p>    There is no inherent downside of summation (i.e., additive</p>
    <p>    amalgamation) - its a modeling choice and it is not "naive".</p>
    <p>  + The authors mention "adjusting for correlation" multiple times</p>
    <p>    throughout the manuscript yet the motivation is not properly</p>
    <p>    clarified. The best I can guess is that they are saying that they</p>
    <p>    need to modify the null-hypothesis to account for a trivial case</p>
    <p>    where something looks differential expressed or set enriched when</p>
    <p>    really its just due to the correlation structure between taxa. That</p>
    <p>    said, I think there are many potential sources of confusion that the</p>
    <p>    authors should clarify. Couldn't set enrichment be reflected in</p>
    <p>    those correlations? Isn't the correlations actually a non-trivial</p>
    <p>    part of what the authors are trying to model? In other words if a</p>
    <p>    set of microbes is highly correlated wouldn't that be a sign that</p>
    <p>    that set is potentially enriched or de-enriched? I don't think I</p>
    <p>    understand this point completely but I think it is likely</p>
    <p>    non-trivial. I would encourage the authors to clarify the role of</p>
    <p>    correlation.</p>
    <p>  + On lines 167-170 the authors state that since the cILR are not</p>
    <p>    orthogonal a correlation can exist between cILR aggregated</p>
    <p>    variables. This is misleading there can be correlation whether or</p>
    <p>    not the cILR's are orthogonal or not, orthogonality and a lack of</p>
    <p>    correlation are separate concepts.</p>
    <p>  + Citation on line 187. I don't see how this paper supports this</p>
    <p>    statement. Egozcue et al. take a almost purely mathematical approach</p>
    <p>    as far as I can tell do not discuss central limit theorems or other</p>
    <p>    things that are implied by the authors statement. If I remember</p>
    <p>    correctly the relevant citations are authored by Aitchison while I</p>
    <p>    cannot remember them exactly.</p>
    <p>  + On line 536 the authors mention "inflated counts", I have no idea</p>
    <p>    what this means.</p>
    <p>  + Lines 572 to 582. I don't understand how this hypothesis makes</p>
    <p>    sense. How does taxa-specific bias relate to the performance of</p>
    <p>    DESeq2 or corncob? The writing here is poor. Also, I am not sure how</p>
    <p>    this could be, are you not basing the gold-standard truth off of</p>
    <p>    permuted data which you know has no signal? This permutation would</p>
    <p>    maintain the measurement bias... as a result it would seem the data</p>
    <p>    does not support this hypothesis. I expect I am missing something.</p>
    <p>2.2 Modeling Choices</p>
    <p>~~~~~~~~~~~~~~~~~~~~</p>
    <p>  + As far as I can tell the authors do not state how they are handling</p>
    <p>    zeros. This is a non-trivial methodologic detail especially if they</p>
    <p>    are simply taking log-ratio transforms of count data. To what extend</p>
    <p>    is the non-normality of the authors results simply a product of</p>
    <p>    directly transforming count data without accounting for the variance</p>
    <p>    of the counts. For example, count data typically have a mean</p>
    <p>    variance relationship that seems largely ignored by the authors</p>
    <p>    approach. Moreover, there has been a number of advances in</p>
    <p>    compositional modeling of microbiome focusing on Multinomial</p>
    <p>    logistic normal models that are not addressed by the authors. In</p>
    <p>    fact in light of the availability of these methods the authors</p>
    <p>    modeling of these counts seems sub-par.</p>
    <p>2.3 Unsubstantiated Claims</p>
    <p>~~~~~~~~~~~~~~~~~~~~~~~~~~</p>
    <p>  There are a number of unsubstantiated claims where the language needs</p>
    <p>  to be altered to be more precise.</p>
    <p>  + Line 493: "These results demonstrate that cILR generated scores are</p>
    <p>    informative features in disease prediction tasks." No. These results</p>
    <p>    demonstrate that cILR COULD be informative features in disease</p>
    <p>    predictions tasks. I am not convinced that these are even useful for</p>
    <p>    the case-studies shown in this manuscript let alone other tasks.</p>
    <p>    Moreover, the comparison methods ssGSEA and GSVA seem like odd</p>
    <p>    choices. Are the authors only using methods that can take set-based</p>
    <p>    features? This does not account for the potential that the chosen</p>
    <p>    sets are not informative. The later seems like an important case to</p>
    <p>    establish the motivation of the current work.</p>
    <p>  + Line 535-537. The authors show that their model displays Type 1</p>
    <p>    error control on a set of of simulated datasets. They make some</p>
    <p>    claims about false-discovery control on real data on lines 397-406</p>
    <p>    but I really don't follow how they know what is non-random or random</p>
    <p>    on this dataset. It seems like they have a strong hypothesis about</p>
    <p>    aerobic vs. anaerobic but that hypothesis seems too weak to serve as</p>
    <p>    a gold-standard reference. Overall these claims are unsubstantiated.</p>
    <p>    I would emphasize that any claim saying a model can be trusted is</p>
    <p>    suspect and bordering on overtly false -- any model can fail and</p>
    <p>    nearly all models are misspecified there are times at which a model</p>
    <p>    may be useful but that iss about it. No model can be globally</p>
    <p>    trusted.</p>
    <p>2.4 Other Comments on Clarity</p>
    <p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p>
    <p>  + The writing after line 215 lacks detail. I kept waiting for a</p>
    <p>    methods section to answer some of my questions (e.g., how was mu or</p>
    <p>    phi chosen in equation 3) but these don't seem to be listed</p>
    <p>    anywhere. Details in the remaining parts of the manuscript are</p>
    <p>    inconsistently given or vague. e.g., Line 249 "all sample sizes were</p>
    <p>    set to 10,000". Do you mean sequencing depth? Number of reads?</p>
    <p>    Number of technical replicates? What is this referring to?</p>
    <p>  + The writing after line 215 is hard to read. In part this relates to</p>
    <p>    the lack of detail but I think it also stems from the fact that the</p>
    <p>    manuscript starts being written in triplicate for Single Sample</p>
    <p>    Enrichment, Differential Abundance Analysis, and then Prediction. It</p>
    <p>    makes the paper repetitive and hard to follow. Further, figures are</p>
    <p>    repetitive and poorly labeled so its hard, at a glance, to figure</p>
    <p>    out what figure links to what part of the paper. I have never seen a</p>
    <p>    discussion written in the parts but this just adds to the feeling</p>
    <p>    that this is just a paper written in triplicate without a coherent</p>
    <p>    message beyond the initial idea which ends around line 215. Further</p>
    <p>    it was not clear from reading the introduction that the paper would</p>
    <p>    be organized like this; some warning in the introduction may help a</p>
    <p>    bit. In fact, it was not even clear what the distinction between</p>
    <p>    single-sample enrichment and differential abundance was from the</p>
    <p>    introduction. In addition, this notation is non-standard. Typically</p>
    <p>    enrichment (e.g., as used in gsEa) refers to essentially</p>
    <p>    differential expression but for sets of genes (i.e., it is typically</p>
    <p>    a comparison between groups). This makes the "single-sample</p>
    <p>    enrichment" terminology confusing.</p>
    <p>Reviewer #2: * Summary:</p>
    <p>Nguyen et al. present a new method for taxonomic enrichment analysis of microbiome data based on an isometric log-ratio transformation of compositional and the competitive null hypothesis borrowed from the gene set enrichment literature. The main strengths are a well-written and structured manuscript, a solid statistical and analytical foundation of the method, and a thorough evaluation of the method on simulated and real datasets. The main weaknesses are installation issues with the R companion package, a lack of adaptation of existing standards for the benchmarking of gene set enrichment methods, and a number of theoretical considerations with the use of a competitive null hypothesis for enrichment testing.</p>
    <p>* Major:</p>
    <p>** Installation:</p>
    <p>Using a recent R installation (R.4.1.0) and Bioconductor installation (3.13), I was not able to install the package. The error message and my session info is included below. The method looks useful for the community and I would strongly encourage a Bioconductor submission (or at least a CRAN submission) of the package to ensure that the package passes R CMD build, check, and install in a continuous integration setup.</p>
    <p>** Adapting standards for the benchmarking of enrichment methods:</p>
    <p>Geistlinger et al. (doi: 10.1093/bib/bbz158) has recently introduced an extensible framework for reproducible benchmarking of enrichment methods based on defined criteria for applicability, gene set prioritization and detection of relevant processes. This setup consists of compendia of curated and standardized datasets and a number of criteria that apply as-is also for new enrichment methods in the microbiome data realm (such as runtime, proportion of rejected null hypotheses, behavior on permuted sample labels and random gene sets). Although I would really like to commend the authors for using curated and standardized datasets from curatdMetagenomicData and HMP16SData, the authors then proceed with the practice of self-assessment over various scenarios which is typically difficult to transport and apply for new methods. Being one of the first methods for enrichment analysis in the microbiome realm (but very likely not the last one), the paper has the opportunity to very early on set the baseline for how new enrichment methods in the microbiome space should be evaluated building on lessons learned in the gene set enrichment literature. This could be achieved (a) clearly communicating the existence of such standards, (b) adapting existing standards where possible, and (c) to point out where adaption of such standards would require further work, as there might well be criteria that do not straightforward translate from gene set enrichment to taxon set enrichment.</p>
    <p>** On the use of the competitive null hypothesis for enrichment testing:</p>
    <p>The authors demonstrate that cILR controls for type I error even under high sparsity and high inter-taxa correlation. However, it has been pointed out that strict type I error rate control might not be a desirable feature for enrichment methods (Goeman and Buhlman, 2009; Wu and Smyth, 2012; Geistlinger et al. 2021). Gene set enrichment analysis is an exploratory process, not a confirmatory, diagnostic process, where strict type I error control augments the lack in power which is well documented for competitive enrichment testing (Goeman and Buhlman, 2009; Wu and Smyth, 2012; Geistlinger et al. 2021) and as the authors demonstrate in their own evaluations. Furthermore, Geistlinger et al. 2021 (Figure 4 therein) has demonstrated that despite controlling the type I error rate, methods might demonstrate widely different rejection rates on real datasets. It is in this context noteworthy that the authors of Camera (Wu and Smyth, 2012), which deliberately abandons strict type I error control by default to compensate for the apparent lack in power of competitive methods.</p>
    <p>&gt; devtools::install_github("qpmnguyen/teaR")</p>
    <p>checking for file ‘/private/var/folders/q9/zp53ds5x6s9g62l77whflgyc0000gn/T/RtmpaSffST/remotesc96e405f9f91/qpmnguyen-teaR-ddb✔ checking for file ‘/private/var/folders/q9/zp53ds5x6s9g62l77whflgyc0000gn/T/RtmpaSffST/remotesc96e405f9f91/qpmnguyen-teaR-ddbc50c/DESCRIPTION’</p>
    <p>─ preparing ‘teaR’:</p>
    <p>✔ checking DESCRIPTION meta-information ...</p>
    <p>─ cleaning src</p>
    <p>─ checking for LF line-endings in source and make files and shell scripts</p>
    <p>─ checking for empty or unneeded directories</p>
    <p>Omitted ‘LazyData’ from DESCRIPTION</p>
    <p>─ building ‘teaR_0.99.0.tar.gz’</p>
    <p>Installing package into ‘/Library/Frameworks/R.framework/Versions/4.1/Resources/release’</p>
    <p>(as ‘lib’ is unspecified)</p>
    <p>* installing *source* package ‘teaR’ ...</p>
    <p>** using staged installation</p>
    <p>** libs</p>
    <p>clang++ -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG -I'/Library/Frameworks/R.framework/Versions/4.1/Resources/release/Rcpp/include' -I/usr/local/include -fPIC -Wall -g -O2 -c RcppExports.cpp -o RcppExports.o</p>
    <p>clang++ -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG -I'/Library/Frameworks/R.framework/Versions/4.1/Resources/release/Rcpp/include' -I/usr/local/include -fPIC -Wall -g -O2 -c cilr.cpp -o cilr.o</p>
    <p>cilr.cpp:26:41: error: expected expression</p>
    <p>if (std::any_of(X.begin(), X.end(), [](double i){return i &lt;= 0;})){</p>
    <p>^</p>
    <p>1 error generated.</p>
    <p>make: *** [cilr.o] Error 1</p>
    <p>ERROR: compilation failed for package ‘teaR’</p>
    <p>* removing ‘/Library/Frameworks/R.framework/Versions/4.1/Resources/release/teaR’</p>
    <p>Warning message:</p>
    <p>In i.p(...) :</p>
    <p>installation of package ‘/var/folders/q9/zp53ds5x6s9g62l77whflgyc0000gn/T//RtmpaSffST/filec96e620d5765/teaR_0.99.0.tar.gz’ had non-zero exit status</p>
    <p>&gt; sessionInfo()</p>
    <p>R version 4.1.0 (2021-05-18)</p>
    <p>Platform: x86_64-apple-darwin17.0 (64-bit)</p>
    <p>Running under: macOS Big Sur 10.16</p>
    <p>Matrix products: default</p>
    <p>BLAS: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib</p>
    <p>LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</p>
    <p>locale:</p>
    <p>[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</p>
    <p>attached base packages:</p>
    <p>[1] stats graphics grDevices utils datasets methods base</p>
    <p>loaded via a namespace (and not attached):</p>
    <p>[1] rstudioapi_0.13 magrittr_2.0.1 usethis_2.0.1</p>
    <p>[4] devtools_2.4.2 pkgload_1.2.1 R6_2.5.0</p>
    <p>[7] rlang_0.4.11 fastmap_1.1.0 tools_4.1.0</p>
    <p>[10] pkgbuild_1.2.0 sessioninfo_1.1.1 cli_3.0.1</p>
    <p>[13] withr_2.4.2 ellipsis_0.3.2 remotes_2.4.0</p>
    <p>[16] rprojroot_2.0.2 lifecycle_1.0.0 crayon_1.4.1</p>
    <p>[19] processx_3.5.2 BiocManager_1.30.16 purrr_0.3.4</p>
    <p>[22] callr_3.7.0 fs_1.5.0 ps_1.6.0</p>
    <p>[25] testthat_3.0.4 curl_4.3.2 memoise_2.0.0</p>
    <p>[28] glue_1.4.2 cachem_1.0.5 compiler_4.1.0</p>
    <p>[31] desc_1.3.0 prettyunits_1.1.1</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010091.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010091.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010091" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">17 Feb 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010091.s009" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">CBEA_reviewer_response.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010091.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010091.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010091.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Patil</surname>
          <given-names>Kiran Raosaheb</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Patil, Segata</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Patil, Segata</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010091" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Mar 2022</named-content>
    </p>
    <p>Dear Dr. Frost,</p>
    <p>Thank you very much for submitting your manuscript "CBEA: Competitive balances for taxonomic enrichment analysis" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Nicola Segata</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Kiran Patil</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This response was well thought out and addresses my major concerns.</p>
    <p>Reviewer #2: My comments regarding the manuscript text have been satisfactorily addressed. The authors also indicate that they started a Bioconductor submission under <ext-link xlink:href="https://github.com/Bioconductor/Contributions/issues/2449" ext-link-type="uri">https://github.com/Bioconductor/Contributions/issues/2449</ext-link>. However, the submission under the provided link has been closed due to inactivity / revisions performed to the manuscript and implementation. An initial review by a reviewer from the Bioc core team indicates that the package is in good shape and would only need minor modifications for acceptance in Bioconductor. As I assume this new method to be a useful contribution for the community, I would thus strongly encourage to follow through with the Bioconductor submission and include a link to the Bioconductor package in the manuscript (once the package has passed review and is accepted in Bioconductor).</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: None</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010091.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010091.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010091" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">28 Mar 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010091.s010" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">CBEA_CoverLetter.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010091.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010091.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010091.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Patil</surname>
          <given-names>Kiran Raosaheb</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Patil, Segata</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Patil, Segata</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010091" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Apr 2022</named-content>
    </p>
    <p>Dear Dr. Frost,</p>
    <p>We are pleased to inform you that your manuscript 'CBEA: Competitive balances for taxonomic enrichment analysis' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Nicola Segata</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Kiran Patil</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: I have no further comments.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010091.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010091.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Patil</surname>
          <given-names>Kiran Raosaheb</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Patil, Segata</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Patil, Segata</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010091" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">2 May 2022</named-content>
    </p>
    <p>PCOMPBIOL-D-21-01648R2 </p>
    <p>CBEA: Competitive balances for taxonomic enrichment analysis</p>
    <p>Dear Dr Frost,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Olena Szabo</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
