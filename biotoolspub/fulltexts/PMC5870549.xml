<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870549</article-id>
    <article-id pub-id-type="pmid">28505226</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx317</article-id>
    <article-id pub-id-type="publisher-id">btx317</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OMTools: a software package for visualizing and processing optical mapping data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Leung</surname>
          <given-names>Alden King-Yung</given-names>
        </name>
        <xref ref-type="aff" rid="btx317-aff1">1</xref>
        <xref ref-type="aff" rid="btx317-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Nana</given-names>
        </name>
        <xref ref-type="aff" rid="btx317-aff1">1</xref>
        <xref ref-type="aff" rid="btx317-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yip</surname>
          <given-names>Kevin Y</given-names>
        </name>
        <xref ref-type="aff" rid="btx317-aff3">3</xref>
        <xref ref-type="corresp" rid="btx317-cor1"/>
        <!--<email>kevinyip@cse.cuhk.edu.hk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chan</surname>
          <given-names>Ting-Fung</given-names>
        </name>
        <xref ref-type="aff" rid="btx317-aff1">1</xref>
        <xref ref-type="aff" rid="btx317-aff2">2</xref>
        <xref ref-type="corresp" rid="btx317-cor1"/>
        <!--<email>tf.chan@cuhk.edu.hk</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx317-aff1"><label>1</label>School of Life Sciences, The Chinese University of Hong Kong, Hong Kong SAR, China</aff>
    <aff id="btx317-aff2"><label>2</label>Centre for Soybean Research, State Key Laboratory of Agrobiotechnology, The Chinese University of Hong Kong, Hong Kong SAR, China</aff>
    <aff id="btx317-aff3"><label>3</label>Department of Computer Science and Engineering, The Chinese University of Hong Kong, Hong Kong SAR, China</aff>
    <author-notes>
      <corresp id="btx317-cor1">To whom correspondence should be addressed. Email: <email>kevinyip@cse.cuhk.edu.hk</email> or <email>tf.chan@cuhk.edu.hk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-05-12">
      <day>12</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>18</issue>
    <fpage>2933</fpage>
    <lpage>2935</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx317.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>Optical mapping is a molecular technique capturing specific patterns of fluorescent labels along DNA molecules. It has been widely applied in assisted-scaffolding in sequence assemblies, microbial strain typing and detection of structural variations. Various computational methods have been developed to analyze optical mapping data. However, existing tools for processing and visualizing optical map data still have many shortcomings. Here, we present OMTools, an efficient and intuitive data processing and visualization suite to handle and explore large-scale optical mapping profiles. OMTools includes modules for visualization (OMView), data processing and simulation. These modules together form an accessible and convenient pipeline for optical mapping analyses.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and implementation</title>
        <p>OMTools is implemented in Java 1.8 and released under a GPL license. OMTools can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/aldenleung/OMTools">https://github.com/aldenleung/OMTools</ext-link> and run on any standard desktop computer equipped with a Java virtual machine.</p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Health and Medical Research Fund</named-content>
          <named-content content-type="funder-identifier">10.13039/501100005847</named-content>
        </funding-source>
        <award-id>12110542</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Optical mapping is a technique for imaging DNA molecules along which specific labels are captured. These labels form distinct patterns along DNA molecules based on their nucleotide sequences. Compared with the short read length in next-generation sequencing (∼150 bp), DNA molecules in optical mapping data are several orders longer, at ∼100–1000 kb (<xref rid="btx317-B3" ref-type="bibr">Lam <italic>et al.</italic>, 2012</xref>). Because of the much greater read length, optical mapping has been used for assisted scaffolding, (<xref rid="btx317-B2" ref-type="bibr">Dong <italic>et al.</italic>, 2013</xref>), structural variations detection (<xref rid="btx317-B1" ref-type="bibr">Cao <italic>et al.</italic>, 2014</xref>, <xref rid="btx317-B5" ref-type="bibr">Mak <italic>et al.</italic>, 2016</xref>) and microbial strain typing (<xref rid="btx317-B6" ref-type="bibr">Schwan <italic>et al.</italic>, 2010</xref>). There are currently two instrument platforms available for generating optical mapping data: OpGen Inc. and BioNano Genomics Inc. Emerging computational methods have been developed for data analysis. To gain knowledge and insights from the optical mapping data, human analysis and interpretation is required and usually involves data visualization. At present, three visualization tools for optical mapping are available: BioNumerics v7 (Applied Maths NV), IrysView (<xref rid="btx317-B7" ref-type="bibr">Shelton <italic>et al.</italic>, 2015</xref>) and JBrowse (<xref rid="btx317-B8" ref-type="bibr">Skinner <italic>et al.</italic>, 2009</xref>). However, none of them could provide multiple visualization styles in accordance to the types of application. Here, we present the software package OMTools, which comprises modules for visualization (OMView), processing optical mapping data and alignment results, and simulation. The package has fast loading time, easy installation and support to multiple data formats (<xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1 and S2</xref>).</p>
  </sec>
  <sec>
    <title>2 OMView</title>
    <p>OMView is a multipurpose visualization module for optical mapping data analysis. Five types of visualizations (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>) are implemented in OMView for different objectives: regional view, anchor view, alignment view, multiple alignments view and molecule view (<xref ref-type="fig" rid="btx317-F1">Fig. 1A–E</xref>). In all types of visualizations, a rectangular block represents the DNA backbone, while vertical bars on the blocks represent signals on the DNA molecule. We explain the purpose and a related example for each type of visualization below.
</p>
    <fig id="btx317-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Major visualization modes in OMView. Five types of views are available to visualize optical mapping data for different purposes: (<bold>A</bold>) Regional view, (<bold>B</bold>) Anchor view, (<bold>C</bold>) Alignment view, (<bold>D</bold>) Multiple alignments view and (<bold>E</bold>) Molecule view</p>
      </caption>
      <graphic xlink:href="btx317f1"/>
    </fig>
    <p>The <italic>regional view</italic> displays all alignments as an overview at a selected region. In each panel, the reference DNA is represented by a thick red line, while aligned and unaligned portions of a molecule are represented by yellow and green lines, respectively. Molecule signals matching the reference signals are in pink while the unaligned ones are in black. Contigs alignment along the reference is also displayed in a similar manner. Each aligned molecule is stretched accordingly so that the first and last matching signals are located at the respective horizontal positions of the reference signals. For a molecule that has individual portions separately aligned to different reference regions, OMView depicts the relationships between consecutive aligned portions (insertion, deletion, inversion and translocation). Multiple panels could be created to display alignment results from different datasets for comparison at the same region, as exemplified with a case of copy number variations on chromosome 18 in the 1000 Genomes trio dataset NA12878, NA12891 and NA12892 in <xref ref-type="fig" rid="btx317-F1">Figure 1A</xref> (<xref rid="btx317-B5" ref-type="bibr">Mak <italic>et al.</italic>, 2016</xref>). Additional panels could be loaded to visualize annotations on the reference, such as gene annotations or gaps depicted as black rectangles above the alignments.</p>
    <p>The <italic>anchor view</italic> is mainly designed for validating structural variations. It displays alignments of which molecule signals could match two selected signals on the reference. Under this view, molecules are shown at the original measured lengths such that structural variations can be easily seen. After the automatic sorting of alignments according to the distance between the two signals on molecules by a sub-module in OMView, the presence as well as the zygosity of insertions/deletions could be easily determined. A similar example of copy number variations described before in anchor view is shown in <xref ref-type="fig" rid="btx317-F1">Figure 1B</xref>.</p>
    <p>The <italic>alignment view</italic> illustrates the alignment of one single molecule against the reference with more details. This is especially important in visualizing partial alignments with complicated relationships. The alignment view employs the aforementioned coloring scheme, where an extended blue block is added to represent unaligned portion of the reference. Multiple panels of alignments are displayed if there are individual portions separately aligned to different reference regions. Below each alignment shows detailed information including aligned signals, alignment score and CIGAR (Concise Idiosyncratic Gapped Alignment Report) string. Certain alignments picked from the previous copy number variations example and an alignment demonstrating an inversion is shown in <xref ref-type="fig" rid="btx317-F1">Figure 1C</xref> (<xref rid="btx317-B5" ref-type="bibr">Mak <italic>et al.</italic>, 2016</xref>).</p>
    <p>The <italic>multiple alignments view</italic>, designed for whole-genome comparisons, depicts multiple optical map alignment of a dataset. Here, matching patterns are represented by a list of collinear-aligned-blocks. Each row of rectangular blocks represents one optical map genome, while each collinear-aligned-block contains a column of rectangular blocks with the same color that represents a matching pattern across different genomes. Down the same column position, a solid line represents a gap and a different colored block represents different matching patterns. Users can therefore easily visualize the structural difference within variable regions across multiple samples. <xref ref-type="fig" rid="btx317-F1">Figure 1D</xref> offers an example of multiple alignments. The user-interface also allows users to manually modify the multiple alignment results and produce statistics of collinear blocks.</p>
    <p>Finally, the <italic>molecule view</italic> is a module for inspection of molecules to offer a general impression on the dataset as shown in <xref ref-type="fig" rid="btx317-F1">Figure 1E</xref>. One could sort the molecules by name, size or number of signals, and a constant number of molecules can be viewed page-by-page.</p>
  </sec>
  <sec>
    <title>3 Additional features</title>
    <p>OMTools contains some useful modules that can be executed within the same software framework for processing of optical mapping data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). Data processing is important for any downstream analysis. OMTools provides filtering tools on optical mapping data such as filtering by size or number of signals. Since molecules with high density or low complexity impede alignment and assembly, OMTools also offers a signal density and complexity filter. A separate module could be applied to detect data duplication errors. Similarly, OMTools provides filtering tools on alignment results. A partial alignment joining module separated from OMBlast (<xref rid="btx317-B4" ref-type="bibr">Leung <italic>et al.</italic>, 2016</xref>) could be employed to treat alignments from other alignment methods as partial alignments to connect them into final alignments. OMTools can also merge and generate statistics for results from various alignment methods.</p>
    <p>A set of simulation modules enables data simulation with a variety of modeling parameters. Various categories of errors including missing and extra signals, scaling, measurement and resolution error are modeled, with optional structural variations added on reference or data to test software related to structural variation detection.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>OMTools offers a fundamental toolbox for optical mapping data processing. OMView serves as a powerful visualization tool for data analysis and illustration. On top of the existing modules and methods included in the OMTools Java library, researchers could build additional analysis modules with minimal effort.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx317_supplementaryinformation.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by the Health and Medical Research Fund 12110542, RGC Collaborative Research Fund [CUHK3/CRF/11G and C4042-14G], Theme-based research schemes T12-403/11, T12-401/13R and T12-402/13-N of the Hong Kong Government, and the Lo Kwee-Seong Biomedical Research Fund and Lee Hysan Foundation.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btx317-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Rapid detection of structural variation in a human genome using nanochannel-based genome mapping technology</article-title>. <source>Gigascience</source>, <volume>3</volume>, <fpage>34</fpage>.<pub-id pub-id-type="pmid">25671094</pub-id></mixed-citation>
    </ref>
    <ref id="btx317-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dong</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Sequencing and automated whole-genome optical mapping of the genome of a domestic goat (Capra hircus)</article-title>. <source>Nat. Biotechnol</source>., <volume>31</volume>, <fpage>135</fpage>–<lpage>141</lpage>.<pub-id pub-id-type="pmid">23263233</pub-id></mixed-citation>
    </ref>
    <ref id="btx317-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lam</surname><given-names>E.T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Genome mapping on nanochannel arrays for structural variation analysis and sequence assembly</article-title>. <source>Nat. Biotechnol</source>., <volume>30</volume>, <fpage>771</fpage>–<lpage>776</lpage>.<pub-id pub-id-type="pmid">22797562</pub-id></mixed-citation>
    </ref>
    <ref id="btx317-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leung</surname><given-names>A.K.-Y.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>OMBlast: alignment tool for optical mapping using a seed-and-extend approach</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>311</fpage>–<lpage>319</lpage>.</mixed-citation>
    </ref>
    <ref id="btx317-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mak</surname><given-names>A.C.Y.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Genome-wide structural variation detection by genome mapping on nanochannel arrays</article-title>. <source>Genetics</source>, <volume>202</volume>, <fpage>351–362</fpage>.<pub-id pub-id-type="pmid">26510793</pub-id></mixed-citation>
    </ref>
    <ref id="btx317-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schwan</surname><given-names>W.R.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Use of optical mapping to sort uropathogenic <italic>Escherichia coli</italic> strains into distinct subgroups</article-title>. <source>Microbiology</source>, <volume>156</volume>, <fpage>2124</fpage>–<lpage>2135</lpage>.<pub-id pub-id-type="pmid">20378655</pub-id></mixed-citation>
    </ref>
    <ref id="btx317-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shelton</surname><given-names>J.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Tools and pipelines for BioNano data: molecule assembly pipeline and FASTA super scaffolding tool</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>734</fpage>.<pub-id pub-id-type="pmid">26416786</pub-id></mixed-citation>
    </ref>
    <ref id="btx317-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Skinner</surname><given-names>M.E.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>JBrowse: a next-generation genome browser</article-title>. <source>Genome Res</source>., <volume>19</volume>, <fpage>1630</fpage>–<lpage>1638</lpage>.<pub-id pub-id-type="pmid">19570905</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
