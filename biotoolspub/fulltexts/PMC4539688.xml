<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4539688</article-id>
    <article-id pub-id-type="pmid">26283514</article-id>
    <article-id pub-id-type="publisher-id">683</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0683-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>diffHic: a Bioconductor package to detect differential genomic interactions in Hi-C data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lun</surname>
          <given-names>Aaron T.L.</given-names>
        </name>
        <address>
          <email>alun@wehi.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Smyth</surname>
          <given-names>Gordon K.</given-names>
        </name>
        <address>
          <email>smyth@wehi.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>The Walter and Eliza Hall Institute of Medical Research, 1G Royal Parade, Parkville, VIC, 3052 Melbourne Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution>Department of Medical Biology, </institution><institution>The University of Melbourne, </institution></institution-wrap>Parkville, VIC, 3010 Melbourne Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution>Department of Mathematics and Statistics, </institution><institution>The University of Melbourne, </institution></institution-wrap>Parkville, VIC, 3010 Melbourne Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>8</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>258</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>7</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Lun and Smyth. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Chromatin conformation capture with high-throughput sequencing (Hi-C) is a technique that measures the <italic>in vivo</italic> intensity of interactions between all pairs of loci in the genome. Most conventional analyses of Hi-C data focus on the detection of statistically significant interactions. However, an alternative strategy involves identifying significant changes in the interaction intensity (i.e., differential interactions) between two or more biological conditions. This is more statistically rigorous and may provide more biologically relevant results.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here, we present the diffHic software package for the detection of differential interactions from Hi-C data. diffHic provides methods for read pair alignment and processing, counting into bin pairs, filtering out low-abundance events and normalization of trended or CNV-driven biases. It uses the statistical framework of the edgeR package to model biological variability and to test for significant differences between conditions. Several options for the visualization of results are also included. The use of diffHic is demonstrated with real Hi-C data sets. Performance against existing methods is also evaluated with simulated data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>On real data, diffHic is able to successfully detect interactions with significant differences in intensity between biological conditions. It also compares favourably to existing software tools on simulated data sets. These results suggest that diffHic is a viable approach for differential analyses of Hi-C data.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0683-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Hi-C</kwd>
      <kwd>Genomic interaction</kwd>
      <kwd>Differential analysis</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Chromatin conformation capture with high-throughput sequencing (Hi-C) is a technique that is widely used to study global chromatin organization <italic>in vivo</italic> [<xref ref-type="bibr" rid="CR1">1</xref>]. Briefly, samples of nuclear DNA are cross-linked and digested with a restriction enzyme to release chromatin complexes into solution (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Each complex may contain multiple restriction fragments, corresponding to an interaction between the associated genomic loci. After some processing, proximity ligation is performed between the ends of the restriction fragments. This favours ligation between restriction fragments in the same complex. The ligated DNA is sheared and purified for high-throughput paired-end sequencing. Each sequencing fragment represents a ligation product, such that each read in the pair originates from a different genomic locus. The intensity of an interaction between a pair of genomic loci can be quantified as the number of read pairs with one read mapped to each locus. The output from the Hi-C procedure spans the genome-by-genome “interaction space” whereby all pairwise interactions between loci can potentially be detected. As such, careful analysis is required to draw meaningful biological conclusions from this type of data.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Main steps in the Hi-C protocol prior to sequencing. Chromatin is cross-linked and cleaved by a restriction enzyme. Interacting loci are held together in the same chromatin complex. Restriction fragment ends are filled in with biotin-labelled nucleotides and subjected to proximity ligation and shearing. Biotin-labelled ligation products are purified for paired-end sequencing. For simplicity, the steps after the restriction digest are only shown for one chromatin complex</p></caption><graphic xlink:href="12859_2015_683_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>Most analyses of Hi-C data have focused on identifying “significant” interactions from a single sample [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. This is challenging because non-specific ligation and apparent interactions can arise from a variety of uninteresting technical causes and rigorous analysis requires a precise quantitative understanding of these artifacts. Identifying biologically interesting interactions from a single sample requires elaborate modeling of the background signal in Hi-C experiments in order to correct for systematic biases due to GC content, mappability and fragment length [<xref ref-type="bibr" rid="CR3">3</xref>]. Such modeling inevitably involves assumptions and approximations. Furthermore, the interaction space for any single sample will be dominated by conserved features such as topologically associating domains [<xref ref-type="bibr" rid="CR4">4</xref>]. These may not be of scientific interest when interactions specific to a particular cell type or experiment condition are being sought. An alternative approach is to identify interactions that are significantly different across two or more biological conditions [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. These differential interactions (DIs) are likely to be scientifically relevant because they are directly associated with the biological conditions being studied. A differential analysis is also technically simpler because it involves a like-for-like comparison, where the intensity of the same interaction is compared between samples. The fact that the same genome is present across samples implies that sequence-related genomic biases will be largely constant between conditions and therefore will tend to cancel out during testing. It follows that interaction-specific biases due to GC content, mappability and similar causes will be substantially mitigated.</p>
    <p>Although several studies have performed custom analyses to detect differential interactions from Hi-C data [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], there are only a couple of publicly available software packages that can do this type of analysis [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. HOMER is a command-line software suite that tests for DIs, assuming binomially-distributed counts and using a background model that takes sequence-based and compartmental biases into account [<xref ref-type="bibr" rid="CR8">8</xref>]. However, HOMER is limited to comparisons between two libraries and does not consider the variability between biological replicates. The binomial assumption means that the tests will only account for sequencing variability. HiBrowse is a user-friendly web-tool implemented in Python [<xref ref-type="bibr" rid="CR7">7</xref>] that can make comparisons between two experimental conditions. This uses the edgeR package [<xref ref-type="bibr" rid="CR9">9</xref>] to estimate biological variablity between replicates. However, HiBrowse is implemented as a web-tool and is not practical for high-throughput analyses of large-scale datasets.</p>
    <p>Here, we present the diffHic package for rigorous detection of differential interactions. Unlike previous tools, diffHic is able to accommodate complex experimental designs, including paired or blocked designs and those with more than two groups. It does this by accessing the generalized linear model functionality of edgeR [<xref ref-type="bibr" rid="CR10">10</xref>]. diffHic also estimates biological variability between replicates using quasi-likelihood methods that robustly control the type I error and false discovery rates [<xref ref-type="bibr" rid="CR11">11</xref>]. diffHic includes functionality to consolidate results at different resolutions while maintaining rigorous error rate control.</p>
    <p>In the diffHic pipeline, read pairs are aligned to a reference genome, processed for quality control and counted into bin pairs across the interaction space. Low-abundance bin pairs are filtered out and the remaining bin pairs are normalized with non-linear methods to eliminate complex biases between libraries. Bin pairs are tested for significant differences between conditions using the latest methods in the edgeR package [<xref ref-type="bibr" rid="CR12">12</xref>]. Careful attention is given to filtering and normalization steps that are sometimes overlooked in existing analysis pipelines. In particular, diffHic provides new normalization methods to removed trended biases that are abundance-dependent. diffHic also implements methods to remove simple scaling biases between libraries and methods to remove genomic biases between interactions and between libraries [<xref ref-type="bibr" rid="CR2">2</xref>]. diffHic can efficiently handle large datasets.</p>
    <p>This article outlines the functionality of the diffHic package. The practical use of the diffHic package is demonstrated with some real Hi-C data sets, for which a number of DIs are successfully detected between conditions. Simulated data is also generated to show that diffHic provides improved sensitivity and error rate control for DI detection, compared to the HOMER software suite.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>diffHic is implemented as an R package. The code is written primarily in R, with time-critical functions written in C++ for greater speed. It makes use of a number of core Bioconductor packages [<xref ref-type="bibr" rid="CR13">13</xref>] such as GenomicRanges, Rsamtools and BSgenome, in addition to edgeR. The pipeline takes a set of name-sorted BAM files [<xref ref-type="bibr" rid="CR14">14</xref>] as input, and processes them into HDF5 files [<xref ref-type="bibr" rid="CR15">15</xref>] prior to further analysis. A helper script written in Python is also provided to facilitate read alignment. The analysis can be run interactively through an R session, or it can be automated for batch jobs.</p>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <sec id="Sec4">
      <title>Introduction to the real data sets</title>
      <p>The diffHic pipeline can be applied on any Hi-C data set containing biological replicates across multiple conditions, where the aim is to detect DIs between conditions. In the following sections, the use of diffHic will be demonstrated on three Hi-C data sets. Each was obtained from the NCBI Gene Expression Omnibus, with the accession number shown below in parentheses. The first data set is taken from a study on human prostate epithelial cells overexpressing the ERG protein or a GFP control (GSE37752) [<xref ref-type="bibr" rid="CR5">5</xref>]. The aim of the differential analysis in this study is to detect ERG-induced changes in the chromatin structure. The second data set is taken from a study on human embryonic stem cells (ESCs) and lung myofibroblasts (GSE35156) [<xref ref-type="bibr" rid="CR4">4</xref>], where the aim is to detect changes between cell types. The final data set is taken from a study on mouse neural stem cells before and after deletion of the <italic>Rad21</italic> gene (GSE49017) [<xref ref-type="bibr" rid="CR16">16</xref>], which aims to identify changes due to the loss of cohesin activity. Two biological replicates are present for each condition in all studies.</p>
    </sec>
    <sec id="Sec5">
      <title>Read alignment and processing</title>
      <p>The first step in a Hi-C data analysis is read alignment to a reference genome. However, this is complicated by the presence of chimeric reads. Recall that a proximity ligation step is performed to construct the Hi-C library. This involves ligating together two interacting DNA fragments from different parts of the genome. A chimeric read is generated when sequencing of the ligation product is performed across the ligation junction. This means that the 5<sup>′</sup> and 3<sup>′</sup> segments of the read are derived from distinct genomic loci. Correct alignment of the 5<sup>′</sup> end is more important than that of the 3<sup>′</sup> end as the location of the latter is already provided by the mate read. Naïvely performing local alignment of full-length reads will be suboptimal as there is no preference for the proper alignment of the 5<sup>′</sup> end.</p>
      <p>The diffHic package uses a pre-splitting strategy to perform chimeric read alignment. This approach takes advantage of the known “signature” sequence around the ligation junction [<xref ref-type="bibr" rid="CR6">6</xref>]. The ligation signature is easily derived from the known recognition sequence of the restriction enzyme used for the initial digestion of the chromatin. For example, the <italic>Hin</italic>dIII enzyme has a recognition sequence of AAGCTT with a 4 bp 5<sup>′</sup> overhang, resulting in a ligation signature of AAGCTAGCTT. Each read sequence containing this signature is split into 5<sup>′</sup> and 3<sup>′</sup> segments at the centre of the signature, using the Cutadapt program [<xref ref-type="bibr" rid="CR17">17</xref>]. Each segment of each read in each pair is then independently aligned to the reference genome using Bowtie2 [<xref ref-type="bibr" rid="CR18">18</xref>]. This pre-splitting approach outperforms the naïve approach for simulated chimeric reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 1, Table S1). For both chimeric and non-chimeric reads, pre-splitting also outperforms the “iterative mapping” approach, where each read is truncated to a 5<sup>′</sup> subsequence and gradually extended from the 3<sup>′</sup> end until it aligns uniquely [<xref ref-type="bibr" rid="CR2">2</xref>]. Similar differences are observed when these non-naïve strategies are applied to real Hi-C libraries (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 1, Table S2).</p>
      <p>Once reads are aligned into BAM files, a number of quality control steps can be applied to remove artifacts. The sizes of the sequencing fragments are estimated by computing the distance of each read to the nearest restriction site in the direction of the read, and summing those distances for both reads in the pair. Fragments with sizes above a default threshold of 600 bp are assumed to result from non-specific cleavage and are discarded [<xref ref-type="bibr" rid="CR2">2</xref>]. Inward-facing read pairs less than 1 kbp apart are also discarded, to avoid dangling ends from inefficient ligation of (incompletely digested) restriction fragments [<xref ref-type="bibr" rid="CR19">19</xref>]. Similarly, outward-facing read pairs less than 25 kbp apart are discarded to avoid self-ligation products from those fragments.</p>
      <p>For the real data, reads were aligned using the pre-splitting strategy to the appropriate reference genome for each study – mm10 for mouse, and hg19 for human. Read pairs were ignored if the 5<sup>′</sup> segment of either read was unmapped, had a mapping quality (MAPQ) score below 10 or was marked as a potential PCR duplicate with the MarkDuplicates tool in the Picard suite v1.117 (<ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard">http://broadinstitute.github.io/picard</ext-link>). Quality control was applied to all remaining read pairs, as described. Any technical replicates were pooled into a single library. Approximately 25–55 % of read pairs were retained in the final libraries.</p>
    </sec>
    <sec id="Sec6">
      <title>Counting into bin pairs</title>
      <p>After alignment, read pairs need to be summarized into counts for each interaction. A simple binning approach is used here, whereby the genome is partitioned into contiguous and non-overlapping bins of fixed width [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Each pair of bins represents an interaction between the corresponding genomic regions. The count for each bin pair is defined as the number of read pairs with one read in each of the corresponding bins (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In this manner, one count is obtained for each bin pair in each library. Note that the boundary of each bin is rounded to the nearest restriction site to reflect the limit of spatial resolution in Hi-C data [<xref ref-type="bibr" rid="CR2">2</xref>]. The exact location of the interacting locus is largely irrelevant as promixity ligation will always be performed between blunt ends derived from the flanking restriction sites.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Overview of the counting strategy with bin pairs. The linear genome is partitioned into bins of constant size, such that the interaction space is partitioned into bin pairs (boxes). Read pairs are shown as open circles and are distributed across the interaction space according to the mapping locations of both reads. For example, the marked read pair (closed circle) has one read on each of chromosomes A and B, mapped to the indicated location on each axis. The number of read pairs in each box is used as the count for the corresponding bin pair</p></caption><graphic xlink:href="12859_2015_683_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>The bin size is a critical parameter that determines the desired resolution of the analysis. Larger bins will contain more reads and provide larger counts, increasing precision and power for downstream hypothesis testing [<xref ref-type="bibr" rid="CR20">20</xref>]. This is often necessary for Hi-C data where read pairs are sparsely distributed across the interaction space. In contrast, smaller bins have lower counts but achieve greater spatial resolution, i.e., adjacent regions in the interaction space can be distinguished. This is important for detecting sharp events such as looping interactions, where the use of larger bins would result in “contamination” by irrelevant counts in the neighbouring space. Traditionally, bin sizes from 100 kbp to 1 Mbp have been used [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] though sizes below 10 kbp are feasible with higher-resolution studies [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Analyses with different sizes can be consolidated later for comprehensive detection of DIs.</p>
      <p>For the real data sets, pairs of 1 Mbp bins were used for counting. This ensures that the counts are sufficiently large, albeit at the cost of spatial resolution. In addition, bin pairs with one or more bins on chromosome Y were discarded. This avoids spurious detection of DIs between conditions due to sex differences. diffHic is also capable of performing higher-resolution analyses – some results with smaller bin sizes (20–100 kbp) are presented throughout Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec7">
      <title>Filtering out low-abundance bin pairs</title>
      <p>Filtering is recommended to remove low-abundance bin pairs prior to further analysis. This decreases the severity of the multiple testing correction; avoids loss of accuracy for statistical approximations at low, discrete counts; and reduces computational work. In edgeR’s statistical framework, the filter statistic for each bin pair is the average log-count-per-million (CPM), i.e., the average abundance across all libraries. This is (roughly) independent of the <italic>p</italic>-value under the null hypothesis, i.e., that there is no difference in counts between conditions [<xref ref-type="bibr" rid="CR22">22</xref>]. Any bin pair with an average abundance below a specified threshold value can be discarded. The aim is to enrich for false nulls without affecting the type I error rate for true nulls [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p>A number of different filtering approaches are implemented in diffHic. The simplest method uses the median abundance of all inter-chromosomal bin pairs as an estimate of the non-specific ligation rate, and only retains bin pairs with abundances above this estimate. This is motivated by the organization of chromosomes into self-contained territories [<xref ref-type="bibr" rid="CR24">24</xref>], which limits the number of genuine contacts that can occur between chromosomes. Another strategy involves fitting a trend to the abundance of intra-chromosomal bin pairs against genomic distance, i.e., the distance between bins in each bin pair. A bin pair is only retained if its abundance is greater than the fitted value of the trend. This assumes that most interactions are driven by the compaction of the linear genome into the nucleus [<xref ref-type="bibr" rid="CR25">25</xref>] which is largely uninteresting. Finally, bin pairs corresponding to high-abundance “peaks” in the two-dimensional interaction space can also be identified [<xref ref-type="bibr" rid="CR21">21</xref>]. This approach regards diffuse interactions as uninteresting and selects for sharp events instead.</p>
      <p>The choice of filtering approach for each analysis depends on the interactions of interest. For example, if the researcher is interested in looping interactions, the peak-based approach may be more useful. In this paper, the simple non-specific method was used for filtering in each real data set. This avoids strong assumptions regarding the definition of “interesting”, as non-specific ligation is obviously uninformative and should be removed. Specifically, filtering was performed to only retain bin pairs with average abundances that were five-fold higher than the estimated non-specific ligation rate. This removes the majority of low-abundance bin pairs that are dominated by non-specific ligation, as these are unlikely to be genuine (differential) interactions. Note that the choice of five-fold is arbitrary – other values can be used so long as the majority of low-abundance bin pairs are removed. Obviously, excessively high thresholds are not ideal as power will be lost from removal of genuine DIs.</p>
    </sec>
    <sec id="Sec8">
      <title>Normalization for library-specific biases</title>
      <p>Library-specific biases can be generated from uncontrolled differences in library preparation. This is particularly problematic for Hi-C data given the complexity of the protocol. Such technical differences may manifest as a trended difference between libraries, where the magnitude of the difference varies as a function of the average abundance (Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">a</xref>, <xref rid="Fig3" ref-type="fig">b</xref>). An artifactual trend may inflate the variance estimates or fold-changes between libraries, leading to loss of power or spurious differences, respectively. To avoid this, diffHic can perform non-linear normalization using a loess-based method that is adapted for low counts [<xref ref-type="bibr" rid="CR26">26</xref>]. Its application removes the trends in Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">c</xref> and <xref rid="Fig3" ref-type="fig">d</xref>, allowing the analysis to proceed safely to statistical modelling. Simple scaling methods [<xref ref-type="bibr" rid="CR27">27</xref>] are also available, in case the trend represents some interesting biological effect that should not be removed.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Trended biases with respect to the average abundance for real Hi-C data. Each point represents a 1 Mbp bin pair that is retained after filtering, with a loess trend (red) fitted across all points. The M-value is defined as the library size-adjusted log<sub>2</sub>-fold change between replicates for the ERG-treated cells in the Rickman et al. study [<xref ref-type="bibr" rid="CR5">5</xref>] (<bold>a</bold>, <bold>c</bold>) or the ESCs in the Dixon et al. study [<xref ref-type="bibr" rid="CR4">4</xref>] (<bold>b</bold>, <bold>d</bold>). Trends are shown before (<bold>a</bold>, <bold>b</bold>) and after (<bold>c</bold>, <bold>d</bold>) non-linear normalization in diffHic</p></caption><graphic xlink:href="12859_2015_683_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>Copy number variations (CNVs) may also be present between the genomes of cells in different groups. This complicates the detection of DIs, as changes in the interaction intensities due to changes in the copy number of the participating loci are unlikely to be interesting. To avoid detecting these changes, diffHic can eliminate CNV-driven differences in abundance between libraries. This is done by computing the marginal count for each bin (i.e., the number of reads mapped to that bin when Hi-C libraries are treated as single-end) as a proxy for the genomic coverage. The marginal log-fold change (log-FC) is computed between two libraries for each bin, representing the CNV for that bin. Note that this refers to the relative change in copy number between conditions for a given genomic region, not any CNV between regions. For example, chromosomes 10 and 13 are lost upon ERG overexpression, resulting in negative marginal log-FCs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Each bin pair is associated with two marginal log-FCs as well as its own log-FC between libraries. Multi-dimensional smoothing is applied to all bin pairs [<xref ref-type="bibr" rid="CR28">28</xref>], whereby a high-dimensional surface is fitted to the bin pair log-FC against the covariates, i.e., the two marginal log-FCs. If the fitted value of the surface changes with the marginal log-FCs across bin pairs, there is likely to be a CNV effect on the interaction intensities. For example, a systematic decrease in the bin pair log-FC with respect to decreasing marginal log-FCs indicates that some CNV-based bias is present in the Rickman et al. data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref>). Normalization of this bias can then be performed based on the fitted value for each bin pair. This results in the removal of the systematic decrease in the normalized bin pair log-FCs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig3" ref-type="fig">b</xref>). More details on this normalization procedure can be found in Section 2 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Effect of normalization for CNV-based biases. Each log<sub>2</sub>-FC is defined as that between one ERG library over one GFP library in the Rickman et al. data set [<xref ref-type="bibr" rid="CR5">5</xref>], adjusted for library size. To simplify visualization, the two marginal log-FCs for each bin pair are summed together. The depth of colour in the plot is proportional to the density of bin pairs, using only those retained after filtering. Results are shown before (<bold>a</bold>) and after (<bold>b</bold>) normalization for CNV-based biases</p></caption><graphic xlink:href="12859_2015_683_Fig4_HTML" id="MO4"/></fig>
</p>
      <p>The iterative correction strategy of Imakaev et al. [<xref ref-type="bibr" rid="CR2">2</xref>] is also implemented in diffHic. This method factorizes out genomic biases from the interaction intensities, yielding “true” contact probabilities that can be compared between interactions. This method facilitates comparisons between different interactions and can also be used to remove condition-specific genomic biases if these are considered to be important for a particular dataset.</p>
      <p>It should be stressed that these normalization strategies do not alter the counts directly. Rather, they compute offsets that are used in fitting generalized linear models (GLMs). For all downstream steps, the offsets computed by the loess-based method (to remove trended biases) were used for the Sofueva et al. data set, while those computed by multi-dimensional smoothing (to remove CNV biases) were used for the Rickman et al. and Dixon et al. data sets. This corrects for the presence of CNVs in the immortalized cell lines that were used in the latter analyses. In all cases, normalization was only applied to bin pairs that remained after filtering.</p>
    </sec>
    <sec id="Sec9">
      <title>Modelling complex experimental designs</title>
      <p>Counts for each bin pair are modelled using the GLM methods implemented in the edgeR package [<xref ref-type="bibr" rid="CR10">10</xref>]. Write <italic>y</italic>
<sub><italic>bi</italic></sub> for the count obtained for bin pair <italic>b</italic> in sample <italic>i</italic>. Taking into account the sequencing depth and treatment conditions applied to sample <italic>i</italic>, the expected value of the count can be represented by a log-linear predictor
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$E(y_{bi}) = \mu_{bi} = \sum\limits_{j=1}^{p} x_{ij}\beta_{bj} + o_{bi} $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bi</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bi</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bi</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2015_683_Equa.gif" position="anchor"/></alternatives></disp-formula> where the <italic>x</italic>
<sub><italic>ij</italic></sub> are elements of the design matrix specifying which experimental conditions are applied to each sample, and the <italic>β</italic>
<sub><italic>j</italic></sub> are unknown coefficients or log-fold changes representing the magnitude of the treatment effect(s). Users specify this log-linear predictor by defining the design matrix in diffHic. For the simplest case involving two experimental groups, the coefficients <italic>β</italic>
<sub><italic>b</italic>1</sub> and <italic>β</italic>
<sub><italic>b</italic>2</sub> can be used to represent the log-interaction intensities of the bin-pair in the two conditions. Alternatively, the model can be reparametrized so that <italic>β</italic>
<sub><italic>b</italic>2</sub> directly estimates the log-fold change in intensity between the two conditions.</p>
      <p>The values <italic>o</italic>
<sub><italic>bi</italic></sub> are offsets that incorporate the sequencing depth and other normalization factors. The offset <italic>o</italic>
<sub><italic>bi</italic></sub> is equal to the logarithm of the total number of unfiltered read pairs for sample <italic>i</italic>, modulated by any normalization factors computed by the methods described in the previous section. The offsets are computed automatically by the diffHic normalization functions and are usually invisible to users. They provide a flexible mathematical means by which bin-specific, condition-specific and sample-specific adjustments can be incorporated into the analysis.</p>
    </sec>
    <sec id="Sec10">
      <title>Modelling technical and biological variability</title>
      <p>The variability of the bin-pair count between replicate samples is modeled using the latest quasi-likelihood (QL) methods implemented in the edgeR package [<xref ref-type="bibr" rid="CR12">12</xref>]. The counts are assumed to follow quasi-negative-binomial distributions, i.e., they are negative binomial (NB) distributed with an additional technical overdispersion parameter. The variance of a count across biological replicates can be written as
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{var}(y_{bi}) = {\sigma_{b}^{2}}\left(\mu_{bi} + \phi_{b}\mu_{bi}^{2}\right) $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mtext>var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bi</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bi</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bi</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2015_683_Equb.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{b}}$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_683_IEq1.gif"/></alternatives></inline-formula> is the QL dispersion parameter and <italic>ϕ</italic>
<sub><italic>b</italic></sub> is the NB dispersion for that bin pair [<xref ref-type="bibr" rid="CR11">11</xref>]. The value of <italic>ϕ</italic>
<sub><italic>b</italic></sub> is estimated by fitting an abundance-dependent trend to the NB dispersions across all bin pairs [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Having estimated <italic>ϕ</italic>
<sub><italic>b</italic></sub>, the value of <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{b}}$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_683_IEq2.gif"/></alternatives></inline-formula> for each bin pair is estimated by applying a robust empirical Bayes procedure that squeezes individual estimators towards a global trend [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma _{b}^{2}}$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_683_IEq3.gif"/></alternatives></inline-formula> vary around unity and represent bin pair-specific variation relative to the average.</p>
      <p>In this model, the NB dispersions <italic>ϕ</italic>
<sub><italic>b</italic></sub> represent the level of biological variability between replicates. Specifically, the square root of <italic>ϕ</italic>
<sub><italic>b</italic></sub> is the biological coefficient of variation (BCV), i.e., the coefficient of variation with which the count for each bin pair varies between the replicate samples, averaged over bin pairs with similar abundances. It represents the coefficient of variation that would be observed in the counts if the sequencing depth was sufficiently large [<xref ref-type="bibr" rid="CR10">10</xref>]. A value of <italic>ϕ</italic>
<sub><italic>b</italic></sub>=0 would imply that only Poisson variation is present between replicates. This is typical of technical replicates formed from repeated sequencing of the same library [<xref ref-type="bibr" rid="CR31">31</xref>]. In practice, overdispersion is always present between biological replicates due to the additional variability of the biological system, and this manifests as <italic>ϕ</italic>
<sub><italic>b</italic></sub>&gt;0. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the estimated BCVs for the real data sets, which varies from about 5 to 15 % depending on the data set and the size of the counts. The decreasing trends with abundance are consistent with similar trends observed for RNA-seq and ChIP-seq data.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Trended dispersions with respect to the average abundance for real data. The trended NB dispersion was computed using edgeR for each 1 Mbp bin pair in each study, after filtering and non-linear normalization. This was done for the Rickman et al. [<xref ref-type="bibr" rid="CR5">5</xref>], Dixon et al. [<xref ref-type="bibr" rid="CR4">4</xref>] and Sofueva et al. [<xref ref-type="bibr" rid="CR16">16</xref>] data sets. The biological coefficient of variation is defined as the square-root of the NB dispersion, and is shown here for improved resolution of low dispersions</p></caption><graphic xlink:href="12859_2015_683_Fig5_HTML" id="MO5"/></fig>
</p>
    </sec>
    <sec id="Sec11">
      <title>Testing for significant differences</title>
      <p>The QL F-test in edgeR can be applied to test for significant differences between biological conditions. This yields a <italic>p</italic>-value for each bin pair, representing the evidence for differential interaction intensities. Correction for multiple testing is performed by controlling the false discovery rate (FDR) with the Benjamini-Hochberg method [<xref ref-type="bibr" rid="CR32">32</xref>]. Bin pairs corresponding to putative DIs are identified as those with corrected <italic>p</italic>-values below some FDR threshold. Several options are provided to visualize the results, including plaid plots and variations thereof, e.g., rotated plots. Some examples of DIs detected from the real data are visualized in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Validation of several DIs is also described in Section 3 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Plaid plots of putative DIs detected in real data. Each “pixel” represents a box in the interaction space with sides of 100 kbp, where the colour of the pixel is proportional to the number of read pairs counted into that box. Putative DIs were defined as 1 Mbp bin pairs detected at a FDR of 5 %. The red rectangle marks the interaction space corresponding to the detected bin pair, in the Rickman et al. data set [<xref ref-type="bibr" rid="CR5">5</xref>] between ERG- (<bold>a</bold>) and GFP-overexpressing prostate cells (<bold>b</bold>); in the Dixon et al. data set [<xref ref-type="bibr" rid="CR4">4</xref>] between ESCs (<bold>c</bold>) and lung cells (<bold>d</bold>); and in the Sofueva et al. data set [<xref ref-type="bibr" rid="CR16">16</xref>] between wild-type (<bold>e</bold>) and <italic>Rad21</italic>-knockout cells (<bold>f</bold>). All coordinates are shown in Mbp. Colours are also adjusted to account for differences in library size</p></caption><graphic xlink:href="12859_2015_683_Fig6_HTML" id="MO6"/></fig>
</p>
      <p>Results can also be consolidated for easier interpretation. If multiple analyses were performed with different bin sizes, smaller bin pairs can be nested within larger “parent” bin pairs. The <italic>p</italic>-values of both nested and parent bin pairs can be combined using Simes’ method [<xref ref-type="bibr" rid="CR33">33</xref>], yielding a single combined <italic>p</italic>-value that represents the overall evidence for a DI within the parent. The genomic coordinates of the parent bin pair can then be reported, along with the combined <italic>p</italic>-value and its FDR-adjusted value. This avoids redundant results from reporting multiple nested bin pairs individually. Similarly, adjacent bin pairs in the interaction space can be clustered together and reported as a single event to reduce redundancy. This is demonstrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 for a high-resolution analysis using 20 kbp bin pairs.</p>
    </sec>
    <sec id="Sec12">
      <title>Comparison with existing tools</title>
      <p>The presence of overdispersed counts suggests that simple statistical models based on the Poisson or binomial distributions [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] will underestimate the actual variance. If these models are used to detect DIs, the significance of any departures from the null hypothesis will be overestimated, i.e., the analysis will be liberal. For example, the HOMER software [<xref ref-type="bibr" rid="CR8">8</xref>] uses a binomial test to compare counts between samples. Its performance was compared to that of diffHic, using a simulated Hi-C data set with two replicates in each of two groups (see Section 4, Figure S3 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). diffHic controls the error rate for overdispersed counts whereas HOMER does not (Fig. <xref rid="Fig7" ref-type="fig">7</xref>
<xref rid="Fig7" ref-type="fig">a</xref>). One might attempt to mitigate the liberalness of HOMER by only using DIs that were detected in all replicate comparisons. However, this <italic>ad hoc</italic> workaround is not sufficient to restore error rate control (Fig. <xref rid="Fig7" ref-type="fig">7</xref>
<xref rid="Fig7" ref-type="fig">a</xref>). diffHic also detects more DIs than the two other methods (Fig. <xref rid="Fig7" ref-type="fig">7</xref>
<xref rid="Fig7" ref-type="fig">b</xref>), despite its relative conservativeness. These results indicate that the underlying statistical model must properly account for overdispersion to achieve optimal performance.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Performance of DI detection methods on simulated Hi-C data. Simulations of multiple groups were conducted with overdispersed counts between biological replicates in each group. Results are shown in terms of (<bold>a</bold>) the observed false discovery rate (FDR) and (<bold>b</bold>) the number of detected true DIs between groups. All values represent the mean of 5 simulation iterations, with standard errors shown as error bars. The nominal FDR threshold is shown as the red dashed line</p></caption><graphic xlink:href="12859_2015_683_Fig7_HTML" id="MO7"/></fig>
</p>
      <p>It should be mentioned that this is not the first time that edgeR has been used to analyze Hi-C data. The HiBrowse pipeline uses edgeR to detect DIs between groups in the presence of biological replicates [<xref ref-type="bibr" rid="CR7">7</xref>]. However, HiBrowse is limited in that it does not account for trended NB dispersions, complex experimental designs or non-linear normalization schemes. diffHic can naturally accommodate these aspects of the differential analysis, as it uses the latest GLM-based methods in edgeR [<xref ref-type="bibr" rid="CR10">10</xref>]. diffHic can also account for variable dispersions across bin pairs through the QL framework [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Finally, HiBrowse is a web tool that is somewhat inconvenient for high-throughput use, whereas diffHic can be easily run on local systems.</p>
    </sec>
    <sec id="Sec13">
      <title>Intended use and future directions</title>
      <p>The diffHic package should be used to detect DIs between two or more biological conditions in a Hi-C experiment. This provides an alternative to conventional analysis strategies that aim to detect “significant” interactions within each sample. The differential analysis may yield more relevant results when the aim of the study is to detect changes in chromatin organization. We anticipate that diffHic – and differential analyses in general – will complement the existing conventional methods, such that the most appropriate analysis strategy can be selected based on the research question. Future development of diffHic will aim to accommodate other types of chromatin conformation data, such as DNase Hi-C [<xref ref-type="bibr" rid="CR34">34</xref>] and Capture-C [<xref ref-type="bibr" rid="CR35">35</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="conclusion">
    <title>Conclusions</title>
    <p>The diffHic package provides a comprehensive and rigorous pipeline for detecting DIs from Hi-C data. Functions are available for alignment and processing; read counting with bin pairs; filtering of low-abundance bin pairs; normalization to remove trended and CNV-driven biases; statistical analyses to model biological variability and to test for significance; and visualization of detected features. A demonstration with real data provides some examples of the types of DIs that can be detected with this approach. Analyses of simulated data indicate that diffHic provides better performance than the existing HOMER software. These results suggest that diffHic may be a useful alternative to conventional methods for Hi-C data analysis, especially for researchers who want to conduct differential analyses.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p>The diffHic package is part of the open-source Bioconductor project [<xref ref-type="bibr" rid="CR13">13</xref>] and can be installed by following the standard Bioconductor installation procedures, as described at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/diffHic.html">http://www.bioconductor.org/packages/release/bioc/html/diffHic.html</ext-link>. diffHic is freely available under version 3 of the GNU General Public License. It is platform independent and can be used on any system that can run R and Bioconductor.</p>
    <p>All statistical analyses reported in this article were run on a Dell Precision laptop with an Intel i7 processor and 16 GB of RAM. Analyses were performed using CentOS 6.6, R v3.2.0, Bioconductor v3.1, diffHic v1.0.0 and edgeR v3.10.0. Read alignments were run separately on a Linux server using Bowtie2 v2.2.4. Excluding the Bowtie2 alignnments, all analyses ran in less than an hour using one core.</p>
    <p><bold>Project name:</bold> diffHic<bold>Project home page:</bold>
<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/diffHic.html">http://www.bioconductor.org/packages/release/bioc/html/diffHic.html</ext-link>
<bold>Operating systems:</bold> UNIX, Windows, MacOS Programming language: R version 3.2.0 or higher, C++ Other requirements: diffHic depends on the Bioconductor packages GenomicRanges, Rsamtools, Biostrings, BSgenome, IRanges, S4Vectors, GenomeInfoDb, BiocGenerics, rhdf5, edgeR, limma, csaw, locfit, methods.<bold>License:</bold> GPL-3<bold>Any restrictions to use by non-academics:</bold> none</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2015_683_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Supplementary materials for the paper.</bold> This PDF file contains a description of the simulation to assess chimeric read alignment strategies (Section 1), comments on the normalization procedure for CNV-based biases (Section 2), some additional validation and high-resolution results and for the real data analyses (Section 3), and a description of the simulation to compare diffHic with HOMER for overdispersed count data (Section 4). Several tables and figures are also included. (PDF 367 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>ATLL wrote the software, performed the analyses and drafted the manuscript. GKS conceived the study, provided guidance and statistical advice, and helped draft the manuscript. Both authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>ATLL was funded by the University of Melbourne (Elizabeth and Vernon Puzey scholarship). GKS was funded by the National Health and Medical Research Council (Program Grant 1054618 and Fellowship). This study was undertaken with Victorian State Government Operational Infrastructure Support and Australian Government NHMRC IRIIS.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5950</issue>
        <fpage>289</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic modeling of Hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <issue>11</issue>
        <fpage>1059</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.947</pub-id>
        <pub-id pub-id-type="pmid">22001755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7398</issue>
        <fpage>376</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rickman</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Soong</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mosquera</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Dlabal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Oncogene-mediated alterations in chromatin conformation</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>23</issue>
        <fpage>9083</fpage>
        <lpage>088</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1112570109</pub-id>
        <pub-id pub-id-type="pmid">22615383</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seitan</surname>
            <given-names>VC</given-names>
          </name>
          <name>
            <surname>Faure</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Ing-Simmons</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cohesin-based chromatin interactions enable regulated gene expression within preexisting architectural compartments</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>12</issue>
        <fpage>2066</fpage>
        <lpage>077</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.161620.113</pub-id>
        <pub-id pub-id-type="pmid">24002784</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulsen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sandve</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Gundersen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lien</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Trengereid</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hovig</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>HiBrowse: multi-purpose statistical analysis of genome-wide chromatin 3D organization</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>11</issue>
        <fpage>1620</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu082</pub-id>
        <pub-id pub-id-type="pmid">24511080</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Laslo</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>4</issue>
        <fpage>576</fpage>
        <lpage>89</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor SRNA-Seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>10</issue>
        <fpage>4288</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lund</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Nettleton</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Detecting differential expression in RNA-sequence data using quasi-likelihood with shrunken dispersion estimates</article-title>
        <source>Stat Appl Genet Mol Biol.</source>
        <year>2012</year>
        <volume>11</volume>
        <issue>5</issue>
        <fpage>Article 8</fpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Lun ATL, Chen Y, Smyth GK. It’s DE-licious: a recipe for differential expression analyses of RNA-seq experiments using quasi-likelihood methods in edgeR. Technical report, Bioinformatics Division, Walter and Eliza Hall Institute of Medical Research, Melbourne. 2015. <ext-link ext-link-type="uri" xlink:href="http://www.statsci.org/smyth/pubs/QLedgeRPreprint.pdf">http://www.statsci.org/smyth/pubs/QLedgeRPreprint.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <collab>Carvalho, BS, et al.</collab>
        </person-group>
        <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>115</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id>
        <pub-id pub-id-type="pmid">25633503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <mixed-citation publication-type="other">Fischer B, Pau G. Rhdf5: HDF5 interface to R. 2015. R package version 2.12.0. <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/rhdf5.html">http://www.bioconductor.org/packages/release/bioc/html/rhdf5.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sofueva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Georgopoulou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vietri Rudan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mira-Bontenbal</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cohesin-mediated interactions organize chromosomal domain architecture</article-title>
        <source>EMBO J</source>
        <year>2013</year>
        <volume>32</volume>
        <issue>24</issue>
        <fpage>3119</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1038/emboj.2013.237</pub-id>
        <pub-id pub-id-type="pmid">24185899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>
        <source>EMBnet J</source>
        <year>2011</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>AY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-resolution map of the three-dimensional chromatin interactome in human cells</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>503</volume>
        <issue>7475</issue>
        <fpage>290</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">24141950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belton</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Gibcus</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Hi-C: a comprehensive technique to capture the conformation of genomes</article-title>
        <source>Methods</source>
        <year>2012</year>
        <volume>58</volume>
        <issue>3</issue>
        <fpage>268</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2012.05.001</pub-id>
        <pub-id pub-id-type="pmid">22652625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <issue>7</issue>
        <fpage>1665</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>De novo detection of differentially bound regions for ChIP-seq data using peaks and windows: controlling error rates correctly</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>95</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourgon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Independent filtering increases detection power for high-throughput experiments</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2010</year>
        <volume>107</volume>
        <issue>21</issue>
        <fpage>9546</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0914005107</pub-id>
        <pub-id pub-id-type="pmid">20460310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bickmore</surname>
            <given-names>WA</given-names>
          </name>
        </person-group>
        <article-title>The spatial organization of the human genome</article-title>
        <source>Annu Rev Genomics Hum Genet</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>67</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-091212-153515</pub-id>
        <pub-id pub-id-type="pmid">23875797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mansson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miyazaki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miyazaki</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global changes in the nuclear positioning of genes and intra- and interdomain genomic interactions that orchestrate B cell fate</article-title>
        <source>Nat Immunol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>1196</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1038/ni.2432</pub-id>
        <pub-id pub-id-type="pmid">23064439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">Lun AT, Smyth GK. csaw: detection of differentially bound regions in ChIP-seq data with sliding windows, with methods for normalization and proper FDR control. R package version 1.2.1.<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/csaw.html">http://bioconductor.org/packages/release/bioc/html/csaw.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <mixed-citation publication-type="other">Loader C. Locfit: local regression, likelihood and density estimation. 2013. R package version 1.5-9.1. <ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=locfit">http://CRAN.R-project.org/package=locfit</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nettleton</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of complex RNA-seq experiments using edgeR</article-title>
        <source>Statistical analysis of next generation sequence data</source>
        <year>2014</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Majewski</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <source>Empirical Bayes in the presence of exceptional cases, with application to microarray data</source>
        <year>2015</year>
        <publisher-loc>Australia</publisher-loc>
        <publisher-name>Technical report, Bioinformatics Division, Walter and Eliza Hall Institute of Medical Research, Melbourne</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Mane</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>9</issue>
        <fpage>1509</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.079558.108</pub-id>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J Royal Stat Soc B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simes</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>An improved Bonferroni procedure for multiple tests of significance</article-title>
        <source>Biometrika</source>
        <year>1986</year>
        <volume>73</volume>
        <issue>3</issue>
        <fpage>751</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/73.3.751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gulsoy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fine-scale chromatin interaction maps reveal the cis-regulatory landscape of human lincRNA genes</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>71</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3205</pub-id>
        <pub-id pub-id-type="pmid">25437436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McGowan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hay</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Giannoulatou</surname>
            <given-names>E</given-names>
          </name>
          <collab>Lynch, M, et al.</collab>
        </person-group>
        <article-title>Analysis of hundreds of cis-regulatory landscapes at high resolution in a single, high-throughput experiment</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <issue>2</issue>
        <fpage>205</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2871</pub-id>
        <pub-id pub-id-type="pmid">24413732</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
