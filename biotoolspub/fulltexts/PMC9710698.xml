<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9710698</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbac052</article-id>
    <article-id pub-id-type="publisher-id">vbac052</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Immunoinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhenoComb: a discovery tool to assess complex phenotypes in high-dimensional single-cell datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9640-299X</contrib-id>
        <name>
          <surname>Burke</surname>
          <given-names>Paulo E P</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strange</surname>
          <given-names>Ann</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1037-4172</contrib-id>
        <name>
          <surname>Monk</surname>
          <given-names>Emily</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thompson</surname>
          <given-names>Brian</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amato</surname>
          <given-names>Carol M</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Woods</surname>
          <given-names>David M</given-names>
        </name>
        <aff><institution>Division of Medical Oncology, Department of Medicine, University of Colorado School of Medicine</institution>, Aurora, CO 80045, <country country="US">USA</country></aff>
        <xref rid="vbac052-cor1" ref-type="corresp"/>
        <!--david.m.woods@cuanschutz.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kuijjer</surname>
          <given-names>Marieke Lydia</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbac052-cor1">To whom correspondence should be addressed. <email>david.m.woods@cuanschutz.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-03">
      <day>03</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>03</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <issue>1</issue>
    <elocation-id>vbac052</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbac052.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>High-dimensional cytometry assays can simultaneously measure dozens of markers, enabling the investigation of complex phenotypes. However, as manual gating relies on previous biological knowledge, few marker combinations are often assessed. This results in complex phenotypes with the potential for biological relevance being overlooked. Here, we present PhenoComb, an R package that allows agnostic exploration of phenotypes by assessing all combinations of markers. PhenoComb uses signal intensity thresholds to assign markers to discrete states (e.g. negative, low, high) and then counts the number of cells per sample from all possible marker combinations in a memory-safe manner. Time and disk space are the only constraints on the number of markers evaluated. PhenoComb also provides several approaches to perform statistical comparisons, evaluate the relevance of phenotypes and assess the independence of identified phenotypes. PhenoComb allows users to guide analysis by adjusting several function arguments, such as identifying parent populations of interest, filtering of low-frequency populations and defining a maximum complexity of phenotypes to evaluate. We have designed PhenoComb to be compatible with a local computer or server-based use.</p>
      </sec>
      <sec id="s3">
        <title>Results</title>
        <p>In testing of PhenoComb’s performance on synthetic datasets, computation on 16 markers was completed in the scale of minutes and up to 26 markers in hours. We applied PhenoComb to two publicly available datasets: an HIV flow cytometry dataset (12 markers and 421 samples) and the COVIDome CyTOF dataset (40 markers and 99 samples). In the HIV dataset, PhenoComb identified immune phenotypes associated with HIV seroconversion, including those highlighted in the original publication. In the COVID dataset, we identified several immune phenotypes with altered frequencies in infected individuals relative to healthy individuals. Collectively, PhenoComb represents a powerful discovery tool for agnostically assessing high-dimensional single-cell data.</p>
      </sec>
      <sec id="s4">
        <title>Availability and implementation</title>
        <p>The PhenoComb R package can be downloaded from <ext-link xlink:href="https://github.com/SciOmicsLab/PhenoComb" ext-link-type="uri">https://github.com/SciOmicsLab/PhenoComb</ext-link>.</p>
      </sec>
      <sec id="s6">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Department of Dermatology and the Cancer Center at the University of Colorado</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Flow and mass cytometry assays are able to measure dozens of markers in hundreds of thousands of cells per sample at single-cell resolution (<xref rid="vbac052-B6" ref-type="bibr">Chattopadhyay <italic toggle="yes">et al.</italic>, 2008</xref>), enabling the characterization of complex phenotypes and powering new insights. However, traditional, hypothesis-driven, manual gating analysis of cytometry data relies on prior knowledge of the researcher, enabling only incremental advances. In contrast, agnostic approaches to the analysis of cytometry data are powerful discovery tools that more fully utilize the high-dimensional data and are not limited to <italic toggle="yes">a priori</italic> hypotheses. However, many agnostic approaches, such as dimension reduction [e.g. Uniform Manifold Approximation and Projection (UMAP) (<xref rid="vbac052-B3" ref-type="bibr">Becht <italic toggle="yes">et al.</italic>, 2019</xref>)] and clustering tools [e.g. Phenograph (<xref rid="vbac052-B7" ref-type="bibr">Levine <italic toggle="yes">et al.</italic>, 2015</xref>)], fail to capture discrete phenotypes, limiting interpretability, the ability to do statistical analysis and downstream isolation of cells (e.g. flow sorting) for future experiments.</p>
    <p>An alternative agnostic approach is to exhaustively identify discrete phenotypes in the flow data by assigning discrete states for each of the measured markers and counting the cells that have the combination of marker states of a given phenotype. For example, if two markers (A and B) are measured and discretized into positive (+) and negative (−) states, an exhaustive combination of markers and states would result in the following phenotypes: A+B+, A+B−, A−B+ and A−B−. Additionally, the partial combinations of markers could also be considered: A+, A−, B+ and B−. By visiting all possible marker/state combinations, the cell counts could be then used to assess which phenotypes are relevant given a comparison of interest.</p>
    <p>Similar approaches were shown to be effective, unveiling novel phenotypes in the context of cancer therapy (<xref rid="vbac052-B12" ref-type="bibr">Woods <italic toggle="yes">et al.</italic>, 2020</xref>) and infectious diseases (<xref rid="vbac052-B1" ref-type="bibr">Aghaeepour <italic toggle="yes">et al.</italic>, 2012</xref>). However, exhaustive exploration in the phenotypic landscape can rapidly get computationally expensive to perform as the number of markers increases. This is because the number of possible phenotypes increases exponentially, such as <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, with the number of markers (<italic toggle="yes">m</italic>) and states (<italic toggle="yes">n</italic>). Previous approaches could only tackle a limited number of markers, had long run times, and are no longer supported/available. Thus, new and more powerful bioinformatic tools are needed to perform this kind of analysis.</p>
    <p>Here, we present PhenoComb, an efficient tool for the exploration of complex phenotypic landscapes. It is available as an R package and implements methods to (i) convert continuous scale data for marker expression into discrete states, (ii) count cells for all possible phenotypes present in the input dataset, (iii) perform a variety of statistical comparisons to evaluate the relevance of those phenotypes based on cell frequency of the samples and (iv) identify relevant phenotypes that are independent from each other. PhenoComb takes advantage of parallel computing and is implemented in a memory-safe manner, overcoming limitations on the number of markers from previous approaches. It can process datasets with virtually any number of markers, only being limited by computing time and disk space for the outputs.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Package implementation and features</title>
      <p>PhenoComb is available as an R package with some functions implemented in C++ for efficiency, but only available through R’s interface. There are two coding workflows available that implement the analysis illustrated in <xref rid="vbac052-F1" ref-type="fig">Figure 1</xref>: a local workflow, designed for ease of use, holding all objects in memory, being easily accessible for the user; and a server workflow, designed to handle large datasets which cannot be held in memory. In both implementations, PhenoComb takes advantage of parallel computing to increase performance where steps of the analysis are mutually independent. Tutorials on how to install and use PhenoComb are available at the GitHub repository page: <ext-link xlink:href="https://github.com/SciOmicsLab/PhenoComb" ext-link-type="uri">https://github.com/SciOmicsLab/PhenoComb</ext-link>.</p>
      <fig position="float" id="vbac052-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>PhenoComb analysis outline. (<bold>a</bold>) Given a set of markers, all possible marker state combinations with lengths from one to the number of markers are generated, each one being considered a unique phenotype. Cells matching each phenotype are counted for each sample. A statistical test is performed comparing phenotype frequencies between two groups of samples and the ones meeting a defined significance threshold are selected. In the illustrated hypothetical, selected phenotypes are shown with a darker color. (<bold>b</bold>) A phenotypic similarity score (ps) is computed between all selected phenotypes and represented as a network. The thickness of the edges indicates their similarity. (<bold>c</bold>) The network has its edges filtered by several ps thresholds and a clustering algorithm is applied for each one. For each cluster identified, the phenotype with the highest log<sub>2</sub>fold-change is selected as the representative one. Clusters are represented by different colors and representative phenotypes are highlighted with a green border. (<bold>d</bold>) A confidence score for each phenotype is then computed as the frequency of its selection as a representative throughout the networks</p>
        </caption>
        <graphic xlink:href="vbac052f1" position="float"/>
      </fig>
      <p>The package also provides several ways to filter data and tune the analysis. For example, cells can be filtered out if intensity values are over a certain threshold, called Out of Bound, to reduce noise. When counting cells for all phenotypes, the user can filter phenotypes by the minimum number of cells on a fraction of samples, by parent phenotype, and also set the maximum phenotype length desired. For the statistical tests, the output can be filtered by parent population and <italic toggle="yes">P</italic>-value. PhenoComb also provides some convenience tools to deal with big outputs, such as finding specific phenotypes in files.</p>
    </sec>
    <sec>
      <title>2.2 Combinatorial phenotypes computation</title>
      <p>Given a dataset with <italic toggle="yes">m</italic> markers’ signal intensity measured, each continuous measurement can be discretized into a finite number <italic toggle="yes">n</italic> of states through <italic toggle="yes">n−</italic>1 provided thresholds obtained by manual gating. These states can be called, for example, negative (−) and positive (+) if one considers only two states, or negative (−), low (+) and high (++) if three states are considered. The number of discrete states can be any number ≥2, and there can be a different number of states for each marker.</p>
      <p>Considering that all <italic toggle="yes">m</italic> markers can be discretized into <italic toggle="yes">n</italic> states, there are <italic toggle="yes">n<sup>m</sup></italic> possible combinations of marker states. Each different combination will henceforth be referred to as phenotypes. Additionally, we can consider phenotypes that are neutral for one or more markers, increasing the total number of possible phenotypes to <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>To illustrate the combinations between markers and states, <xref rid="vbac052-F1" ref-type="fig">Figure 1a</xref> shows all possible combinations between three markers (A, B and C) each one having two possible states (− and +). Each row indicates the number of markers for the phenotype, henceforth called length, as a consequence of considering phenotypes neutral to certain markers.</p>
      <p>PhenoComb provides a method to count the number of cells in the dataset that have a given phenotype for all possible phenotypes across all samples. This is done efficiently by first counting cells for all full-length phenotypes present in the data, and then generating all other phenotypes with neutral states by summing up the cells already counted in the full-length ones. Since the computation of each neutral-state combination is independent from each other, this step can take advantage of parallel computation to increase performance.</p>
    </sec>
    <sec>
      <title>2.3 Evaluation of generated phenotypes</title>
      <p>The statistical evaluation of a phenotype based on its cell counts across samples can be done in several ways. PhenoComb provides three types of statistical comparisons: two group comparison using the Mann–Whitney <italic toggle="yes">U</italic>-test, correlation with a given variable using Kendall’s rank correlation, and a time-to-event (survival) analysis test using Cox Proportional Hazards Model. Since the total number of cells can vary across samples, all statistical tests are performed on cell frequencies, being the cell count of the phenotype divided by the total number of cells the sample contains. If phenotypes are filtered for a given parent phenotype, the frequencies will be calculated based on the parent phenotype’s cell count instead of the total number of cells. The phenotypes can then be filtered by respective <italic toggle="yes">P</italic>-values as represented in bold font in <xref rid="vbac052-F1" ref-type="fig">Figure 1a</xref>.</p>
      <p>While an exhaustive evaluation of marker combinations can create a large number of phenotypes, these phenotypes are not independent of one another. For example, in a two-marker dataset, the phenotype A+ is related to the phenotypes A−, A+B− and A+B+. Given the interrelatedness of phenotypes, when performing statistical comparisons, the type I error rate (i.e. false positives) is not a product of the number of comparisons. Therefore, traditional methods for correcting for multiple comparisons are not appropriate. However, an inflated type I error rate (i.e. false positives) will still occur. PhenoComb does not adjust for multiple comparisons and should be used with that caveat.</p>
    </sec>
    <sec>
      <title>2.4 Identification of independent phenotypes</title>
      <p>As mentioned in the previous section, phenotype cell counts can be dependent on each other. In large datasets, it can be hard to distinguish the phenotypes that are the actual drivers of statistical/biological relevance. PhenoComb provides a network-based algorithm aimed at finding the driver phenotypes.</p>
      <p>Given a number <italic toggle="yes">P</italic> of phenotypes, a phenotypic similarity (<italic toggle="yes">ps</italic>) score matrix <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is calculated based on the number of markers each pair of phenotypes share, such as:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>ℓ</mml:mo></mml:math></inline-formula> is the length of a given phenotype. The similarity matrix <italic toggle="yes">S</italic> can be understood as a symmetric adjacency matrix, thus representing an undirected network where each node is a phenotype, and the links between them are weighted by the <italic toggle="yes">ps</italic> score given in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. An example of such network is depicted in <xref rid="vbac052-F1" ref-type="fig">Figure 1b</xref>.</p>
      <p>Next, <italic toggle="yes">n</italic> sub-networks are generated by pruning the original network from its edges by applying a set increasing thresholds <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mo>*</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The pruning is performed by applying the following function to the matrix <italic toggle="yes">S</italic>:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>For each sub-network, we apply the Louvain clustering algorithm (<xref rid="vbac052-B4" ref-type="bibr">Blondel <italic toggle="yes">et al.</italic>, 2008</xref>), which automatically finds the optimal number of clusters and labels the nodes accordingly, as illustrated in <xref rid="vbac052-F1" ref-type="fig">Figure 1c</xref>. A representative phenotype is then selected from each cluster by ranking them according to the absolute value from the statistic provided by the chosen comparison. For group comparison, the ranking value used is the <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mtext>effect size</mml:mtext><mml:mo>|</mml:mo><mml:mo>*</mml:mo><mml:mo>|</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>fold change</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>. We use this formula to avoid artifacts such as only one sample with an unexpected high frequency driving the fold change. For the correlation test, the correlation metric is used. The Cox Proportional Hazards coefficient is used if this method was chosen. All values used for ranking are normalized for the range. Finally, the representative phenotypes are ranked by a confidence score based on the frequency that the given phenotype shows up as representative in the <italic toggle="yes">n</italic> sub-networks, as depicted in <xref rid="vbac052-F1" ref-type="fig">Figure 1d</xref>.</p>
    </sec>
    <sec>
      <title>2.5 Datasets</title>
      <sec>
        <title>2.5.1 Synthetic datasets</title>
        <p>To better evaluate PhenoComb’s performance, we generated a set of synthetic datasets simulating several combinations of number of markers, maximum phenotype length, number of cells and number of samples. Since they were only used to test the performance of the combinatorial phenotypes computation, all full-length phenotypes for all samples have a similar number of cells. The code to generate such datasets is available on the aforementioned GitHub repository. All computations were performed on a 28-core, 56-thread, Intel Xeon W-3275M 2.50 GHz with 1 TB of memory. However, the memory requirements for PhenoComb are approximately four times the size of the fcs input file.</p>
      </sec>
      <sec>
        <title>2.5.2 The HIV dataset</title>
        <p>This dataset, previously described in <xref rid="vbac052-B11" ref-type="bibr">Weintrob <italic toggle="yes">et al.</italic> (2008)</xref>, was obtained from FlowRespository.org, flow repository ID FR-FCM-ZZZK. The dataset consisted of 466 peripheral blood mononuclear cells (PBMC) samples obtained from human immunodeficiency virus (HIV)-infected military personnel that were evaluated by flow cytometry for 12 markers (CD3, CD4, CD8, CD45RO, CD27, CD28, CD57, CCR5, CCR7, CD127, Ki67 and CD14) and a viability dye. Samples contained a mean of 393 315 events. Individual sample fcs files were gated to exclude debris (foward scatter area versus side scatter area). Samples with &lt;5000 cells were not considered, leaving a total of 421 samples to be analyzed. Dead cells and CD14+ cells were removed through a dump channel gate. Samples were then concatenated and each marker gated as in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>. These analyses were performed on FlowJo 10.7 software. The fluorescence intensity coordinates of gates (i.e. threshold differentiating positive and negative populations for each marker) were recorded in a csv file for reference in PhenoComb function arguments.</p>
      </sec>
      <sec>
        <title>2.5.3 The COVIDome dataset</title>
        <p>This dataset, previously described in <xref rid="vbac052-B10" ref-type="bibr">Sullivan <italic toggle="yes">et al.</italic> (2021)</xref>, was also obtained from FlowRespository.org, flow repository ID FR-FCM-Z367. The dataset consisted of 99 PBMC samples obtained from COVID-infected individuals (<italic toggle="yes">n</italic> = 69) and COVID-negative individuals (<italic toggle="yes">n</italic> = 30), which were evaluated for 40 markers by CyTOF mass cytometry. Samples contained a mean of 390 059 events. The publicly available fcs files were previously gated to remove anomalies and dead cells. Sample fcs files were concatenated, each marker gated as in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, and the intensity coordinates of gates were recorded in a csv file.</p>
      </sec>
    </sec>
    <sec>
      <title>2.6 flowType comparison</title>
      <p>flowType (<xref rid="vbac052-B1" ref-type="bibr">Aghaeepour <italic toggle="yes">et al.</italic>, 2012</xref>) version 2.25.0 was installed using R version 4.0.5 with BiocManager version 3.11. The aforementioned synthetic dataset was assessed by flowType for marker combinations of length 4 through 11, each being repeated three times and the mean runtime assessed.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Performance benchmark</title>
      <p>To evaluate PhenoComb’s performance, we simulated a set of 48 synthetic datasets considering different numbers of markers, cells, samples, maximum phenotype length and number of threads used to compute. These datasets represent the worst-case scenario for each configuration of parameters since all possible combinations of full-length phenotypes will be present in them. That is unlikely to happen in real datasets because of biological restrictions and limited number of sampled cells. To illustrate the magnitude of the analysis, <xref rid="vbac052-F2" ref-type="fig">Figure 2a</xref> shows the number of expected computed phenotypes in the synthetic datasets for a given number of markers. It shows the exponential nature of the combinatorial problem. Also, the number of phenotypes in HIV and COVIDome datasets (discussed later) is shown in purple, confirming that the number of phenotypes present in real datasets is lower than in the theoretical ones, despite some markers in the real datasets having more than two states.</p>
      <fig position="float" id="vbac052-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Performance benchmark. Computing times for the combinatorial phenotype generation step are shown in green for synthetic datasets and in purple for the HIV and COVIDome datasets. (<bold>a</bold>) The number of phenotypes generated by increasing numbers of markers. (<bold>b</bold>) The amount of time (h) to analyze various marker sizes including a comparison to flowType. (<bold>c</bold>) The amount of time (s) to analyze various maximum phenotype lengths. (<bold>d</bold>) The amount of time (s) to analyze various number of cells. (<bold>e</bold>) The amount of time (s) to analyze various numbers of samples. (<bold>f</bold>) Computing time (s) reduction by increasing the number of threads</p>
        </caption>
        <graphic xlink:href="vbac052f2" position="float"/>
      </fig>
      <p>For each of the experiments shown in <xref rid="vbac052-F2" ref-type="fig">Figure 2b–f</xref>, we varied one parameter and fixed the remaining parameters as follow: 15 markers, 40 000 cells per sample, 10 samples, 50 threads and the maximum phenotype length as the number of markers unless otherwise stated. All datasets were assessed with two states for each marker. All analysis was performed using the server workflow since the local workflow only allows the processing of small datasets, which are usually computed in a matter of a few minutes. The experiments shown in <xref rid="vbac052-F2" ref-type="fig">Figure 2</xref> account for the combinatorial phenotype counting step, which is the most impacted by the number of markers and states.</p>
      <p>The parameter that impacts PhenoComb’s performance the most is the number of markers present in the dataset. This was expected since the number of possible phenotypes grows exponentially with the number of markers. <xref rid="vbac052-F2" ref-type="fig">Figure 2b</xref> shows that the computational complexity growth is super-exponential.</p>
      <p>PhenoComb allows a decrease in the maximum length of phenotypes to mitigate this problem when very large phenotypes are not of interest. This feature can also decrease exponentially the computation time as shown in <xref rid="vbac052-F2" ref-type="fig">Figure 2c</xref>. Nevertheless, computation times for real datasets are almost always lower than the synthetic ones because of the lower number of present phenotypes, even though the number of samples and the cell counts per sample were higher in the real datasets used versus the synthetic datasets. The only case where the real dataset is higher than the synthetic is for the HIV data because of its high number of samples (<italic toggle="yes">n</italic> = 421).</p>
      <p>The total number of cells in the dataset had little impact on the cell counting process once they are all transformed to single numbers when calculating the full-length phenotypes, a relatively computationally inexpensive process (<xref rid="vbac052-F2" ref-type="fig">Fig. 2d</xref>). The number of samples present in the dataset increase linearly the time to compute the phenotypes as shown in <xref rid="vbac052-F2" ref-type="fig">Figure 2e</xref>. Lastly, PhenoComb can take advantage of parallel computing, reducing almost exponentially the computing time as the number of threads used is increased (<xref rid="vbac052-F2" ref-type="fig">Fig. 2f</xref>).</p>
      <p>To assess the relative performance of PhenoComb, flowType was used to assess the synthetic datasets. As before, 10 samples with 40 000 cells each were assessed using 50 threads. Marker combinations of length 4 through 15 were assessed. The mean runtimes from three independent runs for each marker length are shown by the orange points in <xref rid="vbac052-F2" ref-type="fig">Figure 2b</xref>. Also, it’s worth noticing that the times measured for flowType do not account writing results to a file, which are included for PhenoComb.</p>
    </sec>
    <sec>
      <title>3.2 Validation of phenotypes identified in previous approaches</title>
      <p>To test PhenoComb’s ability to identify biologically meaningful phenotypes, we used a previously published, publicly available flow cytometry dataset evaluating T-cell immunophenotypes associated with HIV seroconversion (<xref rid="vbac052-B1" ref-type="bibr">Aghaeepour <italic toggle="yes">et al.</italic>, 2012</xref>). PhenoComb was utilized to discretize markers and assess all marker combinations. Marker combinations for CD3+ population were then assessed for associations with survival time following seroconversion. A total of 9754 phenotypes with an unadjusted <italic toggle="yes">P</italic>-value of &lt;<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mn>5.0</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> were identified. We specifically focused on phenotypes identified in the original publication (<xref rid="vbac052-T1" ref-type="table">Table 1</xref>). Of the three phenotypes highlighted in the original publication as being significantly correlated with time to seroconversion, PhenoComb identified two as also statistically significant.</p>
      <table-wrap position="float" id="vbac052-T1">
        <label>Table 1.</label>
        <caption>
          <p>HIV phenotype evaluation comparison</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">T-cell immunophenotype</th>
              <th align="center" rowspan="1" colspan="1">Originally reported <italic toggle="yes">P</italic>-value</th>
              <th align="center" rowspan="1" colspan="1">PhenoComb <italic toggle="yes">P</italic>-value</th>
              <th align="center" rowspan="1" colspan="1">Orginally report CPHR</th>
              <th align="center" rowspan="1" colspan="1">PhenoComb CPHR</th>
              <th align="center" rowspan="1" colspan="1">Originally reported cell frequency</th>
              <th align="center" rowspan="1" colspan="1">PhenoComb cell frequency</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Ki67+CD127−</td>
              <td rowspan="1" colspan="1">2.70E−08</td>
              <td rowspan="1" colspan="1">4.62E−15</td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">1.00E−02</td>
              <td rowspan="1" colspan="1">5.40E−03</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45RO−CD8+CD57+CCR5−CD27+CCR7−CD127−</td>
              <td rowspan="1" colspan="1">3.10E−07</td>
              <td rowspan="1" colspan="1">1.55E−01</td>
              <td rowspan="1" colspan="1">633</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">6.00E−04</td>
              <td rowspan="1" colspan="1">4.10E−03</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD28−CD45RO+CD57−</td>
              <td rowspan="1" colspan="1">5.60E−07</td>
              <td rowspan="1" colspan="1">1.55E−06</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">5.00E−02</td>
              <td rowspan="1" colspan="1">2.72E−02</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>CPHR, Cox Proporional Hazards Model coefficient.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We also benchmarked PhenoComb’s performance in assessing this dataset. For the 12 markers assessed, a total of 220 170 phenotypes were identified using a minimum cell count threshold of 100 in 50% of samples out of a theoretical maximum of 531 440 phenotypes (<xref rid="vbac052-F2" ref-type="fig">Fig. 2a</xref>). Computation time was 2.35 min (<xref rid="vbac052-F2" ref-type="fig">Fig. 2b</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Identification of phenotypes associated with COVID infection</title>
      <p>We next utilized PhenoComb on a publicly available CyTOF dataset. PhenoComb was utilized to discretize markers, assess combinations and compare frequencies between COVID-positive and -negative samples by Mann–Whitney <italic toggle="yes">U</italic> tests. Given the computational time needed to assess 40 markers with multiple discrete states, we divided the dataset into four lineages and assessed a subset of markers in each independently (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). These lineages were: CD45+CD3+ (T cells, 26 additional markers assessed), CD45+CD19+ (B cells, 22 markers), CD45+CD56+ (natural killer (NK) cells, 16 markers), CD45+CD14+ (monocytes, 16 markers) and CD45+CD3−CD19−CD56−CD14− (other immune cells, 18 markers). The following number of phenotypes with an unadjusted <italic toggle="yes">P</italic>-value of ≤0.0005 were identified for the corresponding parent lineage: CD45+CD3+, 437 751 153 phenotypes; CD45+CD19+, 46 171 572 phenotypes; CD45+CD56+, 87 828 phenotypes; CD45+CD14+, 588 011 phenotypes; and CD45+CD3−CD19−CD56−CD14−, 12 625 878 phenotypes. After filtering for independent phenotypes, the following number of phenotypes were identified for each parent lineage: CD45+CD3+, 8 phenotypes; CD45+CD19+, 13 phenotypes; CD45+CD56+, 21 phenotypes; CD45+CD14+, 15 phenotypes; and CD45+CD3−CD19−CD56−CD14−, 5 phenotypes.</p>
      <p>Phenotypes with a confidence score of 1 are reported in <xref rid="vbac052-T2" ref-type="table">Table 2</xref> and graphs of the data are shown in <xref rid="vbac052-F3" ref-type="fig">Figure 3</xref>. Both the CD45+CD3−CD19−CD56−CD14− and the CD3+CD19+ population had elevated frequencies of cells expressing the proliferation marker Ki67 and high levels of the activation marker/ectoenzyme CD38 (<xref rid="vbac052-B8" ref-type="bibr">Quarona <italic toggle="yes">et al.</italic>, 2013</xref>) in COVID-positive samples (<xref rid="vbac052-F3" ref-type="fig">Fig. 3a–c</xref>). In T cells, decreased CD4 cells expressing CD45RA and negative for expression of CCR7 and CD25 were observed in COVID-positive samples relative to COVID-negative (<xref rid="vbac052-F3" ref-type="fig">Fig. 3d</xref>). In NK cells, elevated frequencies of cells expressing the proliferation marker Ki67 were seen in COVID-positive samples (<xref rid="vbac052-F3" ref-type="fig">Fig. 3e</xref>), and elevated frequencies of cells negative for Ki67 were seen in COVID-negative samples (<xref rid="vbac052-F3" ref-type="fig">Fig. 3f</xref>). Monocytes also had elevated frequencies of Ki67-expressing cells in COVID-positive samples (<xref rid="vbac052-F3" ref-type="fig">Fig. 3g</xref>). Increases in frequencies of the monocyte parent lineage expressing the dendritic cell marker CD141 (<xref rid="vbac052-F3" ref-type="fig">Fig. 3h</xref>) and, separately, CD11b (<xref rid="vbac052-F3" ref-type="fig">Fig. 3i</xref>) were also observed in COVID-positive samples.</p>
      <fig position="float" id="vbac052-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Identified phenotypes. Phenotypes differing between COVID-positive and COVID-negative samples identified as independent with a confidence score of 1 are shown for the following parent lineages: (<bold>a, b</bold>) CD45+CD14−CD19−CD3−CD56−, (<bold>c</bold>) CD45+CD19+, (<bold>d</bold>) CD45+CD3+, (<bold>e, f</bold>) CD45+CD56+, (<bold>g–i</bold>) CD45+CD14+. Each panel shows the corresponding difference of means, the 95% confidence intervals and associated <italic toggle="yes">P</italic>-values</p>
        </caption>
        <graphic xlink:href="vbac052f3" position="float"/>
      </fig>
      <table-wrap position="float" id="vbac052-T2">
        <label>Table 2.</label>
        <caption>
          <p>COVIDome identified phenotypes</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Lineage</th>
              <th rowspan="1" colspan="1">Phenotype</th>
              <th align="center" rowspan="1" colspan="1">Standardized effect size</th>
              <th align="center" rowspan="1" colspan="1">Fold change (<italic toggle="yes">log</italic><sub>2</sub>)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD3−CD19−CD56−CD14−</td>
              <td rowspan="1" colspan="1">CD11b−CD14−CD19−CD3−<bold>CD38++CD45+</bold>CD56−HLA_DR−<bold>Ki67+</bold></td>
              <td rowspan="1" colspan="1">0.71</td>
              <td rowspan="1" colspan="1">1.35</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD3−CD19−CD56−CD14−</td>
              <td rowspan="1" colspan="1">CD11b−CD123−CD14−CD19−CD3−<bold>CD38++CD45+</bold>CD56−HLA_DR−<bold>Ki67+</bold></td>
              <td rowspan="1" colspan="1">0.71</td>
              <td rowspan="1" colspan="1">1.35</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD19+</td>
              <td rowspan="1" colspan="1"><bold>CD19+CD38++CD45+</bold>IgD−</td>
              <td rowspan="1" colspan="1">0.52</td>
              <td rowspan="1" colspan="1">1.40</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD3+</td>
              <td rowspan="1" colspan="1">CCR7−CD25−<bold>CD3+CD4++CD45+CD45RA+</bold></td>
              <td rowspan="1" colspan="1">−0.57</td>
              <td rowspan="1" colspan="1">−0.95</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD56+</td>
              <td rowspan="1" colspan="1">CD4−<bold>CD45+CD56+</bold>CD57−<bold>Ki67+</bold></td>
              <td rowspan="1" colspan="1">0.54</td>
              <td rowspan="1" colspan="1">0.53</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD56+</td>
              <td rowspan="1" colspan="1"><bold>CD4+CD45+CD56+</bold>Ki67−</td>
              <td rowspan="1" colspan="1">−0.47</td>
              <td rowspan="1" colspan="1">−0.81</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD14+</td>
              <td rowspan="1" colspan="1">CD11c−<bold>CD14+CD45+Ki67+</bold></td>
              <td rowspan="1" colspan="1">0.61</td>
              <td rowspan="1" colspan="1">2.61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD14+</td>
              <td rowspan="1" colspan="1">CD11c−<bold>CD14+CD141+CD45+</bold></td>
              <td rowspan="1" colspan="1">0.61</td>
              <td rowspan="1" colspan="1">2.61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD45+CD14+</td>
              <td rowspan="1" colspan="1"><bold>CD11b+</bold>CD11c−<bold>CD14+CD45+</bold></td>
              <td rowspan="1" colspan="1">0.61</td>
              <td rowspan="1" colspan="1">2.61</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p>Expressed markers (i.e. positive) are shown in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For each of the lineages assessed, we also determined the total number of phenotypes present and the total runtime needed to compute. These data are plotted in <xref rid="vbac052-F2" ref-type="fig">Figure 2a and b</xref>. The following number of phenotypes were identified for the corresponding lineage (minimum cell count 100 in 50% of samples): CD45+CD56+, 485 832 phenotypes; CD45+CD14+, 1 537 542 phenotypes; CD45+CD3−CD19−CD56−CD14−, 28 219 848 phenotypes; CD45+CD19+, 184 492 651 phenotypes; and CD45+CD3+, 8 263 420 408 phenotypes. The lineages took the following times to compute: CD45+CD56+, 17 min; CD45+CD14+, 18.37 min; CD45+CD3−CD19−CD56−CD14−, 18.53 min; CD45+CD19+, 3.26 h; and CD45+CD3+, 49.97 h.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Herein, we demonstrated that PhenoComb is an efficient and effective discovery tool for agnostically interrogating high-dimensional cytometry data. The package pipeline is carried out over four steps: (i) discretizing marker expression based on user-defined thresholds, (ii) assessing the frequencies of all maker combinations present in the dataset for each sample, (iii) performing a statistical comparison of the phenotype frequencies and (iv) network/clustering analysis to identify representative independent phenotypes from those identified as significantly different. While we presented a pipeline analysis of data using PhenoComb, dataframes/csv files are generated at intermediate points that can be used for further interrogation inside and outside of PhenoComb. For example, the frequency of all identified phenotypes can be accessed to further interrogate specific phenotypes of interest, even if they are not identified as different in comparisons or an independent phenotype in clustering.</p>
    <p>As PhenoComb utilizes thresholds to discretize data, inputs from separate experiments need to be assessed independently. This is consequence of the different thresholds for markers across experiments, except in cases of standardization (e.g. using rainbow beads to standardize voltages). As a result, PhenoComb’s utility as a direct pipeline for use on datasets with batch differences is limited. However, using the product of intermediate steps, workarounds are possible (e.g. combining csv files generated from separately discretized experiments and then assessing frequencies).</p>
    <p>To the authors’ knowledge, no tools similar to PhenoComb in function are publicly available. The package flowType is the closet in function but is no longer actively supported. The comparison of PhenoComb and flowType on synthetic data highlights flowType’s limitation of assessing only relatively short maximum marker lengths. While flowType was used to assess marker combinations only up to a maximum of length 11, the theoretical time necessary for a 15 marker long phenotype is estimated at 42 days. At all marker combination lengths assessed, PhenoComb had shorter runtimes of several orders of magnitude. It is important to note that flowType, to the best of our knowledge, is limited to single-core use. As flowType operates in memory, it is also limited by available RAM. Conversely, PhenoComb takes advantage of multi-core processors and is not limited by available RAM.</p>
    <p>The presented analyses utilized two-state (i.e. ±) or three-state (i.e. negative, low, high) discretization of markers in datasets, but PhenoComb is theoretically compatible with a large number of discretely defined states. Defining the thresholds and the number of states is determined by the user, as it is in manual analysis. The number of states should be guided by visual analysis and background knowledge for markers. For example, CD4 is expressed by monocytes (and other innate cell lineages) in addition to T cells, with monocytes having a ‘low’ expression state and T cells having a ‘high’ expression state. Hence, thresholds for CD4 should define three states if the staining index is adequate to discriminate. Caution should be taken not to define more states than are supported by the biology of the marker and the quality of staining. While measurements for markers in cytometry are continuous, much of the variation is technical in nature rather than biological.</p>
    <p>While we generated synthetic datasets to assess the computational time necessary, real datasets take significantly less time to calculate than the theoretical. As mentioned before and shown in our analysis of the HIV and COVIDome datasets, this is due to many of the theoretical marker combinations being absent in real data. This is the consequence of a limited number of cells being interrogated and/or biological limitations to co-expression/exclusion of markers. With a large enough cell count per sample, an interesting question that PhenoComb is capable of answering is how many of the theoretical marker combinations are present. In other words, PhenoComb could be applied to identify if and what phenotypes are absent. Likewise, PhenoComb could be used to interrogate highly correlated markers, which then could be used to inform more efficient future analyses.</p>
    <p>Using PhenoComb to assess the HIV and COVIDome datasets, we demonstrated it was able to process large, real-world datasets in a relatively short amount of time. For example, in the COVIDome dataset analysis of the CD45+CD14+ lineage, PhenoComb was able to assess over 1.5 million phenotypes derived from 16 markers across 99 samples in under 19 min. However, given the super-exponential increase in computation time, increases in the maximum length of phenotypes can result in analyses requiring extended amounts of time. Illustrating this, the CD45+CD3+ lineage, also from the COVIDome dataset, took 50 h to assess 26 markers. While for specialized and/or occasional use this may be an acceptable amount of time, often it is impractical. This can be mitigated through tuning functional arguments in PhenoComb, including filtering out low-frequency populations or limiting the maximum length of phenotypes to less than the total number of markers interrogated.</p>
    <p>In interrogating the HIV dataset, PhenoComb identified two of the three phenotypes associated with time to seroconversion highlighted in the original publication. However, there was variation between the <italic toggle="yes">P</italic>-values, Cox Proportional Hazard coefficients and cell frequencies between PhenoComb and the original publication. This likely reflects the differences in statistical tests utilized and differences caused by the subjective nature of gating markers. This likely also explains why PhenoComb did not identify one of the three original publication phenotypes as significant.</p>
    <p>In the COVIDome dataset, PhenoComb identified Ki67+ phenotypes in the NK cell, monocyte and undefined other immune cell (i.e. CD45+CD3−CD19−CD56−CD19−) lineages elevated in peripheral blood samples from COVID-positive individuals. Increases in B cells and undefined other immune cells expressing high levels of CD38 were also observed. These phenotypes highlight the proliferation and activation of immune cells as elevated in COVID infection. These phenotypes are associated with an active immune response, as would be expected in an infected individual. In T cells, a CD4++CD45RA+CCR7−CD25− phenotype was decreased in COVID-positive individuals. A CD45RA+CCR7− T-cell phenotype is canonically associated with an effector or ‘effector memory re-expressing RA (TEMRA)’ phenotype (<xref rid="vbac052-B2" ref-type="bibr">Ahlers and Belyakov, 2010</xref>; <xref rid="vbac052-B9" ref-type="bibr">Restifo and Gattinoni, 2013</xref>). A decrease in effector T cells in COVID-infected individuals is counter-intuitive; however, the lack of CD25 expression suggests that these cells are not activated (<xref rid="vbac052-B5" ref-type="bibr">Caruso <italic toggle="yes">et al.</italic>, 1997</xref>) and hence not truly effector cells.</p>
    <p>It is important to note that for all statistical tests, <italic toggle="yes">P</italic>-values are not corrected for the number of comparisons. This is because each phenotype assessed is not an independent observation of the data. Instead, a large number of phenotypes are dependent on each other, making it difficult to estimate multiple comparison adjusted <italic toggle="yes">P</italic>-values. Inflation of type I errors is partially mitigated by the network/clustering approach that uses metrics other than <italic toggle="yes">P</italic>-values to rank their importance. Regardless, identified phenotypes should be treated as ‘discoveries’, requiring further validation.</p>
    <p>PhenoComb is a powerful tool to add to the cytometrist’s analysis toolset. By taking full advantage of the single cell, high-dimensional data generated in cytometry assays, PhenoComb empowers exploratory data analysis and is able to highlight phenotypes for further characterization. Its implementation is also flexible, making it adaptable to work with various single-cell data types.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbac052_Supplementary_Data</label>
      <media xlink:href="vbac052_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We extend our appreciation to Eric Clambey, Director of the Flow Cytometry Shared Resource at the University of Colorado Cancer Center, for his assistance with the CyTOF dataset. We also extend our appreciation to the original authors of the HIV and COVIDome datasets and to Flow Repository for their efforts in supporting open science.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Department of Medicine, the Division of Medical Oncology, the Department of Dermatology and the Cancer Center at the University of Colorado.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbac052-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aghaeepour</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Early immunologic correlates of HIV protection can be identified from computational analysis of complex multivariate T-cell flow cytometry assays</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1009</fpage>–<lpage>1016</lpage>.<pub-id pub-id-type="pmid">22383736</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahlers</surname><given-names>J.D.</given-names></string-name>, <string-name><surname>Belyakov</surname><given-names>I.M.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Memories that last forever: strategies for optimizing vaccine T-cell memory</article-title>. <source>Blood</source>, <volume>115</volume>, <fpage>1678</fpage>–<lpage>1689</lpage>.<pub-id pub-id-type="pmid">19903895</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Becht</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>38</fpage>–<lpage>44</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac052-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>V.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Fast unfolding of communities in large networks</article-title>. <source>J. Stat. Mech</source>., <volume>2008</volume>, <fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="vbac052-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caruso</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>1997</year>) <article-title>Flow cytometric analysis of activation markers on stimulated T cells and their correlation with cell proliferation</article-title>. <source>Cytometry</source>, <volume>27</volume>, <fpage>71</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">9000587</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chattopadhyay</surname><given-names>P.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>A chromatic explosion: the development and future of multiparameter flow cytometry</article-title>. <source>Immunology</source>, <volume>125</volume>, <fpage>441</fpage>–<lpage>449</lpage>.<pub-id pub-id-type="pmid">19137647</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>J.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>. <source>Cell</source>, <volume>162</volume>, <fpage>184</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">26095251</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quarona</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>CD38 and CD157: a long journey from activation markers to multifunctional molecules: CD38 and CD157</article-title>. <source>Cytometry B Clin. Cytom</source>., <volume>84</volume>, <fpage>207</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">23576305</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Restifo</surname><given-names>N.P.</given-names></string-name>, <string-name><surname>Gattinoni</surname><given-names>L.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Lineage relationship of effector and memory T cells</article-title>. <source>Curr. Opin. Immunol</source>., <volume>25</volume>, <fpage>556</fpage>–<lpage>563</lpage>.<pub-id pub-id-type="pmid">24148236</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sullivan</surname><given-names>K.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>The COVIDome explorer researcher portal</article-title>. <source>Cell Rep</source>., <volume>36</volume>, <fpage>109527</fpage>.<pub-id pub-id-type="pmid">34348131</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weintrob</surname><given-names>A.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Increasing age at HIV seroconversion from 18 to 40 years is associated with favorable virologic and immunologic responses to HAART</article-title>. <source>J. Acquir. Immune Defic. Syndr</source>., <volume>49</volume>, <fpage>40</fpage>–<lpage>47</lpage>.<pub-id pub-id-type="pmid">18667932</pub-id></mixed-citation>
    </ref>
    <ref id="vbac052-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Woods</surname><given-names>D.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Nivolumab and ipilimumab are associated with distinct immune landscape changes and response-associated immunophenotypes</article-title>. <source>JCI Insight</source>, <volume>5</volume>, <fpage>e137066</fpage>.<pub-id pub-id-type="pmid">32369447</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
