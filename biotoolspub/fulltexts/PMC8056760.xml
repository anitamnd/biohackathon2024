<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">J. Appl. Cryst.</journal-id>
    <journal-title-group>
      <journal-title>Journal of Applied Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0021-8898</issn>
    <issn pub-type="epub">1600-5767</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8056760</article-id>
    <article-id pub-id-type="publisher-id">ge5087</article-id>
    <article-id pub-id-type="doi">10.1107/S1600576721000674</article-id>
    <article-id pub-id-type="coden">JACGAR</article-id>
    <article-id pub-id-type="pii">S1600576721000674</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computer Programs</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>MATSAS</italic>: a small-angle scattering computing tool for porous systems</article-title>
      <alt-title>
        <italic>MATSAS</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-5608-8115</contrib-id>
        <name>
          <surname>Rezaeyan</surname>
          <given-names>Amirsaman</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3930-3602</contrib-id>
        <name>
          <surname>Pipich</surname>
          <given-names>Vitaliy</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3279-5202</contrib-id>
        <name>
          <surname>Busch</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <aff id="a"><label>a</label>Lyell Centre, Institute of GeoEnergy Engineering, <institution>Heriot-Watt University</institution>, Research Avenue South, Edinburgh EH14 4AS, <country>United Kingdom</country></aff>
      <aff id="b"><label>b</label>Heinz Maier-Leibnitz Zentrum (MLZ), Forschungszentrum Jülich GmbH, <institution>Jülich Centre for Neutron Science (JCNS)</institution>, Lichtenbergstrasse 1, Garching 85748, <country>Germany</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>ar104@hw.ac.uk, amirsaman.rezaeyan@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>54</volume>
    <issue>Pt 2</issue>
    <issue-id pub-id-type="publisher-id">j210200</issue-id>
    <fpage>697</fpage>
    <lpage>706</lpage>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Amirsaman Rezaeyan et al. 2021</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S1600576721000674">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p><italic>MATSAS</italic> analyses X-ray and neutron small-angle scattering data obtained from porous systems. <italic>MATSAS</italic> delivers a full suite of pore characterizations, including specific surface area, porosity, pore size distribution and fractal dimensions.</p>
    </abstract>
    <abstract>
      <p><italic>MATSAS</italic> is a script-based MATLAB program for analysis of X-ray and neutron small-angle scattering (SAS) data obtained from various facilities. The program has primarily been developed for sedimentary rock samples but is equally applicable to other porous media. <italic>MATSAS</italic> imports raw SAS data from <monospace>.xls(x)</monospace> or <monospace>.csv</monospace> files, combines small-angle and very small angle scattering data, subtracts the sample background, and displays the processed scattering curves in log–log plots. <italic>MATSAS</italic> uses the polydisperse spherical (PDSP) model to obtain structural information on the scatterers (scattering objects); for a porous system, the results include specific surface area (SSA), porosity (Φ), and differential and logarithmic differential pore area/volume distributions. In addition, pore and surface fractal dimensions (<italic>D</italic>
<sub>p</sub> and <italic>D</italic>
<sub>s</sub>, respectively) are obtained from the scattering profiles. The program package allows simultaneous and rapid analysis of a batch of samples, and the results are then exported to <monospace>.xlsx</monospace> and <monospace>.csv</monospace> files with separate spreadsheets for individual samples. <italic>MATSAS</italic> is the first SAS program that delivers a full suite of pore characterizations for sedimentary rocks. <italic>MATSAS</italic> is an open-source package and is freely available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/matsas-software/MATSAS">https://github.com/matsas-software/MATSAS</ext-link>).</p>
    </abstract>
    <kwd-group>
      <kwd>
        <italic>MATSAS</italic>
      </kwd>
      <kwd>small-angle scattering</kwd>
      <kwd>polydisperse spherical model</kwd>
      <kwd>porous media</kwd>
      <kwd>computer programs</kwd>
    </kwd-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="sec1">
    <label>1.</label>
    <title>Introduction   </title>
    <p>Small-angle scattering (SAS) of neutrons and X-rays (SANS and SAXS, respectively) is widely used for the nondestructive study of the low-resolution structure of natural and engineered systems, including sedimentary rocks, biological macromolecules, composite nanomaterials and polymers on length scales between ångströms and micrometres in a single or combined experiment (Feigin &amp; Svergun, 1987<xref ref-type="bibr" rid="bb17"> ▸</xref>; Binder <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb8"> ▸</xref>; Zemb &amp; Lindner, 2002<xref ref-type="bibr" rid="bb61"> ▸</xref>; Radlinski, 2006<xref ref-type="bibr" rid="bb46"> ▸</xref>; Borsali &amp; Pecora, 2008<xref ref-type="bibr" rid="bb10"> ▸</xref>; Anovitz &amp; Cole, 2015<xref ref-type="bibr" rid="bb1"> ▸</xref>; Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>; Fritzsche <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb20"> ▸</xref>). Advances in SAS instrumentation, such as neutron and high-flux X-ray synchrotron beamlines, have significantly increased the use of SANS and SAXS experiments (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>; Zemb &amp; Lindner, 2002<xref ref-type="bibr" rid="bb61"> ▸</xref>; Heenan <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb24"> ▸</xref>). With the availability of these technologies, modern instruments can provide high-quality data in time- or space-resolved experiments or measurements under various physical and chemical conditions, such as temperature, pressure, humidity <italic>etc.</italic> (Konarev <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb32"> ▸</xref>; Schrank <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb57"> ▸</xref>). The theoretical and methodological developments obtained over the past few decades have allowed the retrieval of structural information from SAS patterns to address questions revolving around the size, shape, distribution and orientation of scatterers (scattering objects) (Konarev <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb32"> ▸</xref>; Petoukhov <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb43"> ▸</xref>).</p>
    <p>Neutron and X-ray scattering techniques complement each other, but neutrons and X-rays are different in their charge, energy and interaction with matter, which makes each technique subject to its own experimentation type and/or sample type (Binder <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb8"> ▸</xref>; Zemb &amp; Lindner, 2002<xref ref-type="bibr" rid="bb61"> ▸</xref>; Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref> illustrates a pinhole SAS experiment. Neutrons or X-rays are collimated and monochromated towards the sample, inside which a neutron or photon is elastically scattered from its wavevector <bold>k</bold>
<sub>0</sub> into a state with wavevector <bold>k</bold> under a scattering angle 2θ. The magnitude of a wavevector relates to its wavenumber, which is |<bold>k</bold>| = |<bold>k</bold>
<sub>0</sub>| = <italic>k</italic> = 2π/λ for elastic scattering, where λ is the neutron or X-ray wavelength. The intensity of the scattered radiation d<italic>I</italic> is therefore measured in the direction <bold>k</bold> as a function of the momentum transfer (the convention <bold>s</bold> = |<bold>k</bold> − <bold>k</bold>
<sub>0</sub>|) or the scattering vector <bold>Q</bold>. The magnitude of the scattering vector is given by <italic>Q</italic> = 4πsinθ/λ, from which it follows that <bold>Q</bold> = 2π<bold>s</bold>, where <italic>s</italic> = 2sinθ/λ (Radlinski, 2006<xref ref-type="bibr" rid="bb46"> ▸</xref>; Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>).</p>
    <p>The incident flux of the scattering objects is denoted by Φ<sub>0</sub>, <italic>i.e.</italic> Φ<sub>0</sub> = <italic>I</italic>
<sub>0</sub>/<italic>A</italic>, where <italic>I</italic>
<sub>0</sub> is the incident intensity (neutrons or X-rays per second) and <italic>A</italic> is the beam cross-sectional area at the sample position (Radlinski, 2006<xref ref-type="bibr" rid="bb46"> ▸</xref>). The scattered intensity monitored in the solid-angle element dΩ targeted by <italic>Q</italic> can be expressed as <disp-formula id="fd1"><graphic xlink:href="j-54-00697-efd1.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where dΣ is the elemental scattering cross section. The quantity dΣ/dΩ is called the differential cross section of scattering (Radlinski, 2006<xref ref-type="bibr" rid="bb46"> ▸</xref>). The aim of SAS experiments is to determine volume-averaged information on the spatial distribution of the scattering length density (neutrons) or electron density (X-rays) in the sample from the measured dΣ/dΩ as a function of the scattering vector magnitude <italic>Q</italic>, thus <inline-formula><inline-graphic xlink:href="j-54-00697-efi6.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> or <italic>I</italic>(<italic>Q</italic>) (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>).</p>
    <p>For a wide range of substances, SAS data for hard and soft matter can generally be interpreted accurately using a two-phase approximation (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). In this approximation, the scattering volume is viewed as being composed of above-molecular-size phases, each characterized by one of two possible values of the physical property that provides the scattering contrast (Δρ*). For instance, for porous media, these two phases are the solid matrix (phase 1) and the pore space (phase 2) (Radlinski, 2006<xref ref-type="bibr" rid="bb46"> ▸</xref>). The two-phase approximation is a simplification inherent in the SAS method and has been implicitly or explicitly employed for many years. As such, the general expression of the scattering cross section can be expressed as<disp-formula id="fd2"><graphic xlink:href="j-54-00697-efd2.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <italic>N</italic> is the number density of scatterers <italic>N</italic>
<sub>p</sub> per unit volume, <italic>V</italic>
<sub>p</sub> is the volume of the scatterers, and <inline-formula><inline-graphic xlink:href="j-54-00697-efi9.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="j-54-00697-efi10.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> are the scattering length/electron density of phase 1 and phase 2, respectively. <italic>B</italic> is the sample background, accounting for scattering in the high-<italic>Q</italic> limit. The high-<italic>Q</italic> background originates from (i) <italic>Q</italic>-independent incoherent scattering caused by hydrogen atoms in organic matter and/or water, and (ii) <italic>Q</italic>-dependent coherent scattering resulting from microscopic inhomogeneities (<italic>e.g.</italic> small pores in the rock matrix; Bahadur <italic>et al.</italic>, 2015<xref ref-type="bibr" rid="bb5"> ▸</xref>; Blach <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb9"> ▸</xref>). <italic>P</italic>(<italic>Q</italic>) is the form factor which describes the size and shape of the scatterer. There are analytical expressions for the form factor for simple geo­metrical objects like spheres, cylinders, discs or parallelepipeds (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). <italic>S</italic>(<italic>Q</italic>) is the structure factor and contains information about the spatial distribution of the scatterers. The structure factor represents the modification of the intensity due to the spatial correlation of the scatterers (Fritzsche <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb20"> ▸</xref>), where the positions of the scatterers are frozen in time and space in solid porous materials (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). In soft-matter systems, the interaction potential between scatterers is also taken into consideration (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). Form and structure factors need to be specified to determine the structural information in the scattering curves.</p>
    <p>Several SAS programs have been developed in different laboratories that consider various data processing and manipulation methods, fitting models, and form and structure factors to characterize the structure of the scatterers (Table 1<xref ref-type="table" rid="table1"> ▸</xref>). Recognizing the increasing application of SAS data to analyse the pore structure of sedimentary rocks, especially low-permeability rocks such as coal and mudrocks or gas shales (Radlinski, Ioannidis <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb50"> ▸</xref>; Radlinski, Mastalerz <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb51"> ▸</xref>; Radliński <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb48"> ▸</xref>; Mares <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb36"> ▸</xref>; Clarkson <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb15"> ▸</xref>; Mastalerz <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb37"> ▸</xref>; Melnichenko <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb39"> ▸</xref>; Bahadur <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb4"> ▸</xref>, 2015<xref ref-type="bibr" rid="bb5"> ▸</xref>; Anovitz <italic>et al.</italic>, 2015<xref ref-type="bibr" rid="bb3"> ▸</xref>; Leu <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb33"> ▸</xref>; Busch <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb13"> ▸</xref>, 2018<xref ref-type="bibr" rid="bb12"> ▸</xref>; Anovitz &amp; Cole, 2018<xref ref-type="bibr" rid="bb2"> ▸</xref>; Sakurovs <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb55"> ▸</xref>; Vishal <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb59"> ▸</xref>; Blach <italic>et al.</italic>, 2020<xref ref-type="bibr" rid="bb9"> ▸</xref>), we have developed the program package <italic>MATSAS</italic>. It allows the analysis of data obtained from small-angle and very small angle scattering of neutrons and X-rays [very small angle neutron scattering (VSANS), small-angle neutron scattering (SANS), wide-angle X-ray scattering (WAXS), ultra-small-angle X-ray scattering (USAXS) and small-angle X-ray scattering (SAXS)].</p>
    <p><italic>MATSAS</italic> analyses data from pinhole-geometry, time-of-flight (TOF) and Bonse–Hart machines and was tested using data acquired at FRM-II (Research Reactor Munich II, Garching, Germany) and ORNL (Oak Ridge National Laboratory, Tennessee, USA) (Rezaeyan, Pipich <italic>et al.</italic>, 2019<italic>a</italic>
<xref ref-type="bibr" rid="bb52"> ▸</xref>,<italic>b</italic>
<xref ref-type="bibr" rid="bb53"> ▸</xref>; Rezaeyan, Seemann <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb54"> ▸</xref>; Seemann <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb58"> ▸</xref>). <italic>MATSAS</italic> does post-processing of data obtained from research facilities. It is assumed that initial corrections for sample thickness, transmission, detector sensitivity, instrument background, multiple scattering and noise have been made using the instrument-specific settings at the facility itself, providing data in absolute units (Hinde, 2004<xref ref-type="bibr" rid="bb25"> ▸</xref>; Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). <italic>MATSAS</italic> is primarily oriented towards the structural analysis of sedimentary rocks using a polydisperse spherical (PDSP) model. The <italic>MATSAS</italic> software is constantly refined to broaden its functionality, making it applicable to isotropic and partially ordered objects such as biological nanoparticle systems, colloidal solutions, and polymers in solution and bulk. It is an open-source computer tool for academic users and is freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/matsas-software/MATSAS">https://github.com/matsas-software/MATSAS</ext-link>). Open-source access reflects transparency in the fundamental assumptions and solving approaches employed in the program and allows third parties to interface their in-house programs with the data analysis framework of the program (Liu <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb34"> ▸</xref>) and to help in accelerating its development. In this paper, we summarize the main components of <italic>MATSAS</italic> and its development framework.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Program overview   </title>
    <p><italic>MATSAS</italic> features a script-based package in MATLAB (The MathWorks Inc., Natick, MA, USA), which integrates computation and visualization in an easy-to-use environment. The <italic>MATSAS</italic> program is a versatile computer tool allowing both users and developers to add additional tools and develop specific novel applications. The flexible user-friendly framework of <italic>MATSAS</italic> for basic routines, such as intensity calculation or model alignment, allows anyone with basic programming skills to improve or adapt <italic>MATSAS</italic> to better reflect user-specific needs. Furthermore, the current version of the package includes the PDSP model to analyse SAS data in terms of theoretical intensity computation, the <italic>f</italic>(<italic>r</italic>) probability function of pore size distribution and model refinement. The PDSP model is the method commonly used for SAS analysis of a polydisperse system of randomly oriented independently scattering particles and is ubiquitous for fractal microstructures (<italic>e.g.</italic> sedimentary rocks) as well as other porous systems (Radlinski, Ioannidis <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb50"> ▸</xref>), provided that the particle-shape distribution is independent of the distribution of particle dimensions in the polydisperse system (Schmidt, 1982<xref ref-type="bibr" rid="bb56"> ▸</xref>). The script-based <italic>MATSAS</italic> code allows parameters to be tuned for more features of each routine.</p>
    <p>Use of the <italic>MATSAS</italic> program is divided into three steps: (i) pre-processing of raw or facility post-corrected SAS and very small angle scattering (VSAS) data as well as physical information, (ii) processing of the imported information to produce <italic>I</italic>(<italic>Q</italic>) versus <italic>Q</italic> curves, combine the SAS and VSAS curves, and fit the PDSP model, and (iii) post-processing to display and export structural information obtained from the samples being analysed. Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref> illustrates the main components of the present version of <italic>MATSAS</italic>.</p>
    <p>Detailed instructions on how to use the package are available on GitHub. Supporting information and command descriptions are embedded in each module. Errors and bugs can be invoked when no parameters or incorrect data are given to the command. We developed the package in Windows and recommend running it in Windows, Mac or Linux, with any Intel or AMD x86-64 processor with four logical cores and AVX2 instruction set support, as a minimum. Although the program runs satisfactorily without a specific graphics card, a hardware-accelerated graphics card supporting OpenGL 3.3 with 1 GB graphical processing unit (GPU) memory is recommended, as displaying figures and generating Microsoft <italic>Excel</italic> worksheets require more background processing.</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Data pre-processing   </title>
    <p>The data pre-processing module is composed of two components: (i) data are prepared in a Microsoft <italic>Excel</italic> spreadsheet [<monospace>*.xls(x)</monospace>] or <monospace>*.csv</monospace> file, including (V)SAS data, neutron scattering length densities or X-ray electron densities of phases 1 and 2 (<italic>e.g.</italic> rock matrix and pore), grain density of the sample, data reduction limits (optional), and sample name, and (ii) the MATLAB <monospace>data_input.m</monospace> file reads and stores the imported data for the next step. <italic>MATSAS</italic> allows users to run a batch of samples. The units in the input files can be converted between different unit systems (between nm<sup>−1</sup> and Å<sup>−1</sup> for <italic>Q</italic>, for instance) by changing appropriate codes. The range(s) of data points can be adjusted for each data set individually or simultaneously for selected groups of files.</p>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Data processing   </title>
    <p>The data processing module is used to manipulate and analyse the information imported. The primary data processing script is developed to manipulate scattering curves. The <italic>data_manipulation.m</italic> program carries out multiple tasks, including <italic>I</italic>(<italic>Q</italic>) data sorting, curve fitting, background subtraction, curve merging, curve smoothing and raw data reduction. The secondary data processing script file in <italic>data_analysis.m</italic> is designed to analyse <italic>I</italic>(<italic>Q</italic>)–<italic>Q</italic> curves and produce structural information. An arbitrary size distribution is created first and the PDSP model is then fitted to the processed scattering curve. Pore characteristics are predicted and fractal dimensions (including the pore fractal dimension, <italic>D</italic>
<sub>p</sub>, surface fractal dimension, <italic>D</italic>
<sub>s</sub>, and general fractal dimension, <italic>D</italic>
<sub>f</sub>) are evaluated from the fit in this module.</p>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Data manipulation   </title>
      <p>The program <italic>data_manipulation.m</italic> is a data processing module encompassing major SAS data processing steps for isotropic systems, from merging of scattering curves to background reduction. This program performs manipulations with one-dimensional data sets and calls other analysis and fitting programs via user-defined or built-in function files. The SAS data might have been collected at different sample-to-detector distances. Once data from several experimental curves have been combined for one specific instrument (<italic>e.g.</italic> SANS), they may not be sorted, which leads to numerical problems in further analysis. Data sorting is therefore carried out in the data manipulation package using a built-in function. If the SAS data consist of two scattering profiles obtained from two different instruments (<italic>e.g.</italic> VSANS and SANS), <italic>MATSAS</italic> allows users to merge the two curves using a least-squares fit in the overlapping range, as illustrated for example in Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>. The SAS curve is the basis onto which the VSAS curve is rebinned. The high-<italic>Q</italic> background is subtracted using equation (3)<xref ref-type="disp-formula" rid="fd3"/>, <disp-formula id="fd3"><graphic xlink:href="j-54-00697-efd3.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where the scattering varies with <italic>Q</italic>
<sup>−<italic>a</italic></sup> in the high-<italic>Q</italic> limit before plateauing (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). The value of the background <inline-formula><inline-graphic xlink:href="j-54-00697-efi14.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> is determined from a linear plot of equation (4)<xref ref-type="disp-formula" rid="fd4"/>,<disp-formula id="fd4"><graphic xlink:href="j-54-00697-efd4.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="j-54-00697-efi15.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> is the slope and <italic>A</italic> is the intercept (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref> shows the background subtraction in the high-<italic>Q</italic> limit for a range that users can change manually in the program.</p>
      <p>A noise-removal operation is embedded to remove the sparse data around the beam stop or detector edge. Raw data reduction, whose cut-off limits are determined in the data input files, is carried out as well. Two data smoothing operations are included in the package, which can be employed to obtain a smooth scattering profile for further structural analysis. Fractal dimensions and slope are determined here. For all operations, the propagation of uncertainty is performed using standard equations (Bevington &amp; Robinson, 2003<xref ref-type="bibr" rid="bb7"> ▸</xref>). A MATLAB plotting operation displays the currently active scattering profiles on a log–log scale. An advanced plotting option included in the plot permits users to change the plotting range, enlargement factor <italic>etc.</italic> The data manipulation file contains an output section, where the result of each operation can be used in subsequent data analysis. Information about the operation (type of operation, section names, functions, weights, ranges of points used <italic>etc.</italic>) is written in the package in green and allows modification or change of lines if needed.</p>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Data analysis   </title>
      <p>The data analysis program calculates the intensity of SAS from a polydisperse system of scatterers (Porod, 1951<xref ref-type="bibr" rid="bb44"> ▸</xref>, 1952<xref ref-type="bibr" rid="bb45"> ▸</xref>; Guinier &amp; Fournet, 1955<xref ref-type="bibr" rid="bb21"> ▸</xref>). The intensity is expressed in terms of a fractal distribution of scatterers, also called the probability density of the pore size distribution <italic>f</italic>(<italic>r</italic>), for greater numerical stability (Ilavsky &amp; Jemian, 2009<xref ref-type="bibr" rid="bb30"> ▸</xref>). SAS curves from sedimentary rocks are usually linear on a log–log scale, particularly in the high-<italic>Q</italic> region, which reflects fractal behaviour (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). Scattering from a fractal surface is equivalent to scattering from a system of polydisperse spherical scatterers (Schmidt, 1982<xref ref-type="bibr" rid="bb56"> ▸</xref>), with a number–size distribution (the number of spheres with radii between <italic>R</italic> and <italic>R</italic> + d<italic>R</italic>) given by <disp-formula id="fd5"><graphic xlink:href="j-54-00697-efd5.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <italic>D</italic>
<sub>f</sub> is the fractal dimension determined from the slope of the power-law scattering (Melnichenko, 2015<xref ref-type="bibr" rid="bb38"> ▸</xref>). In practice, the distribution described in equation (5)<xref ref-type="disp-formula" rid="fd5"/> and in the range <italic>R</italic>
<sub>min</sub> ≤ <italic>R</italic> ≤ <italic>R</italic>
<sub>max</sub> shows fractal behaviour between the upper and lower cut-off parameters. <italic>f</italic>(<italic>r</italic>) is expressed as <disp-formula id="fd6"><graphic xlink:href="j-54-00697-efd6.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>This is valid for <italic>R</italic>
<sub>max</sub> &gt; <italic>R</italic>
<sub>min</sub> &gt; 0 and <italic>D</italic>
<sub>f</sub> ∈ (−1, ∞), where <italic>D</italic>
<sub>f</sub> = 6 + slope. Scattering from a PDSP featured sample has a linear region with a similar slope −(1 + <italic>D</italic>
<sub>f</sub>) and is described by (Radlinski, Ioannidis <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb50"> ▸</xref>)<disp-formula id="fd7"><graphic xlink:href="j-54-00697-efd7.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="j-54-00697-efi22.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> is the volume of a sphere of radius <italic>r</italic> (volume of a scatterer). In addition, <italic>P</italic>(<italic>Q</italic>, <italic>r</italic>) is the form factor of a sphere of radius <italic>r</italic> (Guinier &amp; Fournet, 1955<xref ref-type="bibr" rid="bb21"> ▸</xref>):<disp-formula id="fd8"><graphic xlink:href="j-54-00697-efd8.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>
<italic>N</italic> is the total number of scatterers, which is related to the number size distribution as <italic>N</italic>(<italic>r</italic>) = <italic>Nf</italic>(<italic>r</italic>). <italic>N</italic>(<italic>r</italic>) is expressed as<disp-formula id="fd9"><graphic xlink:href="j-54-00697-efd9.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where <disp-formula id="fd10"><graphic xlink:href="j-54-00697-efd10.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>is the scattering intensity at <italic>Q</italic> = 0 and <inline-formula><inline-graphic xlink:href="j-54-00697-efi26.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> is the average volume of the scatterers (Radlinski <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb49"> ▸</xref>). Similarly to the approach of Ilavsky &amp; Jemian (2009<xref ref-type="bibr" rid="bb30"> ▸</xref>), <italic>MATSAS</italic> calculates equation (7)<xref ref-type="disp-formula" rid="fd7"/> throughout the integration over a continuous size distribution with a summation over a discrete size histogram: <disp-formula id="fd11"><graphic xlink:href="j-54-00697-efd11.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where the subscript <italic>i</italic> represents different scattering sizes and the subscript <italic>j</italic> describes bins in the size distribution. Δ<italic>r</italic>
<sub><italic>i</italic>, <italic>j</italic></sub> is the width of bin <italic>j</italic> and each scattering size has its own binning index <italic>i</italic>, <italic>j</italic>. <italic>r</italic> is the dimension of the scatterer (radius for spheres) and has limits <inline-formula><inline-graphic xlink:href="j-54-00697-efi28.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="j-54-00697-efi29.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>. The radius <italic>r</italic> is calculated using <italic>R</italic> = 2π/<italic>Q</italic>, which is <italic>R</italic> = 2.5/<italic>Q</italic> in the fractal distribution (Radliński <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb47"> ▸</xref>).</p>
      <p><italic>MATSAS</italic> uses an arbitrary size distribution to model the scattering volume distribution <italic>V</italic>
<sup>2</sup>(<italic>r</italic>)<italic>P</italic>(<italic>Q</italic>, <italic>r</italic>) and determine <italic>f</italic>(<italic>r</italic>). The user can change the theoretical ranges of the various size distributions in the data analysis program. Numerical calculations call limits on the range of dimensions (<italic>r</italic>
<sub>min</sub> and <italic>r</italic>
<sub>max</sub>), the cut-off limits (<italic>R</italic>
<sub>min</sub> and <italic>R</italic>
<sub>max</sub>) and the number of bins (<italic>N</italic>
<sub>bin</sub>). This method results in a natural logarithmic step in dimension and uses three parameters, <italic>R</italic>
<sub>min</sub>, <italic>R</italic>
<sub>max</sub> and <italic>N</italic>
<sub>bin</sub>. The centres of the first (<italic>r</italic>
<sub><italic>i</italic>, 1</sub>) and last (<inline-formula><inline-graphic xlink:href="j-54-00697-efi43.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>) bins are <italic>R</italic>
<sub>max</sub> and <italic>R</italic>
<sub>min</sub>, respectively, and extra fractional volumes are discarded for both bins: the volumes associated with <inline-formula><inline-graphic xlink:href="j-54-00697-efi46.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="j-54-00697-efi47.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> for the first and last bins, respectively. The widths of the bins are equal by selecting associated dimensions at regular increments of the cumulative distribution (Ilavsky &amp; Jemian, 2009<xref ref-type="bibr" rid="bb30"> ▸</xref>), leading to <disp-formula id="fd12"><graphic xlink:href="j-54-00697-efd12.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>However, the numerical operation of the <italic>data_analysis.m </italic>file requires <inline-formula><inline-graphic xlink:href="j-54-00697-efi48.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="j-54-00697-efi49.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="j-54-00697-efi50.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>, <italic>f</italic>
<sub><italic>i</italic></sub>(<italic>r</italic>
<sub><italic>i</italic>, <italic>j</italic></sub>) and <inline-formula><inline-graphic xlink:href="j-54-00697-efi52.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> to fit the PDSP model in equation (7)<xref ref-type="disp-formula" rid="fd7"/> to the measured <italic>I</italic>(<italic>Q</italic>) curve. The fitting procedure employs <italic>f</italic>(<italic>r</italic>) and <italic>IQ</italic>
<sub>0</sub> as fitting parameters for each iteration to attain a match where the summation of square errors (SSQ) tends to a minimum (Hinde, 2004<xref ref-type="bibr" rid="bb25"> ▸</xref>).</p>
      <p>To reduce the computation time taken by numerical integration, we found an analytical solution for the scattering volume distribution <disp-formula id="fd13"><graphic xlink:href="j-54-00697-efd13.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>that transforms equation (11)<xref ref-type="disp-formula" rid="fd11"/> into<disp-formula id="fd14"><graphic xlink:href="j-54-00697-efd14.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>
</p>
      <p><italic>MATSAS</italic> simplifies the intensity calculation by substituting equation (9)<xref ref-type="disp-formula" rid="fd9"/> into equation (14)<xref ref-type="disp-formula" rid="fd14"/>, leading to <disp-formula id="fd15"><graphic xlink:href="j-54-00697-efd15.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>
</p>
      <p>Once the match is reached, the data analysis program yields the structural characteristics of the scatterers using the fitted <italic>f</italic>(<italic>r</italic>) and <italic>IQ</italic>
<sub>0</sub> values. The specific surface area (SSA) of the scatterers is obtained following Hinde (2004<xref ref-type="bibr" rid="bb25"> ▸</xref>): <disp-formula id="fd16"><graphic xlink:href="j-54-00697-efd16.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where the subscript <italic>k</italic> represents bins in the size distribution. The volume fraction of scatterers per unit volume (Φ) is calculated from equation (9)<xref ref-type="disp-formula" rid="fd9"/>, which results in <disp-formula id="fd17"><graphic xlink:href="j-54-00697-efd17.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>and the total volume of scatterers (<italic>V</italic>
<sub>p</sub>) is obtained by<disp-formula id="fd18"><graphic xlink:href="j-54-00697-efd18.jpg" mimetype="image" mime-subtype="gif" position="float" orientation="portrait"/></disp-formula>where the subscript <italic>k</italic> represents bins in the size distribution. Differential (d<italic>V</italic>/d<italic>r</italic> or d<italic>A</italic>/d<bold>r</bold>) and logarithmic differential (d<italic>V</italic>/dlog<italic>r</italic> or d<italic>A</italic>/dlog<italic>r</italic>) scatterer size distributions are calculated cumulatively (Meyer &amp; Klobes, 1999<xref ref-type="bibr" rid="bb40"> ▸</xref>).</p>
      <p>The scattering intensity decays as <italic>Q</italic>
<sup>−<italic>m</italic></sup> with different power-law exponents <italic>m</italic>; this indicates that <italic>m</italic> is related to the dimensionality of the pore as understood in terms of the concept of fractality (Mandelbrot, 1983<xref ref-type="bibr" rid="bb35"> ▸</xref>). For a fractal pore scatterer, therefore, <italic>D</italic>
<sub>p</sub> = <italic>m</italic> with values 1 &lt; <italic>D</italic>
<sub>p</sub> &lt; 3, and for a surface fractal <italic>D</italic>
<sub>s</sub> = 6 − <italic>m</italic> with values 2 ≤ <italic>D</italic>
<sub>s</sub> ≤ 3 (Bale &amp; Schmidt, 1984<xref ref-type="bibr" rid="bb6"> ▸</xref>).</p>
      <p>The scattering at different length scales indicates the Guinier, mass/pore fractal, surface fractal and Porod regions, suggesting that each fractal region is limited to a specific range of scattering vectors (Fritzsche <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb20"> ▸</xref>). Therefore, for sedimentary rocks <italic>D</italic>
<sub>p</sub> and <italic>D</italic>
<sub>s</sub> are geared to the ranges of 0.0003–0.003 cm<sup>−1</sup> and 0.003–0.03 cm<sup>−1</sup>, respectively. In addition, <italic>D</italic>
<sub>f</sub> is included to reflect the fractality of the full pore system over the entire scattering vector range, <italic>e.g.</italic> 0.0003–0.03 cm<sup>−1</sup> in sedimentary rocks (Rezaeyan, Pipich <italic>et al.</italic>, 2019<italic>a</italic>
<xref ref-type="bibr" rid="bb52"> ▸</xref>,<italic>b</italic>
<xref ref-type="bibr" rid="bb53"> ▸</xref>; Rezaeyan, Seemann <italic>et al.</italic>, 2019<xref ref-type="bibr" rid="bb54"> ▸</xref>). These ranges can be changed by the user.</p>
      <p>For demonstration purposes, we tested the analysis operations on SANS and VSANS data obtained from three rock samples (Opalinus Clay) using batch mode. Opalinus Clay is a Jurassic mudrock that was obtained from the Mont Terri Underground Laboratory in Switzerland and has been described in detail previously (Busch <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb13"> ▸</xref>). Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>(<italic>a</italic>) shows the PDSP modelled <italic>I</italic>(<italic>Q</italic>) curves and the measured <italic>I</italic>(<italic>Q</italic>) curves after two iterations of the fitting operation. The first iteration starts with initial guesses for <italic>f</italic>(<italic>r</italic>) and <italic>IQ</italic>
<sub>0</sub>, which are obtained from the slope of the scattering curves and the Guinier &amp; Fournet (1955<xref ref-type="bibr" rid="bb21"> ▸</xref>) approximation, respectively. SSQ tends to a minimum after the second iteration; two iterations are recommended for most rock samples (Hinde, 2004<xref ref-type="bibr" rid="bb25"> ▸</xref>). Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>(<italic>b</italic>) shows <italic>f</italic>(<italic>r</italic>) after two iterations on a log–log scale. <italic>f</italic>(<italic>r</italic>) levels off at scatterer sizes ≳2 µm because the scattering intensities of large scatterers are smeared, possibly due to instrument artefacts at the edge of the detector. The error sensitivity, expressed as dSSQ/dlog(<italic>IQ</italic>
<sub>0</sub>), relates SSQ to the number of iterations [Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>(<italic>c</italic>)]. The value of dSSQ/dlog(<italic>IQ</italic>
<sub>0</sub>) varies around zero for all scatterer sizes. However, as illustrated in Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>(<italic>c</italic>), this can deviate where the fit is rather poor for large scatterer sizes (<inline-formula><inline-graphic xlink:href="j-54-00697-efi71.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>) due to different instrument resolutions or noise within overlap areas. SSQ is magnified when the number of iterations exceeds two, resulting in an attenuation of <italic>f</italic>(<italic>r</italic>). Nevertheless, we recommend attaining a smooth <italic>f</italic>(<italic>r</italic>) if the optimum fit requires a larger number of iterations for a specific sample. χ<sup>2</sup> tolerance can be used for the fit when the user has no preference for the number of iterations.</p>
      <p>We also tested the PDSP model on three poly­di­methyl­siloxane (PDMS) polymers with volume fractions of 0.128, 0.25 and 0.5 in toluene to demonstrate the applicability of the fitting operation for a non-power-law nanostructure in solution [Figs. 4<xref ref-type="fig" rid="fig4"> ▸</xref>(<italic>d</italic>)–4<xref ref-type="fig" rid="fig4"> ▸</xref>(<italic>f</italic>)]. Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>(<italic>f</italic>) displays the numerical flexibility of the fitting procedure after 20 iterations.</p>
    </sec>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Data post-processing   </title>
    <p>The data post-processing module is made of two components, including <italic>data_output.m</italic> in MATLAB and the results reported in figures and tabulated files. The <italic>data_output.m</italic> file calls the results of individual samples, reports the results in figures and tables in the MATLAB command window, and writes the results in <monospace>output.xlsx</monospace>. The results include measured, processed and predicted scattering curves, fractal distribution fit (<italic>f<sub>r</sub></italic>), specific surface area (SSA), porosity (Φ), pore volume (<italic>V</italic>
<sub>p</sub>), pore size distribution (PSD) by pore volume or pore area, fractal dimensions, slopes of scattering curves, pore characteristics divided into macro-, meso- and micropores, and background subtraction values. Some results for the Opalinus Clay samples are shown in Fig. 5<xref ref-type="fig" rid="fig5"> ▸</xref> and Table 2<xref ref-type="table" rid="table2"> ▸</xref>. The results for individual samples are produced and saved in figure formats (<monospace>*.tif</monospace> and <monospace>*.emf</monospace>), <italic>Excel</italic> spreadsheets and <monospace>.csv</monospace> files for use in further specific analyses. The results are usable if the raw SAS data are provided in absolute units; otherwise users must report pore characteristics in arbitrary units.</p>
  </sec>
  <sec sec-type="conclusions" id="sec6">
    <label>6.</label>
    <title>Conclusions   </title>
    <p><italic>MATSAS</italic> encompasses a set of modules allowing for a full analysis of (V)SANS and (V)SAXS data from porous systems, <italic>e.g.</italic> sedimentary rocks. <italic>MATSAS</italic> is written in MATLAB and combines a desktop environment tuned for data processing and structural analyses with pre- and post-processing modules. The pre-processing module is used to import data from Microsoft <italic>Excel</italic> spreadsheets or <monospace>.csv</monospace> files into MATLAB. The main module performs data manipulation and analysis in which <italic>I</italic>(<italic>Q</italic>)–<italic>Q</italic> curves are processed and the PDSP model is fitted to produce structural information for porous systems. The post-processing module displays results in the form of tables and figures and exports them in Microsoft <italic>Excel</italic> spreadsheets or <monospace>.csv</monospace> files. <italic>MATSAS</italic> is the first SAS program that provides a full suite of pore characterizations. The programs included in <italic>MATSAS</italic> are publicly available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/matsas-software/MATSAS">https://github.com/matsas-software/MATSAS</ext-link>) for academic users.</p>
  </sec>
</body>
<back>
  <ack>
    <p>SANS and VSANS measurements on the rock samples tested in this study were performed on the KWS-1 and KWS-3 instruments at the Jülich Centre for Neutron Science (JCNS) at the Heinz Maier-Leibnitz Zentrum (MLZ) in Garching, Germany. We are very grateful for the beam time obtained. We also thank Masoud Ghaderi Zefreh at the University of Edinburgh for assisting with MATLAB programs, and Gernot Rother at Oak Ridge National Laboratory, Artem Feoktystov at the Forschungszentrum Jülich GmbH and Lester Barnsley at the Australian Synchrotron for testing and reporting on <italic>MATSAS</italic>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Anovitz, L. M. &amp; Cole, D. R. (2015). <italic>Rev. Mineral. Geochem.</italic>
<bold>80</bold>, 61–164.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Anovitz, L. M. &amp; Cole, D. R. (2018). <italic>Geological Carbon Storage</italic>, edited by S. Vialle, J. Ajo-Franklin &amp; J. W. Carey, pp. 71–118. Washington, DC: American Geophysical Union/John Wiley &amp; Sons, Inc.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Anovitz, L. M., Cole, D. R., Jackson, A. J., Rother, G., Littrell, K. C., Allard, L. F., Pollington, A. D. &amp; Wesolowski, D. J. (2015). <italic>Geochim. Cosmochim. Acta</italic>, <bold>158</bold>, 199–222.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Bahadur, J., Melnichenko, Y. B., Mastalerz, M., Furmann, A. &amp; Clarkson, C. R. (2014). <italic>Energy Fuels</italic>, <bold>28</bold>, 6336–6344.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Bahadur, J., Radlinski, A. P., Melnichenko, Y. B., Mastalerz, M. &amp; Schimmelmann, A. (2015). <italic>Energy Fuels</italic>, <bold>29</bold>, 567–576.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Bale, H. D. &amp; Schmidt, P. W. (1984). <italic>Phys. Rev. Lett.</italic>
<bold>53</bold>, 596–599.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Bevington, P. &amp; Robinson, D. K. (2003). <italic>Data Reduction and Error Analysis for the Physical Sciences.</italic> 3rd ed. Boston: McGraw-Hill Education.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Binder, K., Erman, B., Mark, J. E. &amp; Roe, R. J. (2000). <italic>Methods of X-ray and Neutron Scattering in Polymer Science.</italic> Oxford University Press.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Blach, T., Radlinski, A. P., Edwards, D. S., Boreham, C. J. &amp; Gilbert, E. P. (2020). <italic>Int. J. Coal Geol.</italic>
<bold>225</bold>, 103495.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Borsali, R. &amp; Pecora, R. (2008). <italic>Soft Matter Characterization.</italic> New York: Springer.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Breßler, I., Kohlbrecher, J. &amp; Thünemann, A. F. (2015). <italic>J. Appl. Cryst.</italic>
<bold>48</bold>, 1587–1598.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Busch, A., Kampman, N., Bertier, P., Pipich, V., Feoktystov, A., Rother, G., Harrington, J., Leu, L., Aertens, M. &amp; Jacops, E. (2018). <italic>Water Resour. Res.</italic>
<bold>54</bold>, 7076–7091.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Busch, A., Schweinar, K., Kampman, N., Coorn, A., Pipich, V., Feoktystov, A., Leu, L., Amann-Hildenbrand, A. &amp; Bertier, P. (2017). <italic>Geol. Soc. London Spec. Publ.</italic>
<bold>454</bold>, SP454.1</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Chacón, P., Morán, F., Díaz, J. F., Pantos, E. &amp; Andreu, J. M. (1998). <italic>Biophys. J.</italic>
<bold>74</bold>, 2760–2775.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Clarkson, C. R., Freeman, M., He, L., Agamalian, M., Melnichenko, Y. B., Mastalerz, M., Bustin, R. M., Radliński, A. P. &amp; Blach, T. P. (2012). <italic>Fuel</italic>, <bold>95</bold>, 371–385.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Dewhurst, C. (2002). <italic>GRASP</italic>, https://www.ill.eu/users/support-labs-infrastructure/software-scientific-tools/grasp</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Feigin, L. A. &amp; Svergun, D. I. (1987). <italic>Structure Analysis by Small-Angle X-ray and Neutron Scattering.</italic> New York: Plenum Press.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Förster, S., Apostol, L. &amp; Bras, W. (2010). <italic>J. Appl. Cryst.</italic>
<bold>43</bold>, 639–646.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Franke, D. &amp; Svergun, D. I. (2009). <italic>J. Appl. Cryst.</italic>
<bold>42</bold>, 342–346.</mixed-citation>
    </ref>
    <ref id="bb70">
      <mixed-citation publication-type="other">Franke, D., Petoukhov, M. V., Konarev, P. V., Panjkovich, A., Tuukkanen, A., Mertens, H. D. T., Kikhney, A. G., Hajizadeh, N. R., Franklin, J. M., Jeffries, C. M. &amp; Svergun, D. I. (2017). <italic>J. Appl. Cryst.</italic>
<bold>50</bold>, 1212–1225.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Fritzsche, H., Huot, J. &amp; Fruchart, D. (2016). <italic>Neutron Scattering and Other Nuclear Techniques for Hydrogen in Materials.</italic> Cham: Springer International Publishing.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Guinier, A. &amp; Fournet, G. (1955). <italic>Small Angle Scattering of X-rays.</italic> New York: John Wiley.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Hammersley, A. P. (1995). <italic>FIT2D Version 5.18 Reference Manual.</italic> ESRF Internal Report Exp/AH/95-01. ESRF, Grenoble, France.</mixed-citation>
    </ref>
    <ref id="bb72">
      <mixed-citation publication-type="other">Hammersley, A. P. (2016). <italic>J. Appl. Cryst.</italic>
<bold>49</bold>, 646–652.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Heenan, R. K. (1999). <italic>FISH, Program for Peak Analysis.</italic> Rutherford Appleton Laboratory Internal Publication 89-129, Didcot, United Kingdom.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Heenan, R. K., Penfold, J. &amp; King, S. M. (1997). <italic>J. Appl. Cryst.</italic>
<bold>30</bold>, 1140–1147.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Hinde, A. L. (2004). <italic>J. Appl. Cryst.</italic>
<bold>37</bold>, 1020–1024.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Hiragi, Y., Sano, Y. &amp; Matsumoto, T. (2003). <italic>J. Synchrotron Rad.</italic>
<bold>10</bold>, 193–196.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Hofmann, A. &amp; Whitten, A. E. (2014). <italic>J. Appl. Cryst.</italic>
<bold>47</bold>, 810–815.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Homan, E., Konijnenburg, M., Ferrero, C., Ghosh, R. E., Dolbnya, I. P. &amp; Bras, W. (2001). <italic>J. Appl. Cryst.</italic>
<bold>34</bold>, 519–522.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Hopkins, J. B., Gillilan, R. E. &amp; Skou, S. (2017). <italic>J. Appl. Cryst.</italic>
<bold>50</bold>, 1545–1553.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Ilavsky, J. &amp; Jemian, P. R. (2009). <italic>J. Appl. Cryst.</italic>
<bold>42</bold>, 347–353.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Keiderling, U. (1997). <italic>Physica B</italic>, <bold>234–236</bold>, 1111–1113.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Konarev, P. V., Petoukhov, M. V., Volkov, V. V. &amp; Svergun, D. I. (2006). <italic>J. Appl. Cryst.</italic>
<bold>39</bold>, 277–286.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Leu, L., Georgiadis, A., Blunt, M. J., Busch, A., Bertier, P., Schweinar, K., Liebi, M., Menzel, A. &amp; Ott, H. (2016). <italic>Energy Fuels</italic>, <bold>30</bold>, 10282–10297.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Liu, H., Hexemer, A. &amp; Zwart, P. H. (2012). <italic>J. Appl. Cryst.</italic>
<bold>45</bold>, 587–593.</mixed-citation>
    </ref>
    <ref id="bb71">
      <mixed-citation publication-type="other">Manalastas-Cantos, K., Konarev, P. V., Hajizadeh, N. R., Kikhney, A. G., Petoukhov, M. V., Molodenskiy, D. S., Panjkovich, A., Mertens, H. D. T., Gruzinov, A., Borges, C., Jeffries, C. M., Svergun, D. I. &amp; Franke, D. (2021). <italic>J. Appl. Cryst.</italic>
<bold>54</bold>, 343–355.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Mandelbrot, B. B. (1983). <italic>The Fractal Geometry of Nature.</italic> New York: W. H. Freeman and Company.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Mares, T. E., Radliński, A. P., Moore, T. A., Cookson, D., Thiyagarajan, P., Ilavsky, J. &amp; Klepp, J. (2012). <italic>Int. J. Coal Geol.</italic>
<bold>94</bold>, 173–181.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Mastalerz, M., He, L., Melnichenko, Y. B. &amp; Rupp, J. A. (2012). <italic>Energy Fuels</italic>, <bold>26</bold>, 5109–5120.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Melnichenko, Y. B. (2015). <italic>Small-Angle Scattering from Confined and Interfacial Fluids: Applications to Energy Storage and Environmental Science.</italic> Cham: Springer.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Melnichenko, Y. B., He, L., Sakurovs, R., Kholodenko, A. L., Blach, T., Mastalerz, M., Radliński, A. P., Cheng, G. &amp; Mildner, D. F. R. (2012). <italic>Fuel</italic>, <bold>91</bold>, 200–208.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Meyer, K. &amp; Klobes, P. (1999). <italic>Fresenius J. Anal. Chem.</italic>
<bold>363</bold>, 174–178.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Muthig, M., Prévost, S., Orglmeister, R. &amp; Gradzielski, M. (2013). <italic>J. Appl. Cryst.</italic>
<bold>46</bold>, 1187–1195.</mixed-citation>
    </ref>
    <ref id="bb42">
      <mixed-citation publication-type="other">Nielsen, S. S., Toft, K. N., Snakenborg, D., Jeppesen, M. G., Jacobsen, J. K., Vestergaard, B., Kutter, J. P. &amp; Arleth, L. (2009). <italic>J. Appl. Cryst.</italic>
<bold>42</bold>, 959–964.</mixed-citation>
    </ref>
    <ref id="bb43">
      <mixed-citation publication-type="other">Petoukhov, M. V., Franke, D., Shkumatov, A. V., Tria, G., Kikhney, A. G., Gajda, M., Gorba, C., Mertens, H. D. T., Konarev, P. V. &amp; Svergun, D. I. (2012). <italic>J. Appl. Cryst.</italic>
<bold>45</bold>, 342–350. </mixed-citation>
    </ref>
    <ref id="bb44">
      <mixed-citation publication-type="other">Porod, G. (1951). <italic>Kolloid-Z.</italic>, <bold>124</bold>, 83–114.</mixed-citation>
    </ref>
    <ref id="bb45">
      <mixed-citation publication-type="other">Porod, G. (1952). <italic>Kolloid-Z.</italic>, <bold>125</bold>, 51–57.</mixed-citation>
    </ref>
    <ref id="bb46">
      <mixed-citation publication-type="other">Radlinski, A. P. (2006). <italic>Rev. Mineral. Geochem.</italic>
<bold>63</bold>, 363–397.</mixed-citation>
    </ref>
    <ref id="bb47">
      <mixed-citation publication-type="other">Radliński, A. P., Boreham, C. J., Lindner, P., Randl, O., Wignall, G. D., Hinde, A. &amp; Hope, J. M. (2000). <italic>Org. Geochem.</italic>
<bold>31</bold>, 1–14.</mixed-citation>
    </ref>
    <ref id="bb48">
      <mixed-citation publication-type="other">Radliński, A. P., Busbridge, T. L., Gray, E. M. A., Blach, T. P. &amp; Cookson, D. J. (2009). <italic>Int. J. Coal Geol.</italic>
<bold>77</bold>, 80–89.</mixed-citation>
    </ref>
    <ref id="bb49">
      <mixed-citation publication-type="other">Radlinski, A. P., Ioannidis, M. A., Hinde, A. L., Hainbuchner, M., Baron, M., Rauch, H. &amp; Kline, R. (2002). <italic>Proceedings of the 2002 International Symposium of the Society of Core Analysts</italic>, 23–27 September 2002, Monterey, California, USA, SCA2002-35.</mixed-citation>
    </ref>
    <ref id="bb50">
      <mixed-citation publication-type="other">Radlinski, A. P., Ioannidis, M. A., Hinde, A. L., Hainbuchner, M., Baron, M., Rauch, H. &amp; Kline, S. R. (2004). <italic>J. Colloid Interface Sci.</italic>
<bold>274</bold>, 607–612.</mixed-citation>
    </ref>
    <ref id="bb51">
      <mixed-citation publication-type="other">Radlinski, A. P., Mastalerz, M., Hinde, A. L., Hainbuchner, M., Rauch, H., Baron, M., Lin, J. S., Fan, L. &amp; Thiyagarajan, P. (2004). <italic>Int. J. Coal Geol.</italic>
<bold>59</bold>, 245–271.</mixed-citation>
    </ref>
    <ref id="bb52">
      <mixed-citation publication-type="other">Rezaeyan, A., Pipich, V., Bertier, P., Seemann, T., Leu, L., Kampman, N., Feoktystov, A., Barnsley, L. C. &amp; Busch, A. (2019<italic>a</italic>). <italic>Microstructural Investigation of Mudrock Seals Using Nanometre-Scale Resolution Techniques</italic>. Sixth EAGE Shale Workshop, 28 April–1 May 2019, Bordeaux, France.</mixed-citation>
    </ref>
    <ref id="bb53">
      <mixed-citation publication-type="other">Rezaeyan, A., Pipich, V., Bertier, P., Seemann, T., Leu, L., Kampman, N., Feoktystov, A., Barnsley, L. C. &amp; Busch, A. (2019<italic>b</italic>). <italic>Quantitative Analysis of the Pore Structure of Premature-To-Postmature Organic-Rich Mudrocks Using Small-Angle Neutron Scattering</italic>. Sixth EAGE Shale Workshop, 28 April–1 May 2019, Bordeaux, France.</mixed-citation>
    </ref>
    <ref id="bb54">
      <mixed-citation publication-type="other">Rezaeyan, A., Seemann, T., Bertier, P., Pipich, V., Leu, L., Kampman, N., Feoktystov, A., Barnsley, L. &amp; Busch, A. (2019). SPE/AAPG/SEG Asia Pacific Unconventional Resources Technology Conference, 18–19 November 2019, Brisbane, Australia, p. 13.</mixed-citation>
    </ref>
    <ref id="bb55">
      <mixed-citation publication-type="other">Sakurovs, R., Koval, L., Grigore, M., Sokolova, A., Ruppert, L. F. &amp; Melnichenko, Y. B. (2018). <italic>Int. J. Coal Geol.</italic>
<bold>186</bold>, 126–134.</mixed-citation>
    </ref>
    <ref id="bb56">
      <mixed-citation publication-type="other">Schmidt, P. W. (1982). <italic>J. Appl. Cryst.</italic>
<bold>15</bold>, 567–569.</mixed-citation>
    </ref>
    <ref id="bb57">
      <mixed-citation publication-type="other">Schrank, C. E., Gioseffi, K., Blach, T., Gaede, O., Hawley, A., Milsch, H., Regenauer-Lieb, K. &amp; Radlinski, A. P. (2020). <italic>J. Petrol.</italic>
<bold>61</bold>, egaa041</mixed-citation>
    </ref>
    <ref id="bb58">
      <mixed-citation publication-type="other">Seemann, T., Bertier, P., Maes, N., Rezaeyan, A., Pipich, V., Barnsley, L., Busch, A. &amp; Cnudde, V. (2019). <italic>Resolving the Pore Structure and Sorption Properties of Methane in Mudrocks – A Small Angle Neutron Scattering Study.</italic> Sixth EAGE Shale Workshop, 28 April–1 May 2019, Bordeaux, France.</mixed-citation>
    </ref>
    <ref id="bb59">
      <mixed-citation publication-type="other">Vishal, V., Chandra, D., Bahadur, J., Sen, D., Hazra, B., Mahanta, B. &amp; Mani, D. (2019). <italic>Energy Fuels</italic>, <bold>33</bold>, 4835–4848.</mixed-citation>
    </ref>
    <ref id="bb60">
      <mixed-citation publication-type="other">Walther, D., Cohen, F. E. &amp; Doniach, S. (2000). <italic>J. Appl. Cryst.</italic>
<bold>33</bold>, 350–363.</mixed-citation>
    </ref>
    <ref id="bb61">
      <mixed-citation publication-type="other">Zemb, T. &amp; Lindner, P. (2002). <italic>Neutrons, X-rays and Light: Scattering Methods Applied to Soft Condensed Matter</italic>. North-Holland Delta Series. Amsterdam: Elsevier.</mixed-citation>
    </ref>
    <ref id="bb62">
      <mixed-citation publication-type="other">Zhao, J. K. (2011). <italic>J. Appl. Cryst.</italic>
<bold>44</bold>, 1277–1280.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>The schematic principle of a SAS experiment.</p>
    </caption>
    <graphic xlink:href="j-54-00697-fig1"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>A schematic flow chart of <italic>MATSAS</italic> programs and their functionalities.</p>
    </caption>
    <graphic xlink:href="j-54-00697-fig2"/>
  </fig>
  <fig id="fig3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>SANS data manipulated and processed on an arbitrary mudrock sample. Red, blue and black curves are the scattering profiles from the VSANS and SANS instruments and the net scattering after manipulation (merging, background subtraction and smoothing), respectively.</p>
    </caption>
    <graphic xlink:href="j-54-00697-fig3"/>
  </fig>
  <fig id="fig4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>The PDSP model applied to SANS data obtained from three rock samples (Opalinus Clay) and three poly­di­methyl­siloxane (PDMS) polymers of volume fractions 0.128, 0.25 and 0.5 in toluene. Rock samples: (<italic>a</italic>) measured <italic>I</italic>(<italic>Q</italic>) curves after manipulation and <italic>I</italic>(<italic>Q</italic>) curves obtained from the PDSP model, (<italic>b</italic>) probability functions of the pore size distribution <italic>f</italic>(<italic>r</italic>), and (<italic>c</italic>) the error sensitivity dSSQ/dlog(<italic>IQ</italic>
<sub>0</sub>) obtained after two iterations. PDMS samples: (<italic>d</italic>) the fitted PDSP model, (<italic>e</italic>) probability functions of the scatterer size distribution <italic>f</italic>(<italic>r</italic>) and (<italic>f</italic>) the error sensitivity obtained after 20 iterations.</p>
    </caption>
    <graphic xlink:href="j-54-00697-fig4"/>
  </fig>
  <fig id="fig5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>The PDSP model applied to SANS data obtained from three rock samples (Opalinus Clay). (<italic>a</italic>) Cumulative pore area distribution, (<italic>b</italic>) logarithmic differential pore area distribution, (<italic>c</italic>) cumulative pore volume distribution and (<italic>d</italic>) logarithmic differential pore volume distribution.</p>
    </caption>
    <graphic xlink:href="j-54-00697-fig5"/>
  </fig>
  <table-wrap id="table1" orientation="portrait" position="float">
    <label>Table 1</label>
    <caption>
      <title>Common SAS programs and their capabilities and applicabilities</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">SAS program</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Capabilities</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Applicability</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Reference</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>FIT2D</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">2D image data reduction/manipulation and peak fitting</td>
          <td rowspan="1" colspan="1" align="left" valign="top"> </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Hammersley (1995<xref ref-type="bibr" rid="bb22"> ▸</xref>, 2016<xref ref-type="bibr" rid="bb72"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>BerSANS</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Data acquisition/reduction</td>
          <td rowspan="1" colspan="1" align="left" valign="top"> </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Keiderling (1997<xref ref-type="bibr" rid="bb31"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>DALAI_GA</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>Ab initio</italic> shape determination</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Biological systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Chacón <italic>et al.</italic> (1998<xref ref-type="bibr" rid="bb14"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>FISH</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Peak analysis and parametric fitting using various form and structure factors</td>
          <td rowspan="1" colspan="1" align="left" valign="top"> </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Heenan (1999<xref ref-type="bibr" rid="bb23"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SAX3D</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>Ab initio</italic> shape determination</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Biological systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Walther <italic>et al.</italic> (2000<xref ref-type="bibr" rid="bb60"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>SAXS/WAXS</italic> software system</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Data acquisition/reduction</td>
          <td rowspan="1" colspan="1" align="left" valign="top"> </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Homan <italic>et al.</italic> (2001<xref ref-type="bibr" rid="bb28"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>GRASP</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Data acquisition/reduction</td>
          <td rowspan="1" colspan="1" align="left" valign="top"> </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Dewhurst (2002<xref ref-type="bibr" rid="bb16"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SAXSANA</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Data reduction, <italic>Q</italic> determination, data conversion, data correction, analysis of time-resolved data and data extrapolation</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Biological systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Hiragi <italic>et al.</italic> (2003<xref ref-type="bibr" rid="bb26"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>PRINSAS</italic>
            <xref ref-type="table-fn" rid="tfn1">†</xref>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Fitting of 1D curves using a spherical form factor for a polydisperse scattering system</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Porous systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Hinde (2004<xref ref-type="bibr" rid="bb25"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>ATSAS</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Data reduction, data processing and 3D modelling</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Biological systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Konarev <italic>et al.</italic> (2006<xref ref-type="bibr" rid="bb32"> ▸</xref>), Petoukhov <italic>et al.</italic> (2012<xref ref-type="bibr" rid="bb43"> ▸</xref>), Franke <italic>et al.</italic> (2017<xref ref-type="bibr" rid="bb70"> ▸</xref>), Manalastas-Cantos <italic>et al.</italic> (2021<xref ref-type="bibr" rid="bb71"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>DAMMIF</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>Ab initio</italic> shape determination for disordered systems and solutions</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Nanostructures</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Franke &amp; Svergun (2009<xref ref-type="bibr" rid="bb19"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>IRENA</italic>
            <xref ref-type="table-fn" rid="tfn1">†</xref>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Plotting SAS data, merging of two overlapping data sets, and fitting form and structural models to data from contrast variation experiments</td>
          <td rowspan="1" colspan="1" align="left" valign="top">A wide range of systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Ilavsky &amp; Jemian (2009<xref ref-type="bibr" rid="bb30"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>BioXTAS RAW</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Isotropic SAXS data reduction, primary data analysis and calculations of the pair-distance distribution functions, averaging, subtraction and analysis of radius of gyration and molecular weight, calculation of inverse Fourier transforms and envelopes, processing of inline size-exclusion chromatography coupled SAXS data, and data deconvolution</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Biological systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Nielsen <italic>et al.</italic> (2009<xref ref-type="bibr" rid="bb42"> ▸</xref>), Hopkins <italic>et al.</italic> (2017<xref ref-type="bibr" rid="bb29"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SCATTER</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">2D data analysis</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Nano- and mesoscale oriented structures</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Förster <italic>et al.</italic> (2010<xref ref-type="bibr" rid="bb18"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SAAF</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">SANS data analysis using a set of standard models</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Polymers</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Zhao (2011<xref ref-type="bibr" rid="bb62"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SASTBX</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Data reduction, model reconstruction, model refinement and shape retrieval</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Biological systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Liu <italic>et al.</italic> (2012<xref ref-type="bibr" rid="bb34"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SASET</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">1D and 2D data analysis and fitting of data using scattering models and anisotropy methods</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Anisotropic structures</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Muthig <italic>et al.</italic> (2013<xref ref-type="bibr" rid="bb41"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>MolScat</italic> and <italic>SAFIR</italic>
</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Modelling of 3D macromolecular structures</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Biological systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Hofmann &amp; Whitten (2014<xref ref-type="bibr" rid="bb27"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SASfit</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Reduction of oversampled data sets, confidence assessment of optimized model parameters and availability of custom user-provided models</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Polymers</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Breßler <italic>et al.</italic> (2015<xref ref-type="bibr" rid="bb11"> ▸</xref>)</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>QtiSAS</italic>/<italic>QtiKWS</italic><xref ref-type="table-fn" rid="tfn1">†</xref></td>
          <td rowspan="1" colspan="1" align="left" valign="top">Graphical visualization, reduction, analysis and fitting of data using various scattering models</td>
          <td rowspan="1" colspan="1" align="left" valign="top">A wide range of systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <ext-link ext-link-type="uri" xlink:href="https://www.qtisas.com/">https://www.qtisas.com/</ext-link>
          </td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>SASview</italic>
            <xref ref-type="table-fn" rid="tfn1">†</xref>
          </td>
          <td rowspan="1" colspan="1" align="left" valign="top">Data reduction, manipulation and analysis using several form and structure factors with polydispersity and orientational distributions</td>
          <td rowspan="1" colspan="1" align="left" valign="top">A wide range of systems</td>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <ext-link ext-link-type="uri" xlink:href="http://www.sasview.org/">http://www.sasview.org/</ext-link>
          </td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="tfn1">
        <label>†</label>
        <p><italic>PRINSAS</italic>, <italic>IRENA</italic>, <italic>QtiSAS</italic> and <italic>SASview</italic> are commonly used for analysis of SAS data obtained from porous systems featuring a wide range of pore sizes.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap-group id="table2" orientation="portrait" position="float">
    <label>Table 2</label>
    <caption>
      <title>Slope (<italic>m</italic>), fractal dimensions (<italic>D</italic>), incoherent background (<italic>I</italic>
<sub>BG</sub>) and pore characteristics evaluated by <italic>MATSAS</italic> from the SANS data for three rock samples</title>
    </caption>
    <table-wrap orientation="portrait" id="d39e2247" position="anchor">
      <caption>
        <p>The subscripts meso and macro represent properties in meso- and macropore sizes, respectively.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead valign="bottom">
          <tr>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Sample ID</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">
              <italic>m</italic>
            </th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">
              <italic>D</italic>
              <sub>f</sub>
            </th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">
              <italic>D</italic>
              <sub>s</sub>
            </th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">
              <italic>D</italic>
              <sub>p</sub>
            </th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom"><italic>I</italic><sub>BG VSAS</sub> (cm<sup>−1</sup>)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom"><italic>I</italic><sub>BG SAS</sub> (cm<sup>−1</sup>)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">SSA (m<sup>2</sup> g<sup>−1</sup>)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">SSA<sub>macro</sub> (m<sup>2</sup> g<sup>−1</sup>)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">SSA<sub>meso</sub> (m<sup>2</sup> g<sup>−1</sup>)</th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">CCP01</td>
            <td rowspan="1" colspan="1" align="left" valign="top">−3.06</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.94</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.88</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.84</td>
            <td rowspan="1" colspan="1" align="char" char=" " charoff="50" valign="top">15317</td>
            <td rowspan="1" colspan="1" align="left" valign="top">1.15</td>
            <td rowspan="1" colspan="1" align="left" valign="top">31.6</td>
            <td rowspan="1" colspan="1" align="left" valign="top">1.4</td>
            <td rowspan="1" colspan="1" align="left" valign="top">30.2</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">CCP07</td>
            <td rowspan="1" colspan="1" align="left" valign="top">−3.05</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.95</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.88</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.76</td>
            <td rowspan="1" colspan="1" align="char" char=" " charoff="50" valign="top">7032</td>
            <td rowspan="1" colspan="1" align="left" valign="top">1.23</td>
            <td rowspan="1" colspan="1" align="left" valign="top">44.8</td>
            <td rowspan="1" colspan="1" align="left" valign="top">1.6</td>
            <td rowspan="1" colspan="1" align="left" valign="top">43.1</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">CCP09</td>
            <td rowspan="1" colspan="1" align="left" valign="top">−3.07</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.93</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.88</td>
            <td rowspan="1" colspan="1" align="left" valign="top">2.86</td>
            <td rowspan="1" colspan="1" align="char" char=" " charoff="50" valign="top">14818</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.92</td>
            <td rowspan="1" colspan="1" align="left" valign="top">29.6</td>
            <td rowspan="1" colspan="1" align="left" valign="top">1.2</td>
            <td rowspan="1" colspan="1" align="left" valign="top">28.5</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap orientation="portrait" id="d39e2401" position="anchor">
      <table frame="hsides" rules="groups">
        <thead valign="bottom">
          <tr>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Sample ID</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom"><italic>V</italic><sub>p</sub> (cm<sup>3</sup> g<sup>−1</sup>)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom"><italic>V</italic><sub>macro</sub> (cm<sup>3</sup> g<sup>−1</sup>)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom"><italic>V</italic><sub>meso</sub> (cm<sup>3</sup> g<sup>−1</sup>)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Φ (%)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Φ<sub>macro</sub> (%)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Φ<sub>meso</sub> (%)</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">SSQ</th>
            <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">χ<sup>2</sup>
</th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">CCP01</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0880</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0541</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0339</td>
            <td rowspan="1" colspan="1" align="left" valign="top">23.7</td>
            <td rowspan="1" colspan="1" align="left" valign="top">14.6</td>
            <td rowspan="1" colspan="1" align="left" valign="top">9.1</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.01</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.003</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">CCP07</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.1036</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0601</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0435</td>
            <td rowspan="1" colspan="1" align="left" valign="top">28.0</td>
            <td rowspan="1" colspan="1" align="left" valign="top">16.3</td>
            <td rowspan="1" colspan="1" align="left" valign="top">11.8</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.09</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.006</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1" align="left" valign="top">CCP09</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0773</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0472</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.0301</td>
            <td rowspan="1" colspan="1" align="left" valign="top">21.1</td>
            <td rowspan="1" colspan="1" align="left" valign="top">12.9</td>
            <td rowspan="1" colspan="1" align="left" valign="top">8.2</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.01</td>
            <td rowspan="1" colspan="1" align="left" valign="top">0.005</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </table-wrap-group>
</floats-group>
