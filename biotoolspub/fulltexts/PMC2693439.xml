<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version v40?>
<?ConverterInfo.XSLTName bmc2nlm.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2693439</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-143</article-id>
    <article-id pub-id-type="pmid">19442283</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-143</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PanGEA: Identification of allele specific gene expression using the 454 technology</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Kofler</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>robert@kofler.or.at</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Teixeira Torres</surname>
          <given-names>Tatiana</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>tttorres@unicamp.br</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Lelley</surname>
          <given-names>Tamas</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>tamas.lelley@boku.ac.at</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Schlötterer</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>christian.schloetterer@vu-wien.ac.at</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>University of Natural Resources and Applied Life Sciences, Department for Agrobiotechnology, Institute for Plant Production Biotechnology Konrad Lorenz Str 20, A-3430 Tulln, Austria</aff>
    <aff id="I2"><label>2</label>Institut für Populationsgenetik, Veterinärmedizinische Universität Wien, Josef Baumann Gasse 1, 1210 Wien, Austria</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>5</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>143</fpage>
    <lpage>143</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/143"/>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>11</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2009 Kofler et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Kofler et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Kofler
               Robert
               
               robert@kofler.or.at
            </dc:author><dc:title>
            PanGEA: Identification of allele specific gene expression using the 454 technology
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(1): 143-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:1&#x0003c;143&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Next generation sequencing technologies hold great potential for many biological questions. While mainly used for genomic sequencing, they are also very promising for gene expression profiling. Sequencing of cDNA does not only provide an estimate of the absolute expression level, it can also be used for the identification of allele specific gene expression.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We developed PanGEA, a tool which enables a fast and user-friendly analysis of allele specific gene expression using the 454 technology. PanGEA allows mapping of 454-ESTs to genes or whole genomes, displaying gene expression profiles, identification of SNPs and the quantification of allele specific gene expression. The intuitive GUI of PanGEA facilitates a flexible and interactive analysis of the data. PanGEA additionally implements a modification of the Smith-Waterman algorithm which deals with incorrect estimates of homopolymer length as occuring in the 454 technology</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>To our knowledge, PanGEA is the first tool which facilitates the identification of allele specific gene expression. PanGEA is distributed under the Mozilla Public License and available at: <ext-link ext-link-type="uri" xlink:href="http://www.kofler.or.at/bioinformatics/PanGEA"/></p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Next generation sequencing technologies hold great promise for biology in general [<xref ref-type="bibr" rid="B1">1</xref>]. They may be used to identify SNPs, pursue metagenomics, analyse DNA-protein interactions, and to discover non-coding RNA [<xref ref-type="bibr" rid="B2">2</xref>]. Furthermore, they may also be used for the analysis of the transcriptome [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>] supplementing the microarray technology. Compared to microarrays, sequencing based analysis of the transcriptome allows to tackle new biological problems such as the identification of allele specific gene expression, absolute measurement of gene expression, identification of structural variation, identification of alternative splicing sites and cross species comparison of gene expression.</p>
    <p>We developed PanGEA – The Comprehensive (ancient greek: pan) <underline>G</underline>ene <underline>E</underline>xpression <underline>A</underline>nalyzer – to enable a fast and user-friendly analysis of allele specific gene expression using the 454 technology. PanGEA can be used for quantification of gene expression, the identification of SNPs and the quantification of allele specific gene expression. Additionally, PanGEA implements a modification of the Smith-Waterman algorithm which deals with incorrect estimates of homopolymer length as occuring in the 454 technology.</p>
    <p>PanGEA and the accompanying console applications have been mainly developed for Windows but also work in Linux and Mac OsX. PanGEA is distributed under the Mozilla Public Licence and can be obtained from <ext-link ext-link-type="uri" xlink:href="http://www.kofler.or.at/bioinformatics/PanGEA"/> [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for the executable and Additional file <xref ref-type="supplementary-material" rid="S2">2</xref> for the source code of PanGEA].</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <sec>
      <title>PanGEA-BlastN</title>
      <p>To map ESTs to genes or whole genomes we developed PanGEA-BlastN. Similarly to Blast [<xref ref-type="bibr" rid="B5">5</xref>], PanGEA-BlastN uses an heuristic algorithm to find approximate hits between the database and the query sequence and then extends these hits with dynamic programming. PanGEA-BlastN is well-suited for mapping of EST reads obtained from next-generation sequencing technologies for the following reasons:</p>
      <p>• the seeding (heuristic search for approximate hits) has been optimized. Pairwise alignments will only be created for the best seeds, which reduces the number of dynamic programming steps and thus computation time</p>
      <p>• the necessity to map ESTs unambiguously is explicitly addressed</p>
      <p>• the dynamic programming algorithm has been modified to deal with uncertainty of homopolymer length as occurring in the 454-technology or in the Helicos system [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]</p>
      <p>• several modifications have been implemented which allow for introns in the EST sequences</p>
      <p>The mapping algorithm of PanGEA-BlastN, initially builds a hash-table of the database sequence and subsequently scans for approximate hits between the query and the database sequence (seeds). Computation time is reduced by the identification of the best candidates for the highest scoring hit from the longest diagonals, i.e. longest succession of shared words between the query and the database sequence. Only the longest diagonals will be subjected to dynamic programming. In addition to the classic Smith-Waterman algorithm PanGEA-BlastN provides a modified Smith-Waterman algorithm which is especially adapted to uncertainty of homopolymer length estimates occurring in several next-generation sequencing technologies [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. We also implemented improvements in the dynamic programming algorithm to increase computation efficiency Gotoh [<xref ref-type="bibr" rid="B8">8</xref>]. Unambiguously mapped ESTs are identified by comparing the scores of pairwise alignments. If the score difference between the best and the second best hit exceeds a minimum threshold, a mapping result is considered unambiguous. Ambiguous results are reported into a separate output file. PanGEA-BlastN also offers an intron-mode in which introns are already considered during seeding. Putative exons, separated by an intron, are individually aligned by dynamic programming (partial alignments) and subsequently aggregated into a composite alignment. Partial alignments, representing putative exons, are frequently overlapping with respect to the query sequence. For example, 'exon a' covering the bases 5 – 125 of a query sequence overlaps with 'exon b' which covers the bases 115 – 220. These overlaps are biologically not meaningful and have to be resolved. Therefore, PanGEA-BlastN calculates the alignment scores for each overlap individually and removes the overlap with the lowest score.</p>
      <p>In contrast to other Blast-like approaches, insignificant hits cannot be filtered by specification of a minimum alignment score. Rather, spurious hits can be filtered after a PanGEA-BlastN search with the option 'Manage Pairwise alignments', by specifying a minimum similarity, alignment length and read coverage (see below). This has the advantage that performing a separate PanGEA-BlastN search for each different setting is not necessary. Instead, a PanGEA-BlastN search is conducted only once and the optimal parameters can subsequently be quickly estimated. The total length of the database sequences is only limited by the amount of available RAM, an analysis using the <italic>D</italic>. <italic>melanogaster </italic>genome as database sequence (120 Mbp) typically requires about 700 MB of RAM. No upper limit exists for the number of query sequences as PanGEA-BlastN operates in batch mode. PanGEA-BlastN is available as a stand-alone console application and embedded into a user-friendly GUI in the software PanGEA.</p>
    </sec>
    <sec>
      <title>Seeding</title>
      <p>Identification of approximate hits between the database and the query sequence, i.e seeding, provides the starting point for subsequent dynamic programming steps. Since the most time consuming processes during mapping of ESTs is dynamic programming, minimizing the number of dynamic programming steps could considerably improve computational efficiency. For EST mapping to genes or genomes the primary interest is the identification of the corresponding genes, thus only a single best hit is expected for each EST. This particular requirement can be used to design an efficient EST-mapping-algorithm by searching, already during seeding, for best-hit-candidates and subsequently aligning only those with dynamic programming. In contrast to Blast which aligns each approximate hit between a database and a query sequence [<xref ref-type="bibr" rid="B5">5</xref>], PanGEA-BlastN only aligns the best-hit-candidates. Best-hit-candidates are identified by searching for the longest diagonals between a database and a query sequence [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>]. Briefly, a hash table is built, containing each non-overlapping word of length <italic>k </italic>in the database sequences. Each word holds information about the index of the database sequence (<italic>i</italic>) and the position within the database sequence (<italic>j</italic>). Words having a low information content, i.e. occur several-fold more often than expected by chance (<italic>n </italic>&gt; <italic>n</italic><sub><italic>max</italic></sub>), are removed from the hash table. The maximum number of occurrences <italic>n</italic><sub><italic>max </italic></sub>for words of length <italic>k </italic>in database sequences having the total length <italic>l</italic><sub><italic>d </italic></sub>can be calculated as</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1471-2105-10-143-i1.gif"/>
        </disp-formula>
      </p>
      <p>Where <italic>c </italic>denotes the low complexity cutoff specified by the user. After building a hash table, the query sequences are scanned. For each overlapping word of length <italic>k </italic>in the query sequence the corresponding matches in the hash table are identified. For these words, a shift (<italic>s</italic>) is calculated <italic>s </italic>= <italic>j </italic>- <italic>t </italic>where <italic>j </italic>is the position of the word in the database sequence and <italic>t </italic>the position in the query sequence. Subsequently, these words are sorted and parsed by searching for consecutive words with identical index (<italic>i</italic>) and identical (or similar) shift (<italic>s</italic>) [<xref ref-type="bibr" rid="B10">10</xref>]. A consecutive series of <italic>n </italic>identical indexes and shifts form a diagonal with length <italic>n</italic>. The algorithm searches for the longest diagonal, having the length <italic>n</italic><sub><italic>longest</italic></sub>, and passes all diagonals with a length <italic>n </italic>≥ <italic>n</italic><sub><italic>longest </italic></sub>- 1 as seeds to the dynamic programming algorithm (Fig. <xref ref-type="fig" rid="F1">1</xref>). The main difference to the algorithm of Ning et al. [<xref ref-type="bibr" rid="B10">10</xref>] is that PanGEA-BlastN uses the diagonals merely as seeds for dynamic programming. In addition to this, PanGEA-BlastN provides an optional modification to account for the presence of introns in the reads being mapped against genomic sequences. Consecutive diagonals of length <italic>n </italic>≥ 2 may be concatenated thus forming cumulative diagonals (Fig. <xref ref-type="fig" rid="F1">1</xref>). These cumulative diagonals allow for introns in the ESTs already during seeding. A maximum distance between the individual diagonals may be specified by the user.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Seeding during the two PanGEA-BlastN search modes</bold>. Individual word positions are marked with an <italic>x</italic>. Length of each diagonal (<italic>n</italic>) is shown above whereas the longest diagonal is indicated by a star. Diagonals being passed as seeds to the dynamic programming algorithm are shown shaded (<italic>n </italic>≥ <italic>n</italic><sub><italic>longest </italic></sub>- 1).</p>
        </caption>
        <graphic xlink:href="1471-2105-10-143-1"/>
      </fig>
    </sec>
    <sec>
      <title>Homopolymer adapted dynamic programming</title>
      <p>Several next-generation sequencing technologies, for example the 454-platform or the Helicos system introduce new types of sequencing errors [<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B13">13</xref>]. Most notably, the length of homopolymers is often estimated incorrectly [<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. These sequencing errors frequently cause the alignments of mismatching bases (Fig. <xref ref-type="fig" rid="F2">2</xref>), which can lead to wrong estimates of the evolutionary distance between two sequences or may complicate the identification of SNPs in downstream applications. We developed a novel Smith-Waterman algorithm, which accounts for this uncertainty of homopolymer length by allowing for gaps preferentially in homopolymers.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Pairwise alignments created with the homopolymer Smith-Waterman algorithm compared to the classic Smith-Waterman algorithm [for the whole alignments see Additional file </bold><xref ref-type="supplementary-material" rid="S3">3</xref><bold>]</bold>.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-143-2"/>
      </fig>
      <p>The basic idea of the algorithm is to adjust the gap-introduction penalty (gap-opening penalty) dynamically to the "homopolymer-terrain" of a nucleotide sequence, i.e to use a position specific gap-introduction penalty, which decreases linearly within hompolymers. Additionally, a reduced gap-introduction penalty should only be valid within the tract of a homopolymer, if a gap is to be extended beyond, the default gap-introduction penalty should be used.</p>
      <p>Let the two DNA sequences be <italic>D </italic>= <italic>d</italic><sub>1</sub><italic>d</italic><sub>2</sub>...<italic>d</italic><sub><italic>n </italic></sub>(database) and <italic>Q </italic>= <italic>q</italic><sub>1</sub><italic>q</italic><sub>2</sub>...<italic>q</italic><sub><italic>m </italic></sub>(query). Let <italic>I</italic><sub><italic>max </italic></sub>further be the default (maximum) gap-introduction penalty, <italic>E </italic>the gap-extension penalty, <italic>S </italic>the hit score and <italic>P</italic><sub><italic>mm </italic></sub>the mismatch penalty, then the minimum gap-introduction penalty <italic>I</italic><sub><italic>min </italic></sub>can be calculated.</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1471-2105-10-143-i2.gif"/>
        </disp-formula>
      </p>
      <p>Gap introduction penalties <italic>I </italic>&lt;<italic>I</italic><sub><italic>min </italic></sub>cause inconsistent alignments. Now two position specific gap introduction matrices can be constructed <italic>I</italic><sub><italic>D </italic></sub>= <italic>I</italic><sub><italic>d</italic>1</sub><italic>I</italic><sub><italic>d</italic>2</sub>...<italic>I</italic><sub><italic>dn </italic></sub>and <italic>I</italic><sub><italic>Q </italic></sub>= <italic>I</italic><sub><italic>q</italic>1</sub><italic>I</italic><sub><italic>q</italic>2</sub>...<italic>I</italic><sub><italic>qm </italic></sub>where each entry <italic>I</italic><sub><italic>di</italic></sub>, <italic>I</italic><sub><italic>qk </italic></sub>relates to an corresponding entry <italic>d</italic><sub><italic>i</italic></sub>, <italic>q</italic><sub><italic>k </italic></sub>in <italic>D </italic>and <italic>Q </italic>respectively, where 1 ≤ <italic>i </italic>≤ <italic>n </italic>and 1 ≤ <italic>k </italic>≤ <italic>m</italic>. The two matrices <italic>I</italic><sub><italic>D </italic></sub>and <italic>I</italic><sub><italic>Q </italic></sub>are instantiated with values for <italic>I</italic><sub><italic>di</italic></sub>, <italic>I</italic><sub><italic>qk </italic></sub>where <italic>I</italic><sub><italic>min </italic></sub>= <italic>I</italic><sub><italic>di</italic></sub>, <italic>I</italic><sub><italic>qk </italic></sub>= <italic>I</italic><sub><italic>max</italic></sub>. In the absence of homopolymers in sequences <italic>D </italic>and <italic>Q</italic>, the corresponding values <italic>I</italic><sub><italic>di </italic></sub>and <italic>I</italic><sub><italic>qk </italic></sub>respectively, are set to <italic>I</italic><sub><italic>max </italic></sub>whereas these values decrease linearly to <italic>I</italic><sub><italic>min </italic></sub>within homopolymers.</p>
      <p>For gaps of length <italic>t </italic>the affine gap penalty <italic>P</italic><sub><italic>gt </italic></sub>can be calculated [<xref ref-type="bibr" rid="B14">14</xref>]:</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1471-2105-10-143-i3.gif"/>
        </disp-formula>
      </p>
      <p>The homopolymer Smith-Waterman algorithm described here, additionally uses the homopolymer gap penalty <italic>P</italic><sub><italic>ht </italic></sub>for gaps of length <italic>t</italic>.</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1471-2105-10-143-i4.gif"/>
        </disp-formula>
      </p>
      <p>To restrict the introduced low-penalty-gaps to homopolymers, we introduced the homopolymer-transgression-penalty <italic>T</italic>, where <italic>x </italic>denotes the number of homopolymer transgressions. A homopolymer is transgressed each time <italic>q</italic><sub><italic>i </italic></sub>≠ <italic>q</italic><sub><italic>i</italic>+1 </sub>for insertions and <italic>d</italic><sub><italic>i </italic></sub>≠ <italic>d</italic><sub><italic>i</italic>+1 </sub>for deletions. A high value of <italic>T </italic>restricts low-penalty-gaps exclusively to homopolymer tracts, whereas <italic>T </italic>= 0 allows an extension of these gaps without imposing any restrictions. Introduction of the homopolymer transgression penalty additionally has the advantage that this facilitates the implementation of the homopolymer Smith-Waterman algorithm in the important modification described by Gotoh [<xref ref-type="bibr" rid="B8">8</xref>].</p>
      <p>Let <italic>s</italic>(<italic>d</italic><sub><italic>i</italic></sub>, <italic>q</italic><sub><italic>k</italic></sub>) be the similarity between the two bases <italic>d</italic><sub><italic>i </italic></sub>and <italic>q</italic><sub><italic>k </italic></sub>then a two dimensional matrix <italic>H </italic>can be constructed, similar as described by Smith and Waterman [<xref ref-type="bibr" rid="B14">14</xref>].</p>
      <p>
        <disp-formula>
          <graphic xlink:href="1471-2105-10-143-i5.gif"/>
        </disp-formula>
      </p>
      <p>Fig <xref ref-type="fig" rid="F2">2</xref> shows some pairwise alignments generated with the homopolymer Smith-Waterman algorithm compared to alignments generated by the classical Smith-Waterman implementation [for the whole alignments see Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>].</p>
      <p>We implemented this homopolymer Smith-Waterman algorithm together with the modification described by Gotoh [<xref ref-type="bibr" rid="B8">8</xref>], which reduces the required computation time from <italic>O</italic>(<italic>m</italic><sup>2</sup><italic>n</italic>) to <italic>O</italic>(<italic>mn</italic>) where m and n is the length of the database and the query sequence respectively [<xref ref-type="bibr" rid="B8">8</xref>]. We simply used four one-dimensional arrays which keep track of the highest possible gap score (normal gaps and homopolymer gaps, each in the database and the query sequence) instead of the two originally described. An implementation of this homopolymer Smith-Waterman algorithm is available as the stand-alone application 'PanGEA-SW'.</p>
    </sec>
    <sec>
      <title>Mapping statistics and management of pairwise alignments</title>
      <p>The mapped cDNA sequence reads can be managed using the user-friendly GUI of PanGEA. Summary statistics for all ESTs mapping to the same gene are provided, such as the number of sense-ESTs mapping to the gene or the number of ESTs containing large gaps (putative introns). Subsets of the mapped reads can be displayed and exported by providing several quality criteria, such as ambiguity, minimum length of the alignment, minimum similarity, minimum coverage of the EST, presence or absence of large gaps (putative introns) or transcript orientation (sense, anti-sense). The subsets may be exported and used for a subsequent analysis, for example SNP identification.</p>
    </sec>
    <sec>
      <title>SNP identification</title>
      <p>SNPs are identified from the pairwise alignments. If a list of validated SNPs is available, PanGEA provides the option to use only these SNPs for frequency estimates from the sequence reads. If no validated SNPs are available, PanGEA identifies SNPs from the sequence reads and provides several options to minimize the number of miscalled SNPs. PanGEA can account for the quality scores of the sequences, determining the sequence quality at the SNP-site and its neighborhood.</p>
      <p>The strategy for SNP-identification in PanGEA is to first identify SNPs using not-stringent parameters and to subsequently select a subset of these SNPs with the option 'Manage SNPs' using stringent parameters. This has the main advantage that a separate SNP-identification for each different parameters is not necessary, rather SNPs are identified only once and subsets can be flexible selected. This approach allows for an interactive fine-tuning of the selected SNPs and SNP-alleles. To test the SNP identification module we created extensive unit tests using NUnit [see Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>].</p>
      <p>The SNP identification module is available as stand-alone console application 'PanGEA-SNP' and has been integrated into the software PanGEA.</p>
    </sec>
    <sec>
      <title>Identification of allele specific gene expression and visualisation of SNPs</title>
      <p>PanGEA provides two options to display the identified SNPs. Either summary results are displayed for each SNP-site (Fig. <xref ref-type="fig" rid="F3">3</xref>) or for each database sequence (typically corresponding to a gene or transcript). The summary statistics for each SNP-site furthermore provide a convenient way to quantify allele specific gene expression by displaying the SNP-allele frequencies at each SNP-site (Fig. <xref ref-type="fig" rid="F3">3</xref>). Optionally, subsets of the SNP-alleles can be displayed according to quality, direction of transcription (sense and anti-sense) and minimum frequency. The quality of SNP-alleles can be assessed by several criteria such as the minimum sequence quality of the SNP, the minimum sequence quality in the neighborhood of the SNP and the minimum distance from the alignment ends.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Summary statistics for each SNP-site and quantification of allele specific gene expression by the frequencies of individual SNP-alleles</bold>.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-143-3"/>
      </fig>
    </sec>
    <sec>
      <title>Methods for benchmarking</title>
      <p>We obtained the <italic>Drosophila melanogaster </italic>genome (release 5.5), gene sequences (release 5.5) and the transcripts (release 5.5) from Flybase <ext-link ext-link-type="uri" xlink:href="http://www.flybase.org/"/>. All benchmarks were carried out on a standard desktop computer with 2 GB of RAM and an Intel™Core Duo<sup>®</sup>2 × 2.4 GHz processor. For benchmarking, a set of 26 040 454-ESTs, with an average length of 106 bp, derived from the 3'-end of <italic>D</italic>. <italic>melanogaster </italic>transcripts, were downloaded from GenBank [accession numbers: <ext-link ext-link-type="gen" xlink:href="EV574767">EV574767</ext-link> – <ext-link ext-link-type="gen" xlink:href="EV600806">EV600806</ext-link>; [<xref ref-type="bibr" rid="B4">4</xref>]]. These 454-ESTs were mapped to the genes of <italic>D</italic>. <italic>melanogaster </italic>using stand-alone BLAST 2.2.13 and PanGEA-BlastN. Both programs used only one of the two available processors. The following PanGEA-BlastN settings were used: word length 11; minimum diagonal 2; low complexity threshold 10; hit score 3; mismatch penalty 5; gap introduction penalty 11; gap extension penalty 2; homopolymer transgression penalty 3; ambiguity threshold 10; homopolymer Smith-Waterman; intron mode was off; The defaults settings were used for NCBI-BlastN, except the e-value was set to 10<sup>-10 </sup>and the tabular output format (-m 8) was used. The pairwise alignments, resulting from the mapping of these 26 000 454-ESTs to the genes of <italic>D</italic>. <italic>melanogaster</italic>, were used for the subsequent identification of SNPs.</p>
      <p>To test the performance of PanGEA-BlastN with the 454-platform in detail, we developed a console application which randomly excises 1000 ESTs from the transcripts of <italic>D</italic>. <italic>melanogaster</italic>, randomly introduces pseudo-sequencing-errors (0%, 5% and 10%) into these ESTs and maps them either to the genes or the whole genome of <italic>D</italic>. <italic>melanogaster </italic>using PanGEA-BlastN. An EST was considered correctly mapped to the genes, if the gene-ID (specified in header of transcript) matched the mapping result, whereas an EST was considered correctly mapped to the whole genome, if the chromosome-ID as well as the position within the chromosome (specified in header of transcript) matched the mapping result.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Influence of the mapping parameters used by PanGEA-BlastN</title>
      <p>We evaluated the influence of the PanGEA-BlastN parameters on the mapping accuracy and computation time by mapping 1000 randomly generated 250 bp fragments from <italic>D. melanogaster </italic>transcripts (release 5.5) to the corresponding genes.</p>
      <p>First, we determined the influence of the low complexity cutoff (c), which reflects the maximum frequency of a word in a hash-table. Words occurring c times more frequent than expected by chance were not considered. As expected the mapping accuracy increased with 'c' on the expense of computation time (Fig. <xref ref-type="fig" rid="F4">4a</xref>). Nevertheless, the number of inaccurately mapped 454-ESTs was low (&lt; 1.20%) irrespective of the low complexity cutoff.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Effect of the most important parameters on the performance of PanGEA-BlastN</bold>. Values were calculated for mapping of 1000 randomly generated 250 bp fragments from <italic>D</italic>. <italic>melanogaster </italic>transcripts to the corresponding genes. Benchmarks were calculated in triplicate for five (or more) datapoints [see Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>]. If not stated otherwise the following parameters were used: word length 11; minimum diagonal 3; low complexity threshold 20; ambiguity 12.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-143-4"/>
      </fig>
      <p>Next we calculated the influence of the ambiguity threshold, which measures the difference between the best and the second best hit. Increasing the ambiguity threshold resulted in a moderate reduction for incorrectly mapped 454-ESTs. While &lt; 1.0% were mapped incorrectly when only the best hit (ambiguity threshold = 0) was considered, an ambiguity threshold of 100 had &lt; 0.5% incorrectly mapped 454-ESTs. The trade off of this increase in mapping accuracy was an increase of ambiguously mapped 454-ESTs. Rather than 9% for the best hit, an ambiguity threshold of 100 resulted in 13% ambiguous hits (Fig. <xref ref-type="fig" rid="F4">4b</xref>). The ambiguity threshold only has a minor influence on computation time [see Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>]. On the other hand, increasing the word size dramatically reduces the computation time on the expense of the mapping accuracy (Fig. <xref ref-type="fig" rid="F4">4c</xref>). The last parameter evaluated was the 'minimum diagonal length'. Similar to word size an increase in minimum diagonal length reduced the computational time on the expense of mapping accuracy (Fig. <xref ref-type="fig" rid="F4">4c</xref>).</p>
      <p>These results illustrate that optimal parameters represent a compromise between computation time, specificity and sensitivity.</p>
    </sec>
    <sec>
      <title>Mapping performance of PanGEA-BlastN</title>
      <p>To assess the performance PanGEA-BlastN we compared PanGEA-BlastN with NCBI-BlastN. A set of more than 25,000 454 ESTs [<xref ref-type="bibr" rid="B4">4</xref>], with an average length of 106 bp were mapped to their gene sequences using PanGEA-BlastN and NCBI-BlastN. Despite a considerable reduced computation time, PanGEA-BlastN generated very similar results as NCBI-BlastN (Table <xref ref-type="table" rid="T1">1</xref>), suggesting that the simplified search did not compromise the mapping efficiency.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Comparision of the performance of PanGEA-BlastN with NCBI-BlastN [<xref ref-type="bibr" rid="B5">5</xref>]. </p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="right">NCBI</td>
              <td align="right">PanGEA</td>
              <td align="right"><italic>P </italic>∩ <italic>N</italic><sup>1</sup></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="right">Time</td>
              <td align="right">47 min</td>
              <td align="right">6 min</td>
              <td align="right">-</td>
            </tr>
            <tr>
              <td align="right">Hits</td>
              <td align="right">23 512</td>
              <td align="right">24 600</td>
              <td align="right">23 436</td>
            </tr>
            <tr>
              <td align="right">Ambiguous</td>
              <td align="right">1 787</td>
              <td align="right">1 887</td>
              <td align="right">1 615</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>More than 25,000 454-ESTs from <italic>D</italic>. <italic>melanogaster </italic>[<xref ref-type="bibr" rid="B4">4</xref>] were mapped to their genes. Ambiguity was reported if the score of the best hit differed from the score of the second best hit by less than 10.</p>
          <p><sup>1</sup><italic>PanGEA </italic>∩ <italic>NCBI</italic>, i.e mapping results in which both tools agree</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Nevertheless, we noted some differences between PanGEA-BlastN and NCBI-BlastN. To evaluate the mapping efficiency of PanGEA-BlastN, we computationally generated 1000 454-EST-like sequences from <italic>D. melanogaster </italic>transcripts and mapped them either to gene sequences (including intronic sequences) or to the entire genome. To account for sequencing errors, we also introduced 5% and 10% mutations prior to mapping.</p>
      <p>The performance of PanGEA-BlastN was assessed using the following criteria: (i) the number of ambiguous hits (ii) the number of correct hits, including ambiguous hits containing the correct hit, (iii) the number of wrong hits, including ambiguous hits not containing the correct hit (iv) the number of not-mapped ESTs, (v) the number of identified large gaps (&gt; 50 bp; putative introns) and finally (vi) the required computation time.</p>
      <p>A very high proportion (&gt; 99.5%) of the ESTs was correctly mapped irrespectively of the sequence divergence (Table <xref ref-type="table" rid="T2">2</xref>). This mapping accuracy could be further improved by changing some of the parameters, such as word size (see previous section). We noted a substantial discrepancy of unambiguously mapped reads for the gene sequences and genomic sequences. Despite a higher complexity, fewer reads (2.5%) were ambiguously mapped to the genome than to the gene sequences (10%). The reason for this discrepancy are ovelapping/nested genes (data not shown). Most importantly, the mapping accuracy was not effected when the intron discovery mode was switched on. However, several large gaps (i.e.: introns) were discovered, emphasizing the need for the intron discovery mode. Increasing the length of the 454-ESTs beyond 100 bp did not result in an increased mapping efficiency, suggesting that this length is sufficient for reliable mapping.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Performance of PanGEA-BlastN with the 454-platform using the recommended settings. </p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center" colspan="14">tag-to-gene mapping<sup>1</sup></td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td align="center" colspan="6">normal mode</td>
              <td align="center" colspan="6">Intron mode</td>
            </tr>
            <tr>
              <td align="left">L<sup>2</sup></td>
              <td align="right">s<sup>3</sup></td>
              <td align="right">a<sup>4</sup></td>
              <td align="right">c<sup>5</sup></td>
              <td align="right">w<sup>6</sup></td>
              <td align="right">n<sup>7</sup></td>
              <td align="right">i<sup>8</sup></td>
              <td align="right">t<sup>9</sup></td>
              <td align="right">a<sup>4</sup></td>
              <td align="right">c<sup>5</sup></td>
              <td align="right">w<sup>6</sup></td>
              <td align="right">n<sup>7</sup></td>
              <td align="right">i<sup>8</sup></td>
              <td align="right">t<sup>9</sup></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">126</td>
              <td align="right">997</td>
              <td align="right">1</td>
              <td align="right">2</td>
              <td align="right">6</td>
              <td align="right">10</td>
              <td align="right">111</td>
              <td align="right">993</td>
              <td align="right">5</td>
              <td align="right">2</td>
              <td align="right">63</td>
              <td align="right">10</td>
            </tr>
            <tr>
              <td align="left">100</td>
              <td align="right">95</td>
              <td align="right">95</td>
              <td align="right">932</td>
              <td align="right">6</td>
              <td align="right">62</td>
              <td align="right">0</td>
              <td align="right">11</td>
              <td align="right">104</td>
              <td align="right">952</td>
              <td align="right">6</td>
              <td align="right">42</td>
              <td align="right">11</td>
              <td align="right">11</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">42</td>
              <td align="right">408</td>
              <td align="right">13</td>
              <td align="right">579</td>
              <td align="right">0</td>
              <td align="right">4</td>
              <td align="right">35</td>
              <td align="right">450</td>
              <td align="right">10</td>
              <td align="right">540</td>
              <td align="right">0</td>
              <td align="right">5</td>
            </tr>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">86</td>
              <td align="right">993</td>
              <td align="right">5</td>
              <td align="right">2</td>
              <td align="right">87</td>
              <td align="right">34</td>
              <td align="right">108</td>
              <td align="right">991</td>
              <td align="right">8</td>
              <td align="right">1</td>
              <td align="right">206</td>
              <td align="right">40</td>
            </tr>
            <tr>
              <td align="left">200</td>
              <td align="right">95</td>
              <td align="right">88</td>
              <td align="right">988</td>
              <td align="right">8</td>
              <td align="right">4</td>
              <td align="right">88</td>
              <td align="right">38</td>
              <td align="right">91</td>
              <td align="right">994</td>
              <td align="right">5</td>
              <td align="right">1</td>
              <td align="right">170</td>
              <td align="right">41</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">90</td>
              <td align="right">953</td>
              <td align="right">5</td>
              <td align="right">42</td>
              <td align="right">44</td>
              <td align="right">37</td>
              <td align="right">78</td>
              <td align="right">885</td>
              <td align="right">13</td>
              <td align="right">102</td>
              <td align="right">75</td>
              <td align="right">36</td>
            </tr>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">114</td>
              <td align="right">986</td>
              <td align="right">10</td>
              <td align="right">4</td>
              <td align="right">211</td>
              <td align="right">84</td>
              <td align="right">94</td>
              <td align="right">996</td>
              <td align="right">3</td>
              <td align="right">1</td>
              <td align="right">407</td>
              <td align="right">90</td>
            </tr>
            <tr>
              <td align="left">300</td>
              <td align="right">95</td>
              <td align="right">86</td>
              <td align="right">988</td>
              <td align="right">10</td>
              <td align="right">2</td>
              <td align="right">188</td>
              <td align="right">81</td>
              <td align="right">102</td>
              <td align="right">990</td>
              <td align="right">6</td>
              <td align="right">4</td>
              <td align="right">354</td>
              <td align="right">95</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">103</td>
              <td align="right">984</td>
              <td align="right">8</td>
              <td align="right">8</td>
              <td align="right">162</td>
              <td align="right">85</td>
              <td align="right">99</td>
              <td align="right">992</td>
              <td align="right">7</td>
              <td align="right">1</td>
              <td align="right">263</td>
              <td align="right">93</td>
            </tr>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">74</td>
              <td align="right">994</td>
              <td align="right">4</td>
              <td align="right">2</td>
              <td align="right">312</td>
              <td align="right">128</td>
              <td align="right">85</td>
              <td align="right">988</td>
              <td align="right">7</td>
              <td align="right">5</td>
              <td align="right">574</td>
              <td align="right">153</td>
            </tr>
            <tr>
              <td align="left">400</td>
              <td align="right">95</td>
              <td align="right">87</td>
              <td align="right">986</td>
              <td align="right">12</td>
              <td align="right">2</td>
              <td align="right">300</td>
              <td align="right">137</td>
              <td align="right">79</td>
              <td align="right">981</td>
              <td align="right">13</td>
              <td align="right">6</td>
              <td align="right">499</td>
              <td align="right">153</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">78</td>
              <td align="right">986</td>
              <td align="right">14</td>
              <td align="right">0</td>
              <td align="right">250</td>
              <td align="right">150</td>
              <td align="right">85</td>
              <td align="right">993</td>
              <td align="right">4</td>
              <td align="right">3</td>
              <td align="right">366</td>
              <td align="right">151</td>
            </tr>
            <tr>
              <td colspan="14">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center" colspan="14">tag-to-genome mapping<sup>10</sup></td>
            </tr>
            <tr>
              <td colspan="14">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">32</td>
              <td align="right">1000</td>
              <td align="right">0</td>
              <td align="right">0</td>
              <td align="right">11</td>
              <td align="right">11</td>
              <td align="right">21</td>
              <td align="right">998</td>
              <td align="right">1</td>
              <td align="right">1</td>
              <td align="right">42</td>
              <td align="right">10</td>
            </tr>
            <tr>
              <td align="left">100</td>
              <td align="right">95</td>
              <td align="right">27</td>
              <td align="right">973</td>
              <td align="right">2</td>
              <td align="right">25</td>
              <td align="right">1</td>
              <td align="right">14</td>
              <td align="right">23</td>
              <td align="right">984</td>
              <td align="right">2</td>
              <td align="right">14</td>
              <td align="right">24</td>
              <td align="right">22</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">14</td>
              <td align="right">399</td>
              <td align="right">4</td>
              <td align="right">597</td>
              <td align="right">0</td>
              <td align="right">14</td>
              <td align="right">11</td>
              <td align="right">337</td>
              <td align="right">13</td>
              <td align="right">650</td>
              <td align="right">1</td>
              <td align="right">4</td>
            </tr>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">31</td>
              <td align="right">997</td>
              <td align="right">3</td>
              <td align="right">0</td>
              <td align="right">93</td>
              <td align="right">59</td>
              <td align="right">25</td>
              <td align="right">994</td>
              <td align="right">6</td>
              <td align="right">0</td>
              <td align="right">190</td>
              <td align="right">55</td>
            </tr>
            <tr>
              <td align="left">200</td>
              <td align="right">95</td>
              <td align="right">31</td>
              <td align="right">993</td>
              <td align="right">7</td>
              <td align="right">0</td>
              <td align="right">82</td>
              <td align="right">49</td>
              <td align="right">20</td>
              <td align="right">995</td>
              <td align="right">5</td>
              <td align="right">0</td>
              <td align="right">154</td>
              <td align="right">51</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">20</td>
              <td align="right">961</td>
              <td align="right">1</td>
              <td align="right">38</td>
              <td align="right">42</td>
              <td align="right">45</td>
              <td align="right">12</td>
              <td align="right">956</td>
              <td align="right">1</td>
              <td align="right">43</td>
              <td align="right">99</td>
              <td align="right">47</td>
            </tr>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">26</td>
              <td align="right">998</td>
              <td align="right">2</td>
              <td align="right">0</td>
              <td align="right">214</td>
              <td align="right">94</td>
              <td align="right">27</td>
              <td align="right">997</td>
              <td align="right">3</td>
              <td align="right">0</td>
              <td align="right">341</td>
              <td align="right">107</td>
            </tr>
            <tr>
              <td align="left">300</td>
              <td align="right">95</td>
              <td align="right">16</td>
              <td align="right">998</td>
              <td align="right">2</td>
              <td align="right">0</td>
              <td align="right">178</td>
              <td align="right">96</td>
              <td align="right">21</td>
              <td align="right">995</td>
              <td align="right">5</td>
              <td align="right">0</td>
              <td align="right">285</td>
              <td align="right">113</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">23</td>
              <td align="right">972</td>
              <td align="right">9</td>
              <td align="right">19</td>
              <td align="right">151</td>
              <td align="right">99</td>
              <td align="right">21</td>
              <td align="right">989</td>
              <td align="right">10</td>
              <td align="right">1</td>
              <td align="right">250</td>
              <td align="right">102</td>
            </tr>
            <tr>
              <td/>
              <td align="right">100</td>
              <td align="right">21</td>
              <td align="right">999</td>
              <td align="right">1</td>
              <td align="right">0</td>
              <td align="right">328</td>
              <td align="right">194</td>
              <td align="right">20</td>
              <td align="right">998</td>
              <td align="right">2</td>
              <td align="right">0</td>
              <td align="right">496</td>
              <td align="right">181</td>
            </tr>
            <tr>
              <td align="left">400</td>
              <td align="right">95</td>
              <td align="right">15</td>
              <td align="right">998</td>
              <td align="right">2</td>
              <td align="right">0</td>
              <td align="right">287</td>
              <td align="right">144</td>
              <td align="right">23</td>
              <td align="right">993</td>
              <td align="right">7</td>
              <td align="right">0</td>
              <td align="right">422</td>
              <td align="right">178</td>
            </tr>
            <tr>
              <td/>
              <td align="right">90</td>
              <td align="right">19</td>
              <td align="right">996</td>
              <td align="right">4</td>
              <td align="right">0</td>
              <td align="right">260</td>
              <td align="right">168</td>
              <td align="right">20</td>
              <td align="right">992</td>
              <td align="right">8</td>
              <td align="right">0</td>
              <td align="right">400</td>
              <td align="right">168</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Values were calculated for mapping 1000 randomly excised ESTs, either to the genes or to the whole genome of <italic>D. melanogaster</italic></p>
          <p><sup>1 </sup>settings: word length 11; minimum diagonal 3; low complexity threshold 10; homopolymer Smith-Waterman algorithm; no maximum intron length</p>
          <p><sup>2 </sup>length of the tags in bp</p>
          <p><sup>3 </sup>similarity of the tag with the target sequence in percent</p>
          <p><sup>4 </sup>ambiguous mapping results; min score difference for unambiguous best hit 12</p>
          <p><sup>5 </sup>correctly mapped tags (including ambiguous results containing the correct hit)</p>
          <p><sup>6 </sup>wrongly mapped tags (including ambiguous results not containing the correct hit)</p>
          <p><sup>7 </sup>no hit identified</p>
          <p><sup>8 </sup>number of long gaps (&gt; 50 bp), putative introns</p>
          <p><sup>9 </sup>mapping time in seconds, without the time required for constructing the word hash-table</p>
          <p><sup>10 </sup>settings as above, only the maximum intron length was set to 5000 bp</p>
        </table-wrap-foot>
      </table-wrap>
      <p>However, considering the benchmarks of Table <xref ref-type="table" rid="T2">2</xref> we recommend the following settings for mapping of 454-ESTs, which are an attempt to optimize the antagonistic demands for efficiency, sensitivity and specificity: word length 11 (10–12), minimum diagonal length 3 (2–3), low complexity cutoff 10 (10–50); intron mode on. These settings are used as defaults by PanGEA-BlastN.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion and conclusion</title>
    <p>PanGEA provides an important step towards the use of massively parallel sequencing for gene expression analysis. While it is currently not apparent which of the new sequencing technologies will provide the most appropriate tool for gene expression analysis, the software tool PanGEA allows an accurate quantification of allele specific gene expression.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>Project name: PanGEA</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.kofler.or.at/bioinformatics/PanGEA"/></p>
    <p>Operating system(s): Windows, Linux and Mac Os X</p>
    <p>Programming language: C#</p>
    <p>Other requirements: .Net Framework 2.0 for Windows; Mono 2.0 for Mac Os X and Linux</p>
    <p>License: Mozilla Public License</p>
    <p>Any restrictions to use by non-academics: none</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>RK, TTT and CS conceived the project. RK did the programming. CS supervised the project. RK, TTT, TL and CS wrote the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>PanGEA 1.04</bold>. A platform independent executable of PanGEA.</p>
      </caption>
      <media xlink:href="1471-2105-10-143-S1.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>PanGEA source code</bold>. The source code of PanGEA.</p>
      </caption>
      <media xlink:href="1471-2105-10-143-S2.rar" mimetype="audio" mime-subtype="x-realaudio">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Comparison of alignments</bold>. Compares the pairwise alignments created with the homopolymer Smith-Waterman algorithm to the classic Smith-Waterman algorithm.</p>
      </caption>
      <media xlink:href="1471-2105-10-143-S3.txt" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>NUnit test for the SNP identification module</bold>. A zip file containing the unit text for the SNP modification mudule as C# code.</p>
      </caption>
      <media xlink:href="1471-2105-10-143-S4.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Performance of PanGEA-BlastN</bold>. Provides detailed benchmarks for PanGEA-BlastN.</p>
      </caption>
      <media xlink:href="1471-2105-10-143-S5.xls" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work was financially supported by the Austrian Science Fund (P19467-B11 (CS), P18414-B14 (TL)) and a fellowship of the Brazilian National Council for Scientific and Technological Development (CNPq) to T.T.T. RK thanks Thomas Kofler for providing the web space and helpful comments on programming in C#.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Next-generation sequencing transforms today's biology</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>16</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">18165802</pub-id>
        <pub-id pub-id-type="doi">10.1038/nmeth1156</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>The impact of next-generation sequencing technology on genetics</article-title>
        <source>Trends Genet</source>
        <year>2008</year>
        <volume>24</volume>
        <pub-id pub-id-type="pmid">18262675</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wilkerson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ohlrogge</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Sampling the Arabidopsis transcriptome with massively parallel pyrosequencing</article-title>
        <source>Plant Physiol</source>
        <year>2007</year>
        <volume>144</volume>
        <fpage>32</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="pmid">17351049</pub-id>
        <pub-id pub-id-type="doi">10.1104/pp.107.096677</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torres</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Metta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ottenwalder</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schlötterer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling by massively parallel sequencing</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>172</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">18032722</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.6984908</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margulies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Egholm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Attiya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bader</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bemben</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Berka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Braverman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Dewell</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fierro</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gomes</surname>
            <given-names>XV</given-names>
          </name>
          <name>
            <surname>Godwin</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Helgesen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Irzyk</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Jando</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Alenquer</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Jarvie</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Jirage</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lanza</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Leamon</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Lefkowitz</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lohman</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Makhijani</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>McDade</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nobile</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Plant</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Puc</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Ronan</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Sarkis</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Simons</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tartaro</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Tomasz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vogt</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Volkmer</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Begley</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Rothberg</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Genome sequencing in microfabricated high-density picolitre reactors</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <fpage>376</fpage>
        <lpage>80</lpage>
        <comment>Epub 2005 Jul 31</comment>
        <pub-id pub-id-type="pmid">16056220</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Buzby</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Babcock</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Beer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bowers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Braslavsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Causey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Colonell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dimeo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Efcavitch</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Giladi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jarosz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lapen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Moulton</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Steinmann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thayer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tyurina</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Single-molecule DNA sequencing of a viral genome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>106</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">18388294</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.1150427</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>An improved algorithm for matching biological sequences</article-title>
        <source>J Mol Biol</source>
        <year>1982</year>
        <volume>162</volume>
        <fpage>705</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">7166760</pub-id>
        <pub-id pub-id-type="doi">10.1016/0022-2836(82)90398-9</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearson</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Improved tools for biological sequence comparison</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1988</year>
        <volume>85</volume>
        <fpage>2444</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">3162770</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.85.8.2444</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>a fast search method for large DNA databases</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1725</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">11591649</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.194201</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Accuracy and quality of massively parallel DNA pyrosequencing</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R143</fpage>
        <pub-id pub-id-type="pmid">17659080</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-7-r143</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brockman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giannoukos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Quality scores and SNP detection in sequencing-by-synthesis systems</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>22</volume>
        <fpage>22</fpage>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics challenges of new sequencing technology</article-title>
        <source>Trends Genet</source>
        <year>2008</year>
        <volume>8</volume>
        <fpage>8</fpage>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Identification of common molecular subsequences</article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <fpage>195</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">7265238</pub-id>
        <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
