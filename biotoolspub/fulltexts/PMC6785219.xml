<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6785219</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007309</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00180</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Natural antisense transcripts</subject>
                  <subj-group>
                    <subject>MicroRNAs</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Gene regulation</subject>
              <subj-group>
                <subject>MicroRNAs</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Animal Genomics</subject>
              <subj-group>
                <subject>Mammalian Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
              <subj-group>
                <subject>RNA stem-loop structure</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
                <subj-group>
                  <subject>RNA stem-loop structure</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Complexity</subject>
            <subj-group>
              <subject>Introns</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Complexity</subject>
              <subj-group>
                <subject>Introns</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Agriculture</subject>
          <subj-group>
            <subject>Animal Management</subject>
            <subj-group>
              <subject>Animal Performance</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Embryology</subject>
            <subj-group>
              <subject>Embryos</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome Annotation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>miRWoods: Enhanced precursor detection and stacked random forests for the sensitive detection of microRNAs</article-title>
      <alt-title alt-title-type="running-head">Sensitive and accurate detection of microRNAs with miRWoods</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4135-6591</contrib-id>
        <name>
          <surname>Bell</surname>
          <given-names>Jimmy</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Larson</surname>
          <given-names>Maureen</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7262-8137</contrib-id>
        <name>
          <surname>Kutzler</surname>
          <given-names>Michelle</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bionaz</surname>
          <given-names>Massimo</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Löhr</surname>
          <given-names>Christiane V.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7285-1977</contrib-id>
        <name>
          <surname>Hendrix</surname>
          <given-names>David</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>School of Electrical Engineering and Computer Science, Oregon State University, Corvallis, OR, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Departments of Clinical and Biomedical Sciences, College of Veterinary Medicine, Oregon State University, Corvallis, OR, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Animal and Rangeland Sciences, Oregon State University, Corvallis, OR, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Biochemistry and Biophysics, Oregon State University, Corvallis, OR, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nie</surname>
          <given-names>Qing</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of California Irvine, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>david.hendrix@oregonstate.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <volume>15</volume>
    <issue>10</issue>
    <elocation-id>e1007309</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Bell et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Bell et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007309.pdf"/>
    <abstract>
      <p>MicroRNAs are conserved, endogenous small RNAs with critical post-transcriptional regulatory functions throughout eukaryota, including prominent roles in development and disease. Despite much effort, microRNA annotations still contain errors and are incomplete due especially to challenges related to identifying valid miRs that have small numbers of reads, to properly locating hairpin precursors and to balancing precision and recall. Here, we present miRWoods, which solves these challenges using a duplex-focused precursor detection method and stacked random forests with specialized layers to detect mature and precursor microRNAs, and has been tuned to optimize the harmonic mean of precision and recall. We trained and tuned our discovery pipeline on data sets from the well-annotated human genome, and evaluated its performance on data from mouse. Compared to existing approaches, miRWoods better identifies precursor spans, and can balance sensitivity and specificity for an overall greater prediction accuracy, recalling an average of 10% more annotated microRNAs, and correctly predicts substantially more microRNAs with only one read. We apply this method to the under-annotated genomes of <italic>Felis catus</italic> (domestic cat) and <italic>Bos taurus</italic> (cow). We identified hundreds of novel microRNAs in small RNA sequencing data sets from muscle and skin from cat, from 10 tissues from cow and also from human and mouse cells. Our novel predictions include a microRNA in an intron of tyrosine kinase 2 (TYK2) that is present in both cat and cow, as well as a family of mirtrons with two instances in the human genome. Our predictions support a more expanded miR-2284 family in the bovine genome, a larger mir-548 family in the human genome, and a larger let-7 family in the feline genome.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>While the computational prediction of microRNA loci from high-throughput sequence data is well-studied, challenges persist in defining the minimum number of reads required for a locus to be evaluated, as well as in defining the precursor span. We present a new method, “miRWoods”, which has greater recall of known microRNAs, while also achieving as good or better overall performance. Our approach uses improved duplex-based methods of precursor detection and a pair of random forest layers that sensitively detect mature products and precursors. We trained our model on data from human, and confirmed that it can successfully be applied cross-species by evaluating predictions for the mouse genome. We then applied our approach to new sequencing data mapped to the under-annotated genomes of cow and cat. We were able to use miRWoods to improve annotations for cat and cow microRNAs, and found novel microRNAs in human and mouse, and identified errors in current annotations.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R56 AG053460</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7285-1977</contrib-id>
          <name>
            <surname>Hendrix</surname>
            <given-names>David A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>National Institutes of Health</institution>
        </funding-source>
        <award-id>R01 AG061406</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7285-1977</contrib-id>
          <name>
            <surname>Hendrix</surname>
            <given-names>David A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Medical Research Foundation of Oregon</institution>
        </funding-source>
        <award-id>1414</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7285-1977</contrib-id>
          <name>
            <surname>Hendrix</surname>
            <given-names>David A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100009612</institution-id>
            <institution>Oregon State University</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Start-up funds</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7285-1977</contrib-id>
          <name>
            <surname>Hendrix</surname>
            <given-names>David A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work is supported by OSHU MRF grant number 1414, NIH grant R56 AG053460, Start-up funds from Oregon State University, and NIH grant R01 AG061406 for David A. Hendrix. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="4"/>
      <page-count count="29"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The datasets supporting the conclusions of this article are available in the GEO repository under the accession GSE125279, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE125279">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE125279</ext-link>. The miRWoods software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/hendrixlab/miRWoods">https://github.com/hendrixlab/miRWoods</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The datasets supporting the conclusions of this article are available in the GEO repository under the accession GSE125279, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE125279">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE125279</ext-link>. The miRWoods software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/hendrixlab/miRWoods">https://github.com/hendrixlab/miRWoods</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>MicroRNAs (miRNAs, miRs) are a highly-conserved class of small endogenous RNA molecules that are involved in post-transcriptional gene silencing by acting as a guide RNA for the RNA-induced silencing complex (RISC). The biogenesis of microRNAs begins with the generation of a primary transcript (pre-miR), which folds into a structure containing one or more ~70-nt hairpins. These hairpin precursors (pre-miRs) are cut at the base by Drosha [<xref rid="pcbi.1007309.ref001" ref-type="bibr">1</xref>]. After export from the nucleus, the loop of the hairpin is cut by Dicer. The resultant double-stranded RNA duplex is unwound to produce two mature ~22-nt microRNAs (miRs), named 5′ and 3′ after the arm of the hairpin from which they derive. Typically, only one of the mature microRNAs is incorporated into RISC, and the other microRNA is degraded and designated miR-star or miR*. The seed sequence at positions 2–8 of RISC-bound mature microRNAs binds to complementary sequences in the 3′ untranslated regions (UTRs) of mRNAs.</p>
    <p>Initially discovered through genetic screens in <italic>C</italic>. <italic>elegans</italic> [<xref rid="pcbi.1007309.ref002" ref-type="bibr">2</xref>], the advent of deep sequencing data has enabled the high-throughput discovery and annotation of novel microRNAs. Most microRNA prediction approaches begin by aligning size-selected deep sequenced RNA (small RNA-seq) reads to the genome, and then the identification of overlapping aligned reads, “read stacks”. These read stacks correspond to mature microRNA products, as well as other sequenced fragments including microRNA offset RNAs (moRs) [<xref rid="pcbi.1007309.ref003" ref-type="bibr">3</xref>], hairpin loops, and spurious RNA fragments. The RNA secondary structures for the genomic sequences surrounding the read stacks are predicted and reads overlapping predicted hairpin structures are analyzed for arrangements consistent with microRNA processing. The prediction methods vary in the specifics of how the data are processed, and relevant features are quantified, as well as what classification techniques are used. Methods employing this strategy include miRTRAP [<xref rid="pcbi.1007309.ref004" ref-type="bibr">4</xref>], the software upon which miRWoods was built, along with miRDeep [<xref rid="pcbi.1007309.ref005" ref-type="bibr">5</xref>], the improved miRDeep2 [<xref rid="pcbi.1007309.ref006" ref-type="bibr">6</xref>] and other variants [<xref rid="pcbi.1007309.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1007309.ref008" ref-type="bibr">8</xref>], miReap [<xref rid="pcbi.1007309.ref009" ref-type="bibr">9</xref>], and miRAnalyzer [<xref rid="pcbi.1007309.ref010" ref-type="bibr">10</xref>].</p>
    <p>Several challenges remain in the computational prediction of microRNAs. Current approaches have strengths and weaknesses; while some approaches focus on higher precision at the expense of false negatives, others focus on higher recall at the expense of false positives. Most approaches require a minimum number of mapped reads at a given locus, meaning that many valid lowly expressed microRNAs are missed. Also, hairpin precursor detection is challenging because slight changes in the boundaries can shift the secondary structure prediction away from the hairpin. Our analysis of the predictions from available methods identifies many cases that partially overlap with or are shifted from annotated loci, and mistake 5′ for 3′ mature miRs.</p>
    <p>These remaining challenges to microRNA discovery motivated us to create miRWoods, a microRNA discovery pipeline using stacked random forests with an improved method for determining hairpin precursor span (<xref ref-type="fig" rid="pcbi.1007309.g001">Fig 1</xref>). The miRWoods pipeline consists of a mature product random forest (MPRF) for mature product detection, and a hairpin precursor random forest (HPRF) for hairpin precursor identification. For, balancing precision <italic>versus</italic> recall, we tuned miRWoods to optimize F-score, which is the harmonic mean of precision and recall. We trained and tuned miRWoods on well-annotated human data sets, evaluated cross-species performance using mouse data and used the pipeline to subsequently identify novel microRNAs in the feline and bovine genomes.</p>
    <fig id="pcbi.1007309.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Outline of miRWoods Pipeline.</title>
        <p>After aligning to the genome, overlapping reads are grouped together to form read stacks. Read stacks are scored used Mature Product Random Forest (MPRF), to predict a set of putative mature microRNAs. Products which meet the minimum threshold score for the MPRF are combined with the surrounding region to form hairpins and each hairpin is folded. Hairpins are scored using the Hairpin Random Forest (HPRF) and a set of final predictions are generated which meet the minimum threshold for the HPRF score.</p>
      </caption>
      <graphic xlink:href="pcbi.1007309.g001"/>
    </fig>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Overview of strategy behind miRWoods</title>
      <p>Because current approaches impose a threshold for the read abundance for a locus to be evaluated as a putative microRNA, many low-abundant miRs are missed. To avoid this, we have added a machine learning classifier to identify read stacks that are plausible mature microRNA loci, thereby enabling miRWoods to detect microRNAs with a single read. This RF evaluates read abundance-related features in the context of other features to classify plausible mature products (<xref rid="pcbi.1007309.t001" ref-type="table">Table 1</xref>). To avoid the sensitive-dependence on precursor span for secondary structure prediction, we examine several putative precursors for each read stack, including one derived from the boundaries of the optimal duplex between the read stack and surrounding genomic region (duplex-focused spans) and those derived from the boundaries with other products (product-focused spans). Through extensive feature-engineering, we have added several novel features to help classify the microRNA precursors, which are listed in <xref rid="pcbi.1007309.t002" ref-type="table">Table 2</xref>. Finally, we have tuned parameters of our model to optimize F-score, the harmonic mean of precision and recall, to result in improved performance that doesn’t sacrifice precision, and recalls 10% more annotated microRNAs on average.</p>
      <table-wrap id="pcbi.1007309.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Features used in the mature products random forest (MRPF).</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007309.t001g" xlink:href="pcbi.1007309.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">fivePrimeHet</td>
                <td align="left" rowspan="1" colspan="1">5′-heterogeneity of product reads</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">medianLength</td>
                <td align="left" rowspan="1" colspan="1">Median length of product reads</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">gcContent</td>
                <td align="left" rowspan="1" colspan="1">GC content of product sequence</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">aa,ac,ag,at,ca,cc,cg,ct,ga,gc,gg,gt,ta,tc,tg,tt (16 features)</td>
                <td align="left" rowspan="1" colspan="1">product dinucleotide frequencies</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">r7,r6,r5,r4,r3,r2,r1,s0,f1,f2,f3,f4,f5,f6,and f7 (15 features)</td>
                <td align="left" rowspan="1" colspan="1">read abundance 7 nt downstrem to 7 nt upstream product start position</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">WFC</td>
                <td align="left" rowspan="1" colspan="1">Wooton-Federhen Complexity of product sequence</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Duplex Energy</td>
                <td align="left" rowspan="1" colspan="1">Minimum free energy of product duplex with surrounding genomic region.</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <table-wrap id="pcbi.1007309.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Features used in the hairpin products random forest (MRPF).</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007309.t002g" xlink:href="pcbi.1007309.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Name</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
                <th align="right" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">mfe</td>
                <td align="left" rowspan="1" colspan="1">minimum free energy of hairpin fold</td>
                <td align="right" rowspan="1" colspan="1">14, 11<xref ref-type="table-fn" rid="t002fn001">*</xref>, 13<xref ref-type="table-fn" rid="t002fn001">*</xref>, 4, 10, 1, 12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">pbp</td>
                <td align="left" rowspan="1" colspan="1">frequency of paired bases of miR</td>
                <td align="right" rowspan="1" colspan="1">11, 4<xref ref-type="table-fn" rid="t002fn001">*</xref>, 8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">urf</td>
                <td align="left" rowspan="1" colspan="1">fraction of unique reads to total adjusted reads for locus</td>
                <td align="right" rowspan="1" colspan="1">34, 8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">gcContent</td>
                <td align="left" rowspan="1" colspan="1">GC content of locus sequence</td>
                <td align="right" rowspan="1" colspan="1">11, 10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">totalSenseRPM</td>
                <td align="left" rowspan="1" colspan="1">Adjusted reads per million (ARPM) in the sense strand</td>
                <td align="right" rowspan="1" colspan="1">12<xref ref-type="table-fn" rid="t002fn001">*</xref>, 4<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">loopSize</td>
                <td align="left" rowspan="1" colspan="1">length of the loop in nucleotides.</td>
                <td align="right" rowspan="1" colspan="1">10, 12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">maxBulge</td>
                <td align="left" rowspan="1" colspan="1">longest bulge appearing in the region of the hairpin spanning the miR and miR<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
                <td align="right" rowspan="1" colspan="1">10<xref ref-type="table-fn" rid="t002fn001">*</xref>, 12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">tapd</td>
                <td align="left" rowspan="1" colspan="1">total displacement of sense to anti-sense products</td>
                <td align="right" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">aapd</td>
                <td align="left" rowspan="1" colspan="1">average displacement of sense to anti-sense products</td>
                <td align="right" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ahc</td>
                <td align="left" rowspan="1" colspan="1">average number of hits to the genome for the major product</td>
                <td align="right" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">afh</td>
                <td align="left" rowspan="1" colspan="1">average 5’-heterogeneity of major product reads</td>
                <td align="right" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">sameShift</td>
                <td align="left" rowspan="1" colspan="1">Amount of offset between products on the same arm</td>
                <td align="right" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">bothShift</td>
                <td align="left" rowspan="1" colspan="1">maximum amount two products are offset on opposite arms</td>
                <td align="right" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Dinucleotide frequencies (16 features)</td>
                <td align="left" rowspan="1" colspan="1">precursor dinucleotide frequencies</td>
                <td align="right" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">maxInteriorLoop</td>
                <td align="left" rowspan="1" colspan="1">Length of largest interior loop spanning the miR and miR<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
                <td align="right" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">intLoopSideDiff</td>
                <td align="left" rowspan="1" colspan="1">Difference in length of of interior loop branches in miR/miR<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
                <td align="right" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">OPA</td>
                <td align="left" rowspan="1" colspan="1">Frequency of the most abundant overlapping product</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Duplex Energy</td>
                <td align="left" rowspan="1" colspan="1">Duplex energy of major product and surrounding region.</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">foldDupCmp</td>
                <td align="left" rowspan="1" colspan="1">Similarity between dotbracket sequences from RNAduplex and RNAfold</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">dupPBP</td>
                <td align="left" rowspan="1" colspan="1">base pairing density of region duplexing the major product</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">dupLoopLength</td>
                <td align="left" rowspan="1" colspan="1">Length of biggest bulge or interior loop in region duplexing the major product</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">APV</td>
                <td align="left" rowspan="1" colspan="1">The average variance of read counts for distinct reads for all products</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">wAPV</td>
                <td align="left" rowspan="1" colspan="1">The average variance of read counts for distinct reads weighted across products</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ARV</td>
                <td align="left" rowspan="1" colspan="1">The average variance of start positions for reads on each product</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">wARV</td>
                <td align="left" rowspan="1" colspan="1">The average variance of start positions for reads weighted by product size</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mpLoopDistance</td>
                <td align="left" rowspan="1" colspan="1">distance of the miR from the loop</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">dupLoopDistance</td>
                <td align="left" rowspan="1" colspan="1">distance of the miR<xref ref-type="table-fn" rid="t002fn001">*</xref> from the loop</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">totalOverlap</td>
                <td align="left" rowspan="1" colspan="1">The sum of the amounts of overlap between each pair of overlapping reads.</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">totalRelativeOverlapAmount</td>
                <td align="left" rowspan="1" colspan="1">sum of each overlap multiplied by the abundance ratio of the smaller to larger product</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">averageOverlapAmount</td>
                <td align="left" rowspan="1" colspan="1">sum of each overlapping product multiplied by the frequency of reads of the smaller product within the hairpin</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">innerLoopGapCount</td>
                <td align="left" rowspan="1" colspan="1">number of times 3 or more unbound nucleotides appears in the loop region</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">totalAntisenseRPM</td>
                <td align="left" rowspan="1" colspan="1">Adjusted reads per million (ARPM) in the anti-sense strand</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">maxUnboundOverhang</td>
                <td align="left" rowspan="1" colspan="1">The largest length of unpaired nucleotides on either side of the miR</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">numOffshoots</td>
                <td align="left" rowspan="1" colspan="1">number of additional hairpins formed on or across from the miR or miR<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">dupSize</td>
                <td align="left" rowspan="1" colspan="1">The size of the region duplexed by the miR product</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">neighborCount</td>
                <td align="left" rowspan="1" colspan="1">The number of regions of contiguous read loci within 1000 nucleotides of the precursor</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RFProductAvg</td>
                <td align="left" rowspan="1" colspan="1">Decision value returned by the random forest in the product phase</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Product counts (8 features)</td>
                <td align="left" rowspan="1" colspan="1">The fraction of the product relative to the total for the hairpin</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Product overlaps (11 features)</td>
                <td align="left" rowspan="1" colspan="1">Overlaping lengths for individual products within the locus (e.g. “miRmoR5pOverlap” the overlap between miR and moR on 5′ arm).</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>*References with an asterisk use a variant of the described feature.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec004">
      <title>Stacked random forest approach</title>
      <p>As with other microRNA discovery tools, miRWoods begins by analyzing genomic loci where small RNA reads mapped. A distinguishing feature of miRWoods is the use of an additional RF layer (the MRPF) to classify reads stacks as plausible mature microRNAs rather than rely only on the number of reads mapping to that genomic locus. The features used in the MRPF are summarized in <xref rid="pcbi.1007309.t001" ref-type="table">Table 1</xref>. The MRPF also leverages basic sequence features previously shown to be effective in detecting precursors such as GC-content and dinucleotide frequencies [<xref rid="pcbi.1007309.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1007309.ref014" ref-type="bibr">14</xref>]. In addition, we introduce some novel features such as the duplex energy between the read stack’s most frequent read sequence and the surrounding genomic locus. This quantity is distinct from miR:miR* duplex energy because the input is a read stack, and miR/miR* designations have not been assigned at this point. Also included are the observed frequencies of 5′ read ends relative to the most abundant position.</p>
      <p>The HRPF also uses several novel features, summarized in <xref rid="pcbi.1007309.t002" ref-type="table">Table 2</xref>. Novel features include 11 “overlap” features, correpsonding to the degree of overlap between different identified products (e.g. 5’ moR, 5’ miR, loop, 3’ miR). We also introduced several features describing destabilizing structures, such as bulges and loops, and several features describing the regions duplexed with the most abundant product. We also analyzed what features were most important for miRWoods, and summarized feature importance in <xref ref-type="supplementary-material" rid="pcbi.1007309.s002">S1 Fig</xref>. We found that the frequency of reads in the start position of the read stack and the duplex energy to be highest in importance for the MPRF (<xref ref-type="supplementary-material" rid="pcbi.1007309.s002">S1A Fig</xref>). We found that the decision value from the MPRF, the reads per million in the sense and anti-sense strands, the product base pairing, and the duplex energy to be the most important features for the HPRF (<xref ref-type="supplementary-material" rid="pcbi.1007309.s002">S1B Fig</xref>). Because the value of some features showed correlation, we also examined feature importance for RFs trained with correlated features removed. We identified features with an R^2 greater than or equal to 0.5 (<xref ref-type="supplementary-material" rid="pcbi.1007309.s015">S1 Table</xref>), and removed the feature with the highest importance for each correlated pair. We did see an increase in feature importance for some features in the HRPF, such as totalSenseRPM, dupLoopDistance, ARV, wARV, dupPBP, and afh (<xref ref-type="supplementary-material" rid="pcbi.1007309.s003">S2 Fig</xref>). We also examined the change in importance when correlated features are removed (<xref ref-type="supplementary-material" rid="pcbi.1007309.s004">S3A and S3B Fig</xref>). In some cases, features gained the importance after removal of their correlated partner. Other cases, such as “dupLoopDistance” and “dupPBP” showed a substantial increase in importance despite not having correlated features removed. We do not observe a significant decrease or consistent change in performance with the most correlated features removed (<xref ref-type="supplementary-material" rid="pcbi.1007309.s004">S3C Fig</xref>).</p>
      <p>We examined the role of read-abundance on the performance of miRWoods. The histograms of true positive predictions from miRWoods, miRDeep2, and miREAP demonstrate that miRWoods correctly identifies more single-read miRs (<xref ref-type="supplementary-material" rid="pcbi.1007309.s005">S4A–S4F Fig</xref>). We observed that consistently in both predictions trained and tested in human (same-species) and trained on human, tested on mouse (cross-species), miRWoods consistently makes more valid positive predictions for loci supported by only one read (<xref ref-type="supplementary-material" rid="pcbi.1007309.s005">S4G Fig</xref>). While these predictions illustrate the power of miRWoods, in practice any single-read predictions are not proof and would require further validation. We analyzed effect of removing read-abundance-related features and found that while performance does reduce with the removal of these features (<xref ref-type="supplementary-material" rid="pcbi.1007309.s005">S4H Fig</xref>), the overall greater performance on low-abundance loci demonstrates that these features do not impair performance.</p>
    </sec>
    <sec id="sec005">
      <title>Accurate mapping of hairpin precursor span</title>
      <p>Proper identification of hairpin precursor span is critical for microRNA prediction, because methods typically rely on secondary structure prediction, which can significantly depend on the defined window. The labeling of 5′ vs 3′ products requires accurate identification of the hairpin precursor. We imposed stringent requirements for predictions for the hairpin span of a locus to be considered a true positive when compared to miRBase annotations. Predicted loci where the hairpin folded in the wrong direction and/or overlapped less than 50% of the annotation were counted as false predictions. To address these stringent criteria, we developed an approach that focuses on strong miR/miR* duplex energy, rather than secondary structure of the hairpin. While most approaches focus on the predicted structure in a region around the most abundant product (i.e. major product), our duplex-focused method selects the span of hairpin regions using the optimal duplex pairing with the most abundant product (<xref ref-type="fig" rid="pcbi.1007309.g002">Fig 2A</xref>). Alternatively, product-focused spans covering the major product and any product 4 nt or more away from the major product are also considered. Each of these options are considered as putative loci, and evaluated in subsequent steps. We found that miRWoods uses the duplex-focused span an average of 88.4% of the time in its final predictions for all human sets (<xref ref-type="supplementary-material" rid="pcbi.1007309.s016">S2 Table</xref>).</p>
      <fig id="pcbi.1007309.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Improved hairpin precursor Span identification.</title>
          <p><bold>a</bold> miRWoods generates several potential hairpin precursor spans from each product that passes through the MPRF. Duplex-focused spans take the region between the product and the optimal duplex and product-focused spans take the region between the product and other products greater than 4 nt away. Hairpins are selected based on HPRF score. <bold>b</bold> The miRBase annotation for hsa-mir-4721 crosses over an intron boundary. miRWoods corrects the annotation by recognizing a second read stack and produce precursor span that perfectly matches an intron, suggesting mir-4721 is a mirtron. <bold>c</bold> The miRWoods prediction for mmu-let-7c-2 in mouse is consistent with the miRBase annotation, while the best miRDeep2 prediction, albeit below the default signal-to-noise threshold, only partially overlap with the miRBase annotation.</p>
        </caption>
        <graphic xlink:href="pcbi.1007309.g002"/>
      </fig>
      <p>The percentage of predictions that matched an annotation well enough to be considered a valid hairpin precursor was computed for miRWoods, miRDeep2 and miReap and summarized in <xref rid="pcbi.1007309.t003" ref-type="table">Table 3</xref>. miRWoods predictions used the proper fold an average of 99.1% of the time for human samples and 99.9% of the time for mouse samples. miReap was able to predict the proper fold 98.2% of the time for human and 97.8% of the time for mouse. miRDeep2 was able to predict the proper fold 98.9% of the time for Human and 97.7% of the time for mouse. In some examples, miRWoods corrects errors in the miRBase annotations. In <xref ref-type="fig" rid="pcbi.1007309.g002">Fig 2B</xref> we show the current annotation for hsa-mir-4721. While miRWoods predicts a hairpin precursor that directly matches with intron splice junctions (a mirtron), the miRBase annotation only overlaps one mature product. Similarly, <xref ref-type="supplementary-material" rid="pcbi.1007309.s006">S5A Fig</xref> shows hsa-mir-6860, which miRWoods predicts to be a half-mirtron and the current miRBase annotation does not. In both cases the miRWoods predicted hairpin span lines up with the intron splice site, even though miRWoods does not use splice junction locations in its predictions, thereby providing independent support to the predictions. In other examples, such as mmu-let-7c-2, the miRDeep2 hairpin span is offset, assigning the 5′ product as the 3′ product (<xref ref-type="fig" rid="pcbi.1007309.g002">Fig 2C</xref>). A similar scenario is observed for hsa-mir-431 (<xref ref-type="supplementary-material" rid="pcbi.1007309.s006">S5B Fig</xref>).</p>
      <table-wrap id="pcbi.1007309.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Percentage of predicted hairpin spans matching miRBase annotation.</title>
          <p>The method with the highest percent for a particular sample are presented in bold.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007309.t003g" xlink:href="pcbi.1007309.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" colspan="2" rowspan="1">miRWoods</th>
                <th align="left" colspan="2" rowspan="1">miRDeep2</th>
                <th align="left" colspan="2" rowspan="1">miReap</th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">library</th>
                <th align="left" rowspan="1" colspan="1">total</th>
                <th align="left" rowspan="1" colspan="1">percent (%)</th>
                <th align="left" rowspan="1" colspan="1">total</th>
                <th align="left" rowspan="1" colspan="1">percent (%)</th>
                <th align="left" rowspan="1" colspan="1">total</th>
                <th align="left" rowspan="1" colspan="1">percent (%)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">human MCF-7<break/>(total cell)</td>
                <td align="left" rowspan="1" colspan="1">450</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>98.901</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">318</td>
                <td align="left" rowspan="1" colspan="1">98.452</td>
                <td align="left" rowspan="1" colspan="1">430</td>
                <td align="left" rowspan="1" colspan="1">98.398</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">humam MCF-7<break/>(cytoplasm)</td>
                <td align="left" rowspan="1" colspan="1">452</td>
                <td align="left" rowspan="1" colspan="1">98.69</td>
                <td align="left" rowspan="1" colspan="1">314</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>99.054</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">428</td>
                <td align="left" rowspan="1" colspan="1">97.717</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">human liver</td>
                <td align="left" rowspan="1" colspan="1">385</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>99.483</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">318</td>
                <td align="left" rowspan="1" colspan="1">99.375</td>
                <td align="left" rowspan="1" colspan="1">413</td>
                <td align="left" rowspan="1" colspan="1">98.804</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">human cell lines</td>
                <td align="left" rowspan="1" colspan="1">736</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>99.325</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">532</td>
                <td align="left" rowspan="1" colspan="1">98.519</td>
                <td align="left" rowspan="1" colspan="1">228</td>
                <td align="left" rowspan="1" colspan="1">97.854</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse brain</td>
                <td align="left" rowspan="1" colspan="1">405</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>100</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">330</td>
                <td align="left" rowspan="1" colspan="1">98.214</td>
                <td align="left" rowspan="1" colspan="1">370</td>
                <td align="left" rowspan="1" colspan="1">98.143</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse embryo</td>
                <td align="left" rowspan="1" colspan="1">486</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>99.59</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">412</td>
                <td align="left" rowspan="1" colspan="1">98.329</td>
                <td align="left" rowspan="1" colspan="1">398</td>
                <td align="left" rowspan="1" colspan="1">97.073</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse newborn</td>
                <td align="left" rowspan="1" colspan="1">419</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>99.762</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">335</td>
                <td align="left" rowspan="1" colspan="1">97.384</td>
                <td align="left" rowspan="1" colspan="1">179</td>
                <td align="left" rowspan="1" colspan="1">97.283</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse ovary</td>
                <td align="left" rowspan="1" colspan="1">282</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>100</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">243</td>
                <td align="left" rowspan="1" colspan="1">97.2</td>
                <td align="left" rowspan="1" colspan="1">237</td>
                <td align="left" rowspan="1" colspan="1">98.75</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse testes</td>
                <td align="left" rowspan="1" colspan="1">293</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>100</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">269</td>
                <td align="left" rowspan="1" colspan="1">97.464</td>
                <td align="left" rowspan="1" colspan="1">260</td>
                <td align="left" rowspan="1" colspan="1">97.744</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec006">
      <title>Evaluation of prediction performance</title>
      <p>A summary of all small RNA deep sequencing data sets is provided in <xref ref-type="supplementary-material" rid="pcbi.1007309.s017">S3 Table</xref>. The repertoire of expressed microRNAs can vary considerably between tissue types in the same organism; therefore, we tested miRWoods against different cell types and conditions. We tested miRWoods on 9 samples from 4 small RNA sequencing experiments and provide performance metrics compared to other methods in <xref rid="pcbi.1007309.t004" ref-type="table">Table 4</xref>. We compared the performance of miRWoods, miRDeep2, and miReap on several small RNA data sets from human and mouse downloaded from GEO [<xref rid="pcbi.1007309.ref015" ref-type="bibr">15</xref>]. In each evaluation, the same RF models trained on human data were tested on small RNA data collected from different tissues including human MCF-7 total cell content (GSE31069), MCF-7 cytoplasmic fractions (GSE31069), human cancer cell lines (GSE16579), human normal liver (GSE21279), as well as cross-species tests on mouse brain, embryo, testes, ovary, and whole newborns (GSE20384). Because microRNA expression can vary from tissue to tissue, all programs were evaluated against the expressed miRs for that data set with at least one read aligned. miRWoods recalled on average 10% more annotated miRs, and obtained greater F-scores except in the case of mouse embryo where the F-sore was 0.312 for miRWoods compared to 0.313 for miRDeep2. Higher F-scores were obtained for all sets when miRWoods was compared with miREAP.</p>
      <table-wrap id="pcbi.1007309.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Comparison of performance of miRWoods compared to miRDeep2 and miReap.</title>
          <p>The method associated with the highest F-score for a particular sample are presented in bold.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007309.t004g" xlink:href="pcbi.1007309.t004"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"> </th>
                <th align="left" colspan="3" rowspan="1">miRWoods</th>
                <th align="left" colspan="3" rowspan="1">miRDeep2</th>
                <th align="left" colspan="3" rowspan="1">miReap</th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">library</th>
                <th align="left" rowspan="1" colspan="1">precision</th>
                <th align="left" rowspan="1" colspan="1">recall</th>
                <th align="left" rowspan="1" colspan="1">F-score</th>
                <th align="left" rowspan="1" colspan="1">precision</th>
                <th align="left" rowspan="1" colspan="1">recall</th>
                <th align="left" rowspan="1" colspan="1">F-score</th>
                <th align="left" rowspan="1" colspan="1">precision</th>
                <th align="left" rowspan="1" colspan="1">recall</th>
                <th align="left" rowspan="1" colspan="1">F-score</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">human MCF-7 (total cell)</td>
                <td align="right" rowspan="1" colspan="1">0.727</td>
                <td align="right" rowspan="1" colspan="1">0.501</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.296</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.839</td>
                <td align="right" rowspan="1" colspan="1">0.354</td>
                <td align="right" rowspan="1" colspan="1">0.249</td>
                <td align="right" rowspan="1" colspan="1">0.42</td>
                <td align="right" rowspan="1" colspan="1">0.478</td>
                <td align="right" rowspan="1" colspan="1">0.223</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">human MCF-7 (cytoplasm)</td>
                <td align="right" rowspan="1" colspan="1">0.7</td>
                <td align="right" rowspan="1" colspan="1">0.511</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.295</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.86</td>
                <td align="right" rowspan="1" colspan="1">0.355</td>
                <td align="right" rowspan="1" colspan="1">0.251</td>
                <td align="right" rowspan="1" colspan="1">0.476</td>
                <td align="right" rowspan="1" colspan="1">0.484</td>
                <td align="right" rowspan="1" colspan="1">0.24</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">human liver</td>
                <td align="right" rowspan="1" colspan="1">0.871</td>
                <td align="right" rowspan="1" colspan="1">0.447</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.295</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.898</td>
                <td align="right" rowspan="1" colspan="1">0.369</td>
                <td align="right" rowspan="1" colspan="1">0.262</td>
                <td align="right" rowspan="1" colspan="1">0.446</td>
                <td align="right" rowspan="1" colspan="1">0.48</td>
                <td align="right" rowspan="1" colspan="1">0.231</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">human cell lines</td>
                <td align="right" rowspan="1" colspan="1">0.627</td>
                <td align="right" rowspan="1" colspan="1">0.586</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.303</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.834</td>
                <td align="right" rowspan="1" colspan="1">0.424</td>
                <td align="right" rowspan="1" colspan="1">0.281</td>
                <td align="right" rowspan="1" colspan="1">0.264</td>
                <td align="right" rowspan="1" colspan="1">0.182</td>
                <td align="right" rowspan="1" colspan="1">0.108</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse brain</td>
                <td align="right" rowspan="1" colspan="1">0.849</td>
                <td align="right" rowspan="1" colspan="1">0.569</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.341</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.951</td>
                <td align="right" rowspan="1" colspan="1">0.463</td>
                <td align="right" rowspan="1" colspan="1">0.312</td>
                <td align="right" rowspan="1" colspan="1">0.397</td>
                <td align="right" rowspan="1" colspan="1">0.52</td>
                <td align="right" rowspan="1" colspan="1">0.225</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse embryo</td>
                <td align="right" rowspan="1" colspan="1">0.694</td>
                <td align="right" rowspan="1" colspan="1">0.567</td>
                <td align="right" rowspan="1" colspan="1">0.312</td>
                <td align="right" rowspan="1" colspan="1">0.898</td>
                <td align="right" rowspan="1" colspan="1">0.481</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.313</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.205</td>
                <td align="right" rowspan="1" colspan="1">0.464</td>
                <td align="right" rowspan="1" colspan="1">0.142</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse newborn</td>
                <td align="right" rowspan="1" colspan="1">0.836</td>
                <td align="right" rowspan="1" colspan="1">0.559</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.335</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.931</td>
                <td align="right" rowspan="1" colspan="1">0.447</td>
                <td align="right" rowspan="1" colspan="1">0.302</td>
                <td align="right" rowspan="1" colspan="1">0.312</td>
                <td align="right" rowspan="1" colspan="1">0.239</td>
                <td align="right" rowspan="1" colspan="1">0.135</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse ovary</td>
                <td align="right" rowspan="1" colspan="1">0.953</td>
                <td align="right" rowspan="1" colspan="1">0.603</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.369</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.96</td>
                <td align="right" rowspan="1" colspan="1">0.519</td>
                <td align="right" rowspan="1" colspan="1">0.337</td>
                <td align="right" rowspan="1" colspan="1">0.798</td>
                <td align="right" rowspan="1" colspan="1">0.506</td>
                <td align="right" rowspan="1" colspan="1">0.31</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mouse testes</td>
                <td align="right" rowspan="1" colspan="1">0.91</td>
                <td align="right" rowspan="1" colspan="1">0.579</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.354</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">0.944</td>
                <td align="right" rowspan="1" colspan="1">0.532</td>
                <td align="right" rowspan="1" colspan="1">0.34</td>
                <td align="right" rowspan="1" colspan="1">0.324</td>
                <td align="right" rowspan="1" colspan="1">0.514</td>
                <td align="right" rowspan="1" colspan="1">0.199</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>For a detailed summary of all microRNAs evaluated, both novel and annotated, along with expression levels across all samples, see <xref ref-type="supplementary-material" rid="pcbi.1007309.s018">S4 Table</xref>. Remarkably, miRWoods performed better on cross-species tests on mouse data compared to tests on human data (<xref ref-type="supplementary-material" rid="pcbi.1007309.s007">S6 Fig</xref>), providing justification for its application to other mammalian genomes when trained on human. Typically, miRWoods has a greater number of false positives and fewer false negatives than miRDeep2 when compared to miRBase annotations (<xref ref-type="fig" rid="pcbi.1007309.g003">Fig 3A</xref>).</p>
      <fig id="pcbi.1007309.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Evaluation of miRWoods performance.</title>
          <p><bold>a</bold> Euler diagrams comparing predictions from miRWoods and miRDeep with annotations from miRBase for human MCF-7 cytoplasmic extract <bold>b</bold> A scatterplot comparing the miRWoods decision value to the log fold change in Dicer knockdown cells compared to wild-type cells. <bold>c</bold> Scatter-boxplot comparing the log fold change for Dicer knockout to wild type for unprocessed read regions, miRBase annotations, and predictions from miRWoods, miRDeep, and miReap for MCF-7 (cytoplasmic fraction). Black dots indicate predictions that are unique to this method. <bold>d</bold> Precision-recall (PR) Curve and AUPRC of miRWoods predictions for human including MCF-7 (total cell content), MCF-7 (cytoplasmic fraction), cell lines, and liver. <bold>e</bold> Euler Diagrams comparing predictions from miRWoods and miRDeep with annotations from miRBase for human liver. <bold>f</bold> Precision Recall Curve and AUPRC of miRWoods predictions for mouse tissues including brain, embryo, newborn, testes, and ovaries sets. <bold>g</bold> Euler Diagrams comparing predictions from miRWoods and miRDeep2 with annotations from miRBase for mouse ovary.</p>
        </caption>
        <graphic xlink:href="pcbi.1007309.g003"/>
      </fig>
      <p>We tuned thresholds for expression level, proportion of negative samples, and decision values threshold on a separate dataset from what RFs were trained on (see Methods, <xref ref-type="supplementary-material" rid="pcbi.1007309.s008">S7 Fig</xref>). A summary of the data sets and values resulting from the tuning experiment is provided in <xref ref-type="supplementary-material" rid="pcbi.1007309.s019">S5 Table</xref>.</p>
      <p>The decision value threshold that has been tuned to optimize the F-score for the identification of valid loci correlates well with decreased expression in Dicer knockdown MCF-7 cells (<xref ref-type="fig" rid="pcbi.1007309.g003">Fig 3B</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007309.s009">S8A and S8B Fig</xref>). On average, the novel predictions of miRWoods show a greater decrease in the cytoplasm of Dicer knockdowns compared to novel predictions from miRDeep2 and miREAP (<xref ref-type="fig" rid="pcbi.1007309.g003">Fig 3C</xref>) and on par in total cell content (<xref ref-type="supplementary-material" rid="pcbi.1007309.s009">S8B Fig</xref>). We calculated p-values for each of these comparisons using two-sample t-tests and found that novel predictions in cytoplasm from miRWoods and miREAP had a significant reduction in Dicer-knockdown expression compared to miRBase. Novel predictions in total cell content for all programs showed a significant reduction in Dicer-knockdown expression compared to miRBase (<xref ref-type="supplementary-material" rid="pcbi.1007309.s020">S6 Table</xref>). Similarly, empirical cumulative distribution functions (ECDFs) of the fold change in Dicer knockdowns compared to wild type show a greater proportion of novel predictions highly depleted in Dicer knockdowns (<xref ref-type="supplementary-material" rid="pcbi.1007309.s009">S8C and S8D Fig</xref>). Examples of novel predictions found to be reduced in expression in Dicer mutants include hsa-Novel35, hsa-Novel28, hsa-Novel23, hsa-Novel65, has-Novel92, and hsa-Novel99 (<xref ref-type="supplementary-material" rid="pcbi.1007309.s010">S9 Fig</xref>).</p>
      <p>One advantage of miRWoods over the other methods is that it prints a score for each genomic locus evaluated, whether or not it is predicted to be a microRNA. Therefore, the output is amenable to creating precision-recall (PR) curves [<xref rid="pcbi.1007309.ref016" ref-type="bibr">16</xref>], such as <xref ref-type="fig" rid="pcbi.1007309.g003">Fig 3D and 3F</xref>. The area under the PR curve (AURPC) evaluates the performance of the prediction, and has the advantage over Receiver Operator Characteristic (ROC) curves [<xref rid="pcbi.1007309.ref017" ref-type="bibr">17</xref>] of not being overwhelmed by the large number of true negatives associated with genome-wide microRNA prediction. We present PR curves for predictions in mouse, with an average AUPRC of 70.3. Comparisons with miRDeep2 show that miRWoods has greater false positives, but fewer false negatives (<xref rid="pcbi.1007309.t004" ref-type="table">Table 4</xref>, <xref ref-type="fig" rid="pcbi.1007309.g003">Fig 3E–3G</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007309.s011">S10 Fig</xref>). Comparisons with miREAP show that miRWoods has a lower false positive rate, and a higher F-score on average (<xref rid="pcbi.1007309.t004" ref-type="table">Table 4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007309.s012">S11 Fig</xref>). Overall, miRWoods shows equal or greater F-score than both miRDeep2 and miReap for all data sets (<xref rid="pcbi.1007309.t004" ref-type="table">Table 4</xref>).</p>
      <p>Many of the “false positive” microRNA predictions are actually novel predictions of valid miRs. Despite how complete the human microRNA annotation is, we were able to identify 682 potential novel loci in the human data sets. We found that many of our novel predictions, despite not being annotated, had homology to known miRs in other species. In some cases, miRWoods identified more instances of known miR families. For example, there are 72 known precursors from the mir-548 family in the human genome annotated by miRBase. miRWoods was able to identify an additional 34 novel members of the mir-548 family (<xref ref-type="supplementary-material" rid="pcbi.1007309.s013">S12 Fig</xref>), suggesting this family could be larger than previously thought.</p>
    </sec>
    <sec id="sec007">
      <title>Novel microRNA predictions in the feline genome</title>
      <p>We next sought to predict microRNA loci in species with limited microRNA annotations, including the feline and bovine genomes. We ran miRWoods on small RNA samples isolated from muscle and skin tissue for 3 different cats. Currently, there are two studies of feline microRNAs that we are aware of. In one study, Sun <italic>et al</italic>. did an analysis with miREAP in the context of the mink enteritis virus (MEV) [<xref rid="pcbi.1007309.ref018" ref-type="bibr">18</xref>]. In a more recent study, Laganà <italic>et al</italic>. identified feline microRNAs with miRDeep2 in a multi-tissue cohort [<xref rid="pcbi.1007309.ref019" ref-type="bibr">19</xref>]. miRWoods identified 495 microRNA loci, with 293 of them having significant homology to microRNA precursors from miRBase. Among the miRWoods predictions, 198 overlapped with the microRNA found in Sun <italic>et al</italic>., and 213 overlapped with microRNAs found in Laganà <italic>et al</italic>., and 215 were newly discovered (<xref ref-type="fig" rid="pcbi.1007309.g004">Fig 4A</xref>).</p>
      <fig id="pcbi.1007309.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>miRWoods predictions in the feline genome.</title>
          <p><bold>a</bold> Euler diagram of the predictions from miRWoods with predictions from Sun <italic>et al</italic>. (2014) and Lagana <italic>et al</italic>. (2017). <bold>b</bold> The expression in skin and muscle for miR-133-Novel-3p <bold>c</bold> Hairpin for mir-133-Novel precursor. <bold>d</bold> The expression in skin and muscle for Novel110-3p. <bold>e</bold> Hairpin for Novel110 precursor. <bold>f</bold> Scatterplot of average muscle expression vs average skin expression for each mature microRNA.</p>
        </caption>
        <graphic xlink:href="pcbi.1007309.g004"/>
      </fig>
      <p>Expression of three novel microRNAs in feline skin and muscle were examined by qPCR and normalized expression relative to 2 control miRs with low variability across our tissue samples, miR-25 and miR-191 (<xref ref-type="fig" rid="pcbi.1007309.g004">Fig 4B and 4D</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007309.s014">S13 Fig</xref>). These examples included a novel member of the miR-133 family, with enriched expression in muscle that was validated by qPCR (<xref ref-type="fig" rid="pcbi.1007309.g004">Fig 4B</xref>) and a predicted structure that strongly matches expectations for microRNAs (<xref ref-type="fig" rid="pcbi.1007309.g004">Fig 4C</xref>). We also identified a novel miR with no homology to known miRs, with a statistically significant tissue-specific enrichment based on a voom analysis [<xref rid="pcbi.1007309.ref020" ref-type="bibr">20</xref>], including some more abundant in muscle (<xref ref-type="fig" rid="pcbi.1007309.g004">Fig 4B–4E</xref>). In addition, we validated two predicted miRs previously described by Laganà <italic>et al</italic> that we determined to be significantly differentially expressed. As predicted, fca-mir-1-1 was more abundant in muscle whereas fca-mir-205 was abundant in skin (<xref ref-type="supplementary-material" rid="pcbi.1007309.s014">S13 Fig</xref>). Overall, our analysis of the expression of our predicted microRNAs identified 71 differentially expressed miRs using a voom FDR of 0.05, with 33 enriched in muscle, and 38 enriched in skin tissue.</p>
      <p>Several known and novel let-7 family precursors were found within clusters including multiple let-7 miRs. For example, we found a cluster on chromosome D4 containing fca-let-7f and two novel let-7 miRs denoted fca-let-7-Novel2 and fca-let-7-Novel3 (<xref ref-type="fig" rid="pcbi.1007309.g005">Fig 5A</xref>). The predicted novel miRs (<xref ref-type="fig" rid="pcbi.1007309.g005">Fig 5B and 5C</xref>) have predicted secondary structures with similar bulges and/or internal loops observed in other let-7 family members including fca-let7f (<xref ref-type="fig" rid="pcbi.1007309.g005">Fig 5D</xref>). A phylogenetic tree of known and novel let-7 miRs shows comparable sequence similarity, although not necessarily correlated with proximity of the genomic loci (<xref ref-type="fig" rid="pcbi.1007309.g005">Fig 5E</xref>).</p>
      <fig id="pcbi.1007309.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Novel let-7 microRNAs in the feline genome.</title>
          <p><bold>a</bold> RNA-seq of cluster containing fca-let7-Novel2, fca-let7f, and fca-let7-Novel3 for each skin and muscle sample from <italic>Felis catus</italic>. <bold>b</bold> Hairpin structures for fca-let7-Novel2, <bold>c</bold> fca-let7-Novel3, and <bold>d</bold> fca-let7f. <bold>e</bold> Phylogenetic tree of let-7 miRs including those previously found by Lagana <italic>et al</italic>. (2017).</p>
        </caption>
        <graphic xlink:href="pcbi.1007309.g005"/>
      </fig>
      <p>Feline microRNAs were found within 51 clusters, 28 overlapped with the 31 previously described [<xref rid="pcbi.1007309.ref019" ref-type="bibr">19</xref>]. In addition to the two previously-identified feline-specific precursors within cluster 14, miRWoods identified one additional feline-specific precursor tagged as fca-Novel45. Cluster 2 covers an intron within the ARHGEF10L gene and contains two more novel feline-specific miRs (fca-Novel10 and fca-Novel13.) Cluster 3 contains fca-mir-30c-1, and two novel mir-30 homologs antisense to one another within an intron on the NFYC gene (<xref ref-type="supplementary-material" rid="pcbi.1007309.s021">S7 Table</xref>)</p>
    </sec>
    <sec id="sec008">
      <title>Novel microRNA predictions in the bovine genome</title>
      <p>For the bovine genome, there are 811 known microRNA precursors producing 881 mature microRNA annotations, compared to 1187 precursors for mouse and 1881 for human, which generate 2045 and 2813 mature products, respectively.</p>
      <p>We used miRWoods to predict bovine microRNA loci using small RNA-seq samples from 10 bovine tissues including corium from the hoof (corium feet), dental pulp, oral papillae, penis, retina, iris, optic nerve, brain stem, bone marrow, and submandibular lymph node. We selected tissues that were highly diverse and whose microRNA profiles had not been examined before. Our pipeline identified a set of 810 predicted microRNA loci. Among these, 409 were already in the miRBase R21 <italic>Bos taurus</italic> annotations, 91 had homology to microRNA annotations in cow and other species, and 310 were novel predictions with no known homology.</p>
      <p>Overall, miRWoods identified 401 novel bovine microRNAs. In addition, clustering of microRNA loci revealed 76 clusters, including 63 known and 13 novel clusters (<xref ref-type="supplementary-material" rid="pcbi.1007309.s021">S7 Table</xref>). Cluster 19 contained two bovine-specific half-mirtrons, (bta-Novel68 and bta-Novel71), within the <italic>PLD2</italic> gene. A bovine specific mirtron (bta-Novel210) and another half-mirtron (bta-Novel212) were found within the <italic>MCAM</italic> gene on cluster 53. Another bovine specific half-mirtron (bta-Novel208) was found on cluster 44 with bta-mir-140 on the <italic>WWP2</italic> gene.</p>
      <p><xref ref-type="fig" rid="pcbi.1007309.g006">Fig 6A</xref> shows an Euler diagram comparing miRBase annotations to miRWoods predictions for bovine samples. To test the validity of the novel predictions, we performed RT-qPCR on available samples, and normalized expression relative to 5 control miRs with low variability across our tissue samples. After normalization, expression levels for control miR-7 are compared with RT-qPCR (<xref ref-type="fig" rid="pcbi.1007309.g006">Fig 6B</xref>). Strong correspondence between small RNA-seq and RT-qPCR are observed for 2 of the tested microRNAs (<xref ref-type="fig" rid="pcbi.1007309.g006">Fig 6C and 6D</xref>), suggesting that the mature product was detectable with both methods in the tissue it was expressed. Expression was observed for all tested novel bovine miRs using RT-qPCR, validating the expression of these predicted mature products (<xref ref-type="fig" rid="pcbi.1007309.g006">Fig 6E</xref>).</p>
      <fig id="pcbi.1007309.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Novel microRNA predictions in the bovine genome.</title>
          <p><bold>a</bold> Euler diagram comparing miRWoods predictions in the cow genome with miRBase annotations. <bold>b</bold> Scatterplot and best fit line comparing the normalized RT-qPCR expression and RNA-seq for the control miR bta-miR-7. <bold>c</bold> Scatterplot and best fit line comparing the normalized RT-qPCR expression and RNA-seq for a novel predicted miR with enriched expression in brain stem. <bold>d</bold> Scatterplot and best fit line comparing the normalized RT-qPCR expression and RNA-seq for a novel predicted miR with enriched expression in corium feet. <bold>e</bold> Heat map of RT-qPCR expression expression values over tissues examined.</p>
        </caption>
        <graphic xlink:href="pcbi.1007309.g006"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>Novel Predictions in the Bovine miR-2284 Precursor Family</title>
      <p>The miR-2284 family has previously been found to be expressed in tissues relevant to the immune system but gene targets are currently unknown [<xref rid="pcbi.1007309.ref021" ref-type="bibr">21</xref>]. Within the mir-2284 family, miRWoods predicted 29 known and 68 homologous precursors. Of the 68 homologous precursors, only 35 fit the criteria of having the same seed region as other miRs. Removing the seed requirement, 33 additional mir-2284 family precursors were identified. Unique reads were found in 51.5% of homologous precursors and 37.00% of already annotated precursors. Hierarchical clustering was performed on mir-2284 family microRNAs based on their normalized expression profiles and a heat map was generated (<xref ref-type="fig" rid="pcbi.1007309.g007">Fig 7A</xref>). Despite having a shared homology, expression of the microRNAs in the mir-2284 family are highly diverse in the tissues assayed, but show greatest expression in submandibular lymph node (SLN). Interestingly, this is consistent with prior studies of this family that observe greatest expression in bovine immune cells [<xref rid="pcbi.1007309.ref022" ref-type="bibr">22</xref>] given recent studies of the immunosuppressive properties of SLNs [<xref rid="pcbi.1007309.ref023" ref-type="bibr">23</xref>]. A phylogenetic tree was created to show all annotated and newly predicted miRs in the mir-2284 family (<xref ref-type="fig" rid="pcbi.1007309.g007">Fig 7B</xref>).</p>
      <fig id="pcbi.1007309.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>mir-2284/mir-2285 family miRs in <italic>Bos taurus</italic>.</title>
          <p><bold>a</bold> A heat map for the expression of annotated and novel mir-2284/mir-2285 family miRs. <bold>b</bold> A phylogenetic tree for the bta-2284/bta-2285 family. Variants of bta-mir-2284 appear in red and variants of bta-mir-2285 appear in blue. Colors for novel predictions appear lighter than those for annotated predictions. <bold>c</bold> Abundance of miRs for the 5′ and 3′ sides of the mir-2284/mir-2285 family. The 5′ product tends to show greater expression in the mir-2284 family while the 3′ product shows greater expression in the mir-2285 family.</p>
        </caption>
        <graphic xlink:href="pcbi.1007309.g007"/>
      </fig>
      <p>Read abundances showed a tendency for mir-2284 and mir-2285 precursors to favor a single (opposite) side of the precursor. The abundance of each microRNA for the mir-2284 and mir-2285 precursors within the mir-2284 precursor family was examined (<xref ref-type="fig" rid="pcbi.1007309.g007">Fig 7C</xref>) For annotated microRNA precursors, 82.05% of mir-2284 loci had the most abundant read on the 5p-side, and 89.36% of mir-2285 had the most abundant read on the 3p-side. Similarly, for our predicted microRNAs with homology to this family, 73.91% of mir-2284 examples had the most abundant read on the 5p-side, and 88.89% of mir-2285 examples had the most abundant read on the 3p-side.</p>
    </sec>
    <sec id="sec010">
      <title>Discovery of novel miR families</title>
      <p>We found that 11 novel predictions in human were within clusters of annotated microRNAs, and 39 novel predictions in new clusters. Of the 9 potential miR families which matched the criteria found in the methods section one contained a snoRNA and was removed. Of the remaining candidate miR families two had miRs which were found across species. We identified a novel miR family with two instances in the human genome; one example was a mirtron in an intron of <italic>LAMA5</italic>, and the other a half-mirtron in an intron of <italic>CHD3</italic> (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8A–8E</xref>). Both of the examples in human were observed to have no expression in Dicer knock-out cells (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8A and 8B</xref>). We observed a strong level of similarity in predicted secondary structures of the two examples observed in human (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8C and 8D</xref>). We compared these introns across several mammalian species and observed patterns of conservation that suggest an ancestral divergence of these two mirtrons rather than a more recent duplication (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8E</xref>). We found another novel miR family with an example in both the bovine and feline genomes, but not observed in mouse or human (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8F–8G</xref>). Strikingly, both of these miRs (bta-Novel5 and fca-Novel70) were found within the same intron of <italic>TYK2</italic> in cow and cat genomes (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8F and 8G</xref>), and both examples showed nearly identical hairpin precursor sequences (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8H and 8I</xref>). We did not observe this miR in human or mouse data sets, and we also observed greater sequence divergence of this intron in human and mouse (<xref ref-type="fig" rid="pcbi.1007309.g008">Fig 8J</xref>). A list of all identified putative novel families identified by miRWoods is presented in <xref ref-type="supplementary-material" rid="pcbi.1007309.s022">S8 Table</xref>.</p>
      <fig id="pcbi.1007309.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007309.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Novel microRNA families identified by miRWoods.</title>
          <p><bold>a</bold> hsa-novel-8 is a mirtron predicted for both MCF-7 sets where expression was decreased in the Dicer knockdown sets. <bold>b</bold> hsa-Novel-185 is a mirtron predicted within the human cell lines set and the MCF-7 (cytoplasmic fraction) set. It also shows reduced expression in the Dicer knockdown version of the MCF-7 set. <bold>c</bold> The structure of hsa-novel-8. <bold>d</bold> The structure of hsa-Novel-185. e Phylogeny comparing the LAMA5 intron and CHD3 intron for several mammals. <bold>f</bold> Novel miR predicted in bovine genome in an intron of TYK2. <bold>g</bold> novel predicted miR in the feline genome in the same intron of TYK2 <bold>h</bold> structure of novel feline miR. <bold>i</bold> structure of novel bovine miR. Eight nucleoties were removed from the 5' end, and two were added to the 3' end to match the feline hairpin precursor boundaries. <bold>j</bold> A phylogeny comparing the TYK2 intron in several mammals.</p>
        </caption>
        <graphic xlink:href="pcbi.1007309.g008"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec011">
    <title>Discussion</title>
    <p>Our study demonstrates that despite a long history of microRNA discovery tools and annotations, there is still room for improvement. Despite the maturity of microRNA annotations for the human genome, our approach was still able to find novel human miRs. We have identified several miRs with annotated positions shifted from the correct location, and that have been resolved with miRWoods.</p>
    <p>The inclusion of the duplex-focused method in miRWoods improved hairpin precursor span identification over the other programs. Not only did miRWoods match the miRBase hairpin precursor annotation more often, in some instances miRWoods predictions corrected the miRBase annotation. Splice junction boundaries for the mirtron and half-mirtron examples provide evidence for the validity of the miRWoods duplex method because the optimal precursor span closely corresponds to the splice junctions, as expected given mirtron biogenesis mechanisms [<xref rid="pcbi.1007309.ref010" ref-type="bibr">10</xref>] despite the fact that these hairpin boundaries were computed without the use of intron annotations. Similarly, Boruta feature-importance analysis showed that the duplex energy was more important than the minimum free energy of the hairpin. These observations support the idea that the thermodynamic stability of intermediate RNA duplex formed by miR and miR* may serve important roles in microRNA function, consistent with previous studies showing this affects efficient loading into Argonaut [<xref rid="pcbi.1007309.ref024" ref-type="bibr">24</xref>]. We also found that the distance between the miR* sequence and the loop have a greater importance than that of the major product and the loop. Future work is needed to determine the relative importance of stable mature miR:miR* duplex formation compared to stable stem-loop formation in microRNA biogenesis.</p>
    <p>We demonstrated in this study that miRWoods is capable of correctly identifying microRNA loci with only one read more than other programs. Although this displays the strength the miRWoods approach, in practice users should seek further evidence to support the validity of any novel miRs only supported by one read.</p>
    <p>Predictions from miRWoods consist of 215 potential novel microRNA annotations for cat and 417 novel candidates for cow. These findings support the expectation that these organisms have comparable number of microRNAs to human and mouse, but are currently less-well annotated due to greater research focus on human and mouse. Future work could expand miR annotation in feline and bovine further by sequencing other tissues, as well as identifying regulatory targets for miRs in specific tissues.</p>
    <p>Finally, our approach is able to identify more examples of known families, suggesting that they are larger than previously thought. While these large families retain sequence similarity at the hairpin-level, they are often the result of seed shifting and mismatches, suggesting a wide range of potential gene targets. Predictions using miRWoods showed an expansion in the number of microRNAs within the mir-548 family in human, and the mir-2284 family in the bovine genome. These families are often defined in terms of homology to the hairpin sequence rather than the seed [<xref rid="pcbi.1007309.ref025" ref-type="bibr">25</xref>]. We observed several mutations within the seed region of mir-2284 family miRs that result in the complex phylogeny, and which indicate that a much wider range of genes may be targeted by this family than currently accepted. The fact that we observed miR-2284 family members to be differentially expressed across diverse tissue types supports the idea that this family expanded and sub-functionalized in various tissues. As noted previously, the widespread genomic distribution of the primate-specific mir-548 family supports the hypothesis that it may have been evolutionarily derived from transposable elements [<xref rid="pcbi.1007309.ref026" ref-type="bibr">26</xref>]. Similarly, mir-2284 family may be more expansive than previously thought, and the observed diversity of sequence and expression supports the hypothesis that this family has shaped ruminant evolution [<xref rid="pcbi.1007309.ref025" ref-type="bibr">25</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec012">
    <title>Methods</title>
    <sec id="sec013">
      <title>Ethics statement</title>
      <p>All bovine tissues were harvested from animals that were already scheduled to be slaughtered, and collected immediately after slaughter. All slaughter operations were performed under USDA-FSIS supervision in accordance with the Humane Slaughter Act (1978), the Federal Meat Inspection Act (1906), and using a percussive captive bolt stunner. The feline tissue samples were obtained through the biobank at the Carlson College of Veterinary Medicine at Oregon State University. Tissues had been banked for research purposes with owner consent and approval of the institutional animal care and use committee.</p>
    </sec>
    <sec id="sec014">
      <title>Tissue samples small RNA sequencing</title>
      <p>We examined small RNA samples collected from 10 bovine tissues including submandibular lymph node (SLN), bone marrow, brain stem, optic nerve, retina and iris of the eye, penis (corpus cavernosum), oral papillae (buccal mucosa), dental pulp, and hoof corium (corium feet) from three Angus steers collected just after slaughter at the Meat Science laboratory at Oregon State University. The feline tissue samples were obtained through the biobank at the Carlson College of Veterinary Medicine at Oregon State University and included normal haired skin and normal skeletal muscle from three male neutered domestic short hair cats aged 10–13 years. Tissues had been banked for research purposes with owner consent and approval of the institutional animal care and use committee. RNA was isolated from tissue by chloroform-isopropanol extraction. RNA quality was analyzed on a Bioanalyzer 2100 Nano chip (Agilent Technologies, Santa Clara, CA), with a minimum acceptable RIN of 7. Small RNA sequencing was performed at the Center for Genome Research and Biocomputing (CGRB) at Oregon State University (OSU). Libraries were prepared using the Illumina TruSeq small RNA sample preparation kit (Illumina, San Diego, CA) for library preparation and size-separation by polyacrylamide gel electrophorese. Library size was determined with the Bioanalyzer 2100 HS-DNA chip and the KAPA biosystem’s library quantification kit, and libraries normalized to 2 nM. Multiplexed samples (6/lane) were sequenced with a 50 cycle v3 sequencing kit on an Illumina HiSeq 3000 sequencer.</p>
    </sec>
    <sec id="sec015">
      <title>The miRWoods pipeline</title>
      <p>The miRWoods pipeline consists of two random forests with readily interpretable, biochemically-motivated features. The pipeline’s two layers correspond to classifiers that recognize different components of the microRNA (<xref ref-type="fig" rid="pcbi.1007309.g001">Fig 1</xref>). The first random forest layer predicts likely mature miRNAs products. In this way, the first random forest acts to filter out a large number of loci before precursors are considered, thereby improving accuracy and reducing the overall runtime. The second random forest layer scores the precursors around the predicted mature miRNAs and is used to generate the final set of predictions.</p>
      <p>The miRWoods pipeline is perl software largely derived from miRTRAP [<xref rid="pcbi.1007309.ref004" ref-type="bibr">4</xref>], but with significant improvements on speed and memory efficiency, as well as two random forest layers rather than user-defined thresholds. The pipeline now includes the integration of indexed bam files for faster read processing, and the RNAfold perl module for rapid secondary structure prediction. The processing of sequencing data begins with one or more small RNA-seq FASTQ files. We first trim the reads using cutadapt, which removes 3′ adapter sequences and filters for read quality requiring a PHRED score of 30 or greater [<xref rid="pcbi.1007309.ref027" ref-type="bibr">27</xref>]. Sequencing data is mapped to the genome using bowtie [<xref rid="pcbi.1007309.ref028" ref-type="bibr">28</xref>]. Before sorting and indexing the bam files, we add additional tags according to samtools specifications describing the number of hits (NH-tags) to the genome for each read [<xref rid="pcbi.1007309.ref029" ref-type="bibr">29</xref>], which is used later in the pipeline to normalize expression.</p>
    </sec>
    <sec id="sec016">
      <title>Mature product random forest</title>
      <p>The miRWoods pipeline consists of several data-processing steps. Next, after read alignment, we identify “read regions”, which consist of reads that map to overlapping positions in the genome. Each of these read regions are evaluated as putative mature microRNA products based on a number of features calculated from genomic loci and read distributions. Basic features for each read region are computed, such as GC-content, dinucleotide frequencies, Wootton-Federhen sequence complexity [<xref rid="pcbi.1007309.ref030" ref-type="bibr">30</xref>], and the median length of reads mapped to the locus. Because the function of microRNAs involves the position of seed sequences relative to the 5′ end, the 5′-heterogeneity is computed for each read region as previously described [<xref rid="pcbi.1007309.ref031" ref-type="bibr">31</xref>]. In addition, we compute the number of reads mapping to positions within a fixed offset from the most abundant product. We also computed the minimum duplex energy between the read stack’s most frequent read sequence and the surrounding 70bp region. These and other features are input into our first random forest, called the “mature product random forest” (MPRF), which classifies read regions as mature microRNA products or non-miR loci. For a complete list of computed features, see Supplementary Methods.</p>
    </sec>
    <sec id="sec017">
      <title>Hairpin precursor span optimization</title>
      <p>We found that a major source of error in high-throughput microRNA discovery was the prediction of the span (start and end positions) of genomic location of the hairpin precursor, and therefore we developed a new method of precursor span prediction (<xref ref-type="fig" rid="pcbi.1007309.g002">Fig 2</xref>). While most other approaches predict secondary structure of the region surrounding a putative mature product, our approach computes the RNA:RNA duplex energy of the mature products (without the loop). Each putative microRNA product identified by the MPRF is used to compute the optimal duplex energy between the most abundant product and the surrounding 70bp window using RNAduplex [<xref rid="pcbi.1007309.ref010" ref-type="bibr">10</xref>], as depicted in <xref ref-type="fig" rid="pcbi.1007309.g002">Fig 2A</xref>. The region spanning this most abundant read and the optimal duplex subsequence is then used as a putative hairpin precursor sequence. In addition, a second method folds between any two products that are separated by 5 nt or more. Both methods are used and create several secondary structure predictions, all of which are the basis of a putative hairpin precursor to be input to the next random forest. When the hairpins are subsequently evaluated in the next step, overlapping hairpins are dropped and only the predicted hairpin with the highest decision value from that random forest is retained.</p>
    </sec>
    <sec id="sec018">
      <title>Hairpin precursor random forest</title>
      <p>The second random forest within miRWoods, called the “hairpin precursor random forest” (HPRF) is used to evaluate the putative hairpin precursors from 71 features, which provide scores based on its sequence, structure, and folding energy. Many of the features for the hairpin phase come from the original miRTRAP software [<xref rid="pcbi.1007309.ref004" ref-type="bibr">4</xref>].</p>
      <p>The features for the HPRF can be categorized as sequence features, structural features, and product-distribution features. Sequence features include dinucleotide frequencies, GC Content, and sequence complexity over the entire precursor sequence. Structural features include the minimum free energy returned by RNAfold [<xref rid="pcbi.1007309.ref032" ref-type="bibr">32</xref>], and the optimal duplex energy of the most abundant product and hairpin precursor region computed by RNAduplex [<xref rid="pcbi.1007309.ref033" ref-type="bibr">33</xref>]. The decision value from the MPRF for the most abundant product within putative hairpin precursors is also included as a feature.</p>
      <p>Expression levels for a locus <italic>L</italic> are quantified with adjusted reads per million (ARPM), which are defined by
<disp-formula id="pcbi.1007309.e001"><alternatives><graphic xlink:href="pcbi.1007309.e001.jpg" id="pcbi.1007309.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives><label>(1)</label></disp-formula>
Total read counts, separately computed for the sense and antisense strands of the precursor, are first adjusted, meaning when a read <italic>r</italic> aligns to <italic>n</italic><sub><italic>r</italic></sub> locations in the genome, the read contributes a fractional count of 1/<italic>n</italic><sub><italic>r</italic></sub> to each location, essentially uniformly distributing the count to each locus [<xref rid="pcbi.1007309.ref034" ref-type="bibr">34</xref>]. These calculated values are then normalized for each sample <italic>S</italic> to parts-per-million.</p>
      <p>The product-distribution features are computed by first naming read stacks as the products that would be expected in the event of Dicer and Drosha cuts by a previously defined algorithm [<xref rid="pcbi.1007309.ref004" ref-type="bibr">4</xref>]. A number of features describe the abundance and mapping of reads for each of these products. The unique read fraction describes the proportion of reads mapping only to the locus. Various features, such as the 5′ heterogeneity, and average hit count were evaluated for the most abundant mature product. For each of the mature products, several features describe the relative frequency of reads for miRs, moRs, loop products, and other products within the precursor. Several other features were created to describe the variance and weighted variance of reads associated with mature products relative to the most frequent cut variant and to the hairpin.</p>
      <p>Dicer and Drosha tend to make precise cuts to produce well-defined 5′ ends of the mature products for proper functionality. Because of this, several features describe the amount of overlap across all products and across each product relative to its surrounding products. In addition, reads within a product would not be expected to be significantly offset from the product on the opposite arm of the hairpin, or relative to any moR products on the same arm. Therefore, features measuring the amount of shift between miR products are included.</p>
      <p>A number of features were generated to describe the structure of the predicted hairpin. Two features, base pair density (fraction of paired nucleotides in predicted structure) within the major product, and base pair density within the optimal duplexed region. These features may be different due to bulges being present on one arm of the hairpin but not the other. Features for the part of the fold around the miR products include the sizes of the largest bulge, size of largest internal loop, size difference between the two halves of internal loops, and overhangs on the major miR product, which are defined as the maximum number of unpaired bases on either end of the miR. The dupLoopLength feature measures the largest region of unbound nucleotides on the duplex across from the most abundant miR Product. A dupSize feature is a measure of the size of the region predicted to duplex with the most abundant product. Since the duplex is expected to be around the same size as the miR product this feature may help exclude cases where there are large unpaired stretches on the duplex or most of the major product is unbound to the duplex. A feature called innerLoopGapCount scores the number of occurrence of spans of 3 or more unpaired nucleotides in the loop region (i.e. more than one indicates a multi-branched loop). This feature may help in situations in which there is a multiloop or where the loop structure is uncommon to known miR precursors. Additionally, a feature measuring the size of the hairpin loop is included. We added new features quantifying the size of the largest bulge in the hairpin structure, which is known to affect Dicer specificity [<xref rid="pcbi.1007309.ref035" ref-type="bibr">35</xref>].</p>
      <p>Because microRNA loci tend to cluster together, we incorporated a neighbor count feature, which is a score tallying the number of neighboring hairpins that occur within 1000 nucleotides of the precursor being analyzed. The neighbor count feature counted all small RNA loci, including both miR and non-miR loci, and reduced the number of observed false positives.</p>
    </sec>
    <sec id="sec019">
      <title>Training, tuning and model selection</title>
      <p>The miRWoods pipeline requires models for both MPRF and HPRF layers that have been trained on positive examples, which are annotated microRNAs, and negative examples, which are loci containing read regions not overlapping annotated microRNAs. The training data for the MPRF is produced by a script that collects loci based on the overlap of the products with the mature microRNAs in miRBase annotations, with <italic>X</italic>-fold more negative examples than positives for some input <italic>X</italic>. The training data for HPRF is created by using hairpins with the best overlap of the known hairpin annotation.</p>
      <p>Our strategy for tuning the thresholds of miRWoods focused on three parameters: the decision value <inline-formula id="pcbi.1007309.e002"><alternatives><graphic xlink:href="pcbi.1007309.e002.jpg" id="pcbi.1007309.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> for the hairpin random forest output, the expression level threshold <italic>E</italic><sub><italic>th</italic></sub> in units of ARPM, and the proportion <italic>X</italic> of negative loci used in stratified sampling. To determine these thresholds, we trained and tested on different small RNA deep sequencing data sets. We selected four large data sets from sequencing read archives (SRA) from diverse tissues and developmental stages. We trained on one of the data sets, which produced optimal RFs. We then applied this to a second data set and computed F-scores for different <inline-formula id="pcbi.1007309.e003"><alternatives><graphic xlink:href="pcbi.1007309.e003.jpg" id="pcbi.1007309.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, <italic>E</italic><sub><italic>th</italic></sub>, and <italic>X</italic> parameters, and chose the set of parameters that gave the highest F-score.</p>
      <p>Our strategy for training and tuning models was to train with one data set, tune on another, and ultimately select final models were chosen based on the highest F-Score when tested on a test set. Two sets of models were trained using either tonsillar B-cell populations from GSE23090 or human cerebellum, heart, kidney, and testis tissue from GSE40499 (<xref ref-type="supplementary-material" rid="pcbi.1007309.s008">S7A Fig</xref>). The frontal cortex data was excluded from the GSE40499 set to make read counts in tissues more balanced. Each of the two resulting models were tuned using a grid-search for the <inline-formula id="pcbi.1007309.e004"><alternatives><graphic xlink:href="pcbi.1007309.e004.jpg" id="pcbi.1007309.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, <italic>E</italic><sub><italic>th</italic></sub>, and <italic>X</italic> parameters to optimize F-score when evaluated on either cancer cells from GSE18381 and GSE20592 or stem cells from GSE65706 and GSE62501; therefore, four tuning experiments were performed, corresponding to the four arrows in <xref ref-type="supplementary-material" rid="pcbi.1007309.s008">S7A Fig</xref>. Afterwards, models tuned using the cancer cell sets were validated using the stem cell sets and vice versa. The model resulting in the highest F-score from the test set was chosen for all remaining tests. Plots of the F-score as a function of each of the tuned parameters are presented in <xref ref-type="supplementary-material" rid="pcbi.1007309.s008">S7B–S7D Fig</xref>. In each training experiment the stratified sampling for the product model was set such that the negative set would be equal in size to the positive set. This was to allow as many products as possible to enter the hairpin phase while still filtering out enough that the resulting folds could be generated in reasonable amount of time.</p>
      <p>The model with the highest F-score resulted from training on the set of tonsillar B-cell populations (GSE23090) and tuning on human melanoma cells (GSE18381) and human normal and cancerous cervical cells (GSE20592) when validated against stem cell sets (GSE65706). Tuning through a grid search resulted in an optimum decision value of 0.28, an ARPM of 0.11, and a 1:25 ratio of positive to negative training data used in stratified sampling.</p>
    </sec>
    <sec id="sec020">
      <title>Comparisons with other tools</title>
      <p>miRWoods was compared with miRDeep2 and miReap in the prediction of microRNA loci from small RNA sequence data in well-annotated genomes. The data used were MCF-7 cell cytoplasmic and total-cell extract from GSE31069, human cancer cell lines from GSE16579, healthy human liver samples from GSE21279, and mouse brain, embryo, newborn, testes, and ovary from GSE20384. For miRDeep2 the FASTQ files were combined and the program was run with the same settings as previously published [<xref rid="pcbi.1007309.ref006" ref-type="bibr">6</xref>].</p>
      <p>We ran miReap with default parameters. FASTQ files were combined into a FASTA file with its reads collapsed. Reads were aligned with bowtie using the same settings used for miRWoods. However, because miRWoods uses quality scores and miReap does not, the allowable error outside of the bowtie alignment seed was changed from 50 to 80 to allow for at least 2 mismatches. Bowtie considers the default value of a mismatch without quality scores present to be 40 (see Supplementary Methods).</p>
      <p>In order to provide a comparison of the three pipelines, a separate set of scripts was used to determine accuracy. For each pipeline being tested a common set of functions was used to score each prediction as a true positive or false positive. We imposed more stringent requirements for true positives than most previous studies that require just overlap with annotated microRNAs. Predicted hairpins where the precursor folded in the wrong direction and only partially overlapped the annotation were named “overlaps” and scored as false positives. Additionally, precursors on the antisense strand of an annotation were named false positives because there is uncertainty whether they are really active as miR precursors.</p>
      <p>A set of custom-made scripts was also developed to find homology for novel predictions from each of the three pipelines. Mature products from precursors that did not overlap annotations were searched with BLAST to the database of mature microRNA found in miRBase [<xref rid="pcbi.1007309.ref036" ref-type="bibr">36</xref>]. Mature products were named homologous if they had the same seed region and an E-value less than 0.05 when compared with a miRNA in the database.</p>
      <p>The sensitivity, specificity and F-scores were used to compare each of the three pipelines. The F-score was used to evaluate performance for two reasons. First, different mapping and filtering methods result in variable numbers of precursors being expressed. Because the F-score does not rely on a tally of the number of true negatives, it is better for comparisons. Second, the type of data being analyzed will tend to be very unbalanced with far more non-miRs than miRs, which leads to an inflated accuracy.</p>
    </sec>
    <sec id="sec021">
      <title>Dicer knockdown comparisons</title>
      <p>The differences in microRNA expression between wild-type cells and cells in which Dicer had been knocked down were compared across pipelines. Small RNA samples collected from total cell content and cytoplasmic fraction for this test came from the series GSE31069 downloaded from GEO. For each pipeline a set of predictions was generated for both wild-type samples. In each case, the log fold change was computed for each novel prediction comparing the expression of the wild-type cells versus cells in which Dicer had been knocked down. A pseudocount of 0.015 ARPM was used to avoid taking the log of zero.</p>
    </sec>
    <sec id="sec022">
      <title>Validation of bovine and feline microRNA predictions</title>
      <p>Novel microRNA predictions were evaluated with homology to known microRNAs from other species and validated by qPCR. We validated the expression of the novel miRs with the highest decision value using qPCR across the tissues we examined.</p>
      <sec id="sec023">
        <title>Feline microRNAs</title>
        <p>Feline RNA samples were reverse transcribed with the HiSpec Buffer system of the miScript II RT kit. We performed qPCR in 96 well plates with the ABI StepOnePlus using cDNA generated from 2.5 ng total RNA, miScript Primer assays, and miScript SYBR Green PCR mix combined in 25 μL reaction volumes. Cycling followed manufacturer’s instructions. Melt Curve analysis was performed to insure single product generation and the average of all primer efficiencies was 1.8. Of the four potential reference genes selected from feline sequencing data, two, miR-25 and miR-191, were found to be stable across tissues and the average of CT values was used to normalize expression.</p>
      </sec>
      <sec id="sec024">
        <title>Bovine microRNAs</title>
        <p>RT was performed using the miScript II RT Kit and qPCR was performed in a HT7900 ABI system in 384-well plate using the Custom miScript Primer Assay and miScript SYBR Green PCR Kit, following the manufacturer-instructions with a 4-fold dilution of cDNA prior qPCR. We performed normalization using internal control genes (ICGs) or reference genes as indicated by the MIQE guideline [<xref rid="pcbi.1007309.ref037" ref-type="bibr">37</xref>]. It has been proposed and demonstrated that the use of ICGs for normalization for miRs qPCR provides a more accurate measure of expression than other methods, such as normalization with 5S RNA, U6 snRNA, or total RNA [<xref rid="pcbi.1007309.ref038" ref-type="bibr">38</xref>]. In order to identify the best ICGs to normalize the novel miRs, we selected predicted miRs with low-variability and similar levels in expression across various tissues, as previously performed [<xref rid="pcbi.1007309.ref038" ref-type="bibr">38</xref>]. The miRs selected for bovine were miR-7, bta-miR-32, bta-miR494, bta-miR-1388, bta-miR-2431, bta-miR-2483, and bta-miR-6520; Final qPCR data for bovine were analyzed using LinRegPCR to account for efficiency of amplification [<xref rid="pcbi.1007309.ref039" ref-type="bibr">39</xref>]. Bovine qPCR data from the tested internal control miRs were normalized using geNorm to determine the M- and V-values [<xref rid="pcbi.1007309.ref040" ref-type="bibr">40</xref>]. bta-miR-7 had a M-value &gt;1.5 and was therefore not used for normalization but rather as a positive control, while the most stable miR pair was miR-494 and miR-6520 (M = 0.98). The most stable normalization was obtained by using the 6 most stable miRs with a final V-value of 0.245. The normalization factor was calculated by geNorm as the geometrical mean of the most stable miRs.</p>
      </sec>
    </sec>
    <sec id="sec025">
      <title>Hierarchical clustering</title>
      <p>Hierarchical clustering was performed for the expression of known and novel mir-2284/mir-2285 family miRs in bovine. Expression was normalized by computing z-scores, subtracting the mean and dividing by the standard deviation across tissues.</p>
    </sec>
    <sec id="sec026">
      <title>Identification of clusters</title>
      <p>Clusters were identified by locating sets of precursors with genomic positions within 10 kbp of each other. Prior to detecting clusters using novel predictions, the set of annotated microRNAs were grouped into clusters. This was done first because if novel microRNAs fell within a cluster of annotated microRNAs it may count as further evidence that that microRNA is real. After the clusters of annotated miRs were identified, novel microRNAs were grouped into new clusters or incorporated into clusters of annotated microRNAs.</p>
    </sec>
    <sec id="sec027">
      <title>Identification of novel miR families</title>
      <p>In order to search for novel miR families, the sequences of each novel miR was blasted to a set containing a combination of the novel miRs found using miRWoods and the set of all known miRs from miRBase. Family membership requires a perfectly matching seed sequence, both products were on the same arm for each hairpin, and a BLAST E-value less than or equal to 0.5 for the mature product. In addition, we excluded examples with top hits that are antisense to itself and cases with identical mature sequences to prevent inclusion of loci originating from repetitive regions.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec028">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s001">
      <label>S1 Methods</label>
      <caption>
        <title>Supplementary Methods.</title>
        <p>A document of providing additional detail for methods used for miRWoods.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s002">
      <label>S1 Fig</label>
      <caption>
        <title>Importance of features.</title>
        <p><bold>a</bold> The importance of each feature based on the Boruta analysis for the mature product random forest (MPRF) <bold>b</bold> The importance of each feature based on the Boruta analysis for the Hairpin Random Forest (HPRF).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s003">
      <label>S2 Fig</label>
      <caption>
        <title>Further feature interpretation: Removal of correlated features I.</title>
        <p><bold>a</bold> Boruta analysis of feature importance for MRPF with correlated features removed. <bold>b</bold> Boruta analysis for HRPF with correlated features and the MRPF decision value removed.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s004">
      <label>S3 Fig</label>
      <caption>
        <title>Further feature interpretation: Removal of correlated features II.</title>
        <p><bold>a</bold> Change in feature importance for MRPF with correlated features removed. <bold>b</bold> Change in feature importance for HRPF with correlated features removed.<bold>c</bold> the F1-score for miRWoods with correlated features and MRPF decision value removed compared to the full feature set.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s005">
      <label>S4 Fig</label>
      <caption>
        <title>Abundance-related features.</title>
        <p><bold>a</bold> Distribution of read abundance for correct miRWoods predictions on MCF7 total cell content. <bold>b</bold> distribution of read abundance for correct miRDeep2 predictions on MCF7 total cell content. <bold>c</bold> distribution of read abundance for correct miReap predictions on MCF7 total cell content. <bold>d</bold> Distribution of read abundance for correct miRWoods predictions on mouse embryos. <bold>e</bold> distribution of read abundance for correct miRDeep2 predictions on mouse embryos. <bold>f</bold> distribution of read abundance for correct miReap predictions on mouse embryos. <bold>g</bold> bar plot of correct predictions with only one read for all samples in human and mouse. <bold>h</bold> F1-score of predictions with size-related features compared to without.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s006">
      <label>S5 Fig</label>
      <caption>
        <title>Effectiveness of duplex method.</title>
        <p><bold>a</bold> RNAseq for hsa-miR-6860 shows miRWoods prediction covering an additional read stack next to the splice junction, which indicates that hsa-miR-6860 may be a half-mirtron. <bold>b</bold> RNAseq for hsa-mir-431 showing predicted folds for miRWoods and miRDeep.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s007">
      <label>S6 Fig</label>
      <caption>
        <title>Cross-species performance.</title>
        <p>Comparison between cross-species F1-score and same-species F1-score. All of miRWoods evaluations were tested on a single model trained and tuned on human datasets. The best performance is observed on mouse samples.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s008">
      <label>S7 Fig</label>
      <caption>
        <title>Tuning miRWoods.</title>
        <p><bold>a</bold> Analysis pipelines and corresponding data sets used for training, tuning, and testing correspond to the paths of the arrows. <bold>b</bold> Plot of F1-score versus decision value threshold used in tuning the decision value threshold. <bold>c</bold> Plot of F1-score versus ARPM threshold used in tuning the ARPM threshold. <bold>d</bold> Plot of f1-score versus X in 1:X stratified sampling used to tune the amount of negative (non-miR) loci used in training the HRPF.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s009">
      <label>S8 Fig</label>
      <caption>
        <title>Dicer knockdown data.</title>
        <p><bold>a</bold> Scatter plot for hairpins in the MCF7 (total) set, plotting log fold change of Dicer knockdown vs wildtype against the miRWoods decision value for annotated (red) and novel (blue) hairpins. The vertical line in the plot represents the decision value cut-off with all miRWoods predicted precursors to the right of it. <bold>b</bold> Box plot showing the log fold change of Dicer knockdown vs wildtype of annotated precursors within miRBase and novel precursors is predicted by each software for the MCF7 (total) set. <bold>(c-d)</bold> CDF’s for <bold>c</bold> MCF7 (Total) and <bold>d</bold> MCF7 (cytoplasmic) log fold change of Dicer knockdown vs wildtype for novel precursors.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s010">
      <label>S9 Fig</label>
      <caption>
        <title>Individual Examples of Dicer knockdown.</title>
        <p>Predicted secondary structures for <bold>a</bold> hsa-Novel35, <bold>b</bold> hsa-Novel28, <bold>c</bold> hsa-Novel23, <bold>d</bold> hsa-Nove65, <bold>e</bold> hsa-Novel92, and <bold>f</bold> hsa-Novel99. <bold>(g-k)</bold> RNAseq for <bold>g</bold> hsa-Novel35, hsa-Novel28, <bold>h</bold> hsa-Novel23, <bold>i</bold> hsa-Novel65, <bold>j</bold> hsa-Novel92, and <bold>k</bold> hsa-Novel99.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s011">
      <label>S10 Fig</label>
      <caption>
        <title>Additional Euler plots comparing miRWoods, miRDeep, and miRBase.</title>
        <p>Euler plots for <bold>a</bold> Human MCF7 (total), <bold>b</bold> Human cell lines, <bold>c</bold> Mouse brain, <bold>d</bold> Mouse embryo, <bold>e</bold> Mouse newborn, and <bold>f</bold> Mouse testes sets.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s012">
      <label>S11 Fig</label>
      <caption>
        <title>Additional Euler plots comparing miRWoods, miReap, and miRBase.</title>
        <p>Euler plots for <bold>a</bold>. Human MCF7 (total), <bold>b</bold> Human MCF7 (cytoplasmic), <bold>c</bold> Human cell lines, <bold>d</bold> Human liver, <bold>e</bold> Mouse brain, <bold>f</bold> Mouse embryo, <bold>g</bold> Mouse newborn, <bold>h</bold> Mouse testes and, <bold>i</bold> Mouse ovaries sets.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s012.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s013">
      <label>S12 Fig</label>
      <caption>
        <title>mir-548 Phylogenetic tree.</title>
        <p>Phylogenetic tree showing expansion of the mir-548 precursor family in human. Annotated mir-548 precursors are shown in blue and predicted novel precursors are shown in green.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s013.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s014">
      <label>S13 Fig</label>
      <caption>
        <title>Differential expression analysis of miRs not shown in main text.</title>
        <p>Expression of fca-mir-1-1 using <bold>a</bold> RNAseq and <bold>b</bold> qPCR validation of differential expression in muscle. <bold>(c-d)</bold> Expression of fca-mir-205 using <bold>c</bold> RNAseq and <bold>d</bold> qPCR validation of differential expression in skin.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s014.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s015">
      <label>S1 Table</label>
      <caption>
        <title>Feature correlation.</title>
        <p>A table of correlations between features used by miRWoods.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s015.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s016">
      <label>S2 Table</label>
      <caption>
        <title>Duplex-focused spans.</title>
        <p>Percentage of cases where duplex method produced span used in final prediction.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s016.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s017">
      <label>S3 Table</label>
      <caption>
        <title>Data summary.</title>
        <p>A summary of all of the datasets tested by miRWoods.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s017.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s018">
      <label>S4 Table</label>
      <caption>
        <title>Mature counts.</title>
        <p>A table of raw counts, adjusted counts, reads per million (RPM), and adjusted reads per million (ARPM) for all annotated and predicted microRNA over all test sets.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s018.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s019">
      <label>S5 Table</label>
      <caption>
        <title>Tuning experiments.</title>
        <p>Summary of data sets and results from the tuning experiments.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s019.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s020">
      <label>S6 Table</label>
      <caption>
        <title>Dicer knockdown enrichment.</title>
        <p>P-values computed from comparing the log-fold change of dicer knockdowns compared to wild-type using a t-test, for the novel predictions of each method and miRBase.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s020.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s021">
      <label>S7 Table</label>
      <caption>
        <title>Clusters.</title>
        <p>Clusters of annotated and predicted microRNA for human, mouse, cat, and cow genomes. miRBase was used as the annotated set for human, mouse, and cow, and the predictions from Lagana <italic>et al</italic>. [<xref rid="pcbi.1007309.ref019" ref-type="bibr">19</xref>] were used as the annotated set for cat. In column B under cluster_source, an annotated set was named as the source if a cluster of two or more annotations could be clustered together without miRWoods predictions. Otherwise the cluster source was called novel.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s021.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007309.s022">
      <label>S8 Table</label>
      <caption>
        <title>Novel families.</title>
        <p>A list of candidate novel families found after comparing predictions across all testing sets.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007309.s022.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank P. Andy Karplus, Duo Jiang, and Fuxin Li for helpful discussions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007309.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>Y</given-names></name>, <name><surname>Ahn</surname><given-names>C</given-names></name>, <name><surname>Han</surname><given-names>J</given-names></name>, <name><surname>Choi</surname><given-names>H</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Yim</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>The nuclear RNase III Drosha initiates microRNA processing</article-title>. <source>Nature</source>. <year>2003</year>;<volume>425</volume>(<issue>6956</issue>):<fpage>415</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/nature01957</pub-id> .<?supplied-pmid 14508493?><pub-id pub-id-type="pmid">14508493</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Ambros</surname><given-names>V</given-names></name>. <article-title>The functions of animal microRNAs</article-title>. <source>Nature</source>. <year>2004</year>;<volume>431</volume>(<issue>7006</issue>):<fpage>350</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1038/nature02871</pub-id><?supplied-pmid 15372042?><pub-id pub-id-type="pmid">15372042</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>W</given-names></name>, <name><surname>Hendrix</surname><given-names>D</given-names></name>, <name><surname>Levine</surname><given-names>M</given-names></name>, <name><surname>Haley</surname><given-names>B</given-names></name>. <article-title>A distinct class of small RNAs arises from pre-miRNA–proximal regions in a simple chordate</article-title>. <source>Nature structural &amp; molecular biology</source>. <year>2009</year>;<volume>16</volume>(<issue>2</issue>):<fpage>183</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Hendrix</surname><given-names>D</given-names></name>, <name><surname>Levine</surname><given-names>M</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>. <article-title>miRTRAP, a computational method for the systematic identification of miRNAs from high throughput sequencing data</article-title>. <source>Genome biology</source>. <year>2010</year>;<volume>11</volume>(<issue>4</issue>):<fpage>R39</fpage><pub-id pub-id-type="doi">10.1186/gb-2010-11-4-r39</pub-id><?supplied-pmid 20370911?><pub-id pub-id-type="pmid">20370911</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Friedländer</surname><given-names>MR</given-names></name>, <name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Adamidi</surname><given-names>C</given-names></name>, <name><surname>Maaskola</surname><given-names>J</given-names></name>, <name><surname>Einspanier</surname><given-names>R</given-names></name>, <name><surname>Knespel</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Discovering microRNAs from deep sequencing data using miRDeep</article-title>. <source>Nature biotechnology</source>. <year>2008</year>;<volume>26</volume>(<issue>4</issue>):<fpage>407</fpage><pub-id pub-id-type="doi">10.1038/nbt1394</pub-id><?supplied-pmid 18392026?><pub-id pub-id-type="pmid">18392026</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Friedländer</surname><given-names>MR</given-names></name>, <name><surname>Mackowiak</surname><given-names>SD</given-names></name>, <name><surname>Li</surname><given-names>N</given-names></name>, <name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Rajewsky</surname><given-names>N</given-names></name>. <article-title>miRDeep2 accurately identifies known and hundreds of novel microRNA genes in seven animal clades</article-title>. <source>Nucleic acids research</source>. <year>2011</year>;<volume>40</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>52</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr688</pub-id><?supplied-pmid 21911355?><pub-id pub-id-type="pmid">21911355</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>. <article-title>miRDeep-P: a computational tool for analyzing the microRNA transcriptome in plants</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>18</issue>):<fpage>2614</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr430</pub-id><?supplied-pmid 21775303?><pub-id pub-id-type="pmid">21775303</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>An</surname><given-names>J</given-names></name>, <name><surname>Lai</surname><given-names>J</given-names></name>, <name><surname>Lehman</surname><given-names>ML</given-names></name>, <name><surname>Nelson</surname><given-names>CC</given-names></name>. <article-title>miRDeep*: an integrated application tool for miRNA identification from RNA sequencing data</article-title>. <source>Nucleic acids research</source>. <year>2012</year>;<volume>41</volume>(<issue>2</issue>):<fpage>727</fpage>–<lpage>37</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1187</pub-id><?supplied-pmid 23221645?><pub-id pub-id-type="pmid">23221645</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>Q</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Guo</surname><given-names>X</given-names></name>, <name><surname>Jiang</surname><given-names>X</given-names></name>, <name><surname>Ren</surname><given-names>Z</given-names></name>, <etal>et al</etal><article-title>Identification and characterization of novel amphioxus microRNAs by Solexa sequencing</article-title>. <source>Genome biology</source>. <year>2009</year>;<volume>10</volume>(<issue>7</issue>):<fpage>R78</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-7-r78</pub-id><?supplied-pmid 19615057?><pub-id pub-id-type="pmid">19615057</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Hackenberg</surname><given-names>M</given-names></name>, <name><surname>Sturm</surname><given-names>M</given-names></name>, <name><surname>Langenberger</surname><given-names>D</given-names></name>, <name><surname>Falcon-Perez</surname><given-names>JM</given-names></name>, <name><surname>Aransay</surname><given-names>AM</given-names></name>. <article-title>miRanalyzer: a microRNA detection and analysis tool for next-generation sequencing experiments</article-title>. <source>Nucleic acids research</source>. <year>2009</year>;<volume>37</volume>(<issue>suppl_2</issue>):<fpage>W68</fpage>–<lpage>W76</lpage>.<pub-id pub-id-type="pmid">19433510</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Sheng</surname><given-names>Y</given-names></name>, <name><surname>Engström</surname><given-names>PG</given-names></name>, <name><surname>Lenhard</surname><given-names>B</given-names></name>. <article-title>Mammalian microRNA prediction through a support vector machine model of sequence and structure</article-title>. <source>PloS one</source>. <year>2007</year>;<volume>2</volume>(<issue>9</issue>):<fpage>e946</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0000946</pub-id><?supplied-pmid 17895987?><pub-id pub-id-type="pmid">17895987</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Tempel</surname><given-names>S</given-names></name>, <name><surname>Zerath</surname><given-names>B</given-names></name>, <name><surname>Zehraoui</surname><given-names>F</given-names></name>, <name><surname>Tahi</surname><given-names>F</given-names></name>. <article-title>miRBoost: boosting support vector machines for microRNA precursor classification</article-title>. <source>RNA</source>. <year>2015</year>;<volume>21</volume>(<issue>5</issue>):<fpage>775</fpage>–<lpage>85</lpage>. <pub-id pub-id-type="doi">10.1261/rna.043612.113</pub-id><?supplied-pmid 25795417?><pub-id pub-id-type="pmid">25795417</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Mathelier</surname><given-names>A</given-names></name>, <name><surname>Carbone</surname><given-names>A</given-names></name>. <article-title>MIReNA: finding microRNAs with high accuracy and no learning at genome scale and from deep sequencing data</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>18</issue>):<fpage>2226</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq329</pub-id><?supplied-pmid 20591903?><pub-id pub-id-type="pmid">20591903</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>P</given-names></name>, <name><surname>Wu</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>W</given-names></name>, <name><surname>Ma</surname><given-names>W</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>, <name><surname>Lu</surname><given-names>Z</given-names></name>. <article-title>MiPred: classification of real and pseudo microRNA precursors using random forest prediction model with combined features</article-title>. <source>Nucleic acids research</source>. <year>2007</year>;<volume>35</volume>(<issue>suppl_2</issue>):<fpage>W339</fpage>–<lpage>W44</lpage>.<pub-id pub-id-type="pmid">17553836</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Barrett</surname><given-names>T</given-names></name>, <name><surname>Troup</surname><given-names>DB</given-names></name>, <name><surname>Wilhite</surname><given-names>SE</given-names></name>, <name><surname>Ledoux</surname><given-names>P</given-names></name>, <name><surname>Evangelista</surname><given-names>C</given-names></name>, <name><surname>Kim</surname><given-names>IF</given-names></name>, <etal>et al</etal><article-title>NCBI GEO: archive for functional genomics data sets—10 years on</article-title>. <source>Nucleic acids research</source>. <year>2010</year>;<volume>39</volume>(<issue>suppl_1</issue>):<fpage>D1005</fpage>–<lpage>D10</lpage>.<pub-id pub-id-type="pmid">21097893</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Raghavan</surname><given-names>V</given-names></name>, <name><surname>Bollmann</surname><given-names>P</given-names></name>, <name><surname>Jung</surname><given-names>GS</given-names></name>. <article-title>A critical investigation of recall and precision as measures of retrieval system performance</article-title>. <source>ACM Transactions on Information Systems (TOIS)</source>. <year>1989</year>;<volume>7</volume>(<issue>3</issue>):<fpage>205</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref017">
      <label>17</label>
      <mixed-citation publication-type="other">Davis J, Goadrich M, editors. The relationship between Precision-Recall and ROC curves. Proceedings of the 23rd international conference on Machine learning; 2006: ACM.</mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>J-z</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>S</given-names></name>, <name><surname>Yuan</surname><given-names>D</given-names></name>, <name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Yi</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>MicroRNA miR-320a and miR-140 inhibit mink enteritis virus infection by repression of its receptor, feline transferrin receptor</article-title>. <source>Virology journal</source>. <year>2014</year>;<volume>11</volume>(<issue>1</issue>):<fpage>210</fpage>.<pub-id pub-id-type="pmid">25465595</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Laganà</surname><given-names>A</given-names></name>, <name><surname>Dirksen</surname><given-names>WP</given-names></name>, <name><surname>Supsavhad</surname><given-names>W</given-names></name>, <name><surname>Yilmaz</surname><given-names>AS</given-names></name>, <name><surname>Ozer</surname><given-names>HG</given-names></name>, <name><surname>Feller</surname><given-names>JD</given-names></name>, <etal>et al</etal><article-title>Discovery and characterization of the feline miRNAome</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>9263</fpage><pub-id pub-id-type="doi">10.1038/s41598-017-10164-w</pub-id><?supplied-pmid 28835705?><pub-id pub-id-type="pmid">28835705</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Law</surname><given-names>CW</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome biology</source>. <year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>R29</fpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id><?supplied-pmid 24485249?><pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Lawless</surname><given-names>N</given-names></name>, <name><surname>Vegh</surname><given-names>P</given-names></name>, <name><surname>O’Farrelly</surname><given-names>C</given-names></name>, <name><surname>Lynn</surname><given-names>DJ</given-names></name>. <article-title>The role of microRNAs in bovine infection and immunity</article-title>. <source>Frontiers in immunology</source>. <year>2014</year>;<volume>5</volume>:<fpage>611</fpage><pub-id pub-id-type="doi">10.3389/fimmu.2014.00611</pub-id><?supplied-pmid 25505900?><pub-id pub-id-type="pmid">25505900</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Lawless</surname><given-names>N</given-names></name>, <name><surname>Foroushani</surname><given-names>AB</given-names></name>, <name><surname>McCabe</surname><given-names>MS</given-names></name>, <name><surname>O’Farrelly</surname><given-names>C</given-names></name>, <name><surname>Lynn</surname><given-names>DJ</given-names></name>. <article-title>Next generation sequencing reveals the expression of a unique miRNA profile in response to a gram-positive bacterial infection</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e57543</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0057543</pub-id><?supplied-pmid 23472090?><pub-id pub-id-type="pmid">23472090</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Sakurai</surname><given-names>D</given-names></name>, <name><surname>Uchida</surname><given-names>R</given-names></name>, <name><surname>Ihara</surname><given-names>F</given-names></name>, <name><surname>Kunii</surname><given-names>N</given-names></name>, <name><surname>Nakagawa</surname><given-names>T</given-names></name>, <name><surname>Chazono</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Immunosuppressive property of submandibular lymph nodes in patients with head and neck tumors: differential distribution of regulatory T cells</article-title>. <source>BMC research notes</source>. <year>2018</year>;<volume>11</volume>(<issue>1</issue>):<fpage>479</fpage><pub-id pub-id-type="doi">10.1186/s13104-018-3587-z</pub-id><?supplied-pmid 30012191?><pub-id pub-id-type="pmid">30012191</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>S</given-names></name>, <name><surname>Jin</surname><given-names>L</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Grimm</surname><given-names>D</given-names></name>, <name><surname>Rossi</surname><given-names>JJ</given-names></name>, <etal>et al</etal><article-title>Thermodynamic stability of small hairpin RNAs highly influences the loading process of different mammalian Argonautes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>22</issue>):<fpage>9208</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bao</surname><given-names>H</given-names></name>, <name><surname>Kommadath</surname><given-names>A</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>, <name><surname>Meng</surname><given-names>Y</given-names></name>, <name><surname>Arantes</surname><given-names>AS</given-names></name>, <name><surname>Plastow</surname><given-names>GS</given-names></name>, <etal>et al</etal><article-title>Expansion of ruminant-specific microRNAs shapes target gene expression divergence between ruminant and non-ruminant species</article-title>. <source>BMC genomics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>609</fpage>.<pub-id pub-id-type="pmid">24020371</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Piriyapongsa</surname><given-names>J</given-names></name>, <name><surname>Jordan</surname><given-names>IK</given-names></name>. <article-title>A family of human microRNA genes from miniature inverted-repeat transposable elements</article-title>. <source>PloS one</source>. <year>2007</year>;<volume>2</volume>(<issue>2</issue>):<fpage>e203</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0000203</pub-id><?supplied-pmid 17301878?><pub-id pub-id-type="pmid">17301878</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>M</given-names></name>. <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>. <source>EMBnet journal</source>. <year>2011</year>;<volume>17</volume>(<issue>1</issue>):pp. <fpage>10</fpage>–<lpage>2</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome biology</source>. <year>2009</year>;<volume>10</volume>(<issue>3</issue>):<fpage>R25</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id><?supplied-pmid 19261174?><pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Homer</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>The sequence alignment/map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref030">
      <label>30</label>
      <mixed-citation publication-type="book"><name><surname>Wootton</surname><given-names>JC</given-names></name>, <name><surname>Federhen</surname><given-names>S</given-names></name>. <chapter-title>[33] Analysis of compositionally biased regions in sequence databases</chapter-title><source>Methods in enzymology</source>. <volume>266</volume>: <publisher-name>Elsevier</publisher-name>; <year>1996</year> p. <fpage>554</fpage>–<lpage>71</lpage>. <pub-id pub-id-type="doi">10.1016/s0076-6879(96)66035-2</pub-id>
<?supplied-pmid 8743706?><pub-id pub-id-type="pmid">8743706</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Morin</surname><given-names>RD</given-names></name>, <name><surname>O’Connor</surname><given-names>MD</given-names></name>, <name><surname>Griffith</surname><given-names>M</given-names></name>, <name><surname>Kuchenbauer</surname><given-names>F</given-names></name>, <name><surname>Delaney</surname><given-names>A</given-names></name>, <name><surname>Prabhu</surname><given-names>A-L</given-names></name>, <etal>et al</etal><article-title>Application of massively parallel sequencing to microRNA profiling and discovery in human embryonic stem cells</article-title>. <source>Genome research</source>. <year>2008</year>;<volume>18</volume>(<issue>4</issue>):<fpage>610</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1101/gr.7179508</pub-id><?supplied-pmid 18285502?><pub-id pub-id-type="pmid">18285502</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Zuker</surname><given-names>M</given-names></name>, <name><surname>Stiegler</surname><given-names>P</given-names></name>. <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>. <source>Nucleic acids research</source>. <year>1981</year>;<volume>9</volume>(<issue>1</issue>):<fpage>133</fpage>–<lpage>48</lpage>. <pub-id pub-id-type="doi">10.1093/nar/9.1.133</pub-id><?supplied-pmid 6163133?><pub-id pub-id-type="pmid">6163133</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Lorenz</surname><given-names>R</given-names></name>, <name><surname>Bernhart</surname><given-names>SH</given-names></name>, <name><surname>Zu Siederdissen</surname><given-names>CH</given-names></name>, <name><surname>Tafer</surname><given-names>H</given-names></name>, <name><surname>Flamm</surname><given-names>C</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <etal>et al</etal><article-title>ViennaRNA Package 2.0</article-title>. <source>Algorithms for Molecular Biology</source>. <year>2011</year>;<volume>6</volume>(<issue>1</issue>):<fpage>26</fpage>.<pub-id pub-id-type="pmid">22115189</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Ruby</surname><given-names>JG</given-names></name>, <name><surname>Stark</surname><given-names>A</given-names></name>, <name><surname>Johnston</surname><given-names>WK</given-names></name>, <name><surname>Kellis</surname><given-names>M</given-names></name>, <name><surname>Bartel</surname><given-names>DP</given-names></name>, <name><surname>Lai</surname><given-names>EC</given-names></name>. <article-title>Evolution, biogenesis, expression, and target predictions of a substantially expanded set of Drosophila microRNAs</article-title>. <source>Genome research</source>. <year>2007</year>;<volume>17</volume>(<issue>12</issue>):000-.</mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>H</given-names></name>, <name><surname>Wu</surname><given-names>Y</given-names></name>, <name><surname>Niu</surname><given-names>Q</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Jia</surname><given-names>G</given-names></name>, <name><surname>Manjunath</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>A sliding-bulge structure at the Dicer processing site of pre-miRNAs regulates alternative Dicer processing to generate 5′-isomiRs</article-title>. <source>Heliyon</source>. <year>2016</year>;<volume>2</volume>(<issue>9</issue>):<fpage>e00148</fpage><pub-id pub-id-type="doi">10.1016/j.heliyon.2016.e00148</pub-id><?supplied-pmid 27656682?><pub-id pub-id-type="pmid">27656682</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Kozomara</surname><given-names>A</given-names></name>, <name><surname>Griffiths-Jones</surname><given-names>S</given-names></name>. <article-title>miRBase: annotating high confidence microRNAs using deep sequencing data</article-title>. <source>Nucleic acids research</source>. <year>2013</year>;<volume>42</volume>(<issue>D1</issue>):<fpage>D68</fpage>–<lpage>D73</lpage>.<pub-id pub-id-type="pmid">24275495</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Bustin</surname><given-names>SA</given-names></name>, <name><surname>Beaulieu</surname><given-names>J-F</given-names></name>, <name><surname>Huggett</surname><given-names>J</given-names></name>, <name><surname>Jaggi</surname><given-names>R</given-names></name>, <name><surname>Kibenge</surname><given-names>FS</given-names></name>, <name><surname>Olsvik</surname><given-names>PA</given-names></name>, <etal>et al</etal><article-title>MIQE precis: Practical implementation of minimum standard guidelines for fluorescence-based quantitative real-time PCR experiments</article-title>. <source>BioMed Central</source>; <year>2010</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Peltier</surname><given-names>HJ</given-names></name>, <name><surname>Latham</surname><given-names>GJ</given-names></name>. <article-title>Normalization of microRNA expression levels in quantitative RT-PCR assays: identification of suitable reference RNA targets in normal and cancerous human solid tissues</article-title>. <source>Rna</source>. <year>2008</year>;<volume>14</volume>(<issue>5</issue>):<fpage>844</fpage>–<lpage>52</lpage>. <pub-id pub-id-type="doi">10.1261/rna.939908</pub-id><?supplied-pmid 18375788?><pub-id pub-id-type="pmid">18375788</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Ruijter</surname><given-names>J</given-names></name>, <name><surname>Ramakers</surname><given-names>C</given-names></name>, <name><surname>Hoogaars</surname><given-names>W</given-names></name>, <name><surname>Karlen</surname><given-names>Y</given-names></name>, <name><surname>Bakker</surname><given-names>O</given-names></name>, <name><surname>Van den Hoff</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Amplification efficiency: linking baseline and bias in the analysis of quantitative PCR data</article-title>. <source>Nucleic acids research</source>. <year>2009</year>;<volume>37</volume>(<issue>6</issue>):<fpage>e45</fpage>–<lpage>e</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkp045</pub-id><?supplied-pmid 19237396?><pub-id pub-id-type="pmid">19237396</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007309.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Vandesompele</surname><given-names>J</given-names></name>, <name><surname>De Preter</surname><given-names>K</given-names></name>, <name><surname>Pattyn</surname><given-names>F</given-names></name>, <name><surname>Poppe</surname><given-names>B</given-names></name>, <name><surname>Van Roy</surname><given-names>N</given-names></name>, <name><surname>De Paepe</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Accurate normalization of real-time quantitative RT-PCR data by geometric averaging of multiple internal control genes</article-title>. <source>Genome biology</source>. <year>2002</year>;<volume>3</volume>(<issue>7</issue>):<fpage>research0034</fpage> 1. <pub-id pub-id-type="doi">10.1186/gb-2002-3-7-research0034</pub-id>
<?supplied-pmid 12184808?><pub-id pub-id-type="pmid">12184808</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
