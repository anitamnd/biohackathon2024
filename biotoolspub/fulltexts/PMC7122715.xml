<?properties open_access?>
<?subarticle pone.0230259.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7122715</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-24923</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230259</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Diagnostic Medicine</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Pulmonary Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Pulmonary Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Radiology and Imaging</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Pulmonary Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Neuroimaging</subject>
            <subj-group>
              <subject>Computed Axial Tomography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neuroimaging</subject>
            <subj-group>
              <subject>Computed Axial Tomography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Diagnostic Medicine</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Tomography</subject>
              <subj-group>
                <subject>Computed Axial Tomography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Tomography</subject>
              <subj-group>
                <subject>Computed Axial Tomography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Radiology and Imaging</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Tomography</subject>
              <subj-group>
                <subject>Computed Axial Tomography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Morphometry</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Classical Mechanics</subject>
            <subj-group>
              <subject>Continuum Mechanics</subject>
              <subj-group>
                <subject>Fluid Mechanics</subject>
                <subj-group>
                  <subject>Fluid Dynamics</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Visualization</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pulmonology</subject>
          <subj-group>
            <subject>Chronic Obstructive Pulmonary Disease</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pulmonology</subject>
          <subj-group>
            <subject>Asthma</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AVATREE: An open-source computational modelling framework modelling Anatomically Valid Airway TREE conformations</article-title>
      <alt-title alt-title-type="running-head">AVATREE: An open-source computational modelling framework modelling Anatomically Valid Airway TREE</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2811-235X</contrib-id>
        <name>
          <surname>Nousias</surname>
          <given-names>Stavros</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zacharaki</surname>
          <given-names>Evangelia I.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moustakas</surname>
          <given-names>Konstantinos</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Department of Electrical and Computer Engineering, University of Patras, Patras, Greece</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tian</surname>
          <given-names>Fang-Bao</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of New South Wales, AUSTRALIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>snousias@upatras.gr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>4</issue>
    <elocation-id>e0230259</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Nousias et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Nousias et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0230259.pdf"/>
    <abstract>
      <p>This paper presents AVATREE, a computational modelling framework that generates Anatomically Valid Airway tree conformations and provides capabilities for simulation of broncho-constriction apparent in obstructive pulmonary conditions. Such conformations are obtained from the personalized 3D geometry generated from computed tomography (CT) data through image segmentation. The patient-specific representation of the bronchial tree structure is extended beyond the visible airway generation depth using a knowledge-based technique built from morphometric studies. Additional functionalities of AVATREE include visualization of spatial probability maps for the airway generations projected on the CT imaging data, and visualization of the airway tree based on local structure properties. Furthermore, the proposed toolbox supports the simulation of broncho-constriction apparent in pulmonary diseases, such as chronic obstructive pulmonary disease (COPD) and asthma. AVATREE is provided as an open-source toolbox in C++ and is supported by a graphical user interface integrating the modelling functionalities. It can be exploited in studies of gas flow, gas mixing, ventilation patterns and particle deposition in the pulmonary system, with the aim to improve clinical decision making.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100008530</institution-id>
            <institution>European Regional Development Fund</institution>
          </institution-wrap>
        </funding-source>
        <award-id>T1EDK-03832</award-id>
        <principal-award-recipient>
          <name>
            <surname>Moustakas</surname>
            <given-names>Konstantinos</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work has been co‐financed by the European Regional Development Fund of the European Union and Greek national funds through the Operational Program Competitiveness, Entrepreneurship and Innovation, under the call RESEARCH – CREATE - INNOVATE Take-A-Breath, under grant agreement No. T1EDK-03832). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="19"/>
      <table-count count="1"/>
      <page-count count="25"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data underlying the results presented in the study are available from <ext-link ext-link-type="uri" xlink:href="https://vessel12.grand-challenge.org/">https://vessel12.grand-challenge.org/</ext-link>. The repository is now publicly available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/LungModelling/avatree">https://gitlab.com/LungModelling/avatree</ext-link>. Furthermore, the outcomes of the presented pipeline are available at <ext-link ext-link-type="uri" xlink:href="https://www.kaggle.com/vvrlabeceupatras/pone-avatree-results">https://www.kaggle.com/vvrlabeceupatras/pone-avatree-results</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data underlying the results presented in the study are available from <ext-link ext-link-type="uri" xlink:href="https://vessel12.grand-challenge.org/">https://vessel12.grand-challenge.org/</ext-link>. The repository is now publicly available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/LungModelling/avatree">https://gitlab.com/LungModelling/avatree</ext-link>. Furthermore, the outcomes of the presented pipeline are available at <ext-link ext-link-type="uri" xlink:href="https://www.kaggle.com/vvrlabeceupatras/pone-avatree-results">https://www.kaggle.com/vvrlabeceupatras/pone-avatree-results</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>1 Introduction</title>
    <p>In the past years, a multitude of studies paves the way for the generation of patient-specific computational models of lung structure and function. Early studies focused on airway morphometry generating the first human bronchial trees models [<xref rid="pone.0230259.ref001" ref-type="bibr">1</xref>]. These studies employed casts to decipher the relationship between bronchi lengths, branching angles and airway diameters [<xref rid="pone.0230259.ref002" ref-type="bibr">2</xref>]. On this basis, researchers built and validated a simulation model of airway morphogenesis from generation 1 to generation 23 [<xref rid="pone.0230259.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0230259.ref004" ref-type="bibr">4</xref>]. Deterministic parameterized bronchial tree generation algorithms used as single input the location of the first one or two generations and the lung volume, extracted directly from computed tomography, thus constituting the core of patient-specific modelling [<xref rid="pone.0230259.ref005" ref-type="bibr">5</xref>–<xref rid="pone.0230259.ref007" ref-type="bibr">7</xref>]. Personalized boundary conditions based on diagnostic imaging were combined with generative approaches and lumped models of resistive trees [<xref rid="pone.0230259.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0230259.ref009" ref-type="bibr">9</xref>] constituting the state of the art in pulmonary system modelling. Later studies incorporated patient-specific boundary conditions into computational fluid dynamics to examine flow regimes, wall stresses and aerosol deposition. In the same direction, modelling the airflow in cases of constrictive conditions, such as asthma and chronic obstructive pulmonary disease (COPD) became feasible with the aforementioned approaches. Wall constriction and remodelling combined with patient-specific boundary conditions allowed the quantification of breathing conditions for asthmatic patients. Motivated by these advancements we introduce an end-to-end modelling approach that produces Anatomically Valid Airway tree conformations(AVATREE). Such conformations are adapted to personalized geometry and boundary conditions derived from diagnostic imaging and well-established airway extraction methods. Specifically, this study aims to provide an open-source simulation framework to (i) exploit imaging data so as to provide patient-specific representations (ii) perform structural analysis (iii) extend the segmented airway tree to predict the airway branching across the whole lung volume (iv) visualize probabilistic confidence maps of generation data (v) simulate bronchoconstriction to (vi) access patient-specific airway functionality (vii) perform fluid dynamics simulation in patient-specific boundary conditions to access pulmonary function.</p>
    <sec id="sec002">
      <title>1.1 Background &amp; related work</title>
      <p>While early studies focused mainly on quantitative modeling approaches to gain insight into the lung function without an explicit link to the lung’s structure, with the advancements in computing power and the current medical imaging capabilities, the interest in the simulation of lung function based on personalized geometric models that incorporate the essential structural features of the lungs, has significantly increased [<xref rid="pone.0230259.ref010" ref-type="bibr">10</xref>]. By now, many studies propose the development and adoption of mathematical and geometrical models to study the structure of the airways and pulmonary physiology. Some address the problem of airway tree segmentation from CT images, while others analyze the branching patterns and bifurcations through airway morphometry or mathematical modelling. In this section, we briefly present representative approaches and introduce definitions for the different computational steps required during airway and pulmonary structure modelling and simulation. Airway segmentation, bronchial morphometry and tree branching, mathematical models of bifurcating distributing systems are required to derive patient-specific structural and functional modelling approaches.</p>
      <p>Early studies on airway morphometry [<xref rid="pone.0230259.ref011" ref-type="bibr">11</xref>–<xref rid="pone.0230259.ref013" ref-type="bibr">13</xref>] used casts of human lungs to study branching patterns and the relation between airway lengths and diameters. The most commonly used conducting airway model has been Weibel’s symmetric model “A” [<xref rid="pone.0230259.ref014" ref-type="bibr">14</xref>]. The airway position has also been described by Horsfield order [<xref rid="pone.0230259.ref001" ref-type="bibr">1</xref>] and Strahler order [<xref rid="pone.0230259.ref015" ref-type="bibr">15</xref>]. Later on, with the advancement of medical imaging techniques, the extraction of airway structure and lung volume from imaging started to play an important role in the analysis of pulmonary diseases. A literature review on the analysis of lung CTs, including segmentation of the various pulmonary structures, can be found in [<xref rid="pone.0230259.ref016" ref-type="bibr">16</xref>], while a comparative study of automated and semi-automated segmentation methods of the airway tree from CT images was presented in [<xref rid="pone.0230259.ref017" ref-type="bibr">17</xref>]. Overall, segmentation approaches can be classified into methods based on morphology [<xref rid="pone.0230259.ref018" ref-type="bibr">18</xref>], morphological aggregation [<xref rid="pone.0230259.ref019" ref-type="bibr">19</xref>], voxel classification [<xref rid="pone.0230259.ref020" ref-type="bibr">20</xref>], adaptive region growing with constraints [<xref rid="pone.0230259.ref021" ref-type="bibr">21</xref>–<xref rid="pone.0230259.ref028" ref-type="bibr">28</xref>], tube similarity [<xref rid="pone.0230259.ref029" ref-type="bibr">29</xref>, <xref rid="pone.0230259.ref030" ref-type="bibr">30</xref>] and gradient vector flow [<xref rid="pone.0230259.ref031" ref-type="bibr">31</xref>]. Several implementations of the aforementioned approaches are available in the literature. The tube segmentation framework [<xref rid="pone.0230259.ref030" ref-type="bibr">30</xref>] utilizing gradient vector flow [<xref rid="pone.0230259.ref031" ref-type="bibr">31</xref>] and the FAST heterogeneous medical image computing and visualization framework [<xref rid="pone.0230259.ref032" ref-type="bibr">32</xref>] utilizing the seeded region growing approach. AVATREE employs airway segmentation as a first step to obtain the personalized structure in the first generations, while the more advanced generations are simulated based on a tree extension algorithm.</p>
      <p>Furthermore, mathematical models of the airway structure were formulated to derive branching and structural rules. Deterministic mathematical models of bifurcating distributing systems were examined [<xref rid="pone.0230259.ref003" ref-type="bibr">3</xref>] setting the basis for modelling bronchial tree branching as a function of available lung space [<xref rid="pone.0230259.ref004" ref-type="bibr">4</xref>]. Deriving airway diameter as a relation of branching features facilitates full determination of the geometry given skeletal representations. Several studies mention scaling properties [<xref rid="pone.0230259.ref033" ref-type="bibr">33</xref>–<xref rid="pone.0230259.ref036" ref-type="bibr">36</xref>] for the airway diameters so that the average diameter <italic>D</italic> of a given airway at generation <italic>G</italic> is the product of the diameter of the trachea <italic>D</italic><sub>0</sub>. Furthermore, Kamiya et al. [<xref rid="pone.0230259.ref037" ref-type="bibr">37</xref>] validated the relation between airway diameter and branching angles and, Kitaoka et al. [<xref rid="pone.0230259.ref002" ref-type="bibr">2</xref>] proposed a branching model allowing the prediction of the relationship between branching angle and flow rate and between airway length and diameter. Experimental studies verified the validity of the aforementioned methods. For the surface reconstruction of airway surface Tawhai et al. [<xref rid="pone.0230259.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0230259.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0230259.ref038" ref-type="bibr">38</xref>] employed fitting cubic Hermite surfaces as described in [<xref rid="pone.0230259.ref039" ref-type="bibr">39</xref>]. The study of Hegedus et al. [<xref rid="pone.0230259.ref040" ref-type="bibr">40</xref>] generated surface models of idealized bifurcation through mathematical modelling rigorously extending the previous definitions [<xref rid="pone.0230259.ref041" ref-type="bibr">41</xref>]. The aforementioned studies are relevant to our approach. To avoid the definition of special rules in the reconstruction of the surface of bifurcations we define the same boundary conditions, as the Poisson-reconstructed surface of a sampled point cloud.</p>
      <p>Towards patient-specific structural and functional modelling, Tawhai et al. and Lin et al. [<xref rid="pone.0230259.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0230259.ref042" ref-type="bibr">42</xref>] studied the imposition of patient-specific boundary conditions to generate 1-dimensional and three-dimensional computational models taking into consideration the effects of turbulence. Towards the same direction, a review article [<xref rid="pone.0230259.ref010" ref-type="bibr">10</xref>] provides insight into multiscale finite element models of lung structure and function aiming towards a computational framework for bridging the spatial scales from molecular to the whole organ. Bordas et al. [<xref rid="pone.0230259.ref007" ref-type="bibr">7</xref>] developed an image analysis and modelling pipeline applied to healthy and asthmatic patient scans to produce complete personalized airway models to the acinar level incorporating CT acquisition, lung and lobar segmentation, airway segmentation and centerline extraction, algorithmic generation of distal airways and zero-dimensional models. Their implementation and results were included into Chaste framework [<xref rid="pone.0230259.ref043" ref-type="bibr">43</xref>], an open-source framework to facilitate computational modelling in heart, lung and soft tissue simulations. Towards the same direction, Montesantos et al. [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] presented a detailed algorithm for the generation of an individualized 3D deterministic model of the conducting part of the human tracheobronchial tree. With respect to the aforementioned studies, our work focuses on generating surface meshes of extended patient-based bronchial trees, suitable for computational fluid dynamics (CFD) simulations, along with a toolbox to simulate constriction of the airways.</p>
      <p>Several authors employed CFD to investigate flow regimes in the human lung. In our previous work [<xref rid="pone.0230259.ref045" ref-type="bibr">45</xref>, <xref rid="pone.0230259.ref046" ref-type="bibr">46</xref>] we performed narrowing deformations in CT extracted lung geometries to simulate constrictive conditions. Other studies in the same category include simulations for CT-based patient specific geometries [<xref rid="pone.0230259.ref047" ref-type="bibr">47</xref>–<xref rid="pone.0230259.ref052" ref-type="bibr">52</xref>], particle deposition [<xref rid="pone.0230259.ref053" ref-type="bibr">53</xref>–<xref rid="pone.0230259.ref056" ref-type="bibr">56</xref>], constrictive pulmonary diseases [<xref rid="pone.0230259.ref045" ref-type="bibr">45</xref>, <xref rid="pone.0230259.ref046" ref-type="bibr">46</xref>, <xref rid="pone.0230259.ref057" ref-type="bibr">57</xref>–<xref rid="pone.0230259.ref059" ref-type="bibr">59</xref>], micro-airway flow regimes [<xref rid="pone.0230259.ref057" ref-type="bibr">57</xref>], turbulence modelling [<xref rid="pone.0230259.ref060" ref-type="bibr">60</xref>], four-dimensional (space and time) dynamic simulations [<xref rid="pone.0230259.ref061" ref-type="bibr">61</xref>], ventilation heterogeneity [<xref rid="pone.0230259.ref057" ref-type="bibr">57</xref>], airflow in the acinar region [<xref rid="pone.0230259.ref062" ref-type="bibr">62</xref>]. Validation studies conducted by Montesantos et al. [<xref rid="pone.0230259.ref063" ref-type="bibr">63</xref>] include morphometric studies on healthy and asthmatic patients providing among others, measurements of branching angles, length and diameter of airways as a function of generation. Such measurements are employed by our study for macroscopic validation of the generated trees.</p>
    </sec>
    <sec id="sec003">
      <title>1.2 Motivation and contributions</title>
      <p>The objective in this field of research is to enable the prediction of gas flow [<xref rid="pone.0230259.ref051" ref-type="bibr">51</xref>, <xref rid="pone.0230259.ref055" ref-type="bibr">55</xref>], gas mixing [<xref rid="pone.0230259.ref064" ref-type="bibr">64</xref>], heat transfer [<xref rid="pone.0230259.ref065" ref-type="bibr">65</xref>], particle deposition [<xref rid="pone.0230259.ref046" ref-type="bibr">46</xref>, <xref rid="pone.0230259.ref054" ref-type="bibr">54</xref>, <xref rid="pone.0230259.ref066" ref-type="bibr">66</xref>, <xref rid="pone.0230259.ref067" ref-type="bibr">67</xref>], and ventilation distribution [<xref rid="pone.0230259.ref068" ref-type="bibr">68</xref>] in the pulmonary system. Lung ventilation patterns prediction [<xref rid="pone.0230259.ref069" ref-type="bibr">69</xref>, <xref rid="pone.0230259.ref070" ref-type="bibr">70</xref>] can provide grounds for performance and fatigue estimation in high-frequency ventilation cases [<xref rid="pone.0230259.ref071" ref-type="bibr">71</xref>], disease severity quantification, such as in asthma and COPD, and give insight into drug delivery or even in transfer of harmful particulates. Motivated by the recent advances in this field and building upon previous work [<xref rid="pone.0230259.ref046" ref-type="bibr">46</xref>], we developed an end-to-end approach facilitating pulmonary structural modelling that is based on the definition of the personalised boundary conditions required for fluid dynamics simulations. Specifically, in this work we</p>
      <list list-type="bullet">
        <list-item>
          <p>present an open-source simulation framework that utilizes imaging data to provide patient-based representations of the structural models of the bronchial tree,</p>
        </list-item>
        <list-item>
          <p>build and extend 1-dimensional graph representations of the bronchial tree,</p>
        </list-item>
        <list-item>
          <p>generate 3D surface models of extended bronchial tree models appropriate for CFD simulations</p>
        </list-item>
        <list-item>
          <p>generate probabilistic visualization of airway generations projected on the personalized CT imaging data, 2</p>
        </list-item>
        <list-item>
          <p>perform validation studies and provide comparison with relevant state-of-the-art approaches</p>
        </list-item>
        <list-item>
          <p>provide an open-source toolbox in C++ and a graphical user interface integrating modelling functionalities.</p>
        </list-item>
      </list>
      <p>The rest of the paper is organized as follows. Section 2 analyzes the individual components of AVATREE, Section 3 commends on the results of our approach while Section 4 concludes this paper.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec004">
    <title>2 Materials and methods</title>
    <p>The processing pipeline uses as input CT images and is presented in <xref ref-type="fig" rid="pone.0230259.g001">Fig 1</xref>. Airway segmentation is applied to the imaging data to extract a 3D surface mesh and a 1-dimensional representation of the airways. We employ the extended 1D graph to derive visualization of probabilistic airway generation labels in the space of the subjects’ anatomy as defined by the CT images and to generate a 3D surface defining personalized boundary conditions, that can be employed as input for computational fluid dynamics simulations.</p>
    <fig id="pone.0230259.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Processing pipeline of AVATREE.</title>
      </caption>
      <graphic xlink:href="pone.0230259.g001"/>
    </fig>
    <sec id="sec005">
      <title>2.1 Segmentation and airways centerline extraction</title>
      <p>The input of the presented approach is unlabeled CT scans required to extract bronchial tree and airways structural features. For the definition of the lung volume, CT-based lung segmentation and annotation is required. For lung segmentation we employ the FAST heterogeneous medical image computing and visualization framework [<xref rid="pone.0230259.ref032" ref-type="bibr">32</xref>] is employed. The result of lung segmentation process is a binary mask visualized in <xref ref-type="fig" rid="pone.0230259.g001">Fig 1</xref>. As a next step, we perform further processing of the segmentation result to distinguish left and right lungs. The process is described below:</p>
      <list list-type="order">
        <list-item>
          <p>A second region growing takes place starting from a single random point inside any of the segmented region only if all its immediate neighbours bare the same label.</p>
        </list-item>
        <list-item>
          <p>To advance the region growing front, all points neighbouring a candidate voxel must not include background voxel. This region is given a new label.</p>
        </list-item>
        <list-item>
          <p>Steps 1 and 2 are repeated for the other lung volume. The result is an image with three labels(background and two lung volumes).</p>
        </list-item>
        <list-item>
          <p>To distinguish left or right we employ the directed graph extracted from the main airways and follow the generic rule according to which the topological distance the topological distance between the bifurcations of the first and the second generation is longer in the left lung.</p>
        </list-item>
      </list>
      <p>The next step involves the segmentation of the first generations of the airways that are identifiable in the patient’s CT image, but any available airway tree segmentation method can be also applied. For this purpose we investigated two algorithms. The first algorithm is the gradient vector flow [<xref rid="pone.0230259.ref029" ref-type="bibr">29</xref>, <xref rid="pone.0230259.ref031" ref-type="bibr">31</xref>] which achieved high accuracy with low false-positive rate (only 1.44%) in a comparative study [<xref rid="pone.0230259.ref017" ref-type="bibr">17</xref>] in the context of the EXACT09 airway segmentation challenge. The second is a standard and stable approach based on seeded region growing [<xref rid="pone.0230259.ref072" ref-type="bibr">72</xref>]. The former is included in the tube segmentation framework [<xref rid="pone.0230259.ref030" ref-type="bibr">30</xref>] and the latter in FAST heterogeneous medical image computing and visualization framework [<xref rid="pone.0230259.ref032" ref-type="bibr">32</xref>].</p>
      <p>Let’s denote with <italic>I</italic>(<bold>x</bold>), <inline-formula id="pone.0230259.e001"><alternatives><graphic xlink:href="pone.0230259.e001.jpg" id="pone.0230259.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mo>Ω</mml:mo><mml:mover><mml:mo>→</mml:mo><mml:mrow/></mml:mover><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, the gray level 3D medical image, where <bold>x</bold> = (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>), <bold>x</bold> ∈ Ω is a voxel in the spatial domain <inline-formula id="pone.0230259.e002"><alternatives><graphic xlink:href="pone.0230259.e002.jpg" id="pone.0230259.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mo>Ω</mml:mo><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> of the volumetric imaging data. The output of the segmentation algorithm for the airways is a binary image <italic>S</italic><sub><italic>A</italic></sub> of equal size with <italic>I</italic>. Likewise, the output of the segmentation algorithm for the lung volumes is a binary image <italic>S</italic><sub><italic>L</italic></sub> of equal size with <italic>I</italic>. The result is presented in Figs <xref ref-type="fig" rid="pone.0230259.g001">1</xref> and <xref ref-type="fig" rid="pone.0230259.g002">2</xref>, and utilized to generate prediction of full bronchial tree structures based on personalized lung volumes. To derive the centerline from <italic>S</italic><sub><italic>A</italic></sub> a multitude of methods is provided in the literature including skeletonization or thinning. <xref ref-type="fig" rid="pone.0230259.g002">Fig 2</xref> presents the up-to-four generations centerline of the airways.</p>
      <fig id="pone.0230259.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Extraction of airway surface and centerline.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g002"/>
      </fig>
      <p>This 1D representation of the bronchial tree is modelled by an undirected graph <inline-formula id="pone.0230259.e003"><alternatives><graphic xlink:href="pone.0230259.e003.jpg" id="pone.0230259.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pone.0230259.e004"><alternatives><graphic xlink:href="pone.0230259.e004.jpg" id="pone.0230259.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mi mathvariant="script">V</mml:mi></mml:math></alternatives></inline-formula> is the set of vertices and <inline-formula id="pone.0230259.e005"><alternatives><graphic xlink:href="pone.0230259.e005.jpg" id="pone.0230259.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi mathvariant="script">E</mml:mi></mml:math></alternatives></inline-formula> is the set of edges. Each vertex, indexed by <italic>i</italic>, can be represented as a point <bold>v</bold><sub><italic>i</italic></sub> = (<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>, <italic>z</italic><sub><italic>i</italic></sub>). We denote the function <italic>N</italic>(<bold>v</bold><sub><italic>i</italic></sub>) yielding the set of vertices indices neighbouring vertex <italic>i</italic>. The undirected graph is extracted by FAST framework [<xref rid="pone.0230259.ref032" ref-type="bibr">32</xref>] and converted into a directed graph with the following process. Initially, the graph starting point is defined as the one closest to the air inlet, i.e. the oral cavity or the trachea. Given index <italic>y</italic> the starting point for <inline-formula id="pone.0230259.e006"><alternatives><graphic xlink:href="pone.0230259.e006.jpg" id="pone.0230259.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> we generate the directed tree <inline-formula id="pone.0230259.e007"><alternatives><graphic xlink:href="pone.0230259.e007.jpg" id="pone.0230259.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. We define as distal point the vertex of the graph with no children and distal branch the edge containing a distal point.</p>
      <p><bold>Algorithm 1</bold> Detection of inlet in undirected graph</p>
      <p specific-use="line">
        <bold>Input: Graph</bold>
        <inline-formula id="pone.0230259.e008">
          <alternatives>
            <graphic xlink:href="pone.0230259.e008.jpg" id="pone.0230259.e008g" mimetype="image" position="anchor" orientation="portrait"/>
            <mml:math id="M8">
              <mml:mi mathvariant="script">G</mml:mi>
            </mml:math>
          </alternatives>
        </inline-formula>
      </p>
      <p specific-use="line">
        <bold>Output: Index of graph inlet</bold>
        <italic>y</italic>
      </p>
      <p specific-use="line">1 <bold>procedure</bold> D<sc>erivation of graph inlet</sc></p>
      <p specific-use="line">2  Initialize set <inline-formula id="pone.0230259.e009"><alternatives><graphic xlink:href="pone.0230259.e009.jpg" id="pone.0230259.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mo>|</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">3  <bold>for each</bold> vertex <bold>v</bold><sub><italic>i</italic></sub>
<bold>do</bold></p>
      <p specific-use="line">4   <bold>if</bold> |<italic>N</italic>(<bold>v</bold><sub><italic>i</italic></sub>)| &gt; 2 <bold>then</bold></p>
      <p specific-use="line">5    <bold>for each</bold>
<italic>n</italic> ∈ <italic>N</italic>(<bold>v</bold><sub><italic>i</italic></sub>) <bold>do</bold></p>
      <p specific-use="line">6     Initialize empty set <inline-formula id="pone.0230259.e010"><alternatives><graphic xlink:href="pone.0230259.e010.jpg" id="pone.0230259.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mi mathvariant="script">K</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">7     <bold>while</bold>
<italic>N</italic>(<bold>v</bold><sub><italic>n</italic></sub>)&lt;3 <bold>do</bold></p>
      <p specific-use="line">8      <bold>for each</bold>
<italic>m</italic> ∈ <italic>N</italic>(<bold>v</bold><sub><italic>n</italic></sub>) <bold>do</bold></p>
      <p specific-use="line">9       <bold>if</bold>
<inline-formula id="pone.0230259.e011"><alternatives><graphic xlink:href="pone.0230259.e011.jpg" id="pone.0230259.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∉</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
<bold>then</bold>
<inline-formula id="pone.0230259.e012"><alternatives><graphic xlink:href="pone.0230259.e012.jpg" id="pone.0230259.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mi mathvariant="script">K</mml:mi><mml:mover><mml:mo>←</mml:mo><mml:mrow/></mml:mover><mml:mi mathvariant="script">K</mml:mi><mml:mo>∪</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">10     <inline-formula id="pone.0230259.e013"><alternatives><graphic xlink:href="pone.0230259.e013.jpg" id="pone.0230259.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mover><mml:mo>←</mml:mo><mml:mrow/></mml:mover><mml:mi mathvariant="script">P</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">11  <inline-formula id="pone.0230259.e014"><alternatives><graphic xlink:href="pone.0230259.e014.jpg" id="pone.0230259.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msub><mml:mi mathvariant="script">K</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p specific-use="line">12  <inline-formula id="pone.0230259.e015"><alternatives><graphic xlink:href="pone.0230259.e015.jpg" id="pone.0230259.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mi>y</mml:mi><mml:mover><mml:mo>←</mml:mo><mml:mrow/></mml:mover><mml:msub><mml:mi mathvariant="script">K</mml:mi><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">K</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
    </sec>
    <sec id="sec006">
      <title>2.2 Generation of extended bronchial tree</title>
      <p>Since higher generations cannot be identified from the personal imaging data, we extend the bronchial tree based on population-wise empirical observations. Initially the directed graph generated by the procedure explained in subsection 2.1 is pruned. Specifically, the extracted 1-dimensional representation is processed to include all the bifurcations located at the end of a given generation so as to facilitate the volume filling algorithm. <xref ref-type="fig" rid="pone.0230259.g001">Fig 1</xref> shows the result of pruning where all generations after the <italic>n</italic><sup><italic>th</italic></sup> have been pruned. The corrected tree is subsequently used for the bronchial tree extension. The generation process utilizes the bronchial tree extension algorithm initially proposed by Tawhai et al. [<xref rid="pone.0230259.ref004" ref-type="bibr">4</xref>] and later improved by Bordas et al. [<xref rid="pone.0230259.ref007" ref-type="bibr">7</xref>] while introducing a few safeguards to allow maximal space utilization. The bronchial tree extension algorithm can be described by the following steps.</p>
      <p>For each lung subvolume <inline-formula id="pone.0230259.e016"><alternatives><graphic xlink:href="pone.0230259.e016.jpg" id="pone.0230259.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0230259.e017"><alternatives><graphic xlink:href="pone.0230259.e017.jpg" id="pone.0230259.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>:</p>
      <list list-type="order">
        <list-item>
          <p>Generate a point cloud sampling the subvolume with a uniform random process. <xref ref-type="fig" rid="pone.0230259.g003">Fig 3</xref> depicts the uniform sampling of each lung subvolume with a total number of <italic>n</italic> = 30000 points [<xref rid="pone.0230259.ref004" ref-type="bibr">4</xref>, <xref rid="pone.0230259.ref006" ref-type="bibr">6</xref>].</p>
        </list-item>
        <list-item>
          <p>Assign a seed point to the closest distal branch as presented in <xref ref-type="fig" rid="pone.0230259.g003">Fig 3</xref>.</p>
        </list-item>
        <list-item>
          <p>Calculate the center of mass of the sampled points as presented in <xref ref-type="fig" rid="pone.0230259.g003">Fig 3</xref>.
<disp-formula id="pone.0230259.e018"><alternatives><graphic xlink:href="pone.0230259.e018.jpg" id="pone.0230259.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
        </list-item>
        <list-item>
          <p>Employ principal component analysis (PCA) on the set of sampled points to define the splitting plane. The motivation for employing PCA is to address a space utilization aspect. The direction of the eigenvector with the greatest norm indicates the dimension of the data with the greatest variance denoting the direction where more space is available for the branches to grow. Picking a plane so that the resulting bounding box demonstrates the lowest possible variation, inhibits the appearance of very long branches. Given data points <bold>D</bold> = [<bold>p</bold><sub>1</sub>
<bold>p</bold><sub>1</sub>
<bold>p</bold><sub>1</sub>⋯<bold>p</bold><sub><italic>n</italic></sub>], <bold>A</bold> = <bold>DD</bold><sup><italic>T</italic></sup> is the auto-correlation matrix. Direct singular value decomposition yields <bold>A</bold> = <bold>UΣU</bold><sup><italic>T</italic></sup> where <bold>U</bold> = [<bold>u</bold><sub>1</sub>
<bold>u</bold><sub>2</sub>
<bold>u</bold><sub>3</sub>]. Then the largest eigenvector is defined as <bold>u</bold><sub><italic>m</italic></sub> = max<sub>1≤<italic>i</italic>≤3</sub>
<bold>u</bold><sub><italic>i</italic></sub>. Given the vector <bold>d</bold> expressing the direction of the distal airway, the splitting plane is described by center of mass <bold>c</bold> and vector <bold>d</bold> × [<bold>d</bold> × <bold>u</bold><sub><italic>m</italic></sub>]. The selected plane maximizes the available space for each new subdivision. <xref ref-type="fig" rid="pone.0230259.g004">Fig 4</xref> presents a splitting plane splitting the set of points into two subdivisions.</p>
        </list-item>
        <list-item>
          <p>Calculate the centroid of each new subdivision.</p>
        </list-item>
        <list-item>
          <p>For each centroid define line segment starting from seed point extending 40% of the distance towards centroid of the subdivision.</p>
        </list-item>
        <list-item>
          <p>If a newly created branch is smaller that 2<italic>mm</italic>, it is considered as terminal.</p>
        </list-item>
        <list-item>
          <p>The process is repeated until no seed points remain.</p>
        </list-item>
        <list-item>
          <p>Any branch found outside the lung volume is removed along with children branches.</p>
        </list-item>
      </list>
      <fig id="pone.0230259.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Definition of center of mass (orange dot) and distal branches (yellow dots).</title>
        </caption>
        <graphic xlink:href="pone.0230259.g003"/>
      </fig>
      <fig id="pone.0230259.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Definition of splitting plane for bifurcating distributive structures.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g004"/>
      </fig>
      <p>It is important to denote that the presented pipeline enables the generation of a tunable user-defined number of generations. If <italic>n</italic> is the number of desired generations, we set stopping criteria, in the extension of the bronchial tree until 2<sup>(<italic>n</italic>+1)</sup> bifurcations have been reached. The resulting 1D representation (<xref ref-type="fig" rid="pone.0230259.g005">Fig 5</xref>) predicts the location of the bifurcating distributive [<xref rid="pone.0230259.ref003" ref-type="bibr">3</xref>] structure given the patient-specific available space. The outcome of the volume filling algorithm will be used later to create maps that express the probability of a voxel to belong to a certain generation. This information when projected on CT slices can be a very informative and powerful clinical decision support tool.</p>
      <fig id="pone.0230259.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Extended bronchial tree (a) 9 generations, (b) 12 generations.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g005"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>2.3 Spatial probability maps of branching properties</title>
      <p>The location of each new generation branch is calculated as explained before and provides a random sample out of all possible bronchial tree conformations. In this step of the proposed framework we produce probabilistic maps for each generation branch that provide estimates of the spatial probability to encounter a certain generation at some point of the imaging data. Such a probabilistic model allows to optimize clinical decision making by accounting for the branches’ distributional uncertainty.</p>
      <p>Let’s denote with <italic>W</italic><sub><italic>g</italic></sub>(<bold>x</bold>), <inline-formula id="pone.0230259.e019"><alternatives><graphic xlink:href="pone.0230259.e019.jpg" id="pone.0230259.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mo>Ω</mml:mo><mml:mover><mml:mo>→</mml:mo><mml:mrow/></mml:mover><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, the probability map for generation <italic>g</italic> where <bold>x</bold> = (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>), <bold>x</bold> ∈ Ω is a voxel in the spatial domain <inline-formula id="pone.0230259.e020"><alternatives><graphic xlink:href="pone.0230259.e020.jpg" id="pone.0230259.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:mo>Ω</mml:mo><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> of the volumetric imaging data. Then
<disp-formula id="pone.0230259.e021"><alternatives><graphic xlink:href="pone.0230259.e021.jpg" id="pone.0230259.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>d</italic> is the distance of voxel <bold>x</bold> to the closest edge of <inline-formula id="pone.0230259.e022"><alternatives><graphic xlink:href="pone.0230259.e022.jpg" id="pone.0230259.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> labeled with generation <italic>g</italic>. Parameter <italic>σ</italic> is set experimentally to <italic>σ</italic> = 1. The extracted spatial map is overlaid on the CT scans, as shown in <xref ref-type="fig" rid="pone.0230259.g006">Fig 6</xref>, providing insightful visualization of spatial likelihood for each branching generation.</p>
      <fig id="pone.0230259.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Visualization of fourth generation probability map.</title>
          <p>First column corresponds to axial view. Second column corresponds to coronal view. Third column corresponds to sagital view. The first row depicts raw imaging data, the second row presents the probabilistic maps for second generation, the third row presents the probabilistic maps for second generation and the fourth row presents the probabilistic maps for second generation.</p>
        </caption>
        <graphic xlink:href="pone.0230259.g006"/>
      </fig>
    </sec>
    <sec id="sec008">
      <title>2.4 Surface generation on predicted 1-dimensional representation</title>
      <p>The extracted 3D geometries are required to conduct studies on computational fluid dynamics, particle transfer and deposition, ventilation, stress analysis and deformation simulations. Marching cubes algorithm [<xref rid="pone.0230259.ref073" ref-type="bibr">73</xref>] is a very well established method implemented in FAST [<xref rid="pone.0230259.ref032" ref-type="bibr">32</xref>] allowing the generation of 3D geometric models from airway segmentation label maps. The constriction simulation method aims to generate 3D tubular surface structures with smaller diameters. To this end, Laplacian surface contraction offers a solution that deforms the geometry pushing the vertices towards the direction of the inward normals.</p>
      <p>The extension of the extracted centerline generates a predictive representation of the bronchial tree given the available space. However, for the outcome of space-filling algorithms to be useful in fluid dynamics simulation, particle deposition simulation or stress finite element analysis based studies, the boundary conditions in the form of triangular 3D meshes need to be defined. Initially, as a simplified approach, to define the diameter of each generation we can employ the power law consistent with Murray’s law of symmetric branching [<xref rid="pone.0230259.ref033" ref-type="bibr">33</xref>, <xref rid="pone.0230259.ref034" ref-type="bibr">34</xref>].
<disp-formula id="pone.0230259.e023"><alternatives><graphic xlink:href="pone.0230259.e023.jpg" id="pone.0230259.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <italic>d</italic><sub>0</sub> denotes the branch diameter of the trachea and <italic>d</italic><sub><italic>z</italic></sub> the branch diameter for generation <italic>z</italic>.</p>
      <p>Furthermore, if we take into account that each branch demonstrates different branching angle and diameter properties, the relation between airway diameter (<italic>d</italic>) and branching angles (<italic>θ</italic>) is based on the following rules validated by Kamiya et al. [<xref rid="pone.0230259.ref037" ref-type="bibr">37</xref>] and Kitaoka et al. [<xref rid="pone.0230259.ref002" ref-type="bibr">2</xref>]:
<disp-formula id="pone.0230259.e024"><alternatives><graphic xlink:href="pone.0230259.e024.jpg" id="pone.0230259.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>d</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
<disp-formula id="pone.0230259.e025"><alternatives><graphic xlink:href="pone.0230259.e025.jpg" id="pone.0230259.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:msubsup><mml:mi>d</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo form="prefix">sin</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>d</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo form="prefix">sin</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo form="prefix">sin</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where the index 0 stands for the parent branch, and the indices 1 and 2 for the two children branches, respectively.</p>
      <p>To reconstruct the lung surface we employ a point cloud sampling approach as input for Poisson surface reconstruction. The outcome is a smooth surface with smooth transitions instead of abrupt transitions in the intersection with the original tubular meshes. The tubular-shaped point cloud is sampled using a uniform random distribution. A clean-up step, visualized in <xref ref-type="fig" rid="pone.0230259.g007">Fig 7</xref>, ensures that no point can be found in distance less than the prescribed diameter of every available branch. The resulting point cloud is used to compute normals. A bilateral normal smoothing [<xref rid="pone.0230259.ref074" ref-type="bibr">74</xref>] function prepares the point cloud for Poisson surface reconstruction [<xref rid="pone.0230259.ref075" ref-type="bibr">75</xref>]. smoothing the point normals. This step facilitates the surface reconstruction in bifurcations and transitional parts. Furthermore, since the directed graph is extracted where each point on the centerline corresponds to a point on the lung surface it is possible to further deform the surface with a custom function or pattern. The generated surface for seven and ten generations is presented in <xref ref-type="fig" rid="pone.0230259.g008">Fig 8</xref>.</p>
      <fig id="pone.0230259.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Outcome of point cloud generation process.</title>
          <p>Extra refinements remove the inner points facilitating normal estimation for Poisson surface reconstruction.</p>
        </caption>
        <graphic xlink:href="pone.0230259.g007"/>
      </fig>
      <fig id="pone.0230259.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Generation of surface from the extended bronchial tree centerline.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g008"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>2.5 Simulation of constrictive pulmonary diseases’ effect on airway tree</title>
      <p>This section aims to provide the methodology for simulation of broncho-constriction allowing to subsequently estimate the dynamic behaviour of the lung airways in the case of an exacerbation event. A bronchial tree 3D geometry is the input for this process yielding as output contracted airways. The proposed geometry contraction procedure is presented by Nousias et al. [<xref rid="pone.0230259.ref045" ref-type="bibr">45</xref>] and Lalas et al. [<xref rid="pone.0230259.ref046" ref-type="bibr">46</xref>] and is an extension of the work of Au et al. [<xref rid="pone.0230259.ref076" ref-type="bibr">76</xref>] facilitating a Laplacian smoothing process that shifts vertices along the estimated curvature normal direction. The airway geometric model consists of connected triangles forming the boundary conditions. Each triangular mesh <inline-formula id="pone.0230259.e026"><alternatives><graphic xlink:href="pone.0230259.e026.jpg" id="pone.0230259.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mi mathvariant="script">M</mml:mi></mml:math></alternatives></inline-formula> can be described as <inline-formula id="pone.0230259.e027"><alternatives><graphic xlink:href="pone.0230259.e027.jpg" id="pone.0230259.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pone.0230259.e028"><alternatives><graphic xlink:href="pone.0230259.e028.jpg" id="pone.0230259.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mi mathvariant="script">V</mml:mi></mml:math></alternatives></inline-formula> is the set of vertices, <inline-formula id="pone.0230259.e029"><alternatives><graphic xlink:href="pone.0230259.e029.jpg" id="pone.0230259.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mi mathvariant="script">E</mml:mi></mml:math></alternatives></inline-formula> is the set of edges and <inline-formula id="pone.0230259.e030"><alternatives><graphic xlink:href="pone.0230259.e030.jpg" id="pone.0230259.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mi mathvariant="script">F</mml:mi></mml:math></alternatives></inline-formula> is the set of faces constituting the 3D surface. Each vertex <italic>i</italic> can be represented as a point <bold>v</bold><sub><italic>i</italic></sub> = (<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>, <italic>z</italic><sub><italic>i</italic></sub>), ∀<italic>i</italic> = 1, 2, ⋯, <italic>N</italic>. For each face <bold>f</bold><sub><italic>i</italic></sub>, ∀<italic>i</italic> = 1, 2, ⋯, <italic>l</italic> we denote the centroid
<disp-formula id="pone.0230259.e031"><alternatives><graphic xlink:href="pone.0230259.e031.jpg" id="pone.0230259.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:msub></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
      <p>The outward unit normal <inline-formula id="pone.0230259.e032"><alternatives><graphic xlink:href="pone.0230259.e032.jpg" id="pone.0230259.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> to the face <bold>f</bold><sub><italic>i</italic></sub> (located at the centroid <bold>m</bold><sub><italic>i</italic></sub>) is calculated as <inline-formula id="pone.0230259.e033"><alternatives><graphic xlink:href="pone.0230259.e033.jpg" id="pone.0230259.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>:
<disp-formula id="pone.0230259.e034"><alternatives><graphic xlink:href="pone.0230259.e034.jpg" id="pone.0230259.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∥</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where <inline-formula id="pone.0230259.e035"><alternatives><graphic xlink:href="pone.0230259.e035.jpg" id="pone.0230259.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are the vertices corresponding to face <bold>f</bold><sub><italic>i</italic></sub>. Given <inline-formula id="pone.0230259.e036"><alternatives><graphic xlink:href="pone.0230259.e036.jpg" id="pone.0230259.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> the curvature flow Laplacian operator, the product <italic>δ</italic> = <bold>LV</bold> approximates the inward curvature flow normals [<xref rid="pone.0230259.ref077" ref-type="bibr">77</xref>]. The motivation for employing the curvature flow Laplacian operator [<xref rid="pone.0230259.ref078" ref-type="bibr">78</xref>] on the mesh is that its output is not affected by mesh density. Specifically,
<disp-formula id="pone.0230259.e037"><alternatives><graphic xlink:href="pone.0230259.e037.jpg" id="pone.0230259.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">V</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>A</italic><sub><italic>i</italic></sub> is the one-ring area, <italic>κ</italic><sub><italic>i</italic></sub> is the local curvature and <bold>n</bold><sub><italic>i</italic></sub> is the inward curvature flow normal of the <italic>i</italic><sup><italic>th</italic></sup> vertex.</p>
      <p>The positions of the vertices satisfying <bold>LV</bold> = 0 result in a zero volume string-like mesh and can be used to simulate mesh contraction. However, since such an optimization problem has more than one solutions, further constraints are required [<xref rid="pone.0230259.ref076" ref-type="bibr">76</xref>]. Introducing weighting matrices <inline-formula id="pone.0230259.e038"><alternatives><graphic xlink:href="pone.0230259.e038.jpg" id="pone.0230259.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
<inline-formula id="pone.0230259.e039"><alternatives><graphic xlink:href="pone.0230259.e039.jpg" id="pone.0230259.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> can smoothly move vertex positions <inline-formula id="pone.0230259.e040"><alternatives><graphic xlink:href="pone.0230259.e040.jpg" id="pone.0230259.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> towards the direction of the inward unit normal by iteratively solving the following minimization problem
<disp-formula id="pone.0230259.e041"><alternatives><graphic xlink:href="pone.0230259.e041.jpg" id="pone.0230259.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix">arg min</mml:mo><mml:mi mathvariant="bold">V</mml:mi></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">V</mml:mi><mml:mo>∥</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>∥</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
where <inline-formula id="pone.0230259.e042"><alternatives><graphic xlink:href="pone.0230259.e042.jpg" id="pone.0230259.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mrow><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> corresponds to the vertex positions before the contraction at each iteration.</p>
      <p>The weighting matrices <bold>W</bold><sub><italic>H</italic></sub> and <bold>W</bold><sub><italic>L</italic></sub> regulate the mesh contraction and mesh attraction, respectively. Initially, we set them to <inline-formula id="pone.0230259.e043"><alternatives><graphic xlink:href="pone.0230259.e043.jpg" id="pone.0230259.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>·</mml:mo><mml:msqrt><mml:mi>A</mml:mi></mml:msqrt><mml:mo>·</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <bold>W</bold><sub><italic>H</italic></sub> = <bold>I</bold>, where <inline-formula id="pone.0230259.e044"><alternatives><graphic xlink:href="pone.0230259.e044.jpg" id="pone.0230259.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:mrow><mml:mi mathvariant="bold">I</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the identity matrix, <italic>k</italic> a double constant experimentally tuned to 10<sup>−3</sup> and <italic>A</italic> the average face area of the model.</p>
      <p><xref ref-type="disp-formula" rid="pone.0230259.e041">Eq (9)</xref> can be expressed as
<disp-formula id="pone.0230259.e045"><alternatives><graphic xlink:href="pone.0230259.e045.jpg" id="pone.0230259.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mi mathvariant="bold">L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula></p>
      <p>The analytical solution can be formulated as
<disp-formula id="pone.0230259.e046"><alternatives><graphic xlink:href="pone.0230259.e046.jpg" id="pone.0230259.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mi>T</mml:mi><mml:mi mathvariant="bold">A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
where matrices <bold>A</bold> and <bold>b</bold> are given by
<disp-formula id="pone.0230259.e047"><alternatives><graphic xlink:href="pone.0230259.e047.jpg" id="pone.0230259.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mi mathvariant="bold">L</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn mathvariant="bold">0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula></p>
      <p>After each iteration <italic>t</italic> we update the contraction and inflation weights to be used in iteration <italic>t</italic> + 1 so that <inline-formula id="pone.0230259.e048"><alternatives><graphic xlink:href="pone.0230259.e048.jpg" id="pone.0230259.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0230259.e049"><alternatives><graphic xlink:href="pone.0230259.e049.jpg" id="pone.0230259.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:msqrt><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:msub><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mfrac></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0230259.e050"><alternatives><graphic xlink:href="pone.0230259.e050.jpg" id="pone.0230259.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:msub><mml:mi>A</mml:mi><mml:msub><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0230259.e051"><alternatives><graphic xlink:href="pone.0230259.e051.jpg" id="pone.0230259.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:msub><mml:mi>A</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> are the original and the current one-ring area respectively. The Laplacian matrix for iteration <italic>t</italic> + 1, <bold>L</bold><sup><italic>t</italic>+1</sup> is also recomputed. On these grounds, to simulate broncho-constriction we require to reduce the airway diameter to a predefined level of narrowing is reached. This level is defined by certain termination criteria [<xref rid="pone.0230259.ref045" ref-type="bibr">45</xref>, <xref rid="pone.0230259.ref046" ref-type="bibr">46</xref>]. Thus, a metric is required that measures the diameter of the bronchi under process. To estimate the degree of contraction of the airway’s geometry after each iteration, we employ a shape diameter function (SDF) based scheme [<xref rid="pone.0230259.ref079" ref-type="bibr">79</xref>] implemented in [<xref rid="pone.0230259.ref080" ref-type="bibr">80</xref>] that evaluates the local volume based on the estimated local diameter assigned to each face of the mesh, also known as raw SDF values. Measuring the volume before and after the Laplacian contraction iteration can set the termination criteria. <xref ref-type="fig" rid="pone.0230259.g009">Fig 9</xref> presents a simulation of constrictive pulmonary conditions.</p>
      <fig id="pone.0230259.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Simulation of constrictive pulmonary conditions.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results" id="sec010">
    <title>3 Results</title>
    <sec id="sec011">
      <title>3.1 Dataset description</title>
      <p>For the evaluation of the aforementioned approaches we employed the dataset provided by VESSEL12 (VESsel SEgmentation in the Lung) challenge [<xref rid="pone.0230259.ref081" ref-type="bibr">81</xref>] and EXACT09 [<xref rid="pone.0230259.ref017" ref-type="bibr">17</xref>]. The VESSEL dataset is comprised of 20 anonymized scans in Meta (MHD/raw) format. The latter consists of 75 completely anonymized chest CT scans contributed by eight different institutions, acquired with several different CT scanner brands and models, using a variety of scanning protocols and reconstruction parameters. The conditions of the scanned subjects varied widely, ranging from healthy volunteers to patients showing severe abnormalities in the airways or lung parenchyma. <xref ref-type="fig" rid="pone.0230259.g006">Fig 6a to 6c</xref> present imaging instances of CT slices across the axial, coronal and sagittal planes. The generation of the initial airway surface, lung volume and 1-dimensional representation are performed using the FAST framework [<xref rid="pone.0230259.ref032" ref-type="bibr">32</xref>].</p>
    </sec>
    <sec id="sec012">
      <title>3.2 Structural modelling and validation</title>
      <p>Our simulation framework processes the initial tree centerline and generates a structural estimation given the first three to four available generation and their morphometric characteristics i.e., lengths and diameters. To facilitate the comparison with morphometric data, we employed a publicly available dataset provided by Montesantos et al. [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] labelled as <italic>pone.0168026.s001</italic>. For the sake of self-completeness, the authors of [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] provided morphometric data extracted from HRCT images acquired at the University Hospital Southampton NHS Foundation Trust as a part of study described in [<xref rid="pone.0230259.ref082" ref-type="bibr">82</xref>, <xref rid="pone.0230259.ref083" ref-type="bibr">83</xref>]. Data from seven healthy subjects and six patients with moderate or persistent asthma were included in the dataset. Asthmatic patients patients were diagnosed exacerbation-free for at least one month and were male non-smokers.</p>
      <p>A Sensation 64 slice HRCT scanner (Siemens, Enlargen, Germany) was utilized to capture 3D images from mouth to the base of the lungs. Subjects were posed in supine position and were instructed to perform slow exhalation. Groundtruth data for the development of bronchial tree models in [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] were extracted by Pulmonary Workstation 2 Software including 3 to 4 generations in the upper lobes and 6 to 7 generations in the lower lobes. For each subject, a morphology file includes the total lung volume of the subject lung (in <italic>cm</italic><sup>3</sup>) and the percent volume per lobe while a translation file contains the airway connectivity, starting from the trachea to the terminal nodes. We used the generated trees from [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] to validate our approach and compare our results with relevant literature findings. Specifically, we compared the distributions of diameters, airway lengths and branching angles for each generation and the total number of airways for Horsfield and Strahler orders.</p>
      <p>In total 31204 acini were calculated being in agreement with the results reported by [<xref rid="pone.0230259.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>]. Figs <xref ref-type="fig" rid="pone.0230259.g010">10</xref> and <xref ref-type="fig" rid="pone.0230259.g011">11</xref> present a comparison in terms of the number of airways for each level of Strahler and Horsfield orders. This comparison confirms that our model comes into agreement with <italic>pone.0168026.s001</italic>. Furthermore, distributions of airway lengths, branching angles and diameters were plotted for each generation, for AVATREE and <italic>pone.0168026.s001</italic> [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>]. Airway lengths maintain the same exponential decay pattern for both models. Differences appear in generations 1 to 4 that are distinctively defined by body size and anatomical features. The distribution of branching angles of our model is also confirmed by <italic>pone.0168026.s001</italic> [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] maintaining a nearly linear decay with a very small rate. The distributions of diameters per generation are also observed to follow an exponential decay pattern. Both our model and <italic>pone.0168026.s001</italic> [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] decay similarly after generation 4 validating the morphometric characteristics of the airway trees generated by our approach. Figs <xref ref-type="fig" rid="pone.0230259.g012">12</xref> to <xref ref-type="fig" rid="pone.0230259.g014">14</xref> present the distribution of airway length, branching angle and diameter for each generation for AVATREE and for <italic>pone.0168026.s001</italic> [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>]. <xref rid="pone.0230259.t001" ref-type="table">Table 1</xref> presents and overview of quantitative macroscopic figures for AVATREE and relevant studies. Branching ratios (<italic>RB</italic><sub><italic>H</italic></sub>, <italic>RB</italic><sub><italic>S</italic></sub>), diameter ratios (<italic>RD</italic><sub><italic>H</italic></sub>, <italic>RD</italic><sub><italic>S</italic></sub>) and length ratios <italic>RL</italic><sub><italic>H</italic></sub>, <italic>RL</italic><sub><italic>S</italic></sub>) were calculated for Strahler and Horsfield ratios denoted as *<sub><italic>S</italic></sub> and *<sub><italic>H</italic></sub> respectively. Specifically, <italic>RB</italic><sub><italic>H</italic></sub>, <italic>RD</italic><sub><italic>H</italic></sub> and <italic>RL</italic><sub><italic>H</italic></sub> were calculated equal to <italic>RB</italic><sub><italic>H</italic></sub> = 1.74, <italic>RD</italic><sub><italic>H</italic></sub> = 1.259 and <italic>RL</italic><sub><italic>H</italic></sub> = 1.26±1.01. Montesantos et al. [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] reported <italic>RB</italic><sub><italic>H</italic></sub> = 1.56, <italic>RD</italic><sub><italic>H</italic></sub> = 1.115 and <italic>RL</italic><sub><italic>H</italic></sub> = 1.13 respectively. Additionally, <italic>RB</italic><sub><italic>S</italic></sub>, <italic>RD</italic><sub><italic>S</italic></sub> and <italic>RL</italic><sub><italic>S</italic></sub> were calculated equal to <italic>RB</italic><sub><italic>S</italic></sub> = 2.35, <italic>RD</italic><sub><italic>S</italic></sub> = 1.25 and <italic>RL</italic><sub><italic>S</italic></sub> = 1.23±1.02 and are close to the figures provides by relative studies [<xref rid="pone.0230259.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] as <xref rid="pone.0230259.t001" ref-type="table">Table 1</xref> reveals. Likewise, rate of decline for diameters per generation <italic>RD</italic> was calculated to <italic>RD</italic> = 0.83±0.21, being in agreement to [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>]. Average branching angle <italic>θ</italic> for our model was calculated to 32.44±28.95 comparable to [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>] reporting a <italic>θ</italic> equal to 42.1±21.4. Finally, Figs <xref ref-type="fig" rid="pone.0230259.g015">15</xref> and <xref ref-type="fig" rid="pone.0230259.g016">16</xref> present bronchial tree 1-dimensional representations extended up to 12 and 23 generations respectively. Additionally, for both generated models the surface has been reconstructed for the first 7 generations.</p>
      <table-wrap id="pone.0230259.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Structural features comparison.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0230259.t001g" xlink:href="pone.0230259.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="2" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">No of</th>
                <th align="center" rowspan="1" colspan="1">Diameter</th>
                <th align="center" rowspan="2" colspan="1">RB<sub><italic>H</italic></sub></th>
                <th align="center" rowspan="2" colspan="1">RD<sub><italic>H</italic></sub></th>
                <th align="center" rowspan="2" colspan="1">RL<sub><italic>H</italic></sub></th>
                <th align="center" rowspan="2" colspan="1">RB<sub><italic>S</italic></sub></th>
                <th align="center" rowspan="2" colspan="1">RD<sub><italic>S</italic></sub></th>
                <th align="center" rowspan="2" colspan="1">RL<sub><italic>S</italic></sub></th>
                <th align="center" rowspan="2" colspan="1">Mean <italic>θ</italic></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">acini</th>
                <th align="center" rowspan="1" colspan="1">Rate of decline</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>AVATREE</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">31204</td>
                <td align="center" rowspan="1" colspan="1">0.83±0.21</td>
                <td align="char" char="." rowspan="1" colspan="1">1.74</td>
                <td align="char" char="." rowspan="1" colspan="1">1.259</td>
                <td align="center" rowspan="1" colspan="1">1.26±1.01</td>
                <td align="center" rowspan="1" colspan="1">2.35</td>
                <td align="char" char="." rowspan="1" colspan="1">1.25</td>
                <td align="center" rowspan="1" colspan="1">1.23±1.02</td>
                <td align="center" rowspan="1" colspan="1">32.4488±28.95</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Tawhai et al</bold>. [<xref rid="pone.0230259.ref006" ref-type="bibr">6</xref>]</td>
                <td align="center" rowspan="1" colspan="1">29445</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="char" char="." rowspan="1" colspan="1">1.47</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">0.13</td>
                <td align="center" rowspan="1" colspan="1">2.8</td>
                <td align="char" char="." rowspan="1" colspan="1">1.41</td>
                <td align="center" rowspan="1" colspan="1">1.39</td>
                <td align="center" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Horsfield et al</bold>. [<xref rid="pone.0230259.ref001" ref-type="bibr">1</xref>]</td>
                <td align="center" rowspan="1" colspan="1">27992</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">2.54-2.81</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5</td>
                <td align="center" rowspan="1" colspan="1">1.55</td>
                <td align="center" rowspan="1" colspan="1">37.28</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Bordas et al</bold>. [<xref rid="pone.0230259.ref007" ref-type="bibr">7</xref>]</td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">42.90±0.10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Montesantos et al</bold>. [<xref rid="pone.0230259.ref044" ref-type="bibr">44</xref>]</td>
                <td align="center" rowspan="1" colspan="1">27763±7118.5</td>
                <td align="center" rowspan="1" colspan="1">0.789±0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">1.56</td>
                <td align="char" char="." rowspan="1" colspan="1">1.116</td>
                <td align="center" rowspan="1" colspan="1">1.13</td>
                <td align="center" rowspan="1" colspan="1">2.49</td>
                <td align="char" char="." rowspan="1" colspan="1">1.397</td>
                <td align="center" rowspan="1" colspan="1">1.392</td>
                <td align="center" rowspan="1" colspan="1">42.1±21.4</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <fig id="pone.0230259.g010" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>Number of airways for each Strahler order for our model, “AVATREE”, and “pone.0168026.s001”.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g010"/>
      </fig>
      <fig id="pone.0230259.g011" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g011</object-id>
        <label>Fig 11</label>
        <caption>
          <title>Number of airways for each Horsfield order for our model, “AVATREE”, and “pone.0168026.s001”.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g011"/>
      </fig>
      <fig id="pone.0230259.g012" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g012</object-id>
        <label>Fig 12</label>
        <caption>
          <title>Distribution of airway lengths for each generation for AVATREE and <italic>pone.0168026.s001</italic>.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g012"/>
      </fig>
      <fig id="pone.0230259.g013" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g013</object-id>
        <label>Fig 13</label>
        <caption>
          <title>Distribution of branching angles for each generation for AVATREE and <italic>pone.0168026.s001</italic>.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g013"/>
      </fig>
      <fig id="pone.0230259.g014" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g014</object-id>
        <label>Fig 14</label>
        <caption>
          <title>Distribution of diameters for each generation for AVATREE and <italic>pone.0168026.s001</italic>.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g014"/>
      </fig>
      <fig id="pone.0230259.g015" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g015</object-id>
        <label>Fig 15</label>
        <caption>
          <title>Estimation of bronchial tree for 12 generations.</title>
          <p>Surface reconstruction was performed for the first 7 generations.</p>
        </caption>
        <graphic xlink:href="pone.0230259.g015"/>
      </fig>
      <fig id="pone.0230259.g016" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g016</object-id>
        <label>Fig 16</label>
        <caption>
          <title>Estimation of bronchial tree for 23 generations.</title>
          <p>Surface reconstruction was performed for the first 7 generations.</p>
        </caption>
        <graphic xlink:href="pone.0230259.g016"/>
      </fig>
    </sec>
    <sec id="sec013">
      <title>3.3 Open-source library &amp; Graphical User Interface</title>
      <p>The presented components of AVATREE are provided as an open-source solution publicly available at (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/LungModelling/avatree">https://gitlab.com/LungModelling/avatree</ext-link>) accompanied by a graphical user interface (GUI). The implemented application programming interface (API) includes the following modules, a) input-output functionalities, b) 1-dimensional representation tools including centerline extraction, graph generation, derivation of graph node properties c) bronchial tree extension tools extending the 1-dimensional representation to the desired number of generations, d) 3D surface generation and processing tools and e) airway narrowing simulation tools.</p>
      <p>The GUI, presented in <xref ref-type="fig" rid="pone.0230259.g017">Fig 17</xref>, employs the set of functionalities defined by AVATREE and is comprised of four panels, namely data input and output panel, area selection panel, segmentation panel and broncho-constriction simulation panel. Through the GUI the user can load a 3D model, select the area to be processed, as <xref ref-type="fig" rid="pone.0230259.g018">Fig 18</xref> visualizes, and use the narrowing functionalities to reduce the airway diameter by the desired percentage. The amount of narrowing depends on the number of iterations and contraction weight multiplier. In <xref ref-type="fig" rid="pone.0230259.g018">Fig 18</xref> an airway of the first generation was constricted by 66%. The deformed surface introduced into computational fluid dynamics can provide insight into the breathing pattern and drug delivery in asthmatic lungs [<xref rid="pone.0230259.ref084" ref-type="bibr">84</xref>]. In the segmentation panel, the surface faces can be classified based on local properties. The one illustrates the shape diameter function (SDF) [<xref rid="pone.0230259.ref079" ref-type="bibr">79</xref>], while the other one the 3D surface according to the generation number. The results are visualized in <xref ref-type="fig" rid="pone.0230259.g019">Fig 19</xref>.</p>
      <fig id="pone.0230259.g017" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g017</object-id>
        <label>Fig 17</label>
        <caption>
          <title>User interface.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g017"/>
      </fig>
      <fig id="pone.0230259.g018" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g018</object-id>
        <label>Fig 18</label>
        <caption>
          <title>Broncho-constriction simulation.</title>
          <p>Airway of second generation narrowed at 34% of original diameter.</p>
        </caption>
        <graphic xlink:href="pone.0230259.g018"/>
      </fig>
      <fig id="pone.0230259.g019" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230259.g019</object-id>
        <label>Fig 19</label>
        <caption>
          <title>Surface annotation with a) SDF function visualizing local diameter b) airway generation.</title>
        </caption>
        <graphic xlink:href="pone.0230259.g019"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec014">
    <title>4 Conclusion</title>
    <p>In this paper, we presented AVATREE, an end-to-end approach modeling the subject-specific airway tree that defines the personalized boundary conditions required for the simulation of pulmonary function. This particular personalization aspect refers to the extraction of the main airways and the lung volumes from imaging allowing the simulation of a personalized extended bronchial tree. The utter goal in this category of studies is to eventually predict gas flow and particle distribution in healthy and constricted bronchial trees. Modelling lung ventilation patterns can provide grounds for performance and fatigue estimation in high-frequency ventilation cases and give insight into drug delivery or even transfer of harmful particulates. Specifically, this work presents an open-source simulation framework that utilizes imaging data to provide patient-specific representations of the structural models of the bronchial tree. The extended 1-dimensional centerline facilitates the generic estimation of pulmonary function through lumped 0-dimensional studies and allows the generation of probabilistic confidence maps of airway generation data. Such a visualization could be exploited by airway tree segmentation methodologies to improve the results further constraining the 3D space to be searched. Further elaborating on the benefits of the presented methodology, the generation of extended bronchial tree surface allows the assessment of airway functionality. Several studies available in the literature have employed computational fluid dynamics to predict flow and particle transfer patterns inside the conducting regions of the bronchial tree. Generating the 3D mesh constituting the surface defines the boundary conditions for this category of studies. Furthermore, surface deformation functionalities allow simulating broncho-constriction, which is the main feature in constrictive pulmonary diseases such as asthma and COPD. Existing approaches of medication adherence in asthma and COPD patients are usually based on the analysis of breathing signals acquired with acoustic sensors attached on inhaler devices [<xref rid="pone.0230259.ref085" ref-type="bibr">85</xref>] [<xref rid="pone.0230259.ref086" ref-type="bibr">86</xref>]. The concept of such studies is to facilitate self-management by guiding the patients to improve their inhaler usage technique [<xref rid="pone.0230259.ref087" ref-type="bibr">87</xref>]. AVATREE could contribute to this type of analysis by estimating the effectiveness of inhaled medication based on personalized imaging data and particle deposition simulations [<xref rid="pone.0230259.ref046" ref-type="bibr">46</xref>]. Both automated and UI guided solutions are provided by the presented open-source solution enabling users to simulate pathological conditions in asthmatic patients guided by imaging priors data from healthy subjects.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0230259.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Horsfield</surname><given-names>K</given-names></name>. <chapter-title>Morphometry of airways</chapter-title><source>Handbook of Physiology The Respiratory System III: American Physiological Society</source>. <year>1986</year>; p. <fpage>75</fpage>–<lpage>87</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Kitaoka</surname><given-names>H</given-names></name>, <name><surname>Takaki</surname><given-names>R</given-names></name>, <name><surname>Suki</surname><given-names>B</given-names></name>. <article-title>A three-dimensional model of the human airway tree</article-title>. <source>Journal of Applied Physiology</source>. <year>1999</year>;<volume>87</volume>(<issue>6</issue>):<fpage>2207</fpage>–<lpage>2217</lpage>. <pub-id pub-id-type="doi">10.1152/jappl.1999.87.6.2207</pub-id><?supplied-pmid 10601169?><pub-id pub-id-type="pmid">10601169</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Bassingthwaighte</surname><given-names>J</given-names></name>, <name><surname>Weissman</surname><given-names>L</given-names></name>. <article-title>Bifurcating distributive system using Monte Carlo method</article-title>. <source>Mathematical and computer modelling</source>. <year>1992</year>;<volume>16</volume>(<issue>3</issue>):<fpage>91</fpage>–<lpage>98</lpage>. <pub-id pub-id-type="doi">10.1016/0895-7177(92)90050-U</pub-id><?supplied-pmid 23015763?><pub-id pub-id-type="pmid">23015763</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Tawhai</surname><given-names>MH</given-names></name>, <name><surname>Pullan</surname><given-names>A</given-names></name>, <name><surname>Hunter</surname><given-names>P</given-names></name>. <article-title>Generation of an anatomically based three-dimensional model of the conducting airways</article-title>. <source>Annals of biomedical engineering</source>. <year>2000</year>;<volume>28</volume>(<issue>7</issue>):<fpage>793</fpage>–<lpage>802</lpage>. <pub-id pub-id-type="doi">10.1114/1.1289457</pub-id><pub-id pub-id-type="pmid">11016416</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Tawhai</surname><given-names>MH</given-names></name>, <name><surname>Burrowes</surname><given-names>KS</given-names></name>. <article-title>Developing integrative computational models of pulmonary structure</article-title>. <source>The Anatomical Record Part B: The New Anatomist: An Official Publication of the American Association of Anatomists</source>. <year>2003</year>;<volume>275</volume>(<issue>1</issue>):<fpage>207</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Tawhai</surname><given-names>MH</given-names></name>, <name><surname>Hunter</surname><given-names>P</given-names></name>, <name><surname>Tschirren</surname><given-names>J</given-names></name>, <name><surname>Reinhardt</surname><given-names>J</given-names></name>, <name><surname>McLennan</surname><given-names>G</given-names></name>, <name><surname>Hoffman</surname><given-names>EA</given-names></name>. <article-title>CT-based geometry analysis and finite element models of the human and ovine bronchial tree</article-title>. <source>Journal of applied physiology</source>. <year>2004</year>;<volume>97</volume>(<issue>6</issue>):<fpage>2310</fpage>–<lpage>2321</lpage>. <pub-id pub-id-type="doi">10.1152/japplphysiol.00520.2004</pub-id><?supplied-pmid 15322064?><pub-id pub-id-type="pmid">15322064</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Bordas</surname><given-names>R</given-names></name>, <name><surname>Lefevre</surname><given-names>C</given-names></name>, <name><surname>Veeckmans</surname><given-names>B</given-names></name>, <name><surname>Pitt-Francis</surname><given-names>J</given-names></name>, <name><surname>Fetita</surname><given-names>C</given-names></name>, <name><surname>Brightling</surname><given-names>CE</given-names></name>, <etal>et al</etal><article-title>Development and analysis of patient-based complete conducting airways models</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>12</issue>):<fpage>e0144105</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0144105</pub-id><?supplied-pmid 26656288?><pub-id pub-id-type="pmid">26656288</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ionescu</surname><given-names>C</given-names></name>, <name><surname>De Keyser</surname><given-names>R</given-names></name>. <article-title>Parametric models for characterizing respiratory input impedance</article-title>. <source>Journal of medical engineering &amp; technology</source>. <year>2008</year>;<volume>32</volume>(<issue>4</issue>):<fpage>315</fpage>–<lpage>324</lpage>. <pub-id pub-id-type="doi">10.1080/03091900701862240</pub-id><pub-id pub-id-type="pmid">18666011</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Ionescu</surname><given-names>CM</given-names></name>, <name><surname>Copot</surname><given-names>D</given-names></name>, <name><surname>De Keyser</surname><given-names>R</given-names></name>. <article-title>Respiratory impedance model with lumped fractional order diffusion compartment</article-title>. <source>IFAC Proceedings Volumes</source>. <year>2013</year>;<volume>46</volume>(<issue>1</issue>):<fpage>260</fpage>–<lpage>265</lpage>. <pub-id pub-id-type="doi">10.3182/20130204-3-FR-4032.00084</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Tawhai</surname><given-names>M</given-names></name>, <name><surname>Clark</surname><given-names>A</given-names></name>, <name><surname>Donovan</surname><given-names>G</given-names></name>, <name><surname>Burrowes</surname><given-names>K</given-names></name>. <article-title>Computational Modeling of Airway and Pulmonary Vascular Structure and Function: Development of a “Lung Physiome”</article-title>. <source>Critical Reviews™ in Biomedical Engineering</source>. <year>2011</year>;<volume>39</volume>(<issue>4</issue>).</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Haefeli-Bleuer</surname><given-names>B</given-names></name>, <name><surname>Weibel</surname><given-names>ER</given-names></name>. <article-title>Morphometry of the human pulmonary acinus</article-title>. <source>The Anatomical Record</source>. <year>1988</year>;<volume>220</volume>(<issue>4</issue>):<fpage>401</fpage>–<lpage>414</lpage>. <pub-id pub-id-type="doi">10.1002/ar.1092200410</pub-id><?supplied-pmid 3382030?><pub-id pub-id-type="pmid">3382030</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Phillips</surname><given-names>C</given-names></name>, <name><surname>Kaye</surname><given-names>S</given-names></name>, <name><surname>Schroter</surname><given-names>R</given-names></name>. <article-title>A diameter-based reconstruction of the branching pattern of the human bronchial tree Part II. Mathematical formulation</article-title>. <source>Respiration physiology</source>. <year>1994</year>;<volume>98</volume>(<issue>2</issue>):<fpage>219</fpage>–<lpage>226</lpage>. <pub-id pub-id-type="doi">10.1016/0034-5687(94)00043-3</pub-id><?supplied-pmid 7817051?><pub-id pub-id-type="pmid">7817051</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref013">
      <label>13</label>
      <mixed-citation publication-type="other">Pisupati C, Wolff L, Mitzner W, Zerhouni E. A central axis algorithm for 3D bronchial tree structures. In: Proceedings of International Symposium on Computer Vision-ISCV. IEEE; 1995. p. 259–264.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref014">
      <label>14</label>
      <mixed-citation publication-type="book"><name><surname>Weibel</surname><given-names>ER</given-names></name>, <name><surname>Cournand</surname><given-names>AF</given-names></name>, <name><surname>Richards</surname><given-names>DW</given-names></name>. <source>Morphometry of the human lung</source>. <volume>vol. 1</volume><publisher-name>Springer</publisher-name>; <year>1963</year>.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Yen</surname><given-names>R</given-names></name>, <name><surname>McLaurine</surname><given-names>M</given-names></name>, <name><surname>Bledsoe</surname><given-names>G</given-names></name>. <article-title>Morphometry of the human pulmonary vasculature</article-title>. <source>Journal of applied physiology</source>. <year>1996</year>;<volume>81</volume>(<issue>5</issue>):<fpage>2123</fpage>–<lpage>2133</lpage>. <pub-id pub-id-type="doi">10.1152/jappl.1996.81.5.2123</pub-id><?supplied-pmid 8941537?><pub-id pub-id-type="pmid">8941537</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Sluimer</surname><given-names>I</given-names></name>, <name><surname>Schilham</surname><given-names>A</given-names></name>, <name><surname>Prokop</surname><given-names>M</given-names></name>, <name><surname>Van Ginneken</surname><given-names>B</given-names></name>. <article-title>Computer analysis of computed tomography scans of the lung: a survey</article-title>. <source>IEEE transactions on medical imaging</source>. <year>2006</year>;<volume>25</volume>(<issue>4</issue>):<fpage>385</fpage>–<lpage>405</lpage>. <pub-id pub-id-type="doi">10.1109/TMI.2005.862753</pub-id><?supplied-pmid 16608056?><pub-id pub-id-type="pmid">16608056</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Lo</surname><given-names>P</given-names></name>, <name><surname>Van Ginneken</surname><given-names>B</given-names></name>, <name><surname>Reinhardt</surname><given-names>JM</given-names></name>, <name><surname>Yavarna</surname><given-names>T</given-names></name>, <name><surname>De Jong</surname><given-names>PA</given-names></name>, <name><surname>Irving</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Extraction of airways from CT (EXACT’09)</article-title>. <source>IEEE Transactions on Medical Imaging</source>. <year>2012</year>;<volume>31</volume>(<issue>11</issue>):<fpage>2093</fpage>–<lpage>2107</lpage>. <pub-id pub-id-type="doi">10.1109/TMI.2012.2209674</pub-id><?supplied-pmid 22855226?><pub-id pub-id-type="pmid">22855226</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref018">
      <label>18</label>
      <mixed-citation publication-type="other">Irving B, Taylor P, Todd-Pokropek A. 3D segmentation of the airway tree using a morphology based method. In: Proceedings of 2nd international workshop on pulmonary image analysis; 2009. p. 297–07.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref019">
      <label>19</label>
      <mixed-citation publication-type="other">Fetita C, Ortner M, Brillet PY, Prêteux F, Grenier P, et al. A morphological-aggregative approach for 3D segmentation of pulmonary airways from generic MSCT acquisitions. In: Proc. of Second International Workshop on Pulmonary Image Analysis; 2009. p. 215–226.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Lo</surname><given-names>P</given-names></name>, <name><surname>Sporring</surname><given-names>J</given-names></name>, <name><surname>Ashraf</surname><given-names>H</given-names></name>, <name><surname>Pedersen</surname><given-names>JJ</given-names></name>, <name><surname>de Bruijne</surname><given-names>M</given-names></name>. <article-title>Vessel-guided airway tree segmentation: A voxel classification approach</article-title>. <source>Medical image analysis</source>. <year>2010</year>;<volume>14</volume>(<issue>4</issue>):<fpage>527</fpage>–<lpage>538</lpage>. <pub-id pub-id-type="doi">10.1016/j.media.2010.03.004</pub-id><?supplied-pmid 20395163?><pub-id pub-id-type="pmid">20395163</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref021">
      <label>21</label>
      <mixed-citation publication-type="other">Pinho R, Luyckx S, Sijbers J. Robust region growing based intrathoracic airway tree segmentation. In: Proc. of Second International Workshop on Pulmonary Image Analysis; 2009. p. 261–271.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref022">
      <label>22</label>
      <mixed-citation publication-type="other">Feuerstein M, Kitasaka T, Mori K. Adaptive branch tracing and image sharpening for airway tree extraction in 3-D chest CT. In: Proc. of Second International Workshop on Pulmonary Image Analysis. vol. 1; 2009. p. 1–8.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Fabijanska A. Results of applying two-pass region growing algorithm for airway tree segmentation to MDCT chest scans from EXACT database. In: The Second International Workshop on Pulmonary Image Analysis, CreateSpace, USA; 2009. p. 251–260.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref024">
      <label>24</label>
      <mixed-citation publication-type="other">Mendoza CS, Acha B, Serrano C. Maximal contrast adaptive region growing for CT airway tree segmentation. In: Proc. of Second International Workshop on Pulmonary Image Analysis; 2009. p. 285–295.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Van Rikxoort EM, Baggerman W, van Ginneken B. Automatic segmentation of the airway tree from thoracic CT scans using a multi-threshold approach. In: Proc. of Second International Workshop on Pulmonary Image Analysis; 2009. p. 341–349.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Weinheimer</surname><given-names>O</given-names></name>, <name><surname>Achenbach</surname><given-names>T</given-names></name>, <name><surname>Düber</surname><given-names>C</given-names></name>. <article-title>Fully automated extraction of airways from CT scans based on self-adapting region growing</article-title>. <source>Computerized Tomography</source>. <year>2008</year>;<volume>27</volume>(<issue>1</issue>):<fpage>64</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Wiemker R, Bülow T, Lorenz C. A simple centricity-based region growing algorithm for the extraction of airways. In: Proc. Second International Workshop on Pulmonary Image Analysis (MICCAI). Citeseer; 2009. p. 309–314.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">Tschirren J, Yavarna T, Reinhardt J. Airway segmentation framework for clinical environments. In: Proceedings of 2nd international workshop on pulmonary image analysis; 2009. p. 227–38.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref029">
      <label>29</label>
      <mixed-citation publication-type="other">Bauer C, Pock T, Bischof H, Beichel R. Airway tree reconstruction based on tube detection. In: Proc. of Second International Workshop on Pulmonary Image Analysis; 2009. p. 203–213.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Smistad</surname><given-names>E</given-names></name>, <name><surname>Elster</surname><given-names>AC</given-names></name>, <name><surname>Lindseth</surname><given-names>F</given-names></name>. <article-title>GPU accelerated segmentation and centerline extraction of tubular structures from medical images</article-title>. <source>International journal of computer assisted radiology and surgery</source>. <year>2014</year>;<volume>9</volume>(<issue>4</issue>):<fpage>561</fpage>–<lpage>575</lpage>. <pub-id pub-id-type="doi">10.1007/s11548-013-0956-x</pub-id><?supplied-pmid 24177985?><pub-id pub-id-type="pmid">24177985</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref031">
      <label>31</label>
      <mixed-citation publication-type="other">Bauer C, Bischof H, Beichel R. Segmentation of airways based on gradient vector flow. In: International workshop on pulmonary image analysis, Medical image computing and computer assisted intervention. Citeseer; 2009. p. 191–201.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Smistad</surname><given-names>E</given-names></name>, <name><surname>Bozorgi</surname><given-names>M</given-names></name>, <name><surname>Lindseth</surname><given-names>F</given-names></name>. <article-title>FAST: framework for heterogeneous medical image computing and visualization</article-title>. <source>International Journal of computer assisted radiology and surgery</source>. <year>2015</year>;<volume>10</volume>(<issue>11</issue>):<fpage>1811</fpage>–<lpage>1822</lpage>. <pub-id pub-id-type="doi">10.1007/s11548-015-1158-5</pub-id><?supplied-pmid 25684594?><pub-id pub-id-type="pmid">25684594</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref033">
      <label>33</label>
      <mixed-citation publication-type="other">Hagmeijer R, Venner C. Critical review of Murray’s theory for optimal branching in fluidic networks. arXiv preprint arXiv:181209706. 2018;.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Pepe</surname><given-names>VR</given-names></name>, <name><surname>Rocha</surname><given-names>LA</given-names></name>, <name><surname>Miguel</surname><given-names>AF</given-names></name>. <article-title>Optimal branching structure of fluidic networks with permeable walls</article-title>. <source>BioMed research international</source>. <year>2017</year>;<volume>2017</volume><pub-id pub-id-type="doi">10.1155/2017/5284816</pub-id><?supplied-pmid 28607933?><pub-id pub-id-type="pmid">28607933</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref035">
      <label>35</label>
      <mixed-citation publication-type="book"><name><surname>Varner</surname><given-names>VD</given-names></name>, <name><surname>Nelson</surname><given-names>CM</given-names></name>. <chapter-title>Computational models of airway branching morphogenesis</chapter-title> In: <source>Seminars in cell &amp; developmental biology</source>. <volume>vol. 67</volume>
<publisher-name>Elsevier</publisher-name>; <year>2017</year> p. <fpage>170</fpage>–<lpage>176</lpage>.<pub-id pub-id-type="pmid">27269374</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Florens</surname><given-names>M</given-names></name>, <name><surname>Sapoval</surname><given-names>B</given-names></name>, <name><surname>Filoche</surname><given-names>M</given-names></name>. <article-title>An anatomical and functional model of the human tracheobronchial tree</article-title>. <source>Journal of Applied Physiology</source>. <year>2010</year>;<volume>110</volume>(<issue>3</issue>):<fpage>756</fpage>–<lpage>763</lpage>. <pub-id pub-id-type="doi">10.1152/japplphysiol.00984.2010</pub-id><?supplied-pmid 21183626?><pub-id pub-id-type="pmid">21183626</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Kamiya</surname><given-names>A</given-names></name>, <name><surname>Togawa</surname><given-names>T</given-names></name>, <name><surname>Yamamoto</surname><given-names>A</given-names></name>. <article-title>Theoretical relationship between the optimal models of the vascular tree</article-title>. <source>Bulletin of mathematical biology</source>. <year>1974</year>;<volume>36</volume>(<issue>3</issue>):<fpage>311</fpage>–<lpage>323</lpage>. <pub-id pub-id-type="doi">10.1007/bf02461331</pub-id><?supplied-pmid 4423763?><pub-id pub-id-type="pmid">4423763</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Tawhai</surname><given-names>MH</given-names></name>, <name><surname>Nash</surname><given-names>MP</given-names></name>, <name><surname>Hoffman</surname><given-names>EA</given-names></name>. <article-title>An imaging-based computational approach to model ventilation distribution and soft-tissue deformation in the ovine lung1</article-title>. <source>Academic radiology</source>. <year>2006</year>;<volume>13</volume>(<issue>1</issue>):<fpage>113</fpage>–<lpage>120</lpage>. <pub-id pub-id-type="doi">10.1016/j.acra.2005.09.088</pub-id><?supplied-pmid 16399039?><pub-id pub-id-type="pmid">16399039</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Fernandez</surname><given-names>J</given-names></name>, <name><surname>Mithraratne</surname><given-names>P</given-names></name>, <name><surname>Thrupp</surname><given-names>S</given-names></name>, <name><surname>Tawhai</surname><given-names>M</given-names></name>, <name><surname>Hunter</surname><given-names>P</given-names></name>. <article-title>Anatomically based geometric modelling of the musculo-skeletal system and other organs</article-title>. <source>Biomechanics and modeling in mechanobiology</source>. <year>2004</year>;<volume>2</volume>(<issue>3</issue>):<fpage>139</fpage>–<lpage>155</lpage>. <pub-id pub-id-type="doi">10.1007/s10237-003-0036-1</pub-id><?supplied-pmid 14685821?><pub-id pub-id-type="pmid">14685821</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Hegedűs</surname><given-names>CJ</given-names></name>, <name><surname>Balásházy</surname><given-names>I</given-names></name>, <name><surname>Farkas</surname><given-names>Á</given-names></name>. <article-title>Detailed mathematical description of the geometry of airway bifurcations</article-title>. <source>Respiratory physiology &amp; neurobiology</source>. <year>2004</year>;<volume>141</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>114</lpage>. <pub-id pub-id-type="doi">10.1016/j.resp.2004.03.004</pub-id><pub-id pub-id-type="pmid">15234679</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Heistracher</surname><given-names>T</given-names></name>, <name><surname>Hofmann</surname><given-names>W</given-names></name>. <article-title>Physiologically realistic models of bronchial airway bifurcations</article-title>. <source>Journal of Aerosol Science</source>. <year>1995</year>;<volume>26</volume>(<issue>3</issue>):<fpage>497</fpage>–<lpage>509</lpage>. <pub-id pub-id-type="doi">10.1016/0021-8502(94)00113-D</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>CL</given-names></name>, <name><surname>Tawhai</surname><given-names>M</given-names></name>, <name><surname>McLennan</surname><given-names>G</given-names></name>, <name><surname>Hoffman</surname><given-names>E</given-names></name>. <article-title>Multiscale simulation of gas flow in subject-specific models of the human lung</article-title>. <source>IEEE Eng Med Biol Mag</source>. <year>2009</year>;<volume>28</volume>(<issue>3</issue>):<fpage>25</fpage>–<lpage>33</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Mirams</surname><given-names>GR</given-names></name>, <name><surname>Arthurs</surname><given-names>CJ</given-names></name>, <name><surname>Bernabeu</surname><given-names>MO</given-names></name>, <name><surname>Bordas</surname><given-names>R</given-names></name>, <name><surname>Cooper</surname><given-names>J</given-names></name>, <name><surname>Corrias</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Chaste: an open source C++ library for computational physiology and biology</article-title>. <source>PLoS computational biology</source>. <year>2013</year>;<volume>9</volume>(<issue>3</issue>):<fpage>e1002970</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002970</pub-id><?supplied-pmid 23516352?><pub-id pub-id-type="pmid">23516352</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Montesantos</surname><given-names>S</given-names></name>, <name><surname>Katz</surname><given-names>I</given-names></name>, <name><surname>Pichelin</surname><given-names>M</given-names></name>, <name><surname>Caillibotte</surname><given-names>G</given-names></name>. <article-title>The creation and statistical evaluation of a deterministic model of the human bronchial tree from HRCT images</article-title>. <source>PLOS one</source>. <year>2016</year>;<volume>11</volume>(<issue>12</issue>):<fpage>e0168026</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0168026</pub-id><?supplied-pmid 27977730?><pub-id pub-id-type="pmid">27977730</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref045">
      <label>45</label>
      <mixed-citation publication-type="other">Nousias S, Lalos AS, Moustakas K. Computational modeling for simulating obstructive lung diseases based on geometry processing methods. In: International Conference on Digital Human Modeling and Applications in Health, Safety, Ergonomics and Risk Management. Springer; 2016. p. 100–109.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Lalas</surname><given-names>A</given-names></name>, <name><surname>Nousias</surname><given-names>S</given-names></name>, <name><surname>Kikidis</surname><given-names>D</given-names></name>, <name><surname>Lalos</surname><given-names>A</given-names></name>, <name><surname>Arvanitis</surname><given-names>G</given-names></name>, <name><surname>Sougles</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Substance deposition assessment in obstructed pulmonary system through numerical characterization of airflow and inhaled particles attributes</article-title>. <source>BMC medical informatics and decision making</source>. <year>2017</year>;<volume>17</volume>(<issue>3</issue>):<fpage>173</fpage><pub-id pub-id-type="doi">10.1186/s12911-017-0561-y</pub-id><?supplied-pmid 29297393?><pub-id pub-id-type="pmid">29297393</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Vial</surname><given-names>L</given-names></name>, <name><surname>Perchet</surname><given-names>D</given-names></name>, <name><surname>Fodil</surname><given-names>R</given-names></name>, <name><surname>Caillibotte</surname><given-names>G</given-names></name>, <name><surname>Fetita</surname><given-names>C</given-names></name>, <name><surname>Preteux</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>Airflow modeling of steady inspiration in two realistic proximal airway trees reconstructed from human thoracic tomodensitometric images</article-title>. <source>Computer Methods in Biomechanics and Biomedical Engineering</source>. <year>2005</year>;<volume>8</volume>(<issue>4</issue>):<fpage>267</fpage>–<lpage>277</lpage>. <?supplied-pmid 16298849?><pub-id pub-id-type="pmid">16298849</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>De Backer</surname><given-names>J</given-names></name>, <name><surname>Vos</surname><given-names>W</given-names></name>, <name><surname>Gorlé</surname><given-names>C</given-names></name>, <name><surname>Germonpré</surname><given-names>P</given-names></name>, <name><surname>Partoens</surname><given-names>B</given-names></name>, <name><surname>Wuyts</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>Flow analyses in the lower airways: patient-specific model and boundary conditions</article-title>. <source>Medical engineering &amp; physics</source>. <year>2008</year>;<volume>30</volume>(<issue>7</issue>):<fpage>872</fpage>–<lpage>879</lpage>.<pub-id pub-id-type="pmid">18096425</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>H</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>. <article-title>Modeling the bifurcating flow in a CT-scanned human lung airway</article-title>. <source>Journal of Biomechanics</source>. <year>2008</year>;<volume>41</volume>(<issue>12</issue>):<fpage>2681</fpage>–<lpage>2688</lpage>. <pub-id pub-id-type="doi">10.1016/j.jbiomech.2008.06.018</pub-id><?supplied-pmid 18667205?><pub-id pub-id-type="pmid">18667205</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Yin</surname><given-names>Y</given-names></name>, <name><surname>Choi</surname><given-names>J</given-names></name>, <name><surname>Hoffman</surname><given-names>EA</given-names></name>, <name><surname>Tawhai</surname><given-names>MH</given-names></name>, <name><surname>Lin</surname><given-names>CL</given-names></name>. <article-title>Simulation of pulmonary air flow with a subject-specific boundary condition</article-title>. <source>Journal of biomechanics</source>. <year>2010</year>;<volume>43</volume>(<issue>11</issue>):<fpage>2159</fpage>–<lpage>2163</lpage>. <pub-id pub-id-type="doi">10.1016/j.jbiomech.2010.03.048</pub-id><?supplied-pmid 20483412?><pub-id pub-id-type="pmid">20483412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Srivastav</surname><given-names>VK</given-names></name>, <name><surname>Paul</surname><given-names>AR</given-names></name>, <name><surname>Jain</surname><given-names>A</given-names></name>. <article-title>Computational Fluid Dynamics Study of Airflow and Particle Transport in Third to Sixth Generation Human Respiratory Tract</article-title>. <source>International Journal of Emerging Multidisciplinary Fluid Sciences</source>. <year>2011</year>;<volume>3</volume>(<issue>4</issue>). <pub-id pub-id-type="doi">10.1260/1756-8315.3.4.227</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Swan</surname><given-names>AJ</given-names></name>, <name><surname>Clark</surname><given-names>AR</given-names></name>, <name><surname>Tawhai</surname><given-names>MH</given-names></name>. <article-title>A computational model of the topographic distribution of ventilation in healthy human lungs</article-title>. <source>Journal of theoretical biology</source>. <year>2012</year>;<volume>300</volume>:<fpage>222</fpage>–<lpage>231</lpage>. <pub-id pub-id-type="doi">10.1016/j.jtbi.2012.01.042</pub-id><?supplied-pmid 22326472?><pub-id pub-id-type="pmid">22326472</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Tian</surname><given-names>G</given-names></name>, <name><surname>Hindle</surname><given-names>M</given-names></name>, <name><surname>Lee</surname><given-names>S</given-names></name>, <name><surname>Longest</surname><given-names>PW</given-names></name>. <article-title>Validating CFD predictions of pharmaceutical aerosol deposition with in vivo data</article-title>. <source>Pharmaceutical research</source>. <year>2015</year>;<volume>32</volume>(<issue>10</issue>):<fpage>3170</fpage>–<lpage>3187</lpage>. <pub-id pub-id-type="doi">10.1007/s11095-015-1695-1</pub-id><?supplied-pmid 25944585?><pub-id pub-id-type="pmid">25944585</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Miyawaki</surname><given-names>S</given-names></name>, <name><surname>Hoffman</surname><given-names>EA</given-names></name>, <name><surname>Lin</surname><given-names>CL</given-names></name>. <article-title>Effect of static vs. dynamic imaging on particle transport in CT-based numerical models of human central airways</article-title>. <source>Journal of aerosol science</source>. <year>2016</year>;<volume>100</volume>:<fpage>129</fpage>–<lpage>139</lpage>. <pub-id pub-id-type="doi">10.1016/j.jaerosci.2016.07.006</pub-id><?supplied-pmid 28090122?><pub-id pub-id-type="pmid">28090122</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Soni</surname><given-names>B</given-names></name>, <name><surname>Aliabadi</surname><given-names>S</given-names></name>. <article-title>Large-scale CFD simulations of airflow and particle deposition in lung airway</article-title>. <source>Computers &amp; Fluids</source>. <year>2013</year>;<volume>88</volume>:<fpage>804</fpage>–<lpage>812</lpage>. <pub-id pub-id-type="doi">10.1016/j.compfluid.2013.06.015</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Stylianou</surname><given-names>FS</given-names></name>, <name><surname>Sznitman</surname><given-names>J</given-names></name>, <name><surname>Kassinos</surname><given-names>SC</given-names></name>. <article-title>Direct numerical simulation of particle laden flow in a human airway bifurcation model</article-title>. <source>International Journal of Heat and Fluid Flow</source>. <year>2016</year>;<volume>61</volume>:<fpage>677</fpage>–<lpage>710</lpage>. <pub-id pub-id-type="doi">10.1016/j.ijheatfluidflow.2016.07.013</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Verbanck</surname><given-names>S</given-names></name>, <name><surname>Schuermans</surname><given-names>D</given-names></name>, <name><surname>Vincken</surname><given-names>W</given-names></name>. <article-title>Small airways ventilation heterogeneity and hyperinflation in COPD: response to tiotropium bromide</article-title>. <source>International journal of chronic obstructive pulmonary disease</source>. <year>2007</year>;<volume>2</volume>(<issue>4</issue>):<fpage>625</fpage><?supplied-pmid 18268937?><pub-id pub-id-type="pmid">18268937</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Sul</surname><given-names>B</given-names></name>, <name><surname>Wallqvist</surname><given-names>A</given-names></name>, <name><surname>Morris</surname><given-names>MJ</given-names></name>, <name><surname>Reifman</surname><given-names>J</given-names></name>, <name><surname>Rakesh</surname><given-names>V</given-names></name>. <article-title>A computational study of the respiratory airflow characteristics in normal and obstructed human airways</article-title>. <source>Computers in biology and medicine</source>. <year>2014</year>;<volume>52</volume>:<fpage>130</fpage>–<lpage>143</lpage>. <pub-id pub-id-type="doi">10.1016/j.compbiomed.2014.06.008</pub-id><?supplied-pmid 25058489?><pub-id pub-id-type="pmid">25058489</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>M</given-names></name>, <name><surname>Bordas</surname><given-names>R</given-names></name>, <name><surname>Vos</surname><given-names>W</given-names></name>, <name><surname>Hartley</surname><given-names>RA</given-names></name>, <name><surname>Brightling</surname><given-names>CE</given-names></name>, <name><surname>Kay</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Dynamic flow characteristics in normal and asthmatic lungs</article-title>. <source>International journal for numerical methods in biomedical engineering</source>. <year>2015</year>;<volume>31</volume>(<issue>12</issue>). <pub-id pub-id-type="doi">10.1002/cnm.2730</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>CL</given-names></name>, <name><surname>Tawhai</surname><given-names>MH</given-names></name>, <name><surname>McLennan</surname><given-names>G</given-names></name>, <name><surname>Hoffman</surname><given-names>EA</given-names></name>. <article-title>Characteristics of the turbulent laryngeal jet and its effect on airflow in the human intra-thoracic airways</article-title>. <source>Respiratory physiology &amp; neurobiology</source>. <year>2007</year>;<volume>157</volume>(<issue>2-3</issue>):<fpage>295</fpage>–<lpage>309</lpage>. <pub-id pub-id-type="doi">10.1016/j.resp.2007.02.006</pub-id><pub-id pub-id-type="pmid">17360247</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Miyawaki</surname><given-names>S</given-names></name>, <name><surname>Choi</surname><given-names>S</given-names></name>, <name><surname>Hoffman</surname><given-names>EA</given-names></name>, <name><surname>Lin</surname><given-names>CL</given-names></name>. <article-title>A 4DCT imaging-based breathing lung model with relative hysteresis</article-title>. <source>Journal of computational physics</source>. <year>2016</year>;<volume>326</volume>:<fpage>76</fpage>–<lpage>90</lpage>. <pub-id pub-id-type="doi">10.1016/j.jcp.2016.08.039</pub-id><?supplied-pmid 28260811?><pub-id pub-id-type="pmid">28260811</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Kumar</surname><given-names>H</given-names></name>, <name><surname>Tawhai</surname><given-names>MH</given-names></name>, <name><surname>Hoffman</surname><given-names>EA</given-names></name>, <name><surname>Lin</surname><given-names>CL</given-names></name>. <article-title>The effects of geometry on airflow in the acinar region of the human lung</article-title>. <source>Journal of biomechanics</source>. <year>2009</year>;<volume>42</volume>(<issue>11</issue>):<fpage>1635</fpage>–<lpage>1642</lpage>. <pub-id pub-id-type="doi">10.1016/j.jbiomech.2009.04.046</pub-id><?supplied-pmid 19482288?><pub-id pub-id-type="pmid">19482288</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Montesantos</surname><given-names>S</given-names></name>, <name><surname>Katz</surname><given-names>I</given-names></name>, <name><surname>Fleming</surname><given-names>J</given-names></name>, <name><surname>Majoral</surname><given-names>C</given-names></name>, <name><surname>Pichelin</surname><given-names>M</given-names></name>, <name><surname>Dubau</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Airway morphology from high resolution computed tomography in healthy subjects and patients with moderate persistent asthma</article-title>. <source>The anatomical record</source>. <year>2013</year>;<volume>296</volume>(<issue>6</issue>):<fpage>852</fpage>–<lpage>866</lpage>. <pub-id pub-id-type="doi">10.1002/ar.22695</pub-id><?supplied-pmid 23564729?><pub-id pub-id-type="pmid">23564729</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Hasler</surname><given-names>D</given-names></name>, <name><surname>Anagnostopoulou</surname><given-names>P</given-names></name>, <name><surname>Nyilas</surname><given-names>S</given-names></name>, <name><surname>Latzin</surname><given-names>P</given-names></name>, <name><surname>Schittny</surname><given-names>J</given-names></name>, <name><surname>Obrist</surname><given-names>D</given-names></name>. <article-title>A multi-scale model of gas transport in the lung to study heterogeneous lung ventilation during the multiple-breath washout test</article-title>. <source>PLoS computational biology</source>. <year>2019</year>;<volume>15</volume>(<issue>6</issue>):<fpage>e1007079</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007079</pub-id><?supplied-pmid 31206515?><pub-id pub-id-type="pmid">31206515</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Karamaoun</surname><given-names>C</given-names></name>, <name><surname>Sobac</surname><given-names>B</given-names></name>, <name><surname>Mauroy</surname><given-names>B</given-names></name>, <name><surname>Van Muylem</surname><given-names>A</given-names></name>, <name><surname>Haut</surname><given-names>B</given-names></name>. <article-title>New insights into the mechanisms controlling the bronchial mucus balance</article-title>. <source>PloS one</source>. <year>2018</year>;<volume>13</volume>(<issue>6</issue>):<fpage>e0199319</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0199319</pub-id><?supplied-pmid 29933368?><pub-id pub-id-type="pmid">29933368</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Kolanjiyil</surname><given-names>AV</given-names></name>, <name><surname>Kleinstreuer</surname><given-names>C</given-names></name>. <article-title>Computationally efficient analysis of particle transport and deposition in a human whole-lung-airway model. Part I: Theory and model validation</article-title>. <source>Computers in biology and medicine</source>. <year>2016</year>;<volume>79</volume>:<fpage>193</fpage>–<lpage>204</lpage>. <pub-id pub-id-type="doi">10.1016/j.compbiomed.2016.10.020</pub-id><?supplied-pmid 27810625?><pub-id pub-id-type="pmid">27810625</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Kolanjiyil</surname><given-names>AV</given-names></name>, <name><surname>Kleinstreuer</surname><given-names>C</given-names></name>, <name><surname>Sadikot</surname><given-names>RT</given-names></name>. <article-title>Computationally efficient analysis of particle transport and deposition in a human whole-lung-airway model. Part II: Dry powder inhaler application</article-title>. <source>Computers in biology and medicine</source>. <year>2017</year>;<volume>84</volume>:<fpage>247</fpage>–<lpage>253</lpage>. <pub-id pub-id-type="doi">10.1016/j.compbiomed.2016.10.025</pub-id><?supplied-pmid 27836120?><pub-id pub-id-type="pmid">27836120</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Whitfield</surname><given-names>CA</given-names></name>, <name><surname>Horsley</surname><given-names>A</given-names></name>, <name><surname>Jensen</surname><given-names>OE</given-names></name>. <article-title>Modelling structural determinants of ventilation heterogeneity: A perturbative approach</article-title>. <source>PloS one</source>. <year>2018</year>;<volume>13</volume>(<issue>11</issue>):<fpage>e0208049</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0208049</pub-id><?supplied-pmid 30496317?><pub-id pub-id-type="pmid">30496317</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Pozin</surname><given-names>N</given-names></name>, <name><surname>Montesantos</surname><given-names>S</given-names></name>, <name><surname>Katz</surname><given-names>I</given-names></name>, <name><surname>Pichelin</surname><given-names>M</given-names></name>, <name><surname>Vignon-Clementel</surname><given-names>I</given-names></name>, <name><surname>Grandmont</surname><given-names>C</given-names></name>. <article-title>A tree-parenchyma coupled model for lung ventilation simulation</article-title>. <source>International journal for numerical methods in biomedical engineering</source>. <year>2017</year>;<volume>33</volume>(<issue>11</issue>):<fpage>e2873</fpage><pub-id pub-id-type="doi">10.1002/cnm.2873</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Pozin</surname><given-names>N</given-names></name>, <name><surname>Montesantos</surname><given-names>S</given-names></name>, <name><surname>Katz</surname><given-names>I</given-names></name>, <name><surname>Pichelin</surname><given-names>M</given-names></name>, <name><surname>Vignon-Clementel</surname><given-names>I</given-names></name>, <name><surname>Grandmont</surname><given-names>C</given-names></name>. <article-title>Predicted airway obstruction distribution based on dynamical lung ventilation data: A coupled modeling-machine learning methodology</article-title>. <source>International journal for numerical methods in biomedical engineering</source>. <year>2018</year>;<volume>34</volume>(<issue>9</issue>):<fpage>e3108</fpage><pub-id pub-id-type="doi">10.1002/cnm.3108</pub-id><?supplied-pmid 29799665?><pub-id pub-id-type="pmid">29799665</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref071">
      <label>71</label>
      <mixed-citation publication-type="journal"><name><surname>Meyers</surname><given-names>M</given-names></name>, <name><surname>Rodrigues</surname><given-names>N</given-names></name>, <name><surname>Ari</surname><given-names>A</given-names></name>. <article-title>High-frequency oscillatory ventilation: A narrative review</article-title>. <source>Canadian journal of respiratory therapy: CJRT = Revue canadienne de la therapie respiratoire: RCTR</source>. <year>2019</year>;<volume>55</volume>:<fpage>40</fpage><pub-id pub-id-type="doi">10.29390/cjrt-2019-004</pub-id><?supplied-pmid 31297448?><pub-id pub-id-type="pmid">31297448</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref072">
      <label>72</label>
      <mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>R</given-names></name>, <name><surname>Bischof</surname><given-names>L</given-names></name>. <article-title>Seeded region growing</article-title>. <source>IEEE Transactions on pattern analysis and machine intelligence</source>. <year>1994</year>;<volume>16</volume>(<issue>6</issue>):<fpage>641</fpage>–<lpage>647</lpage>. <pub-id pub-id-type="doi">10.1109/34.295913</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref073">
      <label>73</label>
      <mixed-citation publication-type="other">Lorensen WE, Cline HE. Marching cubes: A high resolution 3D surface construction algorithm. In: ACM siggraph computer graphics. vol. 21. ACM; 1987. p. 163–169.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref074">
      <label>74</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>Y</given-names></name>, <name><surname>Fu</surname><given-names>H</given-names></name>, <name><surname>Au</surname><given-names>OKC</given-names></name>, <name><surname>Tai</surname><given-names>CL</given-names></name>. <article-title>Bilateral normal filtering for mesh denoising</article-title>. <source>IEEE Transactions on Visualization and Computer Graphics</source>. <year>2010</year>;<volume>17</volume>(<issue>10</issue>):<fpage>1521</fpage>–<lpage>1530</lpage>. <pub-id pub-id-type="doi">10.1109/TVCG.2010.264</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref075">
      <label>75</label>
      <mixed-citation publication-type="other">Kazhdan M, Bolitho M, Hoppe H. Poisson surface reconstruction. In: Proceedings of the fourth Eurographics symposium on Geometry processing. vol. 7; 2006. p. 1–10.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref076">
      <label>76</label>
      <mixed-citation publication-type="other">Au OKC, Tai CL, Chu HK, Cohen-Or D, Lee TY. Skeleton extraction by mesh contraction. In: ACM transactions on graphics (TOG). vol. 27. ACM; 2008. p. 44.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref077">
      <label>77</label>
      <mixed-citation publication-type="other">Sorkine O, Cohen-Or D, Lipman Y, Alexa M, Rössl C, Seidel HP. Laplacian surface editing. In: Proceedings of the 2004 Eurographics/ACM SIGGRAPH symposium on Geometry processing. ACM; 2004. p. 175–184.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref078">
      <label>78</label>
      <mixed-citation publication-type="other">Nealen A, Igarashi T, Sorkine O, Alexa M. Laplacian mesh optimization. In: Proceedings of the 4th international conference on Computer graphics and interactive techniques in Australasia and Southeast Asia. ACM; 2006. p. 381–389.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref079">
      <label>79</label>
      <mixed-citation publication-type="journal"><name><surname>Shapira</surname><given-names>L</given-names></name>, <name><surname>Shamir</surname><given-names>A</given-names></name>, <name><surname>Cohen-Or</surname><given-names>D</given-names></name>. <article-title>Consistent mesh partitioning and skeletonisation using the shape diameter function</article-title>. <source>The Visual Computer</source>. <year>2008</year>;<volume>24</volume>(<issue>4</issue>):<fpage>249</fpage><pub-id pub-id-type="doi">10.1007/s00371-007-0197-5</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref080">
      <label>80</label>
      <mixed-citation publication-type="other">The CGAL Project. CGAL User and Reference Manual. 4.14 ed. CGAL Editorial Board; 2019. Available from: <ext-link ext-link-type="uri" xlink:href="https://doc.cgal.org/4.14/Manual/packages.html">https://doc.cgal.org/4.14/Manual/packages.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref081">
      <label>81</label>
      <mixed-citation publication-type="journal"><name><surname>Rudyanto</surname><given-names>RD</given-names></name>, <name><surname>Kerkstra</surname><given-names>S</given-names></name>, <name><surname>Van Rikxoort</surname><given-names>EM</given-names></name>, <name><surname>Fetita</surname><given-names>C</given-names></name>, <name><surname>Brillet</surname><given-names>PY</given-names></name>, <name><surname>Lefevre</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Comparing algorithms for automated vessel segmentation in computed tomography scans of the lung: the VESSEL12 study</article-title>. <source>Medical image analysis</source>. <year>2014</year>;<volume>18</volume>(<issue>7</issue>):<fpage>1217</fpage>–<lpage>1232</lpage>. <pub-id pub-id-type="doi">10.1016/j.media.2014.07.003</pub-id><?supplied-pmid 25113321?><pub-id pub-id-type="pmid">25113321</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref082">
      <label>82</label>
      <mixed-citation publication-type="journal"><name><surname>Fleming</surname><given-names>J</given-names></name>, <name><surname>Conway</surname><given-names>J</given-names></name>, <name><surname>Majoral</surname><given-names>C</given-names></name>, <name><surname>Katz</surname><given-names>I</given-names></name>, <name><surname>Caillibotte</surname><given-names>G</given-names></name>, <name><surname>Pichelin</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Controlled, parametric, individualized, 2-D and 3-D imaging measurements of aerosol deposition in the respiratory tract of asthmatic human subjects for model validation</article-title>. <source>Journal of aerosol medicine and pulmonary drug delivery</source>. <year>2015</year>;<volume>28</volume>(<issue>6</issue>):<fpage>432</fpage>–<lpage>451</lpage>. <pub-id pub-id-type="doi">10.1089/jamp.2014.1191</pub-id><?supplied-pmid 25859710?><pub-id pub-id-type="pmid">25859710</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref083">
      <label>83</label>
      <mixed-citation publication-type="journal"><name><surname>Majoral</surname><given-names>C</given-names></name>, <name><surname>Fleming</surname><given-names>J</given-names></name>, <name><surname>Conway</surname><given-names>J</given-names></name>, <name><surname>Katz</surname><given-names>I</given-names></name>, <name><surname>Tossici-Bolt</surname><given-names>L</given-names></name>, <name><surname>Pichelin</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Controlled, parametric, individualized, 2D and 3D imaging measurements of aerosol deposition in the respiratory tract of healthy human volunteers: in vivo data analysis</article-title>. <source>Journal of aerosol medicine and pulmonary drug delivery</source>. <year>2014</year>;<volume>27</volume>(<issue>5</issue>):<fpage>349</fpage>–<lpage>362</lpage>. <pub-id pub-id-type="doi">10.1089/jamp.2013.1065</pub-id><?supplied-pmid 24400875?><pub-id pub-id-type="pmid">24400875</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref084">
      <label>84</label>
      <mixed-citation publication-type="journal"><name><surname>Das</surname><given-names>P</given-names></name>, <name><surname>Nof</surname><given-names>E</given-names></name>, <name><surname>Amirav</surname><given-names>I</given-names></name>, <name><surname>Kassinos</surname><given-names>SC</given-names></name>, <name><surname>Sznitman</surname><given-names>J</given-names></name>. <article-title>Targeting inhaled aerosol delivery to upper airways in children: Insight from computational fluid dynamics (CFD)</article-title>. <source>PloS one</source>. <year>2018</year>;<volume>13</volume>(<issue>11</issue>):<fpage>e0207711</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0207711</pub-id><?supplied-pmid 30458054?><pub-id pub-id-type="pmid">30458054</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref085">
      <label>85</label>
      <mixed-citation publication-type="journal"><name><surname>Nousias</surname><given-names>S</given-names></name>, <name><surname>Lalos</surname><given-names>AS</given-names></name>, <name><surname>Arvanitis</surname><given-names>G</given-names></name>, <name><surname>Moustakas</surname><given-names>K</given-names></name>, <name><surname>Tsirelis</surname><given-names>T</given-names></name>, <name><surname>Kikidis</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>An mHealth system for monitoring medication adherence in obstructive respiratory diseases using content based audio classification</article-title>. <source>IEEE Access</source>. <year>2018</year>;<volume>6</volume>:<fpage>11871</fpage>–<lpage>11882</lpage>. <pub-id pub-id-type="doi">10.1109/ACCESS.2018.2809611</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230259.ref086">
      <label>86</label>
      <mixed-citation publication-type="other">Pettas D, Nousias S, Zacharaki EI, Moustakas K. Recognition of Breathing Activity and Medication Adherence using LSTM Neural Networks. In: 2019 IEEE 19th International Conference on Bioinformatics and Bioengineering (BIBE). IEEE; 2019. p. 941–946.</mixed-citation>
    </ref>
    <ref id="pone.0230259.ref087">
      <label>87</label>
      <mixed-citation publication-type="other">Polychronidou E, Lalas A, Tzovaras D, Votis K. A systematic distributing sensor system prototype for respiratory diseases. In: 2019 International Conference on Wireless and Mobile Computing, Networking and Communications (WiMob). IEEE; 2019. p. 191–196.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0230259.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230259.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Fang-Bao</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Fang-Bao Tian</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Fang-Bao Tian</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230259" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">7 Oct 2019</named-content>
    </p>
    <p>PONE-D-19-24923</p>
    <p>AVATREE: An open-source computational modelling framework modelling Anatomically Valid Airway TREE conformations</p>
    <p>PLOS ONE</p>
    <p>Dear Mr Nousias,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by Nov 21 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Fang-Bao Tian</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>2.  Thank you for stating the following in the Acknowledgments Section of your manuscript:</p>
    <p>'This research has been funded by the European Regional Development Fund of the</p>
    <p>European Union and Greek national funds through the Operational Program Compet-itiveness, Entrepreneurship and Innovation, under the call RESEARCH - CREATE - INNOVATE (project code:T1EDK-03832).'</p>
    <p>We note that you have provided funding information that is not currently declared in your Funding Statement. However, funding information should not appear in the Acknowledgments section or other areas of your manuscript. We will only publish funding information present in the Funding Statement section of the online submission form.</p>
    <p>Please remove any funding-related text from the manuscript and let us know how you would like to update your Funding Statement. Currently, your Funding Statement reads as follows:</p>
    <p>'The author(s) received no specific funding for this work.'</p>
    <p>3.  Please ensure that you refer to Figure 7 in your text as, if accepted, production will need this reference to link the reader to the figure.</p>
    <p>Additional Editor Comments (if provided):</p>
    <p>Thank you for submitting your work to Plos One. It has been commented by two independent specialists. As you can see, their views regarding the paper quality are quite different. I would give you an opportunity, to clarify the major issues raised by Reviewer 2, given that the tool introduced may have important application in the community.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Partly</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: No</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: No</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: No</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: I have read PONE-D-19-24923 which develops a computational modelling framework called “AVATREE” to define the personalized boundary conditions required for the simulation of pulmonary functions. Specifically, the AVATREE works as follows: (i) using image data to provide patient-specific representations of the structural models of the bronchial tree, (ii) establishing and extending 1D graph representations of the bronchial tree, (iii) generating 3D surface models of the extended bronchial tree models, (iv) producing probabilities visualization of airway generations on the personalized CT imaging data, and (v) offering an open-source toolbox in C++ and a graphical user interface integrating modelling functionalities. The AVATREE can successfully create anatomically valid airway tree conformations, which would be helpful to eventually predict gas flow and particle deposition characteristics in the healthy and diseased bronchial trees. In my view, this computational modelling framework is worth popularizing, and therefore I advise the paper to be accepted by the PLOS ONE.</p>
    <p>Reviewer #2: This article presents AVAtree, a software designed to take CT images and create computational descriptions of the pulmonary airways. The aim of the paper is to provide an end to end tool that creates airway trees from imaging, which would be highly useful for the community. However, there are several issues with the presentation of the models employed in the context of existing studies and softwares in the area, and there is not enough information on whether the end-point models of the airway anatomy reflect real lung structures to thoroughly assess the validity of the methods.</p>
    <p>1. It was not clear from the manuscript how to access or use AVAtree, as this is a proposed opensource software. The link to a gitlab repository is given as a foot note, but clearer instructions would be beneficial. An attempt to access this repository at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/vvr/LungModelling">https://gitlab.com/vvr/LungModelling</ext-link> led to a ‘page not found’ error. Therefore it was impossible to assess whether the software behaves as described.</p>
    <p>2. There appears to be some confusion regarding the existing literature in the background section. This section is somewhat unfocused, and needs work to clearly motivate the research being conducted. For example, Fernandez et al. looked at generating lung surface representations but this is the only study looking at the lung surface in this section. It appears to be presented in respect to defining boundary conditions for fluid dynamics models, but as far as I am aware the Fernandez model has not been used in that way. The section then jumps to a Hegedus who look at idealised representations of the upper airways, which is not related to the Fernadez study.</p>
    <p>3. Reference [4] is incorrectly given as a reference for AVAtree on page 2.</p>
    <p>4. Section 1.1.3 – I think the citation for coupled 3D-1D models is incorrect. Tawhai &amp; Lin [37] is a review article, and to state that this study did the modelling is not correct – the original papers are cited in that reference.</p>
    <p>5. The Florens model is not defined very well in section 1.1.3 and its relation to the two Tawhai studies that surround it is not clear.</p>
    <p>6. Again, Tawhai [10] is a review, it is not the paper that defined the volume filling branching model, and it did not focus on constrictive lung conditions. The Bordas study is one of many studies that use, or build upon these methods to predict function (see below), and the other studies are neglected from discussion. The Varner paper in this paragraph seems to me to refer specifically to branching mophogenesis in lung development, which is different to representing developed morphology in a model.</p>
    <p>7. A similar open-source pipeline is available in the Chaste framework – presented in a Bordas paper cited in this manuscript. This is not really discussed and should be as the two frameworks are similar in many ways.</p>
    <p>8. Section 2.1 (Segmentation and airways centerline extraction). This appears to be a new implementation for airway segmentation. But how do the authors know this is accurate? Several software, including opensource software have been generated to segment airways. The employed algorithm needs to be compared in some way to the field. This should be a comparison with existing algorithms and/or a comparison to a gold standard (perhaps a manual segmentation).</p>
    <p>9. The branching method described first by Tawhai [4], was first modified by the same group, (Tawhai et al. Journal of Applied Physiology 97: 2310-2321, 2004). Variations of this algorithm have been implemented by Bordas et al [cited] who provided an open source implementation. But variations have also been presented by Abadi et al (IEEE transactions on medical imaging 37: 693-702, 2018) and Mullally et al. (Ann Biomed Eng 37: 286-300, 2009), and Montesantos et al. PloS one 11: e0168026, 2016). In general, modifications have been made to suit a groups own modelling applications – to claim these changes as an improvement, would require some improved comparison to morphological studies. For the most part these models perform fairly similarly, and are good representations of the airway structure of the lung.</p>
    <p>10. The difference between this and previous methods is a PCA based splitting of seed points, very limited information is given about why one would do this (it seems more complicated than other methods), or what improvements it brings. The algorithm should at the very least be compared to real lung morphometric data, as has been typical in previous studies using similar algorithms.</p>
    <p>11. It is not clear how the volume of the lung is defined from imaging, or how generated branches are restricted to lie in the lung volume (if at all).</p>
    <p>12. Given there is presumably a complete 3D representation of the upper airway tree from CT, some information needs to be given regaring why would want to represent these branches as idealised tubular structures for CFD?</p>
    <p>13. Figures associated with dataset collection (and some beyond) have no numbers</p>
    <p>14. It is not at all clear what is meant by personalised boundary conditions, or how they are calculated – what is being simulated for which personalised boundary conditions are needed? Or do these boundary conditions relate to tree generation?</p>
    <p>15. To what level is the extended tree generated? The figures suggest that this is not to the level of the acinus as in most previous studies using similar algorithms, but that this is tunable. More information on this would be beneficial, especially in relation to how well the lung is represented it different choices are made.</p>
    <p>16. Fig 2 shows one very ling thin branch distending from the main upper airway tree – this does not look anatomical, I would suggest that the algorithm has missed some branches from this main airway, as a very long and thin branch like that is unusual.</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
    <supplementary-material content-type="local-data" id="pone.0230259.s001">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">AVATREE comment.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0230259.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0230259.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230259.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230259" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">3 Dec 2019</named-content>
    </p>
    <p>===================================================================================</p>
    <p>Reviewer 1</p>
    <p>General comments</p>
    <p>I have read PONE-D-19-24923 which develops a computational modelling framework called \\AVATREE" to define the personalized boundary conditions required for the simulation of pulmonary functions. Specifically, the AVATREE works as follows: (i) using image data to provide patientspecific representations of the structural models of the bronchial tree, (ii) establishing and extending 1D graph representations of the bronchial tree, (iii) generating 3D surface models of the extended bronchial tree models, (iv) producing probabilities visualization of airway generations on the personalized CT imaging data, and (v) offering an open-source toolbox in C++ and a graphical user interface integrating modelling functionalities. The AVATREE can successfully create anatomically valid airway tree conformations, which would be helpful to eventually predict gas flow and particle deposition characteristics in the healthy and diseased bronchial trees. In my view, this computational modelling framework is worth popularizing, and therefore I advise the paper to be accepted by the PLOS ONE.</p>
    <p>Response: We would like to thank the reviewer for commending our work. With this review, we aim to provide more justification for the strong and weak points of our work and improve the organization of our paper.</p>
    <p>===================================================================================</p>
    <p>Reviewer 2</p>
    <p>General comments</p>
    <p>This article presents AVATree, a software designed to take CT images and create computational descriptions of the pulmonary airways. The paper aims to provide an end to end tool that creates airway trees from imaging, which would be highly useful for the community. However, there are several issues with the presentation of the models employed in the context of existing studies and 1software in the area, and there is not enough information on whether the end-point models of the airway anatomy reflect real lung structures to thoroughly assess the validity of the methods. XResponse: We thank the reviewer for identifying these presentation issues. We describe below how we tried to improve the context of the related work and the methodological assessment and validation. </p>
    <p>===================================================================================</p>
    <p>Comment 2.1: It was not clear from the manuscript how to access or use AVAtree, as this is a proposed opensource software. The link to a gitlab repository is given as a footnote, but clearer instructions would be beneficial. An attempt to access this repository at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/vvr/LungModelling">https://gitlab.com/vvr/LungModelling</ext-link> led to a ‘page not found’ error. Therefore it was impossible to assess whether the software behaves as described. </p>
    <p>Response 2.1: We would like to thank the reviewer for pointing out this and to clarify that the repository was not made publicly available as we were expecting the outcome of the review process.</p>
    <p>Actual changes implemented:</p>
    <p>• The repository is now publicly available at</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/LungModelling/avatree">https://gitlab.com/LungModelling/avatree</ext-link>
    </p>
    <p>• Furthermore, we attach the following private link containing the outcomes of the presented</p>
    <p>pipeline for the needs of the review process.</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://www.dropbox.com/sh/kkh8p8eikxdvkah/AACUP0-hubPx69Waaamyvh9Ta?dl=0">https://www.dropbox.com/sh/kkh8p8eikxdvkah/AACUP0-hubPx69Waaamyvh9Ta?dl=0</ext-link>
    </p>
    <p>Please treat both links confidentially.</p>
    <p>===================================================================================</p>
    <p>Comment 2.2 There appears to be some confusion regarding the existing literature in the background section. This section is somewhat unfocused and needs work to clearly motivate the research being conducted. For example, Fernandez et al. looked at generating lung surface representations but this is the only study looking at the lung surface in this section. It appears to be presented in respect to defining boundary conditions for fluid dynamics models, but as far as I am aware the Fernandez model has not been used in that way. The section then jumps to a Hegedus who look at idealised representations of the upper airways, which is not related to the Fernadez study.</p>
    <p>Response: We would like to thank the reviewer for his/her comment that gives us the opportunity to explain better the contribution of our work and to present the main differences in comparison with similar previous work. Our study aims towards defining personalized boundary conditions that allow to derive flow and particle deposition patterns. Airway branch generation algorithms predict the structure of the bronchial tree in regions that CT based segmentation is not possible. Other studies revealing the relation of the children branch diameters as a function of the branching angle and the parent branch diameters facilitate the definition of the expected diameter for each branch. However, to allow the derivation of flow patterns, mesh structures define the boundary conditions for the CFD simulation. To this end the work of Fernandez was employed by Tawhai et al.[1, 2, 3] facilitating the definition of the lung surface cubic Hermite interpolation. Hegedus et al. attempted to define mathematically the surface of an idealized bifurcation. Such a modelling approach, given the centerline of the bronchial tree, can define the surface of the whole tree since the airways would follow a tubular structure linked with the bifurcation surface. Thus, the aforementioned studies are relevant to our approach since we define the same boundary 2conditions as the Poisson reconstructed surface of a sampled point cloud in order to avoid the definition of special rules in the reconstruction of the surface of bifurcations.</p>
    <p>Actual changes implemented: The whole section 1.1 was restructured to better reflect the</p>
    <p>aforementioned reasoning.</p>
    <p>===================================================================================</p>
    <p>Comment 2.3</p>
    <p>Reference [4] is incorrectly given as a reference for AVAtree on page 2.</p>
    <p>Response: Indeed, reference [4] was incorrectly given as a reference for AVATREE.</p>
    <p>Actual changes implemented: The reference was removed.</p>
    <p>===================================================================================</p>
    <p>Comment 2.4 Section 1.1.3 I think the citation for coupled 3D-1D models is incorrect. Tawhai and Lin [37] is a review article, and to state that this study did the modelling is not correct the original papers are cited in that reference.</p>
    <p>Response: We would like to thank the reviewer for his/her comment that gives us the opportunity to provide sharper insights on current literature. The original paper that should be referenced in this section might be the work of Lin C-L and Tawhai M-H entitled "Multiscale simulation of gas flow in subject-specific models of the human lung".</p>
    <p>Actual changes implemented: The correct references are now included.</p>
    <p>===================================================================================</p>
    <p>Comment 2.5 The Florens model is not defined very well in section 1.1.3 and its relation to the two Tawhai studies that surround it is not clear.</p>
    <p>Response: We would like to thank the reviewer for his/her comment that gives us the opportunity to better present the "Background and related work section". The Florens model, though belonging in the generic category of studies related to the anatomical and functional model of the human tracheo-bronchial tree is not directly linked to our study.</p>
    <p>Actual changes implemented: Taking into account the reviewer comments 2.2, 2.5, 2.6 the whole section was rewritten.</p>
    <p>===================================================================================</p>
    <p>Comment 2.6 Again, Tawhai [10] is a review, it is not the paper that defined the volume filling branching model, and it did not focus on constrictive lung conditions. The Bordas study is one of many studies that use or build upon these methods to predict function (see below), and the other studies are neglected from discussion. The Varner paper in this paragraph seems to me to refer specifically to branching morphogenesis in lung development, which is different to representing developed morphology in a model.</p>
    <p>Response: Tawhai et al in the review paper entitled "Computational modeling of the airway and pulmonary vascular structure and function: development of a "lung physiome" provided an overview of studies related to airway bronchoconstriction mechanisms which could be significant in terms of defining and describing constrictive pulmonary conditions. However, as the reviewer correctly highlights the background section requires refocusing towards the studies that relate with the benefits of our approach. To this end, the phrase "with respect to pulmonary constrictive conditions" was removed. Bordas et al. [4] developed image analysis and modelling pipeline and applied it to healthy and asthmatic patient scans to produce complete personalized airway models to the acinar level incorporating, lung and lobar segmentation, airway segmentation and centerline extraction, algorithmic generation of distal airways, zero-dimensional models. Their results and implementation were included into the Chaste framework [5] which is an open-source framework to facilitate computational modelling in heart, lung and soft tissue simulations. The Varner paper was indeed not so relevant in this context. However Varner et al. report that "detailed morphometric analysis of the bronchial tree has revealed a similar geometric scaling. Using casts of human lungs, Weibel and Gomez reported that the average diameter of the zth generation of airways, d(z), follows the scaling law d(z) = d0 × 2− z3 , which is consistent with Murray’s law for symmetric branching" which is relevant to a certain component of our pipeline. To this end, the whole section was rewritten to better highlight such points.</p>
    <p>Actual changes implemented: To this end, the whole section was rewritten to better highlight</p>
    <p>the reviewer’s aspect.</p>
    <p>===================================================================================</p>
    <p>Comment 2.7 A similar open-source pipeline is available in the Chaste framework { presented in a Bordas paper cited in this manuscript. This is not really discussed and should be as the two frameworks are similar in many ways.</p>
    <p>Response: Bordas et al. [4] developed an image analysis and modelling pipeline and applied it to healthy and asthmatic patient scans to produce complete personalized airway models to the acinar level incorporating lung and lobar segmentation, airway segmentation and centerline extraction, algorithmic generation of distal airways, zero-dimensional models. Their results and implementation were included into the Chaste framework [5] which is an open-source framework to facilitate computational modelling in heart, lung and soft tissue simulations. With respect to Chaste, our work: • generates surface meshes of extended patient-based bronchial trees,</p>
    <p>• simulates constrictions of the airways,</p>
    <p>• generates models that are suitable for computational fluid dynamics (CFD) simulations,</p>
    <p>• generates probabilistic view of airway tree generations.</p>
    <p>Actual changes implemented: A new paragraph was added in 1.1 discussing Chaste framework and relevant similar frameworks.</p>
    <p>===================================================================================</p>
    <p>Comment 2.8 Section 2.1 (Segmentation and airways centerline extraction). This appears to be a new implementation for airway segmentation. But how do the authors know this is accurate? Several software, including opensource software, have been generated to segment airways. The employed algorithm needs to be compared in some way to the field. This should be a comparison with existing algorithms and/or a comparison to a gold standard (perhaps a manual segmentation).</p>
    <p>Response: We would like to thank the reviewer for his/her comment that gives us the opportunity to strengthen the basis of our pipeline. The input of our approach is the binary masks of the segmented airway tree and the lung volumes and can be obtained by any algorithm that successfully segments the first generations of the airways.For this purpose we investigated two algorithms, but AVATREE is modular to the CT segmentation method. The first investigated algorithm is the gradient vector flow [6, 7] which achieved high accuracy with low false-positive rate (only 1.44%) in a comparative study [8] in the context of the EXACT09 airway segmentation challenge. However the implementation of this method showed some instabilities, therefore we also exploited a standard and stable approach, which is the seeded region growing algorithm proposed in [9]. All algorithms presented in EXACT09 study perform well in the prediction of the first 4 generations validated on images of 16 subjects. As presented by Lo et al. the following figure indicates all 15 approaches discussed succeed in detecting the first four generations highlighted with the green color. Thus, our approach receives as input the green region of the airways detected by available baseline and sophisticated algorithms assumed to be a "golden" standard" . To this end we investigated both implementations. The former can be found in the public repository located in [10] and the latter in the public repository located in [11]. An example of the method outcome is presented in Figures 1 and 2. Further justification can be provided in [8] stating that "no 5algorithm comes close to detecting the entire reference airway tree. The highest branches detected and tree length detected for each case ranges from 64.6% to 94.3% and 62.6% to 90.4%, respectively, with an average branches detected and tree length detected of less than 77% and 74%, respectively. Fusing results from the participating algorithms improves the overall result substantially, reaching an average number of branches detected of 84.3% and an average tree length detected of 78.8%, with an average false positive rate of only 1.22%, when all fifteen algorithms[8] were used. Experiments on the inclusion of the results from different algorithms using the sequential forward selection (SFS) procedure show that the tree length of the fused results converges quite rapidly. This indicates that reasonably good results can be obtained by fusing only a subset of the algorithms. Table IV(B) in [8] shows that with a smaller number of algorithms (e.g. using up to 9 algorithms) in the fusion procedure, one can obtain a lower false positive rate at almost the same sensitivity."</p>
    <p>===================================================================================</p>
    <p>Comment 2.9 The branching method described first by Tawhai [4], was first modified by the same group, (Tawhai et al. Journal of Applied Physiology 97: 2310-2321, 2004). Variations of this algorithm have been implemented by Bordas et al. who provided an open-source implementation. But variations have also been presented by Abadi et al (IEEE transactions on medical imaging 37: 693-702, 2018) and Mullally et al. (Ann Biomed Eng 37: 286-300, 2009), and Montesantos et al. PloS one 11: e0168026, 2016). In general, modifications have been made to suit a groups own modelling applications { to claim these changes as an improvement, would require some improved comparison to morphological studies. For the most part, these models perform fairly similarly and are good representations of the airway structure of the lung.</p>
    <p>Response: We would like to thank the reviewer for highlighting significant research in the same field. With respect to the definition of the splitting plane, Tawhai et used the direction of the lobar branch and the center of mass of the sampled points subdivision yielding a certain randomness. The same approach was used by mullaly et al. Bordas et al defined the splitting plane by the nodes of the parent branch and the center of mass of the sampled points subdivision. Abadi et al defined any plane containing the center of mass. Montesantos et al used both siblings of of the parent branch to define a splitting point. We also concur that all the aforementioned approaches perform fairly similarly and are good representations of the airway structure of the lung. The motivation for employing PCA is at the space utilization aspect. The following figures give a visual description of the effect. Picking a plane so that the resulting split volumes are less "rectangular", meaning that the sides of the bounding box demonstrate the lowest possible variation, inhibits the appearance of very long branches.</p>
    <p>Actual changes implemented: The response for comment 2.9 is provided in comment 2.10.</p>
    <p>===================================================================================</p>
    <p>Comment 2.10</p>
    <p>The difference between this and previous methods is a PCA based splitting of seed points, very limited information is given about why one would do this (it seems more complicated than other methods), or what improvements it brings. The algorithm should at the very least be compared to real lung morphometric data, as has been typical in previous studies using similar algorithms. </p>
    <p>Response: The motivation behind employing Principal Component Analysis is that the direction of the eigenvector with the greatest norm indicates the dimension of the data with the greatest variance denoting the direction where more space is available for the branches to grow. Picking a plane so that the resulting split volumes are less "rectangular", meaning that the sides of the bounding box demonstrate the lowest possible variation, inhibits the appearance of very long branches. Although this algorithm might seem complicated, in fact PCA, as a linear transformation, is easy and fast to compute. It has been very popular in many areas solving data normalization and dimensionality reduction problems. In respect to the methods ability to properly reproduce morphometric data, the distribution of branch length and angles as a function of generation, to the best of our knowledge is in agreement with distributions generated by Montesantos et al. Specifically, in the following figure in Montesantos 2016 study presents the airway length as a function of generation and the branching angle as a function of airway generation.</p>
    <p>===================================================================================</p>
    <p>Comment 2.11 It is not clear how the volume of the lung is defined from imaging, or how generated branches are restricted to lie in the lung volume (if at all).</p>
    <p>Response: We would like to thank the reviewer for providing us with the opportunity to strengthen weak descriptions of our pipeline. Since the lungs have a lower density than neighbouring tissue and bones, a global threshold is applied between -850 HU and -500 HU to define seed points and perform region growing. For this process, the FAST heterogeneous medical image computing and visualization framework [19] is employed. The result of lung segmentation process is a binary mask visualized in Figure 1. As a next step, we perform further processing of the segmentation result to distinguish left and right lungs. The process is described below: 1. A second region growing takes place starting from a single random point inside any of the segmented region only if all its immediate neighbours bare the same label. 92. To advance the region growing front, all points neighbouring a candidate voxel must not include background voxel. This region is given a new label 3. Steps 1 and 2 are repeated for the other lung volume. 4. The result is an image with three labels background and lung volumes. 5. To distinguish left or right we employ the directed graph extracted from the main airways. As a generic rule, the topological distance between the bifurcations of the first and the second generation is longer in the left lung. Furthermore, for the extended bronchial tree to remain inside the lung volume branches located outside the lung volume are pruned along with any children.</p>
    <p>Actual changes implemented: We have modified the segmentation related section 2.1 to include the presented methods. Furthermore, in subsection 2.2 we clarify that any branch located outside the lung volume is pruned along with any children.</p>
    <p>===================================================================================</p>
    <p>Comment 2.12</p>
    <p>Given there is presumably a complete 3D representation of the upper airway tree from CT, some</p>
    <p>information needs to be given regarding why would want to represent these branches as idealised</p>
    <p>tubular structures for CFD?</p>
    <p>Response: We would like to thank the reviewer for providing us with the opportunity to highlight the issue of airway morphology. Our approach allows to include a user defined part of the original segmentation to re reconstructed outcome. The extracted 1-dimensional representation is processed to include all the bifurcations located at the end of a given generation so as to facilitate the volume filling algorithm (Please refer to response 2.16 also). Figure 1 shows the result of pruning where all generations after the nth have been pruned. This processed 1-dimensional representation is subsequently used for the bronchial tree extension. The tubular structures were chosen as a model to create a 3D representation of the extended branches in generations for which only the bronchial tree centerlines were available and not a complete 3D representation. Appropriate binding is performed in the interface between upper and lower generations to allow a smooth transition. The first generations segmented from CT retain their original 3D structure unless the user opts for a more simplified representation for the airway tree that could be used to generalize CFD simulations on an average airway tree geometry. The provided code supports both options with the personalized complete 3D representation of the upper airway being the default option. Sampling a point cloud and performing Poisson surface reconstruction produces a watertight surface with smooth transitions and allows us to avoid the definition of special rules in bifurcation surface Furthermore, since the directed graph is extracted where each point on the centerline corresponds to a point on the lung surface it is possible to deform the surface with a custom function or pattern.</p>
    <p>===================================================================================</p>
    <p>Comment 2.13 Figures associated with dataset collection (and some beyond) have no numbers.</p>
    <p>Response: We would like to thank the reviewer for indicating us such errors.</p>
    <p>Actual changes implemented: The Figure numbers were placed correctly.</p>
    <p>===================================================================================</p>
    <p>Comment 2.14 It is not at all clear what is meant by personalised boundary conditions, or how they are calculated { what is being simulated for which personalised boundary conditions are needed? Or do these boundary conditions relate to tree generation?</p>
    <p>Response: Indeed, the personalised boundary conditions refer to the 3D triangular mesh of the bronchial tree extracted for each subject based on the CT images. The first three to four generations are extracted by the segmentation process while a user defined number of subsequent generations is predicted using the branching algorithm. As input, the branching algorithm receives a sampled volume from the lung volume segmentation mask which is personalized for each patient. Furthermore the CT-based extraction of the first generations also reflected the personalized geometry referring to the airway lengths and branching angles of the first generations of a specific subject.</p>
    <p>===================================================================================</p>
    <p>Comment 2.15 To what level is the extended tree generated? The figures suggest that this is not to the level of the acinus as in most previous studies using similar algorithms, but that this is tunable. More information on this would be beneficial, especially in relation to how well the lung is represented it different choices are made.</p>
    <p>Response: The number of generation is truly a tunable parameter, thus the tree is extended to any desired generation as long as the produced branches lie inside the lung volume. If n is the desired generation, we set the stopping criteria to 2(n+1) bifurcations. The choice of n depends on the application and the subsequent CFD simulation. Bordas et al. noted that "due to the limitations of CT and the computational difficulty of these (CFD) simulations, studies are typically limited to the first 6-10 generations".Unfortunately at the moment we do not have to groundtruth data that would allow us to quantitatively assess on a subject specific basis the error introduced by new simulated generations for every additional simulated generation. However, the overall distribution of simulated bronchi length and angles, as illustrated in Figure 10 are in agreement with overall statistics observed in the literature for each generation[12].</p>
    <p>===================================================================================</p>
    <p>Comment 2.16 Fig 2 shows one very ling thin branch distending from the main upper airway tree { this does not look anatomical, I would suggest that the algorithm has missed some branches from this main airway, as a very long and thin branch like that is unusual.</p>
    <p>Response: This very long branch distending from the main upper airways is most probably a segmentation error. Specifically, the long branch is part of generations 5 to 6 and their children are missing from the segmentation. To deal with such inconsistent segmentation outcomes a postprocessing step is included in the pipeline to remove branches demonstrating uncertainty regarding their generation. Furthermore the processed 1-dimensional representation has to include all the bifurcations located at the end of a given generation so as to facilitate the volume filling algorithm. Figure 1 shows the result of pruning where all generations after the nth have been pruned. This processed 1-dimensional representation is subsequently used for the bronchial tree extension.</p>
    <p>Actual changes implemented: We updated Figure 1 so as to include pruning operation.</p>
    <p>===================================================================================</p>
    <p>References</p>
    <p>[1] M. H. Tawhai, M. P. Nash, and E. A. Hoffman, \\An imaging-based computational approach to model ventilation distribution and soft-tissue deformation in the ovine lung1," Academic radiology, vol. 13, no. 1, pp. 113{120, 2006. </p>
    <p>[2] C.-L. Lin, M. H. Tawhai, and E. A. Hoffman, \\Multiscale image-based modeling and simulation of gas flow and particle transport in the human lungs," Wiley Interdisciplinary Reviews: Systems Biology and Medicine, vol. 5, no. 5, pp. 643{655, 2013.</p>
    <p>[3] M. H. Tawhai, P. Hunter, J. Tschirren, J. Reinhardt, G. McLennan, and E. A. Hoffman, \\Ct-based geometry analysis and finite element models of the human and ovine bronchial tree," Journal of applied physiology, vol. 97, no. 6, pp. 2310{2321, 2004.</p>
    <p>[4] R. Bordas, C. Lefevre, B. Veeckmans, J. Pitt-Francis, C. Fetita, C. E. Brightling, D. Kay, S. Siddiqui, and K. S. Burrowes, \\Development and analysis of patient-based complete conducting airways models," PloS one, vol. 10, no. 12, p. e0144105, 2015.</p>
    <p>[5] G. R. Mirams, C. J. Arthurs, M. O. Bernabeu, R. Bordas, J. Cooper, A. Corrias, Y. Davit, S.-J. Dunn, A. G. Fletcher, D. G. Harvey et al., \\Chaste: an open source c++ library for computational physiology and biology," PLoS computational biology, vol. 9, no. 3, p. e1002970, 2013.</p>
    <p>[6] C. Bauer, H. Bischof, and R. Beichel, \\Segmentation of airways based on gradient vector flow," in International workshop on pulmonary image analysis, Medical image computing and computer assisted intervention. Citeseer, 2009, pp. 191{201.</p>
    <p>[7] C. Bauer, T. Pock, H. Bischof, and R. Beichel, \\Airway tree reconstruction based on tube detection," in Proc. of Second International Workshop on Pulmonary Image Analysis, 2009, pp. 203{213.</p>
    <p>[8] P. Lo, B. Van Ginneken, J. M. Reinhardt, T. Yavarna, P. A. De Jong, B. Irving, C. Fetita, M. Ortner, R. Pinho, J. Sijbers et al., \\Extraction of airways from ct (exact’09)," IEEE Transactions on Medical Imaging, vol. 31, no. 11, pp. 2093{2107, 2012.</p>
    <p>[9] R. Adams and L. Bischof, \\Seeded region growing," IEEE Transactions on pattern analysis and machine intelligence, vol. 16, no. 6, pp. 641{647, 1994.</p>
    <p>[10] E. Smistad, A. C. Elster, and F. Lindseth. (2014) Tube segmentation framework. [Online]. Available: <ext-link ext-link-type="uri" xlink:href="https://github.com/smistad/Tube-Segmentation-Framework">https://github.com/smistad/Tube-Segmentation-Framework</ext-link></p>
    <p>[11] E. Smistad, M. Bozorgi, and F. Lindseth. (2015) Fast (framework for heterogeneous medical image computing and visualization). [Online]. Available: <ext-link ext-link-type="uri" xlink:href="https://github.com/smistad/FAST">https://github.com/smistad/FAST</ext-link> 14</p>
    <p>[12] S. Montesantos, I. Katz, M. Pichelin, and G. Caillibotte, \\The creation and statistical evaluation of a deterministic model of the human bronchial tree from hrct images," PLOS one, vol. 11, no. 12, p. e0168026, 2016.</p>
    <p>[13] T. Soong, P. Nicolaides, C. Yu, and S. Soong, \\A statistical description of the human tracheobronchial tree geometry," Respiration physiology, vol. 37, no. 2, pp. 161{172, 1979.</p>
    <p>[14] I. C. on Radiological Protection, \\Publication 66. human respiratory tract model for radiological protection," Ann. ICRP 24., 1994.</p>
    <p>[15] R. Phalen, H. Yeh, G. Schum, and O. Raabe, \\Application of an idealized model to morphometry of the mammalian tracheobronchial tree," The Anatomical Record, vol. 190, no. 2, pp. 167{176, 1978.</p>
    <p>[16] H.-C. Yeh and G. Schum, \\Models of human lung airways and their application to inhaled particle deposition," Bulletin of mathematical biology, vol. 42, no. 3, pp. 461{480, 1980.</p>
    <p>[17] R. F. Phalen, M. J. Oldham, C. B. Beaucage, T. T. Crocker, and J. Mortensen, \\Postnatal enlargement of human tracheobronchial airways and implications for particle deposition," The Anatomical Record, vol. 212, no. 4, pp. 368{380, 1985.</p>
    <p>[18] V. Sauret, P. Halson, I. Brown, J. Fleming, and A. Bailey, \\Study of the three-dimensional geometry of the central conducting airways in man using computed tomographic (ct) images,"Journal of anatomy, vol. 200, no. 2, pp. 123{134, 2002.</p>
    <p>[19] E. Smistad, M. Bozorgi, and F. Lindseth, \\Fast: framework for heterogeneous medical image computing and visualization," International Journal of computer assisted radiology and surgery, vol. 10, no. 11, pp. 1811{1822, 2015.</p>
    <supplementary-material content-type="local-data" id="pone.0230259.s002">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">PONE_D_19_24923_Response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pone.0230259.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0230259.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230259.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Fang-Bao</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Fang-Bao Tian</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Fang-Bao Tian</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230259" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">30 Dec 2019</named-content>
    </p>
    <p>PONE-D-19-24923R1</p>
    <p>AVATREE: An open-source computational modelling framework modelling Anatomically Valid Airway TREE conformations</p>
    <p>PLOS ONE</p>
    <p>Dear Mr Nousias,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by Feb 13 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Fang-Bao Tian</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #2: (No Response)</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #2: Partly</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #2: N/A</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #2: For the most part the authors have satisfied my concerns. However, the need for a comparison between generated tree structures and measured lung morphology remains. The authors have noted that their tree structures are consistent with those generated by Montesantos et al., but don’t provide direct evidence of this in the figures provided. It is left to the reader to go back to that paper and determine how similar the generated trees are. In addition, the Montesantos study is a simulated tree, and it would be most appropriate to compare directly to measurements of airway anatomy. Figures 4-9 of the cited Montesantos et al. paper, shows a comparison between their generated tree, the trees generated by other simulation studies, and, critically, anatomical studies (Horsfield and Cumming, for example). One or two figures like this should be included to verify the model. It would be reasonable for these to be Supplementary Material rather than in the main manuscript, but these data are needed to show how well the model for tree generation performs.</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0230259.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230259.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230259" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">13 Feb 2020</named-content>
    </p>
    <p>We would like to thank the reviewer for providing us with the opportunity to improve the justification of our approach and the validity of our results. While we were not able to find CT images along with image segmentation from previous studies, thereby not being able to perform a direct volumetric comparison of the extracted trees, we could retrieve analytic results of morphometric analyses of real (not simulated) trees which allowed to validate of our predictions more thoroughly. The following section replaced subsection 3.2 titled "structural modelling" and was included in the main document instead of supplementary material to strengthen the presentation of our results. </p>
    <p>Our simulation framework processes the initial tree centerline and generates a structural estimation given the first three to four available generation and their morphometric characteristics i.e., lengths and diameters. </p>
    <p>To facilitate the comparison with morphometric data, we employed a publicly available dataset provided by Montesantos et al.\\cite{montesantos2016creation} labelled as pone.0168026.s001. For the sake of self-completeness, the authors of \\cite{montesantos2016creation} provided morphometric data extracted from HRCT images acquired at the University Hospital Southampton NHS Foundation Trust as a part of study described in \\cite{fleming2015controlled,majoral2014controlled}. Data from seven healthy subjects and six patients with moderate or persistent asthma were included in the dataset. Asthmatic patients patients were diagnosed exacerbation-free for at least one month and were male non-smokers. </p>
    <p>A Sensation 64 slice HRCT scanner (Siemens, Enlargen, Germany) was utilized to capture 3D images from mouth to the base of the lungs. Subjects were posed in supine position and were instructed to perform slow exhalation. Groundtruth data for the development of bronchial tree models in \\cite{montesantos2016creation} were extracted by Pulmonary Workstation 2 Software including 3 to 4 generations in the upper lobes and 6 to 7 generations in the lower lobes. For each subject, a morphology file includes the total lung volume of the subject lung (in cm^3) and the percent volume per lobe while a translation file contains the airway connectivity, starting from the trachea to the terminal nodes. We used the generated trees from \\cite{montesantos2016creation} to validate our approach and compare our results with relevant literature findings. Specifically, we compared the distributions of diameters, airway lengths and branching angles for each generation and the total number of airways for Horsfield and Strahler orders.</p>
    <p>In total 31204 acini were calculated being in agreement with the results reported by \\cite{tawhai2004ct,montesantos2016creation}. Figures 10 and 11 present a comparison in terms of the number of airways for each level of Strahler and Horsfield orders. This comparison confirms that our model comes into agreement with pone.0168026.s001. Furthermore, distributions of airway lengths, branching angles and diameters were plotted for each generation, for AVATREE and pone.0168026.s001\\cite{montesantos2016creation}.</p>
    <p>Airway lengths maintain the same exponential decay pattern for both models. Differences appear in generations 1 to 4 that are distinctively defined by body size and anatomical features. The distribution of branching angles of our model is also confirmed by pone.0168026.s001\\cite{montesantos2016creation} maintaining a nearly linear decay with a very small rate. The distributions of diameters per generation are also observed to follow an exponential decay pattern. Both our model and pone.0168026.s001\\cite{montesantos2016creation} decay similarly after generation 4 validating the morphometric characteristics of the airway trees generated by our approach. Figures 12 to 14 present the distribution of airway length, branching angle and diameter for each generation for AVATREE and for pone.0168026.s001 \\cite{montesantos2016creation}.</p>
    <p>Table 1 presents and overview of quantitative macroscopic figures for AVATREE and relevant studies.</p>
    <p>Branching ratios (RB_H,RB_S), diameter ratios (RD_H,RD_S) and length ratios RL_H,RL_S) were calculated for Strahler and Horsfield ratios denoted as *_S and *_H respectively. Specifically, RB_H,RD_H and RL_H were calculated equal to RB_H=1.74, RD_H=1.259 and RL_H=1.26+- 1.01. Montesantos et al.\\cite{montesantos2016creation} reported RB_H=1.56, RD_H=1.115 and RL_H=1.13 respectively. Additionally, RB_S,RD_S and RL_S were calculated equal to RB_S=2.35, RD_S=1.25 and RL_S=1.23+- 1.02 and are close to the figures provides by relative studies \\cite{horsfield1986morphometry,montesantos2016creation} as Table 1 reveals. Likewise, rate of decline for diameters per generation RD was calculated to RD=0.83 +- 0.21, being in agreement to \\cite{montesantos2016creation}. </p>
    <p>Finally, average branching angle theta for our model was calculated to 32.44+-28.95 comparable to \\cite{montesantos2016creation} reporting a theta equal to 42.1+- 21.4.</p>
  </body>
</sub-article>
<sub-article id="pone.0230259.r005" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230259.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Fang-Bao</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Fang-Bao Tian</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Fang-Bao Tian</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230259" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">26 Feb 2020</named-content>
    </p>
    <p>AVATREE: An open-source computational modelling framework modelling Anatomically Valid Airway TREE conformations</p>
    <p>PONE-D-19-24923R2</p>
    <p>Dear Dr. Nousias,</p>
    <p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
    <p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
    <p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>With kind regards,</p>
    <p>Fang-Bao Tian</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #2: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #2: The authors have satisfied my concerns raised in the last round of review. Thank you for adding the statistical information on the trees, which will help readers interpret the paper.</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pone.0230259.r006" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230259.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Fang-Bao</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Fang-Bao Tian</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Fang-Bao Tian</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230259" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Mar 2020</named-content>
    </p>
    <p>PONE-D-19-24923R2 </p>
    <p>AVATREE: An open-source computational modelling framework modelling Anatomically Valid Airway TREE conformations </p>
    <p>Dear Dr. Nousias:</p>
    <p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE.</p>
    <p>With kind regards,</p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Fang-Bao Tian </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
