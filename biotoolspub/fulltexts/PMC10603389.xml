<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10603389</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad151</article-id>
    <article-id pub-id-type="publisher-id">vbad151</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Immunoinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NetAllergen, a random forest model integrating MHC-II presentation propensity for improved allergenicity prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yuchen</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sackett</surname>
          <given-names>Peter Wad</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7885-4311</contrib-id>
        <name>
          <surname>Nielsen</surname>
          <given-names>Morten</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
        <aff><institution>Instituto de Investigaciones Biotecnológicas, Universidad Nacional de San Martín</institution>, San Martin 1650, <country country="AR">Argentina</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6836-4906</contrib-id>
        <name>
          <surname>Barra</surname>
          <given-names>Carolina</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
        <xref rid="vbad151-cor1" ref-type="corresp"/>
        <!--carolet@dtu.dk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad151-cor1">Corresponding author. Department of Health Technology, Technical University of Denmark, Kgs. Lyngby, Copenhagen 2800, Denmark. E-mail: <email>carolet@dtu.dk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-10-16">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad151</elocation-id>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>26</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad151.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Allergy is a pathological immune reaction towards innocuous protein antigens. Although only a narrow fraction of plant or animal proteins induce allergy, atopic disorders affect millions of children and adults and cost billions in healthcare systems worldwide. <italic toggle="yes">In silico</italic> predictors can aid in the development of more innocuous food sources. Previous allergenicity predictors used sequence similarity, common structural domains, and amino acid physicochemical features. However, these predictors strongly rely on sequence similarity to known allergens and fail to predict protein allergenicity accurately when similarity diminishes.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To overcome these limitations, we collected allergens from AllergenOnline, a curated database of IgE-inducing allergens, carefully removed allergen redundancy with a novel protein partitioning pipeline, and developed a new allergen prediction method, introducing MHC presentation propensity as a novel feature. NetAllergen outperformed a sequence similarity-based BLAST baseline approach, and previous allergenicity predictor AlgPred 2 when similarity to known allergens is limited.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The web service NetAllergen and the datasets are available at <ext-link xlink:href="https://services.healthtech.dtu.dk/services/NetAllergen-1.0/" ext-link-type="uri">https://services.healthtech.dtu.dk/services/NetAllergen-1.0/</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Currently, allergy affects as many as 20% of the worldwide population (<xref rid="vbad151-B42" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2020</xref>). Moreover, the prevalence of allergic diseases has increased in the past decades, and it is likely to rise in the future (<xref rid="vbad151-B37" ref-type="bibr">Sicherer and Sampson 2018</xref>).</p>
    <p>Allergy is characterized by a pathological immune reaction, triggered by normally ubiquitous and innocuous protein antigens in susceptible individuals (<xref rid="vbad151-B42" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2020</xref>). In addition, allergy is a wide terminology that encompasses a number of diseases primarily sharing an IgE-dependent pathway (<xref rid="vbad151-B43" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2016</xref>). Once the allergen contacts the skin or mucosal tissues, antigen-presenting cells (APCs) uptake and digest allergens into small peptides. Peptides with specific motifs are next presented by the major histocompatibility complex (MHC) class II molecules to activate type 2T helper (Th2) cells. In susceptible individuals, Th2 cells further stimulate B cells to produce IgE antibodies in the first sensitization stage. An individual develops an allergy when the immune system is re-exposed to the allergen. The reasons why only a small number of proteins induce allergy is largely unknown. However, it has been suggested that allergens share specific features that, according to the route and level of exposure, genetic predisposition, and environmental factors, can develop into allergies (<xref rid="vbad151-B35" ref-type="bibr">Scheurer <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="vbad151-B38" ref-type="bibr">du Toit <italic toggle="yes">et al.</italic> 2016</xref>).</p>
    <p>Recently, genome-wide association studies (GWAS) have revealed that several allergies are strongly associated with specific HLA alleles, in particular for HLA-DQ and HLA-DRB (<xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>). For example, allergic rhinitis has shown a strong association with HLA-DRB1*04:01, HLA-DQB1*02:02, and HLA-DQB1*03:01 (<xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>). HLA-DQA1*01:03-DQB1*06:01 was found to be associated with wheat allergy, and patients who had celiac diseases carried HLA-DQA1*05:01-DQB1*02:01 and HLA-DQA1*03:01-DQB1*03:02 (<xref rid="vbad151-B25" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2019</xref>). In allergic respiratory disease studies, HLA-DRB1*15:01 has been found to be associated with mite (<xref rid="vbad151-B22" ref-type="bibr">Moffatt <italic toggle="yes">et al.</italic> 2001</xref>) and birch pollen allergens (<xref rid="vbad151-B39" ref-type="bibr">Van Overtvelt <italic toggle="yes">et al.</italic> 2008</xref>). However, the same allele was negatively associated with gelatine (<xref rid="vbad151-B33" ref-type="bibr">Sakaguchi <italic toggle="yes">et al.</italic> 2002</xref>) and cow’s milk (<xref rid="vbad151-B7" ref-type="bibr">Dimitrov and Doytchinova 2016</xref>). Additionally, GWAS studies also suggest that specific amino acid positions in the peptide binding groove shared among different alleles provide susceptibility or protection against different types of allergies (<xref rid="vbad151-B26" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>). Together these findings strongly suggest that differential MHC-II presentation is involved in allergy.</p>
    <p>Various methods have been utilized to identify common patterns in allergens and predict their allergenicity. Initially, relational databases were used to cluster allergens based on their protein sequence or shared structural domains, biochemical, and functional properties (<xref rid="vbad151-B16" ref-type="bibr">Ivanciuc <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="vbad151-B17" ref-type="bibr">2003, Scheurer <italic toggle="yes">et al.</italic> 2015</xref>). Both Blast and Allermatch, another sequence-comparing method, were used to find shared amino acid segments and search query sequences against allergen databases, respectively (<xref rid="vbad151-B11" ref-type="bibr">Fiers <italic toggle="yes">et al.</italic> 2004</xref>, <xref rid="vbad151-B44" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2007</xref>). Later, motif-profile predictions improved prediction by searching for similarities in potential functional domains (<xref rid="vbad151-B31" ref-type="bibr">Riaz <italic toggle="yes">et al.</italic> 2005</xref>). Machine-learning-based methods including features, such as known IgE epitopes, peptide motifs, and dipeptide compositions, have also been widely applied to predict allergenicity (<xref rid="vbad151-B32" ref-type="bibr">Saha and Raghava 2006</xref>, <xref rid="vbad151-B23" ref-type="bibr">Muh <italic toggle="yes">et al.</italic> 2009</xref>). These include Allerdictor, which uses K-mer frequencies in a support vector machine (SVM) (<xref rid="vbad151-B4" ref-type="bibr">Dang and Lawrence 2014</xref>), and AllergenFP based on Tanimoto coefficient similarity search (<xref rid="vbad151-B9" ref-type="bibr">Dimitrov <italic toggle="yes">et al.</italic> 2014b</xref>). FuzzyApp integrates sequence and motif similarity, and other amino acid features in a SVM, introducing fuzzy logic to handle multiple non-binary results (<xref rid="vbad151-B34" ref-type="bibr">Saravanan and Lakshmi 2014</xref>). Q-repeats, 3D structural similarities, and sequential similarities were incorporated into the decision tree in AllerCatPro (<xref rid="vbad151-B21" ref-type="bibr">Maurer-Stroh <italic toggle="yes">et al.</italic> 2019</xref>). The auto- and cross-covariance of amino acids in a sequence were adopted in AllerTOP v2 (<xref rid="vbad151-B8" ref-type="bibr">Dimitrov <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="vbad151-B6" ref-type="bibr">Dimitrov <italic toggle="yes">et al.</italic> 2014a</xref>). AlgPred 2 predicts sequences with hybrid scores by integrating BLAST, and motif features using a random forest model (<xref rid="vbad151-B36" ref-type="bibr">Sharma <italic toggle="yes">et al.</italic> 2021</xref>). However, to the best of our knowledge, no predictor has used MHC presentation in allergenicity prediction.</p>
    <p>In this study, we developed a random forest predictor, NetAllergen, using MHC class II peptide presentation propensity for HLA-DR and HLA-DQ alleles in combination with physicochemical properties, structural information, and evolutionary information. We investigated and validated the relevance of MHC presentation propensity and other features for allergenicity predictions. NetAllergen was benchmarked against a sequence-based BLAST model and other state-of-the-art predictors and demonstrated to achieve higher performance, particularly for allergens that share limited similarity to previously known allergens.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Training dataset</title>
      <p>On September 2020, 2171 allergen protein IDs were retrieved from AllergenOnline, a curated database of IgE-producing allergens (<xref rid="vbad151-B13" ref-type="bibr">Goodman <italic toggle="yes">et al.</italic> 2016</xref>). Available FASTA sequences were downloaded from NCBI and filtered to include protein sequences that ranged in length from 50 to 1000 (<italic toggle="yes">N</italic> = 2082). To remove redundancy in the dataset, a Hobohm 1 (<xref rid="vbad151-B14" ref-type="bibr">Hobohm <italic toggle="yes">et al.</italic> 1992</xref>) algorithm with 90% sequence identity was applied, resulting in a set of 686 non-redundant allergens covering 187 species. In short, the Hobohm 1 algorithm sorts the proteins by sequence length from longest to shortest. The first protein is automatically added to a ‘unique’ list, then the second protein is compared to the protein in the unique list. If the identity exceeds 90% the protein is removed, otherwise it is appended to the unique list. This process is iterated throughout the sorted protein list. Sequence identity was determined by pairwise alignment as the percentage of identical amino acids with regard to the query protein length.</p>
      <p>For each allergen, non-allergen protein candidates were selected by searching for matching species names with the allergen and excluding results with the following keywords in NCBI: allergen, hypothetical, uncertain, predicted, probable, and putative. Additionally, sequence lengths were limited to ±20% of the allergen length. Up to five candidates were randomly selected with BLASTP <italic toggle="yes">E</italic>-values (NCBI-Blast 2.12.0, <xref rid="vbad151-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1990</xref>) higher than 1 × 10<sup>−10</sup> against the allergens (to avoid including sequences with high similarity to known allergens that could be untested antigens, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), and 1 × 10<sup>−100</sup> against any sequence in the negative dataset (to avoid including repeated sequences). The number of non-allergens collected per allergen subset may vary (below five) because of the limited set of proteins for some species. The negative dataset consisted of 2477 non-allergic protein sequences.</p>
    </sec>
    <sec>
      <title>2.2 Dataset homology reduction</title>
      <p>In short, similar allergens were clustered together using BLAST <italic toggle="yes">E</italic>-score and minimum spanning tree (MST). First, the sequence similarity between each allergen in the dataset was determined by BLASTP using an all-against-all alignment. If the query did not provide a significant hit to a protein in the database, the <italic toggle="yes">E</italic>-score was set to a value of 10, scoring as non-aligned proteins. A pairwise comparison matrix of <italic toggle="yes">E</italic>-values was obtained to generate clusters by the MST algorithm. All clusters were then randomly split in partitions to train the model. The training dataset was further reduced by different thresholds by removing the proteins that, after clustering with MST, had more than 20 neighbours/edges. The final positive dataset had 537 allergic proteins after removing homologous sequences. After clustering the allergens, all the non-allergens associated with each allergen (sharing the same species and length range) were grouped together. The clusters from MST were randomly distributed into five partitions with similar sizes.</p>
    </sec>
    <sec>
      <title>2.3 Feature constructions</title>
      <sec>
        <title>2.3.1 MHC-II presentation propensity scores</title>
        <p>NetMHCIIpan 4.0 (<xref rid="vbad151-B30" ref-type="bibr">Reynisson <italic toggle="yes">et al.</italic> 2020b</xref>) was used to predict MHC binding selecting the peptides with a percentile rank below 10% (<xref rid="vbad151-B29" ref-type="bibr">Reynisson <italic toggle="yes">et al.</italic> 2020a</xref>), using a sliding window of 15. From these numbers, two different features were collected. Binder 1 includes the counts for HLA-DRB1*04:01, HLA-DQA1*02:01-DQB1*02:02, HLA-DQA1*04:01-DQB1*03:01, HLA-DQA1*01:03-DQB1*06:01, HLA-DQA1*03:01-DQB1*03:02, and HLA-DQA1*05:01-DQB1*02:01 and binder 2 the counts for HLA-DRB1*15:01. These sets of alleles were selected as they were previously demonstrated to be positively (binder 1) or negatively/positively (binder 2) associated with allergies. Final MHC presentation propensity scores were calculated by summing the binders over different alleles normalized by sequence length.</p>
      </sec>
      <sec>
        <title>2.3.2 Physicochemical properties</title>
        <p>The physicochemical properties included average residue weight, average charge, and isoelectric point constructed with Biopython. Amino acids were also classified into tiny, small, aliphatic, aromatic, non-polar, polar, charged, basic, and acidic groups by size, structure, and charge. These were obtained using Pepstats from EMBL-EBI tools. Additionally, hydropathy indices were calculated using the Kyte–Doolittle scale. A window size of 9 was used to determine position-specific hydropathy indices. Based on the sequential indices, we calculated an overall score for a protein by counting the number of hydrophobic or hydrophilic residues in a sliding window of 5. If all consecutive residues within a window had the same hydropathy tendency, a count of one was added to the overall score. To eliminate the influence of length on feature value, the scores were normalized by the sequence length.</p>
      </sec>
      <sec>
        <title>2.3.3 Local structural features</title>
        <p>Structural features were represented by alpha helix, beta sheet, relative solvent accessibility (RSA), and disordered regions. These features were predicted by using NetSurfP 3.0 (<xref rid="vbad151-B15" ref-type="bibr">Høie <italic toggle="yes">et al.</italic> 2022</xref>). NetSurfP predicts residue-specific secondary structures. The occurrences of 5 alpha helix and 3 beta sheet residues within a sliding window of 7 summarized both alpha-helix and beta-sheet counts per protein. For RSA, the average value in the same window size was calculated, adding 1 if the value exceeded the 0.3 threshold. Additionally, under the same window size setting, the presence of more than three residues with a disorder higher than 0.5 was considered as 1 in the overall disorder. Likewise, these structural features were normalized by the sequence length.</p>
      </sec>
      <sec>
        <title>2.3.4 Amino acid compositions and evolutionary information</title>
        <p>The relative amino acid frequencies in the protein sequence were represented as 20 amino acid composition features (AAC). Further, the evolutionary information was represented by the position-specific scoring matrix (PSSM). PSI-BLAST was used to produce the PSSM. The sequences in the training datasets were used as a BLAST database for searching. We replaced the PSSMs of query sequences with no hits with the default scoring matrix BLOSUM62 due to the database limit. We applied the autocovariance (AC) transformation to vectorize the PSSM for a protein (<xref rid="vbad151-B28" ref-type="bibr">Refahi <italic toggle="yes">et al.</italic> 2020</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Model development</title>
      <p>Nested cross-validation was used for model training and evaluation. Based on the data partitioning, the outer layer had 5-folds, and the inner layers had 4 folds to ensure that the partitions were mutually independent. Grid searches were used to determine hyperparameters and model selection were carried out on the training and validation datasets. A wide set of hyperparameters was tested including the number of estimators, the maximum depth of the decision tree, the minimum samples for split and leaf, and the impurity criterion (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The outer test sets were predicted using a mean of the ensemble of the selected optimal models.</p>
      <p>On top of the partitioning and nested cross-validation, 10 different random seeds were used to randomly distribute the clusters in the different partitions. Ten models were generated from the 10 different seeds used for partitioning. The final model was made as an ensemble by taking the mean of 10 different seed models.</p>
      <p>All the random forest models were developed independently using this same pipeline in Python with Scikit-learn. Performance evaluation was made on the entire dataset by concatenating the predictions from the five outer test sets in the nested cross-validation setup. The input data were standardized to eliminate the effect of different feature scales using a <italic toggle="yes">z</italic>-score transformation. The <italic toggle="yes">z</italic>-scores were calculated based on the means and standard deviations of each training dataset. Data in validation and test datasets were normalized by the means and standard deviations from the training datasets used for model construction.</p>
      <p>Allergens in the training dataset were used to construct the BLAST database. Evaluation sequences were searched against the database and the <italic toggle="yes">E</italic>-values were extracted as the predictions of the baseline model.</p>
    </sec>
    <sec>
      <title>2.5 Evaluation datasets</title>
      <p>Two independent evaluation datasets were collected. The first one was collected from the AlgPred 2 evaluation dataset (<xref rid="vbad151-B36" ref-type="bibr">Sharma <italic toggle="yes">et al.</italic> 2021</xref>). Here, identical duplicates were removed leaving 765 allergen and 2015 non-allergen sequences. The second was a collection of allergens retrieved from Allergen Nomenclature (<xref rid="vbad151-B27" ref-type="bibr">Pomés <italic toggle="yes">et al.</italic> 2018</xref>), Allerbase (<xref rid="vbad151-B18" ref-type="bibr">Kadam <italic toggle="yes">et al.</italic> 2017</xref>), COMPARE (<xref rid="vbad151-B40" ref-type="bibr">van Ree <italic toggle="yes">et al.</italic> 2021</xref>), Allergome (<xref rid="vbad151-B20" ref-type="bibr">Mari and Riccioli 2004</xref>), and SDAP (<xref rid="vbad151-B17" ref-type="bibr">Ivanciuc <italic toggle="yes">et al.</italic> 2003</xref>) databases (on December 2021). Allergenic protein sequences that were identical to positive sequences in the training dataset were excluded. Next, the same procedure to collect non-allergens as for the training dataset was applied. This evaluation dataset contained 1065 positives and 4914 negative proteins (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec>
      <title>2.6 Evaluation metrics</title>
      <p>The performance of each model was evaluated by AUC, AUC 0.1, and positive predictive value (PPV). AUC 0.1 was calculated as the area integrated to a 10% false positive rate. For PPV, predicted values were first sorted in descending order, next PPV was obtained from the proportion of true positive targets within the top <italic toggle="yes">N</italic> predictions, where <italic toggle="yes">N</italic> was the number of allergens.</p>
      <p>In order to assess if the performance of the two models were significantly different, a <italic toggle="yes">P</italic>-value was calculated using bootstrapping. In this setup, a sample with replacement of the same size as the evaluation dataset was taken from the paired predictions from two models to determine whether the null hypothesis of the two models performing at par was rejected. This resampling was performed 10 000 times, and the <italic toggle="yes">P</italic>-value calculated by counting the occurrences of the AUC of one model was greater than that of another divided by the number of samplings.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Homology reduction pipeline</title>
      <p>One of the big and current challenges in machine learning approaches is data leakage, which originates from data used for the model to learn, with high redundancy to what is later evaluated on (<xref rid="vbad151-B12" ref-type="bibr">Gibney 2022</xref>). This issue not only overestimates model accuracy but also curbs its generalization and therefore hinders its prediction ability. In particular, the multiple allergen databases that exist contain a great number of homologous sequences or iso-allergens (<xref rid="vbad151-B18" ref-type="bibr">Kadam <italic toggle="yes">et al.</italic> 2017</xref>). While this redundancy may facilitate the task of finding homologous candidate allergens in unexplored species, it might derange the effort to find new allergen families or sequence-unrelated unknown allergens. Hence, we first developed a pipeline to efficiently remove and cluster similar sequences from the allergens dataset using BLAST sequence alignment and MST, which connects into single clusters all proteins sharing sequence similarity over a threshold.</p>
      <p>Allergen protein sequences were collected from AllergenOnline29 and filtered to remove atypically short and long sequences, highly redundant or identical sequences (detailed in Section 2, <xref rid="vbad151-F1" ref-type="fig">Fig. 1A</xref>). After this, 686 allergen sequences were clustered by MST using all-against-all BLAST sequence similarity <italic toggle="yes">E</italic>-values (≤1 × 10<sup>−10</sup>) to define neighbours (<xref rid="vbad151-F1" ref-type="fig">Fig. 1B</xref>). Since non-allergens are more abundant than allergens in the real scenario, we designed an imbalanced dataset to simulate the case, and expected the model would be able to learn and identify allergens from proteins. For non-allergens, we collected five protein sequences not annotated as allergens from the same species of each allergen as described in Section 2.1 (<xref rid="vbad151-F1" ref-type="fig">Fig. 1C</xref>).</p>
      <fig position="float" id="vbad151-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Data collection. (A) Positive data collection. Allergens were collected from the AllergenOnline database, filtered by length, and by similarity using Hobohm 1 algorithm. (B) Clustering. Clusters were generated using the MST algorithm and distances from BLAST all-against-all <italic toggle="yes">E</italic>-values. (C) Negative data collection. Non-allergen sequences (blue) were collected from NCBI and added in a 5:1 ratio to positive allergens (red) searching for the same species in each allergen. When more than five non-allergens meet the following criteria, matching keywords, length (range 20% allergen), and similarity (<italic toggle="yes">E</italic>-values), a random subset of the candidates that was selected. See Section 2 for details of data collection.</p>
        </caption>
        <graphic xlink:href="vbad151f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 MHC presentation propensity feature</title>
      <p>In order to induce Th2 responses and IgE production, allergens are first digested by APCs and selected peptides are presented on MHC-II complexes. Since allergy-related GWAS studies demonstrated that allergies have strong association to specific MHC class II alleles, we could suggest that the presentation of allergic peptides on those alleles is involved in the allergy development (<xref rid="vbad151-B22" ref-type="bibr">Moffatt <italic toggle="yes">et al.</italic> 2001</xref>, <xref rid="vbad151-B33" ref-type="bibr">Sakaguchi <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="vbad151-B39" ref-type="bibr">Van Overtvelt <italic toggle="yes">et al.</italic> 2008</xref>, <xref rid="vbad151-B7" ref-type="bibr">Dimitrov and Doytchinova 2016</xref>, <xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="vbad151-B25" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2019</xref>). Therefore, NetMHCIIpan was used to predict MHC presentation potential for allergens and non-allergens on a set of selected alleles based on the above-mentioned GWAS studies (<xref rid="vbad151-B30" ref-type="bibr">Reynisson <italic toggle="yes">et al.</italic> 2020b</xref>). The 10% threshold used in NetMHCIIpan was tested and exhibited improved feature AUC by 0.06 compared to the current default 5%. MHC-II presentation propensity was collected by adding the counts of predicted binders for a set of relevant alleles derived from genetic associations found in allergies (<xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="vbad151-B25" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2019</xref>). In particular, two features, binder 1 and binder 2, were created for grouping known positive (HLA-DRB1*04:01, HLA-DQA1*02:01-DQB1*02:02, HLA-DQA1*04:01-DQB1*03:01, HLA-DQA1*01:03-DQB1*06:01, HLA-DQA1*03:01-DQB1*03:02, HLA-DQA1*05:01-DQB1*02:01), and the ambiguous allele (HLA-DRB1*15:01), HLA-II allergenicity associations. HLA-DRB1*15:01 was separated as it was previously proposed in some allergies as a risk factor, while in others a protective allele (<xref rid="vbad151-B33" ref-type="bibr">Sakaguchi <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="vbad151-B39" ref-type="bibr">Van Overtvelt <italic toggle="yes">et al.</italic> 2008</xref>).</p>
      <p>In addition to MHC-II presentation propensity, previously described classification features for allergen/non-allergens were included. Those include amino acid compositions, physicochemical properties, structural features (alpha helix, beta sheets, and RSA), and evolutionary properties (see feature constructions in Section 2). Feature distributions for allergen and non-allergens were illustrated by boxplots for the most significant features displaying the median, quantiles, and densities of each set of data (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>). For binder 1, the <italic toggle="yes">t</italic>-statistic and <italic toggle="yes">P</italic>-value were 12.892 and 4.97 × 10<sup>−34</sup> respectively, indicating a higher MHC-II presentation propensity on allergens compared to non-allergens. Differences in binder 2 were not statistically significant, suggesting that HLA-DRB1*15:01 presentation propensity was not discriminative for this entire dataset. However, the HLA-DRB1*15:01 showed significant presentation preference for the Der p 1 family and Bet v 1 family, compared to other allergen families, such as the Tri a 36 (wheat) and Amb a 4 (short ragweed) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). When comparing the average residue weight, the <italic toggle="yes">t</italic>-test had a negative <italic toggle="yes">t</italic>-statistic value. These results suggested that allergens are characterized by a higher frequency of small-size amino acids. Likewise, allergens were found to be more likely hydrophilic and less hydrophobic, as previously described (<xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>), and containing less arginine and more aspartic acid. The <italic toggle="yes">t</italic>-statistic for alpha helix was negative, and beta sheet positive which indicated the allergens are depleted in alpha helices and enriched to beta sheets compared to non-allergens confirming previous observations (<xref rid="vbad151-B3" ref-type="bibr">Dall’Antonia <italic toggle="yes">et al.</italic> 2014</xref>).</p>
      <fig position="float" id="vbad151-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Distribution and individual-feature performances on selected features for allergens and non-allergens. <italic toggle="yes">T</italic>-test was used to compare the significant difference between allergens (red, A) and nonallergens (blue, NA). The AUC was calculated with feature values and the targets. ‘Small’ corresponds to the relative abundance of small-size amino acids (A, C, D, G, N, P, S, T, V) in a given protein sequence. Likewise, D and R correspond to the frequencies of aspartic acid and arginine per protein.</p>
        </caption>
        <graphic xlink:href="vbad151f2" position="float"/>
      </fig>
      <p>We next determined the AUC of all the individual features on the training dataset. Here, AUC values below 0.5 would suggest that allergic proteins have lower feature values than non-allergic proteins. As expected, the results of these analyses aligned with the <italic toggle="yes">t</italic>-statistics above, i.e. allergens had more MHC-II binder 1, more small-size amino acids, fewer alpha helices, more beta sheets, more hydrophilic proteins and contained more aspartic acid and less arginine (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Model development</title>
      <p>After showing that MHC presentation propensity is a discriminatory feature for allergens (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>), we sought to incorporate these features into machine learning models in order to improve the state-of-the-art allergenicity predictors. To effectively avoid overfitting, a 5-fold nested cross-validation scheme was performed (<xref rid="vbad151-F3" ref-type="fig">Fig. 3</xref>), and the best random forest hyperparameters were selected in the inner loop (<xref rid="vbad151-F3" ref-type="fig">Fig. 3B</xref>). MHC presentation propensity was combined with different sets of features, and optimal performance on the training data was obtained with a random forest model with 60 features (60F). The 60F model included MHC presentation propensity, physicochemical features, amino acid compositions, auto-covariances, and structural features (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>, for details refer to Section 2). Finally, the partitioning from MST was repeated 10 times using different random seeds and a final random forest model ensemble was generated. The ensemble model significantly outperformed most of the individual models in each random seed (<xref rid="vbad151-F3" ref-type="fig">Fig. 3D</xref>), therefore the ensemble scheme was applied to all the models.</p>
      <fig position="float" id="vbad151-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Model development pipeline of NetAllergen. (A) Partitioning. Five partitions randomly combining the clusters obtained from MST clustering were distributed using 10 different random seeds. Every allergen (red bar) and its five associated negatives (blue bars) share the same partition. (B) Cross-validation and ensemble prediction. A nested cross-validation setup was used using 5 folds in the outer layer and 4 folds in the inner layer. The final ensemble prediction is the mean of the 10 model predictions. (C) Internal redundancy tuning. The AUROC was evaluated on the minimal common subset (the dataset with a filter of 5). (D) Evaluation. Ensemble AUC (60F) was significantly higher than the individual partitions except when comparing to P2, which was not significant (<italic toggle="yes">P</italic>-value .152).</p>
        </caption>
        <graphic xlink:href="vbad151f3" position="float"/>
      </fig>
      <p>We next assessed removing sequences with a large number of other similar sequences to further cut out redundancy in the dataset (see Section 2). Here, cross-validation predictive performance was evaluated to find the optimal filter for removing the allergens with a higher number of neighbours in the tree network after MST clustering (<xref rid="vbad151-F3" ref-type="fig">Fig. 3C</xref>). The removal of highly connected vertices in the tree reduced the bias effect of highly similar sequences and improved the model performance. However, applying more stringent filters (removing vertices with fewer than 20 neighbours) caused a loss of informative allergen sequences as well as the performance. Hence, we applied a filter of 20 and removed the sequences that had more than 20 neighbours in the MST clusters.</p>
    </sec>
    <sec>
      <title>3.4 MHC presentation propensity is predictive</title>
      <p>Here, we picked the random forest model as feature importance can be calculated as the mean decrease of Gini impurity for each specific feature in all the trees. A higher value indicates a better split of the data using that feature. We explored the contribution of the different features in the random forest model of 60F and in a reduced model of 20F (only including MHC presentation propensity, structural properties, and physicochemical features, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S3 and S4</xref> for performance and feature compositions). MHC-II presentation propensity binder 1 was the most important feature in the simpler 20F model (<xref rid="vbad151-F4" ref-type="fig">Fig. 4A</xref>). The frequency of small amino acids (Small), average relative solvent accessibility (AvgRSA), binder 2, frequency of acidic amino acids, and alpha helix and beta sheet were also informative features to discriminate allergens and non-allergens (above the median of all feature importance). In the 60F model, although binder 1 was no longer the most important feature, it still played an important role in the prediction (<xref rid="vbad151-F4" ref-type="fig">Fig. 4B</xref>). In contrast, the binder 2 feature became less important in the 60F model. Further, the amino acid composition of arginine, aspartic acid, and lysine, together with the auto-covariance of PSSM on Glutamine (AC_Q) were found to be among the most discriminatory features in the 60F model.</p>
      <fig position="float" id="vbad151-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Median feature importance for RF models. Medians are calculated from cross-validation partitions and 10 random seeds in each random forest as the mean decrease of Gini impurity for (A) 20 features (20F) model, and (B) 60F model. Individual features were grouped into physicochemical properties (PCP, blue), hydropathy (HYD, pink), structural information (NSP, yellow), MHC-II presentation propensity (MHC, red), amino acid compositions (COMP, green), and evolutionary information (AC, purple). Average relative solvent accessibility (AvgRSA).</p>
        </caption>
        <graphic xlink:href="vbad151f4" position="float"/>
      </fig>
      <p>To further investigate the importance of MHC-II features, models removing the binder 1 and binder 2 were trained and evaluated using cross-validation. When the MHC-II features were removed from the 60F model, AUC was reduced from 0.912 to 0.911 and AUC 0.1 from 0.512 to 0.510 (<xref rid="vbad151-T1" ref-type="table">Table 1</xref>). For the 20F model however, when taking out the MHC presentation propensity features (18F), the reduction in prediction power was found to be significant for AUC and PPV. Additionally, the AUCs of 60F or 20F were both greater than AUC of any single feature (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>), which indicated that the model learnt features of allergens and benefited from the combination of features. Consistently with feature importance in those models, this result indicates that the addition of amino acid compositions and ACs could be correlated with MHC presentation propensity. By computing the feature space, the Pearson correlation coefficient suggested that the binder1 was strongly correlated to the alanine and negatively correlated to cysteine (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). These features contributed to the prediction when the MHC presentation propensity was absent, which led to no significant difference after the removal of binder features. The final 60F model was further evaluated based on the confusion matrix method as well. The threshold used for classifying allergens and non-allergen was 0.207 which was determined by the trade-off of sensitivity and specificity. Applied with this threshold, the sensitivity, specificity, and accuracy were 0.836, and MCCs were 0.572. It indicated the model was effectively able to capture the true positives from samples, however, misclassified false positives decreased the MCC.</p>
      <table-wrap position="float" id="vbad151-T1">
        <label>Table 1.</label>
        <caption>
          <p>Cross-validation performance of models with and without MHC-II features.<sup>a</sup></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Model</th>
              <th rowspan="1" colspan="1">AUC</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">P</italic>-value</th>
              <th rowspan="1" colspan="1">AUC0.1</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">P</italic>-value</th>
              <th rowspan="1" colspan="1">PPV</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">P</italic>-value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">58F</td>
              <td rowspan="1" colspan="1">0.911</td>
              <td rowspan="2" colspan="1">.022</td>
              <td rowspan="1" colspan="1">0.512</td>
              <td rowspan="2" colspan="1">.636</td>
              <td rowspan="1" colspan="1">0.657</td>
              <td rowspan="2" colspan="1">.633</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">60F</td>
              <td rowspan="1" colspan="1">0.912</td>
              <td rowspan="1" colspan="1">0.510</td>
              <td rowspan="1" colspan="1">0.650</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">18F</td>
              <td rowspan="1" colspan="1">0.855</td>
              <td rowspan="2" colspan="1">&lt;.001</td>
              <td rowspan="1" colspan="1">0.327</td>
              <td rowspan="2" colspan="1">.226</td>
              <td rowspan="1" colspan="1">0.518</td>
              <td rowspan="2" colspan="1">.035</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20F</td>
              <td rowspan="1" colspan="1">0.866</td>
              <td rowspan="1" colspan="1">0.336</td>
              <td rowspan="1" colspan="1">0.534</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>All <italic toggle="yes">P</italic>-values were obtained using bootstrapping. Models 60F (58F) and 20F (18F) do (not) contain MHC-II presentation propensity features. A random predictor has a PPV in 0.178 ± 0.029 by randomly shuffling the targets 10 000 times and calculating the PPV.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.5 Model comparison</title>
      <p>Sequence similarity to previously known allergens is the main driver of previously developed allergenicity predictors (<xref rid="vbad151-B11" ref-type="bibr">Fiers <italic toggle="yes">et al.</italic> 2004</xref>, <xref rid="vbad151-B10" ref-type="bibr">EFSA 2021</xref>). Therefore, we constructed a sequence similarity baseline model using BLAST. In the baseline model, the predicted value for each potential allergen from the evaluation datasets was taken from the best hit of BLAST against the training dataset. This baseline model was compared to the random forest model (60F) on the AlgPred 2 evaluation dataset (see Section 2). Overall, the baseline model had a higher performance (AUC of 0.923) on the full evaluation dataset compared to the random forest of 60F (AUC 0.886, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). This exceptional performance of the baseline model clearly suggests the high similarity between the allergens in the evaluation dataset and those in the training dataset. However, it is expected that the performance of the baseline model will decrease on unknown or remotely related allergen sequences. To quantify how model-performance correlates with sequence similarity to the training dataset, we sorted the sequences in the evaluation dataset from high to low similarity (negative log <italic toggle="yes">E</italic>-value, i.e. the predicted values of baseline model). We observed that the baseline model performed better than our 60F model for highly similar query entries to the training data with maximum difference of 0.043, but that dropped dramatically when sequence similarity decreased (<xref rid="vbad151-F5" ref-type="fig">Fig. 5</xref>). On the contrary, the 60F model demonstrated a more robust AUC performance on all the dataset and outperformed the baseline model on proteins that were less similar (<italic toggle="yes">E</italic>-value &gt; 1 × 10<sup>−51</sup>) to sequences in the allergen database (<xref rid="vbad151-F5" ref-type="fig">Fig. 5A</xref>). The same trend was observed for AUC 0.1 (<xref rid="vbad151-F5" ref-type="fig">Fig. 5B</xref>).</p>
      <fig position="float" id="vbad151-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Model performance for variable datasets with decreasing similarity thresholds on AlgPred2 evaluation dataset. The sequences were sorted by similarities against allergens in the training dataset with a descending order. The vertical line indicates the changes of performance and split the curves into areas of higher and lower similarities. For the rightmost curve, the number of sequences reduced as the decreasing similarity, which led to that the evaluation was less robust because of noise. (A) AUC. (B) AUC 0.1.</p>
        </caption>
        <graphic xlink:href="vbad151f5" position="float"/>
      </fig>
      <p>In order to compare to state-of-the-art allergenicity predictors, we next benchmarked the random forest model against AlgPred 2 (<xref rid="vbad151-B36" ref-type="bibr">Sharma <italic toggle="yes">et al.</italic> 2021</xref>). Since AlgPred 2 was available in a re-trained format using the evaluation dataset used in their publication, we collected a second and independent evaluation dataset from other allergen databases (detailed information in Section 2). As in the earlier benchmark, the new independent validation set was ranked in the same method with <italic toggle="yes">E</italic>-values against the allergens in the combined datasets of the cross-validation and AlgPred 2. Both AUC and AUC 0.1 performances were assessed in the identical approach and behaved similarly as before, showing a higher performance of AlgPred 2 and baseline model for the highly similar sequences (<xref rid="vbad151-F6" ref-type="fig">Fig. 6</xref>). In a similar fashion, both AlgPred 2 and BLAST performances dropped below that of the 60F model when similarity to training-allergens <italic toggle="yes">E</italic>-values were higher than 1 × 10<sup>−59</sup>. This result suggests the 60F model had superior predictive power on novel sequences which were not included in current allergen databases.</p>
      <fig position="float" id="vbad151-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Model performance with different similarity thresholds on the new evaluation dataset. The similarities were represented by −log(<italic toggle="yes">E</italic>-value) which were obtained from the baseline model (BLAST). The searching database consisted of the positive sequences from our and AlgPred2 dataset. The noise in decreasing data size led to the less robust curves at the rightmost part. (A) AUC. (B) AUC0.1.</p>
        </caption>
        <graphic xlink:href="vbad151f6" position="float"/>
      </fig>
      <p>The analysis of model comparisons indicated that BLAST demonstrates good performance when applied to similar protein sequences, while 60F excelled in handling dissimilar sequences. Hence, the ultimate model was the combination of BLAST and 60F. To select the optimal threshold (1 × 10<sup>−16</sup>) of when to use BLAST or the 60F model, we picked the <italic toggle="yes">E</italic>-value based on AUC0.1 reflecting how well a model predicts positive data. If a query sequence has lower similarity (or a higher <italic toggle="yes">E</italic>-value) than the threshold, we use the 60F to predict the allergenicity.</p>
      <p>The 60F random forest model with BLAST was deployed as a web server. The allergenicity predictor is available at <ext-link xlink:href="https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0" ext-link-type="uri">https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0</ext-link>. The program accepts a FASTA file of protein sequences and provides a prediction result table (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Understanding the nature of allergenicity is of high importance as it contributes to the development of future diagnostic tools and therapeutic strategies. Previous allergen predictors have focused on answering the question of what makes an allergen. By introducing HLA presentation propensity, we proposed a first attempt to answer the question of why only some individuals develop allergies towards ubiquitous proteins. Here, we have developed a new allergen predictor called NetAllergen which incorporates a novel significant feature regarding MHC class II presentation on a set of particular susceptible alleles, suggesting allergenicity may relate to presentation on particular subset of HLA class II alleles. NetAllergen was trained on a carefully curated dataset where redundant allergen sequences were removed. Due to the accessibility of both program/web service and training dataset, AlgPred 2 was the only accessible tool used for benchmark. NetAllergen was demonstrated to perform better than a state-of-the-art predictor AlgPred 2, and a baseline model when sequence similarity towards known allergens is reduced.</p>
    <p>Although it has long been recognized that allergy has a strong HLA association component (<xref rid="vbad151-B788201127" ref-type="bibr">Levine <italic toggle="yes">et al.</italic> 1972</xref>) still very little is known about the mechanisms that trigger allergy. Recently, large GWAS pointed to conserved specific amino acid positions in the HLA-II binding groove determining protective or risk variants for certain allergies (<xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>). This observation suggests that MHC-II presentation in those alleles might have an important role in allergy. Consequently, we have hypothesized that allergens might have a high quantity of presentation motifs towards those specific alleles compared to non-allergens. Here, we showed that this is indeed the case. HLA allele presentation propensity in binder 1 was one of the strongly discriminant features for allergens (AUC = 0.68). In addition, incorporation of this novel HLA presentation propensity feature with other structural features, amino acid compositions, etc., into random forest models achieved good performance for allergenicity prediction.</p>
    <p>The advantage of random forest compared to other more complex models in machine learning is its ease of interpretability. Therefore, we have picked this simple model to better analyze feature importance. Once more, MHC presentation propensity binder 1 was found to be one of the most important features when analyzing which features best split the data in the random forest. Moreover, removing MHC class II presentation features from the model (20F) significantly reduced performance compared to a model including those features. This suggested that MHC-II presentation is an informative classification allergen feature. However, when incorporating additional features such as amino acid compositions, and evolutionary information of the amino acids, those improvements were only moderate. In the 60F models, arginine frequency was the most important feature followed by MHC-II presentation binder 1, auto-covariance of glutamine (AC_Q), and amino acid compositions of aspartic acid, leucine, cysteine, and lysine. While MHC-II presentation features are based on the count of presentation motifs to specific MHC-II alleles, the amino acid compositions count the percentage of amino acids in a protein sequence. They both capture important amino acids information in two distinct approaches, explaining why the 60F model did not show significant improvements against the 58F model.</p>
    <p>In addition to the MHC-II binders, the average residue weight was negatively correlated to allergenicity and small amino acids composition (A, C, D, G, N, P, S, T, V) had positive correlation. In particular, threonine and valine are branched on the beta-carbon and thus are more often found on beta strands than in alpha helices. On the other hand, proline is disfavoured on alpha helices as its amino ring is not able to adopt normal helical main chain conformations (<xref rid="vbad151-B2" ref-type="bibr">Betts and Russell 2003</xref>). These findings align with previous observations that allergens have a higher abundance of beta sheets and less alpha helices compared to non-allergens (<xref rid="vbad151-B3" ref-type="bibr">Dall’Antonia <italic toggle="yes">et al.</italic> 2014</xref>).</p>
    <p>AC represents the average covariance between the sequence and itself. Hence, the coefficients of AC_Q indicated that glutamine might be present in a large number of repetitions in the sequence. This information suggested by AC of glutamine was similar to the Q-repeats features used in AllerCatPro, thus aligning with previous findings for allergens (<xref rid="vbad151-B21" ref-type="bibr">Maurer-Stroh <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>A concept of allergen-like putative non-allergen (APN) was proposed and has been used in several researches (<xref rid="vbad151-B23" ref-type="bibr">Muh <italic toggle="yes">et al.</italic> 2009</xref>, <xref rid="vbad151-B4" ref-type="bibr">Dang and Lawrence 2014</xref>, <xref rid="vbad151-B34" ref-type="bibr">Saravanan and Lakshmi 2014</xref>). The APNs were described as the proteins with identity greater than 30% and not annotated with allergen-related terms. However, most of sequences which are not in allergen database lack allergenicity-related experiments to be definitely defined as non-allergens. Incorporating these sequences might be able to expand the model scope and improve its capacity to distinguish allergens. In the <italic toggle="yes">Chironomus thummi</italic> example (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), the Q23763 and P11582 were found not containing any allergen-related annotation in Swiss-Prot, and they respectively had 95% and 68% identity to known allergen 216_1 (P84298) and 218_1 (P02226). Compared to the known allergens, the former one had several point mutations and the latter one shared identical structure. Hence, it was likely to introduce mislabelling issues without definite evidence, and we used sequence similarity for negative data collection in this work. The APN dataset needs to be further analyzed and can be incorporated in future work.</p>
    <p>Many important applications in bioinformatics, including sequence alignment and machine learning algorithms, employ sequence weighting schemes to mitigate the effects of non-independent homologous sequences over-represented in a dataset (<xref rid="vbad151-B24" ref-type="bibr">Nielsen <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="vbad151-B5" ref-type="bibr">De Maio <italic toggle="yes">et al.</italic> 2021</xref>). In particular, allergen datasets are highly redundant as many homologous proteins are discovered in closely related species. Moreover, strict sequence similarity guidelines proposed by the FAO/WHO to assess allergenicity <italic toggle="yes">in silico</italic> may have favoured the discovery of iso-allergens. As part of the development of NetAllergen, we have proposed a novel pipeline to deal with highly redundant datasets and avoid data leakage issues. Here, we have showcased how this pipeline can be applied to real-life datasets aiding the development of data-driven prediction methods. We believe this proposed pipeline to be broadly applicable and expect it to be of general use for the community.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad151_Supplementary_Data</label>
      <media xlink:href="vbad151_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Author contributions</title>
    <p>Y.L. collected the data, developed the pipeline, trained the models, analyzed and interpreted the data; P.W.S. created the web server; M.N. analyzed and interpreted the data, provided critical revision of the article; and C.B. analyzed and interpreted the data, provided critical revision of the article, and conceived the work. All authors wrote the article and approved the final version to be published.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data and scripts used in this manuscript are available at the web server link: <ext-link xlink:href="https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0" ext-link-type="uri">https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad151-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Gish</surname><given-names>W</given-names></string-name>, <string-name><surname>Miller</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source><year>1990</year>;<volume>215</volume>:<fpage>403</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Betts</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Russell</surname><given-names>RB.</given-names></string-name></person-group><part-title>Amino acid properties and consequences of substitutions</part-title>. In<italic toggle="yes">:</italic> Barnes, M.R. and Gray, I.C. (eds) <source>Bioinformatics for Geneticists</source>. <publisher-name>John Wiley &amp; Sons, Ltd.</publisher-name>, <year>2003</year>, <fpage>289</fpage>–<lpage>316</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad151-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dall’Antonia</surname><given-names>F</given-names></string-name>, <string-name><surname>Pavkov-Keller</surname><given-names>T</given-names></string-name>, <string-name><surname>Zangger</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Structure of allergens and structure based epitope predictions</article-title>. <source>Methods San Diego Calif</source><year>2014</year>;<volume>66</volume>:<fpage>3</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23891546</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dang</surname><given-names>HX</given-names></string-name>, <string-name><surname>Lawrence</surname><given-names>CB.</given-names></string-name></person-group><article-title>Allerdictor: fast allergen prediction using text classification techniques</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>1120</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">24403538</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Maio</surname><given-names>N</given-names></string-name>, <string-name><surname>Alekseyenko</surname><given-names>AV</given-names></string-name>, <string-name><surname>Coleman-Smith</surname><given-names>WJ</given-names></string-name></person-group><etal>et al</etal><article-title>A phylogenetic approach for weighting genetic sequences</article-title>. <source>BMC Bioinformatics</source><year>2021</year>;<volume>22</volume>:<fpage>285</fpage>.<pub-id pub-id-type="pmid">34049487</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Bangov</surname><given-names>I</given-names></string-name>, <string-name><surname>Flower</surname><given-names>DR</given-names></string-name></person-group><etal>et al</etal><article-title>AllerTOP v.2—a server for in silico prediction of allergens</article-title>. <source>J Mol Model</source><year>2014a</year>;<volume>20</volume>:<fpage>2278</fpage>.<pub-id pub-id-type="pmid">24878803</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Doytchinova</surname><given-names>I.</given-names></string-name></person-group><article-title>Associations between milk and egg allergens and the HLA-DRB1/DQ polymorphism: a bioinformatics approach</article-title>. <source>Int Arch Allergy Immunol</source><year>2016</year>;<volume>169</volume>:<fpage>33</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">26953725</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Flower</surname><given-names>DR</given-names></string-name>, <string-name><surname>Doytchinova</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>AllerTOP—a server for in silico prediction of allergens</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>(<issue>Suppl 6</issue>):<fpage>S4</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad151-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Naneva</surname><given-names>L</given-names></string-name>, <string-name><surname>Doytchinova</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>AllergenFP: allergenicity prediction by descriptor fingerprints</article-title>. <source>Bioinformatics</source><year>2014b</year>;<volume>30</volume>:<fpage>846</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">24167156</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B10">
      <mixed-citation publication-type="journal"><collab>EFSA</collab>. Workshop on allergenicity assessment—prediction. <source>EFSA J</source><year>2021</year>;<volume>18</volume>:EN-6826.</mixed-citation>
    </ref>
    <ref id="vbad151-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fiers</surname><given-names>MWEJ</given-names></string-name>, <string-name><surname>Kleter</surname><given-names>GA</given-names></string-name>, <string-name><surname>Nijland</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Allermatch, a webtool for the prediction of potential allergenicity according to current FAO/WHO Codex alimentarius guidelines</article-title>. <source>BMC Bioinformatics</source><year>2004</year>;<volume>5</volume>:<fpage>133</fpage>.<pub-id pub-id-type="pmid">15373946</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibney</surname><given-names>E.</given-names></string-name></person-group><article-title>Could machine learning fuel a reproducibility crisis in science?</article-title><source>Nature</source><year>2022</year>;<volume>608</volume>:<fpage>250</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">35883008</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goodman</surname><given-names>RE</given-names></string-name>, <string-name><surname>Ebisawa</surname><given-names>M</given-names></string-name>, <string-name><surname>Ferreira</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>AllergenOnline: a peer-reviewed, curated allergen database to assess novel food proteins for potential cross-reactivity</article-title>. <source>Mol Nutr Food Res</source><year>2016</year>;<volume>60</volume>:<fpage>1183</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">26887584</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hobohm</surname><given-names>U</given-names></string-name>, <string-name><surname>Scharf</surname><given-names>M</given-names></string-name>, <string-name><surname>Schneider</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Selection of representative protein data sets</article-title>. <source>Protein Sci</source><year>1992</year>;<volume>1</volume>:<fpage>409</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">1304348</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Høie</surname><given-names>MH</given-names></string-name>, <string-name><surname>Kiehl</surname><given-names>EN</given-names></string-name>, <string-name><surname>Petersen</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>NetSurfP-3.0: accurate and fast prediction of protein structural features by protein language models and deep learning</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W510</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">35648435</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ivanciuc</surname><given-names>O</given-names></string-name>, <string-name><surname>Schein</surname><given-names>CH</given-names></string-name>, <string-name><surname>Braun</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Data mining of sequences and 3D structures of allergenic proteins</article-title>. <source>Bioinformatics</source><year>2002</year>;<volume>18</volume>:<fpage>1358</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">12376380</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ivanciuc</surname><given-names>O</given-names></string-name>, <string-name><surname>Schein</surname><given-names>CH</given-names></string-name>, <string-name><surname>Braun</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>SDAP: database and computational tools for allergenic proteins</article-title>. <source>Nucleic Acids Res</source><year>2003</year>;<volume>31</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">12520022</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kadam</surname><given-names>K</given-names></string-name>, <string-name><surname>Karbhal</surname><given-names>R</given-names></string-name>, <string-name><surname>Jayaraman</surname><given-names>VK</given-names></string-name></person-group><etal>et al</etal><article-title>AllerBase: a comprehensive allergen knowledgebase</article-title>. <source>Database</source><year>2017</year>;<volume>2017</volume>:<fpage>bax066</fpage>.<pub-id pub-id-type="pmid">29220458</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B788201127">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>BB</given-names>, </string-name>, <string-name><surname>Stember</surname><given-names>RH</given-names>, </string-name>, <string-name><surname>Fotino</surname><given-names>M.</given-names></string-name></person-group><article-title>Ragweed hay fever: genetic control and linkage to HL-A haplotypes</article-title>. <source>Science</source><year>1972</year>;<volume>178</volume>:<fpage>1201</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">4637806</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marenholz</surname><given-names>I</given-names></string-name>, <string-name><surname>Grosche</surname><given-names>S</given-names></string-name>, <string-name><surname>Kalb</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide association study identifies the SERPINB gene cluster as a susceptibility locus for food allergy</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>1056</fpage>.<pub-id pub-id-type="pmid">29051540</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mari</surname><given-names>A</given-names></string-name>, <string-name><surname>Riccioli</surname><given-names>D.</given-names></string-name></person-group><article-title>The allergome web site—a database of allergenic molecules. Aim, structure, and data of a web-based resource</article-title>. <source>J. Allergy Clin. Immunol</source><year>2004</year>;<volume>113</volume>:<fpage>S301</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad151-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maurer-Stroh</surname><given-names>S</given-names></string-name>, <string-name><surname>Krutz</surname><given-names>NL</given-names></string-name>, <string-name><surname>Kern</surname><given-names>PS</given-names></string-name></person-group><etal>et al</etal><article-title>AllerCatPro—prediction of protein allergenicity potential from the protein sequence</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>3020</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30657872</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffatt</surname><given-names>MF</given-names></string-name>, <string-name><surname>Schou</surname><given-names>C</given-names></string-name>, <string-name><surname>Faux</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>Association between quantitative traits underlying asthma and the HLA-DRB1 locus in a family-based population sample</article-title>. <source>Eur J Hum Genet</source><year>2001</year>;<volume>9</volume>:<fpage>341</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">11378822</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muh</surname><given-names>HC</given-names></string-name>, <string-name><surname>Tong</surname><given-names>JC</given-names></string-name>, <string-name><surname>Tammi</surname><given-names>MT</given-names></string-name></person-group><etal>et al</etal><article-title>AllerHunter: a SVM-Pairwise system for assessment of allergenicity and allergic cross-reactivity in proteins</article-title>. <source>PLoS One</source><year>2009</year>;<volume>4</volume>:<fpage>e5861</fpage>.<pub-id pub-id-type="pmid">19516900</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>H</given-names></string-name>, <string-name><surname>Tsirigos</surname><given-names>KD</given-names></string-name>, <string-name><surname>Brunak</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>A brief history of protein sorting prediction</article-title>. <source>Protein J</source><year>2019</year>;<volume>38</volume>:<fpage>200</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">31119599</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noguchi</surname><given-names>E</given-names></string-name>, <string-name><surname>Akiyama</surname><given-names>M</given-names></string-name>, <string-name><surname>Yagami</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>HLA-DQ and RBFOX1 as susceptibility genes for an outbreak of hydrolyzed wheat allergy</article-title>. <source>J Allergy Clin Immunol</source><year>2019</year>;<volume>144</volume>:<fpage>1354</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">31301374</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noguchi</surname><given-names>E</given-names></string-name>, <string-name><surname>Sakamoto</surname><given-names>H</given-names></string-name>, <string-name><surname>Hirota</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide association study identifies HLA-DP as a susceptibility gene for pediatric asthma in Asian populations</article-title>. <source>PLoS Genet</source><year>2011</year>;<volume>7</volume>:<fpage>e1002170</fpage>.<pub-id pub-id-type="pmid">21814517</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pomés</surname><given-names>A</given-names></string-name>, <string-name><surname>Davies</surname><given-names>JM</given-names></string-name>, <string-name><surname>Gadermaier</surname><given-names>G</given-names></string-name></person-group>, <etal>et al</etal>; <collab>WHO IUIS Allergen Nomenclature Sub-Committee</collab>. <article-title>WHO/IUIS allergen nomenclature: providing a common language</article-title>. <source>Mol. Immunol</source><year>2018</year>;<volume>100</volume>:<fpage>3</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">29625844</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Refahi</surname><given-names>MS</given-names></string-name>, <string-name><surname>Mir</surname><given-names>A</given-names></string-name>, <string-name><surname>Nasiri</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>A novel fusion based on the evolutionary features for protein fold recognition using support vector machines</article-title>. <source>Sci Rep</source><year>2020</year>;<volume>10</volume>:<fpage>14368</fpage>.<pub-id pub-id-type="pmid">32873824</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynisson</surname><given-names>B</given-names></string-name>, <string-name><surname>Alvarez</surname><given-names>B</given-names></string-name>, <string-name><surname>Paul</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>NetMHCpan-4.1 and NetMHCIIpan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title>. <source>Nucleic Acids Res</source><year>2020a</year>;<volume>48</volume>:<fpage>W449</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">32406916</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynisson</surname><given-names>B</given-names></string-name>, <string-name><surname>Barra</surname><given-names>C</given-names></string-name>, <string-name><surname>Kaabinejadian</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Improved prediction of MHC II antigen presentation through integration and motif deconvolution of mass spectrometry MHC eluted ligand data</article-title>. <source>J Proteome Res</source><year>2020b</year>;<volume>19</volume>:<fpage>2304</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">32308001</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Riaz</surname><given-names>T</given-names></string-name>, <string-name><surname>Hor</surname><given-names>HL</given-names></string-name>, <string-name><surname>Krishnan</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>WebAllergen: a web server for predicting allergenic proteins</article-title>. <source>Bioinformatics</source><year>2005</year>;<volume>21</volume>:<fpage>2570</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">15746289</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saha</surname><given-names>S</given-names></string-name>, <string-name><surname>Raghava</surname><given-names>GPS.</given-names></string-name></person-group><article-title>AlgPred: prediction of allergenic proteins and mapping of IgE epitopes</article-title>. <source>Nucleic Acids Res</source><year>2006</year>;<volume>34</volume>:<fpage>W202</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">16844994</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sakaguchi</surname><given-names>M</given-names></string-name>, <string-name><surname>Nakayama</surname><given-names>T</given-names></string-name>, <string-name><surname>Kaku</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Analysis of HLA in children with gelatin allergy</article-title>. <source>Tissue Antigens</source><year>2002</year>;<volume>59</volume>:<fpage>412</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">12144625</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saravanan</surname><given-names>V</given-names></string-name>, <string-name><surname>Lakshmi</surname><given-names>P.</given-names></string-name></person-group><article-title>Fuzzy logic for personalized healthcare and diagnostics: fuzzyApp—a fuzzy logic based allergen-protein predictor</article-title>. <source>Omics</source><year>2014</year>;<volume>18</volume>:<fpage>570</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">25025745</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheurer</surname><given-names>S</given-names></string-name>, <string-name><surname>Toda</surname><given-names>M</given-names></string-name>, <string-name><surname>Vieths</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>What makes an allergen?</article-title><source>Clin Exp Allergy</source><year>2015</year>;<volume>45</volume>:<fpage>1150</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">25989479</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sharma</surname><given-names>N</given-names></string-name>, <string-name><surname>Patiyal</surname><given-names>S</given-names></string-name>, <string-name><surname>Dhall</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>AlgPred 2.0: an improved method for predicting allergenic proteins and mapping of IgE epitopes</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:bbaa294.</mixed-citation>
    </ref>
    <ref id="vbad151-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sicherer</surname><given-names>SH</given-names></string-name>, <string-name><surname>Sampson</surname><given-names>HA.</given-names></string-name></person-group><article-title>Food allergy: a review and update on epidemiology, pathogenesis, diagnosis, prevention, and management</article-title>. <source>J Allergy Clin Immunol</source><year>2018</year>;<volume>141</volume>:<fpage>41</fpage>–<lpage>58</lpage>.<pub-id pub-id-type="pmid">29157945</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Du Toit</surname><given-names>G</given-names></string-name>, <string-name><surname>Tsakok</surname><given-names>T</given-names></string-name>, <string-name><surname>Lack</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Prevention of food allergy</article-title>. <source>J Allergy Clin Immunol</source><year>2016</year>;<volume>137</volume>:<fpage>998</fpage>–<lpage>1010</lpage>.<pub-id pub-id-type="pmid">27059727</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Overtvelt</surname><given-names>L</given-names></string-name>, <string-name><surname>Wambre</surname><given-names>E</given-names></string-name>, <string-name><surname>Maillère</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of bet v 1-Specific CD4+ T cell responses in allergic and nonallergic individuals using MHC class II peptide Tetramers1</article-title>. <source>J Immunol</source><year>2008</year>;<volume>180</volume>:<fpage>4514</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">18354173</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Ree</surname><given-names>R</given-names></string-name>, <string-name><surname>Sapiter Ballerda</surname><given-names>D</given-names></string-name>, <string-name><surname>Berin</surname><given-names>MC</given-names></string-name></person-group><etal>et al</etal><article-title>The COMPARE database: a public resource for allergen identification, adapted for continuous improvement</article-title>. <source>Front Allergy</source><year>2021</year>;<volume>2</volume>:<fpage>700533</fpage>.<pub-id pub-id-type="pmid">35386979</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waage</surname><given-names>J</given-names></string-name>, <string-name><surname>Standl</surname><given-names>M</given-names></string-name>, <string-name><surname>Curtin</surname><given-names>JA</given-names></string-name></person-group>, <etal>et al</etal>; <collab>AAGC collaborators</collab>. <article-title>Genome-wide association and HLA fine-mapping studies identify risk loci and genetic pathways underlying allergic rhinitis</article-title>. <source>Nat Genet</source><year>2018</year>;<volume>50</volume>:<fpage>1072</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">30013184</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>L</given-names></string-name>, <string-name><surname>Fu</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Research progress in atopic march</article-title>. <source>Front Immunol</source><year>2020</year>;<volume>11</volume>:<fpage>1907</fpage>.<pub-id pub-id-type="pmid">32973790</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>W</given-names></string-name>, <string-name><surname>Freeland</surname><given-names>DMH</given-names></string-name>, <string-name><surname>Nadeau</surname><given-names>KC</given-names></string-name></person-group><etal>et al</etal><article-title>Food allergy: immune mechanisms, diagnosis and immunotherapy</article-title>. <source>Nat Rev Immunol</source><year>2016</year>;<volume>16</volume>:<fpage>751</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">27795547</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>ZH</given-names></string-name>, <string-name><surname>Koh</surname><given-names>JLY</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>GL</given-names></string-name></person-group><etal>et al</etal><article-title>AllerTool: a web server for predicting allergenicity and allergic cross-reactivity in proteins</article-title>. <source>Bioinformatics</source><year>2007</year>;<volume>23</volume>:<fpage>504</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">17150996</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10603389</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad151</article-id>
    <article-id pub-id-type="publisher-id">vbad151</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Immunoinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NetAllergen, a random forest model integrating MHC-II presentation propensity for improved allergenicity prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yuchen</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sackett</surname>
          <given-names>Peter Wad</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7885-4311</contrib-id>
        <name>
          <surname>Nielsen</surname>
          <given-names>Morten</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
        <aff><institution>Instituto de Investigaciones Biotecnológicas, Universidad Nacional de San Martín</institution>, San Martin 1650, <country country="AR">Argentina</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6836-4906</contrib-id>
        <name>
          <surname>Barra</surname>
          <given-names>Carolina</given-names>
        </name>
        <aff><institution>Department of Health Technology, Technical University of Denmark</institution>, Kgs. Lyngby, Copenhagen 2800, <country country="DK">Denmark</country></aff>
        <xref rid="vbad151-cor1" ref-type="corresp"/>
        <!--carolet@dtu.dk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad151-cor1">Corresponding author. Department of Health Technology, Technical University of Denmark, Kgs. Lyngby, Copenhagen 2800, Denmark. E-mail: <email>carolet@dtu.dk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-10-16">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad151</elocation-id>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>26</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad151.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Allergy is a pathological immune reaction towards innocuous protein antigens. Although only a narrow fraction of plant or animal proteins induce allergy, atopic disorders affect millions of children and adults and cost billions in healthcare systems worldwide. <italic toggle="yes">In silico</italic> predictors can aid in the development of more innocuous food sources. Previous allergenicity predictors used sequence similarity, common structural domains, and amino acid physicochemical features. However, these predictors strongly rely on sequence similarity to known allergens and fail to predict protein allergenicity accurately when similarity diminishes.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To overcome these limitations, we collected allergens from AllergenOnline, a curated database of IgE-inducing allergens, carefully removed allergen redundancy with a novel protein partitioning pipeline, and developed a new allergen prediction method, introducing MHC presentation propensity as a novel feature. NetAllergen outperformed a sequence similarity-based BLAST baseline approach, and previous allergenicity predictor AlgPred 2 when similarity to known allergens is limited.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The web service NetAllergen and the datasets are available at <ext-link xlink:href="https://services.healthtech.dtu.dk/services/NetAllergen-1.0/" ext-link-type="uri">https://services.healthtech.dtu.dk/services/NetAllergen-1.0/</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Currently, allergy affects as many as 20% of the worldwide population (<xref rid="vbad151-B42" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2020</xref>). Moreover, the prevalence of allergic diseases has increased in the past decades, and it is likely to rise in the future (<xref rid="vbad151-B37" ref-type="bibr">Sicherer and Sampson 2018</xref>).</p>
    <p>Allergy is characterized by a pathological immune reaction, triggered by normally ubiquitous and innocuous protein antigens in susceptible individuals (<xref rid="vbad151-B42" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2020</xref>). In addition, allergy is a wide terminology that encompasses a number of diseases primarily sharing an IgE-dependent pathway (<xref rid="vbad151-B43" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2016</xref>). Once the allergen contacts the skin or mucosal tissues, antigen-presenting cells (APCs) uptake and digest allergens into small peptides. Peptides with specific motifs are next presented by the major histocompatibility complex (MHC) class II molecules to activate type 2T helper (Th2) cells. In susceptible individuals, Th2 cells further stimulate B cells to produce IgE antibodies in the first sensitization stage. An individual develops an allergy when the immune system is re-exposed to the allergen. The reasons why only a small number of proteins induce allergy is largely unknown. However, it has been suggested that allergens share specific features that, according to the route and level of exposure, genetic predisposition, and environmental factors, can develop into allergies (<xref rid="vbad151-B35" ref-type="bibr">Scheurer <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="vbad151-B38" ref-type="bibr">du Toit <italic toggle="yes">et al.</italic> 2016</xref>).</p>
    <p>Recently, genome-wide association studies (GWAS) have revealed that several allergies are strongly associated with specific HLA alleles, in particular for HLA-DQ and HLA-DRB (<xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>). For example, allergic rhinitis has shown a strong association with HLA-DRB1*04:01, HLA-DQB1*02:02, and HLA-DQB1*03:01 (<xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>). HLA-DQA1*01:03-DQB1*06:01 was found to be associated with wheat allergy, and patients who had celiac diseases carried HLA-DQA1*05:01-DQB1*02:01 and HLA-DQA1*03:01-DQB1*03:02 (<xref rid="vbad151-B25" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2019</xref>). In allergic respiratory disease studies, HLA-DRB1*15:01 has been found to be associated with mite (<xref rid="vbad151-B22" ref-type="bibr">Moffatt <italic toggle="yes">et al.</italic> 2001</xref>) and birch pollen allergens (<xref rid="vbad151-B39" ref-type="bibr">Van Overtvelt <italic toggle="yes">et al.</italic> 2008</xref>). However, the same allele was negatively associated with gelatine (<xref rid="vbad151-B33" ref-type="bibr">Sakaguchi <italic toggle="yes">et al.</italic> 2002</xref>) and cow’s milk (<xref rid="vbad151-B7" ref-type="bibr">Dimitrov and Doytchinova 2016</xref>). Additionally, GWAS studies also suggest that specific amino acid positions in the peptide binding groove shared among different alleles provide susceptibility or protection against different types of allergies (<xref rid="vbad151-B26" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>). Together these findings strongly suggest that differential MHC-II presentation is involved in allergy.</p>
    <p>Various methods have been utilized to identify common patterns in allergens and predict their allergenicity. Initially, relational databases were used to cluster allergens based on their protein sequence or shared structural domains, biochemical, and functional properties (<xref rid="vbad151-B16" ref-type="bibr">Ivanciuc <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="vbad151-B17" ref-type="bibr">2003, Scheurer <italic toggle="yes">et al.</italic> 2015</xref>). Both Blast and Allermatch, another sequence-comparing method, were used to find shared amino acid segments and search query sequences against allergen databases, respectively (<xref rid="vbad151-B11" ref-type="bibr">Fiers <italic toggle="yes">et al.</italic> 2004</xref>, <xref rid="vbad151-B44" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2007</xref>). Later, motif-profile predictions improved prediction by searching for similarities in potential functional domains (<xref rid="vbad151-B31" ref-type="bibr">Riaz <italic toggle="yes">et al.</italic> 2005</xref>). Machine-learning-based methods including features, such as known IgE epitopes, peptide motifs, and dipeptide compositions, have also been widely applied to predict allergenicity (<xref rid="vbad151-B32" ref-type="bibr">Saha and Raghava 2006</xref>, <xref rid="vbad151-B23" ref-type="bibr">Muh <italic toggle="yes">et al.</italic> 2009</xref>). These include Allerdictor, which uses K-mer frequencies in a support vector machine (SVM) (<xref rid="vbad151-B4" ref-type="bibr">Dang and Lawrence 2014</xref>), and AllergenFP based on Tanimoto coefficient similarity search (<xref rid="vbad151-B9" ref-type="bibr">Dimitrov <italic toggle="yes">et al.</italic> 2014b</xref>). FuzzyApp integrates sequence and motif similarity, and other amino acid features in a SVM, introducing fuzzy logic to handle multiple non-binary results (<xref rid="vbad151-B34" ref-type="bibr">Saravanan and Lakshmi 2014</xref>). Q-repeats, 3D structural similarities, and sequential similarities were incorporated into the decision tree in AllerCatPro (<xref rid="vbad151-B21" ref-type="bibr">Maurer-Stroh <italic toggle="yes">et al.</italic> 2019</xref>). The auto- and cross-covariance of amino acids in a sequence were adopted in AllerTOP v2 (<xref rid="vbad151-B8" ref-type="bibr">Dimitrov <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="vbad151-B6" ref-type="bibr">Dimitrov <italic toggle="yes">et al.</italic> 2014a</xref>). AlgPred 2 predicts sequences with hybrid scores by integrating BLAST, and motif features using a random forest model (<xref rid="vbad151-B36" ref-type="bibr">Sharma <italic toggle="yes">et al.</italic> 2021</xref>). However, to the best of our knowledge, no predictor has used MHC presentation in allergenicity prediction.</p>
    <p>In this study, we developed a random forest predictor, NetAllergen, using MHC class II peptide presentation propensity for HLA-DR and HLA-DQ alleles in combination with physicochemical properties, structural information, and evolutionary information. We investigated and validated the relevance of MHC presentation propensity and other features for allergenicity predictions. NetAllergen was benchmarked against a sequence-based BLAST model and other state-of-the-art predictors and demonstrated to achieve higher performance, particularly for allergens that share limited similarity to previously known allergens.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Training dataset</title>
      <p>On September 2020, 2171 allergen protein IDs were retrieved from AllergenOnline, a curated database of IgE-producing allergens (<xref rid="vbad151-B13" ref-type="bibr">Goodman <italic toggle="yes">et al.</italic> 2016</xref>). Available FASTA sequences were downloaded from NCBI and filtered to include protein sequences that ranged in length from 50 to 1000 (<italic toggle="yes">N</italic> = 2082). To remove redundancy in the dataset, a Hobohm 1 (<xref rid="vbad151-B14" ref-type="bibr">Hobohm <italic toggle="yes">et al.</italic> 1992</xref>) algorithm with 90% sequence identity was applied, resulting in a set of 686 non-redundant allergens covering 187 species. In short, the Hobohm 1 algorithm sorts the proteins by sequence length from longest to shortest. The first protein is automatically added to a ‘unique’ list, then the second protein is compared to the protein in the unique list. If the identity exceeds 90% the protein is removed, otherwise it is appended to the unique list. This process is iterated throughout the sorted protein list. Sequence identity was determined by pairwise alignment as the percentage of identical amino acids with regard to the query protein length.</p>
      <p>For each allergen, non-allergen protein candidates were selected by searching for matching species names with the allergen and excluding results with the following keywords in NCBI: allergen, hypothetical, uncertain, predicted, probable, and putative. Additionally, sequence lengths were limited to ±20% of the allergen length. Up to five candidates were randomly selected with BLASTP <italic toggle="yes">E</italic>-values (NCBI-Blast 2.12.0, <xref rid="vbad151-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1990</xref>) higher than 1 × 10<sup>−10</sup> against the allergens (to avoid including sequences with high similarity to known allergens that could be untested antigens, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), and 1 × 10<sup>−100</sup> against any sequence in the negative dataset (to avoid including repeated sequences). The number of non-allergens collected per allergen subset may vary (below five) because of the limited set of proteins for some species. The negative dataset consisted of 2477 non-allergic protein sequences.</p>
    </sec>
    <sec>
      <title>2.2 Dataset homology reduction</title>
      <p>In short, similar allergens were clustered together using BLAST <italic toggle="yes">E</italic>-score and minimum spanning tree (MST). First, the sequence similarity between each allergen in the dataset was determined by BLASTP using an all-against-all alignment. If the query did not provide a significant hit to a protein in the database, the <italic toggle="yes">E</italic>-score was set to a value of 10, scoring as non-aligned proteins. A pairwise comparison matrix of <italic toggle="yes">E</italic>-values was obtained to generate clusters by the MST algorithm. All clusters were then randomly split in partitions to train the model. The training dataset was further reduced by different thresholds by removing the proteins that, after clustering with MST, had more than 20 neighbours/edges. The final positive dataset had 537 allergic proteins after removing homologous sequences. After clustering the allergens, all the non-allergens associated with each allergen (sharing the same species and length range) were grouped together. The clusters from MST were randomly distributed into five partitions with similar sizes.</p>
    </sec>
    <sec>
      <title>2.3 Feature constructions</title>
      <sec>
        <title>2.3.1 MHC-II presentation propensity scores</title>
        <p>NetMHCIIpan 4.0 (<xref rid="vbad151-B30" ref-type="bibr">Reynisson <italic toggle="yes">et al.</italic> 2020b</xref>) was used to predict MHC binding selecting the peptides with a percentile rank below 10% (<xref rid="vbad151-B29" ref-type="bibr">Reynisson <italic toggle="yes">et al.</italic> 2020a</xref>), using a sliding window of 15. From these numbers, two different features were collected. Binder 1 includes the counts for HLA-DRB1*04:01, HLA-DQA1*02:01-DQB1*02:02, HLA-DQA1*04:01-DQB1*03:01, HLA-DQA1*01:03-DQB1*06:01, HLA-DQA1*03:01-DQB1*03:02, and HLA-DQA1*05:01-DQB1*02:01 and binder 2 the counts for HLA-DRB1*15:01. These sets of alleles were selected as they were previously demonstrated to be positively (binder 1) or negatively/positively (binder 2) associated with allergies. Final MHC presentation propensity scores were calculated by summing the binders over different alleles normalized by sequence length.</p>
      </sec>
      <sec>
        <title>2.3.2 Physicochemical properties</title>
        <p>The physicochemical properties included average residue weight, average charge, and isoelectric point constructed with Biopython. Amino acids were also classified into tiny, small, aliphatic, aromatic, non-polar, polar, charged, basic, and acidic groups by size, structure, and charge. These were obtained using Pepstats from EMBL-EBI tools. Additionally, hydropathy indices were calculated using the Kyte–Doolittle scale. A window size of 9 was used to determine position-specific hydropathy indices. Based on the sequential indices, we calculated an overall score for a protein by counting the number of hydrophobic or hydrophilic residues in a sliding window of 5. If all consecutive residues within a window had the same hydropathy tendency, a count of one was added to the overall score. To eliminate the influence of length on feature value, the scores were normalized by the sequence length.</p>
      </sec>
      <sec>
        <title>2.3.3 Local structural features</title>
        <p>Structural features were represented by alpha helix, beta sheet, relative solvent accessibility (RSA), and disordered regions. These features were predicted by using NetSurfP 3.0 (<xref rid="vbad151-B15" ref-type="bibr">Høie <italic toggle="yes">et al.</italic> 2022</xref>). NetSurfP predicts residue-specific secondary structures. The occurrences of 5 alpha helix and 3 beta sheet residues within a sliding window of 7 summarized both alpha-helix and beta-sheet counts per protein. For RSA, the average value in the same window size was calculated, adding 1 if the value exceeded the 0.3 threshold. Additionally, under the same window size setting, the presence of more than three residues with a disorder higher than 0.5 was considered as 1 in the overall disorder. Likewise, these structural features were normalized by the sequence length.</p>
      </sec>
      <sec>
        <title>2.3.4 Amino acid compositions and evolutionary information</title>
        <p>The relative amino acid frequencies in the protein sequence were represented as 20 amino acid composition features (AAC). Further, the evolutionary information was represented by the position-specific scoring matrix (PSSM). PSI-BLAST was used to produce the PSSM. The sequences in the training datasets were used as a BLAST database for searching. We replaced the PSSMs of query sequences with no hits with the default scoring matrix BLOSUM62 due to the database limit. We applied the autocovariance (AC) transformation to vectorize the PSSM for a protein (<xref rid="vbad151-B28" ref-type="bibr">Refahi <italic toggle="yes">et al.</italic> 2020</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Model development</title>
      <p>Nested cross-validation was used for model training and evaluation. Based on the data partitioning, the outer layer had 5-folds, and the inner layers had 4 folds to ensure that the partitions were mutually independent. Grid searches were used to determine hyperparameters and model selection were carried out on the training and validation datasets. A wide set of hyperparameters was tested including the number of estimators, the maximum depth of the decision tree, the minimum samples for split and leaf, and the impurity criterion (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The outer test sets were predicted using a mean of the ensemble of the selected optimal models.</p>
      <p>On top of the partitioning and nested cross-validation, 10 different random seeds were used to randomly distribute the clusters in the different partitions. Ten models were generated from the 10 different seeds used for partitioning. The final model was made as an ensemble by taking the mean of 10 different seed models.</p>
      <p>All the random forest models were developed independently using this same pipeline in Python with Scikit-learn. Performance evaluation was made on the entire dataset by concatenating the predictions from the five outer test sets in the nested cross-validation setup. The input data were standardized to eliminate the effect of different feature scales using a <italic toggle="yes">z</italic>-score transformation. The <italic toggle="yes">z</italic>-scores were calculated based on the means and standard deviations of each training dataset. Data in validation and test datasets were normalized by the means and standard deviations from the training datasets used for model construction.</p>
      <p>Allergens in the training dataset were used to construct the BLAST database. Evaluation sequences were searched against the database and the <italic toggle="yes">E</italic>-values were extracted as the predictions of the baseline model.</p>
    </sec>
    <sec>
      <title>2.5 Evaluation datasets</title>
      <p>Two independent evaluation datasets were collected. The first one was collected from the AlgPred 2 evaluation dataset (<xref rid="vbad151-B36" ref-type="bibr">Sharma <italic toggle="yes">et al.</italic> 2021</xref>). Here, identical duplicates were removed leaving 765 allergen and 2015 non-allergen sequences. The second was a collection of allergens retrieved from Allergen Nomenclature (<xref rid="vbad151-B27" ref-type="bibr">Pomés <italic toggle="yes">et al.</italic> 2018</xref>), Allerbase (<xref rid="vbad151-B18" ref-type="bibr">Kadam <italic toggle="yes">et al.</italic> 2017</xref>), COMPARE (<xref rid="vbad151-B40" ref-type="bibr">van Ree <italic toggle="yes">et al.</italic> 2021</xref>), Allergome (<xref rid="vbad151-B20" ref-type="bibr">Mari and Riccioli 2004</xref>), and SDAP (<xref rid="vbad151-B17" ref-type="bibr">Ivanciuc <italic toggle="yes">et al.</italic> 2003</xref>) databases (on December 2021). Allergenic protein sequences that were identical to positive sequences in the training dataset were excluded. Next, the same procedure to collect non-allergens as for the training dataset was applied. This evaluation dataset contained 1065 positives and 4914 negative proteins (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec>
      <title>2.6 Evaluation metrics</title>
      <p>The performance of each model was evaluated by AUC, AUC 0.1, and positive predictive value (PPV). AUC 0.1 was calculated as the area integrated to a 10% false positive rate. For PPV, predicted values were first sorted in descending order, next PPV was obtained from the proportion of true positive targets within the top <italic toggle="yes">N</italic> predictions, where <italic toggle="yes">N</italic> was the number of allergens.</p>
      <p>In order to assess if the performance of the two models were significantly different, a <italic toggle="yes">P</italic>-value was calculated using bootstrapping. In this setup, a sample with replacement of the same size as the evaluation dataset was taken from the paired predictions from two models to determine whether the null hypothesis of the two models performing at par was rejected. This resampling was performed 10 000 times, and the <italic toggle="yes">P</italic>-value calculated by counting the occurrences of the AUC of one model was greater than that of another divided by the number of samplings.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Homology reduction pipeline</title>
      <p>One of the big and current challenges in machine learning approaches is data leakage, which originates from data used for the model to learn, with high redundancy to what is later evaluated on (<xref rid="vbad151-B12" ref-type="bibr">Gibney 2022</xref>). This issue not only overestimates model accuracy but also curbs its generalization and therefore hinders its prediction ability. In particular, the multiple allergen databases that exist contain a great number of homologous sequences or iso-allergens (<xref rid="vbad151-B18" ref-type="bibr">Kadam <italic toggle="yes">et al.</italic> 2017</xref>). While this redundancy may facilitate the task of finding homologous candidate allergens in unexplored species, it might derange the effort to find new allergen families or sequence-unrelated unknown allergens. Hence, we first developed a pipeline to efficiently remove and cluster similar sequences from the allergens dataset using BLAST sequence alignment and MST, which connects into single clusters all proteins sharing sequence similarity over a threshold.</p>
      <p>Allergen protein sequences were collected from AllergenOnline29 and filtered to remove atypically short and long sequences, highly redundant or identical sequences (detailed in Section 2, <xref rid="vbad151-F1" ref-type="fig">Fig. 1A</xref>). After this, 686 allergen sequences were clustered by MST using all-against-all BLAST sequence similarity <italic toggle="yes">E</italic>-values (≤1 × 10<sup>−10</sup>) to define neighbours (<xref rid="vbad151-F1" ref-type="fig">Fig. 1B</xref>). Since non-allergens are more abundant than allergens in the real scenario, we designed an imbalanced dataset to simulate the case, and expected the model would be able to learn and identify allergens from proteins. For non-allergens, we collected five protein sequences not annotated as allergens from the same species of each allergen as described in Section 2.1 (<xref rid="vbad151-F1" ref-type="fig">Fig. 1C</xref>).</p>
      <fig position="float" id="vbad151-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Data collection. (A) Positive data collection. Allergens were collected from the AllergenOnline database, filtered by length, and by similarity using Hobohm 1 algorithm. (B) Clustering. Clusters were generated using the MST algorithm and distances from BLAST all-against-all <italic toggle="yes">E</italic>-values. (C) Negative data collection. Non-allergen sequences (blue) were collected from NCBI and added in a 5:1 ratio to positive allergens (red) searching for the same species in each allergen. When more than five non-allergens meet the following criteria, matching keywords, length (range 20% allergen), and similarity (<italic toggle="yes">E</italic>-values), a random subset of the candidates that was selected. See Section 2 for details of data collection.</p>
        </caption>
        <graphic xlink:href="vbad151f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 MHC presentation propensity feature</title>
      <p>In order to induce Th2 responses and IgE production, allergens are first digested by APCs and selected peptides are presented on MHC-II complexes. Since allergy-related GWAS studies demonstrated that allergies have strong association to specific MHC class II alleles, we could suggest that the presentation of allergic peptides on those alleles is involved in the allergy development (<xref rid="vbad151-B22" ref-type="bibr">Moffatt <italic toggle="yes">et al.</italic> 2001</xref>, <xref rid="vbad151-B33" ref-type="bibr">Sakaguchi <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="vbad151-B39" ref-type="bibr">Van Overtvelt <italic toggle="yes">et al.</italic> 2008</xref>, <xref rid="vbad151-B7" ref-type="bibr">Dimitrov and Doytchinova 2016</xref>, <xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="vbad151-B25" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2019</xref>). Therefore, NetMHCIIpan was used to predict MHC presentation potential for allergens and non-allergens on a set of selected alleles based on the above-mentioned GWAS studies (<xref rid="vbad151-B30" ref-type="bibr">Reynisson <italic toggle="yes">et al.</italic> 2020b</xref>). The 10% threshold used in NetMHCIIpan was tested and exhibited improved feature AUC by 0.06 compared to the current default 5%. MHC-II presentation propensity was collected by adding the counts of predicted binders for a set of relevant alleles derived from genetic associations found in allergies (<xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="vbad151-B25" ref-type="bibr">Noguchi <italic toggle="yes">et al.</italic> 2019</xref>). In particular, two features, binder 1 and binder 2, were created for grouping known positive (HLA-DRB1*04:01, HLA-DQA1*02:01-DQB1*02:02, HLA-DQA1*04:01-DQB1*03:01, HLA-DQA1*01:03-DQB1*06:01, HLA-DQA1*03:01-DQB1*03:02, HLA-DQA1*05:01-DQB1*02:01), and the ambiguous allele (HLA-DRB1*15:01), HLA-II allergenicity associations. HLA-DRB1*15:01 was separated as it was previously proposed in some allergies as a risk factor, while in others a protective allele (<xref rid="vbad151-B33" ref-type="bibr">Sakaguchi <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="vbad151-B39" ref-type="bibr">Van Overtvelt <italic toggle="yes">et al.</italic> 2008</xref>).</p>
      <p>In addition to MHC-II presentation propensity, previously described classification features for allergen/non-allergens were included. Those include amino acid compositions, physicochemical properties, structural features (alpha helix, beta sheets, and RSA), and evolutionary properties (see feature constructions in Section 2). Feature distributions for allergen and non-allergens were illustrated by boxplots for the most significant features displaying the median, quantiles, and densities of each set of data (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>). For binder 1, the <italic toggle="yes">t</italic>-statistic and <italic toggle="yes">P</italic>-value were 12.892 and 4.97 × 10<sup>−34</sup> respectively, indicating a higher MHC-II presentation propensity on allergens compared to non-allergens. Differences in binder 2 were not statistically significant, suggesting that HLA-DRB1*15:01 presentation propensity was not discriminative for this entire dataset. However, the HLA-DRB1*15:01 showed significant presentation preference for the Der p 1 family and Bet v 1 family, compared to other allergen families, such as the Tri a 36 (wheat) and Amb a 4 (short ragweed) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). When comparing the average residue weight, the <italic toggle="yes">t</italic>-test had a negative <italic toggle="yes">t</italic>-statistic value. These results suggested that allergens are characterized by a higher frequency of small-size amino acids. Likewise, allergens were found to be more likely hydrophilic and less hydrophobic, as previously described (<xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>), and containing less arginine and more aspartic acid. The <italic toggle="yes">t</italic>-statistic for alpha helix was negative, and beta sheet positive which indicated the allergens are depleted in alpha helices and enriched to beta sheets compared to non-allergens confirming previous observations (<xref rid="vbad151-B3" ref-type="bibr">Dall’Antonia <italic toggle="yes">et al.</italic> 2014</xref>).</p>
      <fig position="float" id="vbad151-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Distribution and individual-feature performances on selected features for allergens and non-allergens. <italic toggle="yes">T</italic>-test was used to compare the significant difference between allergens (red, A) and nonallergens (blue, NA). The AUC was calculated with feature values and the targets. ‘Small’ corresponds to the relative abundance of small-size amino acids (A, C, D, G, N, P, S, T, V) in a given protein sequence. Likewise, D and R correspond to the frequencies of aspartic acid and arginine per protein.</p>
        </caption>
        <graphic xlink:href="vbad151f2" position="float"/>
      </fig>
      <p>We next determined the AUC of all the individual features on the training dataset. Here, AUC values below 0.5 would suggest that allergic proteins have lower feature values than non-allergic proteins. As expected, the results of these analyses aligned with the <italic toggle="yes">t</italic>-statistics above, i.e. allergens had more MHC-II binder 1, more small-size amino acids, fewer alpha helices, more beta sheets, more hydrophilic proteins and contained more aspartic acid and less arginine (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Model development</title>
      <p>After showing that MHC presentation propensity is a discriminatory feature for allergens (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>), we sought to incorporate these features into machine learning models in order to improve the state-of-the-art allergenicity predictors. To effectively avoid overfitting, a 5-fold nested cross-validation scheme was performed (<xref rid="vbad151-F3" ref-type="fig">Fig. 3</xref>), and the best random forest hyperparameters were selected in the inner loop (<xref rid="vbad151-F3" ref-type="fig">Fig. 3B</xref>). MHC presentation propensity was combined with different sets of features, and optimal performance on the training data was obtained with a random forest model with 60 features (60F). The 60F model included MHC presentation propensity, physicochemical features, amino acid compositions, auto-covariances, and structural features (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>, for details refer to Section 2). Finally, the partitioning from MST was repeated 10 times using different random seeds and a final random forest model ensemble was generated. The ensemble model significantly outperformed most of the individual models in each random seed (<xref rid="vbad151-F3" ref-type="fig">Fig. 3D</xref>), therefore the ensemble scheme was applied to all the models.</p>
      <fig position="float" id="vbad151-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Model development pipeline of NetAllergen. (A) Partitioning. Five partitions randomly combining the clusters obtained from MST clustering were distributed using 10 different random seeds. Every allergen (red bar) and its five associated negatives (blue bars) share the same partition. (B) Cross-validation and ensemble prediction. A nested cross-validation setup was used using 5 folds in the outer layer and 4 folds in the inner layer. The final ensemble prediction is the mean of the 10 model predictions. (C) Internal redundancy tuning. The AUROC was evaluated on the minimal common subset (the dataset with a filter of 5). (D) Evaluation. Ensemble AUC (60F) was significantly higher than the individual partitions except when comparing to P2, which was not significant (<italic toggle="yes">P</italic>-value .152).</p>
        </caption>
        <graphic xlink:href="vbad151f3" position="float"/>
      </fig>
      <p>We next assessed removing sequences with a large number of other similar sequences to further cut out redundancy in the dataset (see Section 2). Here, cross-validation predictive performance was evaluated to find the optimal filter for removing the allergens with a higher number of neighbours in the tree network after MST clustering (<xref rid="vbad151-F3" ref-type="fig">Fig. 3C</xref>). The removal of highly connected vertices in the tree reduced the bias effect of highly similar sequences and improved the model performance. However, applying more stringent filters (removing vertices with fewer than 20 neighbours) caused a loss of informative allergen sequences as well as the performance. Hence, we applied a filter of 20 and removed the sequences that had more than 20 neighbours in the MST clusters.</p>
    </sec>
    <sec>
      <title>3.4 MHC presentation propensity is predictive</title>
      <p>Here, we picked the random forest model as feature importance can be calculated as the mean decrease of Gini impurity for each specific feature in all the trees. A higher value indicates a better split of the data using that feature. We explored the contribution of the different features in the random forest model of 60F and in a reduced model of 20F (only including MHC presentation propensity, structural properties, and physicochemical features, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S3 and S4</xref> for performance and feature compositions). MHC-II presentation propensity binder 1 was the most important feature in the simpler 20F model (<xref rid="vbad151-F4" ref-type="fig">Fig. 4A</xref>). The frequency of small amino acids (Small), average relative solvent accessibility (AvgRSA), binder 2, frequency of acidic amino acids, and alpha helix and beta sheet were also informative features to discriminate allergens and non-allergens (above the median of all feature importance). In the 60F model, although binder 1 was no longer the most important feature, it still played an important role in the prediction (<xref rid="vbad151-F4" ref-type="fig">Fig. 4B</xref>). In contrast, the binder 2 feature became less important in the 60F model. Further, the amino acid composition of arginine, aspartic acid, and lysine, together with the auto-covariance of PSSM on Glutamine (AC_Q) were found to be among the most discriminatory features in the 60F model.</p>
      <fig position="float" id="vbad151-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Median feature importance for RF models. Medians are calculated from cross-validation partitions and 10 random seeds in each random forest as the mean decrease of Gini impurity for (A) 20 features (20F) model, and (B) 60F model. Individual features were grouped into physicochemical properties (PCP, blue), hydropathy (HYD, pink), structural information (NSP, yellow), MHC-II presentation propensity (MHC, red), amino acid compositions (COMP, green), and evolutionary information (AC, purple). Average relative solvent accessibility (AvgRSA).</p>
        </caption>
        <graphic xlink:href="vbad151f4" position="float"/>
      </fig>
      <p>To further investigate the importance of MHC-II features, models removing the binder 1 and binder 2 were trained and evaluated using cross-validation. When the MHC-II features were removed from the 60F model, AUC was reduced from 0.912 to 0.911 and AUC 0.1 from 0.512 to 0.510 (<xref rid="vbad151-T1" ref-type="table">Table 1</xref>). For the 20F model however, when taking out the MHC presentation propensity features (18F), the reduction in prediction power was found to be significant for AUC and PPV. Additionally, the AUCs of 60F or 20F were both greater than AUC of any single feature (<xref rid="vbad151-F2" ref-type="fig">Fig. 2</xref>), which indicated that the model learnt features of allergens and benefited from the combination of features. Consistently with feature importance in those models, this result indicates that the addition of amino acid compositions and ACs could be correlated with MHC presentation propensity. By computing the feature space, the Pearson correlation coefficient suggested that the binder1 was strongly correlated to the alanine and negatively correlated to cysteine (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). These features contributed to the prediction when the MHC presentation propensity was absent, which led to no significant difference after the removal of binder features. The final 60F model was further evaluated based on the confusion matrix method as well. The threshold used for classifying allergens and non-allergen was 0.207 which was determined by the trade-off of sensitivity and specificity. Applied with this threshold, the sensitivity, specificity, and accuracy were 0.836, and MCCs were 0.572. It indicated the model was effectively able to capture the true positives from samples, however, misclassified false positives decreased the MCC.</p>
      <table-wrap position="float" id="vbad151-T1">
        <label>Table 1.</label>
        <caption>
          <p>Cross-validation performance of models with and without MHC-II features.<sup>a</sup></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Model</th>
              <th rowspan="1" colspan="1">AUC</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">P</italic>-value</th>
              <th rowspan="1" colspan="1">AUC0.1</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">P</italic>-value</th>
              <th rowspan="1" colspan="1">PPV</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">P</italic>-value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">58F</td>
              <td rowspan="1" colspan="1">0.911</td>
              <td rowspan="2" colspan="1">.022</td>
              <td rowspan="1" colspan="1">0.512</td>
              <td rowspan="2" colspan="1">.636</td>
              <td rowspan="1" colspan="1">0.657</td>
              <td rowspan="2" colspan="1">.633</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">60F</td>
              <td rowspan="1" colspan="1">0.912</td>
              <td rowspan="1" colspan="1">0.510</td>
              <td rowspan="1" colspan="1">0.650</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">18F</td>
              <td rowspan="1" colspan="1">0.855</td>
              <td rowspan="2" colspan="1">&lt;.001</td>
              <td rowspan="1" colspan="1">0.327</td>
              <td rowspan="2" colspan="1">.226</td>
              <td rowspan="1" colspan="1">0.518</td>
              <td rowspan="2" colspan="1">.035</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20F</td>
              <td rowspan="1" colspan="1">0.866</td>
              <td rowspan="1" colspan="1">0.336</td>
              <td rowspan="1" colspan="1">0.534</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>All <italic toggle="yes">P</italic>-values were obtained using bootstrapping. Models 60F (58F) and 20F (18F) do (not) contain MHC-II presentation propensity features. A random predictor has a PPV in 0.178 ± 0.029 by randomly shuffling the targets 10 000 times and calculating the PPV.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.5 Model comparison</title>
      <p>Sequence similarity to previously known allergens is the main driver of previously developed allergenicity predictors (<xref rid="vbad151-B11" ref-type="bibr">Fiers <italic toggle="yes">et al.</italic> 2004</xref>, <xref rid="vbad151-B10" ref-type="bibr">EFSA 2021</xref>). Therefore, we constructed a sequence similarity baseline model using BLAST. In the baseline model, the predicted value for each potential allergen from the evaluation datasets was taken from the best hit of BLAST against the training dataset. This baseline model was compared to the random forest model (60F) on the AlgPred 2 evaluation dataset (see Section 2). Overall, the baseline model had a higher performance (AUC of 0.923) on the full evaluation dataset compared to the random forest of 60F (AUC 0.886, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). This exceptional performance of the baseline model clearly suggests the high similarity between the allergens in the evaluation dataset and those in the training dataset. However, it is expected that the performance of the baseline model will decrease on unknown or remotely related allergen sequences. To quantify how model-performance correlates with sequence similarity to the training dataset, we sorted the sequences in the evaluation dataset from high to low similarity (negative log <italic toggle="yes">E</italic>-value, i.e. the predicted values of baseline model). We observed that the baseline model performed better than our 60F model for highly similar query entries to the training data with maximum difference of 0.043, but that dropped dramatically when sequence similarity decreased (<xref rid="vbad151-F5" ref-type="fig">Fig. 5</xref>). On the contrary, the 60F model demonstrated a more robust AUC performance on all the dataset and outperformed the baseline model on proteins that were less similar (<italic toggle="yes">E</italic>-value &gt; 1 × 10<sup>−51</sup>) to sequences in the allergen database (<xref rid="vbad151-F5" ref-type="fig">Fig. 5A</xref>). The same trend was observed for AUC 0.1 (<xref rid="vbad151-F5" ref-type="fig">Fig. 5B</xref>).</p>
      <fig position="float" id="vbad151-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Model performance for variable datasets with decreasing similarity thresholds on AlgPred2 evaluation dataset. The sequences were sorted by similarities against allergens in the training dataset with a descending order. The vertical line indicates the changes of performance and split the curves into areas of higher and lower similarities. For the rightmost curve, the number of sequences reduced as the decreasing similarity, which led to that the evaluation was less robust because of noise. (A) AUC. (B) AUC 0.1.</p>
        </caption>
        <graphic xlink:href="vbad151f5" position="float"/>
      </fig>
      <p>In order to compare to state-of-the-art allergenicity predictors, we next benchmarked the random forest model against AlgPred 2 (<xref rid="vbad151-B36" ref-type="bibr">Sharma <italic toggle="yes">et al.</italic> 2021</xref>). Since AlgPred 2 was available in a re-trained format using the evaluation dataset used in their publication, we collected a second and independent evaluation dataset from other allergen databases (detailed information in Section 2). As in the earlier benchmark, the new independent validation set was ranked in the same method with <italic toggle="yes">E</italic>-values against the allergens in the combined datasets of the cross-validation and AlgPred 2. Both AUC and AUC 0.1 performances were assessed in the identical approach and behaved similarly as before, showing a higher performance of AlgPred 2 and baseline model for the highly similar sequences (<xref rid="vbad151-F6" ref-type="fig">Fig. 6</xref>). In a similar fashion, both AlgPred 2 and BLAST performances dropped below that of the 60F model when similarity to training-allergens <italic toggle="yes">E</italic>-values were higher than 1 × 10<sup>−59</sup>. This result suggests the 60F model had superior predictive power on novel sequences which were not included in current allergen databases.</p>
      <fig position="float" id="vbad151-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Model performance with different similarity thresholds on the new evaluation dataset. The similarities were represented by −log(<italic toggle="yes">E</italic>-value) which were obtained from the baseline model (BLAST). The searching database consisted of the positive sequences from our and AlgPred2 dataset. The noise in decreasing data size led to the less robust curves at the rightmost part. (A) AUC. (B) AUC0.1.</p>
        </caption>
        <graphic xlink:href="vbad151f6" position="float"/>
      </fig>
      <p>The analysis of model comparisons indicated that BLAST demonstrates good performance when applied to similar protein sequences, while 60F excelled in handling dissimilar sequences. Hence, the ultimate model was the combination of BLAST and 60F. To select the optimal threshold (1 × 10<sup>−16</sup>) of when to use BLAST or the 60F model, we picked the <italic toggle="yes">E</italic>-value based on AUC0.1 reflecting how well a model predicts positive data. If a query sequence has lower similarity (or a higher <italic toggle="yes">E</italic>-value) than the threshold, we use the 60F to predict the allergenicity.</p>
      <p>The 60F random forest model with BLAST was deployed as a web server. The allergenicity predictor is available at <ext-link xlink:href="https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0" ext-link-type="uri">https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0</ext-link>. The program accepts a FASTA file of protein sequences and provides a prediction result table (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Understanding the nature of allergenicity is of high importance as it contributes to the development of future diagnostic tools and therapeutic strategies. Previous allergen predictors have focused on answering the question of what makes an allergen. By introducing HLA presentation propensity, we proposed a first attempt to answer the question of why only some individuals develop allergies towards ubiquitous proteins. Here, we have developed a new allergen predictor called NetAllergen which incorporates a novel significant feature regarding MHC class II presentation on a set of particular susceptible alleles, suggesting allergenicity may relate to presentation on particular subset of HLA class II alleles. NetAllergen was trained on a carefully curated dataset where redundant allergen sequences were removed. Due to the accessibility of both program/web service and training dataset, AlgPred 2 was the only accessible tool used for benchmark. NetAllergen was demonstrated to perform better than a state-of-the-art predictor AlgPred 2, and a baseline model when sequence similarity towards known allergens is reduced.</p>
    <p>Although it has long been recognized that allergy has a strong HLA association component (<xref rid="vbad151-B788201127" ref-type="bibr">Levine <italic toggle="yes">et al.</italic> 1972</xref>) still very little is known about the mechanisms that trigger allergy. Recently, large GWAS pointed to conserved specific amino acid positions in the HLA-II binding groove determining protective or risk variants for certain allergies (<xref rid="vbad151-B19" ref-type="bibr">Marenholz <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="vbad151-B41" ref-type="bibr">Waage <italic toggle="yes">et al.</italic> 2018</xref>). This observation suggests that MHC-II presentation in those alleles might have an important role in allergy. Consequently, we have hypothesized that allergens might have a high quantity of presentation motifs towards those specific alleles compared to non-allergens. Here, we showed that this is indeed the case. HLA allele presentation propensity in binder 1 was one of the strongly discriminant features for allergens (AUC = 0.68). In addition, incorporation of this novel HLA presentation propensity feature with other structural features, amino acid compositions, etc., into random forest models achieved good performance for allergenicity prediction.</p>
    <p>The advantage of random forest compared to other more complex models in machine learning is its ease of interpretability. Therefore, we have picked this simple model to better analyze feature importance. Once more, MHC presentation propensity binder 1 was found to be one of the most important features when analyzing which features best split the data in the random forest. Moreover, removing MHC class II presentation features from the model (20F) significantly reduced performance compared to a model including those features. This suggested that MHC-II presentation is an informative classification allergen feature. However, when incorporating additional features such as amino acid compositions, and evolutionary information of the amino acids, those improvements were only moderate. In the 60F models, arginine frequency was the most important feature followed by MHC-II presentation binder 1, auto-covariance of glutamine (AC_Q), and amino acid compositions of aspartic acid, leucine, cysteine, and lysine. While MHC-II presentation features are based on the count of presentation motifs to specific MHC-II alleles, the amino acid compositions count the percentage of amino acids in a protein sequence. They both capture important amino acids information in two distinct approaches, explaining why the 60F model did not show significant improvements against the 58F model.</p>
    <p>In addition to the MHC-II binders, the average residue weight was negatively correlated to allergenicity and small amino acids composition (A, C, D, G, N, P, S, T, V) had positive correlation. In particular, threonine and valine are branched on the beta-carbon and thus are more often found on beta strands than in alpha helices. On the other hand, proline is disfavoured on alpha helices as its amino ring is not able to adopt normal helical main chain conformations (<xref rid="vbad151-B2" ref-type="bibr">Betts and Russell 2003</xref>). These findings align with previous observations that allergens have a higher abundance of beta sheets and less alpha helices compared to non-allergens (<xref rid="vbad151-B3" ref-type="bibr">Dall’Antonia <italic toggle="yes">et al.</italic> 2014</xref>).</p>
    <p>AC represents the average covariance between the sequence and itself. Hence, the coefficients of AC_Q indicated that glutamine might be present in a large number of repetitions in the sequence. This information suggested by AC of glutamine was similar to the Q-repeats features used in AllerCatPro, thus aligning with previous findings for allergens (<xref rid="vbad151-B21" ref-type="bibr">Maurer-Stroh <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>A concept of allergen-like putative non-allergen (APN) was proposed and has been used in several researches (<xref rid="vbad151-B23" ref-type="bibr">Muh <italic toggle="yes">et al.</italic> 2009</xref>, <xref rid="vbad151-B4" ref-type="bibr">Dang and Lawrence 2014</xref>, <xref rid="vbad151-B34" ref-type="bibr">Saravanan and Lakshmi 2014</xref>). The APNs were described as the proteins with identity greater than 30% and not annotated with allergen-related terms. However, most of sequences which are not in allergen database lack allergenicity-related experiments to be definitely defined as non-allergens. Incorporating these sequences might be able to expand the model scope and improve its capacity to distinguish allergens. In the <italic toggle="yes">Chironomus thummi</italic> example (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), the Q23763 and P11582 were found not containing any allergen-related annotation in Swiss-Prot, and they respectively had 95% and 68% identity to known allergen 216_1 (P84298) and 218_1 (P02226). Compared to the known allergens, the former one had several point mutations and the latter one shared identical structure. Hence, it was likely to introduce mislabelling issues without definite evidence, and we used sequence similarity for negative data collection in this work. The APN dataset needs to be further analyzed and can be incorporated in future work.</p>
    <p>Many important applications in bioinformatics, including sequence alignment and machine learning algorithms, employ sequence weighting schemes to mitigate the effects of non-independent homologous sequences over-represented in a dataset (<xref rid="vbad151-B24" ref-type="bibr">Nielsen <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="vbad151-B5" ref-type="bibr">De Maio <italic toggle="yes">et al.</italic> 2021</xref>). In particular, allergen datasets are highly redundant as many homologous proteins are discovered in closely related species. Moreover, strict sequence similarity guidelines proposed by the FAO/WHO to assess allergenicity <italic toggle="yes">in silico</italic> may have favoured the discovery of iso-allergens. As part of the development of NetAllergen, we have proposed a novel pipeline to deal with highly redundant datasets and avoid data leakage issues. Here, we have showcased how this pipeline can be applied to real-life datasets aiding the development of data-driven prediction methods. We believe this proposed pipeline to be broadly applicable and expect it to be of general use for the community.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad151_Supplementary_Data</label>
      <media xlink:href="vbad151_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Author contributions</title>
    <p>Y.L. collected the data, developed the pipeline, trained the models, analyzed and interpreted the data; P.W.S. created the web server; M.N. analyzed and interpreted the data, provided critical revision of the article; and C.B. analyzed and interpreted the data, provided critical revision of the article, and conceived the work. All authors wrote the article and approved the final version to be published.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data and scripts used in this manuscript are available at the web server link: <ext-link xlink:href="https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0" ext-link-type="uri">https://services.healthtech.dtu.dk/service.php?NetAllergen-1.0</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad151-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Gish</surname><given-names>W</given-names></string-name>, <string-name><surname>Miller</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source><year>1990</year>;<volume>215</volume>:<fpage>403</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Betts</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Russell</surname><given-names>RB.</given-names></string-name></person-group><part-title>Amino acid properties and consequences of substitutions</part-title>. In<italic toggle="yes">:</italic> Barnes, M.R. and Gray, I.C. (eds) <source>Bioinformatics for Geneticists</source>. <publisher-name>John Wiley &amp; Sons, Ltd.</publisher-name>, <year>2003</year>, <fpage>289</fpage>–<lpage>316</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad151-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dall’Antonia</surname><given-names>F</given-names></string-name>, <string-name><surname>Pavkov-Keller</surname><given-names>T</given-names></string-name>, <string-name><surname>Zangger</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Structure of allergens and structure based epitope predictions</article-title>. <source>Methods San Diego Calif</source><year>2014</year>;<volume>66</volume>:<fpage>3</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23891546</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dang</surname><given-names>HX</given-names></string-name>, <string-name><surname>Lawrence</surname><given-names>CB.</given-names></string-name></person-group><article-title>Allerdictor: fast allergen prediction using text classification techniques</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>1120</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">24403538</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Maio</surname><given-names>N</given-names></string-name>, <string-name><surname>Alekseyenko</surname><given-names>AV</given-names></string-name>, <string-name><surname>Coleman-Smith</surname><given-names>WJ</given-names></string-name></person-group><etal>et al</etal><article-title>A phylogenetic approach for weighting genetic sequences</article-title>. <source>BMC Bioinformatics</source><year>2021</year>;<volume>22</volume>:<fpage>285</fpage>.<pub-id pub-id-type="pmid">34049487</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Bangov</surname><given-names>I</given-names></string-name>, <string-name><surname>Flower</surname><given-names>DR</given-names></string-name></person-group><etal>et al</etal><article-title>AllerTOP v.2—a server for in silico prediction of allergens</article-title>. <source>J Mol Model</source><year>2014a</year>;<volume>20</volume>:<fpage>2278</fpage>.<pub-id pub-id-type="pmid">24878803</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Doytchinova</surname><given-names>I.</given-names></string-name></person-group><article-title>Associations between milk and egg allergens and the HLA-DRB1/DQ polymorphism: a bioinformatics approach</article-title>. <source>Int Arch Allergy Immunol</source><year>2016</year>;<volume>169</volume>:<fpage>33</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">26953725</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Flower</surname><given-names>DR</given-names></string-name>, <string-name><surname>Doytchinova</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>AllerTOP—a server for in silico prediction of allergens</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>(<issue>Suppl 6</issue>):<fpage>S4</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad151-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitrov</surname><given-names>I</given-names></string-name>, <string-name><surname>Naneva</surname><given-names>L</given-names></string-name>, <string-name><surname>Doytchinova</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>AllergenFP: allergenicity prediction by descriptor fingerprints</article-title>. <source>Bioinformatics</source><year>2014b</year>;<volume>30</volume>:<fpage>846</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">24167156</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B10">
      <mixed-citation publication-type="journal"><collab>EFSA</collab>. Workshop on allergenicity assessment—prediction. <source>EFSA J</source><year>2021</year>;<volume>18</volume>:EN-6826.</mixed-citation>
    </ref>
    <ref id="vbad151-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fiers</surname><given-names>MWEJ</given-names></string-name>, <string-name><surname>Kleter</surname><given-names>GA</given-names></string-name>, <string-name><surname>Nijland</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Allermatch, a webtool for the prediction of potential allergenicity according to current FAO/WHO Codex alimentarius guidelines</article-title>. <source>BMC Bioinformatics</source><year>2004</year>;<volume>5</volume>:<fpage>133</fpage>.<pub-id pub-id-type="pmid">15373946</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibney</surname><given-names>E.</given-names></string-name></person-group><article-title>Could machine learning fuel a reproducibility crisis in science?</article-title><source>Nature</source><year>2022</year>;<volume>608</volume>:<fpage>250</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">35883008</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goodman</surname><given-names>RE</given-names></string-name>, <string-name><surname>Ebisawa</surname><given-names>M</given-names></string-name>, <string-name><surname>Ferreira</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>AllergenOnline: a peer-reviewed, curated allergen database to assess novel food proteins for potential cross-reactivity</article-title>. <source>Mol Nutr Food Res</source><year>2016</year>;<volume>60</volume>:<fpage>1183</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">26887584</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hobohm</surname><given-names>U</given-names></string-name>, <string-name><surname>Scharf</surname><given-names>M</given-names></string-name>, <string-name><surname>Schneider</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Selection of representative protein data sets</article-title>. <source>Protein Sci</source><year>1992</year>;<volume>1</volume>:<fpage>409</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">1304348</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Høie</surname><given-names>MH</given-names></string-name>, <string-name><surname>Kiehl</surname><given-names>EN</given-names></string-name>, <string-name><surname>Petersen</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>NetSurfP-3.0: accurate and fast prediction of protein structural features by protein language models and deep learning</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W510</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">35648435</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ivanciuc</surname><given-names>O</given-names></string-name>, <string-name><surname>Schein</surname><given-names>CH</given-names></string-name>, <string-name><surname>Braun</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Data mining of sequences and 3D structures of allergenic proteins</article-title>. <source>Bioinformatics</source><year>2002</year>;<volume>18</volume>:<fpage>1358</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">12376380</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ivanciuc</surname><given-names>O</given-names></string-name>, <string-name><surname>Schein</surname><given-names>CH</given-names></string-name>, <string-name><surname>Braun</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>SDAP: database and computational tools for allergenic proteins</article-title>. <source>Nucleic Acids Res</source><year>2003</year>;<volume>31</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">12520022</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kadam</surname><given-names>K</given-names></string-name>, <string-name><surname>Karbhal</surname><given-names>R</given-names></string-name>, <string-name><surname>Jayaraman</surname><given-names>VK</given-names></string-name></person-group><etal>et al</etal><article-title>AllerBase: a comprehensive allergen knowledgebase</article-title>. <source>Database</source><year>2017</year>;<volume>2017</volume>:<fpage>bax066</fpage>.<pub-id pub-id-type="pmid">29220458</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B788201127">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>BB</given-names>, </string-name>, <string-name><surname>Stember</surname><given-names>RH</given-names>, </string-name>, <string-name><surname>Fotino</surname><given-names>M.</given-names></string-name></person-group><article-title>Ragweed hay fever: genetic control and linkage to HL-A haplotypes</article-title>. <source>Science</source><year>1972</year>;<volume>178</volume>:<fpage>1201</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">4637806</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marenholz</surname><given-names>I</given-names></string-name>, <string-name><surname>Grosche</surname><given-names>S</given-names></string-name>, <string-name><surname>Kalb</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide association study identifies the SERPINB gene cluster as a susceptibility locus for food allergy</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>1056</fpage>.<pub-id pub-id-type="pmid">29051540</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mari</surname><given-names>A</given-names></string-name>, <string-name><surname>Riccioli</surname><given-names>D.</given-names></string-name></person-group><article-title>The allergome web site—a database of allergenic molecules. Aim, structure, and data of a web-based resource</article-title>. <source>J. Allergy Clin. Immunol</source><year>2004</year>;<volume>113</volume>:<fpage>S301</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad151-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maurer-Stroh</surname><given-names>S</given-names></string-name>, <string-name><surname>Krutz</surname><given-names>NL</given-names></string-name>, <string-name><surname>Kern</surname><given-names>PS</given-names></string-name></person-group><etal>et al</etal><article-title>AllerCatPro—prediction of protein allergenicity potential from the protein sequence</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>3020</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30657872</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffatt</surname><given-names>MF</given-names></string-name>, <string-name><surname>Schou</surname><given-names>C</given-names></string-name>, <string-name><surname>Faux</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>Association between quantitative traits underlying asthma and the HLA-DRB1 locus in a family-based population sample</article-title>. <source>Eur J Hum Genet</source><year>2001</year>;<volume>9</volume>:<fpage>341</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">11378822</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muh</surname><given-names>HC</given-names></string-name>, <string-name><surname>Tong</surname><given-names>JC</given-names></string-name>, <string-name><surname>Tammi</surname><given-names>MT</given-names></string-name></person-group><etal>et al</etal><article-title>AllerHunter: a SVM-Pairwise system for assessment of allergenicity and allergic cross-reactivity in proteins</article-title>. <source>PLoS One</source><year>2009</year>;<volume>4</volume>:<fpage>e5861</fpage>.<pub-id pub-id-type="pmid">19516900</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>H</given-names></string-name>, <string-name><surname>Tsirigos</surname><given-names>KD</given-names></string-name>, <string-name><surname>Brunak</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>A brief history of protein sorting prediction</article-title>. <source>Protein J</source><year>2019</year>;<volume>38</volume>:<fpage>200</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">31119599</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noguchi</surname><given-names>E</given-names></string-name>, <string-name><surname>Akiyama</surname><given-names>M</given-names></string-name>, <string-name><surname>Yagami</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>HLA-DQ and RBFOX1 as susceptibility genes for an outbreak of hydrolyzed wheat allergy</article-title>. <source>J Allergy Clin Immunol</source><year>2019</year>;<volume>144</volume>:<fpage>1354</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">31301374</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noguchi</surname><given-names>E</given-names></string-name>, <string-name><surname>Sakamoto</surname><given-names>H</given-names></string-name>, <string-name><surname>Hirota</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-wide association study identifies HLA-DP as a susceptibility gene for pediatric asthma in Asian populations</article-title>. <source>PLoS Genet</source><year>2011</year>;<volume>7</volume>:<fpage>e1002170</fpage>.<pub-id pub-id-type="pmid">21814517</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pomés</surname><given-names>A</given-names></string-name>, <string-name><surname>Davies</surname><given-names>JM</given-names></string-name>, <string-name><surname>Gadermaier</surname><given-names>G</given-names></string-name></person-group>, <etal>et al</etal>; <collab>WHO IUIS Allergen Nomenclature Sub-Committee</collab>. <article-title>WHO/IUIS allergen nomenclature: providing a common language</article-title>. <source>Mol. Immunol</source><year>2018</year>;<volume>100</volume>:<fpage>3</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">29625844</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Refahi</surname><given-names>MS</given-names></string-name>, <string-name><surname>Mir</surname><given-names>A</given-names></string-name>, <string-name><surname>Nasiri</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>A novel fusion based on the evolutionary features for protein fold recognition using support vector machines</article-title>. <source>Sci Rep</source><year>2020</year>;<volume>10</volume>:<fpage>14368</fpage>.<pub-id pub-id-type="pmid">32873824</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynisson</surname><given-names>B</given-names></string-name>, <string-name><surname>Alvarez</surname><given-names>B</given-names></string-name>, <string-name><surname>Paul</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>NetMHCpan-4.1 and NetMHCIIpan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title>. <source>Nucleic Acids Res</source><year>2020a</year>;<volume>48</volume>:<fpage>W449</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">32406916</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynisson</surname><given-names>B</given-names></string-name>, <string-name><surname>Barra</surname><given-names>C</given-names></string-name>, <string-name><surname>Kaabinejadian</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Improved prediction of MHC II antigen presentation through integration and motif deconvolution of mass spectrometry MHC eluted ligand data</article-title>. <source>J Proteome Res</source><year>2020b</year>;<volume>19</volume>:<fpage>2304</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">32308001</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Riaz</surname><given-names>T</given-names></string-name>, <string-name><surname>Hor</surname><given-names>HL</given-names></string-name>, <string-name><surname>Krishnan</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>WebAllergen: a web server for predicting allergenic proteins</article-title>. <source>Bioinformatics</source><year>2005</year>;<volume>21</volume>:<fpage>2570</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">15746289</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saha</surname><given-names>S</given-names></string-name>, <string-name><surname>Raghava</surname><given-names>GPS.</given-names></string-name></person-group><article-title>AlgPred: prediction of allergenic proteins and mapping of IgE epitopes</article-title>. <source>Nucleic Acids Res</source><year>2006</year>;<volume>34</volume>:<fpage>W202</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">16844994</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sakaguchi</surname><given-names>M</given-names></string-name>, <string-name><surname>Nakayama</surname><given-names>T</given-names></string-name>, <string-name><surname>Kaku</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Analysis of HLA in children with gelatin allergy</article-title>. <source>Tissue Antigens</source><year>2002</year>;<volume>59</volume>:<fpage>412</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">12144625</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saravanan</surname><given-names>V</given-names></string-name>, <string-name><surname>Lakshmi</surname><given-names>P.</given-names></string-name></person-group><article-title>Fuzzy logic for personalized healthcare and diagnostics: fuzzyApp—a fuzzy logic based allergen-protein predictor</article-title>. <source>Omics</source><year>2014</year>;<volume>18</volume>:<fpage>570</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">25025745</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheurer</surname><given-names>S</given-names></string-name>, <string-name><surname>Toda</surname><given-names>M</given-names></string-name>, <string-name><surname>Vieths</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>What makes an allergen?</article-title><source>Clin Exp Allergy</source><year>2015</year>;<volume>45</volume>:<fpage>1150</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">25989479</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sharma</surname><given-names>N</given-names></string-name>, <string-name><surname>Patiyal</surname><given-names>S</given-names></string-name>, <string-name><surname>Dhall</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>AlgPred 2.0: an improved method for predicting allergenic proteins and mapping of IgE epitopes</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:bbaa294.</mixed-citation>
    </ref>
    <ref id="vbad151-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sicherer</surname><given-names>SH</given-names></string-name>, <string-name><surname>Sampson</surname><given-names>HA.</given-names></string-name></person-group><article-title>Food allergy: a review and update on epidemiology, pathogenesis, diagnosis, prevention, and management</article-title>. <source>J Allergy Clin Immunol</source><year>2018</year>;<volume>141</volume>:<fpage>41</fpage>–<lpage>58</lpage>.<pub-id pub-id-type="pmid">29157945</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Du Toit</surname><given-names>G</given-names></string-name>, <string-name><surname>Tsakok</surname><given-names>T</given-names></string-name>, <string-name><surname>Lack</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Prevention of food allergy</article-title>. <source>J Allergy Clin Immunol</source><year>2016</year>;<volume>137</volume>:<fpage>998</fpage>–<lpage>1010</lpage>.<pub-id pub-id-type="pmid">27059727</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Overtvelt</surname><given-names>L</given-names></string-name>, <string-name><surname>Wambre</surname><given-names>E</given-names></string-name>, <string-name><surname>Maillère</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of bet v 1-Specific CD4+ T cell responses in allergic and nonallergic individuals using MHC class II peptide Tetramers1</article-title>. <source>J Immunol</source><year>2008</year>;<volume>180</volume>:<fpage>4514</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">18354173</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Ree</surname><given-names>R</given-names></string-name>, <string-name><surname>Sapiter Ballerda</surname><given-names>D</given-names></string-name>, <string-name><surname>Berin</surname><given-names>MC</given-names></string-name></person-group><etal>et al</etal><article-title>The COMPARE database: a public resource for allergen identification, adapted for continuous improvement</article-title>. <source>Front Allergy</source><year>2021</year>;<volume>2</volume>:<fpage>700533</fpage>.<pub-id pub-id-type="pmid">35386979</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waage</surname><given-names>J</given-names></string-name>, <string-name><surname>Standl</surname><given-names>M</given-names></string-name>, <string-name><surname>Curtin</surname><given-names>JA</given-names></string-name></person-group>, <etal>et al</etal>; <collab>AAGC collaborators</collab>. <article-title>Genome-wide association and HLA fine-mapping studies identify risk loci and genetic pathways underlying allergic rhinitis</article-title>. <source>Nat Genet</source><year>2018</year>;<volume>50</volume>:<fpage>1072</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">30013184</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>L</given-names></string-name>, <string-name><surname>Fu</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Research progress in atopic march</article-title>. <source>Front Immunol</source><year>2020</year>;<volume>11</volume>:<fpage>1907</fpage>.<pub-id pub-id-type="pmid">32973790</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>W</given-names></string-name>, <string-name><surname>Freeland</surname><given-names>DMH</given-names></string-name>, <string-name><surname>Nadeau</surname><given-names>KC</given-names></string-name></person-group><etal>et al</etal><article-title>Food allergy: immune mechanisms, diagnosis and immunotherapy</article-title>. <source>Nat Rev Immunol</source><year>2016</year>;<volume>16</volume>:<fpage>751</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">27795547</pub-id></mixed-citation>
    </ref>
    <ref id="vbad151-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>ZH</given-names></string-name>, <string-name><surname>Koh</surname><given-names>JLY</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>GL</given-names></string-name></person-group><etal>et al</etal><article-title>AllerTool: a web server for predicting allergenicity and allergic cross-reactivity in proteins</article-title>. <source>Bioinformatics</source><year>2007</year>;<volume>23</volume>:<fpage>504</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">17150996</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
