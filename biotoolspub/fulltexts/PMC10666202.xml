<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10666202</article-id>
    <article-id pub-id-type="pmid">37982748</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad687</article-id>
    <article-id pub-id-type="publisher-id">btad687</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CENTRE: a gradient boosting algorithm for Cell-type-specific ENhancer-Target pREdiction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rapakoulia</surname>
          <given-names>Trisevgeni</given-names>
        </name>
        <aff><institution>Max Planck Institute for Molecular Genetics</institution>, 14195 Berlin, <country country="DE">Germany</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lopez Ruiz De Vargas</surname>
          <given-names>Sara</given-names>
        </name>
        <aff><institution>Max Planck Institute for Molecular Genetics</institution>, 14195 Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Omgba</surname>
          <given-names>Persia Akbari</given-names>
        </name>
        <aff><institution>Max Planck Institute for Molecular Genetics</institution>, 14195 Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Laupert</surname>
          <given-names>Verena</given-names>
        </name>
        <aff><institution>Max Planck Institute for Molecular Genetics</institution>, 14195 Berlin, <country country="DE">Germany</country></aff>
        <xref rid="FN2" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0555-6561</contrib-id>
        <name>
          <surname>Ulitsky</surname>
          <given-names>Igor</given-names>
        </name>
        <aff><institution>Max Planck Institute for Molecular Genetics</institution>, 14195 Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Department of Immunology and Regenerative Biology, Weizmann Institute of Science</institution>, Rehovot 76100, <country country="IL">Israel</country></aff>
        <aff><institution>Department of Molecular Neuroscience, Weizmann Institute of Science</institution>, Rehovot 76100, <country country="IL">Israel</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1064-3571</contrib-id>
        <name>
          <surname>Vingron</surname>
          <given-names>Martin</given-names>
        </name>
        <aff><institution>Max Planck Institute for Molecular Genetics</institution>, 14195 Berlin, <country country="DE">Germany</country></aff>
        <xref rid="btad687-cor1" ref-type="corresp"/>
        <!--vingron@molgen.mpg.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad687-cor1">Corresponding author. Max Planck Institute for Molecular Genetics, Ihnestraße 63, 14195 Berlin, Germany. E-mail: <email>vingron@molgen.mpg.de</email></corresp>
      <fn id="FN1">
        <p>Present address for Trisevgeni Rapakoulia: GlaxoSmithKline plc, Gunnels Wood Road, Stevenage SG1 2NY, United Kingdom</p>
      </fn>
      <fn id="FN2">
        <p>Present address for Verena Laupert: Bayer AG, Müllerstrasse 178, Berlin 13353, Germany</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-20">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>11</issue>
    <elocation-id>btad687</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>22</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad687.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Identifying target promoters of active enhancers is a crucial step for realizing gene regulation and deciphering phenotypes and diseases. Up to now, several computational methods were developed to predict enhancer gene interactions, but they require either many epigenomic and transcriptomic experimental assays to generate cell-type (CT)-specific predictions or a single experiment applied to a large cohort of CTs to extract correlations between activities of regulatory elements. Thus, inferring CT-specific enhancer gene interactions in unstudied or poorly annotated CTs becomes a laborious and costly task.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we aim to infer CT-specific enhancer target interactions, using minimal experimental input. We introduce Cell-specific ENhancer Target pREdiction (CENTRE), a machine learning framework that predicts enhancer target interactions in a CT-specific manner, using only gene expression and ChIP-seq data for three histone modifications for the CT of interest. CENTRE exploits the wealth of available datasets and extracts cell-type agnostic statistics to complement the CT-specific information. CENTRE is thoroughly tested across many datasets and CTs and achieves equivalent or superior performance than existing algorithms that require massive experimental data.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>CENTRE’s open-source code is available at GitHub via <ext-link xlink:href="https://github.com/slrvv/CENTRE" ext-link-type="uri">https://github.com/slrvv/CENTRE</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Ministry of Education and Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01IS18037G</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Promoters and enhancers are the two major cis-regulatory elements that control the context-dependent gene transcription. Eukaryotic enhancers are bound by various transcription factors (TFs) and when activated they upregulate the expression of target genes by forming chromatin loops with their target promoters (<xref rid="btad687-B9" ref-type="bibr">Furlong and Levine 2018</xref>). It is estimated that over a million potential enhancers exist in the human genome (<xref rid="btad687-B5" ref-type="bibr">ENCODE Project Consortium 2012</xref>), vastly outnumbering human genes. Such significant redundancy shows that the activity of the enhancers is highly specific; only a subset of enhancers is active in a given cell type (CT) and orchestrates the lineage-specific gene expression (<xref rid="btad687-B23" ref-type="bibr">Visel <italic toggle="yes">et al.</italic> 2009</xref>).</p>
    <p>As more mutations and genomic alterations of the noncoding genome become associated with regulatory elements, identifying gene targets of active enhancers is crucial for deciphering diseases and other phenotypes. Experimental methods such as Hi-C (<xref rid="btad687-B12" ref-type="bibr">Lieberman-Aiden <italic toggle="yes">et al.</italic> 2009</xref>), ChIA-PET (<xref rid="btad687-B8" ref-type="bibr">Fullwood <italic toggle="yes">et al.</italic> 2009</xref>), HiChIP (<xref rid="btad687-B16" ref-type="bibr">Mumbach <italic toggle="yes">et al.</italic> 2016</xref>), and Capture Hi-C (<xref rid="btad687-B14" ref-type="bibr">Mifsud <italic toggle="yes">et al.</italic> 2015</xref>) have revealed that chromatin architecture plays an important role in gene transcriptional regulation. When the resolution of these assays is high enough, these techniques can reveal individual Enhancer–Target (ET) contacts. However, high-resolution genome-wide loop data are only available for a limited number of human tissues/CTs and conditions. Further limitations such as low sensitivity, high cost, and technical challenges in loop-calling methods make capture-based techniques difficult to be widely applicable in ET identification (<xref rid="btad687-B13" ref-type="bibr">McCord <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad687-B26" ref-type="bibr">Xu <italic toggle="yes">et al.</italic> 2020</xref>).</p>
    <p>Several computational methods for identifying ET interactions have emerged. Correlating genomic and epigenomic signals at enhancers and promoters across multiple biosamples is the most common practice to detect ET pairs (<xref rid="btad687-B21" ref-type="bibr">Thurman <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad687-B18" ref-type="bibr">Sheffield <italic toggle="yes">et al.</italic> 2013</xref>). Although intuitive, these methods lack CT-specific predictions while requiring a vast number of biosamples. Supervised machine-learning methods train statistical models on sets of known interacting and noninteracting ET pairs annotated with various genomic, epigenomic, and transcriptomic features. Once the model is trained in one or several CTs, in principle, it could predict ET pairs in any other CT. One constraint of these methods is that they require multiple experimental assays to generate CT-specific ET predictions. TargetFinder (<xref rid="btad687-B24" ref-type="bibr">Whalen <italic toggle="yes">et al.</italic> 2016</xref>) integrates hundreds of cell-specific genomics datasets to annotate ET pairs, making the method applicable only to a few rich annotated cell lines. Inflated performance due to dependencies in training and test datasets is another limitation in assessment of the supervised learning models (<xref rid="btad687-B2" ref-type="bibr">Cao and Fullwood 2019</xref>). An unbiased and robust computational approach that can be easily applied to any CT while it claims for a feasible number of experiments is still missing.</p>
    <p>Given a hitherto less studied tissue or CT, the challenge lies in predicting its ET interactions using a minimum of experimentally derived information. We here present Cell-specific ENhancer Target pREdiction (CENTRE) which requires for the CT under study only RNA-seq results and ChIP-seq data for H3K27ac, H3K4me1, and H3K4me3. This CT-specific information is combined with statistics derived from enhancer and promoter signals across many CTs by means of a machine learning method, extreme gradient boosting. Through this combination of generic, across-cell-type information with CT-specific information we obtain a prediction accuracy which is on par or better than established tools. At the same time the requirement for genomic data about the new CT is low enough to allow for easy and routine use of CENTRE for predicting ET interactions in a new CT.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Processing of BENGI datasets</title>
      <p>We used the All-Pairs.Natural-Ratio BENGI collection of datasets for the training and evaluation of CENTRE. BENGI uses the hg19 annotation of cCREs-ELS and GENCODE v19 TSS. We updated all ET pairs of the BENGI datasets on the hg38 annotation using the UCSC Genome Browser liftover facility (<xref rid="btad687-B10" ref-type="bibr">Kent 2002</xref>). Then we overlapped the uplifted regions with the latest version 2 of ENCODE Registry of cCREs on hg38 [findOverlaps function from GenomicRanges library (<xref rid="btad687-B11" ref-type="bibr">Lawrence <italic toggle="yes">et al.</italic> 2013</xref>)]. Regarding the targets, we used the basic gene annotation of GENCODE Release 40 (GRCh38). The hg38 Registry of cCREs-ELS has a variable size between 150 and 350 bp (median length 286 bp), while the hg19 annotation has a variable size between 50 and 16 633 bp (median length 352 bp). In case of a hg19 cCREs-ELS overlapping more than one hg38 cCREs-ELS, multiple ET pairs were created with the mapped hg38 cCREs-ELS and the GENCODE TSS assigning the original label. We kept only ET pairs that are located within 500 KB. We downloaded RNA-seq transcripts per million (TPM) values for the 13 biosamples from ENCODE (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The positive interactions were further processed so that the interacting gene had a TPM value &gt; 0. We kept negative interactions with either a matching TSS or a matching cCREs-ELS in the positive set. All the processed BENGI datasets used in this study can be found at: <ext-link xlink:href="http://owww.molgen.mpg.de/~CENTRE_data/BENGI_processed_datasets.zip" ext-link-type="uri">http://owww.molgen.mpg.de/~CENTRE_data/BENGI_processed_datasets.zip</ext-link>.</p>
    </sec>
    <sec>
      <title>2.2 CENTRE features</title>
      <p>All features used for the training of CENTRE are listed in <xref rid="btad687-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="btad687-T1">
        <label>Table 1.</label>
        <caption>
          <p>CENTRE’s features names as they appear in the open-source code and description.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Feature name</th>
              <th rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_enh.1</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_enh.2</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_enh.3</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_enh.4</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_enh.5</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_gene.1</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_gene.2</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_gene.3</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_gene.4</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EP_prob_gene.5</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-EP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>reg_dist_enh</bold>
              </td>
              <td rowspan="1" colspan="1">Number of 100 bp bins between the ET pair where CRUP-EP &gt; 0.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>norm_reg_dist_enh</bold>
              </td>
              <td rowspan="1" colspan="1">Number of 100 bp bins between the ET pair where CRUP-EP &gt; 0.5 divided by the total number of bins</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_enh.1</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_enh.2</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_enh.3</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_enh.4</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_enh.5</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the cCRE-ELS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_gene.1</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_gene.2</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_gene.3</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_gene.4</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>PP_prob_gene.5</bold>
              </td>
              <td rowspan="1" colspan="1">CRUP-PP probability on 100 bps centered on the GENCODE TSS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>reg_dist_prom</bold>
              </td>
              <td rowspan="1" colspan="1">Number of 100 bp bins between the ET pair where CRUP-PP &gt; 0.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>norm_reg_dist_prom</bold>
              </td>
              <td rowspan="1" colspan="1">Number of 100 bp bins between the ET pair where CRUP-PP &gt; 0.5 divided by the total number of bins</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>RNA_seq</bold>
              </td>
              <td rowspan="1" colspan="1">RNA-seq TPM values for the cell of interest</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>Distance</bold>
              </td>
              <td rowspan="1" colspan="1">Genomic distance between the middle-point of cCREs-ELS and target GENCODE TSSs</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>cor_CRUP</bold>
              </td>
              <td rowspan="1" colspan="1">Pearson correlation across 104 CTs between CRUP-EP and CRUP-PP predictions for cCRE-ELS and target regions respectively</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>combined_tests</bold>
              </td>
              <td rowspan="1" colspan="1">Negative logarithm of Fisher's combined <italic toggle="yes">P</italic> value (computed using the four Wilcoxon rank-sum test <italic toggle="yes">P</italic>-values)</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <sec>
        <title>2.2.1 CT-specific features</title>
        <sec>
          <title>2.2.1.1 CRUP-EP probabilities on cCREs</title>
          <p>ENCODE cCREs-ELS, and GENCODE TSSs were extended on both sides to have a length of 500 bp. We downloaded H3K4me1, H3K4me3, and H3K27ac ChIP-seq data from the ENCODE portal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–S4</xref>) for all the CTs examined in the study, and we applied the CRUP-EP algorithm. CRUP-EP outputs the enhancer probability for every 100-bp genomic bin. We overlapped the obtained probabilities with the 500 bp enhancer and target regions [findOverlaps function from GenomicRanges library (<xref rid="btad687-B11" ref-type="bibr">Lawrence <italic toggle="yes">et al.</italic> 2013</xref>], resulting in five enhancer probabilities scores for the enhancer regions and five for the target regions.</p>
        </sec>
        <sec>
          <title>2.2.1.2 CRUP-PP probabilities on cCREs</title>
          <p>CRUP-EP uses a combination of two binary random forest classifiers and assigns enhancer probabilities to each 100-bp bin [<xref rid="E1" ref-type="disp-formula">Equation (1)</xref>]. The first classifier discriminates between active genomic regions (active promoters, enhancers) and inactive genomic regions (inactive promoters, remaining intra- and intergenic regions). The second classifier distinguishes enhancers from promoters, given that the bin is active.</p>
          <disp-formula id="E1">
            <label>(1)</label>
            <mml:math id="M1" display="block" overflow="scroll">
              <mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>b</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="italic">active</mml:mi>
                    <mml:mo> </mml:mo>
                    <mml:mi mathvariant="italic">enhancer</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>=</mml:mo>
                              <mml:mi mathvariant="italic">active</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo stretchy="false">︸</mml:mo>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">C</mml:mi>
                      <mml:mi mathvariant="bold">lassifier</mml:mi>
                      <mml:mo> </mml:mo>
                      <mml:mn mathvariant="bold">1</mml:mn>
                    </mml:mrow>
                  </mml:munder>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>=</mml:mo>
                              <mml:mi mathvariant="italic">active</mml:mi>
                              <mml:mo> </mml:mo>
                              <mml:mi mathvariant="italic">enhancer</mml:mi>
                              <mml:mo>|</mml:mo>
                              <mml:mo> </mml:mo>
                              <mml:mi>b</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>=</mml:mo>
                              <mml:mi mathvariant="italic">active</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo stretchy="false">︸</mml:mo>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">C</mml:mi>
                      <mml:mi mathvariant="bold">lassifier</mml:mi>
                      <mml:mo> </mml:mo>
                      <mml:mn mathvariant="bold">2</mml:mn>
                    </mml:mrow>
                  </mml:munder>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </disp-formula>
          <p>We used the complementary probability of the second classifier that distinguishes enhancers from promoters such that it can return the probability of the bin to be an active promoter, given that the bin is active [<xref rid="E2" ref-type="disp-formula">Equation (2)</xref>]. We call the output CRUP Promoter Probability (CRUP-PP).</p>
          <disp-formula id="E2">
            <label>(2)</label>
            <mml:math id="M2" display="block" overflow="scroll">
              <mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>b</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="italic">active</mml:mi>
                    <mml:mo> </mml:mo>
                    <mml:mi mathvariant="italic">promoter</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>=</mml:mo>
                              <mml:mi mathvariant="italic">active</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo stretchy="false">︸</mml:mo>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">C</mml:mi>
                      <mml:mi mathvariant="bold">lassifier</mml:mi>
                      <mml:mo> </mml:mo>
                      <mml:mn mathvariant="bold">1</mml:mn>
                    </mml:mrow>
                  </mml:munder>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:mi>P</mml:mi>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>b</mml:mi>
                                  <mml:mi>i</mml:mi>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>n</mml:mi>
                                      </mml:mrow>
                                      <mml:mi>x</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>=</mml:mo>
                                  <mml:mi mathvariant="italic">active</mml:mi>
                                  <mml:mo> </mml:mo>
                                  <mml:mi mathvariant="italic">enhancer</mml:mi>
                                  <mml:mo>|</mml:mo>
                                  <mml:mo> </mml:mo>
                                  <mml:mi>b</mml:mi>
                                  <mml:mi>i</mml:mi>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>n</mml:mi>
                                      </mml:mrow>
                                      <mml:mi mathvariant="normal">x</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>=</mml:mo>
                                  <mml:mi mathvariant="italic">active</mml:mi>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo stretchy="false">︸</mml:mo>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">C</mml:mi>
                      <mml:mi mathvariant="bold">lassifier</mml:mi>
                      <mml:mo> </mml:mo>
                      <mml:mn mathvariant="bold">2</mml:mn>
                    </mml:mrow>
                  </mml:munder>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </disp-formula>
          <p>We overlapped the obtained probabilities with the 500 bp enhancer and target regions [findOverlaps function from GenomicRanges library (<xref rid="btad687-B11" ref-type="bibr">Lawrence <italic toggle="yes">et al.</italic> 2013</xref>)], resulting in five promoter probabilities scores for the enhancer regions and five for the target regions.</p>
        </sec>
        <sec>
          <title>2.2.1.3 Regulatory distance</title>
          <p>We extracted the CRUP-EP and CRUP-PP activity scores for the window between the ET pair. RD features consist of four different values: (i) the number of bins where CRUP-EP &gt; 0.5 (reg_dist_enh), (ii) the number of bins where CRUP-EP &gt; 0.5 divided by the total number of bins in the ET window (norm_reg_dist_enh), (iii) the number of bins where CRUP-PP &gt; 0.5 (reg_dist_prom), and (iv) the number of bins where CRUP-PP &gt; 0.5 divided by the total number of bins in the ET window (norm_reg_dist_prom).</p>
        </sec>
        <sec>
          <title>2.2.1.4 RNA-seq</title>
          <p>RNA-seq TPM values for all biosamples considered in the study were downloaded from the ENCODE portal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
        </sec>
      </sec>
      <sec>
        <title>2.2.2 Generic features</title>
        <sec>
          <title>2.2.2.1 CAGE-seq dataset</title>
          <p>We downloaded the RLE normalized expression TPM tables for enhancers and genes from the FANTOM5 portal (<ext-link xlink:href="https://fantom.gsc.riken.jp/5/datafiles/reprocessed/hg38_latest/extra/" ext-link-type="uri">https://fantom.gsc.riken.jp/5/datafiles/reprocessed/hg38_latest/extra/</ext-link>). We averaged TPM values for the enhancers and for the genes across replicates resulting in 848 different CTs. We intersected cCRE-ELS with enhancer CAGE peaks [findOverlaps function from GenomicRanges library (<xref rid="btad687-B11" ref-type="bibr">Lawrence <italic toggle="yes">et al.</italic> 2013</xref>)]. If a cCRE-ELS region overlapped with more than one CAGE-defined enhancer, we added the TPM values of the overlapped CAGE enhancers. We used the Wilcoxon rank-sum test to compare the gene expression in samples where the enhancer is active (TPM &gt; 0) and inactive (TPM = 0).</p>
        </sec>
        <sec>
          <title>2.2.2.2 DNAse-hypersensitive region dataset</title>
          <p>We downloaded normalized counts across 112 CTs for DNase-hypersensitive sites or DHSs (dhs112_v3.bed) from <ext-link xlink:href="http://big.databio.org/papers/RED/supplement/" ext-link-type="uri">http://big.databio.org/papers/RED/supplement/</ext-link>. We used UCSC liftOver (<xref rid="btad687-B10" ref-type="bibr">Kent 2002</xref>) to obtain the hg38 coordinates of DHSs. We intersected cCRE-ELS and target regions with the DHSs [findOverlaps function from GenomicRanges library (<xref rid="btad687-B11" ref-type="bibr">Lawrence <italic toggle="yes">et al.</italic> 2013</xref>)]. If cCRE-ELS and target regions overlapped with more than one DHS, we added the corresponding DHSs counts. We ranked CTs based on the enhancer DHSs normalized counts and selected the top quantile (0.25) as the ones with the higher enhancer activity. We then used the Wilcoxon rank-sum test to compare the target DHSs signal in samples where the enhancer has higher activity than the rest of the CTs.</p>
        </sec>
        <sec>
          <title>2.2.2.3 DNAse-seq—gene expression dataset</title>
          <p>We downloaded the normalized microarray gene expression for 112 CTs (exp112.bed) that match the DNAse-hypersensitive dataset from <ext-link xlink:href="http://big.databio.org/papers/RED/supplement/" ext-link-type="uri">http://big.databio.org/papers/RED/supplement/</ext-link>. We used the processed DNA-seq dataset for the enhancer regions and we applied the Wilcoxon rank-sum test to compare the target gene expression in samples where the enhancer has higher DNAse activity (top quantile) than the rest of the CTs.</p>
        </sec>
        <sec>
          <title>2.2.2.4 CRUP-EP—gene expression dataset</title>
          <p>We downloaded H3K4me1, H3K4me3, H3K27ac, ChIP-seq data, and RNA-seq TPM values for 66 matched CTs from the ENCODE portal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S4</xref>). We applied the CRUP-EP function and extracted the enhancer probabilities for cCRE-ELS regions, averaging them across the five bins. If the average CRUP-EP probability was &gt;0.5, we considered the enhancer region as an active enhancer. We used the Wilcoxon rank-sum test to compare the gene expression TPM values in CTs where the enhancer predicted active and inactive. The CRUP-EP- gene expression dataset can be found at: <ext-link xlink:href="http://owww.molgen.mpg.de/~CENTRE_data/In_house_constructed_datasets.zip" ext-link-type="uri">http://owww.molgen.mpg.de/~CENTRE_data/In_house_constructed_datasets.zip</ext-link>.</p>
        </sec>
        <sec>
          <title>2.2.2.5 Fisher's combined probability</title>
          <p>We combined the four Wilcoxon rank-sum test <italic toggle="yes">P</italic>-values into a single <italic toggle="yes">P</italic>-value using Fisher's method (<xref rid="btad687-B19" ref-type="bibr">Statistical methods for research workers 1935</xref>). We used the negative logarithm of the combined <italic toggle="yes">P</italic>-value as the final feature in our classification.</p>
        </sec>
        <sec>
          <title>2.2.2.6 CRUP-EP and CRUP-PP correlation</title>
          <p>We downloaded H3K4me1, H3K4me3, H3K27ac, ChIP-seq data for 104 CTs from the ENCODE portal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–S4</xref>). We applied CRUP-EP and CRUP-PP functions in all CTs and extracted the CRUP-EP and CRUP-PP predictions for cCRE-ELS and target regions, respectively. We summed the probabilities over the 5-bin regions and computed the Pearson correlation coefficient across the 104 CTs. The CRUP-EP- CRUP-PP dataset can be found at: <ext-link xlink:href="http://owww.molgen.mpg.de/~CENTRE_data/In_house_constructed_datasets.zip" ext-link-type="uri">http://owww.molgen.mpg.de/~CENTRE_data/In_house_constructed_datasets.zip</ext-link>.</p>
        </sec>
        <sec>
          <title>2.2.2.7 Genomic distance</title>
          <p>We computed the distance between the middle-point of cCREs-ELS and target TSSs according to the ENCODE Registry of cCREs on hg38 and the basic gene annotation of GENCODE Release 40, respectively. We used the absolute value of distance for the classification.</p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>2.3 Centre algorithm</title>
      <p>We applied the XGBoost (<xref rid="btad687-B3" ref-type="bibr">Chen and Guestrin 2016</xref>) algorithm (python xgboost. XGBClassifier) with the logistic regression learning objective for binary classification. To control the unbalance of positive and negative samples we set scale_pos_weight = 5. We used random_state = 0 for reproducibility.</p>
      <p>We initially optimized the algorithm on the GM12878 RNAPII-ChIAPET data (<xref rid="btad687-B20" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2015</xref>) using GridSearchCV with a nested CV scheme for the model selection (inner folds = 3, outer folds =12). Based on the average precision reported in the inner CV we selected the following parameters: random_state = 0, colsample_bytree = 0.7, gamma = 1.0, learning_rate = 0.1, max_depth = 5, n_estimators = 300, reg_lambda = 0, subsample = 0.9. The outer CV is adopted from (<xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> 2020</xref>) to ensure that testing is always performed in different genomic regions than training—the results in <xref rid="btad687-F2" ref-type="fig">Fig. 2C</xref> display only the outer CV performance where no hyperparameter tuning was carried out. We used the same parameters without further optimization in the rest of the BENGI datasets (<xref rid="btad687-F4" ref-type="fig">Fig. 4A and B</xref>).</p>
      <p>We finally optimized the XGBoost algorithm on the consensus LCL datasets, using the RandomizedSearchCV function to find the optimal parameters. We used the customized CV scheme suggested in <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref> to avoid overfitting. Based on the f1 score performances we selected the following parameter set for the pre-trained CENTRE: random_state = 0, colsample_bytree = 0.7, gamma = 0.25, learning_rate= 0.1, max_depth = 10, n_estimators = 300, reg_lambda = 1, subsample = 0.9. The consensus LCL dataset and the script used for CENTRE final training can be found at: <ext-link xlink:href="http://owww.molgen.mpg.de/~CENTRE_data/CENTRE_final_training.zip" ext-link-type="uri">http://owww.molgen.mpg.de/~CENTRE_data/CENTRE_final_training.zip</ext-link>.</p>
      <p>We further evaluated the XGBoost model against Random Forests (RF) classifier. We used analogous parameters with the XGBoost for the RF training. RF parameters: n_estimators = 300, class_weight = ‘balanced_subsample’, random_state = 0, max_samples = 0.9, max_depth = 5. Area under precision recall curves (AUPRCs) and F1-scores comparing the two models are illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Comparison with TargetFinder</title>
      <p>CENTRE features were calculated based on the ENCODE Registry of cCREs on hg38 and the basic gene annotation of GENCODE Release 40 (GRCh38). However, for the comparison with TargetFinder on the BENGI datasets we used the hg19 annotation of cCREs-ELS and GENCODE v19 TSS that the authors originally used. CENTRE feature values were averaged for hg38 ET pairs corresponding to the same hg19 pair.</p>
      <sec>
        <title>2.4.1 TargetFinder</title>
        <p>We reimplemented TargetFinder (<xref rid="btad687-B24" ref-type="bibr">Whalen <italic toggle="yes">et al.</italic> 2016</xref>) (GradientBoostingClassifier, n_estimators = 4000, learning_rate = 0.1, max_depth = 5, max_features = ‘log2’, random_state = 0) to run on the BENGI ET pairs with the customized CV scheme suggested in <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref>. We calculated all the 303 features on LCLs, Hela, K562, IMR90, and NHEK datasets using the generate_training.py script and the corresponding datasets provided on the Github page (<ext-link xlink:href="https://github.com/shwhalen/targetfinder" ext-link-type="uri">https://github.com/shwhalen/targetfinder</ext-link>). Regarding the five tissue datasets where not all genomic datasets required by the TargetFinder method were available, we implemented a TargetFinder reduced model using a subset of 13 features coming from DNase, H3K4me3, H3K27ac, and CTCF experimental assays and distance. We used experimental assays downloaded from the ENCODE portal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Genomic features for all the implementations were calculated for enhancer, promoter, and window regions (EPW setting).</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Code availability</title>
      <p>CENTRE R software is accessible via <ext-link xlink:href="https://github.com/slrvv/CENTRE" ext-link-type="uri">https://github.com/slrvv/CENTRE</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Centre algorithm</title>
      <p>We designed a machine learning pipeline called CENTRE, that predicts ET interactions in a CT-specific manner (<xref rid="btad687-F1" ref-type="fig">Fig. 1</xref>). CENTRE builds on the ENCODE Registry of candidate cis-regulatory elements with enhancer-like signatures (cCRE-ELS) (<xref rid="btad687-B6" ref-type="bibr">ENCODE Project Consortium <italic toggle="yes">et al.</italic> 2020</xref>) and GENCODE transcription start sites (TSSs) (<xref rid="btad687-B25" ref-type="bibr">Wright <italic toggle="yes">et al.</italic> 2016</xref>). During training, the input consists of pairs of enhancers and promoters, labeled as “interacting” or “not interacting” as given in the BENGI ground truth dataset (<xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> 2020</xref>). The algorithm annotates potential ET interactions with a minimum set of CT-specific information coming from histone marks (HMs), gene expression, and generic information derived from ensembles of biosamples and distance. Then a pre-trained extreme gradient boosting classifier (<xref rid="btad687-B3" ref-type="bibr">Chen and Guestrin 2016</xref>) computes a probability for an annotated ET pair to interact in the CT of interest. We however limit the search for ET pairs to a distance of 500 KB which is a commonly accepted threshold for ET interactions (<xref rid="btad687-B22" ref-type="bibr">van Arensbergen <italic toggle="yes">et al.</italic> 2014</xref>) that matches the median size of topologically associated domains (TADs) (<xref rid="btad687-B4" ref-type="bibr">Dekker <italic toggle="yes">et al.</italic> 2013</xref>).</p>
      <fig position="float" id="btad687-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Outline of CENTRE framework: the user provides target genes of interest with CT-specific RNA-seq and H3K27ac, H3K4me1, and H3K4me3 ChIP-seq data. CENTRE extracts all the cCRE-ELS within 500 KB of target genes and computes CT-specific and generic features for all potential ET pairs. ET feature vectors are then fed to a pre-trained XGBOOST classifier, and a probability of an interaction is assigned to ET pairs. ET pairs with higher probability than 0.5 are labeled as interacting pairs</p>
        </caption>
        <graphic xlink:href="btad687f1" position="float"/>
      </fig>
      <p>For predicting ET pairs in a new CT, our algorithm only requires RNA-seq data as well as ChIP-seq data of the histone modifications H3K27ac, H3K4me1, and H3K4me3 determined for this particular CT. These histone modifications reflect the activity status of an enhancer or promoter, while the RNA-seq data inform the machine learning procedure about the transcriptional outcome of a possible ET interaction. The classifier is trained using this information for many available CTs in conjunction with generic, across-cell-type statistics of epigenetic and transcriptomic signals in enhancers and targets. We think of the statistics between regulatory elements across CTs as providing the potential for an interaction, while the CT-specific information serves to predict whether an interaction is realized and leads to gene activation or upregulation in a particular CT.</p>
    </sec>
    <sec>
      <title>3.2 Features reflecting generic, across-cell-type information</title>
      <p>The generic, across-cell-type information is based on the rationale that when a gene’s expression is increased by an enhancer, then one expects to find this enhancer accessible, or more generally active, in those CTs where the gene is upregulated. Conversely, one expects the gene to be more lowly expressed when the enhancer is inactive. This logic suggests looking for correlations between enhancer accessibility and gene expression across many CTs, realized by many existing methods (<xref rid="btad687-B18" ref-type="bibr">Sheffield <italic toggle="yes">et al.</italic> 2013</xref>).</p>
      <p>However, simply using correlation, e.g. of DNAse accessibility patterns with gene expression, does not suffice to point out significant ET interactions because of the CT-specific activity of enhancers. As an example, the TTC39C gene interacts with the distal enhancer-like element EH38E1904551 in the GM12878 cell line according to the ChIA-PET experiment targeting RNAPII (<xref rid="btad687-B20" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2015</xref>). The expression of TTC39C across 112 tissues (<xref rid="btad687-B18" ref-type="bibr">Sheffield <italic toggle="yes">et al.</italic> 2013</xref>) though does not correlate with the accessibility of the EH38E1904551 element in the same tissues as can be seen in <xref rid="btad687-F2" ref-type="fig">Fig. 2A</xref>. In this figure, for only a few tissues there is a clear enhancer accessibility signal as well as high expression, while generally the epigenetic signal is low despite the gene being highly expressed. More examples to this effect are depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> supporting the idea that a correlation coefficient has a low predictive value in identifying ET pairs.</p>
      <fig position="float" id="btad687-F2">
        <label>Figure 2.</label>
        <caption>
          <p>(A) Scatter plot of normalized TTC39C expression and DNase signal at EH38E1904551 across 112 human CTs. Green dots represent CTs with higher accessibility (upper quantile DNase signal). Although TTC39C is expressed across many CTs, EH38E1904551 presents high DNase signals predominantly in lymphoblastoid cell lines, resulting in a Pearson Correlation Coefficient of only 0.11. (B) Boxplots of TTC39C expression in cells where the EH38E1904551 is accessible (upper quantile DNase signal across 112 cells) versus cells where EH38E1904551 is not accessible. The significant <italic toggle="yes">P</italic>-value of the Wilcoxon rank sum test finer illustrates the strength of the ET interaction (also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). (C) Precision Recall Curve plots show the performance of individual feature sets on classifying the GM12878 RNAPII-ChIAPET dataset. The machine learning algorithm achieves its best performance when trained on CT-specific features and generic evidence of the ET interactions (also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). The performance of the gradient boosting algorithms is measured after 12-fold cross validation, training and testing in different chromosomes. CENTRE was optimized on the GM12878 RNAPII-ChIAPET data using a nested cross validation scheme (Section 2). (D) Ranking of feature importance, based on the relative number of times a particular feature occurs in XGBoost trees (feature weight over weights of all features). Top ten features illustrated were extracted from the XGBoost model applied in the GM12878 RNAPII-ChIAPET dataset.</p>
        </caption>
        <graphic xlink:href="btad687f2" position="float"/>
      </fig>
      <p>To mitigate this situation, we draw on another statistic. We divide the CTs according to present or absent enhancer activity. This allows comparing gene activity when the enhancer is active versus inactive (Section 2) by performing a Wilcoxon rank-sum test between target transcriptional signals between cells where the enhancer is active and those where it is not active. We use its associated <italic toggle="yes">P</italic>-value as an indicator of the significance of the ET interaction. For the case of accessibility as a descriptor of enhancer activity, this is visualized in <xref rid="btad687-F2" ref-type="fig">Fig. 2B</xref> where one can see that in those CTs where the enhancer under study is active the target gene tends to be more highly expressed, resulting in a significant <italic toggle="yes">P</italic>-value of the Wilcoxon rank-sum test.</p>
      <p>We further extend this approach by including other descriptors of enhancer activity for cCREs and GENCODE TSS activity. Descriptors for enhancer activity comprise DNAse accessibility and eRNA expression as measured by CAGE tags. On the side of the target promoter/gene activity we use DNAse accessibility and downstream transcript level as measured by microarrays and CAGE-seq. We use three publicly available datasets (<xref rid="btad687-B21" ref-type="bibr">Thurman <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad687-B18" ref-type="bibr">Sheffield <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad687-B1" ref-type="bibr">Andersson <italic toggle="yes">et al.</italic> 2014</xref>) measuring the enhancer and target aforementioned signals in an ensemble of CTs and we calculate the Wilcoxon rank-sum test <italic toggle="yes">P</italic>-value for all enhancers and target pairs within 500 KB. In addition we employ enhancer probabilities generated by CRUP-EP (<xref rid="btad687-B17" ref-type="bibr">Ramisch <italic toggle="yes">et al.</italic> 2019</xref>) which uses H3K4me1, H3K4me3, and H3K27ac ChIP-seq data and predicts the enhancer activity of a genomic region. We used a dataset consisting of CRUP-EP probabilities and RNA-seq TPM values across 66 ENCODE CTs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) and applied the Wilcoxon rank-sum test analysis. For annotating ET pairs, we summarize these four <italic toggle="yes">P</italic>-values into a single Fisher's combined probability (Section 2).</p>
      <p>Based on the way CRUP works, we could also extract probabilities that a region constitutes an active promoter, namely CRUP-PP promoter probability (Section 2). We downloaded H3K4me1, H3K4me3, and H3K27ac ChIP-seq data for 104 CTs from the ENCODE portal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–S4</xref>), and we applied the CRUP-EP and CRUP-PP functions. We complement the across-cell-type information with the Pearson’s correlation coefficient between CRUP-EP and CRUP-PP probabilities over the 104 CTs (Section 2). Thus, the generic information of CENTRE results in three feature values that will be input to the machine learning classifier: (i) Fisher's combined probability, (ii) correlation coefficient of CRUP probabilities, and (iii) the genomic distance between the ET pairs.</p>
    </sec>
    <sec>
      <title>3.3 Features reflecting CT-specific information</title>
      <p>Aggregate statistics obtained from many biosamples are insufficient to delineate CT-specific links. Thus, computational ET prediction methods also use CT-specific assays to capture CT dependent interactions. We designed two kinds of features. Firstly, we want to capture whether an enhancer and promoter are each active. To this end, we again apply the CRUP-EP and CRUP-PP functions (Section 2) to compute from HMs the probabilities for cCRE-ELS and TSS to be active as enhancers or promoters, respectively. Additionally, we use the expression level of the respective target gene as given by the CT-specific RNA-seq data.</p>
      <p>A very important feature in predicting whether cCRE-ELS might target a certain promoter is the genomic distance between the regulatory elements. However, this is a generic feature carrying no information about a particular CT. We again exploit CRUP predictions for regulatory elements to upgrade the genomic distance feature to a “regulatory distance” which describes whether there are many active regulatory elements in the genomic region between the ET pairs, or whether that region is largely devoid of regulatory activity. We apply CRUP-EP and CRUP-PP to the window between the two regulatory elements and extract the fraction of regions classified as enhancers or promoters, respectively. Note that regulatory distance (RD), in contrast to genomic distance alone, captures CT-specific information.</p>
    </sec>
    <sec>
      <title>3.4 Integrating features into a machine learning framework</title>
      <p>Taken together we form features from the following information: (i) Statistics among regulatory element activities in many CTs, as described by the Wilcoxon rank sum test and Pearson’s correlation coefficient, (ii) genomic distance and RD, and (iii) CT-specific regulatory element activity predictions obtained using CRUP and gene expression (<xref rid="btad687-T1" ref-type="table">Table 1</xref>). The CENTRE algorithm combines all these orthogonal sources of information into a single probability score describing the likelihood that an enhancer targets a particular TSS in a given CT. While we exploit ample information to create a priori features from association signals across many CTs, the CT-specific information needed comprises only gene expression plus the three HMs, namely H3K4me1, H3K4me3, and H3K27ac. This latter information is widely available for many cells and can be relatively easily collected for a CT which was not profiled yet. A single feature vector is generated from the combination of across-CT and within-CT-specific information which feeds an XGboost classifier (<xref rid="btad687-B3" ref-type="bibr">Chen and Guestrin 2016</xref>).</p>
      <p>For a proof of concept we tested the ability of individual features to correctly classify ET interactions as derived from GM12878 RNAPII-ChIAPET data (<xref rid="btad687-B20" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2015</xref>) and labeled by <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref>. In <xref rid="btad687-F2" ref-type="fig">Fig. 2C</xref>, we can clearly notice the advantage of the Fisher's combined probability extracted from three publicly available datasets over the average Pearson correlation derived from the same datasets. However, both generic features perform poorly on distinguishing true and false ET interactions on the GM12878 cell line, being inferior to the baseline distance method. When we train the XGboost classifier with CT-specific CRUP probabilities on regulatory elements as well as on the window between them (RD), together with the GM12878 RNA-seq data the performance significantly increases. Combining all the orthogonal variates (across cell-type information, genomic distance, CT-specific gene expression, CRUP predictions) into a single feature vector, CENTRE achieves the highest AUPRC, while still using few CT-specific features.</p>
    </sec>
    <sec>
      <title>3.5 Feature importance</title>
      <p>We ranked features according to their importance, using the number of times they appear in XGBoost trees and tested on GM12878 RNAPII-ChIAPET dataset. Among the leading features in <xref rid="btad687-F2" ref-type="fig">Fig. 2D</xref> one finds both generic and CT-specific features. Genomic distance (position 1), Wilcoxon tests combined (position 6), and CRUP correlation (position 9) are generic features, while positions 2 (RNA-seq), 3 (Normalized Regulatory distance enhancers), and 4 and 5 (CRUP-EPs on promoter) are occupied by CT-specific features. This underlines that both generic and CT-specific features contribute to the overall performance.</p>
      <p>We also applied a Leave-One-Feature-Out (LOFO) importance ranking of the features. Here, for the reduced model the F1-score gets computed. The result is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2A</xref>. This analysis ranks the RNA-seq signal as the most important feature for the model’s performance. The low contribution of some features (including Genomic distance) in the LOFO evaluation can be attributed to the correlated information they offer (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). When we perform LOFO excluding groups of correlated features, the model’s performance drops further, indicating target signals and ET proximity features as the most important ones (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2B</xref>). LOFO also confirms the contribution of both generic and CT-specific features to the overall performance (<xref rid="btad687-F2" ref-type="fig">Fig. 2C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2C</xref>) showing a higher influence for CT-specific features.</p>
      <p>With versions of RD scoring high in feature importance, we further checked whether RD is in fact more informative than mere genomic distance. To this end, we collected enhancer–promoter pairs which interact in LCLs but not in HeLa cells, based on the annotation provided by <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref>. Clearly, for all these ET pairs the genomic distance is the same in the genomes of the two cell lines, while RD can take on different values. <xref rid="btad687-F3" ref-type="fig">Figure 3A</xref> shows a scatter plot comparing normalized enhancer RD (fraction of CRUP-EP-predicted windows in the ET interval) between LCLs and HeLa cells. In the LCLs, where the ET pairs interact, this RD tends to be smaller than in the HeLa cells, where they do not interact. This is evidenced by the regression line which has a smaller slope than the identity. The other version of RD estimates the fraction of active promoters between two regions (CRUP-PP) and is plotted in <xref rid="btad687-F3" ref-type="fig">Fig. 3B</xref>, showing that this count is dramatically lower in the LCLs as compared to HeLa cells. Thus, RD reflects functional context for an ET pair, going beyond the simple genomic distance.</p>
      <fig position="float" id="btad687-F3">
        <label>Figure 3.</label>
        <caption>
          <p>(A) Scatterplot of enhancers’ RD, captured by the normalized CRUP-EP scores applied to the window between 334 ET pairs that interact in LCLs but not in HeLa cell line. (B) Scatterplot of promoters’ RD, captured by the normalized CRUP-PP scores applied to the window between 334 ET pairs that interact in LCLs but not in HeLa cell line. We can notice that both enhancers and promoters’ RD tend to be smaller in LCLs than HeLa cells. (C) Genome Browser view of the MALAT1 gene (ENSG00000251562) which is targeted by the upstream CRE EH38E2964268 in GM12878 but not in HeLa. The enhancer track shows the regions that have higher than 0.5 CRUP-EP probability in the window between the ET pair. The enhancers’ RD is smaller in GM12878 compared to HeLa, as shown by CRUP predicted enhancers track and confirmed by the H3K27ac signals. CENTRE correctly uncovers the CT-specific true interaction in GM12878, while it assigns a very small probability in HeLa, where the specific ET pair does not interact.</p>
        </caption>
        <graphic xlink:href="btad687f3" position="float"/>
      </fig>
      <p>An example of an ET pair where RD makes a difference with respect to the final CENTRE prediction score is given in <xref rid="btad687-F3" ref-type="fig">Fig. 3C</xref>. The cCRE-ELS EH38E2964268 targets the metastasis associated lung adenocarcinoma noncoding RNA gene MALAT1 (ENSG00000251562) in the GM12878 cell line but not in HeLa according to data from <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref>. Indeed, in HeLa we observe an increased number of predicted enhancers (purple track) in the interval between enhancer and target compared to GM12878, where the ET link is active and where we observe fewer predicted enhancers in the interval. This gets reflected in the enhancer’s RD of the ET pair, which is smaller in GM12878 than in HeLa. The CENTRE algorithm correctly predicts the CT-specific link, assigning a probability of interaction of 0.51 in GM12878 but a lower probability of 0.12 in the same pair in HeLa. This is shown in the arcs connecting enhancer and target and which are held in the color of the respective CT. The RNA-seq track shows that the gene is transcribed in both CTs, although the enhancer studied here targets it only in GM12878.</p>
    </sec>
    <sec>
      <title>3.6 Validation using BENGI dataset</title>
      <p>For the validation of CENTRE on multiple CTs, we used the <italic toggle="yes">Benchmark of candidate Enhancer-Gene Interactions</italic> (BENGI) established by <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref>. In their paper the authors evaluated several computational enhancer target identification methods including, in particular, TargetFinder (<xref rid="btad687-B24" ref-type="bibr">Whalen <italic toggle="yes">et al.</italic> 2016</xref>) which was shown to be the best-performing method across all datasets (<xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> 2020</xref>). For the purpose of evaluation, the study puts together a comprehensive testbed annotating pairs of cCREs-ELS and GENCODE TSS with experimental evidence derived from either 3D chromatin interactions (ChIa-PET), HiC, genetic interactions, or CRISPR/dCAS9 perturbations for 13 CTs. To avoid evaluation bias due to dependencies between training and test datasets, the authors also provide 12 cross-validation (CV) groups split by chromosome. This ensures that testing is always performed in different genomic regions than training. We use BENGI datasets and follow their suggested routine of 12-fold CV such that our results should be fully comparable to results reported by <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref>. For evaluation we use F1-score. F1-score is a well-suited metric for highly imbalanced datasets as is the case with the few reported positive interactions in comparison to a large number of noninteracting pairs.</p>
      <p>Before testing the machine learning prediction, we investigated how informative are individual features with respect to distinguishing positive from negative ET pairs. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> presents, for each feature, box plots comparing the respective feature value between the positive and negative pairs. Clearly, the more different they are the more likely this feature will aid in the prediction. This is being summarized in the <italic toggle="yes">P</italic>-value of a <italic toggle="yes">t</italic>-test comparing the two distributions. Generic features and CT-specific features for the target promoter/gene are generally the most significant ones presenting a consistent significant difference between interacting and noninteracting ET pairs across BENGI datasets.</p>
      <p>The full TargetFinder model uses roughly 101 epigenomic and transcriptomic experiments from histone modification ChIP-seq, TF ChIP-seq, DNase-seq, and CAGE-seq, yielding 303 features. Our CENTRE method computes 28 features stemming from only four experiments, namely three ChIP-Seq HMs and RNA-seq. For the initial comparison we used ET datasets derived from five commonly used CTs where all experiments required by TargetFinder are available, which then also includes the four experiments used by CENTRE. <xref rid="btad687-F4" ref-type="fig">Figure 4A</xref> shows the performance of CENTRE compared to TargetFinder (at 12-fold CV) in terms of F1-score. CENTRE achieves a higher F1-score than TargetFinder in 11 out of 13 benchmark datasets, where positive pairs were extracted from five experimental assays applied in five cell lines. Especially when positive pairs come from Hi-C loops, both methods' performance is limited. However, CENTRE is more efficient in uncovering ET interactions across many CTs and experimental techniques. TargetFinder in contrast, although requiring substantially more CT-specific information, performs better than CENTRE in only two ChIAPET RNAPII datasets.</p>
      <fig position="float" id="btad687-F4">
        <label>Figure 4.</label>
        <caption>
          <p>(A) Boxplots representing the F1 scores after 12-fold CV achieved by CENTRE and TargetFinder applied in 13 BENGI datasets (five cell lines) where all experimental assays required by TargetFinder are available. (B) Comparison of CENTRE and TargetFinder in five tissue datasets where a subset of experimental assays required by TargetFinder was used (TargetFinder Reduced model). The asterisk denotes the F1 score of the pre-trained CENTRE on the consensus LCL dataset and applied on the five tissue datasets. (C) Mean F1 scores after 12-fold CV of CENTRE when trained and tested on different datasets. For each test dataset, orange cells highlight the best performing training dataset.</p>
        </caption>
        <graphic xlink:href="btad687f4" position="float"/>
      </fig>
      <p>We extended our evaluation in five tissue datasets where the positive pairs were extracted from eQTL mapping. Since not all TF ChIP-seq datasets needed for training of TargetFinder were available, we reimplemented a reduced TargetFinder model (Section 2) using a subset of 13 features coming from DNase, H3K4me3, H3K27ac, and CTCF experimental assays and genomic distance, as suggested by <xref rid="btad687-B15" ref-type="bibr">Moore <italic toggle="yes">et al.</italic> (2020)</xref>. <xref rid="btad687-F4" ref-type="fig">Figure 4B</xref> shows that CENTRE’s advantage becomes even more evident in these five tissues, significantly outperforming the reduced TargetFinder model. Even though the reduced TargetFinder model uses more CT-specific information than CENTRE, still CENTRE predicts CT-specific ET pairs correctly more often, relying only on a minimal amount of CT-specific information.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref> depicts the top ten features ranked by the number of times they appear in XGBoost trees for all models applied in BENGI datasets. Genomic distance holds the leading position in most of the cases except Geuvadis LCL dataset and Ovary eQTL datasets where the target RNA-seq signal is ranked in the top position.</p>
    </sec>
    <sec>
      <title>3.7 Pre-trained centre framework</title>
      <p>Training a classifier is a complicated process and rather than requiring the user to train a classifier a pre-trained classifier should be provided. Therefore, we provide a pre-trained classifier software that we have trained on a dataset of known ET interactions and that is then ready to make new ET predictions in any CT and context. To this end, the selection of the training dataset is a critical factor for the algorithm's ability in future predictions. Based on the information summarized in <xref rid="btad687-F4" ref-type="fig">Fig. 4</xref>, we focused on K562, GM12878, HeLa cell lines. For these CTs, training ET links were derived from multiple experimental assays in the BENGI benchmark collection. Based on the expectation that these experimental methods capture different aspects of ET interactions, we created joint cell-line-specific consensus datasets and a comprehensive composite dataset consisting of all labeled ET interactions from the three cell lines in a fixed positive-to-negative ratio. We also combined the two best performing datasets according to <xref rid="btad687-F4" ref-type="fig">Fig. 4A and B</xref> (GM12878 RNAPII-ChIAPET and CHi-C, <xref rid="btad687-F4" ref-type="fig">Fig. 4A</xref>) and kept intact the GM12878 RNAPII-ChIAPET (<xref rid="btad687-B20" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2015</xref>) dataset in the training collection since CENTRE achieved its best performance when applied to it.</p>
      <p>For the classifiers trained on this information, we performed extensive performance evaluation on 11 ET datasets coming from three cell lines and six different experimental assays, using the 12 CV scheme to avoid overfitting. According to the results shown in <xref rid="btad687-F4" ref-type="fig">Fig. 4C</xref>, when CENTRE is trained on the consensus LCL training dataset, it presents the most solid performance, achieving the best F1-score in 5 out of 11 testing datasets and the second-best in another three datasets. Noteworthy, among its best-performing test sets, are the K562 and HeLa datasets coming from Hi-C loops, displaying good performance across cell-types.</p>
      <p>Once we homed in on the training set, CENTRE was trained and optimized on the whole consensus LCL dataset (Section 2). The feature importance for the pre-trained classifier is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>. As a proof of concept, we applied the pre-trained classifier on the five eQTL tissue datasets of <xref rid="btad687-F4" ref-type="fig">Fig. 4B</xref>. As we can notice the pre-trained algorithm on the consensus LCL dataset and applied to the whole five tissue datasets performs similarly to the method when trained and tested on the same datasets with 12-fold CV. Noteworthy, it achieves an even better f1 score than the median 12-fold CV scores for three out of five tissue datasets, showing its predictive ability when applied to different CTs. We provide the pre-trained CENTRE framework as ready-to-use R software. For application to a particular CT, it takes as input the CT-specific H3K4me1, H3K4me3, H3K27ac, ChIP-seq data, and RNA-seq TPM values. Then, for a user provided target gene of interest the software predicts the interacting cCRE-ELSs. There is no need for retraining and the inclusion of all the other sources of information in the training is invisible to the user.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this work, we have put forward the CENTRE method to predict interacting enhancer–promoter pairs in a CT of interest. In a real-life application, that CT of interest will typically be a less studied CT and our method requires only a limited set of experimental data to base the prediction on. When training the method, however, we include a wealth of available data to establish a space of feasible interactions. These interactions get reweighted according to the CT-specific information. This process is transparent to the user who does not need to retrain the program but instead only provides the CT-specific data to the trained algorithm. Despite this simplicity in applying CENTRE, the quality of its predictions is generally comparable to, and in some cases better, than the best existing methods.</p>
    <p>Designing a machine learning method not only yields the benefit of the final product, the program, but also allows to study which features contribute and improve the quality of the predictions. We did not attempt to assemble large numbers of features but put a lot of effort into the careful design of the features. In this process we experienced a few surprises. Firstly, in the context of distilling the information from available data across CTs, we found that a rank-sum test between two regulatory features of many CTs adds valuable information on top of that provided by correlations. Clearly, enhancer and promoter activity across many CTs need not be linearly related. For an active ET link both enhancer and promoter/gene intensities (ATAC, CRUP score, RNA-seq) will be high. In an inactive link the relationship between the intensities will be largely random while generally lower than for an active link. A rank-based measure like the rank-sum test appears to detect this more robustly than a correlation coefficient.</p>
    <p>The other insight from the feature design concerns the RD. While genomic distance clearly plays an important role in enhancer–promoter interaction, RD describes how much regulatory activity there is in the interval between enhancer and promoter in the CT under study. We have shown that inclusion of this feature improves prediction, and that RD is connected to the probability of an ET link. This suggests that for the cell it is easier to establish a specific chromatin interaction when in the loop that is excluded there is little other regulatory activity. The concept of inspecting various signals in the window between ET pairs is not new, TargetFinder also uses window signals in its model. However, TargetFinder investigates numerous signals while CENTRE relies only on CRUP probabilities.</p>
    <p>Although CENTRE performs well and compares favorably with TargetFinder, the F1 score on many datasets is still low. To a certain degree this simply reflects the inherent difficulty of the problem of enhancer target prediction. Inclusion of more HMs could possibly improve the annotation of cCREs and RD, but this comes to the cost of extra experiments and makes practical application of our method harder. We also tried to put our method to the toughest tests and present fair comparisons and results, avoiding overfitting issues due to dependent genomic regions in training and test sets. Still, even the choice of validation data strongly influences any performance measurement. We notice that the Hi-C datasets consistently exhibited the lowest overall performance. One possible reason is that Hi-C maps even at 5 kb resolution are too coarse and cannot be used to link distal regulatory elements to their target genes (<xref rid="btad687-B27" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2018</xref>). Another limitation stems from technical challenges in calling Hi-C loops, where different loop-calling methods can produce markedly different results (<xref rid="btad687-B7" ref-type="bibr">Forcato <italic toggle="yes">et al.</italic> 2017</xref>).</p>
    <p>Given the difficulty of the enhancer target prediction problem, there is clearly room for future improvement of our method. In the current version we derive the space of feasible interactions from an analysis of large amounts of epigenetic data. Here the question is whether and how to capitalize on Hi-C data when it is available. Also, we still have to limit the predicted interactions to a distance of 500 kb to avoid large numbers of false positives. Future methodological improvements will hopefully allow extending this interval.</p>
    <p>The pre-trained CENTRE framework is provided as ready-to-use R software where the user gives target genes along with CT-specific H3K4me1, H3K4me3, H3K27ac, ChIP-seq, and RNA-seq TPM data and receives all the interacting and noninteracting predicted enhancers for the genes of interest. Thus, CENTRE provides an accurate, pragmatic framework to distinguish genomic interactions without the need for extensive and costly experiments.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad687_Supplementary_Data</label>
      <media xlink:href="btad687_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the German Ministry of Education and Research (BMBF) [FKZ 01IS18037G].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad687-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andersson</surname><given-names>R</given-names></string-name>, <string-name><surname>Gebhard</surname><given-names>C</given-names></string-name>, <string-name><surname>Miguel-Escalada</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>An atlas of active enhancers across human cell types and tissues</article-title>. <source>Nature</source><year>2014</year>;<volume>507</volume>:<fpage>455</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">24670763</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>F</given-names></string-name>, <string-name><surname>Fullwood</surname><given-names>MJ.</given-names></string-name></person-group><article-title>Inflated performance measures in enhancer–promoter interaction–prediction methods</article-title>. <source>Nat Genet</source><year>2019</year>;<volume>51</volume>:<fpage>1196</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31332378</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>T</given-names></string-name>, <string-name><surname>Guestrin</surname><given-names>C.</given-names></string-name></person-group> XGBoost. In: <italic toggle="yes">Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, San Francisco, USA</italic>. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="btad687-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dekker</surname><given-names>J</given-names></string-name>, <string-name><surname>Marti-Renom</surname><given-names>MA</given-names></string-name>, <string-name><surname>Mirny</surname><given-names>LA</given-names></string-name></person-group><etal>et al</etal><article-title>Exploring the three-dimensional organization of genomes: interpreting chromatin interaction data</article-title>. <source>Nat Rev Genet</source><year>2013</year>;<volume>14</volume>:<fpage>390</fpage>–<lpage>403</lpage>.<pub-id pub-id-type="pmid">23657480</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B5">
      <mixed-citation publication-type="journal"><collab>ENCODE Project Consortium</collab>. <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source><year>2012</year>;<volume>489</volume>:<fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B6">
      <mixed-citation publication-type="journal"><collab>ENCODE Project Consortium</collab><etal>et al</etal><article-title>Expanded encyclopaedias of DNA elements in the human and mouse genomes</article-title>. <source>Nature</source><year>2020</year>;<volume>583</volume>:<fpage>699</fpage>–<lpage>710</lpage>.<pub-id pub-id-type="pmid">32728249</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B19">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fisher</surname><given-names>RA</given-names></string-name></person-group>. <part-title>Statistical methods for research workers</part-title>. In: <italic toggle="yes">Breakthroughs in statistics: Methodology and distribution</italic> 1970 (pp. <fpage>66</fpage>–<lpage>70</lpage>). <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer New York</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btad687-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Forcato</surname><given-names>M</given-names></string-name>, <string-name><surname>Nicoletti</surname><given-names>C</given-names></string-name>, <string-name><surname>Pal</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Comparison of computational methods for Hi-C data analysis</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>679</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">28604721</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fullwood</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Liu</surname><given-names>MH</given-names></string-name>, <string-name><surname>Pan</surname><given-names>YF</given-names></string-name></person-group><etal>et al</etal><article-title>An oestrogen-receptor-alpha-bound human chromatin interactome</article-title>. <source>Nature</source><year>2009</year>;<volume>462</volume>:<fpage>58</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">19890323</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furlong</surname><given-names>EEM</given-names></string-name>, <string-name><surname>Levine</surname><given-names>M.</given-names></string-name></person-group><article-title>Developmental enhancers and chromosome topology</article-title>. <source>Science</source><year>2018</year>;<volume>361</volume>:<fpage>1341</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">30262496</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kent</surname><given-names>WJ</given-names></string-name>, <string-name><surname>Sugnet</surname><given-names>CW</given-names></string-name>, <string-name><surname>Furey</surname><given-names>TS</given-names></string-name></person-group><etal>et al</etal><article-title>The human genome browser at UCSC</article-title>. <source>Genome Res</source><year>2002</year>;<volume>12</volume>:<fpage>996</fpage>–<lpage>1006</lpage>.<pub-id pub-id-type="pmid">12045153</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawrence</surname><given-names>M</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W</given-names></string-name>, <string-name><surname>Pagès</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Software for computing and annotating genomic ranges</article-title>. <source>PLoS Comput Biol</source><year>2013</year>;<volume>9</volume>:<fpage>e1003118</fpage>.<pub-id pub-id-type="pmid">23950696</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E</given-names></string-name>, <string-name><surname>van Berkum</surname><given-names>NL</given-names></string-name>, <string-name><surname>Williams</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source><year>2009</year>;<volume>326</volume>:<fpage>289</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCord</surname><given-names>RP</given-names></string-name>, <string-name><surname>Kaplan</surname><given-names>N</given-names></string-name>, <string-name><surname>Giorgetti</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Chromosome conformation capture and beyond: toward an integrative view of chromosome structure and function</article-title>. <source>Mol Cell</source><year>2020</year>;<volume>77</volume>:<fpage>688</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">32001106</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mifsud</surname><given-names>B</given-names></string-name>, <string-name><surname>Tavares-Cadete</surname><given-names>F</given-names></string-name>, <string-name><surname>Young</surname><given-names>AN</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping long-range promoter contacts in human cells with high-resolution capture Hi-C</article-title>. <source>Nat Genet</source><year>2015</year>;<volume>47</volume>:<fpage>598</fpage>–<lpage>606</lpage>.<pub-id pub-id-type="pmid">25938943</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moore</surname><given-names>JE</given-names></string-name>, <string-name><surname>Pratt</surname><given-names>HE</given-names></string-name>, <string-name><surname>Purcaro</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>A curated benchmark of enhancer–gene interactions for evaluating enhancer–target gene prediction methods</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>:<fpage>17</fpage>.<pub-id pub-id-type="pmid">31969180</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mumbach</surname><given-names>MR</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Flynn</surname><given-names>RA</given-names></string-name></person-group><etal>et al</etal><article-title>HiChIP: efficient and sensitive analysis of protein-directed genome architecture</article-title>. <source>Nat Methods</source><year>2016</year>;<volume>13</volume>:<fpage>919</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">27643841</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramisch</surname><given-names>A</given-names></string-name>, <string-name><surname>Heinrich</surname><given-names>V</given-names></string-name>, <string-name><surname>Glaser</surname><given-names>LV</given-names></string-name></person-group><etal>et al</etal><article-title>CRUP: a comprehensive framework to predict condition-specific regulatory units</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>227</fpage>.<pub-id pub-id-type="pmid">31699133</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sheffield</surname><given-names>NC</given-names></string-name>, <string-name><surname>Thurman</surname><given-names>RE</given-names></string-name>, <string-name><surname>Song</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Patterns of regulatory activity across diverse human cell types predict tissue identity, transcription factor binding, and long-range interactions</article-title>. <source>Genome Res</source><year>2013</year>;<volume>23</volume>:<fpage>777</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">23482648</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Luo</surname><given-names>OJ</given-names></string-name>, <string-name><surname>Li</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>CTCF-mediated human 3D genome architecture reveals chromatin topology for transcription</article-title>. <source>Cell</source><year>2015</year>;<volume>163</volume>:<fpage>1611</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">26686651</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thurman</surname><given-names>RE</given-names></string-name>, <string-name><surname>Rynes</surname><given-names>E</given-names></string-name>, <string-name><surname>Humbert</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source><year>2012</year>;<volume>489</volume>:<fpage>75</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">22955617</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Arensbergen</surname><given-names>J</given-names></string-name>, <string-name><surname>van Steensel</surname><given-names>B</given-names></string-name>, <string-name><surname>Bussemaker</surname><given-names>HJ</given-names></string-name></person-group><etal>et al</etal><article-title>In search of the determinants of enhancer–promoter interaction specificity</article-title>. <source>Trends Cell Biol</source><year>2014</year>;<volume>24</volume>:<fpage>695</fpage>–<lpage>702</lpage>.<pub-id pub-id-type="pmid">25160912</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Visel</surname><given-names>A</given-names></string-name>, <string-name><surname>Blow</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>ChIP-seq accurately predicts tissue-specific activity of enhancers</article-title>. <source>Nature</source><year>2009</year>;<volume>457</volume>:<fpage>854</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">19212405</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whalen</surname><given-names>S</given-names></string-name>, <string-name><surname>Truty</surname><given-names>RM</given-names></string-name>, <string-name><surname>Pollard</surname><given-names>KS</given-names></string-name></person-group><etal>et al</etal><article-title>Enhancer–promoter interactions are encoded by complex genomic signatures on looping chromatin</article-title>. <source>Nat Genet</source><year>2016</year>;<volume>48</volume>:<fpage>488</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">27064255</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>JC</given-names></string-name>, <string-name><surname>Mudge</surname><given-names>J</given-names></string-name>, <string-name><surname>Weisser</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Improving GENCODE reference gene annotation using a high-stringency proteogenomics workflow</article-title>. <source>Nat Commun</source><year>2016</year>;<volume>7</volume>:<fpage>11778</fpage>.<pub-id pub-id-type="pmid">27250503</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S</given-names></string-name>, <string-name><surname>Yi</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>Exploring 3D chromatin contacts in gene regulation: the evolution of approaches for the identification of functional enhancer–promoter interaction</article-title>. <source>Comput Struct Biotechnol J</source><year>2020</year>;<volume>18</volume>:<fpage>558</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">32226593</pub-id></mixed-citation>
    </ref>
    <ref id="btad687-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>An</surname><given-names>L</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>. <source>Nat Commun</source><year>2018</year>;<volume>9</volume>:<fpage>750</fpage>.<pub-id pub-id-type="pmid">29467363</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
