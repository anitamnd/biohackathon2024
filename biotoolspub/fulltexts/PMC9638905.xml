<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9638905</article-id>
    <article-id pub-id-type="pmid">36243974</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkac881</article-id>
    <article-id pub-id-type="publisher-id">gkac881</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/7</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Interpretable deep learning for chromatin-informed inference of transcriptional programs driven by somatic alterations across cancers</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tao</surname>
          <given-names>Yifeng</given-names>
        </name>
        <aff><institution>Computational Biology Department, School of Computer Science, Carnegie Mellon University</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Xiaojun</given-names>
        </name>
        <aff><institution>Department of Biomedical Informatics, School of Medicine, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>UPMC Hillman Cancer Center, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Palmer</surname>
          <given-names>Drake</given-names>
        </name>
        <aff><institution>UPMC Hillman Cancer Center, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4970-2252</contrib-id>
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <aff><institution>Computational Biology Department, School of Computer Science, Carnegie Mellon University</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Department of Biological Sciences, Carnegie Mellon University</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8599-2269</contrib-id>
        <name>
          <surname>Lu</surname>
          <given-names>Xinghua</given-names>
        </name>
        <aff><institution>Department of Biomedical Informatics, School of Medicine, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Department of Pharmaceutical Science, School of Medicine, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3175-1777</contrib-id>
        <name>
          <surname>Osmanbeyoglu</surname>
          <given-names>Hatice Ulku</given-names>
        </name>
        <!--osmanbeyogluhu@pitt.edu-->
        <aff><institution>Department of Biomedical Informatics, School of Medicine, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>UPMC Hillman Cancer Center, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Department of Bioengineering, School of Engineering, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Department of Biostatistics, School of Public Health, University of Pittsburgh</institution>, <addr-line>Pittsburgh</addr-line>, <addr-line>PA</addr-line>, <country country="US">USA</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 412 623 7789; Email: <email>osmanbeyogluhu@pitt.edu</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>28</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-10-16">
      <day>16</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>50</volume>
    <issue>19</issue>
    <fpage>10869</fpage>
    <lpage>10881</lpage>
    <history>
      <date date-type="accepted">
        <day>29</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>01</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkac881.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Cancer is a disease of gene dysregulation, where cells acquire somatic and epigenetic alterations that drive aberrant cellular signaling. These alterations adversely impact transcriptional programs and cause profound changes in gene expression. Interpreting somatic alterations within context-specific transcriptional programs will facilitate personalized therapeutic decisions but is a monumental task. Toward this goal, we develop a partially interpretable neural network model called <bold>C</bold>hromatin-informed <bold>I</bold>nference of <bold>T</bold>ranscriptional <bold>R</bold>egulators <bold>U</bold>sing <bold>S</bold>elf-attention mechanism (CITRUS). CITRUS models the impact of somatic alterations on transcription factors and downstream transcriptional programs. Our approach employs a self-attention mechanism to model the contextual impact of somatic alterations. Furthermore, CITRUS uses a layer of hidden nodes to explicitly represent the state of transcription factors (TFs) to learn the relationships between TFs and their target genes based on TF binding motifs in the open chromatin regions of tumor samples. We apply CITRUS to genomic, transcriptomic, and epigenomic data from 17 cancer types profiled by The Cancer Genome Atlas. CITRUS predicts patient-specific TF activities and reveals transcriptional program variations between and within tumor types. We show that CITRUS yields biological insights into delineating TFs associated with somatic alterations in individual tumors. Thus, CITRUS is a promising tool for precision oncology.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R00 CA207871</award-id>
        <award-id>R01 LM012011</award-id>
        <award-id>R01HG010589</award-id>
        <award-id>R21CA216452</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Center for Machine Learning and Health at Carnegie Mellon University</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>UPMC-ITTC</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Pennsylvania Department of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100004897</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>FP00003273</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Mario Lemieux Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AWS Machine Learning Research Award</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>The complex interplay between signaling inputs and transcriptional responses dictates important cellular functions. Dysregulation of this interplay leads to development and progression of disease, which has been most clearly delineated in the context of certain cancers. Cancer cells acquire somatic alterations that modify signaling and transcriptional programs, leading to profound changes in gene expression. We still lack a complete understanding of how somatic alterations affect cellular function in cancer. To begin to understand these effects, it is important to study somatic alterations within the specific transcriptional context in which they are found. Context- and patient-specific studies can be achieved with machine learning techniques, which are expected to facilitate personalized therapeutic decisions.</p>
    <p>In the last decade, a monumental effort has been made to molecularly profile tumors by consortia, including The Cancer Genome Atlas (TCGA) and the International Cancer Genome Consortium (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>). The multimodal datasets generated by these efforts include gene expression and somatic alterations, such as recurrent mutations and copy number variations (CNVs). The combination of genomic and transcriptomic information enables the integration of transcriptional states with upstream signaling pathways. Several methods have been developed to connect somatic alterations to a prior network or to gene expression (<xref rid="B3" ref-type="bibr">3–9</xref>). More recently, the Genomic Data Analysis Network generated assay for transposase-accessible chromatin with high-throughput sequencing (ATAC-seq) data for a subset of TCGA samples (∼500 patients) (<xref rid="B10" ref-type="bibr">10</xref>). Although chromatin profiling helps uncover context-dependent and/or non-linear effects of transcription factors (TFs) on gene expression, it has not yet been incorporated into methods that connect somatic alterations to transcriptional programs across cancers. Incorporating DNA sequence information at promoter, intronic, and intergenic enhancers from ATAC-seq tumor profiles using TF motif analysis will improve the modeling of transcriptional regulation and delineate the impact of somatic alterations on transcriptional programs.</p>
    <p>Deep learning is a powerful tool for capturing non-linear feature interactions that can explain the underlying biological phenomena. For example, attention mechanism is a deep learning method that has been widely used in computer vision and natural language processing. In contrast to traditional deep learning methods, the self-attention mechanism considers the contextual relationship of the input features and assigns attention weights to each input (<xref rid="B11" ref-type="bibr">11</xref>). In general, attention mechanisms improve the performance of deep learning models and increase the interpretability of the models. More recently, attention mechanisms have been applied to cancer genomics for cancer driver gene detection (<xref rid="B12" ref-type="bibr">12</xref>), drug response prediction (<xref rid="B13" ref-type="bibr">13</xref>) and base editing outcome prediction (<xref rid="B14" ref-type="bibr">14</xref>). For example, the genomic impact transformer (GIT) model utilizes a self-attention mechanism to encode the effects of somatic alterations in cancer and uses multi-layer perceptrons to predict differentially expressed genes (<xref rid="B12" ref-type="bibr">12</xref>). The attention mechanism enables GIT to select driver mutations that are likely to lead to downstream phenotypes. However, the GIT model lacks interpretability in the sense that it does not model intermediate TFs during modeling signaling from somatic alterations to gene expression programs.</p>
    <p>Here, we present <bold>C</bold>hromatin-informed <bold>I</bold>nference of <bold>T</bold>ranscriptional <bold>R</bold>egulators <bold>U</bold>sing <bold>S</bold>elf-attention mechanism (CITRUS), a partially interpretable neural network model with encoder-decoder architecture. CITRUS links somatic alterations to transcriptional programs by modeling the statistical relationships between mutations, CNVs, gene expression, and TF-target gene information derived from ATAC-seq (Figure <xref rid="F1" ref-type="fig">1</xref>). We show that CITRUS yields important biological insights into dysregulated TFs in individual tumors. Using a systematic <italic toggle="yes">in silico</italic> knock out approach, we identified key TFs associated with major somatic alterations. We believe CITRUS will assist researchers in providing actionable hypotheses for follow-up experiments and developing personalized and targeted therapeutics in a pan-cancer setting.</p>
    <fig position="float" id="F1">
      <label>Figure 1.</label>
      <caption>
        <p>Overview of CITRUS: An attention-based model with TF-target gene priors. The input to our framework includes somatic alteration and copy number variation, assay for transposase-accessible chromatin with high-throughput sequencing (ATAC-seq), tumor expression datasets and TF recognition motifs. CITRUS takes somatic alteration and copy number variation data as input and encodes them as a tumor embedding using a self-attention mechanism. Cancer type embedding is used to stratify the confounding factor of tissue type. The middle layer further transforms the tumor embeddings into a TF layer, which represents the inferred activities of 320 TFs. Finally, gene expression levels are predicted from the TF activities through a TF-target gene priors constrained sparse layer based on ATAC-seq.</p>
      </caption>
      <graphic xlink:href="gkac881fig1" position="float"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Data pre-processing</title>
      <p>We downloaded the batch normalized RNA-Seq expression levels quantified by RNA-Seq by Expectation Maximization (RSEM) from the Genomic Data Commons (GDC) portal (<ext-link xlink:href="https://gdc.cancer.gov/about-data/publications/pancanatlas" ext-link-type="uri">https://gdc.cancer.gov/about-data/publications/pancanatlas</ext-link>. We log<sub>2</sub>-transformed RSEM values and identified the 2500 most variable genes across samples within a cancer type. Then, we took the union of the identified genes across cancer types. The final gene set included 5541 genes.</p>
      <p>We obtained processed gene-level somatic alterations for each cancer patient from Cai <italic toggle="yes">et al.</italic> (<xref rid="B4" ref-type="bibr">4</xref>). Genes with non-synonymous mutations, small insert/deletion, or somatic copy number alteration (deletion or amplification) were given a value of 1, and otherwise were given a value of 0. We removed genes that were not present in at least 4% of samples for each cancer type.</p>
      <p>We downloaded the ATAC-seq pan-cancer dataset from the GDC portal (<ext-link xlink:href="https://gdc.cancer.gov/about-data/publications/ATACseq-AWG" ext-link-type="uri">https://gdc.cancer.gov/about-data/publications/ATACseq-AWG</ext-link>) (<xref rid="B10" ref-type="bibr">10</xref>).</p>
      <p>We obtained SILAC-based quantitative phosphoproteomic data set of a spontaneously immortalized non-tumorigenic breast epithelial cell line MCF10A along with two isogenic derivatives generated by knock-in of mutant alleles—one bearing the E545K mutation and the other bearing the H1047R mutation of the <italic toggle="yes">PIK3CA</italic> gene—from the originally published Supplementary Data (<xref rid="B15" ref-type="bibr">15</xref>). We also obtained human protein microarray-based AKT1 kinase assays from the originally published Supplementary Data (<xref rid="B15" ref-type="bibr">15</xref>).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Creating TF-target gene matrix</title>
      <p>To construct a binary TF-target gene matrix across cancer types, we started with an atlas of chromatin accessible regions derived from all tumor types (∼200K peaks) based on ATAC-seq pan-cancer dataset (<xref rid="B10" ref-type="bibr">10</xref>). Therefore, this prior matrix was not tissue specific. We represented every gene by its feature vector of TF motif binding presence, where motif information was summarized across all promoters, intronic, and intergenic chromatin accessible sites assigned to the gene. Briefly, using the MEME (<xref rid="B16" ref-type="bibr">16</xref>) curated <italic toggle="yes">cis</italic>-BP (<xref rid="B17" ref-type="bibr">17</xref>) TF motif binding reference, we scanned the pan-cancer ATAC-seq peak atlas with FIMO (<xref rid="B18" ref-type="bibr">18</xref>) to find peaks likely to contain each motif (<italic toggle="yes">P</italic> &lt; 10<sup>−5</sup>). We filtered TFs that were not expressed in at least 50% of samples in at least one of the seventeen tumor types. Further, similarity of predicted target peak sets was measured using the Jaccard index (size of intersection/size of union). If two TFs had a high Jaccard index (&gt;0.5), we looked at the mean Jaccard index of each TF with all other TFs, and we removed the TF with the largest mean Jaccard index. The final set contained 320 TF binding motifs. Then, we associated each peak to its nearest gene in the human genome using the ChIPpeakAnno package (<xref rid="B19" ref-type="bibr">19</xref>). ATAC-seq peaks located in the body of the transcription unit, together with the 100 kb regions upstream of the transcription start site (TSS) and downstream of the 3′ end, were assigned to the gene. We converted the assigned ATAC peaks for each gene to a feature vector of motif binding signals by assigning the maximum score of each motif across all peaks to a gene. The final TF-target gene matrix <bold>C</bold> ∈ {0,1}<sup><italic toggle="yes">k</italic>×<italic toggle="yes">l</italic></sup> contains a candidate set of associations between TFs and target genes. <italic toggle="yes">C<sub>i,j</sub></italic> = 1 when there is a connection from TF <inline-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> to the gene <inline-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> (red lines connecting the TF layer and target gene expression (Exp) layer in Figure <xref rid="F1" ref-type="fig">1</xref>).</p>
    </sec>
    <sec id="SEC2-3">
      <title>CITRUS model</title>
      <p>CITRUS is a framework for modeling impact of somatic alterations on transcriptional programs through the latent hidden status of the tumor. Figure <xref rid="F1" ref-type="fig">1</xref> shows the model architecture with an overall encoder and decoder structure. Somatic gene alteration inputs with &gt;20K dimensions were encoded into a compressed representation as tumor embedding. Then the tumor embedding, which represents the status of the tumor, was decoded to a large dimension data of gene expression. The encoder-decoder architecture allows the model to capture key features of the high dimension inputs and reduce the data noise as well.</p>
      <p>In the encoder module of the CITRUS model, each mutant gene is mapped into the gene embedding, and aggregated together with cancer type embedding to form the tumor embedding through weighted sum. Like ‘word embedding’ in the natural language processing (NLP) field, our gene embedding represents each distinct somatic alteration with a particular continuous number vector such that somatic alteration that share similar biological functions are located close to each other in embedding space, which is a Euclidean space. It captures the functional similarity among somatic alterations perturbing common pathways. Our pre-trained gene embedding was derived from the gene2vec method based on the co-occurrence information of somatic alterations, which utilized the skip gram word2vec algorithm based on the context-target word pairs. If two mutant genes co-exist with a third gene in similar pattern, they tend to share similar gene embeddings. In the CITRUS model, we uploaded the pre-trained gene embedding and further updated/finetuned it under the supervision of mRNA profile. From the point of the implementation, we created embedding space only for somatic alterations of each tumor, so that the sparse high dimension vector of tumor somatic alterations ( &gt;10k) was converted into a dense 2d array with smaller dimensions <italic toggle="yes">N</italic> × <italic toggle="yes">M</italic>, <italic toggle="yes">N</italic> is the maximal number of gene mutations/copy number events of each tumor (∼1000); <italic toggle="yes">M</italic> is the embedding size (512). This conversion also set up the foundation for self-attention mechanism which in turn to feeds into our attention weight analyses.</p>
      <p>Cancer type embedding acts in a similar way by converting each cancer type into a vector, then merging with gene embedding to form a personalized tumor embedding. The added cancer type information provides additional guidance for the model training in a multi-cancer type data setting and further improves the prediction performance and shortens the training time for the model to converge (see the <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 1</xref>). The condensed tumor embedding, which comprises the attention-weighted gene embedding, and the specified cancer type embedding served as a highly informative entry point for the multi-layer perceptron decoder from which derived our transcriptional factor activities.</p>
      <p>We design a self-attention mechanism which assigned importance weights to input features (somatic alterations) through the model training. Formally, given a specific tumor <inline-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math></inline-formula>, with the cancer type <inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$s$\end{document}</tex-math></inline-formula>, we have a set of somatic alterations in the tumor <inline-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{ {g_u}\} _{u\; = \;1}^m$\end{document}</tex-math></inline-formula> where <italic toggle="yes">m</italic> is number of mutant genes. The encoder module first maps each gene <inline-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$g$\end{document}</tex-math></inline-formula> (it is <inline-formula><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${g_u}$\end{document}</tex-math></inline-formula> here, but we omit the subscript for notation simplicity) into its corresponding gene vector <inline-formula><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${e_g}$\end{document}</tex-math></inline-formula>. Then, the encoder utilizes the multi-head self-attention mechanism to calculate the weighted sum of both the gene embeddings and the cancer type embedding:</p>
      <disp-formula>
        <tex-math id="M0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{e_t} = {e_s} + {{\rm{\alpha }}_1}{e_1} + {{\rm{\alpha }}_2}{e_2} + {{\rm{\alpha }}_3}{e_3} + \ldots + {{\rm{\alpha }}_m}{e_m}\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>The self-attention mechanism takes the gene embeddings of all mutated/altered genes as an input and outputs the attention weights <inline-formula><tex-math id="M0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{ {{\rm{\alpha }}_u}\} _{u\; = \;1}^m$\end{document}</tex-math></inline-formula> through a sub-neural network. To be more specific, in the case of single-head attention mechanism, we first calculate the unnormalized attention weights <inline-formula><tex-math id="M00010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{ {\beta _{g,j}}\} _{g\; = \;1}^m$\end{document}</tex-math></inline-formula>:</p>
      <disp-formula>
        <tex-math id="M00011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\beta _{g,j}} = \theta _j^T\tanh \left( {{W_0}{e_g}} \right),\;g\; = \;1,2, \ldots ,m.\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>where <inline-formula><tex-math id="M00012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\theta _j}$\end{document}</tex-math></inline-formula> is the single-head parameter. Then we normalize the attention weights:</p>
      <disp-formula>
        <tex-math id="M00013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\alpha _{1,j}},{\alpha _{2,j}}, \ldots ,{\alpha _{m,j}} = softmax\left( {{\beta _{1,j}},{\beta _{2,j}}, \ldots ,{\beta _{m,j}}} \right).\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>In the case of multi-head attention mechanism, we have parameters for multiple heads <inline-formula><tex-math id="M00014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{ {\theta _j}\} _{j\; = \;1}^h$\end{document}</tex-math></inline-formula>. The final attention weights are the sum of single head weights:</p>
      <disp-formula>
        <tex-math id="M00015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\alpha _g} = {\alpha _{g,1}} + {\alpha _{g,2}} + \ldots + \;{\alpha _{g,h}},\;g\; = \;1,2, \ldots ,m\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>The attention mechanism captures the context of co-existing somatic alterations and their complex interactions, which is lost in simpler models. Interested readers can find the mathematical details of self-attention mechanisms in the cited reference (<xref rid="B12" ref-type="bibr">12</xref>).</p>
      <p>In the decoder module of CITRUS, we first infer the TF activities from the encoded tumor embedding <inline-formula><tex-math id="M00016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${e_t}$\end{document}</tex-math></inline-formula>:</p>
      <disp-formula>
        <tex-math id="M00017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{e_f} = tanh\left( {{W_f}{e_t} + {b_f}} \right).\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>We used tanh activation instead of ReLU operation, which is more widely used in deep learning, because it has similar performance to that of ReLU in our model and generates more biologically meaningful results (e.g., distribution of TFs <inline-formula><tex-math id="M00018" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${e_f}$\end{document}</tex-math></inline-formula>). Finally, CITRUS predicts cancer type-specific mRNA expression from TF activities:</p>
      <disp-formula>
        <tex-math id="M00019" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\hat y = W{e_f} + {b_r}\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>where <inline-formula><tex-math id="M00020" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W$\end{document}</tex-math></inline-formula> corresponds to the sparse TF–target gene matrix constrained by the prior <inline-formula><tex-math id="M00021" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C \in {\{ 0,1\} ^{k \times l}}$\end{document}</tex-math></inline-formula>. More specifically, to integrate priors into our model, <inline-formula><tex-math id="M00022" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W$\end{document}</tex-math></inline-formula> shares the same shape with prior <inline-formula><tex-math id="M00023" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="M00024" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${W_{i,j}}$\end{document}</tex-math></inline-formula> is allowed to be nonzero only when <inline-formula><tex-math id="M00025" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${C_{i,j}} = 1$\end{document}</tex-math></inline-formula>, and <italic toggle="yes">W<sub>i,j</sub></italic> is constrained to be non-negative value. We use mean square loss function as: <inline-formula><tex-math id="M00026" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$MSE( {y,\hat y} )$\end{document}</tex-math></inline-formula>. The TF–target gene matrix contains the binary constraints that element-wisely define the sparse connections between TFs and potential target genes. During the training of model, only non-zero part of the parameters is allowed to be backpropagated and updated. The rest part of the weight parameters are always zero values throughout the training and inference.</p>
      <p>One might use other common approaches to integrate prior <inline-formula><tex-math id="M00027" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\bf{C}}$\end{document}</tex-math></inline-formula> into the <inline-formula><tex-math id="M00028" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\bf{W}}$\end{document}</tex-math></inline-formula>, i.e. by applying a Gaussian prior to <inline-formula><tex-math id="M00029" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W$\end{document}</tex-math></inline-formula>, which is equivalent to adding an additional penalty to the loss function <inline-formula><tex-math id="M00030" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathop \sum \limits_{i,j:{C_{i,j}} = 0} ( W )_{i,j}^2.$\end{document}</tex-math></inline-formula> However, this ‘soft’ constraint tends to generate less stable TF layers across different runs of training compared to the ‘hard’ constraints shown in our model.</p>
      <p>To prevent overfitting and to increase robustness to noise, we introduced additional dropout operations with a dropout rate of 0.2 after the input layer, activated tumor embedding layer, and activated TF layer.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Training and evaluation</title>
      <p>We implemented CITRUS through the PyTorch package (<ext-link xlink:href="https://pytorch.org/" ext-link-type="uri">https://pytorch.org/</ext-link>), and training was performed using the Adam optimizer with default parameters except for the learning rate (15) and weight decay. We set the learning rate to <inline-formula><tex-math id="M00031" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$1\; \times {10^{ - 3}}$\end{document}</tex-math></inline-formula> and the weight decay to <inline-formula><tex-math id="M00032" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$1\; \times {10^{ - 5}}$\end{document}</tex-math></inline-formula>. We used early stopping with patience of 30 steps to stop training.</p>
      <p>For statistical evaluation, we computed the mean Spearman correlation (<inline-formula><tex-math id="M00033" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rm{\rho }}$\end{document}</tex-math></inline-formula>) between predicted and measured gene expression profiles for each tumor. We held out 20% of samples as the testing set with stratified splitting, preserving the percentage of samples for each cancer type (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table 1</xref>). The remaining 80% of samples were used for training and validation to determine the optimal hyperparameters of the model. For hyperparameter setting, we did 5-fold cross validation by stratified data splitting into 5-fold. Each fold was used for validation after training on the other 4-fold. We utilized mean of the performance over all runs to decide the optimal values of hyperparameters such as the learning rate and batch size. Then, we applied the trained model with selected hyperparameters to the testing set for performance evaluation. To increase the stability of inferred TF activity analysis, we assembled multiple CITRUS models trained with different random initialization state and integrated the TF layer based on the average of 10 trials.</p>
      <p><bold><italic toggle="yes">Parameter selection:</italic></bold> CITRUS includes &gt;10 hyperparameters that are described in the following paragraphs. These hyperparameters were tuned for optimal performance in the validation set. Ideally, hyperparameter optimization is performed using a grid search of all parameters. However, this is not practical due to the tremendous computational cost. For example, three options for each parameter leads to 3<sup>10</sup> possible combinations for just 10 parameters. In addition, we guide the performance metric by <italic toggle="yes">k</italic>-fold cross-validation, and the total experiments necessary would be 5 <inline-formula><tex-math id="M00034" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\; \times$\end{document}</tex-math></inline-formula> 3<sup>10</sup> (<italic toggle="yes">k</italic> = 5). Therefore, our hyperparameter tuning strategy combined automatic and manual tuning. First, we created empirical settings for each parameter and randomly selected a set of parameters from 100 combinations. We utilized the best-performing settings to narrow down the preliminary decisions and correlation among parameters. Then, we tuned parameters independently or in sub-groups manually or by grid search.</p>
      <p><bold><italic toggle="yes">Model robustness:</italic></bold> The learning rate is perhaps the most important hyperparameter in neural network training. We first tested the learning rate in a range of settings [10<sup>−5</sup>, 10<sup>−4</sup>, 10<sup>−3</sup>, 10<sup>−2</sup> …], starting with the lowest setting and progressing to larger values until validation loss started to diverge. We found that if the learning rate was too small, overfitting occurred and picked up input noise. Additionally, overfitting reduced the number of driver genes that were covered in downstream attention weight analyses. If the learning rate was too big, however, the model could not converge to an optima and yielded higher validation loss. Ultimately, we selected learning rates of 10<sup>−3</sup> and 10<sup>−4</sup> and applied a weight penalty (weight decay) to find an optimal combination of settings. We set the weight decay range from 10<sup>−6</sup> to 10<sup>−4</sup> and performed a grid search. The optimal settings for learning rate and weight decay were determined to be 10<sup>−3</sup> and 10<sup>−5</sup>, respectively. Although large batch sizes can accelerate learning rates and training, our experiments indicated that a learning rate of 10<sup>−3</sup> was the largest value that maintained validation accuracy when tested on increasing batch sizes (16, 64, 100 and 300, which is the maximum value that could run in GPU). We found that larger batch sizes tended to have slightly higher gene-wise correlation at the cost of longer training time. To balance execution time, we selected a batch size of 100. The early stopping patience setting is also related to the learning rate and batch size. Specifically, higher learning rates and larger batch sizes require smaller patience to stop training. Higher patience settings may otherwise cause overfitting. Using our selected learning rate and batch size settings, a patience of 30 was generally sufficient to maintain training without stopping too early (underfitting) due to fluctuation and without halting too far from the optima (overfitting). We validated a patience setting of 30 by comparing it with a case of overfitting. We selected the lowest loss point in the overfit training and measured how far it was from the model with early stopping. During early stages of training, the model showed an initial drop in validation performance followed by a rise. To avoid this inconsistency, we did not apply early stopping for the first 180 test steps. To test the attention mechanism, we created a mesh grid for two attention sizes (256, 128) and four attention head settings (32, 16, 8, 4). We then performed an exhaustive grid search within these settings. Based on prediction performance, we selected 256 and eight as the optimal values for attention size and attention head, respectively.</p>
      <p>Finally, we fine-tuned our model by adjusting the dropout rate. Because we used weight decay for regularization, dropout is considered a secondary regularization for our model. In addition to hidden layer dropout, we also applied dropout to our input to reduce input noise and network redundancy and to generate a more stable hidden TF layer. We tested a sequence of five dropout rates (0.1, 0.2, 0.3, 0.4, 0.5). All dropout rate settings yielded performances above 0.9 for average sample correlation in the testing set. We determined the dropout rate optimal value (0.2) primarily based on driver gene coverage in self-attention analyses.</p>
      <p>As we used an early stopping mechanism, we set the maximum iteration parameter to 1000. This setting ensures that the training process stops either once the patience setting is satisfied or once the maximum iterations is reached. Code testing and quick runs were performed with a maximum iteration of one.</p>
      <p>We tested two activation functions: ‘ReLU’ and ‘tanh’. Although both activation functions performed similarly, ‘tanh’ generated more biologically meaningful results and was selected. We also tested l2, minimax and standard normalization (scale) to normalize gene expression and found that scale normalization generated the best prediction accuracy for our model settings.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Training the affinity regression (AR) models</title>
      <p>AR is an algorithm for efficiently solving a regularized bilinear regression problem (<xref rid="B20" ref-type="bibr">20–23</xref>) and was defined in our model as follows. For a data set of <italic toggle="yes">M</italic> tumor samples profiled using RNA-seq with <italic toggle="yes">N</italic> genes, we let <bold>Y∈</bold><italic toggle="yes">R<sup>N</sup></italic><sup>x</sup><italic toggle="yes"><sup>M</sup></italic> be the log<sub>10</sub> gene expression profiles of tumor samples. Each column of <bold>Y</bold> corresponds to an RNA-seq experiment for a cancer type. We define the TF attributes of each gene in a matrix <bold>D ∈</bold><italic toggle="yes">R<sup>N</sup></italic><sup>x</sup><italic toggle="yes"><sup>Q</sup></italic>, where each row represents a gene, and each column represents a TF vector. The TF vector indicates whether there is a binding site for the TF on each gene based on ATAC-seq data. We define the somatic alteration attributes of tumor samples as a matrix <bold>P ∈</bold><italic toggle="yes">R<sup>M</sup></italic><sup>x</sup><italic toggle="yes"><sup>S</sup></italic> where each row represents a tumor sample, and each column represents the somatic alteration status for the tumor sample. We set up a bilinear regression problem to learn the weight matrix <bold>W ∈</bold><italic toggle="yes">R<sup>Q</sup></italic><sup>x</sup><italic toggle="yes"><sup>S</sup></italic> on paired TF and somatic alteration features:</p>
      <disp-formula>
        <tex-math id="M00035" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\bf{DW}}{{\bf{P}}^T}\sim {\bf{Y}}\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>We can transform the system to an equivalent system of equations by reformulating the matrix products as Kronecker products:</p>
      <disp-formula>
        <tex-math id="M00036" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\bf{DW}}{{\bf{P}}^T} \approx {\bf{Y}} \Leftrightarrow ({\bf{P}} \otimes {\bf{D}}){\rm{ vec}}\left( {\bf{W}} \right) \approx {\rm{vec}}\left( {\bf{Y}} \right)\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>where ⊗ is a Kronecker product, and vec is a vectorizing operator that stacks a matrix and produces a vector. The result of this system is a standard (if large-scale) regression problem. Full details and a derivation of the reduced optimization problem are provided elsewhere (<xref rid="B21" ref-type="bibr">21</xref>). For statistical evaluation, we separated datasets by cancer type and conducted 5-fold cross-validation to tune hyperparameters in the training and validation sets as we performed in CITRUS setting.</p>
    </sec>
    <sec id="SEC2-6">
      <title><italic toggle="yes">In silico</italic> knockout analysis</title>
      <p>We implemented an <italic toggle="yes">in silico</italic> knock out approach that removes a specific somatic mutation (or copy number variation) <italic toggle="yes">g</italic> from all the tumor samples that carry it. The new somatic alteration profiles and the CITRUS-inferred TF activities generate a ‘wild type’ corpus that does not contain the alteration <italic toggle="yes">g</italic>. In contrast, the original samples containing the alteration <italic toggle="yes">g</italic> serve as the ‘mutant/altered’ group. We then conducted t-tests between the mutant and wild type groups to evaluate the impact of mutation <italic toggle="yes">g</italic>. This approach captures the contextual effects of mutations through the non-linear attention module of CITRUS and provides a controlled experimental environment that holds all mutations constant except for mutation <italic toggle="yes">g</italic>. For complex genotypes, the model explains TF activity across tumors. We then corrected for multiple hypotheses across models, treating inferred TF activities as separate groups of tests.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Association score between TF activity subtypes and frequent somatic alterations</title>
      <p>For each somatic mutation or copy number variation, we calculated the P-value of its frequency in a cancer subtype compared to other subtypes using Fisher's exact test. The P-value was further adjusted through FDR across subtypes. To identify the relative frequency of a somatic alteration in a subtype, we defined an association score, which is the product of the relative frequency direction and −log10FDR.</p>
    </sec>
    <sec id="SEC2-8">
      <title>Statistical analysis</title>
      <p>Statistical tests were performed with the R statistical environment (4.0.2) and Python. For population comparisons of inferred TF activities, we performed Student's t-tests and determined the direction of shifts by comparing the mean of the two populations. We corrected raw <italic toggle="yes">P</italic>-values for multiple hypothesis testing based on two methods: Bonferroni and FDR (BH method).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Pan-cancer modeling of transcriptional programs</title>
      <p>To systematically interpret somatic alterations within context-specific transcriptional programs and to identify disrupted TFs that drive tumor-specific gene expression patterns across multiple cancer types, we developed CITRUS (Figure <xref rid="F1" ref-type="fig">1</xref>, see Materials and Methods for details). CITRUS traces biological signaling from somatic alterations to signaling pathways, to TFs, and finally to target gene expression (mRNA levels). To enable this tracing, CITRUS employs an encoder-decoder architecture. The encoder module compresses input somatic alterations into a latent vector variable called a tumor embedding. The decoder predicts TF activities from the tumor embedding and then predicts target gene expression. More intuitively, the model learns the flow of information from somatic alterations to altered activity of TFs to their transcriptional changes in target genes.</p>
      <p>We applied this approach to 17 tumors from TCGA and identified key TFs associated with somatic alterations. Our dataset included samples from 17 different tumor types for which mRNA, somatic mutation and copy number variation data were available. ATAC-seq data were available for subset of patients: bladder urothelial carcinoma (BLCA, <italic toggle="yes">n</italic> = 371, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 10), breast cancer (BRCA, <italic toggle="yes">n</italic> = 719, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 75), cervical squamous cell carcinoma and endocervical adenocarcinoma (CESC, <italic toggle="yes">n</italic> = 267, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 4), colorectal adenocarcinoma (COAD, <italic toggle="yes">n</italic> = 271, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 41), esophageal carcinoma (ESCA, <italic toggle="yes">n</italic> = 170, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 18), glioblastoma multiforme (GBM, <italic toggle="yes">n</italic> = 143, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 9), head and neck squamous carcinoma (HNSC, <italic toggle="yes">n</italic> = 475, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 9), kidney renal cell-clear carcinoma (KIRC, <italic toggle="yes">n</italic> = 357, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 16), kidney renal papillary cell carcinoma (KIRP, <italic toggle="yes">n</italic> = 272, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 34), liver hepatocellular carcinoma (LIHC, <italic toggle="yes">n</italic> = 336, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 17), lung adenocarcinoma (LUAD, <italic toggle="yes">n</italic> = 459, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 22), lung squamous cell carcinoma (LUSC, <italic toggle="yes">n</italic> = 430, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 16), pheochromocytoma and paraganglioma (PCPG, <italic toggle="yes">n</italic> = 109, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 9), prostate cancer (PRAD, <italic toggle="yes">n</italic> = 449, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 26), stomach adenocarcinoma (STAD, <italic toggle="yes">n</italic> = 373, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 21), thyroid carcinoma (THCA, <italic toggle="yes">n</italic> = 216, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 14), and uterine corpus endometrial carcinoma (UCEC, <italic toggle="yes">n</italic> = 361, <italic toggle="yes">n</italic><sub>ATAC-seq</sub> = 13).</p>
      <p>For statistical evaluation, we computed the mean Spearman correlation and mean squared error (MSE) between predicted and measured gene expression profiles on the testing set (see Materials and Methods). CITRUS achieved significantly better performance than a regularized bilinear regression algorithm called affinity regression (AR) (<xref rid="B21" ref-type="bibr">21–24</xref>) that was trained independently for each cancer type and explain gene expression across tumors in terms of somatic alteration status and presence of TF motif binding sites based on a pan-cancer ATAC-seq atlas (Figure <xref rid="F2" ref-type="fig">2A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table 2</xref>). We also observed better prediction performance with models built using cancer type embedding compared to without cancer type embedding (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 1</xref>). Moreover, models built without cancer type took ∼1.7× time longer to coverage than the cancer type model.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>CITRUS models the impact of somatic alterations on gene expression programs. (<bold>A</bold>) Performance of CITRUS in each cancer type compared to the regularized bilinear regression method Affinity regression (Affreg). Boxplots show the mean Spearman correlations between predicted and actual gene expression based on CITRUS (orange) and Affreg (light blue) in TCGA datasets for each cancer type. Both CITRUS and Affreg were tuned on the same training and validation sets and evaluated on the same testing set. <bold>(B)</bold> Somatic alteration frequencies and CITRUS-inferred attention weights of genes. Cumulative pan-cancer results are shown on the left, and individual BRCA and HNSC results are shown in the middle and on the right, respectively. See Supplementary Fig. 1 for complete results from each cancer type. (<bold>C</bold>) Principal component analysis (PCA) of TF activity colored by cancer type. Standard TCGA tumor symbols are used to indicate tumor type.</p>
        </caption>
        <graphic xlink:href="gkac881fig2" position="float"/>
      </fig>
      <p>To identify somatic alterations that influenced gene expression programs, we compared the relationship of overall attention weights (inferred by CITRUS) and the frequencies of somatic alterations (used as the control group) across all cancer types and within each cancer type (Figure <xref rid="F2" ref-type="fig">2B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 2</xref>). In general, attention weights were positively correlated with the frequency of somatic alteration. For example, the top altered genes <italic toggle="yes">TP53</italic> and <italic toggle="yes">PIK3CA</italic> had high attention weights. However, our self-attention mechanism assigned low attention weights to many frequently altered genes. We also observed a few infrequently altered genes with high attention weights. For example, the H3K4 methyltransferase KMT2C had a high attention weight in BRCA but was infrequently altered. Indeed, <italic toggle="yes">KMT2C</italic> is a key regulator of ERα activity and anti-estrogen response in breast cancer (<xref rid="B24" ref-type="bibr">24</xref>,<xref rid="B25" ref-type="bibr">25</xref>).</p>
      <p>We found genes with high attention weights were enriched for known cancer drivers using the IntOGen<sup>9</sup> database. We first grouped all the genes into two parts with the threshold of 2 (log(attention + 1) ≥ 2 as the more attended group, and log(attention + 1) &lt; 2 as the less attended group). Using Fisher's exact test, we verified that known cancer driver genes were enriched in the highly attention group (<italic toggle="yes">P</italic> = 4.48 × 10<sup>−41</sup>) in the pan-cancer analysis. We further examined driver enrichment using the frequently mutated genes. We found the frequently mutated genes with lower attention weight were not significantly enriched in cancer drivers (<italic toggle="yes">P</italic> &gt; 0.05, Fisher's exact test) unlike frequently mutated genes with higher attention weight (<italic toggle="yes">P</italic> &lt; 0.05, Fisher's exact test) Briefly, we selected the top 100 frequently mutated genes and divided them into two groups (high attention and low attention group) by several different separation thresholds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table 3</xref>). For each threshold split, we conducted driver enrichment analyses on these two groups respectively with Fisher's Exact test. It consistently shows that the high attention group has a significant driver enrichment (<italic toggle="yes">P</italic> &lt; 0.05) while the low attention group does not (<italic toggle="yes">P</italic> &gt; 0.05).</p>
      <p>We used CITRUS to infer patient-specific TF activities across tumor types. Clustering tumors by these inferred TF activities largely recovered the distinction between major tumor types (Figure <xref rid="F2" ref-type="fig">2C</xref>). Interestingly, samples with squamous morphology components (BLCA, CESC, ESCA, HNSC and LUSC) clustered together. Tumors with tissue or organ similarities or proximity were also clustered together. These included neuroendocrine and glioma tumors (GBM and PCPG), clear cell and papillary renal carcinomas (KIRC and KIRP), a gastrointestinal group (COAD, and STAD), and breast and endometrial cancer (BRCA and UCEC). We also observed similar clustering of the tumor embeddings (Supplementary Fig. 3).</p>
      <p>Next, we assessed TF–tumor type associations by <italic toggle="yes">t</italic>-test and compared inferred TF activities between samples in each tumor type versus those in all other tumor types. We corrected for false discovery rate (FDR) across TFs and identified significant shared and cancer-specific TFs, which are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>. The average TF activity and significance of the four most significant TFs in each cancer are shown in Figure <xref rid="F3" ref-type="fig">3</xref>. Our results highlight both known and novel cancer-specific TF regulators. For example, FUBP1, which regulates <italic toggle="yes">c-Myc</italic> gene transcription, had significantly higher inferred activity in many cancer types, including LIHC, HNSC, BLCA, ESCA, CESC, LUSC, PRAD, BRCA and UCEC. Consistent with previous reports, IRF3 activity was significantly higher in GBM (<xref rid="B26" ref-type="bibr">26</xref>). KLF8 had decreased activity in GBM, LIHC and KIRC, which is consistent with its role in suppressing cell apoptosis during tumor progression (<xref rid="B27" ref-type="bibr">27</xref>). Additionally, YY1, which regulates various developmental processes (<xref rid="B28" ref-type="bibr">28</xref>), had increased activity in CESC and COAD.</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>CITRUS identifies regulatory features of tumor types. Dot plot shows the mean inferred TF activity differences between samples in a given tumor type versus those in all other tumor types by <italic toggle="yes">t</italic>-test. We corrected for FDR across TFs for each pairwise comparison and identified significant TFs. The complete results are included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>. The dot size indicates −log<sub>10</sub>(FDR). For clarity, the union of the top four significant TFs in each cancer type is shown.</p>
        </caption>
        <graphic xlink:href="gkac881fig3" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-2">
      <title>Cancer subtype identification from CITRUS-inferred TF activity and somatic alterations</title>
      <p>Next, we asked whether CITRUS could identify cancer subtypes based on the TF activity associated with somatic alterations. We conducted <italic toggle="yes">k</italic>-means clustering of inferred TF activities for each cancer type to define subtypes, and then we conducted hierarchical clustering of both the cancer subtypes and TF activities. Figure <xref rid="F4" ref-type="fig">4</xref> shows the clustering of subtypes by CITRUS-inferred mean TF activities and corresponding somatic alteration associations (see Methods). We observed major differences in mean TF activities across cancer types and minor but significant differences within cancer types. Variations within a cancer type may arise from distinct mutation or CNV profiles of subgroups. For example, clustering by TF activities revealed subclasses of CESC enriched with <italic toggle="yes">KRAS</italic> mutations; KIRC enriched with <italic toggle="yes">VHL</italic>, <italic toggle="yes">BAP1</italic>, <italic toggle="yes">PBRM1</italic> and <italic toggle="yes">TP53</italic> mutations; LIHC enriched with <italic toggle="yes">CTNNB1</italic>, <italic toggle="yes">BAP1</italic> and <italic toggle="yes">TP53</italic> mutations; THCA enriched with <italic toggle="yes">NRAS</italic>, <italic toggle="yes">HRAS</italic> and <italic toggle="yes">BRAF</italic> mutations; and PCPG enriched with <italic toggle="yes">HRAS</italic> mutations (multiple hypothesis corrected Fisher's exact test <italic toggle="yes">P</italic>-value &lt; 0.05).</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Landscape of somatic alterations and inferred TF activities. (<bold>A</bold>) Heatmap shows tumor subtypes clustered by mean inferred TF activity. The color scale is proportional to TF activity. (B, C) Heatmaps of association scores for (<bold>B</bold>) mutations and (<bold>C</bold>) copy number variations. Association scores were calculated by multiplying the −log<sub>10</sub> FDR by the direction derived from Fisher's exact test.</p>
        </caption>
        <graphic xlink:href="gkac881fig4" position="float"/>
      </fig>
      <p>As our goal was to decipher cancer-specific downstream effects of targeted therapies and to discover secondary targets for combination drug strategies, we developed a systematic statistical approach for modeling the impact of somatic alterations on TF activity. We implemented an <italic toggle="yes">in silico</italic> knock out approach that removes a specific somatic mutation (or CNV) <italic toggle="yes">g</italic> from all carrier tumor samples in each TCGA cancer study and then predicts altered TF activity (see Methods). Using this approach, we were able to identify TFs whose inferred activity was significantly dysregulated by somatic alterations in known cancer driver genes. Figure <xref rid="F5" ref-type="fig">5A</xref> demonstrates TF activities that were associated with somatic alterations in UCEC. CITRUS identified mutations in <italic toggle="yes">PIK3CA</italic>, <italic toggle="yes">PTEN</italic>, <italic toggle="yes">KRAS</italic>, <italic toggle="yes">TP53</italic> and <italic toggle="yes">CTNNB1</italic> that were significantly associated with various TF activities across UCEC tumors (∼66% of tumors have <italic toggle="yes">PTEN</italic> inactivating mutations, ∼50% have <italic toggle="yes">PIK3CA</italic> activating mutations, ∼38% have <italic toggle="yes">TP53</italic> mutations, ∼26% have <italic toggle="yes">CTNNB1</italic> mutations, and ∼20% have <italic toggle="yes">KRAS</italic> mutations). UCEC samples with <italic toggle="yes">PTEN</italic> mutations were mutually exclusive with <italic toggle="yes">TP53</italic>, <italic toggle="yes">CTNNB1</italic>, and <italic toggle="yes">KRAS</italic> mutations and showed distinct TF activity patterns. Mutations in <italic toggle="yes">PTEN</italic> that inactivate its phosphatase activity result in increased PI3K signaling. Consistent with this effect, TFs associated with <italic toggle="yes">PTEN</italic> mutations were involved in cell cycle and differentiation, including E2F5, TP63, ELF3, DBP, ZKSCAN3, LHX2, HOXB6, SOX9, DBP, MYLB1 and GLIS1. TFs associated with <italic toggle="yes">CTNNB1</italic> mutant status were involved in WNT and TGF-beta signaling including TCF7, TCF7L2, TCF7L1, FOXH1, EMX1 and MYBL1.</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Somatic alterations are associated with dysregulated TF activity. Impact of somatic alterations on individual TFs based on <italic toggle="yes">in silico</italic> knock out experiments in (<bold>A</bold>) UCEC and (<bold>B</bold>) BRCA datasets from TCGA. The dot plot shows mean TF activity, and dot size indicates –log<sub>10</sub>(FDR). Vertical axis are mutations and horizontal axis are TFs associated with at least on the mutations. The experiment and control groups are whether the mutation present or not in the patient. To evaluate the impact of mutations on TF activities, we conducted Student's <italic toggle="yes">t</italic>-test on the two groups. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 4</xref> for the full list of cancer types. (<bold>C</bold>) Inferred ETS2 activity in TCGA studies and impact of <italic toggle="yes">TP53</italic> mutations. Tumors with mutant <italic toggle="yes">TP53</italic> have significantly higher ETS2 activity than WT tumors (<italic toggle="yes">P</italic> &lt; 0.01, <italic toggle="yes">t</italic>-test). This association is not significant using mRNA levels of <italic toggle="yes">ETS2</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 6</xref>). Box edges represent the upper and lower quantile with median value shown as a bold line in the middle of the box. Whiskers extend to 1.5 times the quantile.</p>
        </caption>
        <graphic xlink:href="gkac881fig5" position="float"/>
      </fig>
      <p>Similarly, CITRUS identified TF activities that were associated with somatic alterations in BRCA (Figure <xref rid="F5" ref-type="fig">5B</xref>). Mutations in <italic toggle="yes">PIK3CA</italic>, <italic toggle="yes">PTEN</italic>, <italic toggle="yes">MAP2K4</italic>, <italic toggle="yes">GATA3</italic>, <italic toggle="yes">TP53</italic> and <italic toggle="yes">CDH1</italic> were significantly associated with various TF activities. In BRCA, ∼36% of tumors have <italic toggle="yes">PIK3CA</italic> activating mutations, ∼35% have <italic toggle="yes">TP53</italic> mutations, ∼15% have <italic toggle="yes">GATA3</italic> mutations, ∼15% have <italic toggle="yes">CDH1</italic> mutations, ∼10% have <italic toggle="yes">PTEN</italic> mutations, and ∼7% have <italic toggle="yes">MAP2K4</italic> mutations. Activating mutations in <italic toggle="yes">PIK3CA</italic> often occur in one of three hotspot locations (E545K, E542K and H1047R) and promote constitutive signaling through the pathway. TFs associated with <italic toggle="yes">PIK3CA</italic> mutations were involved in WNT signaling, epithelial–mesenchymal transition, and cancer stem cell transition, including ELF3, TFEC, STAT4, STAT5B, NFATC1, GLIS1, CDC5L and AR. We also examined protein microarray-based AKT1 kinase assay and SILAC-based phosphoproteomic data from isogenic knock-in breast cell lines harboring mutations of PIK3CA (<xref rid="B15" ref-type="bibr">15</xref>). Of 20 TFs represented in the phosphoproteomic data associated with mutant <italic toggle="yes">PIK3CA</italic>, 16 of them associated with PIK3CA mutation in our analysis (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table 4</xref>). Moreover, of the seven TFs identified as AKT substrates, six of them were associated with PIK3CA mutation in our analysis (FDR-adjusted <italic toggle="yes">P</italic>-value &lt; 0.05) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table 5</xref>).</p>
      <p>BRCA samples with <italic toggle="yes">PIK3CA</italic> and <italic toggle="yes">TP53</italic> mutations were mutually exclusive, and our <italic toggle="yes">in silico</italic> knock out analysis associated distinct TFs with these mutations. <italic toggle="yes">TP53</italic> mutant tumors were associated with increased activity of TFs that have roles in tumor growth, such as ETS2 and FOSB, growth modulation, such as THAP1, CREB3L1 and CEBPZ, and development, such as MEF2C/D, MEOX1 and MSX1. We performed similar analyses for other cancer types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 4</xref>).</p>
      <p>Although the TFs affected by some somatic alterations differed between cancer types, mutation of <italic toggle="yes">TP53</italic> was associated with similar TFs across cancer types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 5</xref>). <italic toggle="yes">TP53</italic> is one of the most frequently inactivated tumor suppressor genes that suffers from missense mutations in human cancer. These missense mutations result in the expression of a mutant form of p53 protein. We observed that inferred <italic toggle="yes">TP53</italic> activity was lower when <italic toggle="yes">TP53</italic> was mutated compared to wild type for most cancer types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 6</xref>). Mutant p53 protein can disable other tumor suppressors (e.g. p63 and p73) or enable oncogenes, such as ETS2 (<xref rid="B29" ref-type="bibr">29</xref>). Indeed, the inferred TF activity of ETS2 was higher in mutant versus WT <italic toggle="yes">TP53</italic> tumors across cancers (Figure <xref rid="F5" ref-type="fig">5C</xref>); however, these differences were not as significant at the gene expression level (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 7</xref>). We also observed significant upregulation of motif-based targets of ETS2 based on ATAC-seq relative to all genes in the TCGA tumor data excluding GBM (<italic toggle="yes">P</italic>-value &lt; 1e−6, Kolmogorov–Smirnov test, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure 8</xref>) consistent with our analysis.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Analysis of the regulatory network in tumor datasets is challenging due to the complexity of the cancer genome (e.g. aneuploidy, CNVs, structural variation, and mutations). CITRUS provides a systematic framework for integrating regulatory genomics with tumor expression and somatic alterations to better understand how expression programs are affected by somatic alterations in cancers and to infer patient-specific TF activities. Our method uses a deep learning framework called a self-attention mechanism to capture the complex contextual interactions between somatic alterations. For a more accurate representation of TF-target gene relationships, we leveraged ATAC-seq tumor data from TCGA patients. CITRUS is designed to capture the flow of information from altered genes (e.g. signaling proteins) to TFs to target genes, and our <italic toggle="yes">in silico</italic> knock out analysis predicts the causal impact of somatic alterations. Joint modeling across different tumor types also revealed patient subgroups associated with somatic alterations.</p>
    <p>The key advantage of the CITRUS model is that it enables the detection and representation of the functional impact of somatic alterations on transcription factors, which in turn enables detection of common mechanisms of tumors even if tumors host different somatic alteration. Further, a specific mutated gene usually contains a specific type of mutations, so in a lot of cases, the mutated gene is already very informative of the mutation types. In cases where a somatic alteration is associated with the activity of a targetable TF or their upstream/downstream component the knowledge of putative downstream positive and negative effectors can aid in the identification of combination therapies. For example, one could perform shRNA or CRISPR/Cas screening of downstream TFs to identify those whose knockdown/deletion leads to reduced/enhanced proliferation. This mechanistic information could inform the development of combination therapies, e.g. by selecting agents known to alter activity of these specific TFs.</p>
    <p>One limitation of the TF binding motif approach utilized by CITRUS is that TFs of the same family often share a similar motif and thus are difficult to disambiguate. Therefore, TF motifs may encompass the activities of multiple TFs. Moreover, co-binding TF binding patterns (e.g. AP-1−IRF complexes) can be biologically meaningful for gene expression and are not currently represented in our model. Future models will work to represent these composite elements as features. Another limitation is that we do not represent directionality in the TF–target gene priors (i.e. whether a gene is activated or repressed by a TF). Prior knowledge of whether the TF is acting as an activator or as a repressor would add meaningful interpretation to inferred TF activities. These limitations may confound the interpretation of the activity of TFs with context-specific activator and repressor roles. Further, regulatory network analysis of tumor datasets is also complicated by the presence of stromal/immune cells within the tumor and the heterogeneity of the cancer cells themselves. However, our framework can be extended to model single-cell RNA-seq or deconvoluted RNA-seq via computational methods.</p>
    <p>Despite these limitations, modeling the impact of somatic alterations on transcriptional programs may ultimately enable the development of individualized therapies, aid in understanding mechanisms of drug resistance, and allow the identification of biomarkers of response. We anticipate that computational modeling of transcriptional regulation across different tumor types will emerge as an important tool in precision oncology, aiding in the eventual goal of selecting the best therapeutic option for individual patients.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>ATAC-seq data are available in the public repository Genomic Data Commons (<ext-link xlink:href="https://gdc.cancer.gov/about-data/publications/ATACseq-AWG" ext-link-type="uri">https://gdc.cancer.gov/about-data/publications/ATACseq-AWG</ext-link>). RNA-seq gene expression, somatic mutation, copy number variation, and clinical data are available in a public repository from TCGA’s Firehose data run (<ext-link xlink:href="https://confluence.broadinstitute.org/display/GDAC/Dashboard-Stddata" ext-link-type="uri">https://confluence.broadinstitute.org/display/GDAC/Dashboard-Stddata</ext-link>). Only the samples ‘whitelisted’ by TCGA for the Pan-Cancer Analysis Working Group were used in the study. For our analysis, we only used samples with parallel RNA-seq, somatic mutation, and GISTIC copy number data. Processed input and output files have been made available at the supplementary website for the paper: <ext-link xlink:href="https://sites.pitt.edu/~xim33/CITRUS" ext-link-type="uri">https://sites.pitt.edu/∼xim33/CITRUS</ext-link>.</p>
  </sec>
  <sec id="SEC6">
    <title>CODE AVAILABILITY</title>
    <p>The software for CITRUS is available at <ext-link xlink:href="https://github.com/osmanbeyoglulab/CITRUS" ext-link-type="uri">https://github.com/osmanbeyoglulab/CITRUS</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkac881_Supplemental_Files</label>
      <media xlink:href="gkac881_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>The results published here are based on data generated by The Cancer Genome Atlas project established by the NCI and NHGRI (accession number: phs000178.v7p6). Information about TCGA and the investigators and institutions that constitute TCGA research network can be found at <ext-link xlink:href="http://cancergenome.nih.gov/" ext-link-type="uri">http://cancergenome.nih.gov/</ext-link>. We thank Jacob Stewart-Ornstein, Eneda Toska, Jing Hong Wang and Harinder Singh for helpful discussions. The content of this manuscript is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health or other funding agencies. The Pennsylvania Department of Health specifically disclaims responsibility for any analyses, interpretations, or conclusions.</p>
  </ack>
  <sec id="SEC7">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkac881#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC8">
    <title>FUNDING</title>
    <p>National Institutes of Health [R00 CA207871 to H.U.O.]; National Institutes of Health [R01 LM012011 to X.L.]; Fellowship in Digital Health from the Center for Machine Learning and Health at Carnegie Mellon University (to Y.T.); UPMC-ITTC fund (to R.S.); National Institutes of Health [R01HG010589, R21CA216452 to R.S.]; Pennsylvania Department of Health [FP00003273 to R.S.]; Mario Lemieux Foundation (to R.S.); AWS Machine Learning Research Award (to R.S.). Funding for open access charge: National Institutes of Health.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><collab>ICGC/TCGA Pan-Cancer Analysis of Whole Genomes Consortium</collab><article-title>Pan-cancer analysis of whole genomes</article-title>. <source>Nature</source>. <year>2020</year>; <volume>578</volume>:<fpage>82</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">32025007</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Cancer Genome Atlas Research Network</collab><string-name><surname>Weinstein</surname><given-names>J.N.</given-names></string-name>, <string-name><surname>Collisson</surname><given-names>E.A.</given-names></string-name>, <string-name><surname>Mills</surname><given-names>G.B.</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>K.R.</given-names></string-name>, <string-name><surname>Ozenberger</surname><given-names>B.A.</given-names></string-name>, <string-name><surname>Ellrott</surname><given-names>K.</given-names></string-name>, <string-name><surname>Shmulevich</surname><given-names>I.</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C.</given-names></string-name>, <string-name><surname>Stuart</surname><given-names>J.M.</given-names></string-name></person-group><article-title>The cancer genome atlas pan-cancer analysis project</article-title>. <source>Nat. Genet.</source><year>2013</year>; <volume>45</volume>:<fpage>1113</fpage>–<lpage>1120</lpage>.<pub-id pub-id-type="pmid">24071849</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Ng</surname><given-names>K.S.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>T.B.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F.</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>K.</given-names></string-name>, <string-name><surname>Scott</surname><given-names>K.L.</given-names></string-name>, <string-name><surname>Meric-Bernstam</surname><given-names>F.</given-names></string-name>, <string-name><surname>Mills</surname><given-names>G.B.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K.</given-names></string-name></person-group><article-title>Cancer driver mutation prediction through bayesian integration of multi-omic data</article-title>. <source>PLoS One</source>. <year>2018</year>; <volume>13</volume>:<fpage>e0196939</fpage>.<pub-id pub-id-type="pmid">29738578</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cai</surname><given-names>C.</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>G.F.</given-names></string-name>, <string-name><surname>Lu</surname><given-names>K.N.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>X.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>S.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X.</given-names></string-name>, <string-name><surname>Xue</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>A.V.</given-names></string-name>, <string-name><surname>Clark</surname><given-names>N.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Systematic discovery of the functional impact of somatic genome alterations in individual tumors through tumor-specific causal inference</article-title>. <source>PLoS Comput. Biol.</source><year>2019</year>; <volume>15</volume>:<fpage>e1007088</fpage>.<pub-id pub-id-type="pmid">31276486</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofree</surname><given-names>M.</given-names></string-name>, <string-name><surname>Shen</surname><given-names>J.P.</given-names></string-name>, <string-name><surname>Carter</surname><given-names>H.</given-names></string-name>, <string-name><surname>Gross</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ideker</surname><given-names>T.</given-names></string-name></person-group><article-title>Network-based stratification of tumor mutations</article-title>. <source>Nat. Methods</source>. <year>2013</year>; <volume>10</volume>:<fpage>1108</fpage>–<lpage>1115</lpage>.<pub-id pub-id-type="pmid">24037242</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paull</surname><given-names>E.O.</given-names></string-name>, <string-name><surname>Carlin</surname><given-names>D.E.</given-names></string-name>, <string-name><surname>Niepel</surname><given-names>M.</given-names></string-name>, <string-name><surname>Sorger</surname><given-names>P.K.</given-names></string-name>, <string-name><surname>Haussler</surname><given-names>D.</given-names></string-name>, <string-name><surname>Stuart</surname><given-names>J.M.</given-names></string-name></person-group><article-title>Discovering causal pathways linking genomic events to transcriptional states using tied diffusion through interacting events (TieDIE)</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>2757</fpage>–<lpage>2764</lpage>.<pub-id pub-id-type="pmid">23986566</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basha</surname><given-names>O.</given-names></string-name>, <string-name><surname>Mauer</surname><given-names>O.</given-names></string-name>, <string-name><surname>Simonovsky</surname><given-names>E.</given-names></string-name>, <string-name><surname>Shpringer</surname><given-names>R.</given-names></string-name>, <string-name><surname>Yeger-Lotem</surname><given-names>E.</given-names></string-name></person-group><article-title>ResponseNet v.3: revealing signaling and regulatory pathways connecting your proteins and genes across human tissues</article-title>. <source>Nucleic Acids Res.</source><year>2019</year>; <volume>47</volume>:<fpage>W242</fpage>–<lpage>W247</lpage>.<pub-id pub-id-type="pmid">31114913</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bashashati</surname><given-names>A.</given-names></string-name>, <string-name><surname>Haffari</surname><given-names>G.</given-names></string-name>, <string-name><surname>Ding</surname><given-names>J.</given-names></string-name>, <string-name><surname>Ha</surname><given-names>G.</given-names></string-name>, <string-name><surname>Lui</surname><given-names>K.</given-names></string-name>, <string-name><surname>Rosner</surname><given-names>J.</given-names></string-name>, <string-name><surname>Huntsman</surname><given-names>D.G.</given-names></string-name>, <string-name><surname>Caldas</surname><given-names>C.</given-names></string-name>, <string-name><surname>Aparicio</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Shah</surname><given-names>S.P.</given-names></string-name></person-group><article-title>DriverNet: uncovering the impact of somatic driver mutations on transcriptional networks in cancer</article-title>. <source>Genome Biol.</source><year>2012</year>; <volume>13</volume>:<fpage>R124</fpage>.<pub-id pub-id-type="pmid">23383675</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ng</surname><given-names>S.</given-names></string-name>, <string-name><surname>Collisson</surname><given-names>E.A.</given-names></string-name>, <string-name><surname>Sokolov</surname><given-names>A.</given-names></string-name>, <string-name><surname>Goldstein</surname><given-names>T.</given-names></string-name>, <string-name><surname>Gonzalez-Perez</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lopez-Bigas</surname><given-names>N.</given-names></string-name>, <string-name><surname>Benz</surname><given-names>C.</given-names></string-name>, <string-name><surname>Haussler</surname><given-names>D.</given-names></string-name>, <string-name><surname>Stuart</surname><given-names>J.M.</given-names></string-name></person-group><article-title>PARADIGM-SHIFT predicts the function of mutations in multiple cancers using pathway impact analysis</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>:<fpage>i640</fpage>–<lpage>i646</lpage>.<pub-id pub-id-type="pmid">22962493</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Corces</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>Granja</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Shams</surname><given-names>S.</given-names></string-name>, <string-name><surname>Louie</surname><given-names>B.H.</given-names></string-name>, <string-name><surname>Seoane</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>W.</given-names></string-name>, <string-name><surname>Silva</surname><given-names>T.C.</given-names></string-name>, <string-name><surname>Groeneveld</surname><given-names>C.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>C.K.</given-names></string-name>, <string-name><surname>Cho</surname><given-names>S.W.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The chromatin accessibility landscape of primary human cancers</article-title>. <source>Science</source>. <year>2018</year>; <volume>362</volume>:<fpage>eaav1898</fpage>.<pub-id pub-id-type="pmid">30361341</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaswani</surname><given-names>A.</given-names></string-name>, <string-name><surname>Shazeer</surname><given-names>N.</given-names></string-name>, <string-name><surname>Parmar</surname><given-names>N.</given-names></string-name>, <string-name><surname>Uszkoreit</surname><given-names>J.</given-names></string-name>, <string-name><surname>Jones</surname><given-names>L.</given-names></string-name>, <string-name><surname>Gomez</surname><given-names>A.N.</given-names></string-name>, <string-name><surname>Kaiser</surname><given-names>L.</given-names></string-name>, <string-name><surname>Polosukhin</surname><given-names>I.</given-names></string-name></person-group><source>Adv. Neural Inf. Process. Syst.</source><year>2017</year>; <fpage>5998</fpage>–<lpage>6008</lpage>.</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tao</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Cai</surname><given-names>C.</given-names></string-name>, <string-name><surname>Cohen</surname><given-names>W.W.</given-names></string-name>, <string-name><surname>Lu</surname><given-names>X.</given-names></string-name></person-group><article-title>From genome to phenome: predicting multiple cancer phenotypes based on somatic genomic alterations via the genomic impact transformer</article-title>. <source>Pac. Symp. Biocomput.</source><year>2020</year>; <volume>25</volume>:<fpage>79</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">31797588</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cadow</surname><given-names>J.</given-names></string-name>, <string-name><surname>Born</surname><given-names>J.</given-names></string-name>, <string-name><surname>Manica</surname><given-names>M.</given-names></string-name>, <string-name><surname>Oskooei</surname><given-names>A.</given-names></string-name>, <string-name><surname>Rodriguez Martinez</surname><given-names>M.</given-names></string-name></person-group><article-title>PaccMann: a web service for interpretable anticancer compound sensitivity prediction</article-title>. <source>Nucleic Acids Res.</source><year>2020</year>; <volume>48</volume>:<fpage>W502</fpage>–<lpage>W508</lpage>.<pub-id pub-id-type="pmid">32402082</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marquart</surname><given-names>K.F.</given-names></string-name>, <string-name><surname>Allam</surname><given-names>A.</given-names></string-name>, <string-name><surname>Janjuha</surname><given-names>S.</given-names></string-name>, <string-name><surname>Sintsova</surname><given-names>A.</given-names></string-name>, <string-name><surname>Villiger</surname><given-names>L.</given-names></string-name>, <string-name><surname>Frey</surname><given-names>N.</given-names></string-name>, <string-name><surname>Krauthammer</surname><given-names>M.</given-names></string-name>, <string-name><surname>Schwank</surname><given-names>G.</given-names></string-name></person-group><article-title>Predicting base editing outcomes with an attention-based deep learning algorithm trained on high-throughput target library screens</article-title>. <source>Nat. Commun.</source><year>2021</year>; <volume>12</volume>:<fpage>5114</fpage>.<pub-id pub-id-type="pmid">34433819</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Renuse</surname><given-names>S.</given-names></string-name>, <string-name><surname>Sahasrabuddhe</surname><given-names>N.A.</given-names></string-name>, <string-name><surname>Zahari</surname><given-names>M.S.</given-names></string-name>, <string-name><surname>Chaerkady</surname><given-names>R.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>M.S.</given-names></string-name>, <string-name><surname>Nirujogi</surname><given-names>R.S.</given-names></string-name>, <string-name><surname>Mohseni</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>P.</given-names></string-name>, <string-name><surname>Raju</surname><given-names>R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Activation of diverse signalling pathways by oncogenic PIK3CA mutations</article-title>. <source>Nat. Commun.</source><year>2014</year>; <volume>5</volume>:<fpage>4961</fpage>.<pub-id pub-id-type="pmid">25247763</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>T.L.</given-names></string-name>, <string-name><surname>Boden</surname><given-names>M.</given-names></string-name>, <string-name><surname>Buske</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Frith</surname><given-names>M.</given-names></string-name>, <string-name><surname>Grant</surname><given-names>C.E.</given-names></string-name>, <string-name><surname>Clementi</surname><given-names>L.</given-names></string-name>, <string-name><surname>Ren</surname><given-names>J.</given-names></string-name>, <string-name><surname>Li</surname><given-names>W.W.</given-names></string-name>, <string-name><surname>Noble</surname><given-names>W.S.</given-names></string-name></person-group><article-title>MEME SUITE: tools for motif discovery and searching</article-title>. <source>Nucleic Acids Res.</source><year>2009</year>; <volume>37</volume>:<fpage>W202</fpage>–<lpage>W208</lpage>.<pub-id pub-id-type="pmid">19458158</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weirauch</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>A.</given-names></string-name>, <string-name><surname>Albu</surname><given-names>M.</given-names></string-name>, <string-name><surname>Cote</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>Montenegro-Montero</surname><given-names>A.</given-names></string-name>, <string-name><surname>Drewe</surname><given-names>P.</given-names></string-name>, <string-name><surname>Najafabadi</surname><given-names>H.S.</given-names></string-name>, <string-name><surname>Lambert</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Mann</surname><given-names>I.</given-names></string-name>, <string-name><surname>Cook</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Determination and inference of eukaryotic transcription factor sequence specificity</article-title>. <source>Cell</source>. <year>2014</year>; <volume>158</volume>:<fpage>1431</fpage>–<lpage>1443</lpage>.<pub-id pub-id-type="pmid">25215497</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grant</surname><given-names>C.E.</given-names></string-name>, <string-name><surname>Bailey</surname><given-names>T.L.</given-names></string-name>, <string-name><surname>Noble</surname><given-names>W.S.</given-names></string-name></person-group><article-title>FIMO: scanning for occurrences of a given motif</article-title>. <source>Bioinformatics</source>. <year>2011</year>; <volume>27</volume>:<fpage>1017</fpage>–<lpage>1018</lpage>.<pub-id pub-id-type="pmid">21330290</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>L.J.</given-names></string-name>, <string-name><surname>Gazin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Lawson</surname><given-names>N.D.</given-names></string-name>, <string-name><surname>Pages</surname><given-names>H.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>S.M.</given-names></string-name>, <string-name><surname>Lapointe</surname><given-names>D.S.</given-names></string-name>, <string-name><surname>Green</surname><given-names>M.R.</given-names></string-name></person-group><article-title>ChIPpeakAnno: a bioconductor package to annotate chip-seq and chip-chip data</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>; <volume>11</volume>:<fpage>237</fpage>.<pub-id pub-id-type="pmid">20459804</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Osmanbeyoglu</surname><given-names>H.U.</given-names></string-name>, <string-name><surname>Pelossof</surname><given-names>R.</given-names></string-name>, <string-name><surname>Bromberg</surname><given-names>J.F.</given-names></string-name>, <string-name><surname>Leslie</surname><given-names>C.S.</given-names></string-name></person-group><article-title>Linking signaling pathways to transcriptional programs in breast cancer</article-title>. <source>Genome Res.</source><year>2014</year>; <volume>24</volume>:<fpage>1869</fpage>–<lpage>1880</lpage>.<pub-id pub-id-type="pmid">25183703</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pelossof</surname><given-names>R.</given-names></string-name>, <string-name><surname>Singh</surname><given-names>I.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Weirauch</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Hughes</surname><given-names>T.R.</given-names></string-name>, <string-name><surname>Leslie</surname><given-names>C.S.</given-names></string-name></person-group><article-title>Affinity regression predicts the recognition code of nucleic acid-binding proteins</article-title>. <source>Nat. Biotechnol.</source><year>2015</year>; <volume>33</volume>:<fpage>1242</fpage>–<lpage>1249</lpage>.<pub-id pub-id-type="pmid">26571099</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Osmanbeyoglu</surname><given-names>H.U.</given-names></string-name>, <string-name><surname>Toska</surname><given-names>E.</given-names></string-name>, <string-name><surname>Chan</surname><given-names>C.</given-names></string-name>, <string-name><surname>Baselga</surname><given-names>J.</given-names></string-name>, <string-name><surname>Leslie</surname><given-names>C.S.</given-names></string-name></person-group><article-title>Pancancer modelling predicts the context-specific impact of somatic mutations on transcriptional programs</article-title>. <source>Nat. Commun.</source><year>2017</year>; <volume>8</volume>:<fpage>14249</fpage>.<pub-id pub-id-type="pmid">28139702</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>X.</given-names></string-name>, <string-name><surname>Somasundaram</surname><given-names>A.</given-names></string-name>, <string-name><surname>Qi</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Hartman</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Singh</surname><given-names>H.</given-names></string-name>, <string-name><surname>Osmanbeyoglu</surname><given-names>H.U.</given-names></string-name></person-group><article-title>SPaRTAN, a computational framework for linking cell-surface receptors to transcriptional regulators</article-title>. <source>Nucleic Acids Res.</source><year>2021</year>; <volume>49</volume>:<fpage>9633</fpage>–<lpage>9647</lpage>.<pub-id pub-id-type="pmid">34500467</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gala</surname><given-names>K.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Sinha</surname><given-names>A.</given-names></string-name>, <string-name><surname>Razavi</surname><given-names>P.</given-names></string-name>, <string-name><surname>Dorso</surname><given-names>M.</given-names></string-name>, <string-name><surname>Sanchez-Vega</surname><given-names>F.</given-names></string-name>, <string-name><surname>Chung</surname><given-names>Y.R.</given-names></string-name>, <string-name><surname>Hendrickson</surname><given-names>R.</given-names></string-name>, <string-name><surname>Hsieh</surname><given-names>J.J.</given-names></string-name>, <string-name><surname>Berger</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>KMT2C mediates the estrogen dependence of breast cancer through regulation of ERalpha enhancer function</article-title>. <source>Oncogene</source>. <year>2018</year>; <volume>37</volume>:<fpage>4692</fpage>–<lpage>4710</lpage>.<pub-id pub-id-type="pmid">29755131</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jozwik</surname><given-names>K.M.</given-names></string-name>, <string-name><surname>Chernukhin</surname><given-names>I.</given-names></string-name>, <string-name><surname>Serandour</surname><given-names>A.A.</given-names></string-name>, <string-name><surname>Nagarajan</surname><given-names>S.</given-names></string-name>, <string-name><surname>Carroll</surname><given-names>J.S.</given-names></string-name></person-group><article-title>FOXA1 directs H3K4 monomethylation at enhancers via recruitment of the methyltransferase MLL3</article-title>. <source>Cell Rep.</source><year>2016</year>; <volume>17</volume>:<fpage>2715</fpage>–<lpage>2723</lpage>.<pub-id pub-id-type="pmid">27926873</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarassishin</surname><given-names>L.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S.C.</given-names></string-name></person-group><article-title>Interferon regulatory factor 3 alters glioma inflammatory and invasive properties</article-title>. <source>J. Neurooncol.</source><year>2013</year>; <volume>113</volume>:<fpage>185</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">23512614</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Xing</surname><given-names>H.</given-names></string-name>, <string-name><surname>Li</surname><given-names>C.</given-names></string-name>, <string-name><surname>Liang</surname><given-names>L.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X.F.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>L.Y.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>M.C.</given-names></string-name>, <string-name><surname>Shen</surname><given-names>F.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>T.</given-names></string-name></person-group><article-title>A novel role of Kruppel-like factor 8 as an apoptosis repressor in hepatocellular carcinoma</article-title>. <source>Cancer Cell Int.</source><year>2020</year>; <volume>20</volume>:<fpage>422</fpage>.<pub-id pub-id-type="pmid">32874135</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Stovall</surname><given-names>D.B.</given-names></string-name>, <string-name><surname>Inoue</surname><given-names>K.</given-names></string-name>, <string-name><surname>Sui</surname><given-names>G.</given-names></string-name></person-group><article-title>The oncogenic role of yin yang 1</article-title>. <source>Crit. Rev. Oncog.</source><year>2011</year>; <volume>16</volume>:<fpage>163</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">22248053</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martinez</surname><given-names>L.A.</given-names></string-name></person-group><article-title>Mutant p53 and ETS2, a tale of reciprocity</article-title>. <source>Front. Oncol.</source><year>2016</year>; <volume>6</volume>:<fpage>35</fpage>.<pub-id pub-id-type="pmid">26925389</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
