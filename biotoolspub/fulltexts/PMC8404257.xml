<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8404257</article-id>
    <article-id pub-id-type="publisher-id">4338</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04338-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Conifer: clonal tree inference for tumor heterogeneity with single-cell and bulk sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Baghaarabani</surname>
          <given-names>Leila</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Goliaei</surname>
          <given-names>Sama</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Foroughmand-Araabi</surname>
          <given-names>Mohammad-Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shariatpanahi</surname>
          <given-names>Seyed Peyman</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Goliaei</surname>
          <given-names>Bahram</given-names>
        </name>
        <address>
          <email>goliaei@ut.ac.ir</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.46072.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 0612 7950</institution-id><institution>Institute of Biochemistry and Biophysics, </institution><institution>University of Tehran, </institution></institution-wrap>Tehran, Iran </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.46072.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 0612 7950</institution-id><institution>Faculty of New Sciences and Technologies, </institution><institution>University of Tehran, </institution></institution-wrap>Tehran, Iran </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.412553.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 0740 9747</institution-id><institution>Department of Mathematical Sciences, </institution><institution>Sharif University of Technology, </institution></institution-wrap>Tehran, Iran </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>416</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Genetic heterogeneity of a cancer tumor that develops during clonal evolution is one of the reasons for cancer treatment failure, by increasing the chance of drug resistance. Clones are cell populations with different genotypes, resulting from differences in somatic mutations that occur and accumulate during cancer development. An appropriate approach for identifying clones is determining the variant allele frequency of mutations that occurred in the tumor. Although bulk sequencing data can be used to provide that information, the frequencies are not informative enough for identifying different clones with the same prevalence and their evolutionary relationships. On the other hand, single-cell sequencing data provides valuable information about branching events in the evolution of a cancerous tumor. However, the temporal order of mutations may be determined with ambiguities using only single-cell data, while variant allele frequencies from bulk sequencing data can provide beneficial information for inferring the temporal order of mutations with fewer ambiguities.
</p>
      </sec>
      <sec>
        <title>Result</title>
        <p id="Par2">In this study, a new method called Conifer (ClONal tree Inference For hEterogeneity of tumoR) is proposed which combines aggregated variant allele frequency from bulk sequencing data with branching event information from single-cell sequencing data to more accurately identify clones and their evolutionary relationships. It is proven that the accuracy of clone identification and clonal tree inference is increased by using Conifer compared to other existing methods on various sets of simulated data. In addition, it is discussed that the evolutionary tree provided by Conifer on real cancer data sets is highly consistent with information in both bulk and single-cell data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In this study, we have provided an accurate and robust method to identify clones of tumor heterogeneity and their evolutionary history by combining single-cell and bulk sequencing data.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04338-7.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Heterogeneity of tumor</kwd>
      <kwd>Clonal tree</kwd>
      <kwd>Bulk sequencing</kwd>
      <kwd>Single-cell sequencing</kwd>
      <kwd>Bayesian nonparametric model</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">Genetic mutation is a major cause of abnormal cell growth and cancer. Although cancer cells are usually derived from one mutated cell initially and therefore share mutated genes, new mutations may happen in cancer development [<xref ref-type="bibr" rid="CR1">1</xref>]. In other words, cancer cells in a tumor are not homogeneous and tumor genomic heterogeneity is shown in many studies [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. A tumor consists of different clones, each of which is a set of cells sharing a common genotype inherited from a common ancestor [<xref ref-type="bibr" rid="CR4">4</xref>]. In order to understand individual tumors heterogeneity and their phylogenetic inference which can probably be a helpful component for personalized cancer treatment, it is critical to properly identify their clones, determine the development stage of cancer cells and identify early single-nucleotide variants (SNVs) that have led to rapid cell growth [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par13">Sequencing of bulk data that focuses on DNA of a mixture of thousands or millions of cancerous and/or normal cells is widely used for providing a mixed signal of variant allele frequencies (VAFs) for each somatic mutation. In order to discover the evolutionary history, bulk sequencing data needs deconvolution analysis [<xref ref-type="bibr" rid="CR8">8</xref>], which often includes two successive deduction steps. At the first step, co-occurred SNV clusters are deduced by deconvolving the mixed signal of the bulk sample [<xref ref-type="bibr" rid="CR9">9</xref>]. Afterward, the evolutionary relationship between clusters is deduced by using SNV cluster frequencies [<xref ref-type="bibr" rid="CR10">10</xref>]. However, in some methods such as PhyloWGS [<xref ref-type="bibr" rid="CR11">11</xref>], these two inference steps are carried out jointly to avoid SNV clusters that are phylogenetically incompatible. In most tumor heterogeneity analyses based on bulk sequencing data such as PyClone [<xref ref-type="bibr" rid="CR9">9</xref>], PhyloSub [<xref ref-type="bibr" rid="CR12">12</xref>], Clomial [<xref ref-type="bibr" rid="CR13">13</xref>], and AncesTree [<xref ref-type="bibr" rid="CR14">14</xref>], it is generally supposed that SNVs with similar VAFs belong to the same clone.</p>
    <p id="Par14">It is shown in various cases that only relying on frequencies observed in a bulk sample may not be enough to infer the evolutionary history, and taking multiple samples is required [<xref ref-type="bibr" rid="CR8">8</xref>]. In addition, the assumption that SNVs with similar frequencies belong to the same clone may be violated, since a tumor may be composed of clones with similar frequencies but different genotypes.</p>
    <p id="Par15">Moreover, even though low-frequency SNVs are common and can play a decisive role in tumor diversity, the process of their prevalence discovery from bulk sequencing is not accurate enough [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par16">To achieve higher resolution for inferring evolutionary history, single-cell sequencing was introduced, which allows direct acquisition of cell genotypes without the need to deconvolution of mixed signals [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR20">20</xref>], and resulted in reducing the possibility of ignoring low-frequency SNVs. In addition, single-cell information about co-occurred SNVs can be used to differentiate between clusters of SNVs with the same prevalence [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p id="Par17">Single-cell sequencing is well used in methods like SCITE [<xref ref-type="bibr" rid="CR22">22</xref>], OncoNEM [<xref ref-type="bibr" rid="CR23">23</xref>], and SiFit [<xref ref-type="bibr" rid="CR24">24</xref>] to infer mutational trees, though clonal frequencies are not reported in them. Furthermore, in SiCloneFit [<xref ref-type="bibr" rid="CR25">25</xref>], a nonparametric Bayesian mixture model based on a Chinese Restaurant Process (CRP) is introduced to infer the clonal genotypes and their evolution based on a finite-sites model. Although SiCloneFit has an assumption in clonal tree inference that each node of the tree can only have up to two children (binary tree), however the polytomies of the binary clonal tree can be inferred by removing the branches which are unsupported by mutations in a post-processing step. On the other hand, Conifer can directly infer a tumor phylogeny with polytomy by the joint modeling of bulk and single-cell sequencing data.</p>
    <p id="Par18">Despite all of its advantages, the single-cell sequencing approach is costly and error-prone. False-positive errors occur due to the DNA amplification error, and false-negative errors occur due to the missing of one or both alleles (dropout). Furthermore, another type of noise may occur in data as a result of accidental sequencing of two or more cells.</p>
    <p id="Par19">Considering the advantages and disadvantages of bulk and single-cell sequencing data, the idea of utilizing both data types is used in several studies, to reduce inaccuracies in each approach and consequently achieve more accurate clonal tree inference. As an example of the benefits of this combination, the temporal order of mutations can be determined using decreasing VAFs from bulk sequencing data with fewer ambiguities than using only single-cell data. On the other hand, branching events in the evolutionary tree can be inferred more accurately with single-cell data.</p>
    <p id="Par20">ddClone [<xref ref-type="bibr" rid="CR26">26</xref>] analyzes intra-tumor heterogeneity using single-cell and bulk sequencing data and proposes a probabilistic model based on the nonparametric Bayesian method to deduce tumor clones. The prior of the Bayesian method is obtained from single-cell data, and the likelihood is obtained from bulk sequencing data. However, ddClone does not infer tumor phylogeny and is not sufficient for understanding cancer tumor evolution.</p>
    <p id="Par21">B-SCITE [<xref ref-type="bibr" rid="CR21">21</xref>] is the first computational approach that infers tumor phylogeny from combined single-cell and bulk sequencing data. This probabilistic method searches for tumor phylogenetic trees to maximize the joint likelihood of the two data types. In this method, tree search is carried out with a customized Markov chain Monte Carlo (MCMC) algorithm over the space of labeled trees [<xref ref-type="bibr" rid="CR21">21</xref>]. B-SCITE is mainly designed for inferring mutational trees and straightforward clonal tree inference is not provided.</p>
    <p id="Par22">In addition, PhISCS [<xref ref-type="bibr" rid="CR27">27</xref>] is a combinatorial approach that uses integer linear programming for mutational tree inference based on single-cell and bulk sequencing data. However, PhISCS does not infer tumor subclones and their evolutionary relationship directly.</p>
    <p id="Par23">In this study, we have proposed a new method Conifer, which utilizes both single-cell and bulk sequencing data to infer tumor clones and their evolutionary relationship. In contrast to SiCloneFit, there is no limitation on the depth and number of branches of the inferred tree of Conifer. In Conifer single-cell sequencing data is used to resolve the challenge of identifying similar prevalent clones in the tumor and to resolve ambiguities in the phylogeny inference. On the other hand, Conifer uses bulk sequencing data to reduce the negative effects of sampling biases and false-negative mutations. Based on our knowledge, Conifer is the first method that introduces the tumor clonal tree using both single-cell and bulk sequencing data.</p>
    <p id="Par24">As clones and their evolutionary tree are not predefined, Conifer provides a Bayesian nonparametric model and a tree-structure Chinese Restaurant Process (CRP) is used as its prior. To approximate the posterior of the Bayesian model, the particular MCMC algorithm that Conifer performs is a Collapsed Gibbs Sampling in which some of the latent variables are marginalized out to speed up the coverage of the chain. As a result, Conifer introduces a clonal tree in which each node represents the clonal genotypes that have occurred together and are shared between different cells. It is noteworthy that Conifer employs the infinite sites assumption (ISA) which implies that mutations persist once occurred. In nodes closer to the tree root, corresponding clonal genotypes are shared between a larger number of cells, while moving away from the root and towards the leaves, clones become more specialized to particular cells in those paths.</p>
    <p id="Par25">We evaluated Conifer performance in clone identification comprehensively on various simulated datasets with different numbers of clones, bulk and single-cell samples, etc. and compared it with the best methods such as B-SCITE [<xref ref-type="bibr" rid="CR21">21</xref>] and ddClone [<xref ref-type="bibr" rid="CR26">26</xref>] in the field, based on V-measure [<xref ref-type="bibr" rid="CR28">28</xref>] and adjusted rand score [<xref ref-type="bibr" rid="CR29">29</xref>] criteria. Moreover, Conifer introduces the clonal evolutionary trees on simulated data which are compared with methods like B-SCITE [<xref ref-type="bibr" rid="CR21">21</xref>], OncoNEM [<xref ref-type="bibr" rid="CR23">23</xref>], and PhyloWGS [<xref ref-type="bibr" rid="CR11">11</xref>] based on co-clustering accuracy and ancestor–descendant accuracy criteria (the definition of these criteria are given in [<xref ref-type="bibr" rid="CR21">21</xref>]). In conclusion, Conifer has higher accuracy in clone identification and phylogeny inference than other existing methods in most cases. In addition, Conifer is more evaluated on real data sets of cancer by comparing its evolutionary tree with other methods. By deep investigation, it is shown that Conifer evolutionary tree is completely consistent with VAFs of mutations in bulk data and also co-occurrence of mutations in single-cell data.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <p id="Par26">Conifer uses mutation co-occurrence information in single-cell data for inferring tree branching alongside the VAFs in bulk sequencing data for identifying clones and their temporal ordering. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, it is shown schematically how two data types are connected to infer the clonal tree. As it is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, single-cell data is represented as a matrix with rows and columns showing SNVs and cells, respectively, and each element indicating the presence or absence of corresponding SNV in a cell. Moreover, bulk sequencing data is considered as a matrix in which each element presents VAFs related to SNV in different bulk sequencing samples (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic representation of combining single-cell and bulk sequencing data for clonal tree inference in Conifer method, <bold>a</bold>
<inline-formula id="IEq157"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times m$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq157.gif"/></alternatives></inline-formula> matrix in which each row and column represents SNVs and cell, respectively. White elements show no mutation and blue ones show mutation has occurred. 1 and 0 with the red font show false-positive and false-negative (drop-out events), respectively, <bold>b</bold>
<inline-formula id="IEq158"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times b$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq158.gif"/></alternatives></inline-formula> matrix that its rows are SNVs and its columns are bulk samples and <inline-formula id="IEq159"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{ij}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq159.gif"/></alternatives></inline-formula> is variant allele frequency in bulk samples, <bold>c</bold> co-occurred patterns of SNVs in single-cell profiles which are determined by dashed rectangles, <bold>d</bold> the inferred clonal tree and cell attachment</p></caption><graphic xlink:href="12859_2021_4338_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par27">In the Conifer method, it is assumed that SNVs with similar VAFs in different bulk samples most likely belong to a common cluster, unless there is no single-cell showing two SNVs have co-occurred. All co-occurred patterns in the single-cell profile are considered as the prior knowledge for mutation clustering. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, the co-occurred patterns are shown as dashed rectangles. Using these patterns, the clonal tree with attached single-cell samples can be inferred, with the mutations of each pattern presented in each of its path (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Clustering technique and phylogenetic inference are described in detail in the “Material and method” section.</p>
    <sec id="Sec3">
      <title>Performance on simulated data</title>
      <p id="Par28">Since the clonal tree is not known for data of real cancer tumors, a complete set of data is simulated and used to evaluate the performance of Conifer. To simulate data, the idea of ddClone [<xref ref-type="bibr" rid="CR26">26</xref>] and B-SCITE [<xref ref-type="bibr" rid="CR21">21</xref>] studies are used (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details). The simulated data covers various cell counts (25,50,100 and 500), numbers of clones (10, 15, 20, and 40), and different types of error in single-cell data. The root node of each clonal tree represents a healthy cell population, and SNVs are randomly distributed between other nodes.</p>
      <p id="Par29">For evaluating the accuracy of the Conifer inferred clonal tree, it is compared with B-SCITE [<xref ref-type="bibr" rid="CR21">21</xref>], OncoNEM [<xref ref-type="bibr" rid="CR23">23</xref>], and PhyloWGS [<xref ref-type="bibr" rid="CR11">11</xref>] according to the co-clustering accuracy measure. B-SCITE uses both single-cell and bulk sequencing data while OncoNEM and PhyloWGS use only single-cell and only bulk sequencing data, respectively.</p>
      <p id="Par30">In addition, the ancestor–descendant accuracy measure is used for comparing the Conifer tree with B-SCITE in the presence of copy number variation (CNV). The plots are generated by ggplot2 [<xref ref-type="bibr" rid="CR30">30</xref>] to illustrate the accuracy of the methods on different criteria.</p>
      <p id="Par31">Additionally, for evaluating the accuracy of clustering, the V-measure [<xref ref-type="bibr" rid="CR28">28</xref>] and the adjusted rand score [<xref ref-type="bibr" rid="CR29">29</xref>] criteria are used which are implemented in scikit-learn Python package 0.19.2. Their corresponding scores are between 0 and 1, which 0 represents random labeling independent of the number of clusters and 1 shows the accurate clustering.</p>
      <p id="Par32">In order to measure the method sensitivity respecting errors in single-cell sequencing data, different types of errors such as assortment bias and doublet rate are examined and explained in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Assortment bias error is indicated by the parameter <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq1.gif"/></alternatives></inline-formula>, large values of which present less assortment bias and equivalently less difference between single-cell and bulk genotype prevalence.</p>
      <sec id="Sec4">
        <title>Clonal tree accuracy</title>
        <p id="Par33">Comparison of Conifer with B-SCITE and PhyloWGS methods using the co-clustering accuracy measure is shown in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref> for 100 simulated clonal trees with 10 clones and 25, 50, and 100 numbers of cells and 1 and 2 bulk sequencing samples with coverage of 10,000. Simulated single-cell data which is used by both Conifer and B-SCITE is generated with the false-positive rate of <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${10}^{-5}$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq2.gif"/></alternatives></inline-formula>, the false-negative rate of 0.2, the missing rate of 0.05, and the doublet rate of 0.1 with various ranges of values for <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq3.gif"/></alternatives></inline-formula> (<inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \hspace{0.17em}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mspace width="1.69998pt"/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq4.gif"/></alternatives></inline-formula>= 1, 5, 10, and 1000), while PhyloWGS method uses only bulk sequencing data. Instead of only mutations which are common between single-cell and bulk sequencing data, all mutations in bulk data are considered in this comparison. As it is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> for one bulk sample and Fig. <xref rid="Fig3" ref-type="fig">3</xref> for two bulk samples, although the performance of all three methods is improved by increasing the number of bulk samples, Conifer shows the highest accuracy for different single-cell sequencing data and different numbers of bulk samples. In addition, in both Conifer and B-SCITE methods, for a specific number of bulk samples, the accuracy is increased by increasing the number of single cells. Also, the accuracy of B-SCITE is decreased by decreasing the value of <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq5.gif"/></alternatives></inline-formula> while Conifer is almost stable for different values of <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq6.gif"/></alternatives></inline-formula>. Additionally, it should be noted that although the doublet rate is not considered in the Conifer model, it is accurate with doublet rate of 0.1 according to the results shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of co-clustering accuracy in B-SCITE, Conifer, and PhyloWGS models for 100 clonal trees simulated with 10 clones and 50 mutations and for <inline-formula id="IEq160"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M20"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq160.gif"/></alternatives></inline-formula> = 1, 5, 10 and 1000. For single-cell data 25, 50, and 100 genotypes are extracted for each clonal tree. There are two bulk sequencing samples with a coverage of 10,000. The following errors are added to the single-cell data: the false-positive rate of 10<sup>–5</sup>, the false-negative rate of 0.2, the missing rate of 0.05, and the doublet rate of 0.1</p></caption><graphic xlink:href="12859_2021_4338_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of co-clustering accuracy in B-SCITE, Conifer, and PhyloWGS models for 100 clonal trees simulated with 10 clones and 50 mutations. For <inline-formula id="IEq161"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M22"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq161.gif"/></alternatives></inline-formula> = 1, 5, 10 and 1000. For single-cell data 25, 50, and 100 genotypes are extracted for each clonal tree. The number of bulk sequencing samples is 2 with a coverage of 10,000. The following errors are added to the single-cell data: the false-positive rate of 10<sup>–5</sup>, the false-negative rate of 0.2, the missing rate of 0.05, and the doublet rate of 0.1</p></caption><graphic xlink:href="12859_2021_4338_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par34">The above comparison is repeated between Conifer and OncoNEM and shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. As OncoNEM uses only single-cell data, only SNVs which are common between single-cell and bulk sequencing data are considered in Conifer to make the comparison meaningful. Conifer is run with one bulk sequencing sample and shows better accuracy than OncoNEM for various ranges of values for <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq7.gif"/></alternatives></inline-formula>. Moreover, improved performance of OncoNEM for larger values of <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq8.gif"/></alternatives></inline-formula> together with the high accuracy of Conifer even for small values of <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq9.gif"/></alternatives></inline-formula> is evidence for the effectiveness of Conifer’s approach in combining single-cell and bulk sequencing data, as large values of λ indicate less difference between single-cell and bulk genotype frequencies.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of co-clustering accuracy in OncoNEM and Conifer models for 100 clonal trees simulated with 20 clones and 100 mutations and for <inline-formula id="IEq162"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M30"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq162.gif"/></alternatives></inline-formula> = 1, 5, 10 and 1000. For single-cell data 25, 50, and 100 genotypes are extracted for each clonal tree. There is one bulk sequencing sample with a coverage of 10,000. The following errors are added to the single-cell data: the false-positive rate of 10<sup>–5</sup>, the false-negative rate of 0.2, the missing rate of 0.05, and the doublet rate of 0.1</p></caption><graphic xlink:href="12859_2021_4338_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec5">
        <title>The presence of CNV</title>
        <p id="Par35">Although Conifer assumes that SNVs are obtained from the copy-number-neutral regions and the VAFs are not affected by copy number variations, it is still accurate regarding the alterations of CNV, on account of the fact that single-cell sequencing data is also used for clone identification and tree inference. VAF alterations by CNV can result in the incorrect inference of mutation clustering in models that only rely on VAFs similarities in bulk sequencing data.</p>
        <p id="Par36">Comparisons of the ancestor–descendant accuracy measure for Conifer and B-SCITE on two simulated data sets with 30% and 50% of CNV are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1 and S2, respectively. It can be concluded that the accuracy of Conifer is not affected significantly by changing the proportion of CNVs and it is more accurate than B-SCITE for various numbers of cells in both data sets.</p>
      </sec>
      <sec id="Sec6">
        <title>Clone identification accuracy</title>
        <p id="Par37">Accuracy of Conifer, ddClone, and B-SCITE methods in SNV clustering is evaluated and compared in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S3 and S4, for 100 clonal trees simulated with 10, 20, and 40 clones, 100 SNVs, one bulk sequencing sample with coverage of 10,000, and 50 single-cell genotypes. Simulated single-cell data is generated with the following errors: the false-positive rate of <inline-formula id="IEq10"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${10}^{-5}$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq10.gif"/></alternatives></inline-formula>, the false-negative rate of 0.2, the missing rate of 0.05, and the doublet rate of 0.1. In this comparison, the mutations that are not present in single-cell sequencing data are ignored. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3, Conifer has outperformed both methods in various numbers of clones and various ranges of values for λ according to adjusted rand score measure. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4, both Conifer and B-SCITE perform very well in detecting the correct clones according to the V-measure, while ddClone presents lower accuracy. As it can be concluded from Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4, the results of all three methods are not highly sensitive to different values of λ.</p>
      </sec>
      <sec id="Sec7">
        <title>Large false-positive rates</title>
        <p id="Par38">The performance of Conifer is more evaluated for larger values of false-positive rates. The inferred trees of Conifer, B-SCITE, and OncoNEM are compared in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5 for the false-positive rate of 1%. With this relatively large false-positive rate the co-clustering accuracy is slightly decreased for all three methods, however, Conifer's accuracy is still in an acceptable range. By increasing the value of λ the accuracy of all methods improves and Conifer has the largest accuracy among them for λ = 1000. In addition, the clustering accuracy is compared between Conifer and ddClone using the V-measure accuracy for larger values of false-positive rate of 5% and 10%. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6 it is shown that although the V-measure accuracy is moderately decreased by larger values of false-positive rates, Conifer is still accurate enough and outperforms ddClone. However, this accuracy decrease is because false-positive errors can violate the assumed co-occurrence of mutations which is used by Conifer as prior knowledge in clustering of SNVs based on their VAFs.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Performance on real data</title>
      <sec id="Sec9">
        <title>Colorectal cancer</title>
        <p id="Par39">Conifer performance is further evaluated on real data of a patient (CRC2) with colorectal cancer which is provided in the study of Leung et al. [<xref ref-type="bibr" rid="CR31">31</xref>]. It is noteworthy that in this dataset there are two bulk sequencing data of primary and metastatic tumors together with single-cell sequencing data.</p>
        <p id="Par40">For CRC2 patient, 182 cells are sequenced from the primary colorectal and liver metastatic tumors. The number of SNVs reported by the original study is 36. Genotypes reported as binary values indicate the presence or absence of mutation in an SNV locus. In this study, cells with no mutation are ignored and 25 SNVs and 86 cells are considered for CRC2 patient.</p>
        <p id="Par41">The clonal tree inferred by Conifer for this dataset is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Each branch in the tree represents the mutation profile of one or a set of cells, and each clone is a set of mutations that have occurred in a branch and their VAF frequencies are similar in different bulk sequencing samples.<fig id="Fig5"><label>Fig. 5</label><caption><p>Clonal evolution tree inferred by Conifer for CRC2 patient tumor data. For each SNV, two numbers are reported: VAFs in colorectal tumor bulk sample and metastasis liver bulk sample</p></caption><graphic xlink:href="12859_2021_4338_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par42">Conifer method introduces a tree with 7 nodes (clones) so that the root node is for the non-mutant genotype (C1) and two nodes C2 and C3 are its descendants. C2 is a cluster that contains somatic mutations (SPEN_1, NR3C2, EPHB6, ATR). It is different from primary and metastatic tumor clones and has a separate branch in the clonal tree. This clone and its separated branch are also mentioned in the original study of Leung et al. [<xref ref-type="bibr" rid="CR31">31</xref>]. C3 is the first evolved clone from healthy cells and has nine mutations, including tp53 which is a tumor suppressor gene. The cell population CP3 is attached to C3 clonal genotype.</p>
        <p id="Par43">In the evolutionary process after formation of the C3 clone and before tumor metastasis, the C4 clone is formed with mutations (CHN1, ATP7B, APC: 1, LRP1B) and CP4 cell population. This clone is introduced as a result of VAFs similarity and mutation occurrence in one single-cell profile. In the original study of Leung et al. [<xref ref-type="bibr" rid="CR31">31</xref>], SCITE method [<xref ref-type="bibr" rid="CR22">22</xref>] is used to infer the evolutionary tree of mutation, and two distinct branches for metastatic cells are reported based on single-cell sequencing data, assuming that the mutations are not missed during evolution.</p>
        <p id="Par44">Based on both bulk and single-cell sequencing data, Conifer method shows that a group of cells of the primary clone C4 has migrated to the liver, and this migration has occurred only once. Conifer concludes that the migrated cells are subjected to the FUS mutation in the liver, creating the clone C5 and then evolved into two separate branches. The reason that Conifer represents the FUS mutation as a separate clone is although the FUS mutation should belong to the clone C6 considering neighboring mutations with close frequencies based on single-cell data, as the VAF is not similar to other mutations in that clone (NR4A3, HELZ, TSHZ3), a separate cluster is created. As it is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, Conifer concludes that in addition to the clone C6, the clone C5 is also the ancestor of the clone C7, which can be explained by the false positives that occurred in the profiles of eight cells. In fact, it indicates the possibility of co-occurrence of FUS mutation with mutations of clone C7 (SPEN_2, F8, LAMB4).</p>
        <p id="Par45">Comparison of the Conifer inferred tree and the clonal tree introduced in SiCloneFit [<xref ref-type="bibr" rid="CR25">25</xref>], which is based on only single-cell sequencing data, shows some worth-mentioning differences. In SiCloneFit [<xref ref-type="bibr" rid="CR25">25</xref>] two “IL2IR” and “APC: 2” mutations are co-occurred in the first clone of the primary tumor. On the contrary, Conifer concludes that they belong to the second clone of the primary tumor according to the similarity of those two mutations VAFs. Additionally, the clonal tree of SiCloneFit [<xref ref-type="bibr" rid="CR25">25</xref>] for patient CRC2 represents polyclonal seeding. In other words, it shows the existence of two distinct branches for metastasis. In fact, in SiCloneFit it is concluded that two distinct groups of cells with different mutations have migrated from the primary clone and formed two independent metastatic clones, and the FUS mutation has occurred in both of them independently and during two different evolutionary processes. However, Conifer inferred tree is more likely to be consistent with VAFs similarity as the VAF value of FUS mutation in the metastatic sample (29.1) is approximately equal to the total mean VAF value of C6 (2.36) and C7 (27.56). A recent study that proposes a method named SCARLET [<xref ref-type="bibr" rid="CR32">32</xref>] also shows monoclonal seeding by investigating changes in copy number variation of single-cell sequencing data, which corroborates the Conifer’s tree.</p>
      </sec>
      <sec id="Sec10">
        <title>Triple-negative breast cancer (TNBC)</title>
        <p id="Par46">The performance of Conifer is more evaluated on real data by analyzing the triple-negative breast cancer in the study of Wang et al. [<xref ref-type="bibr" rid="CR33">33</xref>]. Single-cell profiles of 16 cells were provided after performing copy number profiling and exome sequencing. Clonal trees inferred by the original study, PhISCS [<xref ref-type="bibr" rid="CR27">27</xref>], and Conifer for selected 18 mutations (with coverage of <inline-formula id="IEq11"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${10}^{5}$$\end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq11.gif"/></alternatives></inline-formula>), are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Conifer provides clonal tree based on bulk and single-cell data while clonal evolution in the original study is inferred based on single-cell exome and copy number data, and PhISCS has taken the matrix of single-cell sequencing data and the estimated noise rates of SCS experiment as its inputs (the clonal tree is reported in the study of Karpov et al. [<xref ref-type="bibr" rid="CR34">34</xref>]).<fig id="Fig6"><label>Fig. 6</label><caption><p>Clonal tree inference for a patient with triple-negative breast cancer, <bold>a</bold> Clonal tree Inferred in the original study [<xref ref-type="bibr" rid="CR33">33</xref>] based on single-cell exome and copy number data, <bold>b</bold> Clonal tree Inferred by PhISCS based on single-cell data, <bold>c</bold> Clonal tree inferred by Conifer based on bulk and single-cell data</p></caption><graphic xlink:href="12859_2021_4338_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par47">Mutations which are presented in the linear part of all trees (before branching) are quite similar to each other except for the mutation ECM1 which is discussed in the following.</p>
        <p id="Par48">As it is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>c, Conifer introduces 4 different clones C1, C2, C3, and C4 for those mutations which all belong to clone C1 in the original study. This difference is because the mutations in the clone C1 of the original study have different VAFs and as Conifer uses bulk sequencing VAFs together with single-cell data, it proposes different clustering which is more consistent with mutations VAFs similarity.</p>
        <p id="Par49">In addition, clones of the mutations SETBP1 with the VAF value of 35.3% and NOTCH2 with the VAF value of 42.2% are different between Conifer and PhISCS. In PhISCS, they belong to clones C1 and C2, respectively while in Conifer they are clustered oppositely. In other words, in the Conifer tree, the NOTCH2 mutation belongs to the clone C1 with the mean VAF value of 39.05% and the SETBP1 mutation belongs to the clone C2 with the mean VAF value of 35.7%. Moreover, in contrast to PhISCS in which the mutation AFF4 with the VAF value of 35.4% belongs to the clone C3 (which also contains the mutation NTRK1 with the VAF value of 26.1%), Conifer has put it in the same clone of the mutations SETBP1 and NOTCH3 with the VAF values of 35.3% and 36%, respectively which is more consistent with similarity of VAFs. The difference in placement of the MAP2K7 mutation between Conifer and PhISCS is also worth mentioning. Conifer puts the mutation MAP2K7 with the VAF value of 13.4% in a distinct clone C4 while in PhISCS tree it is in the same clone of the mutations NOTCH2 and NOTCH3 with VAF values of 42.2% and 36% which are significantly different with VAF value of the mutation MAP2K7 and seems to be inconsistent with VAF similarity.</p>
        <p id="Par50">Single-cell co-occurrence frequencies of the mutation ECM1 are not similar to mutations of clone C5 (TGFB2, CHRM5), therefore ECM1 and C5 (TGFB2, CHRM5) are placed in different branches in Conifer. On the other hand, the mutation ECM1 is similar to mutations in clones C6 and C8 regarding single-cell co-occurrence frequencies and consequently, Conifer introduces the clone C7 (containing the mutation ECM1) as the ancestor of clones C6 and C8. The placement of this mutation clearly shows how Conifer relies on VAFs similarity data for identifying clones and simultaneously uses single-cell data for finding the most appropriate place for clones in the tree.</p>
        <p id="Par51">Finally, mutations in leaf clones of the original study tree (clones C2, C3, and C4) are quite similar to mutations in leaf clones of the Conifer tree (clones C5, C6, and C8) and slightly different from the PhISCS tree in which if clone pairs (C4, C5), (C7, C8) and (C9, C10) are formed according to VAF similarity and then clones of each pair are merged, the resulted clones will be equivalent to clones C2, C3 and C4 in the original study tree, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusion</title>
    <p id="Par52">In this study, a new reliable and effective method named Conifer is introduced for inferring tumor clonal tree by combining single-cell and bulk sequencing data. Conifer provides a generative nonparametric model for the identification of clones and their evolutionary relationship based on single-cell and bulk sequencing data by considering infinite site assumption (ISA).</p>
    <p id="Par53">Conifer method has the distinctive feature of simultaneously identifying both clones and phylogenetic tree. Each tree branch contains mutations of one or more cells, and their common clones are obtained by their VAFs similarity in different bulk sequencing samples. In the Conifer inferred tree, clones with genotypes that are common in more cells are closer to the root.</p>
    <p id="Par54">In order to evaluate the performance of Conifer, comprehensive sets of single-cell and bulk sequencing data are simulated with varying numbers of SNVs, cells, bulk samples, and clones. Additionally, a wide range of error rates, assortment biases, and doublets are considered. By studying the simulated datasets, it is shown that Conifer is more accurate than other existing methods on different criteria for evaluation of clone identification and clonal evolutionary tree. For assessing Conifer performance on real datasets, data of a patient with colorectal cancer is used. In this investigation, Conifer provides the genotype of clones, cell population, and clonal tree by considering combined single-cell and bulk sequencing data of the primary and metastatic tumors. In the obtained clonal tree, the evolutionary stage in which the metastasis has occurred is clearly identified.</p>
    <p id="Par55">Additionally, the performance of Conifer is assessed on real data of a patient with triple-negative breast cancer and it is shown that Conifer inferred tree is completely consistent with VAFs and co-occurrence of mutations in bulk and single-cell data, respectively.</p>
    <p id="Par56">In conclusion, Conifer provides a more accurate clonal tree of tumor heterogeneity comparing to other existing methods. It is achieved by combining single-cell and bulk sequencing data, the former of which is used for resolving the challenge of identifying similar prevalent clones that co-occur in the tumor and, resolving the ambiguities of phylogeny inference, while the latter is used to reduce the effects of single-cell sequencing errors such as false-negative rates and sampling biases.</p>
  </sec>
  <sec id="Sec12">
    <title>Material and method</title>
    <p id="Par57">Conifer aims to introduce a rooted clonal tree <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T$$\end{document}</tex-math><mml:math id="M36"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq12.gif"/></alternatives></inline-formula> with <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M38"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq13.gif"/></alternatives></inline-formula> nodes which are labeled as <inline-formula id="IEq14"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left( T \right) = \left\{ {\vartheta_{0} ,\vartheta_{1} , \ldots ,\vartheta_{s} } \right\}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mi>T</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq14.gif"/></alternatives></inline-formula>, by using single-cell mutation profiles and VAFs of different bulk sequencing samples. Conifer provides a Bayesian nonparametric model for inferring clonal trees without any knowledge of clones or their evolutionary tree. In the Bayesian nonparametric model, the posterior distribution on infinite collections of tree hierarchies and clones must be found. The inference of posterior distribution is performed by the MCMC algorithm for approximating distributions over trees, clones, and SNVs allocations.</p>
    <p id="Par58">Two main steps of the algorithm are sampling path assignments and sampling level allocations, which are repeated successively for a sufficient number of iterations so that the Markov chain converges to the stationary distribution. These two steps are explained in this section.</p>
    <p id="Par59">The nested CRP introduced in the study of Blei et al. [<xref ref-type="bibr" rid="CR35">35</xref>] is used as a prior of the Bayesian nonparametric model provided by Conifer. In addition, the nested CRP model is extended by Conifer in such a way that instead of ordinary CRP, distance-dependent CRP [<xref ref-type="bibr" rid="CR36">36</xref>] is used for level allocations. In order to review the main components of Conifer, they are briefly explained below.</p>
    <sec id="Sec13">
      <title>Nested CRP</title>
      <p id="Par60">It is a process for providing a prior on tree topologies without any limitation on its width and depth. To understand nested CRP, the Chinese Restaurant Process (CRP) should be defined first. The CRP is a stochastic process for introducing the distribution of customers, which sequentially enter a restaurant with infinite tables and sit at a table. The probability of sitting at a table is proportional to the number of customers who have already sat at that table. Customers can also sit at a new table with probability proportional to the model parameter <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M42"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq15.gif"/></alternatives></inline-formula>. The formed sitting plans represent customer clustering. For showing the formulation of CRP, the notation in the study of Blei et al. [<xref ref-type="bibr" rid="CR36">36</xref>] is used. The table assignment for customer <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M44"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq16.gif"/></alternatives></inline-formula> is <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{i}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq17.gif"/></alternatives></inline-formula>, and at the time of customer <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M48"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq18.gif"/></alternatives></inline-formula>’s entrance, <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M50"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq19.gif"/></alternatives></inline-formula> tables are occupied by customers <inline-formula id="IEq20"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq20.gif"/></alternatives></inline-formula> to <inline-formula id="IEq21"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i - 1$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq21.gif"/></alternatives></inline-formula>. Assume <inline-formula id="IEq22"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{k}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq22.gif"/></alternatives></inline-formula> is the number of customers sitting at table <inline-formula id="IEq23"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M58"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq23.gif"/></alternatives></inline-formula>, then the <inline-formula id="IEq24"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{i}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq24.gif"/></alternatives></inline-formula> is drawn as Eq. (<xref rid="Equ1" ref-type="">1</xref>).<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {c_{i} = k{|}c_{{1:\left( {i - 1} \right)}} ,\gamma } \right) \propto \left\{ {\begin{array}{*{20}l} {n_{k} } \hfill &amp; {for \quad k \le K} \hfill \\ \gamma \hfill &amp; {for \quad k = K + 1} \hfill \\ \end{array} } \right.$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>γ</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par61">The nested CRP is an extended CRP in which instead of having only one restaurant, it is assumed that there is an infinite number of Chinese restaurants with an infinite number of tables. A restaurant is selected as the root, on each table of which, there is a card with the name of the next restaurant, to which those sitting on that table should go the next night. In fact, as each restaurant is referred to only once, so the relations between different restaurants form a tree structure. Therefore, the nested CRP provides a prior on tree topologies and each node of the tree provides a CRP over its descendant.</p>
    </sec>
    <sec id="Sec14">
      <title>Distance-dependent CRP</title>
      <p id="Par62">This process is a different representation of CRP in such a way that instead of joining different tables, customers join each other. Distance-dependent CRP [<xref ref-type="bibr" rid="CR36">36</xref>] implies that if two customers have access to each other through a series of customer connections, then they are sitting at the same table. Therefore, the customers' seating assignment depends on the distances between them. For representing customer connections, a graph is defined in which nodes and edges represent customers and their connections, respectively. In other words, if <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{i}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq25.gif"/></alternatives></inline-formula> is the index of a customer joining the customer <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M66"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq26.gif"/></alternatives></inline-formula>, then the binary <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {i,z_{i} } \right)$$\end{document}</tex-math><mml:math id="M68"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq27.gif"/></alternatives></inline-formula> is the directional graph edge. The clusters are defined according to connected sub-graphs in this similarity graph. Let <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{t}}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M72"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq29.gif"/></alternatives></inline-formula> be the distance measurements between customers and the decay function, respectively. The customer assignments are drawn by distance-dependent CRP as Eq. (<xref rid="Equ2" ref-type="">2</xref>).<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {z_{i} = j{|}t,\eta } \right) \propto \left\{ {\begin{array}{*{20}l} {f\left( {t_{ij} } \right)} \hfill &amp; { if\quad i \ne j } \hfill \\ \eta \hfill &amp; { if\quad i = j} \hfill \\ \end{array} } \right.$$\end{document}</tex-math><mml:math id="M74" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>η</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par63">The range of <inline-formula id="IEq30"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M76"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M78"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq31.gif"/></alternatives></inline-formula> is from 1 to the number of customers, and <inline-formula id="IEq32"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta$$\end{document}</tex-math><mml:math id="M80"><mml:mi>η</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq32.gif"/></alternatives></inline-formula> is the model parameter that controls the self-loop in the connectivity graph. Additionally, the induced table assignment is denoted by <inline-formula id="IEq33"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l\left( z \right)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq33.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec15">
      <title>Input data</title>
      <p id="Par64">Single-cell data is presented by a <inline-formula id="IEq34"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times m$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq34.gif"/></alternatives></inline-formula> matrix <inline-formula id="IEq35"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M86"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq35.gif"/></alternatives></inline-formula> in which each row and column represents SNV and cell, respectively, and its elements with a value of zero show that no mutation has occurred in the corresponding position, while the value of one means a mutation has occurred.</p>
      <p id="Par65">In addition, bulk data is presented by a <inline-formula id="IEq36"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times b{ }$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>b</mml:mi><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq36.gif"/></alternatives></inline-formula> matrix <inline-formula id="IEq37"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M90"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq37.gif"/></alternatives></inline-formula> that its rows are SNVs and its columns are bulk samples, and each element <inline-formula id="IEq38"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{ij}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq38.gif"/></alternatives></inline-formula> is a variant allele frequency that corresponds to the ith SNV in the jth bulk sample.</p>
    </sec>
    <sec id="Sec16">
      <title>Sampling path</title>
      <p id="Par66">At the first iteration, Conifer uses nested CRP for generating a tree path in such a way that each cell is considered as a customer. To represent each single-cell <inline-formula id="IEq39"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M94"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq40.gif"/></alternatives></inline-formula> is defined as a set of SNVs with the value of one in that cell. The process of generating path with nested CRP is as follows: at the first step (the first night in nested CRP) the root node <inline-formula id="IEq41"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{0}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq41.gif"/></alternatives></inline-formula> does not have any child, therefore for <inline-formula id="IEq42"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{1}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq42.gif"/></alternatives></inline-formula> (first customer) it generates node <inline-formula id="IEq43"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{1}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq43.gif"/></alternatives></inline-formula> with the probability of one. This process repeats for <inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M104"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq44.gif"/></alternatives></inline-formula> steps (nights) and generates <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M106"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq45.gif"/></alternatives></inline-formula> levels which <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M108"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq46.gif"/></alternatives></inline-formula> is a random number limited to the size of <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{1}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq47.gif"/></alternatives></inline-formula>. The path corresponding to <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{1}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq48.gif"/></alternatives></inline-formula> is labeled by <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{1}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq49.gif"/></alternatives></inline-formula>. For generating the path of the next cells (<inline-formula id="IEq50"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq50.gif"/></alternatives></inline-formula> with <inline-formula id="IEq51"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d &gt; 1$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq51.gif"/></alternatives></inline-formula>), there are two options; generating a node as a new child of the root node <inline-formula id="IEq52"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{0}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq52.gif"/></alternatives></inline-formula> with probability of <inline-formula id="IEq53"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\gamma }{{\gamma + d - 1{ }}}$$\end{document}</tex-math><mml:math id="M122"><mml:mfrac><mml:mi>γ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mrow/></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq53.gif"/></alternatives></inline-formula> (<inline-formula id="IEq54"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M124"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq54.gif"/></alternatives></inline-formula> is the model parameter), or choosing child <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{j}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>ϑ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq55.gif"/></alternatives></inline-formula> of the root node <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{0}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq56.gif"/></alternatives></inline-formula> with probability of <inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\left| {n_{j} } \right|}}{{\gamma + d - 1{ }}}$$\end{document}</tex-math><mml:math id="M130"><mml:mfrac><mml:mfenced close="|" open="|"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mrow/></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq57.gif"/></alternatives></inline-formula> (<inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left| {n_{j} } \right|$$\end{document}</tex-math><mml:math id="M132"><mml:mfenced close="|" open="|"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq58.gif"/></alternatives></inline-formula> is the number of cells that have chosen <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{j}$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>ϑ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq59.gif"/></alternatives></inline-formula> so far) to go through. After processing each <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq60.gif"/></alternatives></inline-formula> and generating its corresponding path <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq61.gif"/></alternatives></inline-formula>, its mutations are assigned to nodes of the path <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq62.gif"/></alternatives></inline-formula> randomly. The probability of the generated tree is calculated by multiplying the probabilities of all paths and is used as the prior probability of the Bayesian model.</p>
      <p id="Par67">For the sampling path step of the next iterations, Conifer removes the corresponding path of each <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq63.gif"/></alternatives></inline-formula> with its mutations from the tree and deletes possible empty nodes. Afterward, the removed path is added to the tree with the same procedure explained above (except the random assignment of mutations).</p>
      <p id="Par68">In addition, for those SNVs which are not present in any single cell, Conifer adds extra sets with one mutation and follows the same procedure for generating their path.</p>
      <p id="Par69">In order to make the sampling path clear, an example with defined inputs as single-cell mutation matrix <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M144"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq64.gif"/></alternatives></inline-formula> and bulk data matrix <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M146"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq65.gif"/></alternatives></inline-formula> is illustrated in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. In this figure <inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{1} = \left\{ {M_{1} ,M_{2} ,M_{3} ,M_{4} ,M_{5} } \right\}$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq66.gif"/></alternatives></inline-formula> is defined as a set of SNVs with the value of one in the first cell (<inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d = 1$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq67.gif"/></alternatives></inline-formula>) and <inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{2}$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq68.gif"/></alternatives></inline-formula>, <inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{3}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{4}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq70.gif"/></alternatives></inline-formula> are defined for other cells similarly. In Fig. <xref rid="Fig7" ref-type="fig">7</xref>b it is shown that the first path of the tree corresponding to <inline-formula id="IEq71"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{1}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq71.gif"/></alternatives></inline-formula> is generated with four levels and node labels are <inline-formula id="IEq72"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\vartheta_{0} ,\vartheta_{1} ,\vartheta_{2} ,\vartheta_{3} } \right\}$$\end{document}</tex-math><mml:math id="M160"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq72.gif"/></alternatives></inline-formula>. In Fig. <xref rid="Fig7" ref-type="fig">7</xref>c, the generated path for <inline-formula id="IEq73"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{2}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq73.gif"/></alternatives></inline-formula> is shown. For generating this path, <inline-formula id="IEq74"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{2}$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq74.gif"/></alternatives></inline-formula> is first assigned to the node <inline-formula id="IEq75"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{1}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq75.gif"/></alternatives></inline-formula> with the probability of <inline-formula id="IEq76"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{\gamma + 1}$$\end{document}</tex-math><mml:math id="M168"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq76.gif"/></alternatives></inline-formula> and then, instead of assigning it to node <inline-formula id="IEq77"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{2}$$\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq77.gif"/></alternatives></inline-formula>, a new node <inline-formula id="IEq78"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{4}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq78.gif"/></alternatives></inline-formula> is generated with the probability of <inline-formula id="IEq79"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\gamma }{{\gamma + 1{ }}}$$\end{document}</tex-math><mml:math id="M174"><mml:mfrac><mml:mi>γ</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mrow/></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq79.gif"/></alternatives></inline-formula>. Generating new nodes continues up to level <inline-formula id="IEq80"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = 4$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq80.gif"/></alternatives></inline-formula>. The resulted tree after generating paths for <inline-formula id="IEq81"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{3}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq81.gif"/></alternatives></inline-formula> and <inline-formula id="IEq82"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{4}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq82.gif"/></alternatives></inline-formula> is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>d. When the initial tree is generated, mutations of each <inline-formula id="IEq83"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq83.gif"/></alternatives></inline-formula> are assigned to the nodes of their corresponding paths randomly as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>e.<fig id="Fig7"><label>Fig. 7</label><caption><p>A schematic example showing sampling steps of tree inference by Conifer, <bold>a</bold> the variables <inline-formula id="IEq163"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{1}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq163.gif"/></alternatives></inline-formula>,<inline-formula id="IEq164"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ }{\varvec{w}}_{2}$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq164.gif"/></alternatives></inline-formula>,<inline-formula id="IEq165"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ }{\varvec{w}}_{3}$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq165.gif"/></alternatives></inline-formula> and <inline-formula id="IEq166"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{4}$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq166.gif"/></alternatives></inline-formula> are defined for cells 1 to 4 which are sets of SNVs with the value of one in corresponding cells. Matrices <inline-formula id="IEq167"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq167.gif"/></alternatives></inline-formula> and <inline-formula id="IEq168"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq168.gif"/></alternatives></inline-formula> show the single-cell data and VAFs of SNVs in different bulk samples, respectively, <bold>b</bold> the generated path <inline-formula id="IEq169"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{1}$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq169.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq170"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{1}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq170.gif"/></alternatives></inline-formula> with node labels of <inline-formula id="IEq171"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\vartheta_{0} ,\vartheta_{1} ,\vartheta_{2} ,\vartheta_{3} } \right\}$$\end{document}</tex-math><mml:math id="M200"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq171.gif"/></alternatives></inline-formula>, <bold>c</bold> the generated path <inline-formula id="IEq172"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{2}$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq172.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq173"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{2}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq173.gif"/></alternatives></inline-formula> with node labels of <inline-formula id="IEq174"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\vartheta_{0} ,\vartheta_{1} ,\vartheta_{4} ,\vartheta_{5} } \right\}$$\end{document}</tex-math><mml:math id="M206"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq174.gif"/></alternatives></inline-formula>, <bold>d</bold> the generated paths <inline-formula id="IEq175"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{3}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq175.gif"/></alternatives></inline-formula> and <inline-formula id="IEq176"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{4}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq176.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq177"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{3}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq177.gif"/></alternatives></inline-formula> and <inline-formula id="IEq178"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{4}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq178.gif"/></alternatives></inline-formula> with node labels of <inline-formula id="IEq179"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\vartheta_{0} ,\vartheta_{6} ,\vartheta_{7} } \right\}$$\end{document}</tex-math><mml:math id="M216"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq179.gif"/></alternatives></inline-formula> and <inline-formula id="IEq180"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\vartheta_{0} ,\vartheta_{8} ,\vartheta_{9} } \right\}$$\end{document}</tex-math><mml:math id="M218"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq180.gif"/></alternatives></inline-formula>, respectively, <bold>e</bold> initial tree with random mutation assignment for each <inline-formula id="IEq181"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq181.gif"/></alternatives></inline-formula> to nodes of their corresponding paths, <bold>f</bold> result of sampling level for path <inline-formula id="IEq182"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{1}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq182.gif"/></alternatives></inline-formula>, <bold>g</bold> result of sampling level for path <inline-formula id="IEq183"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{2}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq183.gif"/></alternatives></inline-formula>, <bold>h</bold> result of sampling level for last two paths <inline-formula id="IEq184"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{3}$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq184.gif"/></alternatives></inline-formula> and <inline-formula id="IEq185"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{4}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq185.gif"/></alternatives></inline-formula>, <bold>i</bold> final tree after successive iterations of sampling path and sampling level</p></caption><graphic xlink:href="12859_2021_4338_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Sampling level</title>
      <p id="Par70">Conifer clusters mutations for each path based on their VAFs similarity in different bulk sequencing samples. The possibility of having two distinct clones with the same mean value of VAFs makes their mutations clustering ambiguous. Considering the co-occurrence patterns of these mutations in single-cell sequencing data with their VAFs similarity is helpful to tackle this ambiguity. Therefore, Conifer performs sampling level with distance-dependent CRP instead of ordinary CRP of study Blei et al. [<xref ref-type="bibr" rid="CR35">35</xref>] to consider the co-occurrence frequency of mutations as the distance between them. In other words, patterns of joining mutations resulted from distance-dependent CRP is the prior of Bayesian model which is based on single-cell data, and likelihoods of these patterns are computed by connectivity strength between clusters based on the VAFs of mutations in different bulk samples. Moreover, the posterior samples of SNVs level allocations for Gibbs sampler are summarized by the Maximum Posterior Expected Adjusted Rand (MPEAR) method [<xref ref-type="bibr" rid="CR37">37</xref>]. Also, nodes are ordered according to the weighted average of their mean VAF value and mean value of the number of SNVs occurrence in a level (ISA assumption), so that nodes with the higher average mean value are placed in lower levels.</p>
      <p id="Par71">In the example of Fig. <xref rid="Fig7" ref-type="fig">7</xref>, the result of sampling level for path <inline-formula id="IEq84"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{1}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq84.gif"/></alternatives></inline-formula> is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>f in which two clusters with mutations <inline-formula id="IEq85"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {M_{1} ,M_{2} ,M_{3} } \right\}$$\end{document}</tex-math><mml:math id="M232"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq85.gif"/></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {M_{4} ,M_{5} } \right\}$$\end{document}</tex-math><mml:math id="M234"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq86.gif"/></alternatives></inline-formula> are generated and node <inline-formula id="IEq87"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{3}$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq87.gif"/></alternatives></inline-formula> with no mutation is removed. Then, clustering is performed for mutations <inline-formula id="IEq88"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {M_{1} ,M_{2} ,M_{3} ,M_{9} ,M_{10} } \right\}$$\end{document}</tex-math><mml:math id="M238"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq88.gif"/></alternatives></inline-formula> in nodes <inline-formula id="IEq89"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{1}$$\end{document}</tex-math><mml:math id="M240"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq89.gif"/></alternatives></inline-formula>,<inline-formula id="IEq90"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ }\vartheta_{4}$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mrow/><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq90.gif"/></alternatives></inline-formula> and <inline-formula id="IEq91"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{5}$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq91.gif"/></alternatives></inline-formula> in the path <inline-formula id="IEq92"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{2}$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq92.gif"/></alternatives></inline-formula> and the node <inline-formula id="IEq93"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{5}$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq93.gif"/></alternatives></inline-formula> is removed and the resulted tree is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>g. Result of sampling level for last two paths <inline-formula id="IEq94"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{3}$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq94.gif"/></alternatives></inline-formula> and <inline-formula id="IEq95"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{4}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq95.gif"/></alternatives></inline-formula> is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>h in which nodes <inline-formula id="IEq96"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{7}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq97"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{9}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq97.gif"/></alternatives></inline-formula> are removed as there is no mutation assigned to them. As it is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>h, at the end of the sampling level, two nodes <inline-formula id="IEq98"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{6}$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq98.gif"/></alternatives></inline-formula> and <inline-formula id="IEq99"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vartheta_{1}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>ϑ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq99.gif"/></alternatives></inline-formula> present same genotype and will be merged together in the sampling path of the next iteration. Sampling path and sampling level steps are performed iteratively resulting in the final tree which is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>i.</p>
      <p id="Par72">To explain how the co-occurrence frequency of mutations is calculated to be used in distance-dependent CRP, a distinct path <inline-formula id="IEq100"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq100.gif"/></alternatives></inline-formula> is considered. The co-occurrence frequency of all pairs of SNVs in the path <inline-formula id="IEq101"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq101.gif"/></alternatives></inline-formula> is defined by a <inline-formula id="IEq102"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{{{\varvec{c}}_{d} }} \times n_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq102.gif"/></alternatives></inline-formula> matrix <inline-formula id="IEq103"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{t}}_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq103.gif"/></alternatives></inline-formula> which <inline-formula id="IEq104"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{{{\varvec{c}}_{d} }} { }$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq104.gif"/></alternatives></inline-formula> is the number of SNVs in the path <inline-formula id="IEq105"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq105.gif"/></alternatives></inline-formula>. Each element of <inline-formula id="IEq106"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{t}}_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq106.gif"/></alternatives></inline-formula> is calculated by the number of cells that both SNVs have occurred in divided by the total number of cells in single-cell matrix <inline-formula id="IEq107"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{M}}$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq107.gif"/></alternatives></inline-formula>.</p>
      <p id="Par73">To cluster SNVs based on the similarity of VAFs, a <inline-formula id="IEq108"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{{{\varvec{c}}_{d} }} \times n_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq108.gif"/></alternatives></inline-formula> connectivity matrix <inline-formula id="IEq109"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{V}}_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq109.gif"/></alternatives></inline-formula> is calculated for each distinct path <inline-formula id="IEq110"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq110.gif"/></alternatives></inline-formula> in the tree. Each element of <inline-formula id="IEq111"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{V}}_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq111.gif"/></alternatives></inline-formula> is the Euclidean distance of VAFs for the corresponding SNV pair in the path.</p>
      <p id="Par74">As an example, the calculation of the co-occurrence frequency matrix <inline-formula id="IEq112"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{t}}_{{{\varvec{c}}_{1} }}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq112.gif"/></alternatives></inline-formula> and the connectivity matrix <inline-formula id="IEq113"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{V}}_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M288"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq113.gif"/></alternatives></inline-formula> for the sample inputs of Fig. <xref rid="Fig7" ref-type="fig">7</xref> is shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>.<fig id="Fig8"><label>Fig. 8</label><caption><p><bold>a</bold> A schematic example showing a clonal tree,<bold> b</bold> calculation of co-occurrence frequency of mutations <inline-formula id="IEq186"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{t}}_{{{\varvec{c}}_{1} }}$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq186.gif"/></alternatives></inline-formula> for path <inline-formula id="IEq187"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{1}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq187.gif"/></alternatives></inline-formula> in the clonal tree, <bold>c</bold> calculation of connectivity matrix <inline-formula id="IEq188"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{V}}_{{{\varvec{c}}_{1} }}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq188.gif"/></alternatives></inline-formula> for path <inline-formula id="IEq189"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{1}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq189.gif"/></alternatives></inline-formula> in the clonal tree</p></caption><graphic xlink:href="12859_2021_4338_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>Formulation</title>
      <p id="Par75">Using the notation in the study of Baldassano et al. [<xref ref-type="bibr" rid="CR38">38</xref>] for the connectivity clustering model, Conifer’s generative model formulation is described as follows:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d} { }\sim { }nCRP\left( {\gamma ,{\varvec{w}}_{d} } \right)\quad {\text{Nested}}\;{\text{CRP}}\;\left( {{\text{Sampling}}\;{\text{path}}} \right)$$\end{document}</tex-math><mml:math id="M298" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/><mml:mo>∼</mml:mo><mml:mrow/><mml:mi>n</mml:mi><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mtext>Nested</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>CRP</mml:mtext><mml:mspace width="0.277778em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>Sampling</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>path</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{z}}_{{{\varvec{c}}_{d} { }}} \sim { }ddCRP\left( {\eta ,{\varvec{f}},{\varvec{t}}_{{{\varvec{c}}_{d} }} ,{\varvec{V}}_{{{\varvec{c}}_{d} }} { }} \right)\quad {\text{Distance - dependent}}\;{\text{CRP}}\;\left( {{\text{Sampling}}\;{\text{level}}} \right)$$\end{document}</tex-math><mml:math id="M300" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mrow/><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mrow/></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mrow><mml:mtext>Distance - dependent</mml:mtext></mml:mrow><mml:mspace width="0.277778em"/><mml:mtext>CRP</mml:mtext><mml:mspace width="0.277778em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>Sampling</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>level</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{V}}_{{{\varvec{c}}_{d} ,ij}} \sim Normal\left( {{\varvec{A}}_{{l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{i} { },{ }l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{j} }} ,{\varvec{\sigma}}_{{l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{i} { },{ }l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{j} }}^{2} } \right)$$\end{document}</tex-math><mml:math id="M302" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub><mml:mrow/><mml:mo>,</mml:mo><mml:mrow/><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub><mml:mrow/><mml:mo>,</mml:mo><mml:mrow/><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}_{{l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{i} { },{ }l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{j} }} ,{\varvec{\sigma}}_{{l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{i} { },{ }l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{j} }}^{2} { } \sim { }Normal - Inverse - \chi^{2} { }\left( {{\upmu }_{0} { },\kappa_{0} ,\sigma_{0}^{2} ,\nu_{0} } \right)$$\end{document}</tex-math><mml:math id="M304" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub><mml:mrow/><mml:mo>,</mml:mo><mml:mrow/><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub><mml:mrow/><mml:mo>,</mml:mo><mml:mrow/><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow/><mml:mo>∼</mml:mo><mml:mrow/><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow/><mml:mo>,</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{ij} = \frac{{\exp \left( { - t_{{{\varvec{c}}_{d} ,ij}} { } + a} \right)}}{{\left( {1 + exp{ }\left( { - t_{{{\varvec{c}}_{d} ,ij}} { } + a} \right){ }} \right)}}$$\end{document}</tex-math><mml:math id="M306" display="block"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow/><mml:mo>+</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow/><mml:mfenced close=")" open="("><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow/><mml:mo>+</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mrow/></mml:mrow></mml:mfenced></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par76">In this model <inline-formula id="IEq114"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq114.gif"/></alternatives></inline-formula> is defined as a set of SNVs with the value of one in cell <inline-formula id="IEq115"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d\left( {d = 1{ }to{ }m} \right)$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mrow/><mml:mi>m</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq115.gif"/></alternatives></inline-formula> and <inline-formula id="IEq116"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq116.gif"/></alternatives></inline-formula> is its corresponding path generated by nested CRP with a parameter <inline-formula id="IEq117"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M314"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq117.gif"/></alternatives></inline-formula> following Gamma distribution. <inline-formula id="IEq118"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{z}}_{{{\varvec{c}}_{d} { }}}$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq118.gif"/></alternatives></inline-formula> is a vector with the size of the number of mutations in the path <inline-formula id="IEq119"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq119.gif"/></alternatives></inline-formula> which is generated by distance-dependent CRP. It defines the mutation links for all mutations in the path <inline-formula id="IEq120"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq120.gif"/></alternatives></inline-formula>. Also, <inline-formula id="IEq121"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq121.gif"/></alternatives></inline-formula> is the level assignment derived from the <inline-formula id="IEq122"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{z}}_{{{\varvec{c}}_{d} { }}}$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq122.gif"/></alternatives></inline-formula>, for each mutation in the path <inline-formula id="IEq123"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq123.gif"/></alternatives></inline-formula>.</p>
      <p id="Par77">Moreover, <inline-formula id="IEq124"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta$$\end{document}</tex-math><mml:math id="M328"><mml:mi>η</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq124.gif"/></alternatives></inline-formula> is the model parameter following Gamma distribution and controls the self-loop in the connectivity graph. The decay function is represented by <inline-formula id="IEq125"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{f}}$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq125.gif"/></alternatives></inline-formula> and the hyper-parameter <inline-formula id="IEq126"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a$$\end{document}</tex-math><mml:math id="M332"><mml:mi>a</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq126.gif"/></alternatives></inline-formula>. The variable <inline-formula id="IEq127"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{t}}_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq127.gif"/></alternatives></inline-formula> denotes the co-occurrence frequency matrix of all SNV pairs in the path <inline-formula id="IEq128"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq128.gif"/></alternatives></inline-formula>. In addition, <inline-formula id="IEq129"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq129.gif"/></alternatives></inline-formula> denotes the connectivity strength of two clusters <inline-formula id="IEq130"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{i}$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq130.gif"/></alternatives></inline-formula> and <inline-formula id="IEq131"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{j}$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq131.gif"/></alternatives></inline-formula> and <inline-formula id="IEq132"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\sigma}}^{2} { }$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq132.gif"/></alternatives></inline-formula> is their connectivity variance. <inline-formula id="IEq133"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\sigma}}^{2}$$\end{document}</tex-math><mml:math id="M348"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq134.gif"/></alternatives></inline-formula> follow the <inline-formula id="IEq135"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Normal - Inverse - \chi^{2} { }$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq135.gif"/></alternatives></inline-formula> distribution function with scalar prior mean and precision of <inline-formula id="IEq136"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {{\upmu }_{0} ,\kappa_{0} } \right)$$\end{document}</tex-math><mml:math id="M352"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq136.gif"/></alternatives></inline-formula> and <inline-formula id="IEq137"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\sigma_{0}^{2} ,\nu_{0} } \right)$$\end{document}</tex-math><mml:math id="M354"><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq137.gif"/></alternatives></inline-formula>, respectively.</p>
      <p id="Par78">Conifer probabilistic graphical model (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7) and the table of notation reference (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec19">
      <title>Inference</title>
      <p id="Par79">Clonal tree of the tumor heterogeneity is found by posterior distribution inference on the path and level assignment of mutations from single-cell and bulk sequencing data, which is shown by <inline-formula id="IEq138"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p({\varvec{c}}_{d} ,{\varvec{z}}_{{{\varvec{c}}_{d} { }}} |\gamma ,\eta ,{\varvec{f}},{\varvec{t}}_{{{\varvec{c}}_{d} }} ,{\varvec{V}}_{{{\varvec{c}}_{d} }} ,{\varvec{w}}_{d} )$$\end{document}</tex-math><mml:math id="M356"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq138.gif"/></alternatives></inline-formula>. This posterior is approximated with Collapsed Gibbs sampling by iteratively performing sampling paths and sampling level assignments.<list list-type="order"><list-item><p id="Par80">Sampling path:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\varvec{c}}_{d} {|}{\varvec{c}}_{ - d} ,{\varvec{w}},{\varvec{z}},\gamma ,\eta } \right) \propto p\left( {{\varvec{c}}_{d} {|}{\varvec{c}}_{ - d} ,\gamma } \right)p\left( {{\varvec{w}}_{d} {|}{\varvec{c}},{\varvec{w}}_{ - d} ,{\varvec{z}},\eta } \right)$$\end{document}</tex-math><mml:math id="M358" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par81">In Eq. (<xref rid="Equ8" ref-type="">8</xref>) which represents a Bayesian model, <inline-formula id="IEq139"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{ - d}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq139.gif"/></alternatives></inline-formula> all paths existing in the tree after removing the mutations in the path corresponding to the cell <inline-formula id="IEq140"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M362"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq140.gif"/></alternatives></inline-formula>. The term <inline-formula id="IEq141"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\varvec{w}}_{d} {|}{\varvec{c}},{\varvec{w}}_{ - d} ,{\varvec{z}},\eta } \right)$$\end{document}</tex-math><mml:math id="M364"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq141.gif"/></alternatives></inline-formula> represents the probability that <inline-formula id="IEq142"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{w}}_{d}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq142.gif"/></alternatives></inline-formula> has created a specific path, and <inline-formula id="IEq143"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\varvec{c}}_{d} {|}{\varvec{c}}_{ - d} ,\gamma } \right){ }$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mfenced><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq143.gif"/></alternatives></inline-formula> is the probability of prior which is based on the nested CRP and can be calculated by Eq. (<xref rid="Equ1" ref-type="">1</xref>). The computational details are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p></list-item><list-item><p id="Par82">Sampling level assignments:</p><p id="Par83">Conifer performs sampling on the mutation links <inline-formula id="IEq144"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{z}}}_{d}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq144.gif"/></alternatives></inline-formula> as follows:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp; p\left( {\left( {z_{{{\varvec{c}}_{d} { }}} } \right)_{i}^{{\left( {new} \right)}} {|}\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{ - i} ,{\varvec{c}}_{d} ,{\varvec{V}}_{{{\varvec{c}}_{d} }} ,\eta ,{\varvec{f}},{\mathbf{t}}_{{{\mathbf{c}}_{{\text{d}}} }} } \right) \propto \\ &amp; \quad \quad \quad p\left( {\left( {z_{{{\varvec{c}}_{d} { }}} } \right)_{i}^{{\left( {new} \right)}} {|}\eta ,{\varvec{f}},{\varvec{t}}_{{{\varvec{c}}_{d} }} } \right)p{(}{\varvec{V}}_{{{\varvec{c}}_{d} }} {|} l\left( {\left( {{\varvec{z}}_{{{\varvec{c}}_{d} { }}} } \right)_{ - i} \cup \left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}^{{\left( {new} \right)}} } \right),{\varvec{c}}_{d} ) \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M372" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:mfenced></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">t</mml:mi><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mtext>d</mml:mtext></mml:msub></mml:msub></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:mfenced></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4338_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par84">In the Bayesian model of Eq. (<xref rid="Equ9" ref-type="">9</xref>), <inline-formula id="IEq145"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq145.gif"/></alternatives></inline-formula> denotes a link to mutation <inline-formula id="IEq146"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M376"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq146.gif"/></alternatives></inline-formula> and <inline-formula id="IEq147"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {{\varvec{z}}_{{{\varvec{c}}_{d} }} } \right)_{ - i}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq147.gif"/></alternatives></inline-formula> is the vector of mutation links from which <inline-formula id="IEq148"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq148.gif"/></alternatives></inline-formula> is removed. For considering different choices for sampling, the notation <inline-formula id="IEq149"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}^{{\left( {new} \right)}}$$\end{document}</tex-math><mml:math id="M382"><mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq149.gif"/></alternatives></inline-formula> is used to denote a new link to mutation <inline-formula id="IEq150"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M384"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq150.gif"/></alternatives></inline-formula> after removing <inline-formula id="IEq151"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq151.gif"/></alternatives></inline-formula>. In Eq. (<xref rid="Equ9" ref-type="">9</xref>), the term <inline-formula id="IEq152"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {\left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}^{{\left( {new} \right)}} {|}\eta ,{\varvec{f}},{\varvec{t}}_{{{\varvec{c}}_{d} }} } \right)$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:mfenced></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq152.gif"/></alternatives></inline-formula> is the probability of prior which is based on the distance-dependent CRP and can be calculated by Eq. (<xref rid="Equ2" ref-type="">2</xref>). The term <inline-formula id="IEq153"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p{(}{\varvec{V}}_{{{\varvec{c}}_{d} }} {|} l\left( {\left( {{\varvec{z}}_{{{\varvec{c}}_{d} }} } \right)_{ - i} \cup \left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}^{{\left( {new} \right)}} } \right),{\varvec{c}}_{d} )$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq153.gif"/></alternatives></inline-formula> is the likelihood of <inline-formula id="IEq154"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{V}}_{{{\varvec{c}}_{d} }}$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq154.gif"/></alternatives></inline-formula> according to the clusters given by <inline-formula id="IEq155"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l\left( {\left( {{\varvec{z}}_{{{\varvec{c}}_{d} }} } \right)_{ - i} \cup \left( {z_{{{\varvec{c}}_{d} }} } \right)_{i}^{{\left( {new} \right)}} } \right)$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq155.gif"/></alternatives></inline-formula> in the path <inline-formula id="IEq156"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}_{d}$$\end{document}</tex-math><mml:math id="M396"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4338_Article_IEq156.gif"/></alternatives></inline-formula>. The computational details are in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4338_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1</bold>. Gibbs Sampling algorithm formulations.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DNA</term>
        <def>
          <p id="Par4">Deoxyribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>CRP</term>
        <def>
          <p id="Par5">Chinese Restaurant Process</p>
        </def>
      </def-item>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par6">Copy number variation</p>
        </def>
      </def-item>
      <def-item>
        <term>MCMC</term>
        <def>
          <p id="Par7">Markov chain Monte Carlo</p>
        </def>
      </def-item>
      <def-item>
        <term>MPEAR</term>
        <def>
          <p id="Par8">Maximum Posterior Expected Adjusted Rand</p>
        </def>
      </def-item>
      <def-item>
        <term>VAF</term>
        <def>
          <p id="Par9">Variant allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par10">Single nucleotide variation</p>
        </def>
      </def-item>
      <def-item>
        <term>ISA</term>
        <def>
          <p id="Par11">Infinite site assumption</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>None.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>LBA designing and implementing the method, collecting and analyzing the data, and writing-manuscript. BG and SG conceptualization, interpreting the result, supervision, project administration, and editing the manuscript. MFA and SPS: conceptualization, validation, editing-manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The sequencing datasets analyzed during the current study are available from the Sequence Read Archive with the accession number SRP074289 (for patient CRC2) and SRA053195 (for TNBC patients). All the source codes are available in the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/LeilaBagha/Conifer">https://github.com/LeilaBagha/Conifer</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par85">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par86">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par87">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nowell</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>The clonal evolution of tumor cell populations</article-title>
        <source>Science</source>
        <year>1976</year>
        <volume>194</volume>
        <issue>4260</issue>
        <fpage>23</fpage>
        <lpage>28</lpage>
        <?supplied-pmid 959840?>
        <pub-id pub-id-type="pmid">959840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Marte</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>Tumour heterogeneity</source>
        <year>2013</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Nature Publishing Group</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marusyk</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Almendro</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Polyak</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Intra-tumour heterogeneity: a looking glass for cancer?</article-title>
        <source>Nat Rev Cancer</source>
        <year>2012</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>323</fpage>
        <lpage>334</lpage>
        <?supplied-pmid 22513401?>
        <pub-id pub-id-type="pmid">22513401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merlo</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Pepper</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Maley</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Cancer as an evolutionary and ecological process</article-title>
        <source>Nat Rev Cancer</source>
        <year>2006</year>
        <volume>6</volume>
        <issue>12</issue>
        <fpage>924</fpage>
        <lpage>935</lpage>
        <?supplied-pmid 17109012?>
        <pub-id pub-id-type="pmid">17109012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burrell</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Tumour heterogeneity and the evolution of polyclonal drug resistance</article-title>
        <source>Mol Oncol</source>
        <year>2014</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>1095</fpage>
        <lpage>1111</lpage>
        <?supplied-pmid 25087573?>
        <pub-id pub-id-type="pmid">25087573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greaves</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary determinants of cancer</article-title>
        <source>Cancer Discov</source>
        <year>2015</year>
        <volume>5</volume>
        <issue>8</issue>
        <fpage>806</fpage>
        <lpage>820</lpage>
        <?supplied-pmid 26193902?>
        <pub-id pub-id-type="pmid">26193902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dagogo-Jack</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>AT</given-names>
          </name>
        </person-group>
        <article-title>Tumour heterogeneity and resistance to cancer therapies</article-title>
        <source>Nat Rev Clin Oncol</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>81</fpage>
        <?supplied-pmid 29115304?>
        <pub-id pub-id-type="pmid">29115304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Advances in understanding tumour evolution through single-cell sequencing</article-title>
        <source>Biochim Biophys Acta (BBA)-Rev Cancer</source>
        <year>2017</year>
        <volume>1867</volume>
        <issue>2</issue>
        <fpage>127</fpage>
        <lpage>138</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Biele</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bouchard-Côté</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>PyClone: statistical inference of clonal population structure in cancer</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>396</fpage>
        <lpage>398</lpage>
        <?supplied-pmid 24633410?>
        <pub-id pub-id-type="pmid">24633410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popic</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Salari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kashef-Haghighi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">25583448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>PhyloWGS: reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">25583448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zare</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Blau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Inferring clonal composition from multiple sections of a breast cancer</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>e1003703</fpage>
        <?supplied-pmid 25010360?>
        <pub-id pub-id-type="pmid">25010360</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El-Kebir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Oesper</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Acheson-Field</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>i62</fpage>
        <lpage>i70</lpage>
        <?supplied-pmid 26072510?>
        <pub-id pub-id-type="pmid">26072510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffith</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>OL</given-names>
          </name>
          <name>
            <surname>Krysiak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Skidmore</surname>
            <given-names>ZL</given-names>
          </name>
          <name>
            <surname>Ramu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dang</surname>
            <given-names>HX</given-names>
          </name>
          <name>
            <surname>Trani</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>Optimizing cancer genome sequencing and analysis</article-title>
        <source>Cell Syst</source>
        <year>2015</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>210</fpage>
        <lpage>223</lpage>
        <?supplied-pmid 26645048?>
        <pub-id pub-id-type="pmid">26645048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Advances and applications of single-cell sequencing technologies</article-title>
        <source>Mol Cell</source>
        <year>2015</year>
        <volume>58</volume>
        <issue>4</issue>
        <fpage>598</fpage>
        <lpage>609</lpage>
        <?supplied-pmid 26000845?>
        <pub-id pub-id-type="pmid">26000845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navin</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Cancer genomics: one cell at a time</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Biele</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>McAlpine</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Clonal genotype and population structure inference from single-cell tumor sequencing</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>573</fpage>
        <lpage>576</lpage>
        <?supplied-pmid 27183439?>
        <pub-id pub-id-type="pmid">27183439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Single-cell sequencing data reveal widespread recurrence and loss of mutational hits in the life histories of tumors</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1885</fpage>
        <lpage>1894</lpage>
        <?supplied-pmid 29030470?>
        <pub-id pub-id-type="pmid">29030470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>KI</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using single cell sequencing data to model the evolutionary history of a tumor</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malikic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Integrative inference of subclonal tumour evolution from single-cell and bulk sequencing data</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Tree inference for single-cell data</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>OncoNEM: inferring tumor evolution from single-cell sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">28077169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SiCloneFit: Bayesian inference of population structure, genotype, and phylogeny of tumor clones from single-cell genome sequencing data</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>11</issue>
        <fpage>1847</fpage>
        <lpage>1859</lpage>
        <?supplied-pmid 31628257?>
        <pub-id pub-id-type="pmid">31628257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salehi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bouchard-Côté</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>ddClone: joint statistical inference of clonal populations from single cell and bulk tumour sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">28077169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malikic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mehrabadi</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Ciccolella</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Ricketts</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Haghshenas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Seidman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hach</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>PhISCS: a combinatorial approach for subperfect tumor phylogeny reconstruction via integrative use of single-cell and bulk sequencing data</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>11</issue>
        <fpage>1860</fpage>
        <lpage>1877</lpage>
        <?supplied-pmid 31628256?>
        <pub-id pub-id-type="pmid">31628256</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Rosenberg A, Hirschberg J. V-measure: a conditional entropy-based external cluster evaluation measure. In: Proceedings of the 2007 joint conference on empirical methods in natural language processing and computational natural language learning (EMNLP-CoNLL); 2007. p. 410–420.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>218</lpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hadley</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>Ggplot2: elegrant graphics for data analysis</source>
        <year>2016</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leung</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Casasent</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sei</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vilar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Maru</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kopetz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Single-cell DNA sequencing reveals a late-dissemination model in metastatic colorectal cancer</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>8</issue>
        <fpage>1287</fpage>
        <lpage>1299</lpage>
        <?supplied-pmid 28546418?>
        <pub-id pub-id-type="pmid">28546418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zaccaria</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Scarlet: single-cell tumor phylogeny inference with copy-number constrained mutation losses</article-title>
        <source>Cell Syst</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>323</fpage>
        <lpage>332.e328</lpage>
        <?supplied-pmid 32864481?>
        <pub-id pub-id-type="pmid">32864481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Waters</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Unruh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vattathil</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Clonal evolution in breast cancer revealed by single nucleus genome sequencing</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>512</volume>
        <issue>7513</issue>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <?supplied-pmid 25079324?>
        <pub-id pub-id-type="pmid">25079324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karpov</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Malikic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>A multi-labeled tree dissimilarity measure for comparing “clonal trees” of tumor progression</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">30839948</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
        </person-group>
        <article-title>The nested Chinese restaurant process and Bayesian nonparametric inference of topic hierarchies</article-title>
        <source>J ACM (JACM)</source>
        <year>2010</year>
        <volume>57</volume>
        <issue>2</issue>
        <fpage>1</fpage>
        <lpage>30</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Frazier</surname>
            <given-names>PI</given-names>
          </name>
        </person-group>
        <article-title>Distance dependent Chinese restaurant processes</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>8</issue>
        <fpage>2461</fpage>
        <lpage>2488</lpage>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fritsch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ickstadt</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Improved criteria for clustering based on the posterior similarity matrix</article-title>
        <source>Bayesian Anal</source>
        <year>2009</year>
        <volume>4</volume>
        <issue>2</issue>
        <fpage>367</fpage>
        <lpage>391</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baldassano</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Fei-Fei</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Parcellating connectivity in spatial maps</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e784</fpage>
        <?supplied-pmid 25737822?>
        <pub-id pub-id-type="pmid">25737822</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
