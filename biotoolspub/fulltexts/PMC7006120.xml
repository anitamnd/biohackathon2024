<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7006120</article-id>
    <article-id pub-id-type="publisher-id">6541</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-6541-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iREAD: a tool for intron retention detection from RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Hong-Dong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Funk</surname>
          <given-names>Cory C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4157-0267</contrib-id>
        <name>
          <surname>Price</surname>
          <given-names>Nathan D.</given-names>
        </name>
        <address>
          <email>Nathan.Price@systemsbiology.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution>Center for Bioinformatics, </institution><institution>School of Computer Science and Engineering, Central South University, </institution></institution-wrap>Changsha, Hunan Province 410083 People’s Republic of China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0463 2320</institution-id><institution-id institution-id-type="GRID">grid.64212.33</institution-id><institution>Institute for Systems Biology, </institution></institution-wrap>Seattle, WA 98109 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>128</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Intron retention (IR) has been traditionally overlooked as ‘noise’ and received negligible attention in the field of gene expression analysis. In recent years, IR has become an emerging field for interrogating transcriptomes because it has been recognized to carry out important biological functions such as gene expression regulation and it has been found to be associated with complex diseases such as cancers. However, methods for detecting IR today are limited. Thus, there is a need to develop novel methods to improve IR detection.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we present iREAD (intron REtention Analysis and Detector), a tool to detect IR events genome-wide from high-throughput RNA-seq data. The command line interface for iREAD is implemented in Python. iREAD takes as input a BAM file, representing the transcriptome, and a text file containing the intron coordinates of a genome. It then 1) counts all reads that overlap intron regions, 2) detects IR events by analyzing the features of reads such as depth and distribution patterns, and 3) outputs a list of retained introns into a tab-delimited text file. iREAD provides significant added value in detecting IR compared with output from IRFinder with a higher AUC on all datasets tested. Both methods showed low false positive rates and high false negative rates in different regimes, indicating that use together is generally beneficial. The output from iREAD can be directly used for further exploratory analysis such as differential intron expression and functional enrichment. The software is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/genemine/iread">https://github.com/genemine/iread</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">Being complementary to existing tools, iREAD provides a new and generic tool to interrogate poly-A enriched transcriptomic data of intron regions. Intron retention analysis provides a complementary approach for understanding transcriptome.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Intron retention</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>iREAD</kwd>
      <kwd>Gene expression</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01AG006786</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014718</institution-id>
            <institution>Innovative Research Group Project of the National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61702556</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">Historically being considered as transcriptional noise or ‘junk’, intron retention (IR) has recently been shown to carry out important biological functions such as regulating gene expression that is coupled with nonsense mediated decay [<xref ref-type="bibr" rid="CR1">1</xref>], producing novel isoforms [<xref ref-type="bibr" rid="CR2">2</xref>] and targeting specific cell compartments [<xref ref-type="bibr" rid="CR3">3</xref>]. It has thus been gaining recent interest, especially as it relates to a putative role in health and disease. Tumor-specific IRs were overexpressed in lung adenocarcinoma tumors [<xref ref-type="bibr" rid="CR4">4</xref>], and IRs were mostly increased in an analysis across 16 cancers [<xref ref-type="bibr" rid="CR5">5</xref>]. IR appears to be a widespread mechanism of tumor-suppressor inactivation based on integrative analysis of exome and RNA sequencing data [<xref ref-type="bibr" rid="CR6">6</xref>]. IR was also found to regulate gene expression in biological processes such as normal granulocyte differentiation [<xref ref-type="bibr" rid="CR7">7</xref>], CD4+ T cell activation [<xref ref-type="bibr" rid="CR8">8</xref>], and terminal erythropoiesis [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Functions of IR were systematically discussed in two recent reviews [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par10">Next generation sequencing has resulted in a vast amount of RNA-seq data, which provides a rich resource for the detection of IR in combination with bioinformatics tools. However, to the best of our knowledge, only a few computational tools have been developed thus far—and these tools are either not freely available or have limitations. The methods described in [<xref ref-type="bibr" rid="CR12">12</xref>] and [<xref ref-type="bibr" rid="CR5">5</xref>] are not publicly available. IRcall and IR classifier are also not currently available, possibly due to website changes [<xref ref-type="bibr" rid="CR13">13</xref>]. The recently developed KMA (Keep Me Around) is an efficient method for IR detection [<xref ref-type="bibr" rid="CR14">14</xref>]. It involves transcript quantification from the command line followed by intron retention analysis in R, which brings some inconveniences due to switching software environments. Also, the flat distribution of retained reads, a common feature of IR, is not well identified in KMA. By analyzing the number of exon-exon junction reads and exon-intron junction reads, IRFinder detects retained introns by calculating a retention ratio that reflects the relative expression of transcripts with the retained intron to those that span the intron but does not have the intron retained [<xref ref-type="bibr" rid="CR15">15</xref>]. As a promising approach, IRFinder also has one limitation that the distribution pattern of intronic reads is not well addressed [<xref ref-type="bibr" rid="CR15">15</xref>]. Also, IRFinder considers introns that completely overlap of exons of other transcripts, resulting in the fact that the identified IR events may be ambiguous. For methods like rMATS [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] and MISO [<xref ref-type="bibr" rid="CR18">18</xref>], they can only analyze annotated introns in gene models and therefore can not be applied to profile all intron retention events that exist in samples. Another limitation of rMATS is that it focuses on determining the changes of PSI (percent spliced in) values between two groups of samples; those introns which are retained but not differentially expressed are not considered, therefore one cannot obtain holistic profiles of all retained introns by these methods. Therefore, developing new algorithms for detecting intron retention remains to be in great need.</p>
    <p id="Par11">In this work, we present iREAD (intron REtention Analysis and Detector), for the identification of IR from poly-A enriched RNA-seq data (single-end and paired-end). iREAD takes as input an existing BAM file and an annotation file that contains a list of introns that do not overlap any exons of any other splice isoforms or genes. For convenience, such introns are called ‘independent introns’. The features of iREAD are several folds. Firstly, the use of independent introns can help avoid the confounding of exons that overlap with introns, thus enabling unambiguous identification of intron retention. Methods like IRFinder include introns completely overlapping with exons of other transcripts and the resulting IR events may be ambiguous. Secondly, iREAD detects retained introns through analyzing both splice junction reads and intron expression level that considers all the intronic reads to increase confidence. However, methods like IRFinder only look at the percentage of expression of intron-retained RNA calculated from junction reads and do not consider expression level of introns. Thirdly, based on information theory, we proposed a novel entropy score to assess ‘how flat’ intronic reads are distributed across the whole intron region, a feature unique to iREAD. Using both simulated RNA-seq data and a deep-sequencing poly-A enriched mouse RNA-seq data, we tested the performance of iREAD and compared it with existing tools.</p>
  </sec>
  <sec id="Sec2">
    <title>Algorithm and Implementation</title>
    <sec id="Sec3">
      <title>Algorithm</title>
      <p id="Par12">iREAD takes two input files (Fig. <xref rid="Fig1" ref-type="fig">1</xref>): (1), a BAM file that is generated by aligning reads to a reference genome using tools such as STAR. The BAM file needs to be sorted by coordinates (the default of STAR) and to be indexed (can be done using the ‘samtools index’ command). (2), a text file containing the coordinates of independent introns that do not overlap with any exons of any other isoforms or genes. Independent introns are calculated by merging exons of all isoforms and genes of a given genome followed by subtracting them from spanning regions of genes using Bedtools [<xref ref-type="bibr" rid="CR19">19</xref>]. Using ENSEMBL gene models (GTF format based on GRCh38), we identified independent introns together with their coordinates and parent-gene information for humans and mice, and provided them in the iREAD package. Pre-computed independent introns of humans and mice based on other versions of GTF annotation are made available at our website (<ext-link ext-link-type="uri" xlink:href="https://github.com/genemine/iread">https://github.com/genemine/iread</ext-link>). Independent introns of any other species can be identified in the same way. Since iREAD does not rely on known IR annotations, any retained introns (known or novel) are expected to be detected by iREAD.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic of the iREAD algorithm. iREAD takes two input files: a BAM file resulting from polyA-enriched RNA-seq read alignment and text file containing a list of independent introns that do not overlap with any exons of any transcripts. iREAD then counts the number of reads (partially) falling into the intron regions. After recording intronic reads, four filters (number of total reads, number of exon-intron junction reads, FPKM and entropy score) are calculated for filtering for high confidence intron retention events</p></caption><graphic xlink:href="12864_2020_6541_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par13">Firstly, reads overlapping the independent intronic regions are extracted from BAM files using Samtools, and reads are counted with Bedops [<xref ref-type="bibr" rid="CR20">20</xref>]. Since the resulting reads include spliced reads that can span but do not physically overlap introns, we developed a Perl script to count reads that fully reside in or partially overlap with the pre-calculated independent introns by considering both the read-spanning length (from the reference genome) and the coordinates of the independent introns. Specifically, iREAD counts and records the number of exon-intron junction reads, which provides direct evidence supporting retention of introns.</p>
      <p id="Par14">Because reads in retained introns are often flatly distributed across the whole intron region, we developed a score to characterize the ‘flatness’ of intronic reads based on information theory. We divide each intron into eight bins, count the number of reads in each bin, and record the number of reads in a vector, denoted as <bold>r</bold> = (n<sub>1</sub>, n<sub>2</sub>, …, n<sub>8</sub>). This vector is then converted to a probability mass distribution by normalization using the following formula:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_i=\frac{n_i}{\sum {n}_i},i=1,\dots, 8. $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>∑</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12864_2020_6541_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par15">The entropy of this distribution is calculated as:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ entropy=-{\sum}_{i=1}^8{p}_i lo{g}_2\left({p}_i\right) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mtext mathvariant="italic">entropy</mml:mtext><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="italic">lo</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:math><graphic xlink:href="12864_2020_6541_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par16">Because the maximal entropy for eight bins is 3, we divide the entropy by 3 and normalize it to be in the range [0,1], called the normalized entropy score (NE-score) for convenience.
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ NE- score=\frac{entropy}{3} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi mathvariant="italic">NE</mml:mi><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext mathvariant="italic">entropy</mml:mtext><mml:mn>3</mml:mn></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6541_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par17">Summing up, we recorded the number of total reads (denoted by T) and junction reads (denoted by J), and the NE-score of each intron. FPKM is also calculated for each intron to account for intron length. Based on these features, we can set threshold values to filter for IR events of high confidence. In the iREAD package, strict threshold values (T ≥ 20, J ≥ 1, FPKM≥3 and NE-score ≥ 0.9) are used as default to identify intron retention events conservatively and reliably. However, users can tune the default parameters in their own study.</p>
      <p id="Par18">iREAD is suitable for both single-end and paired-end sequencing data. For paired-end data, following the conventional practice in RNA-seq data analysis, the number of fragments is counted, i.e. a pair of reads is counted as one fragment.</p>
    </sec>
    <sec id="Sec4">
      <title>Implementation</title>
      <p id="Par19">We implemented the iREAD pipeline on the command line using a mixture of Perl and Python scripts. The command interface is implemented in Python using the ‘<italic>argparse</italic>’ module. iREAD requires a BAM file and a text file of independent introns as input. To determine IR events, we have implemented four filters: total reads, junction reads, FPKM and NE-score, which can be tuned easily by specifying the values of the optional parameters ‘-n’, ‘-j’, ‘-f’, and ‘-e’, respectively. To obtain high-confidence IR events, the number of total reads, junction reads, FPKM and NE-score is set to 20, 1, 3 and 0.9 respectively by default. Samtools and Bedops [<xref ref-type="bibr" rid="CR20">20</xref>], which are two commonly used tools in NGS data analysis, need to be installed for running iREAD.</p>
      <p id="Par20">Using the Perl module Parallel::ForkManager, we recently parallelized iREAD so that it can use multi-cores, which makes the current version of iREAD (version 0.8.0) much faster than the previous one (version 0.6.0).</p>
      <p id="Par21">We implemented detailed and self-evident help document for iREAD. One can use the command ‘iread.py -h’ to obtain help information.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results</title>
    <sec id="Sec6">
      <title>User interface and usage</title>
      <p id="Par22">iREAD is implemented in Python with a command line interface, which can be run on Linux and Mac operating systems. For the convenience of testing, we have included an RNA-seq data (<italic>data/mouse_test.bam</italic>) and the annotation of independent introns of mice (<italic>meta/intron_mouse_3875.bed</italic>) in the iREAD folder. Using this data, users can run iREAD for IR detection using the command ‘<italic>iread.py data/mouse_test.bam meta/intron_mouse_3875.bed -o tmp_output -t 62000000</italic>’ (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), where ‘-o’ and ‘-t’ specify the output folder and the number of total fragments in the data.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Illustration of the usage and output of iREAD. <bold>a</bold> an example run of iREAD on a mouse RNA-seq data that is included in the package. In addition to the RNA-seq BAM file and the intron file, ‘-o’ and ‘-t’ specify the output directory and the library size, respectively. <bold>b</bold> example rows of the output file resulting from (<bold>a</bold>). As shown, this file contains 7 columns. The first column is the intron ID. By default, iREADs uses strict criteria (fragments≥20, junction_reads≥1, FPKM≥3 and entropy_score &gt; =0.9) to filter for intron retention events. The last column indicates whether an intron is retained (‘yes’) or not (‘no’). Note that the threshold for determining intron retention are optional parameters and can be tuned by the users</p></caption><graphic xlink:href="12864_2020_6541_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par23">After the iREAD run is finished, a file called mouse_test.ir is generated in the ‘tmp_output’ folder, where a list of introns together with their features such as the number of all reads (both junction and intronic), junction reads, FPKM and NE-score is stored (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). The last column of this file indicates whether the intron is retained (‘yes’) or not (‘no’) under default settings.</p>
    </sec>
    <sec id="Sec7">
      <title>Comparison of iREAD with IRFinder using simulated RNA-seq data</title>
      <p id="Par24">We compared the performance of iREAD to the state-of-the-art method IRFinder [<xref ref-type="bibr" rid="CR15">15</xref>]. To the best of our knowledge, a gold standard dataset of experimentally validated intron retention events is not available for benchmarking. Therefore, we simulated an RNA-seq dataset using the BEER software [<xref ref-type="bibr" rid="CR21">21</xref>]. As suggested by the current author of BEER, the option for generating novel splice isoforms is turned off, which is suitable for intron retention analysis. Based on the mouse ENSEMBL gene build GTF file (version 77) and using default setting, we generated a dataset of 30 million (30 M) paired reads. From this dataset, we randomly sampled half of the read pairs to generate a lower-depth dataset of 15 million (15 M) reads. For both datasets, based on the coordinates of each read, we first mapped the reads to all introns and then constructed three gold standard (GS) sets of IRs of different confidence level: GS1, GS2 and GS2, for which the minimum allowed FPKM of retained introns is set to 0.1, 0.3 and 0.5, respectively. GS3 collects IRs of the highest confidence, while the IRs in GS1 is relatively the least strictly-defined. GS2 includes IRs of the medium-level confidence. In addition, all IRs in these three sets have at least 10 paired end reads and at least one junction read that spans the exon-intron junction.</p>
      <p id="Par25">We ran iREAD and IRFinder on both the 15 M and 30 M datasets. The same gene annotation model (ENSEMBL GTF file, version 77) was used for iREAD and IRFinder. For iREAD, default settings of the four filters (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) were used to determine IR events. For IRFinder, it mainly uses one metric, called IRratio ranging from 0 to 1, to describe to which extent an IR is retained, without providing an indicator of whether introns are retained or not.</p>
      <p id="Par26">First, we compared the performance of iREAD and IRFinder using their default settings to identify IR events. For IRFinder, the threshold of IRratio was set to 0.1 following the original paper [<xref ref-type="bibr" rid="CR15">15</xref>]. Also, introns flagged with warning messages such as ‘low coverage’ by IRFinder were removed because of their low confidence. Default settings for iREAD are described in Section 2.2. For a given RNA-seq dataset, assuming that iREAD detects N<sub>1</sub> retention events and IRFinder detects N<sub>2</sub> introns with IRratio≥0.1, we sorted the retained introns by FPKM for iREAD and by IRratio for IRFinder, and chose the top <italic>N</italic> = min(N<sub>1</sub>,N<sub>2</sub>) to compare.</p>
      <p id="Par27">The comparison of iREAD and IRFinder on the two simulated datasets are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. On the 15 M simulated data, the top ranked <italic>N</italic> = 2498 IR events by iREAD and IRFinder were compared. Out of the top ranked 2498 IR events, we found that 287 (11.5%) were shared by both methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a), which indicates that the intron annotation and/or criteria used by iREAD and IRFinder capture different features of intron retention events. We further evaluated the precision (the number of true positives divided by the sum of true positives and false positives) and recall (the number of detected positives divided by the total number of positives in the dataset), for each method using the gold standard. We found that the precision of IRFinder on the GS1 (FPKM≥0.1), GS2 (FPKM≥0.3) and GS3 (FPKM≥0.5) gold standard were 0.73 (recall = 0.06), 0.73 (recall = 0.07) and 0.71 (recall = 0.08), respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c and d). The precision of iREAD was 0.99 in all the three gold standard sets, with recall equal to 0.08, 0.09 and 0.11 on GS1, GS2 and GS3, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). The reason why iREAD achieves higher precision may be that it directly counts the reads fully within introns and across exon-intron boundaries and therefore retained introns are expected to be found, as long as they are covered by a sufficient number of reads. In contrast, IRFinder uses IRratio, a more sophisticated criterion that measures the percentage of intron-retained transcripts; therefore, introns with high absolute expression but low relative expression may not be detected. Moreover, we looked into the top ranked IR events by IRFinder, and found that 36 out of the top 100 IR events completely overlap with exons of splice isoforms of the same gene. This result reflects that a proportion of IR events by IRFinder might be false positives because they overlap with exons; in contrast, the results of iREAD are confident because it only analyzes independent introns which by definition do not overlap with any exons of any genes. This is another reason why the sharing between IRFinder and iREAD is low and why IRfinder is less accurate. Nonetheless, the above result shows that most of IR events identified by both IRFinder and iREAD are accurate. On the 30 M simulated data, we detected slightly more intron retention events (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e), likely due to the increased depth of the data. The precision comparison of IREAD and IRFinder is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>f, g and h, respectively. The results on the 30 M dataset is similar to that on the 15 M dataset (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of the precision of iREAD with IRFinder on their identified intron retention events at default settings using simulated RNA-seq data with known ground-truth intron retention events. Two datasets were used, which are, for convenience, called15M dataset (containing 15 M reads) and 30 M dataset (containing 30 M reads). Firstly, retained introns were detected using both IRFinder and iREAD with default thresholds. Suppose N<sub>1</sub> and N<sub>2</sub> IR events were detected by each method, and the top ranked <italic>N</italic> = min(N<sub>1</sub>, N<sub>2</sub>) IR events of each method were compared in terms of the number of shared IR events and precision. N was found to be 2498 and 2683 for the 15 M (upper panel) and 30 M (lower panel) dataset, respectively. The sharing of identified IRs on the 15 M and 30 M dataset is shown in (<bold>a</bold>) and (<bold>e</bold>), respectively. On the 15 M dataset, the precision of IRFinder and iREAD based on the GS1 (FPKM≥0.1), GS2 (FPKM≥0.3) and GS3 (FPKM≥0.5) gold standard is presented in (<bold>b</bold>), (<bold>c</bold>) and (<bold>d</bold>), respectively. On the 30 M dataset, the precision of IRFinder and iREAD based on the GS1, GS2 and GS3 gold standard is presented in (<bold>f</bold>), (<bold>g</bold>) and (<bold>h</bold>), respectively. The results showed that iREAD achieved consistently higher precision than IRFinder on the IRs identified at default setting</p></caption><graphic xlink:href="12864_2020_6541_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par28">Second, we compared iREAD with IRFinder in a comprehensive manner. Without using the default thresholds for detecting IRs, we pulled out all the introns analyzed by iREAD and IRFinder, and sorted them by FPKM and IRratio, respectively. We then calculated the ROC curves using the GS1 (FPKM≥0.1), GS2 (FPKM≥0.3) and GS3 (FPKM≥0.5) gold standard, respectively. The results on the 15 M and 30 M dataset based on GS1, GS2 and GS3 are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. For the 15 M dataset, we found that the AUC of iREAD on GS1, GS2 and GS3 are 0.77, 0.81 and 0.84, which is consistently higher than that of IRFinder whose AUC are 0.73, 0.74 and 0.75. Another observation is that, with increased confidence of gold standard from GS1 to GS3, the AUCs of both iREAD and IRFinder increase, being consistent with our expectation. The above observations hold on the 30 M dataset.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance comparison among iREAD, IRFinder and their combined score on the simulated 15 M and 30 M RNA-seq datasets with known ground-truth intron retention events in terms of AUC. The ROC curves of both methods based on the GS1(FPKM≥0.1), GS2 (FPKM≥0.3) and GS3(FPKM≥0.5) gold standard for the 15 M dataset is shown in (<bold>a</bold>), (<bold>b</bold>) and (<bold>c</bold>), respectively. Similarly, the ROC curves of both methods based on the GS1, GS2 and GS3 gold standard for the 30 M dataset are shown in (<bold>d</bold>), (<bold>e</bold>) and (<bold>f</bold>), respectively</p></caption><graphic xlink:href="12864_2020_6541_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par29">As iREAD complements IRFinder to some extent, we tested whether an ensemble of these two approaches could improve the results for IR identification. The scores used for evaluating intron retention propensity are intron expression level for iREAD and IRratio for IRFinder. One difficulty that faces us is that these two types of scores are not comparable. We therefore considered normalizing the scores. First, as the distribution of both scores of these two methods are heavily tailed, log<sub>2</sub>-transformation was applied to make the scores approximately normally distributed. To make the scores of iREAD and IRFinder in the same scale and comparable, the log<sub>2</sub>-transformed scores are further standardized to have zero mean and unit variance (with mean subtracted and divided by standard deviation using the <italic>scale</italic> function in R base package version 3.5.2). Let S<sub>1</sub> and S<sub>2</sub> be the log<sub>2</sub>-transformed and standardized score of iREAD and IRFinder. We then calculated their integrated score as <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ S=\frac{1}{2}\left({S}_1+{S}_2\right) $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6541_Article_IEq1.gif"/></alternatives></inline-formula>. The performance of this integrated score in terms of AUC was shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. We observed that, for both the 15 M and 30 M datasets, the integrated score achieved better results than both iREAD and IRFinder, suggesting that these two approaches are complementary.</p>
      <p id="Par30">We further showed that the more confident the retained introns are, the more improvement of AUC the integrated score would achieve. For each of the six data settings in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, we ranked the positive retained introns by their expression level (FPKM). Then, we constructed a series of gold standard by including only a subset of the top ranked positives and all the negatives. Denote the proportion of selected top positives by R. We tested five values of R, which are 20, 40, 60, 80 and 100%. Note that <italic>R</italic> = 100% is equal to using all positive introns as in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. For each <italic>R</italic> value, we calculated AUC for IRFinder, iREAD and the integrated score, respectively. Then we calculated the Performance Improvement Ratio (PIR) as <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ PIR=\frac{AUC_{integrated}-{AUC}_{mean}}{AUC_{mean}} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:mi mathvariant="italic">PIR</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="italic">AUC</mml:mi><mml:mtext mathvariant="italic">integrated</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">AUC</mml:mi><mml:mtext mathvariant="italic">mean</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi mathvariant="italic">AUC</mml:mi><mml:mtext mathvariant="italic">mean</mml:mtext></mml:msub></mml:mfrac><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="12864_2020_6541_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>AUC</italic><sub><italic>integrated</italic></sub> represents the AUC of the integrated score and <italic>AUC</italic><sub><italic>mean</italic></sub> stands for the mean AUC of IRFinder and iREAD. The results of PIR for both the 15 M and 30 M datasets are presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. It was observed that PIR decreases as a function of increased numbers of positive retained introns, suggesting that iREAD and IRFinder complement most each other for the top ranked introns and that their complementarity decreases for the lower ranked introns. Further, at a given value of <italic>R</italic> (e.g. 60%), we found that the lowest, medium and highest PIR values are achieved on the least confident (GS1), intermediate confident (GS2) and most confident (GS3) gold standard, respectively, again supporting that the highest gain in performance could be achieved for the most confidently retained introns.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance improvement ratio (PIR) by the integrated score over the average performance of iREAD and IRFinder in terms of AUC. PIR was calculated for both the 15 M (<bold>a</bold>) and 30 M (<bold>b</bold>) datasets using the three different gold standard set of retained introns: GS1(FPKM≥0.1), GS2 (FPKM≥0.3) and GS3(FPKM≥0.5). PIR decreases as a function of increased numbers of positive retained introns, suggesting that iREAD and IRFinder complement most each other for the top ranked introns</p></caption><graphic xlink:href="12864_2020_6541_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par31">Using simulated data with different sequencing depth and gold standard of retained introns of different quality, we found that both iREAD and IRFinder are accurate, and that many of their detected retention events are not shared due presumably to their differences in intron annotation and in the criteria for retention evaluation. We also showed that these two methods complement each other and using the integrated score of these methods could help improve the power for intron retention detection.</p>
    </sec>
    <sec id="Sec8">
      <title>Comparison of iREAD with IRFinder on mouse RNA-seq data</title>
      <p id="Par32">We further compared iREAD and IRFinder using a mouse brain RNA-seq data (available at <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:">https://www.synapse.org/#!Synapse:</ext-link> syn4486837, sample ID:256520).</p>
      <p id="Par33">This data was generated by polyA-enrichment and sequenced with 133 million paired end reads. Using the same approach for extracting the top ranked retained introns as used for the simulation experiments, we obtained 3238 IR events from each method, out of them 532 are shared.</p>
      <p id="Par34">As the number of IRs shared by the two methods is small, we investigated why the two methods are disparate in their annotation by performing a systematic comparison of the 3238 IRs detected by each method. First, we excluded the 532 shared IRs detected by both methods and focused the analysis on the IRs specific to each method. For the 2706 IR events that are specific to IRFinder, only 1434 (53.0%) are annotated with ‘clean’ by the IRFinder software, which are IRs of high confidence; in contrast, a much higher percentage (69.2%) are annotated with ‘clean’ among the IRs shared by both methods. 741 (27.4%) are annotated with ‘known-exon’, indicating that a significant proportion of retained introns overlap with exons of other isoforms/genes; none of the IRs shared by both methods are annotated with ‘known-exon. Such introns cannot be detected by iREAD because it is designed to detect only independent introns. 386 (14.3%) are annotated with ‘anti-near’ (having a nearby gene on the antisense strand), which are another type of high quality annotation; this percentage is 30.0% for the IRs agreed by both methods. 145 (5.3%) are annotated with ‘anti-over’ (overlapping with another gene on the antisense strand), meaning that the reads in such introns may be from the anti-sense gene; the shared IRs have a lower percentage (0.8%) for this type of annotation. Further, we examined systematically why IRFinder-specific IRs are not detected by iREAD at default setting. We matched them to the independent introns used by iREAD and extracted their expression values in terms of FPKM. By comparison, it is found that IRFinder-specific IRs (not detected by iREAD) show generally lower expression than those retained introns detected by iREAD at default settings (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). This observation suggests that iREAD may fail when the intron have low absolute expression (FPKM) though the relative expression of intron-retained transcripts (i.e. IRratio) can be high. For iREAD-specific IRs, we examined why they are not detected by IRFinder at default setting. We matched them to the introns used by IRFinder and extracted their IRratio values. It is found that iREAD-specific IRs (not detected by IRFinder) show generally lower IRratio values than those retained introns detected by IRFinder at default settings (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). This observation suggests that IRFinder may fail when the relative expression of intron-retained transcripts is low though the intron may have high expression. This comparison again supports the complementarity between the two methods, and combining both methods may provide a more comprehensive set of IR events.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Systematic analysis of IRs detected by only IRFinder (IRFinder-specific) or iREAD (iREAD-specific) in the mouse data. We matched IRFinder-specific IRs to the introns used in iREAD and obtained their expression values in terms of FPKM; specifically, the IRFinder-specific introns overlapping with exons are not considered because iREAD does not consider them. We also matched iREAD-specific IRs to the introns used in IRFinder and obtained their IRratio values. IRFinder-specific IRs (with relatively higher IRratio) show generally lower expression than the retained introns detected by iREAD at default settings. iREAD-specific IRs (with relatively higher expression) show generally lower IRratio values than the retained introns detected by IRFinder at default settings. The shared IRs of the two methods have high IRratio and high expression</p></caption><graphic xlink:href="12864_2020_6541_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par35">As illustrations, we showed one example for each of the three categories: shared IRs, IRFinder-specific IRs and iREAD-specific IRs, respectively. For the shared introns, an example is a confidently retained intron (chr19:5496402–5,496,985) of <italic>Snx32</italic> (ENSMUSG00000056185) with an NE-score of 0.995 and coverage by 420 reads of which 157 are junction reads (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a). The IRratio of this intron by IRFinder is 0.29, which is significantly higher than the threshold 0.1. In Fig. <xref rid="Fig7" ref-type="fig">7</xref>b, we showed an intron (5:142,905,278-142,905,428 of the gene <italic>Actb</italic>) identified to be retained by IRFinder but not by iREAD. With a closer look at the gene model in Fig. <xref rid="Fig7" ref-type="fig">7</xref>b, it can be found that this intron of the transcript ENSMUST00000163829 completely overlap with exons of another transcript (ENSMUST00000106216) of the same gene, indicating that this ‘retained intron’ is ambiguous because it could result from the transcription of exons. This observation explains why iREAD does not consider this intron to be retained because it only detects the unambiguous independent introns that do not overlap with any exons of any transcripts. However, in IRFinder, ambiguous intron retention events are also included. In Fig. <xref rid="Fig7" ref-type="fig">7</xref>c, we showed one example intron (chr22:109,546,542-109,549,290 of the gene <italic>Meg3</italic>) which was detected to be retained by iREAD but not by IRFinder. Clearly, this intron does not overlap with exons of any other transcripts, and all intronic reads must come from retained introns. We are not clear why this intron is missed by IRFinder.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Examples of retained introns in the mouse RNA-seq data visualized in IGV (v2.3.90). <bold>a</bold> a retained intron (chr19:5496402–5,496,985) of <italic>Snx32</italic> identified by both IREAD and IRFinder. <bold>b</bold>, a retained intron (5:142,905,278-142,905,428 of <italic>Actb</italic>) identified by IRFinder but not by iREAD. As can be seen from the gene model in (<bold>c</bold>), this intron completely overlap with exons of another transcript (ENSMUST00000106216) of the same gene, indicating that this ‘retained intron’ is ambiguous because it could result from the transcription of exons. iREAD does not consider this intron to be retained because it only analyzes independent introns, i.e. unambiguous introns that do not overlap with any exons of any transcripts. <bold>c</bold>, a retained intron (chr22:109,546,542-109,549,290 of Meg3) identified by iREAD but not by IRFinder</p></caption><graphic xlink:href="12864_2020_6541_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>iREAD detects biologically relevant IRs</title>
      <p id="Par36">To illustrate that iREAD is capable of detecting biologically meaningful IRs, we analyzed a dataset of human induced pluripotent stem cells (hiPSCs) that can be differentiated to neurons. This dataset contains samples at four time points (Day 1, Day 2, Day 3, Day 4), with 3 samples at each time point. Thus, there are a total of 12 samples. We downloaded the raw RNA-sequencing data in FASTQ format of the 12 samples, and apply iREAD to each sample to detect IR events. Using edgeR, we detected differentially expressed retained introns between Day 1 and Day 4. A total of 75 differential introns (FDR &lt; 0.05) were detected. As shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, these retained introns mark the developmental stages of hiPSCs during differentiation into neurons.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Heatmap of expression of differentially expressed retained introns between Day 1 and Day 4 in the human induced pluripotent stem cells (hiPSCs) dataset. Three samples are measured at each time point and the mean expression of the three samples are shown. Retained introns mark the developmental stages of hiPSCs during differentiation into neurons</p></caption><graphic xlink:href="12864_2020_6541_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par37">To understand the functions of the differential IRs, we performed Gene Ontology (GO) enrichment analysis for the parent genes of these IRs using the clusterProfiler software (v3.12). We found that the genes are enriched in a total of 22 GO biological process terms, suggesting that the detected IRs are not random but are related to biological pathways. Moreover, we found that some of these enriched terms are related to the differentiation of hiPSC into neurons. For example, <italic>regulation of cholesterol biosynthetic process</italic> (GO:0045540) was shown to be relevant to the neural stem cell differentiation [<xref ref-type="bibr" rid="CR22">22</xref>]. Modulation of chemical synaptic transmission (GO:0050804) have been reported to be associated with human iPSC-derived neurons [<xref ref-type="bibr" rid="CR23">23</xref>]. RNA splicing (GO:0008380) was implicated in human iPSCs that undergo neuron differentiation [<xref ref-type="bibr" rid="CR24">24</xref>]. These results imply that biologically meaningful IRs can be uncovered with iREAD.</p>
    </sec>
    <sec id="Sec10">
      <title>Speed</title>
      <p id="Par38">We compared the speed of IRFinder and iREAD for intron retention detection using the above-mentioned high sequencing depth mouse sample with 133 million reads (9.9G BAM file). From the raw BAM file, we also randomly sampled 30 and 60 million of the paired end reads to generate RNA-seq data of different sequencing depth for investigating how the speed of iREAD changes with the number of reads. On a commonly used server with 20 cores and 64G memory, iREAD takes only 5, 12 and 22 min for intron retention detection for the three sub-datasets at different depth (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). Since most RNA-seq data have less than 60 million reads. iREAD is expected to finish IR event detection of one RNA-seq sample with ~ 10 min, which is efficient. We also tested IRFinder on the same computer, and found that the speed of both methods are comparable (Fig. <xref rid="Fig9" ref-type="fig">9</xref>).
<fig id="Fig9"><label>Fig. 9</label><caption><p>We compared the speed of iREAD to IRFinder using three data at different depth (30 M, 60 M and 120 M). The 30 M and 60 M data are sub-sampled from the original mouse RNA-seq data with 120 M reads. It shows that the speed of both methods are comparable</p></caption><graphic xlink:href="12864_2020_6541_Fig9_HTML" id="MO9"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusion</title>
    <p id="Par39">By quantifying intronic reads and mining their characteristics, we designed the iREAD algorithm for genome-wide detection of novel intron retention events from RNA-seq data. We implemented it as a command line software using Python. It works with both single-end and paired-end sequencing data that has been prepared using poly-A enrichment protocols. We compared iREAD with the recently published method IRFinder using simulated RNA-seq data with known ground truth intron retention events, and found that it achieves consistently higher accuracies than IRFinder and that iREAD complements IRFinder in terms of their criteria in detecting IR events. We showed that using the integrated score of both methods is a good way in practice because it can improve the performance of retained intron detection. Based on the simulation study, directly analyzing intronic reads as used in iREAD achieved higher sensitivity than using the IRratio metric in IRFinder. We found that iREAD is also efficient when tested on real data with very high sequencing depth (over 130 million reads). The resulting intron retention data can be further explored in various ways such as differential expression and functional enrichment, allowing for its use in many fields including the search for disease-associated gene expression signatures. We also illustrated that IRs identified by iREAD are biologically meaningful. Being complementary to existing tools, iREAD provides a new and generic tool to interrogate the previously largely neglected intronic regions from the angle of view of intron retention.</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p id="Par40">
      <list list-type="bullet">
        <list-item>
          <p id="Par41">Project name: iREAD</p>
        </list-item>
        <list-item>
          <p id="Par42">Project home: <ext-link ext-link-type="uri" xlink:href="https://github.com/genemine/iread">https://github.com/genemine/iread</ext-link>.</p>
        </list-item>
        <list-item>
          <p id="Par43">Operating system(s): Linux, Mac</p>
        </list-item>
        <list-item>
          <p id="Par44">Programming language: Python, Perl</p>
        </list-item>
        <list-item>
          <p id="Par45">Other requirements: No</p>
        </list-item>
        <list-item>
          <p id="Par46">License: No.</p>
        </list-item>
        <list-item>
          <p id="Par47">Any restrictions to use by non-academics: No</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par4">Binary version of sequence alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>FPKM</term>
        <def>
          <p id="Par5">Fragments per kilobase of exon model per million mapped reads</p>
        </def>
      </def-item>
      <def-item>
        <term>IR</term>
        <def>
          <p id="Par6">Intron retention</p>
        </def>
      </def-item>
      <def-item>
        <term>NE-score</term>
        <def>
          <p id="Par7">Normalized entropy score</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-seq</term>
        <def>
          <p id="Par8">RNA sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Nicholas Lahens at Perelman School of Medicine at University of Pennsylvania for providing the BEER software and his useful discussion.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>HDL and NDP conceived the study. HDL conducted the experiments. HDL, CCF and NDP wrote the manuscript. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Natural Science Foundation of China (No. 61702556) (HDL), the NIA U01AG006786 (NDP) and the start-up funding (NO. 502041004) from Central South University (HDL).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source codes of iREAD and independent intron data are made freely available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/genemine/iread">https://github.com/genemine/iread</ext-link>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par48">Not applicable</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par49">Not applicable</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par50">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Braunschweig</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Widespread intron retention in mammals functionally tunes transcriptomes</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>1774</fpage>
        <lpage>1786</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.177790.114</pub-id>
        <pub-id pub-id-type="pmid">25258385</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bell</surname>
            <given-names>TJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cytoplasmic BKCa channel intron-containing mRNAs contribute to the intrinsic excitability of hippocampal neurons</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>1901</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0711796105</pub-id>
        <pub-id pub-id-type="pmid">18250327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckley Peter</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cytoplasmic intron sequence-retaining transcripts can be dendritically targeted via ID element Retrotransposons</article-title>
        <source>Neuron</source>
        <year>2011</year>
        <volume>69</volume>
        <fpage>877</fpage>
        <lpage>884</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2011.02.028</pub-id>
        <pub-id pub-id-type="pmid">21382548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The global landscape of intron retentions in lung adenocarcinoma</article-title>
        <source>BMC Med Genet</source>
        <year>2014</year>
        <volume>7</volume>
        <fpage>15</fpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dvinge</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>Widespread intron retention diversifies most cancer transcriptomes</article-title>
        <source>Genome Med</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-015-0168-9</pub-id>
        <pub-id pub-id-type="pmid">25606059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jung</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intron retention is a widespread mechanism of tumor-suppressor inactivation</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <fpage>1242</fpage>
        <lpage>1248</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3414</pub-id>
        <pub-id pub-id-type="pmid">26437032</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>JJ-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Orchestrated intron retention regulates normal granulocyte differentiation</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>154</volume>
        <fpage>583</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2013.06.052</pub-id>
        <pub-id pub-id-type="pmid">23911323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ni</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global intron retention mediated gene regulation during CD4+ T cell activation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>6817</fpage>
        <lpage>6829</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw591</pub-id>
        <pub-id pub-id-type="pmid">27369383</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Parra</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gee</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Mohandas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Conboy</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>A dynamic intron retention program enriched in RNA processing genes regulates gene expression during terminal erythropoiesis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>42</volume>
        <fpage>838</fpage>
        <lpage>851</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Furuya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kobayashi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Baba</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ito</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nakatani</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Splice-site mutation causing partial retention of intron in the FLCN gene in Birt-Hogg-Dubé syndrome: a case report</article-title>
        <source>BMC Med Genet</source>
        <year>2018</year>
        <volume>11</volume>
        <fpage>42</fpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Porse</surname>
            <given-names>BT</given-names>
          </name>
        </person-group>
        <article-title>The functional consequences of intron retention: alternative splicing coupled to NMD as a regulator of gene expression</article-title>
        <source>BioEssays</source>
        <year>2014</year>
        <volume>36</volume>
        <fpage>236</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.201300156</pub-id>
        <pub-id pub-id-type="pmid">24352796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boutz</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Bhutkar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sharp</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Detained introns are a novel, widespread class of post-transcriptionally spliced introns</article-title>
        <source>Genes Dev</source>
        <year>2015</year>
        <volume>29</volume>
        <fpage>63</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.247361.114</pub-id>
        <pub-id pub-id-type="pmid">25561496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>IRcall and IRclassifier: two methods for flexible detection of intron retention events from RNA-Seq data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>S9</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S2-S9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Conboy</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <source>Keep me around: intron retention detection and analysis</source>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Middleton</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IRFinder: assessing the impact of intron retention on mammalian gene expression</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>51</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1184-4</pub-id>
        <pub-id pub-id-type="pmid">28298237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>rMATS: robust and flexible detection of differential alternative splicing from replicate RNA-Seq data</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>E5593</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1419161111</pub-id>
        <pub-id pub-id-type="pmid">25480548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mats: a bayesian framework for flexible detection of differential alternative splicing from rna-seq data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e61</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1291</pub-id>
        <pub-id pub-id-type="pmid">22266656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katz</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Airoldi</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>Analysis and design of RNA sequencing experiments for identifying isoform regulation</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>1009</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1528</pub-id>
        <pub-id pub-id-type="pmid">21057496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neph</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BEDOPS: high-performance genomic feature operations</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1919</fpage>
        <lpage>1920</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts277</pub-id>
        <pub-id pub-id-type="pmid">22576172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grant</surname>
            <given-names>GR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative analysis of RNA-Seq alignment algorithms and the RNA-Seq unified mapper (RUM)</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2518</fpage>
        <lpage>2528</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr427</pub-id>
        <pub-id pub-id-type="pmid">21775302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knobloch</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The role of lipid metabolism for neural stem cell regulation</article-title>
        <source>Brain Plast</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>61</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.3233/BPL-160035</pub-id>
        <pub-id pub-id-type="pmid">29765860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meijer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell model for synaptic transmission and plasticity in human iPSC-Derived Neurons</article-title>
        <source>Cell Rep</source>
        <year>2019</year>
        <volume>27</volume>
        <fpage>2199</fpage>
        <lpage>2211.e2196</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.04.058</pub-id>
        <pub-id pub-id-type="pmid">31091456</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell alternative splicing analysis with Expedition reveals splicing dynamics during neuron differentiation</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>67</volume>
        <fpage>148</fpage>
        <lpage>161.e145</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.06.003</pub-id>
        <pub-id pub-id-type="pmid">28673540</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
