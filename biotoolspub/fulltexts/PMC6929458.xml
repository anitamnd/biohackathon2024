<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6929458</article-id>
    <article-id pub-id-type="publisher-id">6297</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-019-6297-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MS2CNN: predicting MS/MS spectrum based on protein sequence using deep convolutional neural networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Lin</surname>
          <given-names>Yang-Ming</given-names>
        </name>
        <address>
          <email>d112233445563@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Ching-Tai</given-names>
        </name>
        <address>
          <email>ctchen@iis.sinica.edu.tw</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6711-1739</contrib-id>
        <name>
          <surname>Chang</surname>
          <given-names>Jia-Ming</given-names>
        </name>
        <address>
          <email>chang.jiaming@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 6277</institution-id><institution-id institution-id-type="GRID">grid.412042.1</institution-id><institution>Department of Computer Science, </institution><institution>National Chengchi University, </institution></institution-wrap>11605 Taipei City, Taiwan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2287 1366</institution-id><institution-id institution-id-type="GRID">grid.28665.3f</institution-id><institution>Institute of Information Science, </institution><institution>Academia Sinica, </institution></institution-wrap>115 Taipei City, Taiwan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 9</issue>
    <elocation-id>906</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Tandem mass spectrometry allows biologists to identify and quantify protein samples in the form of digested peptide sequences. When performing peptide identification, spectral library search is more sensitive than traditional database search but is limited to peptides that have been previously identified. An accurate tandem mass spectrum prediction tool is thus crucial in expanding the peptide space and increasing the coverage of spectral library search.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose MS<sup>2</sup>CNN, a non-linear regression model based on deep convolutional neural networks, a deep learning algorithm. The features for our model are amino acid composition, predicted secondary structure, and physical-chemical features such as isoelectric point, aromaticity, helicity, hydrophobicity, and basicity. MS<sup>2</sup>CNN was trained with five-fold cross validation on a three-way data split on the large-scale human HCD MS<sup>2</sup> dataset of Orbitrap LC-MS/MS downloaded from the National Institute of Standards and Technology. It was then evaluated on a publicly available independent test dataset of human HeLa cell lysate from LC-MS experiments. On average, our model shows better cosine similarity and Pearson correlation coefficient (0.690 and 0.632) than MS<sup>2</sup>PIP (0.647 and 0.601) and is comparable with pDeep (0.692 and 0.642). Notably, for the more complex MS<sup>2</sup> spectra of 3+ peptides, MS<sup>2</sup>PIP is significantly better than both MS<sup>2</sup>PIP and pDeep.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We showed that MS<sup>2</sup>CNN outperforms MS<sup>2</sup>PIP for 2+ and 3+ peptides and pDeep for 3+ peptides. This implies that MS<sup>2</sup>CNN, the proposed convolutional neural network model, generates highly accurate MS<sup>2</sup> spectra for LC-MS/MS experiments using Orbitrap machines, which can be of great help in protein and peptide identifications. The results suggest that incorporating more data for deep learning model may improve performance.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Peptide</kwd>
      <kwd>Mass spectrum</kwd>
      <kwd>Tandem mass spectrometry</kwd>
      <kwd>Spectral library search</kwd>
      <kwd>Protein identification</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Deep convolutional neural networks</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Ministry of Science and Technology, Taiwan (TW)</institution>
        </funding-source>
        <award-id>106-2221-E-004-011-MY2</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chang</surname>
            <given-names>Jia-Ming</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <conference xlink:href="https://incob2019.org/">
      <conf-name>International Conference on Bioinformatics (InCoB 2019)</conf-name>
      <conf-acronym>InCoB 2019</conf-acronym>
      <conf-loc>Jakarta, Indonesia</conf-loc>
      <conf-date>10-12 September 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Tandem mass spectrometry (MS<sup>2</sup>) has emerged as an indispensable technology in high-throughput proteomics experiments [<xref ref-type="bibr" rid="CR1">1</xref>]. Tandem mass spectra generated from bottom-up proteomics consist of mass-to-charge ratios and relative abundances of a set of fragment ions generated from digested peptides. The patterns of these fragment ions are useful for the identification and quantification of proteomes in the sample.</p>
    <p id="Par12">There are two common approaches for protein identification: database search and spectral library search. The former searches each tandem mass spectrum (or MS<sup>2</sup> spectrum) acquired from experiments against theoretical spectrums generated from all possible digested peptides (with trypsin in most of the cases) in the human proteome using a scoring function. The latter searches a MS<sup>2</sup> spectrum against a spectral library, a collection of high-quality spectra of all identified peptides from previous experiments [<xref ref-type="bibr" rid="CR2">2</xref>]. Although database search is more comprehensive and covers all possible peptide space, the sensitivity is lower because of the absence of intensity for each fragment ion in theoretical spectra. In contrast, spectral library search provides considerably higher sensitivity since a spectral library consists of realistic fragment ion intensities [<xref ref-type="bibr" rid="CR3">3</xref>]. However, spectral library search is limited to peptides that have been previously identified, which hinders the application of spectral library search in areas where the discovery of novel peptides is of importance, such as the identification of peptides with mutations or peptides from isoforms of proteins. To take this into account, it is necessary to develop methods for computational prediction or simulation of MS<sup>2</sup> spectra from amino acid sequences to expand the size of a spectral library.</p>
    <p id="Par13">There are several different strategies in predicting the MS<sup>2</sup> spectrum of a peptide. MassAnalyzer, a pioneer work in computational prediction of a MS<sup>2</sup> spectrum, uses a kinetic model on the basis of the mobile proton hypothesis to simulate peptide fragmentation [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. A semi-empirical approach is to predict the MS<sup>2</sup> spectrum of a peptide from the spectra of similar peptides by peak perturbation [<xref ref-type="bibr" rid="CR6">6</xref>]. The approach is based on the observation that the peptides of similar sequences produce similar fragmentation patterns in most cases. The concept is then generalized to a weighted <italic>K</italic>-nearest neighbor (KNN) approach in which a machine learning model first selects peptides that are likely to have high spectra similarity to the target peptide, and then a consensus algorithm combines their spectra to predict the MS<sup>2</sup> spectrum of the target peptide [<xref ref-type="bibr" rid="CR7">7</xref>]. Though the two approaches can yield good prediction accuracy for target peptides with similar amino acid sequence neighbors, they are not designed to predict the MS<sup>2</sup> spectrum for arbitrary peptides of interest. For better predictive capability, other methods simplify the model by focusing on the prediction of <italic>y</italic>-ion intensities only [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. Although they achieve some success, the applicability of these methods is somewhat restricted.</p>
    <p id="Par14">PeptideART, a data-driven approach based on feed-forward neural networks, is trained with more than 40,000 peptide spectrum matches (PSMs) [<xref ref-type="bibr" rid="CR11">11</xref>]. In benchmark tests on five different data sets for MS<sup>2</sup> spectrum prediction, PeptideART compares favorably to MassAnalyzer. MS<sup>2</sup>PIP [<xref ref-type="bibr" rid="CR12">12</xref>], a later random forest approach, incorporates different predictive models for different peptide lengths (8 to 28 amino acids) and different charge states (charge 2+ and 3+). These models are trained with more than 73,000 PSMs; the overall performance is reported to be better than PeptideART. A web server version of MS<sup>2</sup>PIP has been constructed with a new computational model and a much larger training data set of more than 170,000 PSMs [<xref ref-type="bibr" rid="CR13">13</xref>]. More recently, a deep neural network-based method called pDeep has been developed [<xref ref-type="bibr" rid="CR14">14</xref>]. The method is based on a bidirectional long short-term memory (BiLSTM) model and is trained with a data set of around 4,000,000 MS<sup>2</sup> spectra. Notably, for the same peptide sequence, it predicts MS<sup>2</sup> spectra of three different fragmentation approaches: HCD (higher-energy collisional dissociation), ETD (electron-transfer dissociation), and EThcD (electron-transfer/higher-energy collision dissociation). According to the reported benchmark experiment, pDeep yields considerable improvements over MassAnalyzer and MS-Simulator.</p>
    <p id="Par15">In this study, we propose MS<sup>2</sup>CNN, a deep convolutional neural network (DCNN) method for MS<sup>2</sup> spectrum prediction given experimental spectra large enough to effectively train a sophisticated deep learning model. We adopt the network structure of LeNet-5 [<xref ref-type="bibr" rid="CR15">15</xref>], a DCNN consisting of three major components: a convolutional layer, a pooling layer, and a fully connected layer. A single DCNN is constructed to predict peptides of a specific length and charge. The entire training set was composed of high-quality human HCD MS<sup>2</sup> spectra from an Orbitrap LC-MS/MS experiment downloaded from the National Institute of Standards and Technology (NIST) consisting of 320,824 unique peptide sequences and 1,127,971 spectra. Five-fold cross validation was performed and the method was then benchmarked on a publicly available independent test dataset of human HeLa cell lysate from LC-MS/MS experiments with MS<sup>2</sup>PIP and pDeep. MS<sup>2</sup>CNN achieved a cosine similarity (COS) in the range of 0.57–0.79 and 0.59–0.74 for peptides of charge 2+ and charge 3+, respectively. These results suggest that MS<sup>2</sup>CNN significantly outperforms MS<sup>2</sup>PIP, especially for shorter peptide sequences for which abundant training data is available. It is also shown that MS<sup>2</sup>CNN has an overall comparable performance to pDeep; however the former predicts MS<sup>2</sup> spectra for charge 3+ peptides, which are usually considered more complicated than the spectra for 2+ peptides, at a higher accuracy.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Five-fold cross validation for determining convolutional layer</title>
      <p id="Par16">Because there are significantly more charge 2+ than charge 3+ peptide sequences, the best layer number of MS<sup>2</sup>CNN is determined by charge 2+, after which the value is directly applied to charge 3+. Given the one-fold run of the five-fold validation result, we chose the 4-layer model as the default structure of MS<sup>2</sup>CNN because it yielded the best performance and is the most efficient of all the models (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). Although the 5-layer model is comparable to the 4-layer model for some peptide lengths, we did not consider it as its performance fluctuates considerably for peptides of different lengths and it also requires longer training times.</p>
      <p id="Par17">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the five-fold cross validation performance evaluated with COS for different peptide lengths and charge states (other detailed metrics are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). The figure shows that the predictive capability decreases as the peptide length gets larger, possibly due to less training data for longer peptides. We further investigated whether there is a benefit to merging charge 2+ and 3+ training data to build up a single model as MS<sup>2</sup>CNN_mix instead of having the two MS<sup>2</sup>CNN 2+ and MS<sup>2</sup>CNN 3+ models for charge 2+ and charge 3+ peptides, respectively. We followed the previous training procedure with an additional input feature-engineered procedure based on the merged data set of charge 2+ or 3+ peptides. The performance in general falls between the performance of charge 2+ and charge 3+ (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, gray bar). This shows that although a larger data set boosts performance (improves MS<sup>2</sup>CNN 3+ performance), different charge states also contain specific patterns in terms of spectrum prediction (impairing MS<sup>2</sup>CNN 2+ performance).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Bar chart of MS<sup>2</sup>CNN COS on charge 2+ (blue), 3+ (orange), and mix (gray) models. Blue and orange dashed lines indicate the peptide number of charge 2+ and 3+ data sets, respectively</p></caption><graphic xlink:href="12864_2019_6297_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Upper bound analysis</title>
      <p id="Par18">Peptide fragmentation is a random process; for example, even the same peptide in the same experiment can sometimes result in different peak intensities in spectra. When combining different ionization sources, ion detection, experimental steps, and even different species, the spectrum of the same peptide can be significantly different. Therefore, we compare the similarity between the training spectra and independent spectra for the same peptide sequence (Table <xref rid="Tab1" ref-type="table">1</xref>). Ideally, the similarity in terms of COS or PCC should be 1 if the experimental conditions and the random processes for generating the two spectra are perfectly identical. In reality, the similarity can be seen as the Bayes rate, the theoretical prediction upper bound on prediction accuracy due to unexplainable variance. To conclude, the average upper bound COS for different peptide lengths ranges from 0.600 to 0.800 and decreases as peptide length increases. The average upper bound of PCC for different peptide lengths is even lower, ranging from 0.550 to 0.760. Peptide length seems to have a smaller effect on PCC than on COS, especially for peptides of charge 3 + .
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Average cosine similarity (COS) and Pearson correlation coefficient (PCC) of spectra from the same peptide in training and independent test sets with charge 2+ and charge 3+</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Length</th><th colspan="2">Charge 2+</th><th colspan="2">Charge 3+</th></tr><tr><th>COS</th><th>PCC</th><th>COS</th><th>PCC</th></tr></thead><tbody><tr><td>9</td><td>0.800</td><td>0.757</td><td>0.617</td><td>0.553</td></tr><tr><td>10</td><td>0.770</td><td>0.724</td><td>0.781</td><td>0.734</td></tr><tr><td>11</td><td>0.760</td><td>0.713</td><td>0.771</td><td>0.721</td></tr><tr><td>12</td><td>0.735</td><td>0.688</td><td>0.735</td><td>0.682</td></tr><tr><td>13</td><td>0.704</td><td>0.655</td><td>0.732</td><td>0.681</td></tr><tr><td>14</td><td>0.703</td><td>0.658</td><td>0.703</td><td>0.650</td></tr><tr><td>15</td><td>0.687</td><td>0.643</td><td>0.672</td><td>0.617</td></tr><tr><td>16</td><td>0.694</td><td>0.652</td><td>0.691</td><td>0.641</td></tr><tr><td>17</td><td>0.645</td><td>0.601</td><td>0.690</td><td>0.641</td></tr><tr><td>18</td><td>0.646</td><td>0.606</td><td>0.660</td><td>0.612</td></tr><tr><td>19</td><td>0.636</td><td>0.595</td><td>0.668</td><td>0.622</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Independent test set evaluation</title>
      <p id="Par19">We compared the proposed MS<sup>2</sup>CNN and MS<sup>2</sup>CNN_mix models with MS<sup>2</sup>PIP and pDeep based on the independent test set in terms of COS and PCC (Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, detailed values in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). In general, MS<sup>2</sup>CNN and MS<sup>2</sup>CNN_mix outperform MS<sup>2</sup>PIP for charge 2+ (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) and charge 3+ (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) peptides in both metrics significantly with a <italic>p</italic>-value &lt; 0.01 by a Wilcoxon signed-rank test (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: R Script). For charge 2+ peptides, MS<sup>2</sup>CNN outperforms pDeep marginally for peptide lengths no greater than 11, whereas for peptide lengths from 12 to 19, pDeep considerably outperforms the other methods for both COS and PCC (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In contrast, for charge 3+ peptides, MS<sup>2</sup>CNN and MS<sup>2</sup>CNN_mix yield higher COS and PCC than pDeep for all peptide lengths significantly with a <italic>p</italic>-value &lt; 0.01 by the Wilcoxon signed-rank test (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). This suggests that pDeep might be more sensitive to the size of training data, as the number of spectra for charge 3+ peptides is significantly smaller than that of the charge 2+ peptides. Note that pDeep was trained with HCD mouse spectra. Although they show a high MS/MS spectra similarity (a median PCC of 0.94) across different species, a minority of peptides which share low similarity across species can nevertheless deteriorate prediction performance.
<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> COS (cosine similarity) and <bold>b</bold> PCC (Pearson’s correlation coefficient) of MS<sup>2</sup>CNN 2+ (blue bar), MS<sup>2</sup>CNN_mix (blue bar with white dots), MS<sup>2</sup>PIP (white bar with blue dashes), and pDeep (black bar) on the charge 2+ peptides from the independent test set</p></caption><graphic xlink:href="12864_2019_6297_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p><bold>a</bold> COS and <bold>b</bold> PCC of MS<sup>2</sup>CNN 3+ (blue bar), MS<sup>2</sup>CNN_mix (blue bar with white dots), MS<sup>2</sup>PIP (white bar with blue dashes), and pDeep (black bar) on the charge 3+ peptides from the independent test set</p></caption><graphic xlink:href="12864_2019_6297_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par20">Note that the performance of charge 3+ peptides at lengths of 17, 18, and 19 are better than that of charge 2+ peptides for both COS and PCC. This may be due to the richer training data set and higher theoretical prediction upper bound in those ranges. The advantage of MS<sup>2</sup>CNN_mix can be seen in the prediction results of charge 3+ (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), for which the size of the training data set greatly increases. This benefit becomes insignificant for charge 2+ peptides, as the original training data set is much larger: the improvement is not affected by theoretical prediction upper bound. Taking charge 3+ peptide lengths of 11 and 12 as an example (Fig. <xref rid="Fig3" ref-type="fig">3</xref> b), there is more improvement in length 12 (MS<sup>2</sup>CNN_mix vs MS<sup>2</sup>PIP) but a higher upper bound in length 11 than length 12 (0.721 vs 0.682, Table <xref rid="Tab2" ref-type="table">2</xref> charge 3 + .PCC).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Features used to encode a peptide sequence and its fragment ion sequences</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Feature</th><th>Description</th><th>Package: function name</th></tr></thead><tbody><tr><td colspan="2">m/z</td><td>Pyteomics v3.4.2: calculate_mass</td></tr><tr><td> Original</td><td>m/z of the original sequence</td><td/></tr><tr><td> Fragment ion</td><td>m/z of the fragment ion sequence</td><td/></tr><tr><td>Isoelectric point</td><td>isoelectric point of the sequence</td><td>Biopython 1.7: isoelectric_point</td></tr><tr><td>Instability index</td><td>instability index of the sequence</td><td>Biopython 1.7: instability_index</td></tr><tr><td>Aromaticity</td><td>aromaticity of the sequence</td><td>Biopython 1.7: aromaticity</td></tr><tr><td>Secondary structure fraction</td><td>α-helix, β-strand and coil fraction of the sequence</td><td>Biopython 1.7: secondary_structure_fraction</td></tr><tr><td>Helicity</td><td>helicity of the sequence</td><td>In-house program</td></tr><tr><td>Hydrophobicity</td><td>hydrophobicity of the sequence</td><td>in-house program</td></tr><tr><td>Basicity</td><td>basicity of the sequence</td><td>in-house program</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Discussion and conclusion</title>
    <p id="Par21">Peptide identification is an important issue in mass spectrometry-based proteomics. There are two major approaches for peptide identification: database search and spectral library search. Spectral library search boasts a greater sensitivity than database search, but is limited to peptides that have been previously identified. Overcoming this limitation calls for an accurate MS<sup>2</sup> spectrum prediction tool that is capable of reproducing the chemical fragmentation pattern of a peptide sequence. Over the years, a large number of high quality MS<sup>2</sup> spectra have been generated and made publicly available by experimentalists, making for an excellent opportunity for researchers to effectively train modern machine learning models such as deep convolutional neural networks for MS<sup>2</sup> spectra prediction.</p>
    <p id="Par22">We devise DCNN, a deep learning model for the prediction of peak intensities of MS<sup>2</sup> spectra. In addition to DCNN, we incorporate different Python libraries for feature engineering to facilitate the training process. According to our independent test set of HCD spectra of human samples from Orbitrap LC-MS experiments, MS<sup>2</sup>CNN shows superior prediction performance compared to MS<sup>2</sup>PIP for charge 2+ and 3+ peptides in terms of COS. It also outperforms pDeep, another deep learning approach, for charge 3+ peptides. In the future, we plan to improve the predictive power of our model by either including more data for longer peptide sequences or employing another popular approach in deep learning such as transfer learning, in which a pretrained model is reused for another task, for example, we use a model trained on short peptides for a long peptide task. In the light of our results, we believe MS<sup>2</sup>CNN can be of great use in expanding the coverage of a spectral library and improving the identification accuracy of spectral library search in the analysis of proteomics samples.</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Feature engineering</title>
      <p id="Par23">To apply a deep learning method to our dataset, each peptide sequence must be converted into a feature vector with a label. Table <xref rid="Tab2" ref-type="table">2</xref> lists the features we use to characterize a peptide sequence. These features include peptide composition (similar to amino acid composition), mass-to-charge ratio (m/z), and peptide physical-chemical properties such as isoelectric point, instability index, aromaticity, secondary structure fraction, helicity, hydrophobicity, and basicity. The m/z and physical-chemical features of not only the peptide sequence but all the possible <italic>b</italic> and <italic>y</italic> fragment ions are also included in the feature vector. Take for example the peptide sequence AAAAAAAAGAFAGR (length = 14): its m/z is 577.80, the amino acid composition is {A: 10, C: 0, D: 0, E: 0, F: 1, G: 2, H: 0, I: 0, K: 0, L: 0, M: 0, N: 0, P: 0, Q: 0, R: 1, S: 0, T: 0, V: 0, W: 0, Y: 0}, and the physical-chemical properties {isoelectric point, instability index, aromaticity, helicity, hydrophobicity, basicity, secondary structure fraction} are {9.80, 3.22, 0.07, − 0.21, 1.21, 208.46, (0.071, 0.14, 0.71)}. In addition, the m/z and physical-chemical properties of all the 26 (=2*(14–1)) fragment ions are included in the feature vector. The total number of features for a peptide sequence is 290 (=1 + 20 + 9 + 26*1 + 26*9). We used <italic>Pyteomics</italic> v3.4.2 [<xref ref-type="bibr" rid="CR16">16</xref>] to compute the mass-to-charge ratio and <italic>Biopython</italic> v1.7 [<xref ref-type="bibr" rid="CR17">17</xref>] to calculate the amino acid composition, instability index, isoelectric point, and secondary structure fraction.</p>
    </sec>
    <sec id="Sec9">
      <title>MS<sup>2</sup>CNN model</title>
      <p id="Par24">We propose MS<sup>2</sup>CNN, a DCNN model that uses the aforementioned features (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The MS<sup>2</sup>CNN model takes a peptide feature vector as input and computes an ensemble of nonlinear function nodes in which each layer consists of a number of nodes. The predicted peak intensity corresponds to an output node of the MS<sup>2</sup>CNN model.
<fig id="Fig4"><label>Fig. 4</label><caption><p>MS<sup>2</sup>CNN model architecture</p></caption><graphic xlink:href="12864_2019_6297_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par25">In the proposed model, a convolution layer is activated by the <italic>relu</italic> activation function. A max-pooling layer is added after a convolution layer: together they constitute one convolution-pooling layer. The number of convolution-pooling layers is repeated <italic>n</italic> times in MS<sup>2</sup>CNN, where <italic>n</italic> ranges from 2 to 7. The best number was determined by a cross validation experiment. We unify the node number of the convolutional layers as 10; the node number for the last convolutional layer depends on the layer depth. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 lists the detailed configurations for convolutional layers from layers 2 to 7. The repeated convolution-pooling layers are followed by another layer to flatten the output. Then we add a fully connected layer with twice as many nodes as the number of output nodes. We implemented the MS<sup>2</sup>CNN architecture and executed the whole training process using the <italic>Keras</italic> Python package version 2.0.4 [<xref ref-type="bibr" rid="CR18">18</xref>]. Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates the MS<sup>2</sup>CNN model structure.</p>
    </sec>
    <sec id="Sec10">
      <title>Datasets</title>
      <sec id="Sec11">
        <title>Training data set</title>
        <p id="Par26">We downloaded the training set – a human HCD library based on an Orbitrap mass analyzer and LC-MS (Liquid chromatography–mass spectrometry) – from the NIST website. This set is based on CPTAC and ProteomeXchange, two public repositories containing 1,127,971 spectra from 320,824 unique peptide sequences in <italic>.msp</italic> format. The dataset consists of peptides with charge states ranging from 1+ to 9+, among which only charge states of 2+ and 3+ were selected as there was not enough data for the other charges to effectively train a machine learning model. This strategy is consistent with previous studies.</p>
      </sec>
      <sec id="Sec12">
        <title>De-duplicated spectrum</title>
        <p id="Par27">It is common for different spectra to belong to the same peptide sequence, and for charge states to have different peak intensities for their fragment ions. We performed a two-step process to generate a de-duplicated spectrum from a set of spectra for a given peptide. First, each peak in a spectrum was normalized by the maximum peak intensity of the spectrum. Then, the intensity of each <italic>b</italic>- and <italic>y</italic>-ion was determined by the median intensity of the ion across different spectra. This yielded a consensus spectrum which filters out noise that could degrade DCNN training. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 summarizes the number of spectra after deduplication. For effective training of a complex DCNN model, the number of peptides should exceed 5000 after deduplication. Based on this criterion, we focused on peptides of lengths 9 to 19 and eliminated the rest. This resulted in 166,371 charge 2+ peptides (70.4% of the 2+ peptides from NIST) and 98,364 charge 3+ peptides (69.6% of the 3+ peptides from NIST).</p>
      </sec>
      <sec id="Sec13">
        <title>Independent test set</title>
        <p id="Par28">We used the data-dependent acquisition data of Orbitrap LC-MS experiments from [<xref ref-type="bibr" rid="CR19">19</xref>] as an independent test set. This included 22,890 and 5998 spectra for charge 2+ and 3+ peptides, respectively. The proportion of common peptides in our training set and independent test set exceeded 90%. Although these peptides were viewed as easier prediction targets, the performance is still bounded by the theoretical upper bound; for example, the upper bound of COS for charge 2+ and charge 3+ peptides ranges from 0.636 to 0.800 and from 0.617 to 0.781, respectively (detailed numbers shown in Table <xref rid="Tab1" ref-type="table">1</xref>). The numbers of commonly observed peptides for different lengths are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Evaluation</title>
      <sec id="Sec15">
        <title><italic>K</italic>-fold cross validation</title>
        <p id="Par29">To select the best parameters (i.e., layer numbers) for the MS<sup>2</sup>CNN model and to prevent overfitting, we applied five-fold cross validation with a three-way data split, namely, the entire data set was partitioned into training, validation (10% of training data), and test sets. Training epochs continued as long as the accuracy of the validation set improved over the previous epoch by 0.001; otherwise, training was terminated. The final model was selected based on validation performance, and was used to predict the test set for performance evaluation. Since our model was selected based on validation set performance, there was no <italic>data leakage</italic> problem, in which information in the test data is involved in model selection. This problem can result in over-estimation of the performance and unfair comparison with other methods.</p>
      </sec>
      <sec id="Sec16">
        <title>Metrics</title>
        <p id="Par30">Two metrics are used: <italic>Cosine similarity</italic> (COS) and <italic>Pearson correlation coefficient</italic> (PCC). COS is one of the most widely used spectrum similarity measures for mass spectrometry. It measures the similarity between two non-zero vectors by calculating the angle between them (Eq. 1, calculated by the Python <italic>scikit-learn</italic> package [<xref ref-type="bibr" rid="CR20">20</xref>]). COS ranges from − 1 to + 1 (angle from 180° to 0°).
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathit{\cos}\left(X,Y\right)=\frac{X{Y}^T}{\left|\left|X\right|\right|\left|\left|Y\right|\right|}\cdots $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mo mathvariant="italic">cos</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>X</mml:mi><mml:msup><mml:mi>Y</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi></mml:mfenced></mml:mfenced><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:mi>Y</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>⋯</mml:mo></mml:math><graphic xlink:href="12864_2019_6297_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par31">The PCC measures the linear correlation between two variables <italic>X</italic> and <italic>Y</italic> (Eq. 2, calculated by the Python <italic>Scipy</italic> package [<xref ref-type="bibr" rid="CR21">21</xref>]). It ranges from 1 to − 1, where 1 denotes a completely positive correlation, − 1 a completely negative correlation, and 0 a random correlation or two variables that have no association.
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\rho}_{XY}=\frac{\mathit{\operatorname{cov}}\left(X,Y\right)}{\sigma_X\ {\sigma}_Y}\cdots $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mi>ρ</mml:mi><mml:mi mathvariant="italic">XY</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo mathvariant="italic">cov</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:msub><mml:mi>σ</mml:mi><mml:mi>Y</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋯</mml:mo></mml:math><graphic xlink:href="12864_2019_6297_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec17">
        <title>Evaluation methods</title>
        <sec id="FPar1">
          <title>MS<sup>2</sup>PIP</title>
          <p id="Par32">Recently, MS<sup>2</sup>PIP released a new prediction model using XGBoost [<xref ref-type="bibr" rid="CR22">22</xref>]; the previous random-forest model [<xref ref-type="bibr" rid="CR13">13</xref>] was not available. Thus, we used the latest MS<sup>2</sup>PIP model for benchmark comparison. The local standalone version (Python code downloaded from [<xref ref-type="bibr" rid="CR23">23</xref>]) was used instead of the online server as the latter is subject to a maximum number of 5000 peptides per query.</p>
          <p id="Par33">We used the default settings of MS<sup>2</sup>PIP according to the Github config file, other than changing <italic>frag_method</italic> from HCD to HCDch2. In addition, the MGF function was enabled to generate intensities without log<sub>2</sub> transformation. To ensure a fair comparison, we processed the test data using the same peak normalization procedure used to process our training data.</p>
        </sec>
        <sec id="FPar2">
          <title>pDeep</title>
          <p id="Par34">First, we converted a peptide to a 2D array using the pDeep API. Then, we loaded the pDeep model (.h5 format), which we used to predict the intensities of the peptide [<xref ref-type="bibr" rid="CR14">14</xref>]. Although the pDeep documentation states “If the precursor charge state is &lt;= 2, 2+ ions should be ignored”, to ensure a fair and complete charge 2+ peptide comparison, we set the intensity of the testing 2+ peak to zero as if it were missing in pDeep prediction. pDeep provided three trained models – BiLSTM, ProteomeTools-ETD, and ProteomeTools-EThcD – of which the BiLSTM model was used for comparison as it performed the best in both COS and PCC metrics (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6).</p>
        </sec>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2019_6297_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1:</bold> Excel file: Supplementary tables S1–S6 for additional results. </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2019_6297_MOESM2_ESM.r">
            <caption>
              <p><bold>Additional file 2:</bold> R Script: Wilcoxon signed-rank test for independent test set evaluation.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>COS</term>
        <def>
          <p id="Par4">Cosine similarity</p>
        </def>
      </def-item>
      <def-item>
        <term>DCNN</term>
        <def>
          <p id="Par5">Deep convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>KNN</term>
        <def>
          <p id="Par6"><italic>K</italic>-nearest neighbor</p>
        </def>
      </def-item>
      <def-item>
        <term>m/z</term>
        <def>
          <p id="Par7">mass-to-charge</p>
        </def>
      </def-item>
      <def-item>
        <term>MS</term>
        <def>
          <p id="Par8">Mass spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>MS<sup>2</sup></term>
        <def>
          <p id="Par9">Tandem mass spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>PCC</term>
        <def>
          <p id="Par10">Pearson correlation coefficient</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Yang-Ming Lin and Ching-Tai Chen contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-019-6297-6.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to acknowledge Dr. Ting-Yi Sung and Dr. Aaron Heidel for their assistance in polishing the manuscript.</p>
    <sec id="FPar3">
      <title>About this supplement</title>
      <p id="Par35">This article has been published as part of BMC Genomics, Volume 20 Supplement 9, 2019: 18th International Conference on Bioinformatics. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-9">https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-9</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>YML, CTC, and JMC conceived the study. CTC collected the data sets. YML implemented the method and conducted the experiments. All authors wrote the paper and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Publication of this supplement was funded by the Taiwan Ministry of Science and Technology [106–2221-E-004-011-MY2 to J.-M.C. and 108-2628-E-004-001-MY3 to Y.-M.L.] and “The Human Project from Mind, Brain and Learning” of NCCU from the Higher Education Sprout Project by the Ministry of Education in Taiwan. We are grateful to the National Center for High-performance Computing for computer time and facilities.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Our source code for the whole experiments, including preprocessing, feature engineering, and MS<sup>2</sup>CNN, is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/changlabtw/MS2CNN">https://github.com/changlabtw/MS2CNN</ext-link>.</p>
    <p>The materials generated and analyzed during the current study are available at</p>
    <p>○ Training data <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/52fcaade571a7d60241c">https://figshare.com/s/52fcaade571a7d60241c</ext-link>.</p>
    <p>○ Independent test data <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/91e99d2c9f7ce03f1210">https://figshare.com/s/91e99d2c9f7ce03f1210</ext-link>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par36">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par37">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par38">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry-based proteomics</article-title>
        <source>Nature.</source>
        <year>2003</year>
        <volume>422</volume>
        <issue>6928</issue>
        <fpage>198</fpage>
        <lpage>207</lpage>
        <pub-id pub-id-type="doi">10.1038/nature01511</pub-id>
        <pub-id pub-id-type="pmid">12634793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eddes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development and validation of a spectral library searching method for peptide identification from MS/MS</article-title>
        <source>PROTEOMICS.</source>
        <year>2007</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>655</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.200600625</pub-id>
        <pub-id pub-id-type="pmid">17295354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Understanding the improved sensitivity of spectral library searching over sequence database searching in proteomics data analysis</article-title>
        <source>Proteomics.</source>
        <year>2011</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>1075</fpage>
        <lpage>1085</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201000492</pub-id>
        <pub-id pub-id-type="pmid">21298786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Prediction of low-energy collision-induced dissociation spectra of peptides</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <issue>14</issue>
        <fpage>3908</fpage>
        <lpage>3922</lpage>
        <pub-id pub-id-type="doi">10.1021/ac049951b</pub-id>
        <pub-id pub-id-type="pmid">15253624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Prediction of low-energy collision-induced dissociation spectra of peptides with three or more charges</article-title>
        <source>Anal Chem</source>
        <year>2005</year>
        <volume>77</volume>
        <issue>19</issue>
        <fpage>6364</fpage>
        <lpage>6373</lpage>
        <pub-id pub-id-type="doi">10.1021/ac050857k</pub-id>
        <pub-id pub-id-type="pmid">16194101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A semi-empirical approach for predicting unobserved peptide MS/MS spectra from spectral libraries</article-title>
        <source>Proteomics.</source>
        <year>2011</year>
        <volume>11</volume>
        <issue>24</issue>
        <fpage>4702</fpage>
        <lpage>4711</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201100316</pub-id>
        <pub-id pub-id-type="pmid">22038894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Sokoloski</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Radivojac</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Extending the coverage of spectral libraries: a neighbor-based approach to predicting intensities of peptide fragmentation spectra</article-title>
        <source>Proteomics.</source>
        <year>2013</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>756</fpage>
        <lpage>765</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201100670</pub-id>
        <pub-id pub-id-type="pmid">23303707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bowler</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A machine learning approach to explore the spectra intensity pattern of peptides using tandem mass spectrometry data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>325</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-325</pub-id>
        <pub-id pub-id-type="pmid">18664292</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bu</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MS-simulator: predicting y-ion intensities for peptides with two charges based on the intensity ratio of neighboring ions</article-title>
        <source>J Proteome Res</source>
        <year>2012</year>
        <volume>11</volume>
        <issue>9</issue>
        <fpage>4509</fpage>
        <lpage>4516</lpage>
        <pub-id pub-id-type="doi">10.1021/pr300235v</pub-id>
        <pub-id pub-id-type="pmid">22794508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>OpenMS-simulator: an open-source software for theoretical tandem mass spectrum prediction</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>110</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0540-1</pub-id>
        <pub-id pub-id-type="pmid">25887925</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Radivojac</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>On the accuracy and limits of peptide fragmentation spectrum prediction</article-title>
        <source>Anal Chem</source>
        <year>2011</year>
        <volume>83</volume>
        <issue>3</issue>
        <fpage>790</fpage>
        <lpage>796</lpage>
        <pub-id pub-id-type="doi">10.1021/ac102272r</pub-id>
        <pub-id pub-id-type="pmid">21175207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degroeve</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>MS2PIP: a tool for MS/MS peak intensity prediction</article-title>
        <source>Bioinformatics.</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>24</issue>
        <fpage>3199</fpage>
        <lpage>3203</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt544</pub-id>
        <pub-id pub-id-type="pmid">24078703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degroeve</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Maddelein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>MS2PIP prediction server: compute and visualize MS2 peak intensity predictions for CID and HCD fragmentation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>W1</issue>
        <fpage>W326</fpage>
        <lpage>W330</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv542</pub-id>
        <pub-id pub-id-type="pmid">25990723</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>XX</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Chi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pDeep: Predicting MS/MS Spectra of Peptides with Deep Learning</article-title>
        <source>Anal Chem</source>
        <year>2017</year>
        <volume>89</volume>
        <issue>23</issue>
        <fpage>12690</fpage>
        <lpage>12697</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.7b02566</pub-id>
        <pub-id pub-id-type="pmid">29125736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lecun</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gradient-based learning applied to document recognition</article-title>
        <source>Proc IEEE</source>
        <year>1998</year>
        <volume>86</volume>
        <fpage>2278</fpage>
        <lpage>2324</lpage>
        <pub-id pub-id-type="doi">10.1109/5.726791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goloborodko</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Levitsky</surname>
            <given-names>LI</given-names>
          </name>
          <name>
            <surname>Ivanov</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Gorshkov</surname>
            <given-names>MV</given-names>
          </name>
        </person-group>
        <article-title>Pyteomics--a Python framework for exploratory data analysis and rapid software prototyping in proteomics</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>2013</year>
        <volume>24</volume>
        <issue>2</issue>
        <fpage>301</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-012-0516-6</pub-id>
        <pub-id pub-id-type="pmid">23292976</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cock</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Antao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Dalke</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>
        <source>Bioinformatics.</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>11</issue>
        <fpage>1422</fpage>
        <lpage>1423</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id>
        <pub-id pub-id-type="pmid">19304878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Chollet F. Keras. <ext-link ext-link-type="uri" xlink:href="https://github.com/fchollet/keras">https://github.com/fchollet/keras</ext-link> Date Accessed at 2017/09/01.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsou</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Teo</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <article-title>Untargeted, spectral library-free analysis of data-independent acquisition proteomics data generated using Orbitrap mass spectrometers</article-title>
        <source>Proteomics</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>15–16</issue>
        <fpage>2257</fpage>
        <lpage>2271</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201500526</pub-id>
        <pub-id pub-id-type="pmid">27246681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Walt</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The NumPy Array: a structure for efficient numerical computation</article-title>
        <source>Comput Sci Eng</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>22</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gabriels</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Degroeve</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Updated MS<sup>2</sup>PIP web server delivers fast and accurate MS<sup>2</sup> peak intensity prediction for multiple fragmentation methods, instruments and labeling techniques</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>W1</issue>
        <fpage>W295</fpage>
        <lpage>W299</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz299</pub-id>
        <pub-id pub-id-type="pmid">31028400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other"><ext-link ext-link-type="uri" xlink:href="https://github.com/sdgroeve/ms2pip_c">https://github.com/sdgroeve/ms2pip_c</ext-link> Date accessed at 2018/03/13.</mixed-citation>
    </ref>
  </ref-list>
</back>
