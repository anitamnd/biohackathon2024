<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6717970</article-id>
    <article-id pub-id-type="publisher-id">1787</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1787-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MPRAnalyze: statistical framework for massively parallel reporter assays</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1939-0865</contrib-id>
        <name>
          <surname>Ashuach</surname>
          <given-names>Tal</given-names>
        </name>
        <address>
          <email>tal_ashuach@berkeley.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Fischer</surname>
          <given-names>David S.</given-names>
        </name>
        <address>
          <email>david.fischer@helmholtz-muenchen.de</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kreimer</surname>
          <given-names>Anat</given-names>
        </name>
        <address>
          <email>anat.kreimer@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ahituv</surname>
          <given-names>Nadav</given-names>
        </name>
        <address>
          <email>nadav.ahituv@ucsf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Theis</surname>
          <given-names>Fabian J.</given-names>
        </name>
        <address>
          <email>fabian.theis@helmholtz-muenchen.de</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yosef</surname>
          <given-names>Nir</given-names>
        </name>
        <address>
          <email>niryosef@berkeley.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 7878</institution-id><institution-id institution-id-type="GRID">grid.47840.3f</institution-id><institution>Department of Electrical Engineering and Computer Sciences, University of California Berkeley, </institution></institution-wrap>Berkeley, California USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 7878</institution-id><institution-id institution-id-type="GRID">grid.47840.3f</institution-id><institution>Center for Computational Biology, University of California Berkeley, </institution></institution-wrap>Berkeley, California USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0483 2525</institution-id><institution-id institution-id-type="GRID">grid.4567.0</institution-id><institution>Institute of Computational Biology, Helmholz Zentrum München, </institution></institution-wrap>Neuherberg, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000000123222966</institution-id><institution-id institution-id-type="GRID">grid.6936.a</institution-id><institution>TUM School of Life Sciences Weihenstephan, Technical University of Munich, </institution></institution-wrap>Freising, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution>Department of Bioengineering and Therapeutic Sciences, University of California San Francisco, </institution></institution-wrap>San Francisco, California USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution>Institute for Human Genetics, University of California San Francisco, </institution></institution-wrap>San Francisco, California USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0489 3491</institution-id><institution-id institution-id-type="GRID">grid.461656.6</institution-id><institution>Ragon Institute of MGH, MIT, and Harvard, </institution></institution-wrap>Cambridge, MA USA </aff>
      <aff id="Aff8"><label>8</label>Chan Zuckerberg BioHub, San Francisco, California USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>183</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>Massively parallel reporter assays (MPRAs) can measure the regulatory function of thousands of DNA sequences in a single experiment. Despite growing popularity, MPRA studies are limited by a lack of a unified framework for analyzing the resulting data. Here we present MPRAnalyze: a statistical framework for analyzing MPRA count data. Our model leverages the unique structure of MPRA data to quantify the function of regulatory sequences, compare sequences’ activity across different conditions, and provide necessary flexibility in an evolving field. We demonstrate the accuracy and applicability of MPRAnalyze on simulated and published data and compare it with existing methods.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-019-1787-z) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01HG007910</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Understanding the function of the non-coding genome poses one of the most significant and outstanding challenges following the completion of the human genome project [<xref ref-type="bibr" rid="CR1">1</xref>]. One critical function that is primarily associated with non-coding regions is to regulate the transcription of nearby genes by interaction with transcription factors and other proteins and through recruitment of the RNA polymerase complex [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. Two of the main classes of regulatory regions consist of promoters (which are proximal to the transcription start site of the respective gene) and enhancers (distal elements), both demonstrated to harbor many disease-related mutations [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. The delineation of these critical regions on a genome-wide scale has traditionally relied on chromatin-associated features that are indicative of regulatory activity, such as acetylation or methylation of certain residues along histone tails [<xref ref-type="bibr" rid="CR1">1</xref>]. However, this approach does not provide direct evidence for regulatory activity, nor the dependence of this putative activity on the cellular context or on the presence of mutations.</p>
    <p>Recent advances in reporter assays address this issue in a set of procedures dubbed massively parallel reporter assays (MPRAs) [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. In these assays, a synthetic DNA construct that contains a minimal transcriptional unit is introduced into cells. Each such construct is generally composed of a candidate regulatory sequence of interest, a minimal promoter, and a unique DNA “barcode” that can be transcribed. The candidate sequences are assumed to be capable of regulating the transcription of the barcode sequence similarly to how a native sequence may regulate the transcription of its target gene. The cells then undergo RNA and DNA sequencing to measure both RNA transcript counts and DNA construct counts, and the RNA-to-DNA ratio is used to estimate the transcription rate of every barcode. Relying on sequence-based reporters leverages the vast combinatorial space of unique sequences (instead of a limited set of fluorescent reporters [<xref ref-type="bibr" rid="CR8">8</xref>]), and utilizes next-generation sequencing to measure the activity of thousands of putative regulatory sequences in a single experiment. To ensure robustness, each candidate regulatory sequence is usually associated with several barcodes (&lt;10 to over 100, depending on the study).</p>
    <p>MPRAs can be used to address several important questions. In classification studies, MPRAs are used to identify which putative regulatory regions are indeed inducing transcription (albeit in a synthetic context) [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. In allelic comparison studies, MPRAs are used to quantify the effect that variations to the sequence of regulatory regions may have on their ability to regulate transcription. This approach is primarily utilized for studying the effect of genetic polymorphisms that are observed in humans [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>], but also to explore more basic science questions such as the effect of perturbing the sequence content, spacing, or number of transcription factor binding sites [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. In comparative studies, MPRAs are used to quantify the dependence between the regulatory activity of each sequence and the cellular context, comparing tissues [<xref ref-type="bibr" rid="CR16">16</xref>], cell lines [<xref ref-type="bibr" rid="CR11">11</xref>], or other conditions of interest [<xref ref-type="bibr" rid="CR17">17</xref>]. A combination of two or more study types is also possible through more complex experimental designs, for example measuring the interaction between alleles and conditions [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p>Despite growing popularity of MPRAs, most studies to date rely on analysis approaches that either discount the inherent noise in the data (e.g., taking an average ratio across all barcodes) or designed for other data modalities (such as DESeq2 [<xref ref-type="bibr" rid="CR18">18</xref>], typically used for RNA-seq data, whose underlying assumptions may not hold true for MPRA). Other MPRA analysis methods only address some of the types of questions MPRAs can address, such as QuASAR-MPRA [<xref ref-type="bibr" rid="CR19">19</xref>] and mpralm [<xref ref-type="bibr" rid="CR20">20</xref>] that only perform comparative analyses, and rely on ratio-based summary statistics that limits the statistical power provided in these experiments. To address this, we have developed MPRAnalyze—a statistical framework that leverages information from multiple barcodes to ensure robust analysis of MPRA data. In the following, we demonstrate the use of MPRAnalyze for the three primary analysis tasks listed above, and compare its performance to the existing approaches using a collection of published datasets. MPRAnalyze is available as an R package through Bioconductor [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p>MPRA data is produced from two parallel procedures: RNA-sequencing is used to measure the number of transcripts produced from each barcode, and DNA-sequencing is used to measure the number of construct copies of each barcode. Thus for each barcode the ratio of RNA to DNA can serve as a conceptual proxy for the transcription rate [<xref ref-type="bibr" rid="CR7">7</xref>]. However, both DNA and RNA measurement procedures provide an approximate and noisy estimation, an issue exacerbated by the unstable nature of a ratio: minor differences in the counts themselves can result in major shifts in the ratio, especially when dealing with small numbers. This problem can be handled by associating multiple barcodes with each sequence, providing multiple replicates within a single experiment and a single sequencing library. This approach introduces an additional problem of summarizing counts from multiple barcodes to get a single transcription rate estimate for a candidate regulatory sequence, which is made difficult since the efficiency of incorporation inside cells, while theoretically uniform across the different constructs, has a significant degree of variability in practice (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Two commonly used techniques of addressing this issue are based on summary statistics: the aggregated ratio, which is the ratio of the sum of RNA counts across barcodes divided by the sum of DNA counts across barcodes <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\frac {\frac {1}{n}\sum _{i}^{n} RNA_{i}}{\frac {1}{m}\sum _{j}^{m} DNA_{j}}\right)$\end{document}</tex-math><mml:math id="M2"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">RN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">DN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq1.gif"/></alternatives></inline-formula>; and the mean ratio, which is the mean of the observed RNA/DNA ratios across barcodes <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\frac {1}{n}\sum _{i}^{n}\frac {DNA_{i}}{RNA_{i}}\right)$\end{document}</tex-math><mml:math id="M4"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">DN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq2.gif"/></alternatives></inline-formula>. Although intuitive, both summary statistics have inherent limitations. The aggregated ratio loses the statistical power that multiple barcodes provide and is often dominated by a minority of barcodes with high counts, and the mean ratio is highly sensitive to noise, as recently demonstrated in a paper by Myint and colleagues [<xref ref-type="bibr" rid="CR20">20</xref>]. A method to leverage the multiplicity of barcodes in a robust manner is therefore needed to fully fulfill the potential of these assays.
<fig id="Fig1"><label>Fig. 1</label><caption><p>MPRAnalyze model properties and fit. <bold>a</bold> Distribution of construct abundances (DNA barcodes) across datasets, computed as the observed barcode count + 1 for visualization purposes. <bold>b</bold> A graphical representation of the MPRAnalyze model. External covariates (e.g., conditions of interest, batch effects, barcode effects) are design-dependent. Latent construct and transcript counts are related by the transcription rate <italic>α</italic>. <bold>c</bold> Goodness of fit plots for both DNA and RNA libraries across datasets. Expected counts were extracted from the fitted GLMs. MPRAnalyze’s model fits MPRA data well, with <italic>R</italic><sup>2</sup>&gt;0.86 across all datasets. Since the Kwasnieski data only has one replicate in the DNA library, the DNA model is able to reach a perfect fit, in which case the DNA estimates used in the RNA model are identical to the original DNA counts</p></caption><graphic xlink:href="13059_2019_1787_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>MPRAnalyze model</title>
      <p>We introduce MPRAnalyze, a method for the analysis of MPRA data that uses a graphical model to relate the DNA and RNA counts, account for the uncertainty in both libraries and leverage the unique structure and opportunities presented by MPRA data. Out model relies on the assumption of a linear relationship between the RNA counts and the corresponding DNA counts: <italic>R</italic><italic>N</italic><italic>A</italic>=<italic>D</italic><italic>N</italic><italic>A</italic>×<italic>α</italic>, similar to ratio-based approaches, with <italic>α</italic> denoting the transcription rate. Our framework comprises two nested models: the DNA model, which estimates the latent construct counts for the observed DNA counts, and the RNA model, which uses the construct count estimates from the DNA model and the observed RNA counts to estimates the rate of transcription, <italic>α</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b).</p>
      <p>For each candidate regulatory sequence, the model requires two vectors of observations: DNA counts <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {d}$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq3.gif"/></alternatives></inline-formula> and RNA counts <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {r}$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq4.gif"/></alternatives></inline-formula>, where each observation is the number of times a specific barcode, associated with this sequence, was observed at the DNA and RNA levels respectively. Additionally, we denote <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {\hat {d}}$\end{document}</tex-math><mml:math id="M10"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq5.gif"/></alternatives></inline-formula> the vector of latent construct counts (DNA) and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {\hat {r}}$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq6.gif"/></alternatives></inline-formula> the vector of latent transcript counts (RNA). We assume that the latent construct counts, from which the observed DNA counts are sampled, are generated by a gamma distribution. Second, we assume that the conditional distribution of the RNA counts follows a Poisson distribution. Formally: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \vec{\hat{d}}\sim Gamma\left(k,b\right)  $$ \end{document}</tex-math><mml:math id="M14"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">Gamma</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1787_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ2">
          <label>2</label>
          <alternatives>
            <tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \vec{\hat{r}}|\vec{\hat{d}}\sim Poisson\left(\alpha\vec{\hat{d}}\right)  $$ \end{document}</tex-math>
            <mml:math id="M16">
              <mml:mover accent="true">
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mo>→</mml:mo>
              </mml:mover>
              <mml:mo>|</mml:mo>
              <mml:mover accent="true">
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mo>→</mml:mo>
              </mml:mover>
              <mml:mo>∼</mml:mo>
              <mml:mtext mathvariant="italic">Poisson</mml:mtext>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>α</mml:mi>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1787_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>These result in a closed-form negative binomial likelihood for the RNA counts: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \vec{\hat{r}}\sim NB\left(\mu=\frac{\alpha\cdot k}{\beta},\ \psi=k\right)  $$ \end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">NB</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1787_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The negative binomial distribution is a common approximation of sequencing data due to the observed over-dispersion [<xref ref-type="bibr" rid="CR22">22</xref>], and indeed all datasets we examined have a quadratic relationship between the mean and the variance, which can be captured by a negative binomial. This relationship is also observed for the DNA libraries, which is expected of Gamma-distributed data if the distribution’s shape parameter <italic>k</italic>≈1 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1, S3; “<xref rid="Sec16" ref-type="sec">Methods</xref>”).</p>
      <p>Now, assume we have two conditions. In this case, each barcode is measured twice (once in each condition), and the model needs to relate these observations and account for potential differences between them. MPRAnalyze achieves this by assuming that the effects are log-additive, and replacing the simple components of the DNA estimate (<inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {\hat {d}}$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq7.gif"/></alternatives></inline-formula>) and the transcription rate estimate (<italic>α</italic>) with generalized linear models (GLM) that enable easy encoding of various relationships between experimental factors. The model then becomes: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \log\left(\vec{d}\right) = X_{D}\vec{\beta} + \log\left(\vec{S_{D}}\right)  $$ \end{document}</tex-math><mml:math id="M22"><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1787_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ5">
          <label>5</label>
          <alternatives>
            <tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\log\left(\vec{r}\right) = X_{D}\vec{\beta} + X_{R}\vec{\gamma} + \log\left(\vec{S_{R}}\right)  $$ \end{document}</tex-math>
            <mml:math id="M24">
              <mml:mo>log</mml:mo>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>X</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mover accent="true">
                <mml:mrow>
                  <mml:mi>β</mml:mi>
                </mml:mrow>
                <mml:mo>→</mml:mo>
              </mml:mover>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>X</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>R</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mover accent="true">
                <mml:mrow>
                  <mml:mi>γ</mml:mi>
                </mml:mrow>
                <mml:mo>→</mml:mo>
              </mml:mover>
              <mml:mo>+</mml:mo>
              <mml:mo>log</mml:mo>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1787_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>Here, <italic>S</italic><sub><italic>D</italic></sub>,<italic>S</italic><sub><italic>R</italic></sub> are external correction factors, used to account for various technical effects such as library size in the DNA and RNA data respectively. <italic>X</italic><sub><italic>D</italic></sub>,<italic>X</italic><sub><italic>R</italic></sub> are design matrices for the DNA and RNA models, which encode the experimental setup of the assay. For instance, in a two condition settings, each matrix will include a column with a 0/1 indicator corresponding to the first or second condition respectively. The respective coefficients <italic>β</italic> and <italic>γ</italic> will then capture the effect associated with the choice of condition. Notably, the DNA design matrix <italic>X</italic><sub><italic>D</italic></sub> will also usually encode the identity of the barcode, so as to enable per-barcode estimation of construct abundance. This is not necessary for the RNA design matrix <italic>X</italic><sub><italic>R</italic></sub> since we assume that the barcodes are replicates that should have a single estimate of the transcription rate. An illustrative example is provided in Figure S2 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>) and a formal description of the model is provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
      <p>The model can be further extended to encode multiple covariates, both quantitative and qualitative, and thus support the common structure of MPRA experiments, namely multiple barcodes per sequence, multiple replicates or batches, and multiple conditions analyzed simultaneously. An important aspect of this flexibility is that it supports “un-paired” datasets in which the DNA sequencing was performed on the pool of constructs, prior to incorporation into cells [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. In these cases, there might not be separate DNA estimates for each condition being tested, in which case the conditions of interest would only be modelled in the RNA design matrix and excluded from the DNA model.</p>
      <p>In summary, MPRAnalyze utilizes a model that accounts for barcode specific effects and leverages them for increased statistical power and robustness of estimation. Since a standard for MPRA experimental design has yet to be formed, the nested GLM construction provides flexibility and is easily adjustable to changing experimental designs. Our model is also highly interpretable, allowing for quantitative estimates of sequence activity to be easily extracted, as well as differential activity to be tested directly using established statistical tests. This framework can explicitly leverage negative controls (sequences with no expected regulatory function) when available, either to establish the null distribution in classification analyses or to correct for systemic bias in comparative analyses (“<xref rid="Sec16" ref-type="sec">Methods</xref>”).</p>
    </sec>
    <sec id="Sec4">
      <title>Benchmark datasets</title>
      <p>In the following sections, we investigate the performance of MPRAnalyze in quantifying the transcriptional activity of candidate regions, as well as in the three major analysis tasks, namely—classification, cross-condition analysis, and allelic comparisons. Finally, we evaluate MPRAnalyze in a complex setup where we investigate both multiple conditions and multiple alleles. We compare MPRAnalyze to the current set of tools and analysis methodologies, using simulated data and a collection of public data sets. These datasets were chosen for representing a diversity of MPRA protocols (e.g., episomal or lentiviral integration, DNA sequencing pre- or post-transduction), study focus (classification, comparative analyses, allelic comparisons), and experimental design (number of barcodes per sequence, number of replicates). A summary of the data sets and their properties is provided in Table <xref rid="Tab1" ref-type="table">1</xref>. Applying MPRAnalyze to these data, we found that the model is able to provide a good fit (<italic>R</italic><sup>2</sup>&gt;0.86 for all datasets, Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), which is consistent with our distributional assumptions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>MPRA datasets used for evaluation of MPRAnalyze throughout the paper</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Type of analysis</th><th align="left">Integration</th><th align="left">DNA sequencing</th><th align="left">#Sequences</th><th align="left">#Negative controls</th><th align="left">#Barcodes</th><th align="left">#Replicates (DNA,RNA)</th></tr></thead><tbody><tr><td align="left">Kwasnieski [<xref ref-type="bibr" rid="CR10">10</xref>]</td><td align="left">Quantification</td><td align="left">Episomal</td><td align="left">Pre-transduction</td><td align="left">1200</td><td align="left">568</td><td align="left">4</td><td align="justify">1,4</td></tr><tr><td align="left">Inoue-Kircher (epi) [<xref ref-type="bibr" rid="CR9">9</xref>]</td><td align="left">Quantification</td><td align="left">Episomal</td><td align="left">Post-transduction</td><td align="left">2338</td><td align="left">102</td><td align="left">100</td><td align="justify">3,3</td></tr><tr><td align="left">Inoue-Kircher (chr) [<xref ref-type="bibr" rid="CR9">9</xref>]</td><td align="left">Quantification</td><td align="left">Lentiviral</td><td align="left">Post-transduction</td><td align="left">2338</td><td align="left">102</td><td align="left">100</td><td align="justify">3,3</td></tr><tr><td align="left">Inoue-Kreimer [<xref ref-type="bibr" rid="CR17">17</xref>]</td><td align="left">Comparative</td><td align="left">Lentiviral</td><td align="left">Post-transduction</td><td align="left">2464</td><td align="left">200</td><td align="left">90</td><td align="justify">3,3</td></tr><tr><td align="left">Mattioli [<xref ref-type="bibr" rid="CR13">13</xref>]</td><td align="left">Allelic Comparison</td><td align="left">Episomal</td><td align="left">Pre-transduction</td><td align="left">3960</td><td align="left">0</td><td align="left">26/80</td><td align="justify">1, 4/8</td></tr></tbody></table><table-wrap-foot><p>In the Mattioli data, multiple values indicate an asymmetric design: reference alleles were associated with 80 barcodes compared with 26 barcodes for alternative alleles, and 4 replicates were available for K562 cells compared with 8 in HepG2. For further details on each datasets, see “<xref rid="Sec16" ref-type="sec">Methods</xref>”</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Quantification</title>
      <p>We set out to examine the properties of the estimate of transcription rate generated by MPRAnalyze, denoted <italic>α</italic> (alpha), and compare it to the ratio-based summary statistics (i.e., mean of RNA-to-DNA ratios across all barcodes, or alternatively, the ratio of means [henceforth referred to as the <italic>aggregate ratio</italic>]).</p>
      <p>Reassuringly, the three estimates are largely in agreement (Pearson’s <italic>r</italic>&gt;0.9 across datasets, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). To further examine the accuracy of the estimates, we used the negative control sequences included in some of the datasets. These are assumed to have an identical transcription rate induced by the minimal promoter included in each construct with no sequence-induced activity. We examined the variance of the estimates on these sets. In the Kwasnieski dataset, the limited number of barcodes (<italic>n</italic>=4) is mitigated by high counts per barcode (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), leading to all estimates having similarly low variance. In the barcode-rich datasets (<italic>n</italic>≥90), the mean ratio is expectedly [<xref ref-type="bibr" rid="CR20">20</xref>] the most variable, with <italic>α</italic> being the most consistent in the Inoue-Kircher datasets and comparably consistent to the aggregated ratio in the Inoue-Kreimer dataset (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). These results suggest that MPRAnalyze is estimating similar transcription rates across the negative controls, as expected from this collection.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of MPRAnalyze’s <italic>α</italic> estimate of transcription rate with the ratio-based estimates <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\text {agg.ratio:} \frac {\frac {1}{n}\sum _{i}^{n} RNA_{i}}{\frac {1}{m}\sum _{j}^{m} DNA_{j}}; \text {mean.ratio:} \frac {1}{n}\sum _{i}^{n}\frac {DNA_{i}}{RNA_{i}}\right)$\end{document}</tex-math><mml:math id="M26"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>agg.ratio:</mml:mtext><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">RN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">DN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:mtext>mean.ratio:</mml:mtext><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">DN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RN</mml:mtext><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq8.gif"/></alternatives></inline-formula><bold>a</bold> The variance measured among estimates of negative-control sequences in each dataset (these are assumed to have an identical transcription rate). <bold>b–d</bold> Barcodes were sampled and quantification was recomputed based on the partial data to measure the effect of barcode number on estimate performance [See “Methods” for further subsampling details]. Analyses were performed using the full-data estimate as the ground truth. <bold>e–g</bold> MPRA data was simulated to provide an actual ground truth. In each case we measured the bias (<italic>e</italic><italic>s</italic><italic>t</italic><italic>i</italic><italic>m</italic><italic>a</italic><italic>t</italic><italic>e</italic>−<italic>t</italic><italic>r</italic><italic>u</italic><italic>t</italic><italic>h</italic>) (<bold>b,e</bold>); the standard deviation <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\sqrt {Var\left (estimate-truth\right)}\right)$\end{document}</tex-math><mml:math id="M28"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msqrt><mml:mrow><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext mathvariant="italic">estimate</mml:mtext><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">truth</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq9.gif"/></alternatives></inline-formula> (<bold>c,f</bold>); and the Spearman correlation between the estimates and the ground truth (<bold>d,g</bold>)</p></caption><graphic xlink:href="13059_2019_1787_Fig2_HTML" id="MO2"/></fig></p>
      <p>We then explored the effect of the number of barcodes on the estimates’ performance. Using the barcode-rich datasets, barcodes were sampled at various rates and estimates were recomputed for each sequence (3 independent samples per sequence per barcode rate). Using the full-data estimates as the ground truth, we found that down-sampling barcodes does not result in a systemic bias in any of the estimates (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), and all estimates showed reduced variance with increased barcodes, with the mean ratio under-performing the other two estimates, and <italic>α</italic> having a similar or lower variance than the aggregated ratio (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c).</p>
      <p>In many cases, the goal of quantifying sequence activity is to rank and compare different sequences, as in mutagenesis experiments. To compare the stability of the ordering of sequences, the Spearman correlation was computed between the estimates in each sub-sample to the estimates of the full data. Alpha has either similar or higher correlation than both ratio-based estimates across datasets and barcode abundance (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d).</p>
      <p>Since these analyses are limited by a lack of ground truth, MPRA data was then simulated by generating random coefficients and using the same nested GLM construction as described above to generate samples. To avoid biasing the results, samples were generated with a log-normal noise model instead of the default Gamma-Poisson convolutional model MPRAnalyze uses (“Methods”). We generated 281 sequences with gradually increasing transcription rates spanning a range of possible values (from 0.2 to 3, in 0.01 steps), with three replicates in each simulation. The analyses above were repeated with the simulated data. We found that while the measured bias was indeed not influenced by the number of barcodes, the mean ratio is substantially more biased than both <italic>α</italic> and the aggregated ratio (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). Similar to the real data results, we found <italic>α</italic> has lower variance than both ratio-based estimates, and higher correlation with the true transcription rates (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f, g). We also simulated data with varying number of replicates and found that increasing the number of replicates has a similar effect to increasing the number of barcodes, since both parameters increase the effective sample size. With any given number of barcodes, increasing the number of replicates improved performance—the degree of improvement decreased when more barcodes were available (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5).</p>
      <p>Overall, we found that <italic>α</italic> performs similarly or better than both ratio-based estimators in terms of accuracy, consistency, and robustness to missing data.</p>
    </sec>
    <sec id="Sec6">
      <title>Classification</title>
      <p>A common use case for MPRA is classification of active sequences, which induce transcriptional activity. This is commonly done by comparing the ratio-based estimates of the assayed sequences to a control set of sequences [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], an approach that suffers from the summary statistics’ sensitivity to noise and missing data, demonstrated above, which in the context of classification leads to decreased power and accuracy. Other studies performed this analysis using DESeq2 [<xref ref-type="bibr" rid="CR18">18</xref>], a differential expression analysis (DEA) method, by treating the DNA and RNA libraries as two conditions and looking for significant differences between the two [<xref ref-type="bibr" rid="CR11">11</xref>]. In the following we demonstrate that overall DEA methods either lack power or are not well calibrated for MPRA data. More importantly, these methods rely on an implicit assumption that the majority of features do not display differential behavior, a valid assumption for RNA-seq that does not hold for MPRA, in which the assayed sequences are often explicitly selected for their potential activity. This assumption makes the results of DEA methods highly dependent on experimental design and sequence selection.</p>
      <p>MPRAnalyze performs classification of active sequences by comparing the respective <italic>α</italic> estimates against the null distribution of transcription rate induced solely by the minimal promoter. The null is based on negative control sequences when available, and otherwise, MPRAnalyze relies on a conservative assumption that the mode of the distribution of the <italic>α</italic> values is the mode of the null distribution and that values lower than the mode are broadly generated by the null. These values are therefore used to estimate the mean and variance of the null distribution.</p>
      <p>In both scenarios, the <italic>α</italic> value of each candidate sequence is compared against the null distribution using the median absolute deviation (MAD)—a variant of the <italic>Z</italic>-score that is less sensitive to outliers. MPRAnalyze supports either a one-sided or two-sided test, allowing for identification of inducing sequences (inducing transcription beyond the minimal promoter levels) or repressive sequences (repressing transcription to below the promoter levels). A one-sided test was used to generate all results presented in this paper.</p>
      <sec id="Sec7">
        <title>Comparing mPRAnalyze with existing methods</title>
        <p>To assess the performance of MPRAnalyze in classification analyses, we compared six methods: MPRAnalyze with and without negative controls; empirical <italic>p</italic>values computed using the two ratio-based estimates, and DESeq2 in either full mode (each barcode as a separate sample) or collapsed mode (each replicate as a sample, taking the sum across barcodes within each replicate; see “<xref rid="Sec16" ref-type="sec">Methods</xref>”). Similarly to MPRAnalyze, DESeq2 was applied using an asymmetric mode, namely focusing on inducing sequences that have a higher signal in the RNA library than in the DNA library.</p>
        <p>We examined the fraction of sequences that were significantly active (FDR &lt;0.05) in each dataset, stratified by group: negative controls, candidate sequences, and positive controls when available (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). As expected, empirical <italic>p</italic> values from the ratio-based estimates show a clear lack of power. Both DESeq2-collapsed and MPRAnalyze without controls have inflated rates of false positives in the Kwasnieski datasets (compared with the theoretically expected 5% false discovery rate among the negative controls set). When examining the results across all datasets, we find that while MPRAnalyze and DESeq2 have overall comparable results, both modes of MPRAnalyze achieve a better balance between sensitivity (identifying candidates as active) and specificity (not identifying negative controls as active) than both modes of DESeq2 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Classification analysis comparisons. <bold>a</bold> fraction of sequences identified as significantly active (BH-corrected <italic>P</italic>&lt;0.05) by method and class of sequence. MPRAnalyze results both in control-based (red) and no-controls (orange) modes; empirical <italic>p</italic> values based on the mean ratio (blue) or aggregated ratio (green); DESeq2 results in collapsed mode (barcodes are summed within each batch, purple) or full mode (full data, light blue). Absolute number of active sequences is displayed on the bars. <bold>b</bold> Precision-Recall curve. Precision is based on performance on the negative controls, Recall is based on the total population of sequences, assuming all candidates are active. Error bars are ± the standard deviation of these measures across datasets. <bold>c</bold> Fraction of active sequences detected after re-running the analyses on 685 sequences from the Inoue-Kreimer dataset that were identified as active by MPRAnalyze (regular mode) and both DESeq2 modes, and the 200 controls from the same dataset. MPRAnalyze recapitulates the same results, finding that 100% of the candidates are active, whereas DESeq2 full only identifies 161 (23.5%) and DESeq2 collapsed completely fails to identify any active sequences</p></caption><graphic xlink:href="13059_2019_1787_Fig3_HTML" id="MO3"/></fig></p>
        <p>Since the above analysis overlooks the overall statistical behavior of the methods, we examined the full <italic>p</italic> value distribution of each method within each dataset. Considering multiple datasets, we found that both modes of MPRAnalyze, both ratio-based methods and DESeq2-full appear well calibrated, whereas DESeq2-collapsed does not follow the theoretical distribution of <italic>p</italic> values: a mixture of uniform values (corresponding to non-active sequences that follow the null distribution) and low values (active sequences for which the null is rejected) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). Similar results were found when examining the distribution over negative controls only (expected to be uniform), with MPRAnalyze in the no-control mode having some inflated values (assigning more low <italic>p</italic> values than expected), which emphasizes the importance of using negative controls in classification studies (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7). Finally, we examined the distribution over positive controls (only available in the Inoue-Kircher datasets) and found that MPRAnalyze in both modes has significantly higher statistical power, being outperformed only by ill-calibrated DESEq2-collapsed (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8). Overall, we found that despite comparable rates of sequences found statistically significant, the MPRAnalyze model is better calibrated to MPRA data.</p>
      </sec>
      <sec id="Sec8">
        <title>Caveats of using methods designed for differential expression</title>
        <p>DESeq2 pools information across all features included in the dataset (genes for RNA-seq, candidate enhancers for MPRA), both in the library size correction and estimation of the dispersion parameter. However, unlike genome-wide assays such as RNA-seq, the set of assayed features in MPRA experiments is curated according to the specific goals and context of the study. We hypothesized that DESeq2-based classification would be highly dependent on the sequences included in the analysis. We repeated the classification analysis on the Inoue-Kreimer dataset using only the 200 negative controls sequences and 685 candidate sequences that were previously classified as active by MPRAnalyze and both modes of DESeq2. This simulated a scenario in which the data was generated in an experiment that included fewer sequences. Confirming our hypothesis, MPRAnalyze results remain unchanged with all candidate sequences significantly active, whereas DESeq2-full only classifies 161 (23.5%) of the sequences as active and DESeq2-collapsed finds no active sequences at all. This reveal an inherent limitation of using differential expression methods such as DESEq2 for analyzing MPRA data.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Comparative studies</title>
      <p>Another common use for MPRAs is comparative studies, looking for differential transcription induced by a putative regulatory sequence between different cell types, stimuli, or other experimental covariates [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. More complex experimental settings are also possible, e.g., using MPRA to evaluate transcriptional activity over time as in the Inoue-Kreimer data [<xref ref-type="bibr" rid="CR17">17</xref>], or the interaction between differential allele activity and the presence of a certain transcription factor, as performed by Ulirsch and colleagues [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
      <p>Here we use the Inoue-Kircher data to demonstrate that MPRAnalyze is more statistically powerful than establish methods for analyzing comparative MPRA data, and therefore enables discovery of more neuanced biological signals, and that MPRAnalyze supports more complex experimental designs that are not supported by previous methods (e.g., temporal analysis).</p>
      <p>Performing differential activity analysis in MPRAnalyze can be done in two ways: first, since MPRAnlyze optimizes the model using likelihood maximization, any single hypothesis that can be encoded in a generalized linear model can be tested using a likelihood ratio test. This includes complex hypotheses that can be captured by interaction terms between covariates (e.g., cell type and genetic background [<xref ref-type="bibr" rid="CR12">12</xref>]). Additionally, in simple two-condition designs, or in cases where multiple contrasts are compared to a single reference (e.g., multiple different stimuli compared against the unstimulated behavior), the model coefficients can be extracted from the RNA model and tested using a Wald test. While both options are supported in the implementation of MPRAnalyze, the results in this paper are based on likelihood ratio testing.</p>
      <p>When performing comparative analysis, it is important to account for possible biases, such as those induced by overall differences in the basal transcription rate. In RNA-seq experiments, this issue is usually resolved via library size correction [<xref ref-type="bibr" rid="CR23">23</xref>], but with MPRA this is not necessarily sufficient. This is because for the library size to properly correspond to bias in the data, either the vast majority of features must be non-differential, or the differential signal must be symmetric. Neither of these assumptions necessarily hold for MPRA data, as they largely depend on the selection of the candidate sequences. For instance, MPRA can be designed with most sequences being more active in one condition than in the other, and thus most sequences are indeed differentially active. To address this issue, MPRAnalyze utilizes negative controls in the data to define the null differential behavior. This is done by fitting a separate, joint model for the controls, in which each control sequence has a distinct DNA model but they all share a single RNA model, reflecting the basal activity in each condition (<xref rid="Sec16" ref-type="sec">Methods</xref>).</p>
      <p>Alternative methods have been developed to address this or similar questions. QuASAR-MPRA [<xref ref-type="bibr" rid="CR19">19</xref>] was designed specifically for allelic comparisons and uses a beta-binomial model and mpralm [<xref ref-type="bibr" rid="CR20">20</xref>] which is a general differential-activity tool designed for MPRA which fits a linear model. Both methods use summary statistics and do not include barcode-level information in their model. Mpralm can use either the aggregated ratio or the mean ratio as the statistic, and is therefore subject to the limitations described above. QuASAR-MPRA, similar to MPRAnalyze, models the DNA and RNA separately, but it does so using the sum of counts across all barcodes in each condition, collapsing the data into a single measurement.</p>
      <sec id="Sec10">
        <title>Comparing mPRAnalyze with existing methods</title>
        <p>To compare these different methods, we used the Inoue-Kreimer dataset and extended the subset of samples we used to include both the 0 h and 72 h timepoints (post neural induction of human embryonic stem cells (hESC)). We then looked for sequences whose activity differed between the two time points, using MPRAnalyze, mpralm (both aggregated ratio and mean ratio modes), and QuASAR-MPRA (“<xref rid="Sec16" ref-type="sec">Methods</xref>”). The distribution of <italic>p</italic> values (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a) shows that overall MPRAnalyze and both modes of mpralm are well calibrated, following the expected mixture of uniform values and low values among candidates, and showing slight inflation but overall uniform behavior among the negative controls. Conversely, QuASAR-MPRA is less calibrated on both candidates and negative control sequences, recapitulating the results described by Myint et al. [<xref ref-type="bibr" rid="CR20">20</xref>]. Indeed, QuASAR-MPRA only identified two candidates as significantly differential (BH-corrected <italic>p</italic> values &lt;0.05).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparative analysis results of comparing timepoint 0h to 72h in the Inoue-Kreimer dataset. <bold>a</bold><italic>p</italic> value distributions of candidates (top) and controls (bottom). QuASAR-MPRA is poorly calibrated, whereas MPRAnalyze and both mpralm modes follow the theoretical behavior (mixture of uniform and low values). <bold>b</bold> Direct comparison of MPRAnalyze to competing methods. Top panels show the biological effect size (log fold-change); Bottom panels show the statistical significance (BH-corrected <italic>p</italic>; dotted lines are 0.05 threshold). <bold>c</bold> Venn diagram for MPRAnalyze and mpralm (both modes). The numbers in each area are (top) the total number of sequences in the area, and (bottom) the number of decreasing-activity sequences (left) + and increasing-activity sequences (right). <bold>d</bold> Enrichment of transcription factor binding sites in differentially active sequences as determined by each method. Solid line represents threshold of 0.05. (see “<xref rid="Sec16" ref-type="sec">Methods</xref>” for further details)</p></caption><graphic xlink:href="13059_2019_1787_Fig4_HTML" id="MO4"/></fig></p>
        <p>Overall, we observe that the estimates of effect size (log fold-change) are largely reproducible across methods (Pearson’s <italic>r</italic> &gt;0.84 across all pairs). In terms of statistical power (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b), we observe that MPRAnalyze calls more sequences as significant compared to the other methods. We further note that the FDR values of MPRAnalyze are largely correlated with those of mpralm among statistically significant candidates (Spearman correlation &gt;0.63 for sequences MPRAnalyze calls differential) and that the estimates of QuASAR-MPRA do not correlate with the other two methods (consistent with the results in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Further examination of the results excluded QuASAR-MPRA since it did not identify a sufficient number differential sequences.</p>
        <p>We further examined the differential sequences, after filtering the results to only include candidate sequences that are classified as active in at least one of the conditions (BH-corrected <italic>p</italic>&lt;0.05, using MPRAnalyze’s classification method). Interestingly, mpralm in aggregate mode finds a roughly balanced number of sequences that are increasing (99) and decreasing (91) in activity (comparing 0 h to 72 h), and in mean mode finds more decreasing (89) than increasing (49), while MPRAnalyze finds far more increasing (351) than decreasing (115) sequences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). However, sequences in the Inoue-Kreimer study were explicitly selected to correspond to increased activity over the course of differentiation (2037 [82%] of the assayed sequences are genomic regions selected due to their closest gene showing increased expression over differentiation). Therefore, the imbalance in the results from MPRAnalyze fits to the design of the experiment.</p>
        <p>We then explored the set of candidates that were detected by each method. To this end, we divided the set of differentially active sequences into decreasing and increasing activity (comparing 0 h to the 72 h time point), then within each set we tested for over-representation of DNA binding motifs (hypergeometric test, BH-corrected <italic>p</italic>&lt;0.05; “<xref rid="Sec16" ref-type="sec">Methods</xref>”). To narrow down the results, we examined the union of top 15 most enriched transcription factor binding motifs by each method (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1, Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S2).</p>
        <p>Among decreasing-activity sequences, we find as expected binding sites for two of the core pluripotent factors (NANOG, POU5F1). While these are captured by all methods, we observe a higher significance with MPRAnalyze. Among increasing-activity sequences, where the methods have more profound differences, we find that MPRAnalyze generally has lower fold-enrichment scores, but compensates by a substantial increase in statistical power. Overall, mpralm in <italic>mean</italic> mode does not detect many of the enriched transcription factors found by the other methods, with a total of 23 (compared with 106 and 195 found by mpralm <italic>aggregate</italic> and MPRAnalyze, respectively), and displays diminished statistical power.</p>
        <p>To ensure that these results are not simply explained by the higher number of differential sequences detected by MPRAnalyze, we also examined a <italic>consensus + noise</italic> option, where the consensus set (sequences called differential by all methods) was inflated with randomly chosen sequences (taken from the remaining population) to match the number of differential sequences called by MPRAnalyze (“<xref rid="Sec16" ref-type="sec">Methods</xref>”). We find that this simulated inflation that does not reflect true biological signal does not explain the increased power displayed by MPRAnalyze.</p>
        <p>Notably, MPRAnalyze results are enriched for binding sites for TEAD2 and NRF1, but results accourding to the other methods do not contain such enrichment. Both factors have been implicated in neurogenesis by previous studies [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], and upon closer examination we found that NRF1 binding sites have comparable fold-enrichment in all methods (1.48 in MPRAnalyze, 1.39 in mpralm <italic>aggregate</italic> and 1.45 in mpralm <italic>mean</italic>), but only pass the statistical threshold with MPRAnalyze. In the other direction, we found the mpralm results are enriched for binding sites of MYF5 and GSX1, but not the MPRAnalyze results. However, when examining the mRNA levels measured in the corresponding time points, we found that both factors have very low expression levels in the conditions in which MPRA was conducted (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S3). These levels are below their characteristic expression levels in tissues they are known to be active in [<xref ref-type="bibr" rid="CR26">26</xref>], making them less attractive candidates for driving differential transcription. Overall, MPRAnalyze identifies biological signal that is consistent with the competing methods, with increased statistical power, which allows for more nuanced results.</p>
      </sec>
      <sec id="Sec11">
        <title>Detecting temporal activity</title>
        <p>Finally, we note that MPRAnalyze can be used on the entire Inoue-Kreimer dataset, which consists of seven time-points, to identify sequences whose activity changes over time. MPRAnalyze performs this analysis by comparing two models: the full model, which allows for time-dependent activity; and the reduced model, in which time-point factors are excluded, thereby forcing a constant behavior across time-points (methods). This analysis cannot be performed by either of the competing methods: QuASAR-MPRA only supports two-condition comparisons, and mpralm only supports coefficient-based hypothesis testing. We ran MPRAnalyze in this fashion and after filtering sequences to only those that are active in at least one time-point (FDR &lt;0.05, using MPRAnalyze to perform classification analysis per time-point) MPRAnalyze finds 749 (28%) sequences that have temporal activity (methods, FDR &lt;0.05). Reassuringly, of the 466 sequences identified as differential between the first and last time-points, 420 (90.1%) are found to have overall temporal activity.</p>
        <p>We found that temporal sequences broadly tend to have a smooth impulse-like activation pattern over time [<xref ref-type="bibr" rid="CR27">27</xref>], whereas negative control sequences have less clear patterns (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10). We then clustered the temporal sequences (<italic>K</italic>-means with <italic>K</italic> = 4 on <italic>α</italic> values, <italic>z</italic>-normalized for each sequence) in order to group sequences with a similar temporal behavior pattern, and repeated the same binding site enrichment analysis as above (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S4) for each cluster. As evidence for the validity of our approach, we found that the sequences that are active at the early time points were indeed enriched for binding sites of core pluripotent factors (NANOG, SOX2, POUF51), and that sequences that are active later in the differentiation process were enriched for binding sites of transcription factors known to participate in neural differentiation (ATF2 [<xref ref-type="bibr" rid="CR28">28</xref>], HES1 [<xref ref-type="bibr" rid="CR29">29</xref>], GLI1, LEF [<xref ref-type="bibr" rid="CR30">30</xref>]).</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Allelic comparison</title>
      <p>Many MPRA studies deal with quantifying the effect of sequence variants on regulatory function. These studies, referred to here as allelic comparison studies, include those that compare observed genetic variants to investigate the regulatory effect of different alleles of a regulatory sequence [<xref ref-type="bibr" rid="CR12">12</xref>], as well as studies that deliberately change a sequence to elucidate the regulatory grammar in a systemic fashion [<xref ref-type="bibr" rid="CR13">13</xref>]. While conceptually similar to comparative analyses, allelic comparisons require different factors to be considered. Two important differences are: (1) the compared sequences (e.g., wild type and mutant allele) come from the same sample and therefore a systemic bias is less concerning than it is when comparing different conditions, and (2) the different alleles being compared are associated with different barcodes, in contrast with condition-wise comparison in which barcodes are shared between conditions.</p>
      <p>To demonstrate the utility of MPRAnalyze in this scenario, we used recently published data by Mattioli and colleagues [<xref ref-type="bibr" rid="CR13">13</xref>], who measured the effects of all possible single-nucleotide deletions were examined on 31 selected promoters. To this end, an MPRA was conducted with all the deletion and corresponding wild type (WT) sequences, where each deletion was associated with 26 barcodes and each WT sequence was associated with 80 barcodes. A single sample of the pre-transduction plasmids was sequenced to produce the DNA library. The RNA samples were taken from two different tissues: eight samples from the HepG2 cell line and four samples from the K562 cell line. This asymmetrical experimental design exemplifies the diverse nature of MPRA studies, and the necessity of a flexible framework.</p>
      <p>Using this dataset, we demonstrate that MPRAnalyze is well calibrated and more statistically powerful than established methods, and supports studying the interaction of multiple conditions: in this case finding sequence variants with cell-line specific functional effects.</p>
      <sec id="Sec13">
        <title>Comparing mPRAnalyze with existing methods</title>
        <p>Similar to the comparative analysis described above, we compared each deletion sequence with the corresponding WT in each tissue separately, with all three methods: MPRAnalyze, mpralm (which only supports the <italic>aggregated</italic> mode for allelic comparisons), and QuASAR-MPRA.</p>
        <p>When examining the <italic>p</italic> value distribution generated by each method we find that MPRAnalyze and mpralm are both better calibrated than QuASAR-MPRA (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a-b). Consistent with our previous results, all methods have correlated estimates of biological effects (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c–f). The methods are better correlated in the HepG2 data compared with the K562 data (correlations with MPRAnalyze: Pearson’s <italic>r</italic>=0.72 in K562 and 0.77 in HepG2 for mpralm, and 0.78 in K562 and 0.96 in HepG2 for QuASAR), which we hypothesized is due to the higher number of replicates in the HepG2 data. When the comparison was repeated using only four replicates of the HepG2 data, the correlations between methods decreased (correlations with MPRAnalyze: Pearson’s <italic>r</italic>=0.63 for mpralm and 0.38 for QuASAR, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance evaluation in allelic comparison. <bold>a,b</bold><italic>p</italic> value density of the three evaluated methods in both cell lines. <bold>c–f</bold> logFC values between methods in each cell type shows all methods find a similar biological signal. <bold>g–i</bold> logFC values between cell types for each method. Some differences are expected, but overall values are highly correlated. <bold>j</bold> Schematic of the enrichment analysis, testing cell-line specific functional deletions for enrichment of motifs that were gained or lost by those deletions. <bold>k, l</bold> results of motif enrichment analyses. Transcription Factors with significant enrichment (FDR &lt; 0.05) are labeled</p></caption><graphic xlink:href="13059_2019_1787_Fig5_HTML" id="MO5"/></fig></p>
        <p>We then compared the effects estimated by each method across cell lines. Overall, we find a high degree of similarity in the effects of sequence perturbation across cell lines—a finding supported by all the methods we considered (Fig. <xref rid="Fig5" ref-type="fig">5</xref>g–i). Looking more closely, we find that mpralm and QuASAR-MPRA both find a systemic skew towards stronger effects in K562, with 72.6% and 63.1% of deletions having a more extreme log fold-change value in K562 compared with HepG2 in mpralm and QuASAR-MPRA, respectively, whereas MPRAnalyze results are more balanced, with 49.8%. When comparing statistical power, we again find that MPRAnalyze can detect more deletions that significantly affect the rate of transcription (FDR &lt;0.05). In HepG2, MPRAnalyze finds 2855 (72%) deletions with a significant effect, whereas mpralm finds 2710 (68.4%), with 2071 (52.2%) of the sequences significant in both; in K562, MPRAnalyze finds 1230 (31%) significant deletions compared with 360 (9%) found by mpralm, with 272 (6.8%) significant in both. In both cell types, QuASAR-MPRA does not find any significantly functional deletion. As expected, due to the larger sample size, both MPRAnalyze and mpralm are more powerful in HepG2 compared with K562.</p>
      </sec>
      <sec id="Sec14">
        <title>Identifying variants with cell-line specific effects</title>
        <p>Since the Mattioli study performed allelic comparisons in two cell types, it can also be used for the identification of deletions that have a different effect in HepG2 cells compared with K562 cells. With MPRAnalyze, it is possible to address this question directly, testing the interaction between the tissue and the allele covariates in the model. When performing this analysis, MPRAnalyze found 608 (15.3%) differential deletions that had a different effect between cell types. For example, the core promoter of the lncRNA gene DLEU1 has several functional deletions that are highly concordant between cell types, and a single differentially functional deletion in position 83, where the deletion has a significantly larger effect in HepG2 (<italic>l</italic><italic>o</italic><italic>g</italic><italic>F</italic><italic>C</italic>=−0.86) than in K562 (<italic>l</italic><italic>o</italic><italic>g</italic><italic>F</italic><italic>C</italic>=−0.13)(Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12).</p>
        <p>To examine the biological implications of our results, we followed the analysis performed by Mattioli and colleagues and identified transcription factor binding motifs that are disturbed by the single nucleotide deletions. Focusing only on functional deletions (i.e., deletions that had any effect in one or both cell lines), we looked for DNA binding motifs whose disruptive deletions are over-represented in the set of conditionally functional deletions (i.e., deletions with significantly more effect in one cell line vs. the other) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>j). Overall, we found three statistically enriched (Hypgergeometric test, <italic>F</italic><italic>D</italic><italic>R</italic>&lt;0.05, <xref rid="Sec16" ref-type="sec">Methods</xref>) motifs in the cell type specific deletions (Fig. <xref rid="Fig5" ref-type="fig">5</xref>k, l). Reassuringly, we found that K562-specific deletions were enriched for motifs of the erythroid transcription factor NF-E2. These results demonstrate the potential utility of MPRAnalyze in addressing cases of complex and possibly asymmetric experimental designs.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="discussion">
    <title>Discussion</title>
    <p>Massively parallel reporter assays are a powerful technique for functional characterization of enhancer activity in a high-throughput manner. MPRAs can be used to quantify the contribution made by non-coding DNA elements, such as enhancers, to transcriptional activity in nearby genes [<xref ref-type="bibr" rid="CR10">10</xref>]. It can be further extended to evaluate differences in regulatory activity between different alleles [<xref ref-type="bibr" rid="CR12">12</xref>], elucidate regulatory grammar via mutagenesis studies [<xref ref-type="bibr" rid="CR13">13</xref>], and compare enhancer activity between conditions [<xref ref-type="bibr" rid="CR9">9</xref>]. Complex experimental designs can include interaction studies, where one is interested in how sequence changes affect differential activity between cellular conditions [<xref ref-type="bibr" rid="CR12">12</xref>], or identifying temporal patterns in time-course data [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p>Since MPRAs are still an actively developing technology, they often vary in experimental design. While MPRAnalyze is flexible and can handle various study designs, the method benefits from certain experimental decisions that are generally recommended but not always leveraged in other analyses. First, pairing the DNA and RNA libraries by extracting DNA from the same post-transduction libraries that the RNA libraries are extracted from, avoids introducing further experimental noise into the data and enables MPRAnalyze to better fit and relate the two models to increase accuracy of estimating nuisance factors. Additionally, as demonstrated in our results, increasing the number of available barcodes and replicates can greatly reduce the measured noise and increase performance of all methods, as seen in recent studies [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Finally, the inclusion of negative control sequences allows explicit modeling of the null behavior and avoids relying on assumptions that may bias the results and prevent proper interpretation of them. The curated nature of MPRA datasets makes negative controls a valuable and often crucial aspect of properly interpreting the results.</p>
    <p>MPRAnalyze offers a robust statistical framework that enables all major uses of MPRAs in a unified model. Our model avoids relying on ratio-based summary statistics, seeking to directly model the data as structured, following a similar trend in other high throughput functional assay analysis methods, such as recent methods developed for the analysis of deep mutational scanning data [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR35">35</xref>]. MPRAnalyze models noise in both DNA and RNA libraries and uses a nested GLM design to control barcode-specific effects and leverage the multiplicity of barcodes for increased statistical power. The method is highly flexible and allows various complex study designs to be tested in a straight-forward manner, including those currently not supported by any established method. Additionally, MPRAnalyze avoids relying on population-level properties in the analysis, instead leveraging negative controls when available to establish null behaviors.</p>
  </sec>
  <sec id="Sec16">
    <title>Methods</title>
    <sec id="Sec17">
      <title>Dataset collection and processing</title>
      <p>For all datasets included in this paper, we relied on the pre-processing and filtering performed by the authors of the original papers. This ensures that MPRAnalyze’s performance isn’t reflecting any favorable processing steps we chose.</p>
      <p>For <italic>Kwasnieski</italic>, the study [<xref ref-type="bibr" rid="CR10">10</xref>] measured the activity of potential regulatory regions in K562 cells. Regions were selected according to ENCODE annotations of four groups: enhancers, weak enhancers, repressed enhancers, enhancers active in ESCs. The repressed and ESC-annotated enhancers were used as controls and were excluded from the analysis after library size normalization factors were computed. In addition to control classes, each class had internal sets of scrambled sequences used as negative controls, which were used as controls in our analyses. Each sequences in this dataset was associated with four barcodes. The DNA was sequenced before transduction and with a single replicate, while four replicates are available for the RNA. While the sample size in this data is very limited, this allowed for higher read counts to be achieved, mitigating the loss of statistical power by getting more reliable quantification of the counts.</p>
      <p>For <italic>Inoue-Kircher</italic>, the study [<xref ref-type="bibr" rid="CR9">9</xref>] compared activity in HepG2 cells of liver enhancers that were either episomal or chromosomally integrated using a lentivirus (lentiMPRA). While the study is comparative, the comparison is not between biological conditions and the results are therefore difficult to validate or interpret. We therefore decided to use the data as two separate quantification datasets. The datasets were analyzed together to better account for batch and barcode-specific effects, and <italic>α</italic> estimates were extracted from the joint model for each condition separately. Negative control sequences were generated by scrambling candidate sequences, and positive controls were sequences that have been previously validated as having a regulatory function in these cells. Each sequence was associated with 100 unique barcodes. DNA was sequenced post-transduction. Both DNA and RNA have three replicates.</p>
      <p>For <italic>Inoue-Kreimer</italic>, the study [<xref ref-type="bibr" rid="CR17">17</xref>] identified enhancers with temporal activity over the first 72 h after neural induction. lentiMPRA was performed in 7 timepoints (0, 3, 6, 12, 24, 48, and 72 h after undiction). For the purpose of our analysis, we used only the data from the first timepoint in the quantification and classification analyses, and timepoints 0 and 72 h for the comparative analysis. Negative controls are scrambled candidate sequences. Each sequence was associated with 90 barcodes. DNA was sequenced post-transduction. Both DNA and RNA have three replicates.</p>
      <p>For <italic>Mattioli</italic>, the study [<xref ref-type="bibr" rid="CR13">13</xref>] compared WT sequences containing core promoters of 31 long non-coding RNAs (21 sequences), enhancer RNAs (5 sequences) and messenger RNAs (5 sequences) with the same sequences with single-nucleotide deletions. Each core promoter was divided to 2 “tiles” to cover more of the putative regulatory sequence, resulting in a total of 62 WT sequences. MPRAs were performed in both K562 and HepG2 cells, with varying number of replicates (4 in K562, 8 in HepG2). DNA was sequenced pre-transduction, and in a single replicate (used for both cell types).</p>
    </sec>
    <sec id="Sec18">
      <title>Computing transcription rate estimates</title>
      <p>All transcription rate estimates were computed for library size normalized MPRA data, using upper quartile normalization to compute size factors. <italic>MPRAnalyze’s α</italic> was computed for each dataset using the quantification analysis (See Additional files). Across datasets, batch and barcode-level effects were modelled in the nested DNA model, but excluded from the RNA model design. This allows MPRAnalyze to model nuisance effects but asserts that all barcodes associated with a single sequence must share the same transcription rate. Both ratio-based estimates were computed using only barcodes with non-zero DNA and RNA counts. So for each sequence: <italic>S</italic>={<italic>i</italic>∈[<italic>n</italic>]|<italic>R</italic><sub><italic>i</italic></sub>≠0,<italic>D</italic><sub><italic>i</italic></sub>≠0}. Then the Mean Ratio <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$=\frac {1}{|S|}\sum _{i\in S}{\frac {R_{i}}{D_{i}}}$\end{document}</tex-math><mml:math id="M30"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq10.gif"/></alternatives></inline-formula>, and the Aggregated Ratio <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$=\frac {\sum _{i\in S}{R_{i}}}{\sum _{j\in S}{D_{j}}}$\end{document}</tex-math><mml:math id="M32"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq11.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec19">
      <title>Running alternative methods</title>
      <p><italic>DESeq2</italic> was used as a method for classifying active enhancers, by comparing the DNA and RNA libraries as the two conditions being compared. DEseq2 was used in two modes: the full mode included each barcode as separate sample, and the collapsed mode took the sum across barcodes within each batch as a sample. In full mode, a single count was added to each observation to avoid issues with DESeq2 library normalization scheme. The model used within DESeq2 was a simple comparison model: type, where type identifies DNA and RNA observations.</p>
      <p><italic>QuASAR-MPRA</italic> was used according to the documentation provided in the package. The <italic>betas.beta.binom</italic> value, which is the logit transformation of the allelic skew, was used as a proxy for log fold-change.</p>
      <p><italic>mpralm</italic> was used according to the documentation provided in the package. For allelic comparisons, while the package vignette uses the sum across barcodes when aggregating the counts, we used the mean across barcodes instead, since the two compared alleles did not have the same number of associated barcodes. Additionally, since the package requires manual aggregation of barcodes in this situation, only the <italic>aggregated</italic> mode of the model is supported for this type of analysis.</p>
    </sec>
    <sec id="Sec20">
      <title>Subsampling analysis</title>
      <p>For the subsampling analysis, barcodes were sampled down to varying levels (for Inoue-Kircher datasets: 15, 30, 45, 60, 75, and 90 out of the total 100 barcodes; for Inoue-Kreimer: 15, 30, 45, 60, and 75 of the total 90 barcodes). The analysis uses three independent replicates of this down-sampling process, so overall for each sequence, we get a set of 3×<italic>K</italic> estimates at various numbers of available barcodes, where <italic>K</italic>=6 for the Inoue-Kircher datasets and <italic>K</italic>=5 for Inoue-Kreimer. The analyses were done on the entire down-sampled dataset in a single run and included the original data as well as the reduced-barcodes data, to neutralize any effect that the library size correction might have on the estimates.</p>
    </sec>
    <sec id="Sec21">
      <title>Simulating mPRA data</title>
      <p>MPRA data was simulated by generating random coefficients for the nested GLM construction that MPRAnalyze uses. The <italic>latent (true)</italic> DNA and RNA counts were generated directly from the model, then log-normal noise was added to the latent counts to get the <italic>observed</italic> counts. Formally: 
<disp-formula id="Equa"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \vec{\beta}=&amp;\left[\beta_{0},\vec{\beta_{\text{batch}}},\ \vec{\beta_{\text{BC}}}\right]\\ \beta_{0}\sim&amp;N\left(K, \sigma_{0}^{2}\right)\\ \vec{\beta_{\text{batch}}}\sim&amp;N\left(0, \sigma_{\text{batch}}^{2}\right)\\ \vec{\beta_{BC}}\sim&amp;N\left(0, \sigma_{\text{BC}}^{2}\right)\\ \Downarrow\\ \vec{D}_{\text{true}} =&amp;\ \text{nint}\left(\text{exp}\left(X_{d} \vec{\beta}\right)\right)\\ \vec{R}_{\text{true}} =&amp;\ \text{nint}\left(\text{exp}\left(\alpha\cdot X_{d} \vec{\beta}\right)\right)\\ \vec{D}_{\text{observed}} \sim&amp;\ \text{nint}\left(\mathrm{log-Normal}\left(\text{exp}\left(X_{d} \vec{\beta}\right), \sigma_{D}^{2}\right)\right)\\ \vec{R}_{\text{observed}} \sim&amp;\ \text{nint}\left(\mathrm{log-Normal}\left(\text{exp}\left(\alpha\cdot X_{d} \vec{\beta}\right), \sigma_{R}^{2}\right)\right) \end{array} $$ \end{document}</tex-math><mml:math id="M34"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext>batch</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext>BC</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext>batch</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>batch</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BC</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>BC</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi>⇓</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>true</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mtext>nint</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>exp</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>true</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mtext>nint</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>exp</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>observed</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mtext>nint</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">Normal</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>exp</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>observed</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mtext>nint</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">Normal</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>exp</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1787_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>K</italic> controls the intercept term for the construct distribution, the variance of which is <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{0}^{2}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq12.gif"/></alternatives></inline-formula>; <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{\text {batch}}^{2}, \sigma _{\text {BC}}^{2}$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>batch</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>BC</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq13.gif"/></alternatives></inline-formula> control the size of batch and barcode effects, respectively; <inline-formula id="IEq14"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{D}^{2}, \sigma _{R}^{2}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq14.gif"/></alternatives></inline-formula> determine the noise levels added to the data; and nint is the nearest-integer function, using base R’s <italic>round</italic> function. An implementation of this simulation process is included in the MPRAnalyze package.</p>
      <p>Noise was generated using log-normal noise instead of Gamma/Negative Binomial to avoid generating data directly from MPRAnalyze’s model, which might bias the results.</p>
      <p>Simulated data in this manuscript was generated with three batches, varying numbers of barcodes, <italic>K</italic>=5, and <italic>σ</italic><sub>0</sub>=<italic>σ</italic><sub>batch</sub>=<italic>σ</italic><sub>BC</sub>=<italic>σ</italic><sub><italic>D</italic></sub>=<italic>σ</italic><sub><italic>R</italic></sub>=0.5.</p>
    </sec>
    <sec id="Sec22">
      <title>Transcription factor binding site enrichment analysis</title>
      <p>The transcription factor binding site enrichment analysis was performed using the binary binding matrix computed by Inoue and Kreimer et al. [<xref ref-type="bibr" rid="CR17">17</xref>], with each entry indicating the potential for binding (motif-based binding prediction using Fimo [<xref ref-type="bibr" rid="CR36">36</xref>], <italic>F</italic><italic>D</italic><italic>R</italic>&lt;10<sup>−4</sup>) or overlap with transcription factor ChIP-seq peaks from publicly available data [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. Enrichment was calculated using a hypergeometric test, with all binding motifs of a each transcription factors being pooled together. A factor was deemed enriched if BH-corrected <italic>p</italic> &lt; 0.05. Enrichment scores were calculated as: <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log _{2}\left (\frac {\text {fraction of differential sequences containing a binding site of the TF}}{\text {fraction of total sequences containing a binding st of the TF}}\right).$\end{document}</tex-math><mml:math id="M42"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>fraction of differential sequences containing a binding site of the TF</mml:mtext></mml:mrow><mml:mrow><mml:mtext>fraction of total sequences containing a binding st of the TF</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><inline-graphic xlink:href="13059_2019_1787_Article_IEq15.gif"/></alternatives></inline-formula> For the <italic>consensus + noise</italic> option, for each TF we calculated the number of predicted binding sites in the consensus set and in the remaining population. We then added artificial biding sites to the consensus set, proportional to their abundance in the remaining population, to match the number of differential sequences called by MPRAnalyze.</p>
    </sec>
    <sec id="Sec23">
      <title>Temporal activity analysis</title>
      <p>The analysis was performed by setting the full RNA model to include both batch and time-course factors (∼<italic>batch + time</italic>), and the reduced model to batch factors only (∼<italic>batch</italic>). A Likelihood-ratio test is performed for statistical significance, and a sequence is deemed “temporal” if BH-corrected <italic>p</italic>&lt;0.05. Heatmaps for visualization were generated using the ComplexHeatmap R package [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
    </sec>
    <sec id="Sec24">
      <title>Differential deletions analysis</title>
      <p>To identify differential deletions (deletions that affect the induced transcription rate in K562 differently than in HepG2) in the Mattioli dataset we used an interaction term in the RNA model design, encoding the interaction between the cell type factor and the allele factor: 
<disp-formula id="Equb"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \mathcal{H}_{0}:&amp; \mathrm{RNA \sim Allele + CellType + Allele:CellType}\\ \mathcal{H}_{1}:&amp; \mathrm{RNA \sim Allele + CellType} \end{array} $$ \end{document}</tex-math><mml:math id="M44"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mi mathvariant="normal">RNA</mml:mi><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">Allele</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">CellType</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">Allele</mml:mtext><mml:mo>:</mml:mo><mml:mtext mathvariant="italic">CellType</mml:mtext><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mi mathvariant="normal">RNA</mml:mi><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">Allele</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">CellType</mml:mtext><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1787_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Then a standard likelihood ratio test was performed to determine statistical significance. Since the DNA data has a different design (a single replicate shared across all RNA samples), that design only modeled for barcode specific effects.</p>
    </sec>
    <sec id="Sec25">
      <title>Differential deletion motif analysis</title>
      <p>Once differential deletions were identified, we divided the differential deletions to those that had a greater effect in HepG2 or K562. For each cell type, we used the motif hits curated by Mattioli and collegues, which rely on FIMO-based [<xref ref-type="bibr" rid="CR36">36</xref>] predicted binding scores, to associate each deletion with differential motifs: motifs predicted in one allele and not the other. If the deletion causes a decrease in the induced transcription rate, we took the “lost” motifs (predicted in WT, not in the deletion), and if the deletion caused an increase, we took the “gained” motifs (predicted in the deletion, not the WT). All motifs associated with the same transcription factor were pooled. Enrichment scores were calculated using a hypergeometric test, using the total set of functional deletions as background (motifs for these were acquired in the same fashion).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec26">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1787_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplemental Figures (S1-12). (PDF 1759 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1787_MOESM2_ESM.pdf">
            <label>Additional file 2</label>
            <caption>
              <p>Supplemental methods. Formal description of the MPRAnalyze model, hypothesis testing schemes and optimization details. (PDF 231 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1787_MOESM3_ESM.csv">
            <label>Additional file 3</label>
            <caption>
              <p>Table s1. Transcription factor binding site enrichment analysis results: BH-corrected <italic>p</italic> values. (CSV 48 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2019_1787_MOESM4_ESM.csv">
            <label>Additional file 4</label>
            <caption>
              <p>Table s2. Transcription factor binding site enrichment analysis results: fold-enrichment scores. (CSV 82 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2019_1787_MOESM5_ESM.csv">
            <label>Additional file 5</label>
            <caption>
              <p>Table s3. Full RNA-seq measurements from the Inoue-Kreimer study of the timepoints T0h and T72h. (CSV 993 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2019_1787_MOESM6_ESM.csv">
            <label>Additional file 6</label>
            <caption>
              <p>Table s4. BH-corrected <italic>p</italic> values from the Transcription Factor finding site enrichment analysis of the temporal results. (CSV 40 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="13059_2019_1787_MOESM7_ESM.docx">
            <label>Additional file 7</label>
            <caption>
              <p>Review history for the manuscript. (DOCX 50 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Tal Ashuach and David S. Fischer contributed equally to this work.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>TA, DSF, and NY conceived of core algorithms. TA and DSF designed the software package. TA conducted all the experiments. TA and NY wrote the manuscript. AK, NA, and FJT advised on the interpretation of the results. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was supported by the National Human Genome Research Institute (NHGRI; grant number U01HG007910).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>MPRAnalyze is implemented as an R package and is distributed under GPL-3 license through bioconductor [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR40">40</xref>]: <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/MPRAnalyze.html">https://bioconductor.org/packages/release/bioc/html/MPRAnalyze.html</ext-link>. Source code and materials used to generate the figures in this paper are available via Zenodo (DOI: 10.5281/zenodo.3345040; <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3345040">https://zenodo.org/record/3345040</ext-link>). Datasets used throughout the manuscript: <italic>Kwasnieski</italic> [<xref ref-type="bibr" rid="CR10">10</xref>] Data is made available by the authors upon request; <italic>Inoue-Kircher</italic> [<xref ref-type="bibr" rid="CR9">9</xref>] Available from Gene Expression Omnibus: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE83894">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE83894</ext-link>; <italic>Inoue-Kreimer</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] Data is made available by the authors upon request; <italic>Mattioli</italic> [<xref ref-type="bibr" rid="CR13">13</xref>] Available from Gene Expression Omnibus: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE117594">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE117594</ext-link></p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>All authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kulaeva</surname>
            <given-names>OI</given-names>
          </name>
          <name>
            <surname>Nizovtseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Polikanov</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Ulianov</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Studitsky</surname>
            <given-names>VM</given-names>
          </name>
        </person-group>
        <article-title>Distant activation of transcription: mechanisms of enhancer action</article-title>
        <source>Mol Cell Biol</source>
        <year>2012</year>
        <volume>32</volume>
        <issue>24</issue>
        <fpage>4892</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1128/MCB.01127-12</pub-id>
        <pub-id pub-id-type="pmid">23045397</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maston</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional regulatory elements in the human genome</article-title>
        <source>Annu Rev Genomics Hum Genet</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>29</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genom.7.080505.115623</pub-id>
        <pub-id pub-id-type="pmid">16719718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hindorff</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Sethupathy</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Junkins</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Manolio</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Potential etiologic and functional implications of genome-wide association loci for human diseases and traits</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>23</issue>
        <fpage>9362</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0903103106</pub-id>
        <pub-id pub-id-type="pmid">19474294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ahituv</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Gene regulatory elements, major drivers of human disease</article-title>
        <source>Annu Rev Genomics Hum Genet</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>45</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-091416-035537</pub-id>
        <pub-id pub-id-type="pmid">28399667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kinney</surname>
            <given-names>Justin B.</given-names>
          </name>
          <name>
            <surname>McCandlish</surname>
            <given-names>David M.</given-names>
          </name>
        </person-group>
        <article-title>Massively Parallel Assays and Quantitative Sequence–Function Relationships</article-title>
        <source>Annual Review of Genomics and Human Genetics</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>99</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-083118-014845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inoue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ahituv</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Decoding enhancers using massively parallel reporter assays</article-title>
        <source>Genomics</source>
        <year>2015</year>
        <volume>106</volume>
        <issue>3</issue>
        <fpage>159</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2015.06.005</pub-id>
        <pub-id pub-id-type="pmid">26072433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Visel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Minovitsky</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dubchak</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pennacchio</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>VISTA enhancer browser–a database of tissue-specific human enhancers</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>Database issue</issue>
        <fpage>88</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inoue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>McManus</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Ahituv</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A systematic comparison reveals substantial differences in chromosomal versus episomal encoding of enhancer activity</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>38</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.212092.116</pub-id>
        <pub-id pub-id-type="pmid">27831498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwasnieski</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Fiore</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chaudhari</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>High-throughput functional testing of ENCODE segmentation predictions</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>10</issue>
        <fpage>1595</fpage>
        <lpage>602</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.173518.114</pub-id>
        <pub-id pub-id-type="pmid">25035418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tewhey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kotliar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Winnicki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reilly</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Direct identification of hundreds of Expression-Modulating variants using a multiplexed reporter assay</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <issue>6</issue>
        <fpage>1519</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.027</pub-id>
        <pub-id pub-id-type="pmid">27259153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ulirsch</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Nandakumar</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Giani</surname>
            <given-names>FC</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rogov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Melnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McDonel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Do</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Sankaran</surname>
            <given-names>VG</given-names>
          </name>
        </person-group>
        <article-title>Systematic functional dissection of common genetic variation affecting red blood cell traits</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <issue>6</issue>
        <fpage>1530</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.048</pub-id>
        <pub-id pub-id-type="pmid">27259154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mattioli</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Volders</surname>
            <given-names>P-J</given-names>
          </name>
          <name>
            <surname>Gerhardinger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Maass</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Melé</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>High-throughput functional analysis of lncRNA core promoters elucidates rules governing tissue specificity</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>344</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.242222.118</pub-id>
        <pub-id pub-id-type="pmid">30683753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Taher</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Patwardhan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Inoue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ovcharenko</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ahituv</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Massively parallel decoding of mammalian regulatory sequences supports a flexible organizational model</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <issue>9</issue>
        <fpage>1021</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2713</pub-id>
        <pub-id pub-id-type="pmid">23892608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weingarten-Gabbay</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A shared architecture for promoters and enhancers</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <issue>12</issue>
        <fpage>1253</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3152</pub-id>
        <pub-id pub-id-type="pmid">25418744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>SQ</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>AEO</given-names>
          </name>
          <name>
            <surname>Byrne</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Flannery</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Corbo</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Massively parallel cis-regulatory analysis in the mammalian central nervous system</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>2</issue>
        <fpage>238</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.193789.115</pub-id>
        <pub-id pub-id-type="pmid">26576614</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Inoue F, Kreimer A, Ashuach T, Ahituv N, Yosef N. Massively parallel characterization of regulatory dynamics during neural induction. 2018. 10.1101/370452.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalita</surname>
            <given-names>Cynthia A</given-names>
          </name>
          <name>
            <surname>Moyerbrailean</surname>
            <given-names>Gregory A</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>Christopher</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>Xiaoquan</given-names>
          </name>
          <name>
            <surname>Luca</surname>
            <given-names>Francesca</given-names>
          </name>
          <name>
            <surname>Pique-Regi</surname>
            <given-names>Roger</given-names>
          </name>
        </person-group>
        <article-title>QuASAR-MPRA: accurate allele-specific analysis for massively parallel reporter assays</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>5</issue>
        <fpage>787</fpage>
        <lpage>794</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Myint L, Avramopoulos DG, Goff LA, Hansen K. Linear models enable powerful differential activity analysis in massively parallel reporter assays. 2017. 10.1101/196394.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carvalho</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gatto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Girke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>MacDonald</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Obenchain</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Oleś</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shannon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Tenenbaum</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Orchestrating high-throughput genomic analysis with bioconductor</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>115</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id>
        <pub-id pub-id-type="pmid">25633503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbas-Aghababazadeh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fridley</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Comparison of normalization approaches for gene expression studies completed with high-throughput sequencing</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>0206312</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0206312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaneko</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Kohn</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>DePamphilis</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Transcription factor TEAD2 is involved in neural tube closure</article-title>
        <source>Genesis</source>
        <year>2007</year>
        <volume>45</volume>
        <issue>9</issue>
        <fpage>577</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1002/dvg.20330</pub-id>
        <pub-id pub-id-type="pmid">17868131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>W-T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H-I</given-names>
          </name>
          <name>
            <surname>Chiou</surname>
            <given-names>R-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>A-M</given-names>
          </name>
        </person-group>
        <article-title>A novel function of transcription factor alpha-Pal/NRF-1: increasing neurite outgrowth</article-title>
        <source>Biochem Biophys Res Commun</source>
        <year>2005</year>
        <volume>334</volume>
        <issue>1</issue>
        <fpage>199</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bbrc.2005.06.079</pub-id>
        <pub-id pub-id-type="pmid">15992771</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stelzer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rosen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Plaschkes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zimmerman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Twik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fishilevich</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Nudel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lieder</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mazor</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dahary</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Warshawsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Guan-Golan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kohn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rappaport</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Safran</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lancet</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The GeneCards suite: From gene data mining to disease genome sequence analyses</article-title>
        <source>Curr Protoc Bioinforma</source>
        <year>2016</year>
        <volume>54</volume>
        <fpage>1.30.1</fpage>
        <lpage>1.30.33</lpage>
        <pub-id pub-id-type="doi">10.1002/cpbi.5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Impulse control: temporal dynamics in gene transcription</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>144</volume>
        <issue>6</issue>
        <fpage>886</fpage>
        <lpage>896</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.02.015</pub-id>
        <pub-id pub-id-type="pmid">21414481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ackermann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ashton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lyons</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hornung</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Breitwieser</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Loss of ATF2 function leads to cranial motoneuron degeneration during embryonic mouse development</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>4</issue>
        <fpage>19090</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0019090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kageyama</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ohtsuka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kobayashi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Roles of hes genes in neural development</article-title>
        <source>Dev Growth Differ</source>
        <year>2008</year>
        <volume>50 Suppl 1</volume>
        <fpage>97</fpage>
        <lpage>103</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1440-169X.2008.00993.x</pub-id>
        <pub-id pub-id-type="pmid">18067585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>H-K</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H-S</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Neural transcription factors: from embryos to neural stem cells</article-title>
        <source>Mol Cells</source>
        <year>2014</year>
        <volume>37</volume>
        <issue>10</issue>
        <fpage>705</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.14348/molcells.2014.0227</pub-id>
        <pub-id pub-id-type="pmid">25234468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <mixed-citation publication-type="other">Davis JE, Insigne KD, Jones EM, Hastings QB, Kosuri S. Multiplexed dissection of a model human transcription factor binding site architecture. 2019. 10.1101/625434.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">van Arensbergen J, Pagie L, FitzPatrick V, de Haas M, Baltissen M, Comoglio F, van der Weide R, Teunissen H, Võsa U, Franke L, de Wit E, Vermeulen M, Bussemaker H, van Steensel B. Systematic identification of human SNPs affecting regulatory element activity. 2019. 10.1101/460402.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fowler</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Deep mutational scanning: a new style of protein science</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>8</issue>
        <fpage>801</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3027</pub-id>
        <pub-id pub-id-type="pmid">25075907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matuszewski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hildebrandt</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Ghenu</surname>
            <given-names>A-H</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Bank</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A statistical guide to the design of deep mutational scanning experiments</article-title>
        <source>Genetics</source>
        <year>2016</year>
        <volume>204</volume>
        <issue>1</issue>
        <fpage>77</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.116.190462</pub-id>
        <pub-id pub-id-type="pmid">27412710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubin</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Gelman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bajjalieh</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Papenfuss</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>A statistical framework for analyzing deep mutational scanning data</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>150</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1272-5</pub-id>
        <pub-id pub-id-type="pmid">28784151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grant</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>FIMO: scanning for occurrences of a given motif</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>7</issue>
        <fpage>1017</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr064</pub-id>
        <pub-id pub-id-type="pmid">21330290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gifford</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Ziller</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Donaghey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tsankov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Shishkin</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Issner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Coyne</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fostel</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Meldrim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional and epigenetic dynamics during specification of human embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>153</volume>
        <issue>5</issue>
        <fpage>1149</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2013.04.037</pub-id>
        <pub-id pub-id-type="pmid">23664763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsankov</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Akopian</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ziller</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Donaghey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Transcription factor binding dynamics during human ES cell differentiation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>518</volume>
        <issue>7539</issue>
        <fpage>344</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14233</pub-id>
        <pub-id pub-id-type="pmid">25693565</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eils</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schlesner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>18</issue>
        <fpage>2847</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw313</pub-id>
        <pub-id pub-id-type="pmid">27207943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">Ashuach T, Fischer DS, Kreimer A, Ahituv N, Theis FJ, Yosef N. MPRAnalyze. 2019. 10.18129/B9.bioc.MPRAnalyze. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/MPRAnalyze.html">https://bioconductor.org/packages/release/bioc/html/MPRAnalyze.html</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
