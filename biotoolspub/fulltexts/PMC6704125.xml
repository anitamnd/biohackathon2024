<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6704125</article-id>
    <article-id pub-id-type="publisher-id">48455</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-019-48455-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>High-speed device synchronization in optical microscopy with an open-source hardware control platform</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5397-8382</contrib-id>
        <name>
          <surname>Colville</surname>
          <given-names>Marshall J.</given-names>
        </name>
        <address>
          <email>mjc449@cornell.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2701-3114</contrib-id>
        <name>
          <surname>Park</surname>
          <given-names>Sangwoo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zipfel</surname>
          <given-names>Warren R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Paszek</surname>
          <given-names>Matthew J.</given-names>
        </name>
        <address>
          <email>mjp31@cornell.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution>Field of Biophysics, </institution><institution>Cornell University, </institution></institution-wrap>Ithaca, NY 14853 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution>Nancy E. and Peter C. Meinig School of Biomedical Engineering, </institution><institution>Cornell University, </institution></institution-wrap>Ithaca, NY 14853 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution>Robert Frederick Smith School of Chemical and Biomolecular Engineering, </institution><institution>Cornell University, </institution></institution-wrap>Ithaca, NY 14853 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution>Field of Biomedical Engineering, </institution><institution>Cornell University, </institution></institution-wrap>Ithaca, NY 14853 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936877X</institution-id><institution-id institution-id-type="GRID">grid.5386.8</institution-id><institution>Kavli Institute at Cornell for Nanoscale Science, </institution></institution-wrap>Ithaca, NY 14853 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>12188</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Azimuthal beam scanning eliminates the uneven excitation field arising from laser interference in through-objective total internal reflection fluorescence (TIRF) microscopy. The same principle can be applied to scanning angle interference microscopy (SAIM), where precision control of the scanned laser beam presents unique technical challenges for the builders of custom azimuthal scanning microscopes. Accurate synchronization between the instrument computer, beam scanning system and excitation source is required to collect high quality data and minimize sample damage in SAIM acquisitions. Drawing inspiration from open-source prototyping systems, like the Arduino microcontroller boards, we developed a new instrument control platform to be affordable, easily programmed, and broadly useful, but with integrated, precision analog circuitry and optimized firmware routines tailored to advanced microscopy. We show how the integration of waveform generation, multiplexed analog outputs, and native hardware triggers into a single central hub provides a versatile platform for performing fast circle-scanning acquisitions, including azimuthal scanning SAIM and multiangle TIRF. We also demonstrate how the low communication latency of our hardware platform can reduce image intensity and reconstruction artifacts arising from synchronization errors produced by software control. Our complete platform, including hardware design, firmware, API, and software, is available online for community-based development and collaboration.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Optical imaging</kwd>
      <kwd>Interference microscopy</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation (NSF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DGE-1650441</award-id>
        <award-id>1752226</award-id>
        <principal-award-recipient>
          <name>
            <surname>Colville</surname>
            <given-names>Marshall J.</given-names>
          </name>
          <name>
            <surname>Paszek</surname>
            <given-names>Matthew J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000057</institution-id>
            <institution>U.S. Department of Health &amp;amp; Human Services | NIH | National Institute of General Medical Sciences (NIGMS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2T32GM008267</award-id>
        <award-id>2T32GM008267</award-id>
        <principal-award-recipient>
          <name>
            <surname>Colville</surname>
            <given-names>Marshall J.</given-names>
          </name>
          <name>
            <surname>Paszek</surname>
            <given-names>Matthew J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000054</institution-id>
            <institution>U.S. Department of Health &amp;amp; Human Services | NIH | National Cancer Institute (NCI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R33-CA193043</award-id>
        <award-id>U54-CS210184</award-id>
        <principal-award-recipient>
          <name>
            <surname>Paszek</surname>
            <given-names>Matthew J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Modern imaging applications typically require the cooperative action of several independent devices, such as stages, filters, excitation modulators, and many others. Control of peripheral devices directly from the instrument computer requires independent connections, communication protocols and manufacturer-provided drivers and application programming interfaces (APIs). Integration of several peripherals in this way is technically challenging, and while software packages exist from both commercial and open-source<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> suppliers, they each have a limited set of supported devices. Moreover, the latency introduced by serial communications, the operating system (OS), application overhead and suboptimal API implementations can have a significant effect on synchronization accuracy. Because of these limitations, the time taken to update the experimental parameters across multiple peripherals can be much greater than the individual devices’ response times, limiting the effective acquisition speed and increasing the risk of synchronization errors that could cause artifacts in the collected data.</p>
    <p id="Par3">To overcome these challenges, hardware controllers centralize device control within a single unit, typically using digital triggers or analog voltages to step peripheral devices through a series of predefined states. Hardware controllers can decrease communications overhead and implementation complexity by eliminating serial communications during an experiment. For devices that support digital triggering or analog control, the update time is reduced to the controller’s response time, eliminating the additional delay of serial data transfer and decoding. A controller with sufficient speed and memory can have the entire acquisition sequence pre-programmed, allowing autonomous operation from the instrument computer, eliminating communication overhead and processing time delays at runtime.</p>
    <p id="Par4">Universal microcontroller breakout boards, such as the Arduino devices<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, have provided individuals and communities with a flexible platform to prototype and create interactive hobbyist-grade electronic devices. However, these controller platforms lack the appropriate I/O and optimizations to control many of the high precision, scientific-grade peripherals in state-of-the-art microscopes. General-purpose PC bus and USB data acquisition (DAQ) cards are popular alternatives that offer more powerful general-purpose I/O and system integration. However, they suffer the drawbacks of implementation complexity at hardware and software levels<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. While the underlying controller or DAQ may be general purpose, it is implemented and developed in a single, highly specialized application. Because of this the completed systems generally lack portability, limiting transferability and community support.</p>
    <p id="Par5">Here we describe an open-source instrument-control platform that is designed with flexibility, ease of adoption, performance, and cost in mind. Throughout the development of our device, we have committed to three major design principles: (1) the device should be hardware independent and support a wide range of peripherals, (2) the device should not limit data acquisition rate and (3) the device should be an open-source community resource. While the instrument controller is general purpose by design, specific I/O and routines have been included to provide a low-cost, high-performance solution for rapid peripheral device synchronization in advanced microscopes, including laser-scanning systems. We demonstrate the advantages of hardware control in a custom azimuthal beam scanning microscope by characterization of the effects of excitation quality and timing accuracy in a pair of complementary axial localization techniques: scanning angle interference microscopy (SAIM)<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup> and multiangle total internal reflection fluorescence microscopy (MA-TIRF)<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Controller design</title>
      <p id="Par6">To effectively provide a centralized hub we integrated both analog and digital functions on a single printed circuit board (PCB) (Fig. <xref rid="Fig1" ref-type="fig">1a,b</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>), simplifying connector wiring and providing protection against unwanted electrical interference. Our design further subdivided the analog circuitry into waveform generation (2x) by independent direct digital synthesizers (DDS), high-speed bipolar analog outputs (2x) with adjustable references, and a multiplexed 8-channel analog output (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>), allowing us to optimize the design of each subcircuit for its intended task. We incorporated full-speed USB connectivity, 8 digital I/O lines and a serial communication port in the hardware design. Given the high component and trace density required while considering cost and availability, we opted for a 4-layer PCB design with minimum 6 mil trace width and separation. This design could be affordably sourced, unpopulated, from many custom PCB manufacturers (i.e. OSH Park, 3 boards $197.90). Following the same reasoning we selected components for our design that were actively being produced and available from multiple suppliers (i.e. Digikey, complete component set $270.90 per board) in package sizes that could be placed and soldered by hand without the need for specialized equipment. We then populated the PCBs using basic surface mount and through-hole soldering tools such as a hot air rework station, soldering iron and tweezers, commonly available in most electronics labs. The completed, populated PCBs could be built by hand in around 6 hours apiece (~$200 and 2 additional hours of labor were required to assemble the enclosure and internal connectors). The PCB layout incorporated a 0.1 inch 6-pin header for connection to an in-circuit serial programmer and debugger (ICD-U64, Custom Computer Services Inc., $89), which facilitated rapid development of updates to the controller firmware.<fig id="Fig1"><label>Figure 1</label><caption><p>Hardware control integration facilitates the cooperation of a variety of peripheral devices. (<bold>a</bold>) Completed PCB assembly with key I/O features and dimensions. (<bold>b</bold>) Conceptual system topology wherein the microcontroller (MCU) acts as an intermediary between the instrument computer and multiple peripherals. (<bold>c</bold>) Timing waveforms from a maximum framerate acquisition sequence. The camera’s exposure acts as the timing signal to synchronize peripheral device updates in a typical circle-scanning experiment. The experiment was defined as a series of three repeating scan radii (mirror waveform amplitude) for each of two excitation wavelengths (Lasers 1 and 2).</p></caption><graphic xlink:href="41598_2019_48455_Fig1_HTML" id="d29e375"/></fig></p>
      <p id="Par7">For communications between the computer and instrument controller we utilized the microcontroller’s native full-speed universal serial bus (USB) human interface device (HID) protocol. This protocol was supported on all major computer operating systems (OS) and eliminated the need for OS-specific USB drivers, making the controller “plug and play”. A limitation of the full-speed USB HID protocol was the 64 kB/s bandwidth and 1 ms frame length. Even with higher frequency transfers in faster USB protocols (the high-speed USB standard operated on 0.125 ms microframes) there was no mechanism for synchronizing USB transfers with events coming from the peripheral devices such as the camera. The round-trip time for the controller to recognize a synchronization signal from a peripheral, notify the instrument computer via USB, wait for the computer to process the signal and respond to the controller with the appropriate action to take was too long for accurate synchronization. We addressed this issue by selecting a 16-bit PIC® microcontroller with 256 kB program memory and 96 kB RAM in our design, allowing us to load complex sequences of experimental parameters in the controller memory. In this way peripheral updates and simple processing tasks were done without the need for communication between the controller and the instrument computer, circumventing the synchronization limitations of the USB protocol.</p>
      <p id="Par8">The controller firmware was written to prioritize minimum latency for the most critical tasks such as shuttering. We built our hardware controller around a microcontroller to take advantage of its low cost, field reprogrammability, native interrupts, and chip-level integration of relevant functions, such as those for serial communications, counters, and parallel ports. One limitation of the 16-bit microcontroller used in our design was the relatively slow processor speed and low computational throughput. To address this, we offloaded calculations for acquisition sequences to the instrument computer. Prior to data acquisition the experimental parameters were uploaded to the controller, which ran as a finite-state machine during the experiment. The controller stepped through the experimental sequence using the microcontroller’s native interrupts triggered by the camera exposure, device triggers or internal timers (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Furthermore, we prioritized the allocation of parallel ports and internal serial communication hardware to minimize processor overhead wherever possible.</p>
      <p id="Par9">We found that for a typical experimental step, including waveform amplitude change, excitation shuttering and modulating 2 lasers, the total update time was on the order of 50 μs. For reference, the vertical shift time of our electron-multiplying CCD camera (EMCCD; Andor iXon 888 Ultra) was approximately 600 μs and the readout time of our scientific CMOS (sCMOS; Andor Zyla 4.2) was approximately 3.9 ms (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). Thus, the controller could synchronize several peripheral devices far faster than the dead time between exposures on a state-of-the-art microscope and was capable of handling complex, experimental sequences without limiting speed.</p>
    </sec>
    <sec id="Sec4">
      <title>Azimuthal beam scanning</title>
      <p id="Par10">Speckles and fringes caused by imperfections in the optical train, such as dust particles or internal reflections, are inherent to laser illumination<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The uneven excitation profile caused by these coherence artifacts is particularly noticeable in TIRF excitation and other widefield imaging techniques. While a variety of technologies have been developed to reduce or eliminate these artifacts<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>, azimuthal beam scanning, or “circle scanning,” has become an attractive solution to reduce the effects of interference fringes and speckle artifacts in fluorescence microscopy<sup><xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup>. Therefore, we incorporated several laser-scanning routines into our controller and demonstrated how a super-resolution azimuthal beam scanning microscope could be built around our open-source control platform (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>).<fig id="Fig2"><label>Figure 2</label><caption><p>Circle scanning microscope design with hardware control. (<bold>a</bold>) Schematic illustration of the key components of the circle scanning microscope. DC1-DC3: Laser combining dichroic mirrors. AOTF: Acousto-optic tunable filter. Polarizer: m = 1 vortex half-wave retarder. DC4: Quad bandpass dichroic. Additional components omitted for clarity. (<bold>b</bold>) Conceptual diagram of the circle scanning optics. <italic>f</italic><sub>sl</sub>: Scan lens focal length. <italic>f</italic><sub>bfp</sub>: Objective lens rear focal length. <italic>f</italic><sub>s</sub>: Objective lens front focal length. (<bold>c</bold>) Scan mirror command signals and laser pattern on the objective rear focal plane. Static beam: the laser parked at a single location on the objective back focal plane by applying a constant voltage to the galvanometer-mounted mirrors. Discrete scan: the mirrors drive the beam through 32 points approximating a circle in the objective back focal plane. Circle scan: the mirrors are driven with sinusoidal voltages scanning the beam in a continuous circle.</p></caption><graphic xlink:href="41598_2019_48455_Fig2_HTML" id="d29e447"/></fig></p>
      <p id="Par11">In our microscope, the controller formed a central hub, synchronizing the cooperative actions of the laser-scanning mirrors, acousto-optic tunable filter (AOTF), sCMOS camera and other devices (mechanical shutter, EMCCD etc., Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). The scanning mirrors’ angular deflections were controlled by the dual waveform outputs of our controller. The scanning mirrors’ apparent center of rotation was positioned in the objective’s conjugate image plane so that the excitation beam location remained static in the sample plane regardless of the azimuthal or axial angle (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). This configuration of the optical system produced a homogeneous excitation field by scanning many azimuthal angles within a single camera frame, with the effective profile being the average across the azimuthal angles in each exposure. The sCMOS fire-all and EMCCD exposure outputs were both connected to one of the controller’s digital I/O ports, which was configured as an external interrupt for acquisition synchronization. Using the cameras’ exposure signal allowed precise shuttering by the AOTF, only exciting the sample during the sensor active time. Additionally, peripheral updates, such as changing the scan radius or excitation wavelength, were begun immediately at the end of an exposure, ensuring the system had enough settling time before the beginning of the next exposure without adding additional delays between frames (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>).</p>
      <p id="Par12">In an azimuthal scanning microscope, the excitation laser must be steered about the optical axis such that its position describes a circle in the objective lens’ back focal plane. This can be accomplished by a variety of beam steering methods including crossed acousto-optic deflectors<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, deformable micromirror devices<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, and motorized mirrors<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. We noted that circular scans could be approximated with a discrete set of points (discrete scan, Fig. <xref rid="Fig2" ref-type="fig">2c</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>) lying along a circle. However, for mechanical beam steering mirrors with finite maximum accelerations, we found that our galvanometer-driven mirrors were unable to follow the command signal perfectly. When we used a 32-point circle approximation, the mirror momentum resulted in oscillations about each point, decreasing the precision with which the axial incidence angle at the sample could be controlled (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par13">As an alternative strategy, we used the integrated waveform generators of our control platform to drive the mirrors with a pair of sine waves with a π/2 phase offset (circle scan, Fig. <xref rid="Fig2" ref-type="fig">2c</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). With this approach the mirrors remained settled on the circle and in constant motion, which eliminated the noise associated with starting and stopping at each point in a discreet scan (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par14">Utilizing the integrated waveform generators in circle scanning mode, we investigated the improvements that could be gained through circle scanning in SAIM experiments to minimize laser-induced interference artifacts. SAIM is a surface-generated interference localization microscopy technique that measures the pixelwise average axial position of fluorescent probes with better than 10 nm precision. SAIM samples were prepared on a reflective silicon wafer with a defined layer of thermal oxide to act as a transparent spacer (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). When illuminated with a coherent light source, the direct and reflected excitation created an axial interference pattern with a characteristic spatial frequency that depended on the axial angle of incidence<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. A series of images at known axial incidence angles were acquired and fit pixelwise to an optical model that predicted the observed fluorescence intensity fluctuations as a function of axial position (height) above the SiO<sub>2</sub>/water interface (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Previous SAIM implementations utilized a static beam excitation scheme<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, the simplest method to implement on a commercial microscope.<fig id="Fig3"><label>Figure 3</label><caption><p>Azimuthal beam scanning reduces incidence angle dependent laser artifacts in scanning angle interference microscopy (SAIM) imaging. (<bold>a</bold>) Schematic illustration of SAIM. Samples were prepared on reflective silicon substrates with a defined oxide layer of thickness <italic>d</italic> and excited with a laser at incidence angle <italic>θ</italic> to generate an axial interference pattern with known spatial frequency. The measured fluorescence intensity at distance from the substrate <italic>H</italic> varies with <italic>θ</italic> for a supported lipid bilayer (SLB) labeled with DiI. (<bold>b</bold>) Example single-pixel raw data (orange dots) and best-fit curve. (<bold>c</bold>) Reconstructed SLB height maps with circle scanning or static beam excitation schemes (full image 147.9 × 147.9 μm). (<bold>d</bold>) Pooled DiI height distributions in SLBs acquired with static beam and circle scanning excitation schemes (n = 5 regions, 4.2 × 10<sup>6</sup> pixels per region). (<bold>e</bold>) Quantification of the average fit parameters in circle scanning and static beam SAIM imaging of the 5 lipid bilayer regions in <bold>d</bold>. Red lines indicate mean, boxes the central quartiles, whiskers min and max. (<bold>f</bold>) Widefield and circle scanning SAIM height reconstructions of a live HeLa cell expressing the focal adhesion components mEmerald-Zyxin and mCherry-Paxillin, scale bars 25 μm. (<bold>g</bold>) Enlarged view of the region boxed in <bold>f</bold>. The colored images represent pixel-by-pixel SAIM height reconstructions of mEmerald-Zyxin or mCherry-Paxillin as noted, scale bars 5 μm. A static beam reconstruction of zyxin height is included for comparison. (<bold>h</bold>) Distribution of pixelwise height fits from adhesion complexes in <bold>g</bold>. Heights are the average of all non-zero fits. (<bold>i</bold>) Plots of fluorescence intensity as a function of scan angle for the static and circle scanning Zyxin images in g. Colored lines indicate the same 10 representative pixels from each image, black lines the average of all 10 pixels.</p></caption><graphic xlink:href="41598_2019_48455_Fig3_HTML" id="d29e584"/></fig></p>
      <p id="Par15">We hypothesized that circle scanning SAIM would remove the pixelwise, frame-to-frame variations in the excitation intensity arising from speckle and fringe artifacts in a static beam system that degrade the accuracy of axial position reconstructions. To illustrate the advantages of circle scanning over static beam excitation in SAIM experiments, we used our microscope to image supported lipid bilayers (SLBs) labeled with DiI using either a static beam or circle scanning excitation scheme. The bilayer topography from static beam reconstructions showed local topographical variations of several nanometers that were not present in circle scanning reconstructions (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). When multiple, independent regions of the samples were imaged, we found that the same topographical patterns emerged, indicating that the excitation artifacts caused erroneous height estimations in the analysis (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). Figure <xref rid="Fig3" ref-type="fig">3d</xref> shows the height distributions from the combined results of 5 bilayer regions with average heights of 10.2 ± 3.46 nm and 8.72 ± 3.10 nm for the static beam and circle scanning experiments, respectively. To verify that the samples were equivalent in terms of labeling density and bilayer continuity we examined the fluorescence intensity maps (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). Based on a visual inspection, the height reconstructions in both cases were independent of variations in label density or bilayer defects. The average of 5 height reconstructions showed the topographical variations seen in the static beam experiments were consistent across multiple regions unlike the circle scanning experiments, indicating that they were systematic and did not reflect the sample topography (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). This led us to conclude that the topography observed in the static beam experiments was a consequence of laser excitation artifacts that are mitigated by circle scanning. The improvement in the quality of the raw data was reflected in the more consistent average intensity across image sets and higher average R<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> value from the reconstructions (Fig. <xref rid="Fig3" ref-type="fig">3e</xref>). Finally, circle scanning resulted in a greater than 5-fold increase in the average signal to noise ratio (S/N) across the experiments, a direct consequence of eliminating the incidence angle dependent laser artifacts.</p>
      <p id="Par16">When imaging biological samples, such as live cells, high background fluorescence, local variations of the sample’s optical properties caused by intracellular structures and dynamic processes conspire to disrupt the ideal axial interference pattern. While these properties cannot be eliminated, as they are intrinsic to the sample, optimizing instrument performance could possibly mitigate their effects. To demonstrate the advantages of circle scanning in a biologically relevant context, we imaged live HeLa cells expressing the focal adhesion proteins mEmerald-zyxin and mCherry-paxillin (Fig. <xref rid="Fig3" ref-type="fig">3f</xref>). We noted that paxillin and zyxin could serve as axial measuring sticks as their height distributions are well known from several sources<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. The widefield image in Fig. <xref rid="Fig3" ref-type="fig">3f</xref> highlights the background fluorescence in a typical live-cell sample. Because SAIM illuminated throughout the sample volume, the fluorescence from diffuse pools of free probes within the sample contributed to the observed intensity at each incidence angle. For bright, discrete structures, such as focal adhesions on the cell periphery, the intensity fluctuations of the background were typically much smaller than the signal magnitude and robust localization was possible. With dim structures or in regions with no structure, fluctuations in the background, such as those arising from laser excitation artifacts, could be erroneously identified as real structures in the reconstruction. In the magnified view of the cell’s leading edge (Fig. <xref rid="Fig3" ref-type="fig">3g</xref>), the widefield image showed several adhesion complexes on the periphery of the cell and a typical inhomogeneous background away from the cell’s edge. The laser artifacts in the static beam case resulted in the artifactual appearance of structures that were not visible in the widefield image. The circle scanning reconstructions were free of these errors and better matched the focal adhesions from the widefield image. Both circle scanning and static beam reconstructions of zyxin showed similar distributions in height of 86.4 ± 8.17 nm and 83.1 ± 7.69 nm, respectively, as expected (Fig. <xref rid="Fig3" ref-type="fig">3h</xref>). Inspecting the pixelwise raw data demonstrated the improved S/N and reduction in outlier data points at high incidence angles where laser illumination artifacts are particularly problematic (Fig. <xref rid="Fig3" ref-type="fig">3i</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Accuracy of peripheral device synchronization in hardware versus software control</title>
      <p id="Par17">Another potential source of error in SAIM and other techniques that make frame-to-frame intensity comparisons challenging is variation in the excitation dose. Excitation shuttering minimizes photobleaching and phototoxicity in living samples, reducing the total light dose to the minimum required for the experiment. However, the excitation shutter must be accurately synchronized with the camera exposure. Variations in shutter/camera synchronization between frames are reflected in the observed fluorescence intensity, leading to localization artifacts. This effect is particularly problematic when using sCMOS cameras with rolling shutters where the beginning of exposure and readout are done by pixel rows<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Shuttering partway through the exposure/readout cycle results in the over exposure of some rows, while exposure throughout the exposure/readout cycle can lead to spatial distortion of fast-moving objects. sCMOS cameras can be run in a simulated global shutter mode wherein the excitation exposure is begun once all pixel rows are exposing and ended when the first row begins to readout (i.e. “fire-all” mode).</p>
      <p id="Par18">We considered that the roundtrip communication travel time from camera to computer to AOTF and the variable latency inherent in software control schemes could limit the precision of shutter synchronization. We collected 500 frames of a homogeneous fluorescent monolayer with either software control or hardware control to illustrate the effects of synchronization errors with a sCMOS camera (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). From the pixel column kymograph, with software control the upper pixel rows were relatively underexposed compared to the center pixel row. Under hardware control this effect was reduced, and a more even fluorescence intensity pattern was observed. Timing variability had the greatest effect on the last rows to be exposed or readout (those furthest from the center of the sensor in a center-out readout configuration, Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). The center row (dashed lines in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>) showed little difference between software and hardware control schemes while the top row (solid lines) had a lower average value and greatly increased noise under software control when compared to hardware control (Fig. <xref rid="Fig4" ref-type="fig">4a,b</xref>). To quantify the synchronization errors, we placed a fast photomultiplier tube directly in the excitation path of our microscope (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). With software synchronization, we measured an average −12.34 ± 0.9943 ms and 2.714 ± 1.236 ms delay between the beginning or end of exposure, respectively, and shutter operation. On the other hand, when the camera’s fire-all signal was used to trigger the excitation shutter through our hardware controller, we achieved a 3 order of magnitude improvement in synchronization latency (12.73 ± 12.80 μs and 10.59 ± 1.552 μs start and end of exposure, respectively, Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). Although the hardware controller does introduce an additional delay in signal transmission, we found this to be on the order of 25% of the total time difference between the trigger signal and the effective shuttering time (Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>). With careful calibration the average delay under software control could be reduced. However, the variability due to communications and software overhead were intrinsic and could not be easily accounted for. It is important to note that a suboptimal or incorrect implementation of hardware control could introduce the same or even greater errors in synchronization than software control. Similarly, highly optimized software implementations could approach the minimum latency introduced by the device communication protocol but cannot overcome this fundamental limit.<fig id="Fig4"><label>Figure 4</label><caption><p>Hardware based synchronization minimizes latency-induced artifacts in SAIM. (<bold>a</bold>) Top: fluorescence kymographs of the top half of the center pixel column of an sCMOS camera imaging a homogeneous dye monolayer. Bottom: Full sensor single frame images from the same acquisition sequence. (<bold>b</bold>) Plot of average row intensities (2048 pixels) from the series in <bold>a</bold>. Dashed lines represent the center pixel row, solid lines the top pixel row. (<bold>c</bold>) Distribution of excitation shutter delays at the start of frame (SOF) and end of frame (EOF) relative to the camera’s exposure signal over 50 frames. Lines represent the average of 50 frames, boxes the center quartiles and whiskers the minimum and maximum values. (<bold>d</bold>–<bold>f</bold>) Lipid bilayer height, fluorescence intensity and signal-to-noise ratio in SAIM reconstructions from image sets acquired with software or hardware synchronization. (<bold>g</bold>) Standard deviation from SAIM reconstructions of lipid bilayer height. Each of 6 equivalent regions of the sample were imaged first with hardware synchronization and then immediately after with software synchronization. The horizontal bands in the software image follow the center-out readout pattern of the sCMOS camera. (<bold>h</bold>–<bold>j</bold>) Lipid bilayer height distributions in SAIM reconstructions vs. fluorescence intensity, coefficient of determination and signal-to-noise ratio with the excitation under software (top row) or hardware (bottom row) control. Images in <bold>a</bold> and <bold>d</bold>–<bold>g</bold> reflect the full sensor area of 2048 × 2048 pixels, corresponding to a 147.9 × 147.9 μm field of view. Data in <bold>a</bold> and <bold>b</bold> were normalized to the average intensity in the first exposure for comparison.</p></caption><graphic xlink:href="41598_2019_48455_Fig4_HTML" id="d29e729"/></fig></p>
      <p id="Par19">Considering these results, we hypothesized that the increased precision of hardware synchronization would result in a higher S/N and better localization precision in SAIM. To make a direct comparison between software and hardware synchronization, we imaged SLBs first with software synchronization and then, without moving the sample, with hardware synchronization at the same excitation intensity and over the same range of angles, such that an identical observation of the sample was made. The height reconstructions of SLBs (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>) acquired with software synchronization demonstrated a strong dependence of fitted height on distance from the center of the sensor which was not reflected in the hardware synchronization acquisitions. The fitted fluorescence intensity profile (Fig. <xref rid="Fig4" ref-type="fig">4e</xref>) was closely matched with both synchronization schemes. The hardware acquisition sequences had a lower average intensity, which was expected given the shorter overall excitation time (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). The S/N from the reconstructions with software synchronization showed a high S/N band in the region around the center of the detector that decays toward the top and bottom of the image compared to the hardware synchronization acquisition where the S/N closely followed the excitation intensity profile, as expected (Fig. <xref rid="Fig4" ref-type="fig">4f</xref>). Using the standard deviation in height over several independent SLB regions as a metric for localization precision, we found that the sensor readout pattern was reflected in the localization precision with software synchronization and not with hardware synchronization (Fig. <xref rid="Fig4" ref-type="fig">4g</xref>). Owing to the large sensor size in the sCMOS camera, the excitation profile was not perfectly flat across the field of view, which could make interpretation of the reconstructions difficult. To understand the effects of synchronization errors, we examined the height distributions as a function of intensity, coefficient of determination (R<sup>2</sup>, a measure of goodness of fit) and S/N (Fig. <xref rid="Fig4" ref-type="fig">4h–j</xref>). In the case of software synchronization, the reconstructed heights showed a strong dependence on the fluorescence intensity with higher intensity corresponding to larger height values. A similar trend was observed for both R<sup>2</sup> and S/N. With hardware synchronization, the reported height was independent of intensity and similar distributions were seen for both R<sup>2</sup> and S/N.</p>
    </sec>
    <sec id="Sec6">
      <title>MA-TIRF</title>
      <p id="Par20">To demonstrate some of the versatility of our hardware control platform, we performed MA-TIRF imaging experiments utilizing the same hardware and sequencing functions used in SAIM experiments. Like SAIM, MA-TIRF achieves axial localization of fluorescent probes by reconstruction from multiple independent images. When the excitation incidence angle at the coverslip to sample interface is beyond the critical angle, θ<sub>c</sub>, total internal reflection occurs, and the excitation potential is confined to a thin evanescent field within a few hundred nanometers of the interface. The exponential decay of the evanescent field depends on the angle of incidence and is characterized by the penetration depth, which decreases with angle of incidence<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. In an MA-TIRF experiment the excitation incidence is swept through a range of angles greater than the critical angle and individual images are acquired at each step (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>).<fig id="Fig5"><label>Figure 5</label><caption><p>Implementation of circle scanning multiangle TIRF (MA-TIRF). (<bold>a</bold>) Concept of MA-TIRF. Top: The evanescent excitation field intensity (solid lines) as a function of height above the glass-liquid interface and penetration depth (dashed lines) for various angles of incidence. Lower left: Schematic representation of fluorescent probes (red dots) at 300, 200 and 100 nm (3, 2 and 1, respectively) from the glass-liquid interface. Lower right: Theoretical intensity profiles as a function of angle of incidence for the 3 fluorescent probes. (<bold>b</bold>) Widefield and height reconstructions of phalloidin-AF560 and mEmerald-Zyxin in a fixed HeLa cell. Scale bars 25 μm. (<bold>c</bold>) Enlarged view of the leading edge of the cell in <bold>b</bold>. Scale bars 5 μm. (<bold>d</bold>) Reconstructed actin height profile (solid black line, red box in <bold>c</bold>) and zyxin height distribution (green bars, non-zero fits from <bold>c</bold>).</p></caption><graphic xlink:href="41598_2019_48455_Fig5_HTML" id="d29e805"/></fig></p>
      <p id="Par21">As a test subject, we imaged actin stress fibers, which are involved in adhesion-based motility and are required for maintenance of focal adhesion complexes. The ubiquity of actin fibers throughout cells complicates methods, such as SAIM, that lack optical sectioning. The thin evanescent excitation field in MA-TIRF rendered the ventral stress fibers clearly visible. We also imaged zyxin, which is known to interact with actin in the upper layers of focal adhesions where the mechanical coupling between the cytoskeleton and adhesion machinery occurs. Simultaneous imaging of actin and zyxin highlighted MA-TIRF’s ability to resolve stress fiber profiles (Fig. <xref rid="Fig5" ref-type="fig">5b,c</xref>). Compared to SAIM, MA-TIRF returned a similar average zyxin height in adhesion complexes (93.3 nm) but a broader standard deviation (19.9 nm vs. 8.17 nm for circle scanning SAIM). Using MA-TIRF we were able to visualize the height profile along actin stress fibers (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>) originating in adhesion zones as determined by zyxin enrichment. We found that in the zyxin-rich regions the stress fiber height matches the average zyxin height but increased with distance from the zyxin end. The ability to perform both SAIM and MA-TIRF experiments on the same microscope platform demonstrated the ability of our hardware controller to adapt existing infrastructure for new applications.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par22">High-speed synchronization of multiple devices has become a necessity in modern microscope systems and can be a complicated barrier for researchers who need to build or customize microscopes for specific imaging tasks. The two common approaches to peripheral integration are through software packages or dedicated hardware controllers. Software is typically the simplest path to system integration, but generally limits the available hardware pool to a list of supported devices. In some cases, such as with the open-source Micro-Manager<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> microscopy software, unsupported devices can be added by writing new device adapters. Doing so requires familiarity with the specific programming languages used, the device and software APIs and in some cases the operating system architecture. Furthermore, inefficient or improper implementations can limit performance and affect data quality. As we have shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, even in the case of a stable and widely used software package, limitations imposed by the communication protocol’s speed and intricacies can limit the synchronization precision of multiple devices. With the rapid progress of image processing technology, online and real-time analysis are being applied in many fields, such as imaging flow cytometery<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, presenting even greater challenges in device synchronization. While microcontrollers may lack the computational resources for high-throughput data processing, they can provide precise device synchronization by limiting the need for high-latency, non-deterministic communication between multiple peripherals. For example, a single USB transaction between the host computer and a microcontroller can be reliably used to trigger multiple peripheral updates within a few microseconds of the controller receiving the transmission.</p>
    <p id="Par23">Hardware device synchronization can overcome many of the limitations imposed by software. We demonstrated this for the example case of camera and AOTF timing wherein the excitation is shuttered in concert with the camera’s actual exposure. A naïve solution would be to avoid shuttering the excitation at the cost of increased excitation dose, photobleaching and phototoxicity. The greater the interframe interval the more pronounced each of these effects becomes, making it infeasible for time-course experiments with significant delays between frames. Under software control, and with shuttering, we observed timing differences of 10 or more milliseconds between the exposure and shuttering. If synchronization differences are consistent they can be accounted for in software by adding a delay between the slow and fast devices. In the case we have presented, latency between camera and AOTF events had variabilities on the order of milliseconds, and a simple delay would not suffice. Under hardware control we were able to achieve precise and consistent synchronization regardless of the framerate</p>
    <p id="Par24">We have used lipid bilayers to demonstrate that small variances in the timing between excitation and exposure can decrease the accuracy and precision of SAIM experiments. SLBs formed by fusion of small unilamellar vesicles make an ideal test sample with known properties (e.g. thickness, index of refraction, structure), are easily labeled with a variety of dies and have extremely low background fluorescence. The SLB experiments illustrate the importance of frame-to-frame consistency in maximizing the precision of SAIM localizations. Inconsistent illumination caused by interference at the sample (laser fringes and speckles) has the same effect as inconsistent timing on SAIM experiments. Although the causes are different, the result is that on a pixelwise basis, the instrument is causing additional intensity variations that obscure the predicted intensity variations in the raw data. In this study we chose not to use a set of background or correction images in any experiment. We found that the combined circle scanning and hardware synchronization approach eliminated the need for preprocessing the data with correction images.</p>
    <p id="Par25">Resolution of fast biological processes places additional constraints on the imaging system, and the effective time resolution is limited to the elapsed time to acquire the complete image series for a range of scan angles. Ultimately, this limit is set by the camera framerate plus any delay associated with changing the excitation angle or wavelength. In a typical circle scanning SAIM experiment we acquire between 16 and 32 images over the incidence angle series. The exact number of images is determined empirically at the time of the experiment based on balancing acquisition time with data quality. Our hardware controller allows acquisition at the camera framerate, that is there is no additional delay added and all devices are updated during readout. Under these conditions the effective time resolution is the number of frames per acquisition multiplied by the exposure period. For instruments with slower peripheral devices (i.e. motorized TIRF prisms), or under software control, an adequate delay between frames must be added while the system reaches the new stable point for the next camera frame. Motion of the sample between the first and last frames of a SAIM or MA-TIRF sequence will introduce additional errors in the reconstruction because a pixel in the first frame is not mapped to the same sample location in subsequent frames in the angle series. It follows that the time between the first exposure and last exposure in a set of incidence angles should be less than the time it takes the sample to move by one pixel. This condition can be difficult to satisfy but hardware control maximizes the achievable acquisition rate, providing a more accurate multi-frame snapshot in SAIM and MA-TIRF experiments (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>, Supplementary Videos <xref rid="MOESM3" ref-type="media">2</xref>,<xref rid="MOESM4" ref-type="media">3</xref>).</p>
    <p id="Par26">The concept of a general-purpose scientific instrument controller is not unique to this project and several examples exist, some as commercial products. One open source instrumentation project like what we have reported is the Pulse Pal<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> signal generator (Sanworks, $745 at the time of writing), which features 4 independent +/−  10 V waveform outputs and 2 trigger inputs. While Pulse Pal could be used for driving the scanning system, additional hardware would be required to integrate multichannel excitation control and shuttering. Another open-source example is the FlyPi, a multifunctional microscopy project (project costs range between ~$100 and ~$250 depending on the number of additional modules the user incorporates)<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The FlyPi utilizes a Raspberry Pi computer for data acquisition and experiment control and an external Arduino microcontroller to control the microscope peripherals such as stage, temperature, illumination and others. While similar in approach, the FlyPi is a complete microscope solution designed for accessibility whereas our instrument controller is designed to offer high-precision, high speed peripheral integration in advanced system development. Outside of dedicated microscopy systems, there are many examples, such as the general purpose instrument STEMlab™ hardware platform (Red Pitaya, ~$290 at the time of writing) which features 2 radio frequency (RF) inputs, 2 RF outputs, 16 digital I/O signals and 4 additional low speed analog outputs as well as significant computational resources due to its integrated FPGA and dual core CPU. The hardware is limited, though, to +/−1 V for the RF outputs and 0–1.8 V for the analog outputs, requiring additional, custom amplification stages to interface with many devices. Furthermore, while the software is open source, the hardware is not. Many non-open source solutions are available such as the Triggerscope 16 (Advanced Research Consulting, $1499 at the time of writing), which features 16 0-10 V analog outputs, 16 TTL outputs and sequencing capabilities of up to 60 steps. Other popular options are the DAQ solutions offered by National Instruments, which range in cost from ~$200 to more than $6000, with cards providing 4 analog outputs, 48 digital I/Os and USB connectivity beginning at ~$1100. While these boards arguably offer greater flexibility and standardization than our controller, they do not have the same level of microscopy-specific optimization or integration of design, requiring additional effort in development. For comparison, a researcher wishing to build a copy of our controller as reported here could do so for ~$525 (we have included a bill of materials in the project repository including part numbers and suppliers) and 8 hours of labor with access to basic surface mount soldering and test equipment found in most electronics labs.</p>
    <p id="Par27">There are many forms of hardware control that have been used in microscopy from plugin extension PCBs for universal microcontroller platforms to commercial field programmable gate array boards to custom embedded electronics platforms covering a broad range of cost, complexity and flexibility. We have sought to create a broadly useful platform that is economical and easy to integrate. The open-source model used by Micro-Manager has greatly contributed to the success of the project and we seek to emulate their example by making all design and source code freely available<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>. We have made all levels of the project from hardware to driver API and user interface software open-source. This will allow us to capitalize on the skills and feedback of users and create a community of contributors, distributing the cost of further development based on the framework presented here. While we have demonstrated the utility of our controller in a single, circle scanning instrument, the control platform we have developed has a broad range of applications including laser-scanning confocal or two photon microscopies, imaging cytometry, microfluidic systems and spectroscopy to name a few. Through continuing, community-driven development of the project we envision our hardware as a valuable resource for general scientific device control.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Preparation of supported lipid bilayers</title>
      <p id="Par28">A chloroform solution of 1-palmitoyl-2-oleoyl-glycero-3-phosphocholine with 0.1 mole percent 1,2-dipalmitoyl-sn-glycero-3-phosphoethanolamine-N-(cap biotinyl) (Avanti Polar Lipids) was dried first under a stream of nitrogen and then under vacuum to remove the solvent. The resulting film was dissolved to 1 mg/mL in PBS pH 7.4 at 37 °C with extensive vortexing and freeze-thawed 7x by cycling between liquid nitrogen and 37 °C baths. The lipid suspension was then extruded 13x through double stacked 100 nm polycarbonate membranes (Whatman) to yield small unilamellar vesicles (SUVs). SUVs prepared in this way were stored at 4 °C and used within 2 weeks. Silicon wafers with ~1900 nm thermal oxide (Addison Engineering) were diced into 1 cm<sup>2</sup> chips, and the oxide layer thickness for each chip was measured with a FilMetrics F50-EXR. The chips were then cleaned in piranha solution (30 volume % hydrogen peroxide in sulfuric acid), rinsed extensively and stored in deionized water until use. SLBs were formed by incubating the cleaned silicon chips in the SUV solution for 1 hour, and then rinsed with PBS, incubated with 1.75 μM DiIC<sub>18</sub> for 30 minutes, and rinsed again with PBS. The samples were then inverted into a 35 mm glass-bottom imaging dish (MatTek) containing PBS and immediately imaged.</p>
    </sec>
    <sec id="Sec10">
      <title>Preparation of HeLa cell samples</title>
      <p id="Par29">The plasmids mEmerald-Zyxin-6 (Addgene plasmid # 54319; <ext-link ext-link-type="uri" xlink:href="http://n2t.net/addgene:54319">http://n2t.net/addgene:54319</ext-link>; RRID: Addgene_54319) and mCherry-Paxillin-22 (Addgene plasmid # 55114; <ext-link ext-link-type="uri" xlink:href="http://n2t.net/addgene:55114">http://n2t.net/addgene:55114</ext-link>; RRID: Addgene_55114) were a gift from Michael Davidson. HeLa cells (ATCC CCL-2) were cultured in Dulbecco’s Modified Eagle Medium (ThermoFisher) supplemented with 10% fetal bovine serum (ThermoFisher) and 100 U/mL penicillin-streptomycin (ThermoFisher) at 37 °C and 5% CO<sub>2</sub>.</p>
      <p id="Par30">For SAIM experiments, silicon chips were prepared as for SLBs except the chips were sonicated for 15 mins in acetone, 15 minutes in 1 M NaOH and UV sterilized in place of the piranha cleaning. Cells were seeded onto the chips at 2 × 10<sup>4</sup> cm<sup>−2</sup> in full culture medium and incubated overnight. Cells were transfected with 1:1 mEmerald-Zyxin-6 to mCherry-Paxillin-22 using Lipofectamine 3000 (ThermoFisher) per the manufacturer’s protocol and allowed to grow for 24 hours. Sample were then rinsed 3x in PBS, inverted into a 35 mm glass-bottom imaging dish containing HEPES-Tyrode’s (119 mM NaCl, 5 mM KCl, 25 mM HEPES buffer, 2 mM CaCl<sub>2</sub>, 2 mM MgCl<sub>2</sub>, 6 g/L glucose, pH 7.4) and imaged at 37 °C.</p>
      <p id="Par31">For MA-TIRF experiments, cells were seeded at 2 × 10<sup>4</sup> cm<sup>−2</sup> directly into 35 mm glass-bottom imaging dishes and incubated overnight to allow attachment. Samples were then transfected with mEmerald-Zyxin-6 as before and incubated an additional 24 hours. Following incubation, the samples were rinsed with PBS and fixed in 4% formaldehyde in PBS for 10 minutes, rinsed 3 additional times and permeabilized with 0.1% v/v Triton X-100 in PBS for 10 minutes. The solution was then aspirated, and the sample was incubated for 1 hour at room temperature with Alexa Fluor™ 568 Phalloidin (ThermoFisher) diluted to 1 U/mL in PBS with 1% bovine serum albumin (ThermoFisher). Samples were then rinsed 3 times in PBS and imaged immediately.</p>
    </sec>
    <sec id="Sec11">
      <title>Controller design</title>
      <p id="Par32">Full details on the controller design are included in Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM1" ref-type="media">3</xref>. Briefly, the analog subcircuits were designed and simulated using CircuitLab<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. The controller PCB layout was made using EAGLE (Autodesk). Printed circuit boards were ordered unpopulated from OSH Park. The components were purchased from Digi-Key and then hand assembled. Firmware was written in the C programming language, compiled and debugged with C-Aware IDE (Custom Computer Service Inc.). Host-side driver and GUI software was written in C++ with Visual Studio 2017 (Microsoft) using the Qt<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> framework, HIDAPI<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, boost C++ <sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, and OpenCV libraries<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>.</p>
    </sec>
    <sec id="Sec12">
      <title>Microscope design</title>
      <p id="Par33">The circle scanning microscope was built on a Nikon Ti-E inverted fluorescence microscope. The 405 nm (Power Technology Inc.), 488 nm (Coherent), and 560 nm (MPB Communications Inc.) lasers were combined with the 642 nm (MPB Communications Inc.) to make a colinear beam by a series of dichroic mirrors (Chroma). The combined output beam was attenuated and shuttered by an AOTF (AA Opto-Electronic) before being directed onto the galvanometer scanning mirrors (Cambridge Technology). The image of the laser on the scanning mirrors was magnified and relayed to the sample by 2 4 <italic>f</italic> lens systems, the beam expanding telescope and the scan lens / objective lens combination. The beam expander is formed by <italic>f</italic> = 30 mm and <italic>f</italic> = 300 mm achromatic lenses with an m = 1 zero-order vortex half-wave plate positioned between them and positioned 2 <italic>f</italic> from the 300 mm achromatic scan lens (Thorlabs). SAIM experiments were performed with a 60x N.A. 1.27 water immersion objective, and MA-TIRF with a 60x N.A. 1.49 oil immersion objective lens (Nikon). Fluorescence emission was collected with a quad band filter cube and single band filters (TRF89901-EMv2, Chroma) mounted in a motorized filter wheel (Sutter). For both SAIM and MA-TIRF experiments, images were acquired with a Zyla 4.2 sCMOS (Andor) camera using the microscope’s 1.5x magnifier for a total magnification of 90×. In all experiments the open source software Micro-Manager<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> was used for camera and filter wheel control and image acquistion. For timing data with software control the AOTF driver hardware was disconnected from the hardware controller and connected to the instrument computer via USB. The AOTF was added to the micromanager configuration utilizing the AA AOTF device adapter written by Erwin Peterman and supplied with the software. A single AA AOTF device was added to the hardware configuration to avoid potential delays associated with using multiple channels. Details on excitation incidence angle calibration are given in Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>Timing data acquisition</title>
      <p id="Par34">Timing data acquired with the EMCCD camera was done with frame transfer and electron multiplying gain enabled. The sCMOS camera auxiliary output was configured for “fire all” mode. In both cases the camera fire output was connected to the hardware controller through a BNC “T” connector. The other side of the “T” was connected to a digital oscilloscope (MSO2014B, Tektronix) and single shot acquisitions were acquired triggered by the rising edge of the camera fire signal. A fast photomultiplier tube (Hammamatsu) was placed directly in the excitation path immediately after the AOTF and the amplifier output connected to the oscilloscope. Automatic shuttering was enabled in either Micro-Manager (software control) or via the hardware controller (hardware control) and single exposures were initiated with the “Snap” function.</p>
    </sec>
    <sec id="Sec14">
      <title>SAIM</title>
      <p id="Par35">For static beam SAIM experiments, a series of 31 images were acquired at evenly spaced incidence angles from −45.8 to 43.9 degrees. For circle scanning experiments, 32 images were acquired at evenly spaced intervals from 0 to 30 degrees in the case of live cells or 0 to 45 degrees in the case of SLBs. Angle ranges are given with respect to the wafer normal in the imaging media (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). The raw images were fit pixelwise without further preprocessing using a custom analysis program written by the authors (Supplementary Note <xref rid="MOESM1" ref-type="media">5</xref>) to obtain the reconstructed height topography of the samples. Images were postprocessed with Fiji<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> and statistical analysis was performed in MATLAB (MathWorks) and Prism (GraphPad).</p>
    </sec>
    <sec id="Sec15">
      <title>MA-TIRF</title>
      <p id="Par36">For MA-TIRF experiments, a series of 20 images were acquired from 61.5 degrees to 65.3 at intervals of 0.2 degrees with respect to the excitation angle of incidence in the coverslip at the glass to water interface. The galvanometer command amplitude corresponding to the critical angle was experimentally confirmed using the fluorescence intensity of a dye monolayer<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. MA-TIRF reconstructions were done with MATLAB using the ADMM<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. The resulting height images were postprocessed in Fiji and statistical analysis was performed in Prism.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2019_48455_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Notes and Figures</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41598_2019_48455_MOESM2_ESM.avi">
            <caption>
              <p>Supplementary video 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41598_2019_48455_MOESM3_ESM.avi">
            <caption>
              <p>Supplementary video 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41598_2019_48455_MOESM4_ESM.avi">
            <caption>
              <p>Supplementary video 3</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1038/s41598-019-48455-z.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Susan Daniel and Rohit Singh (Cornell University) for discussions and assistance preparing SLB samples. This research was funded by the National Institute of General Medical Sciences Ruth L. Kirschstein National Research Service Award 2T32GM008267 (M.J.C.), National Science Foundation Graduate Research Fellowship DGE-1650441 (M.J.C.), National Cancer Institute U54 CS210184 (M.J.P. and W.R.Z.) and R33-CA193043 (M.J.P. and W.R.Z.), National Science Foundation Award 1752226 (M.J.P.) and the Kavli Institute at Cornell for Nanoscale Science (M.J.C., W.R.Z. and M.J.P.). This work was performed in part at the Cornell NanoScale Science &amp; Technology Facility (CNF), a member of the National Nanotechnology Coordinated Infrastructure (NNCI), which is supported by the National Science Foundation (Grant NNCI-1542081).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author Contributions</title>
    <p>M.J.C., W.R.Z. and M.J.P. conceived the project and devised the studies. M.J.C. and W.R.Z. conceived and developed the controller electronics and firmware. M.J.C. built the controller and microscope, wrote the driver, interface and analysis software. M.J.C. and S.P. performed the experiments and collected instrument performance data. All authors contributed to the writing of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code Availability</title>
    <p>All source code written by the authors including controller firmware, driver, graphical interface and SAIM analysis code as described here is available in the project repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/mjc449/SAIMscannerV3.git">https://github.com/mjc449/SAIMscannerV3.git</ext-link> (commit 80819d26b2d570e266a7220d5379a96686e4b835). Additional source code and third-party libraries are available from the links referenced in the controller design section. Analysis code for the MA-TRIF experiments is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zcshinee/Pol-TIRF.git">https://github.com/zcshinee/Pol-TIRF.git</ext-link> (commit 5279d16bb0b9bcbd1fe98836f08d99dfbb50d628).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data Availability</title>
    <p>Source data including raw and processed image files are available upon request from the corresponding authors.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing Interests</title>
    <p id="Par37">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Edelstein, A., Amodaj, N., Hoover, K., Vale, R. &amp; Stuurman, N. Computer Control of Microscopes Using µManager. in <italic>Current Protocols In Molecular Biology</italic> (eds Ausubel, F. M. <italic>et al.</italic>) (John Wiley &amp; Sons, Inc., 2010).</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">OpenLabTools. Available at, <ext-link ext-link-type="uri" xlink:href="http://openlabtools.eng.cam.ac.uk/Instruments/Microscope/">http://openlabtools.eng.cam.ac.uk/Instruments/Microscope/</ext-link>. (Accessed: 18th December 2018).</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Planchon</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid three-dimensional isotropic imaging of living cells using Bessel beam plane illumination</article-title>
        <source>Nature Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>417</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1586</pub-id>
        <pub-id pub-id-type="pmid">21378978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>York</surname>
            <given-names>AG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Instant super-resolution imaging in live cells and embryos via analog image processing</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1122</fpage>
        <lpage>1126</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2687</pub-id>
        <pub-id pub-id-type="pmid">24097271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paszek</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scanning angle interference microscopy reveals cell dynamics at the nanoscale</article-title>
        <source>Nature Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>825</fpage>
        <lpage>827</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2077</pub-id>
        <pub-id pub-id-type="pmid">22751201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carbone</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Vale</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Stuurman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>An acquisition and analysis pipeline for scanning angle interference microscopy</article-title>
        <source>Nature Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>897</fpage>
        <lpage>898</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4030</pub-id>
        <pub-id pub-id-type="pmid">27798596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zong</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shadowless-illuminated variable-angle TIRF (siva-TIRF) microscopy for the observation of spatial-temporal dynamics in live cells</article-title>
        <source>Biomedical Optics Express</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>1530</fpage>
        <pub-id pub-id-type="doi">10.1364/BOE.5.001530</pub-id>
        <pub-id pub-id-type="pmid">24877013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Goodman, J. W. <italic>Speckle Phenomena in Optics: Theory and Applications</italic>. (Roberts and Company Publishers, 2007).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A simple and cost-effective setup for super-resolution localization microscopy</article-title>
        <source>Scientific Reports</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>1542</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-01606-6</pub-id>
        <pub-id pub-id-type="pmid">28484239</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saloma</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kawata</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Minami</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Large-amplitude current modulation of semiconductor laser and multichannel optical imaging</article-title>
        <source>Optics Communications</source>
        <year>1992</year>
        <volume>93</volume>
        <fpage>4</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/0030-4018(92)90119-C</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dingel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kawata</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Speckle-free image in a laser-diode microscope by using the optical feedback effect</article-title>
        <source>Opt. Lett., OL</source>
        <year>1993</year>
        <volume>18</volume>
        <fpage>549</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="doi">10.1364/OL.18.000549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mattheyses</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Axelrod</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Effective elimination of laser interference fringing in fluorescence microscopy by spinning azimuthal incidence angle</article-title>
        <source>Microscopy Research and Technique</source>
        <year>2006</year>
        <volume>69</volume>
        <fpage>642</fpage>
        <lpage>647</lpage>
        <pub-id pub-id-type="doi">10.1002/jemt.20334</pub-id>
        <pub-id pub-id-type="pmid">16770769</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Toledo-Crow</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mattheyses</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Polarization-Controlled TIRFM with Focal Drift and Spatial Field Intensity Correction</article-title>
        <source>Biophysical Journal</source>
        <year>2014</year>
        <volume>106</volume>
        <fpage>1008</fpage>
        <lpage>1019</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2013.12.043</pub-id>
        <pub-id pub-id-type="pmid">24606926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiolka</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Belyaev</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ewers</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stemmer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Even illumination in total internal reflection fluorescence microscopy using laser light</article-title>
        <source>Microscopy Research and Technique</source>
        <year>2008</year>
        <volume>71</volume>
        <fpage>45</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1002/jemt.20527</pub-id>
        <pub-id pub-id-type="pmid">17886344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van’t Hoff</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>de Sars</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Oheim</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A programmable light engine for quantitative single molecule TIRF and HILO imaging</article-title>
        <source>Optics Express</source>
        <year>2008</year>
        <volume>16</volume>
        <fpage>18495</fpage>
        <pub-id pub-id-type="doi">10.1364/OE.16.018495</pub-id>
        <pub-id pub-id-type="pmid">18958128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Axial superresolution via multiangle TIRF microscopy with sequential imaging and photobleaching</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>4368</fpage>
        <lpage>4373</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1516715113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lambacher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fromherz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Fluorescence interference-contrast microscopy on oxidized silicon using a monomolecular dye layer</article-title>
        <source>Applied Physics A: Materials Science &amp; Processing</source>
        <year>1996</year>
        <volume>63</volume>
        <fpage>207</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01567871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanchanawong</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanoscale architecture of integrin-based cell adhesions</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>468</volume>
        <fpage>580</fpage>
        <lpage>584</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09621</pub-id>
        <pub-id pub-id-type="pmid">21107430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Talin determines the nanoscale architecture of focal adhesions</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>E4864</fpage>
        <lpage>E4873</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1512025112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>HH</given-names>
          </name>
        </person-group>
        <article-title>Analysis and Compensation of Rolling Shutter Effect</article-title>
        <source>IEEE Transactions on Image Processing</source>
        <year>2008</year>
        <volume>17</volume>
        <fpage>1323</fpage>
        <lpage>1330</lpage>
        <pub-id pub-id-type="doi">10.1109/TIP.2008.925384</pub-id>
        <pub-id pub-id-type="pmid">18632342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin-Fernandez</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Tynan</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Webb</surname>
            <given-names>SED</given-names>
          </name>
        </person-group>
        <article-title>A ‘pocket guide’ to total internal reflection fluorescence: A ‘Pocket Guide’ to Total Internal Reflection Fluorescence</article-title>
        <source>Journal of Microscopy</source>
        <year>2013</year>
        <volume>252</volume>
        <fpage>16</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1111/jmi.12070</pub-id>
        <pub-id pub-id-type="pmid">23889125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Heo, Y. J., Lee, D., Kang, J., Lee, K. &amp; Chung, W. K. Real-time Image Processing for Microscopy-based Label-free Imaging Flow Cytometry in a Microfluidic Chip. <italic>Scientific Reports</italic><bold>7</bold> (2017).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Sanders, J. I. &amp; Kepecs, A. A low-cost programmable pulse generator for physiology and behavior. <italic>Front</italic>. <italic>Neuroeng</italic>. <bold>7</bold> (2014).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maia Chagas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prieto-Godino</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Arrenberg</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Baden</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The €100 lab: A 3D-printable open-source platform for fluorescence microscopy, optogenetics, and accurate temperature control during behaviour of zebrafish, Drosophila, and Caenorhabditis elegans</article-title>
        <source>PLOS Biology</source>
        <year>2017</year>
        <volume>15</volume>
        <fpage>e2002702</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.2002702</pub-id>
        <pub-id pub-id-type="pmid">28719603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">mjc449. SAIMscannerV3. (2018). Available at, <ext-link ext-link-type="uri" xlink:href="https://github.com/mjc449/SAIMscannerV3">https://github.com/mjc449/SAIMscannerV3</ext-link>. (Accessed: 14th December 2018).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">mjc449/SSv3_1 · CircuitHub. Available at, <ext-link ext-link-type="uri" xlink:href="https://circuithub.com/projects/mjc449/SSv3_1/revisions/16275">https://circuithub.com/projects/mjc449/SSv3_1/revisions/16275</ext-link>. (Accessed: 14th December 2018).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Online circuit simulator &amp; schematic editor. CircuitLab Available at, <ext-link ext-link-type="uri" xlink:href="https://www.circuitlab.com/">https://www.circuitlab.com/</ext-link>. (Accessed: 16th December 2018).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Qt Wiki. Available at, <ext-link ext-link-type="uri" xlink:href="https://wiki.qt.io/Main">https://wiki.qt.io/Main</ext-link>. (Accessed: 16th December 2018).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Ott, A. <italic>A Simple library for communicating with USB and Bluetooth HID devices on Linux</italic>, <italic>Mac</italic>, <italic>and Windows</italic>.<italic>: signal11/hidapi</italic>. (2018).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Boost C++ Libraries. Available at, <ext-link ext-link-type="uri" xlink:href="https://www.boost.org/">https://www.boost.org/</ext-link>. (Accessed: 16th December 2018).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">OpenCV library. Available at, <ext-link ext-link-type="uri" xlink:href="https://opencv.org/">https://opencv.org/</ext-link>. (Accessed: 16th December 2018).</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fiji: an open-source platform for biological-image analysis</article-title>
        <source>Nature Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>676</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three-dimensional super-resolved live cell imaging through polarized multi-angle TIRF</article-title>
        <source>Optics Letters</source>
        <year>2018</year>
        <volume>43</volume>
        <fpage>1423</fpage>
        <pub-id pub-id-type="doi">10.1364/OL.43.001423</pub-id>
        <pub-id pub-id-type="pmid">29600995</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
