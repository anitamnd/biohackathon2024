<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5249015</article-id>
    <article-id pub-id-type="publisher-id">1306</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-1306-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DGW: an exploratory data analysis tool for clustering and visualisation of epigenomic marks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lukauskas</surname>
          <given-names>Saulius</given-names>
        </name>
        <address>
          <email>saulius.lukauskas13@imperial.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Visintainer</surname>
          <given-names>Roberto</given-names>
        </name>
        <address>
          <email>visintainer@fbk.eu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sanguinetti</surname>
          <given-names>Guido</given-names>
        </name>
        <address>
          <email>gsanguin@inf.ed.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schweikert</surname>
          <given-names>Gabriele B.</given-names>
        </name>
        <address>
          <email>gschweik@inf.ed.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2113 8111</institution-id><institution-id institution-id-type="GRID">grid.7445.2</institution-id><institution>Department of Chemical Engineering, </institution><institution>Imperial College London, </institution></institution-wrap>London, SW7 2AZ UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7988</institution-id><institution-id institution-id-type="GRID">grid.4305.2</institution-id><institution>School of Informatics, </institution><institution>University of Edinburgh, </institution></institution-wrap>10 Crichton St, Edinburgh, EH8 9AB Scotland </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9780 0901</institution-id><institution-id institution-id-type="GRID">grid.11469.3b</institution-id><institution/><institution>Fondazione Bruno Kessler, </institution></institution-wrap>Via Sommarive 18, Povo, I-38123 TN Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <issue>Suppl 16</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>447</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Functional genomic and epigenomic research relies fundamentally on sequencing based methods like ChIP-seq for the detection of DNA-protein interactions. These techniques return large, high dimensional data sets with visually complex structures, such as multi-modal peaks extended over large genomic regions. Current tools for visualisation and data exploration represent and leverage these complex features only to a limited extent.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present DGW, an open source software package for simultaneous alignment and clustering of multiple epigenomic marks. DGW uses Dynamic Time Warping to adaptively rescale and align genomic distances which allows to group regions of interest with similar shapes, thereby capturing the structure of epigenomic marks. We demonstrate the effectiveness of the approach in a simulation study and on a real epigenomic data set from the ENCODE project.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Our results show that DGW automatically recognises and aligns important genomic features such as transcription start sites and splicing sites from histone marks. DGW is available as an open source Python package.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Clustering</kwd>
      <kwd>ChIP-seq</kwd>
      <kwd>Epigenetics</kwd>
      <kwd>Dynamic Time Warping</kwd>
    </kwd-group>
    <conference>
      <conf-name>The 10th International Workshop on Machine Learing in Systems Biology (MLSB)</conf-name>
      <conf-loc>Den Haag, The Netherlands</conf-loc>
      <conf-date>3-4 September 2016</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Sequencing based technologies such as ChIP-Seq and DNAse-Seq [e.g. reviewed in [<xref ref-type="bibr" rid="CR1">1</xref>]] have revolutionized our understanding of chromatin structure and function, yielding deep insights in the importance of epigenomic marks in the basic processes of life. The emergent picture is that gene expression is controlled by a complex interplay of protein binding and epigenomic modifications. While histone marks (and other epigenomic marks) can be measured in a high throughput way, exploratory data analysis techniques for these data types are still being developed. Epigenomic marks exhibit characteristics that distinguish them fundamentally from e.g. mRNA gene expression measurements: they are spatially extended across regions as wide as several kilobases within which they often present interesting local structures, such as the presence of multiple peaks and troughs [<xref ref-type="bibr" rid="CR2">2</xref>], and intriguing asymmetries [<xref ref-type="bibr" rid="CR3">3</xref>] (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The shape of epigenomic marks across replicate data sets appears to be highly conserved, and has recently been exploited for statistical testing [<xref ref-type="bibr" rid="CR4">4</xref>]. While the biological reasons for such conservation are not entirely clear, recent studies have suggested that both architectural and regulatory aspects may be at play. Bieberstein and colleagues showed intriguing patterns of accumulation of the histone marks H3K4me3 and H3K9ac at splice sites [<xref ref-type="bibr" rid="CR5">5</xref>], hinting at an architectural origin of the shape of the marks. More recently, Benveniste et al showed that histone marks can be very well predicted genome-wide by the binding patterns of transcription factors (TFs) [<xref ref-type="bibr" rid="CR6">6</xref>]. The shape of the peak may therefore be a readout of additional chromatin-related events and genomic regions which are similarly marked may therefore hint at common regulatory or architectural features. Excellent visualisation tools (e.g. UCSC genome browser) enable researchers to appreciate such features for individual enrichment peaks. However, while automatically grouping such marks based on shape similarity may be a valuable tool for hypothesis generation, it has remained a non-trivial task.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The epigenomic marks H3K4me3 (<italic>left</italic>) and H3K9ac (<italic>right</italic>) accumulate around transcription start sites often showing a bimodal peak with a valley over the TSS. Shown are two biological replicates for each mark and the input signal. Y axis corresponds to read counts. Annotated genes and the enriched regions called by MACS2 are shown in <italic>grey</italic> below each profile</p></caption><graphic xlink:href="12859_2016_1306_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>Current approaches to clustering regions based on chromatin signatures can be broadly split into two camps: global approaches, such as the celebrated HMM-based reconstruction of the “colours of the chromatin” [<xref ref-type="bibr" rid="CR7">7</xref>], try to find a segmentation of large genomic regions based on histone signatures. These approaches usually rely on the presence vs absence characterization of histone marks at genomic loci, such that the clustering is primarily based on combinatorial patterns of multiple histone marks, as opposed to spatial patterns emerging within individual peaks. Another interesting segmentation approach was recently introduced by Knijnenburg and colleagues [<xref ref-type="bibr" rid="CR8">8</xref>]. Here, signal enrichment is considered across a wide range of scales spanning several orders of magnitude. While this constitutes a significant improvement compared to earlier approaches, signal patterns within segments are again not taken into account. On the other hand, local approaches attempt to cluster short genomic regions at particular loci based on the quantitative binding or modification pattern measured at the loci (e.g. via ChIP-Seq). Examples of these approaches include the ENCODE Cluster Aggregation Tool (CAGT) [<xref ref-type="bibr" rid="CR3">3</xref>], or the clustering of genes based on PolII binding profiles performed in [<xref ref-type="bibr" rid="CR9">9</xref>]. Local approaches have to address two challenging problems: aligning the peaks to a reference, and standardising the peaks so that they can be represented as vectors of equal dimensions. To align regions, both, the method by Taslim and colleagues as well as the CAGT tool, rely on anchor points (e.g. transcription start sites (TSS) [<xref ref-type="bibr" rid="CR9">9</xref>] or transcription factor binding sites from auxiliary ChIP-Seq experiments [<xref ref-type="bibr" rid="CR3">3</xref>]). The regions are then standardised either by rescaling to a fixed gene length [<xref ref-type="bibr" rid="CR9">9</xref>] or by applying windows of fixed length either side of the anchor points [<xref ref-type="bibr" rid="CR3">3</xref>] irrespective of the true extent of the local enrichment. These strategies may be plausible for certain applications. However, the shape and extent of histone marks for instance, appear to be determined by many factors [<xref ref-type="bibr" rid="CR5">5</xref>], such that a uniform rescaling may be inappropriate. In particular, if one made the assumption that epigenomic marks are directly or indirectly influenced by the underlying DNA sequence, it becomes clear that more flexibility in the comparison and alignment of these marks is needed: for example, ortholog genes may share similar sequence features but their sequence length may vary. Sequence comparisons therefore in general do not require the considered sequences to be of equal length, they allow for insertions, deletions, shifts. Similar local variations should therefore be allowed when comparing epigenomic marks.</p>
    <p>In this work, we address the problem of aligning and clustering epigenomic data in a completely unsupervised way: as input data we use ChIP-Seq enrichment measurements within peak regions identified by a peak finder such as MACS [<xref ref-type="bibr" rid="CR10">10</xref>]. The alignment and the standardisation problems are solved simultaneously without the use of additional information, such as transcription start sites or gene annotation. We introduce a local rescaling which allows to match epigenomic marks based on maximum similarity between shapes. Our method, Dynamic Genome Warping (DGW), is based on the classical Dynamic Time Warping algorithm [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>], which enabled computer scientists to construct robust speech recognisers undeterred by the variability in pitch and speed of enunciation. In DGW we have implemented multidimensional alignment and clustering, such that multiple epigenomic tracks can be analysed simultaneously. This feature can also be used to control for local sequencing bias as DNA inputs or IGG controls can easily be added to the analysis. We first test DGW in a simulation study. Subsequently, we demonstrate that DGW can align genomic landmarks such as TSSs and first splicing sites (FSSs) on real epigenomic data from the ENCODE project [<xref ref-type="bibr" rid="CR13">13</xref>], thus effectively and automatically solving both the alignment and the standardization problems. DGW is freely available as a stand-alone, platform-independent and fully documented Python package.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p>We will first motivate and illustrate our method on a particular data set of histone modifications from the ENCODE project [<xref ref-type="bibr" rid="CR13">13</xref>], measuring tri-methylation of histone 3 at lysine 4 (H3K4me3) and acetylation of histone 3 at lysine 9 (H3K9ac) in human leukaemia cell line K562. The reason for choosing these two specific marks is that they are known to be characteristically enriched in the flanking regions of TSSs [<xref ref-type="bibr" rid="CR2">2</xref>] and they were recently shown to accumulate at FSSs [<xref ref-type="bibr" rid="CR5">5</xref>], hence providing direct evidence of the biological relevance of both the alignment and standardisation problems.</p>
    <p>Aligned fragments (BAM files) of both epigenomic marks were processed with the MACS2 peak caller [<xref ref-type="bibr" rid="CR10">10</xref>] to identify regions which showed enrichment relative to a input control sample; we then merged the two sets by considering every region called for either mark. We stress that the method is independent of the specific marks chosen, or the choice of peak caller, and is readily extendable to other types of genomic and epigenomic data.</p>
    <p>Enriched regions normally have very different lengths, nevertheless visual inspection of peaks can reveal similarities between the shape of the peaks. These similarities are often visualised through a global averaging (aggregation) of the marks as in [<xref ref-type="bibr" rid="CR2">2</xref>], nevertheless there are strong arguments that global averaging may also mask more subtle patterns. A useful motivating example is given in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. This shows four regions which are enriched in the H3K4me3 as well as H3K9ac marks. They all overlap with genes and exhibit broadly similar shapes: a bimodal peak with a trough over the TSS. However, the total lengths of the enriched regions vary, and so does the extent of the two individual sub-peaks, which could be governed by the underlying gene structure. Therefore, the position of the TSS relative to the start of the enriched regions varies.</p>
    <sec id="Sec3">
      <title>Dynamic genome warping</title>
      <p>To automatically quantify the similarities between peaks such as the ones shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> we use the classic Dynamic Time Warping (DTW) algorithm [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR14">14</xref>]. A modern review of the basic concepts of Dynamic Time Warping can be found e.g. in [<xref ref-type="bibr" rid="CR12">12</xref>]. It was originally introduced in the speech recognition community to robustly recognize speech independently of speech speed. There, the problem was to match waveforms of similar shape but potentially different duration. Likewise, our aim is to be able to associate peaks which exhibit similar local structure (shape) regardless of their spatial extension.</p>
      <p>Specifically, let <bold>a</bold>=(<italic>a</italic>
<sub>1</sub>,…,<italic>a</italic>
<sub><italic>N</italic></sub>) and <bold>b</bold>=(<italic>b</italic>
<sub>1</sub>,…,<italic>b</italic>
<sub><italic>M</italic></sub>) be two sequences with values <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a_{i},b_{i} \in \mathcal {S}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq1.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq2.gif"/></alternatives></inline-formula> is a metric space equipped with local distance <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d\colon \mathcal {S}\times \mathcal {S}\rightarrow \mathbb {R}$\end{document}</tex-math><mml:math id="M6"><mml:mi>d</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq3.gif"/></alternatives></inline-formula> (e.g. squared Euclidean distance or Cosine distance). DTW uses dynamic programming to construct a <italic>warping path</italic>
<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {p}=\left ({p_{1}^{0}},{p_{1}^{1}}\right),\ldots,\left ({p_{i}^{0}},{p_{i}^{1}}\right),\ldots,\left ({p_{K}^{0}},{p_{K}^{1}}\right)$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="bold">p</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq4.gif"/></alternatives></inline-formula>, i.e. two sets of indices identifying the elements of the two sequences which are mapped to each other in order to minimise the sum of the local distances. In formulae, 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mathbf{p}=\text{argmin}\sum\limits_{i=1}^{K}d\left(a_{{p_{i}^{0}}},b_{{p_{i}^{1}}}\right)  $$ \end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="bold">p</mml:mi><mml:mo>=</mml:mo><mml:mtext>argmin</mml:mtext><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mi>d</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2016_1306_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>subject to the following constraints 
<list list-type="bullet"><list-item><p><inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${p_{1}^{0}}={p_{1}^{1}}=1$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq5.gif"/></alternatives></inline-formula>, the first points of both sequences are mapped to each other;</p></list-item><list-item><p><inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${p_{K}^{0}}=N$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${p_{K}^{1}}=M$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq7.gif"/></alternatives></inline-formula>, the end points of both sequences are mapped to each other;</p></list-item><list-item><p><inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$0\le p_{i+1}^{j}-{p_{i}^{j}}\le 1$\end{document}</tex-math><mml:math id="M18"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq8.gif"/></alternatives></inline-formula> for all <italic>i</italic>=1,…,<italic>K</italic> and <italic>j</italic>=0,1, each index set is non-decreasing with maximum step one. This ensures that every point in each sequence gets mapped to at least one point on the other sequence.</p></list-item></list>
</p>
      <p>Algorithmically, DTW is very similar to the classical alignment algorithms such as Needleman-Wunsch and Smith-Waterman: it assumes an optimal alignment between subsequences, iterates by selecting the optimal next move and recovers the optimal global alignment by backtracking. As such, it entails constructing a matrix of size <italic>M</italic>×<italic>N</italic>, which determines the computational complexity of the algorithm: Computing pairwise DTW distances between all peaks is therefore the computationally most expensive step, as it involves computing <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (N_{peaks}^{2}\right)$\end{document}</tex-math><mml:math id="M20"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2016_1306_Article_IEq9.gif"/></alternatives></inline-formula> DTW distances, each of which is <italic>O</italic>(<italic>M</italic>×<italic>N</italic>). In Fig. <xref rid="Fig2" ref-type="fig">2</xref> we show how the first two peaks in Fig. <xref rid="Fig1" ref-type="fig">1</xref> are aligned onto each other using DTW. Notice that the pure DTW algorithm allows arbitrarily long stretches to be compressed to a single point. This behaviour may be undesirable, and simple modifications are implemented such as an upper limit on the length of compressed regions (Sakoe-Chiba band [<xref ref-type="bibr" rid="CR11">11</xref>]), or an exponential penalty on compressing/stretching. By applying the Sakoe-Chiba Band constraint we can also reduce the run-time to <italic>O</italic>(<italic>k</italic>×<italic>m</italic>
<italic>a</italic>
<italic>x</italic>(<italic>N</italic>,<italic>M</italic>)), where k is the width of the band, that can be chosen to be small. Novel strategies to reduce the computational load are however emerging [<xref ref-type="bibr" rid="CR15">15</xref>], and it would be interesting to integrate such ideas in the epigenomic context.
<fig id="Fig2"><label>Fig. 2</label><caption><p>DGW alignment of two H3K4me3 profiles. <bold>a</bold> Shown is the distance density matrix for two peaks (Peak 188 on the x-axis and Peak 280 on the y axis). Colour coding corresponds to local Euclidean distances from small (<italic>green</italic>) to large (<italic>red</italic>). Optimal path is shown in blue. <bold>b</bold> Mapping between the two profiles. <bold>c</bold> Dynamically aligned profiles and total distance <italic>D</italic> between the two peaks</p></caption><graphic xlink:href="12859_2016_1306_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>DGW readily extends to multi-dimensional data if more than one epigenomic track is analysed: In this case <bold>a</bold> and <bold>b</bold> become sequences of vectors, e.g. (<bold>a</bold>
<sub>1</sub>,…,<bold>a</bold>
<sub><italic>N</italic></sub>), that each contain the coverage of each mark at time point <italic>i</italic>. In this way, the different epigenomic marks are given equal weight, however other weighting schemes can easily be implemented.</p>
      <p>In addition to the optimal path between two sequences we also report their total distance under the optimal warping which will subsequently be used for the clustering of peaks. Note, when using squared Euclidean distance as local distance measure, both, differences in peak shapes as well as in enrichment levels contribute to the overall DTW distance. If this is not desired the peaks can optionally be normalized by the respective peak heights, and the Cosine distance can be used as local distance. To account for potential strand specificity of epigenomic marks we compute two distances for every pairwise peak comparison: one with the two sequences unchanged, and one with one of them reversed. The smaller distance between the two is then returned as the true distance between the patterns.</p>
    </sec>
    <sec id="Sec4">
      <title>Clustering</title>
      <p>After aligning all pairwise distances between peaks, we next aim to cluster them into groups which share similar shapes. Implementing k-means clustering within a DTW framework, however, would require the ability to define an average of all potentially possible warped profiles, which is not an easy task. Instead we take advantage of the pre-computed pairwise distances between peaks and perform agglomerative hierarchical clustering, using complete linkage to avoid chaining [<xref ref-type="bibr" rid="CR16">16</xref>]. The resulting dendrogram contains <italic>N</italic>
<sub><italic>peaks</italic></sub>−1 nodes, each of which represents a possible clustering of the data. As in any hierarchical clustering method, the number of clusters can be adaptively chosen by the user. This is both a strength and a weakness of the methodology. Principled methods for choosing a cutoff exist [<xref ref-type="bibr" rid="CR17">17</xref>] and implementing them in the context of DGW will be a future direction of improvement. DGW computes a prototype for each node, i.e. a sequence representative of all sequences attached to the node (leaves of the tree which has the chosen node as a root). Prototype computation is a non-trivial problem in DTW; here we use the scaled prioritised shape averaging algorithm of [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Pre-processing pipeline and implementation</title>
      <p>Here we briefly describe the DGW software package; a more thorough description, including installation instructions and examples, is given in the vignette at the DGW home-page [<xref ref-type="bibr" rid="CR19">19</xref>]. DGW consists of two modules: a worker module, which performs the computationally intensive tasks, and an explorer module, which allows visual exploration of the results. DGW-worker takes as input a set of genomic regions (a bed file e.g. returned by a peak finder) and a set of data files (bam files) for different epigenomic marks. Single-end reads are extended to the estimated fragment lengths. To alleviate the computational burden and to reduce spatial noise, coverage within peak regions are binned into non-overlapping windows spanning 50 bp. This is an adjustable parameter which should reflect the scale at which local changes are expected in the data. For each peak, we thus construct a sequence <bold>a</bold>=(<italic>a</italic>
<sub>1</sub>,…,<italic>a</italic>
<sub><italic>N</italic></sub>), which contains as values <italic>a</italic>
<sub><italic>i</italic></sub> the coverage within each bin <italic>i</italic>. At this point, we do not normalize with the input sample but use simple read counts. A practical reason for this is that most input samples still have a relatively low coverage. As there is no enrichment for binding sites, input samples cover the whole genome. Input library sizes therefore need to be significantly larger than their IP sample counterparts, which in practice is rarely the case. A simple correction, which uses enrichment over input is in most applications counterproductive as it adds additional noise to the signal. However, our method allows to add input samples for multidimensional clustering offering a convenient way to incorporate the additional information which is conveyed in a sufficiently sequenced input sample if it is available. The DGW-worker then computes the warping distances, the hierarchical clustering dendrogram, and the prototype sequences associated with each node; this is computationally intensive and the tasks will be automatically distributed across multiple cores if available. A typical run of DGW worker on the ChIP-seq data set takes 420 mins of CPU time distributed across six cores, for a total execution time of just over one hour.</p>
      <p>Once these computations are completed, the lightweight explorer module can be launched. This opens a window displaying a heat-map of the peaks and the clustering dendrogram. The dendrogram can be cut at any desired level. The information about which peaks are clustered is returned as a series of BED files (one per cluster) to enable subsequent analyses. Individual clusters can be further analysed and additional functionalities are provided at this level, e.g. histograms of the positions of specific regions of interest pre and post warping (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) and warpings of individual peaks onto prototypes can be obtained.
</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <sec id="Sec7">
      <title>Simulation study</title>
      <p>As a proof of correctness, we constructed a simple simulation study that mimics as best as possible a real biological data set. We considered the initial 2 kb of five genes from the UCSC known genes data set, and extracted H3K4me3 data for these five regions from the ENCODE human leukaemia cell line K562 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The first three of which showed bi-modal peaks, the remaining two exhibited a single peak. We ensured that the first splicing site of these five genes fell within the 2 kb region considered. We generated modified versions of the five seed regions using the following procedure (Fig. <xref rid="Fig3" ref-type="fig">3</xref>): A multiplicative Gaussian noise with variance <italic>v</italic> was applied to the read counts in each bin of a seed region. Further, each bin was removed or duplicated with probability <italic>p</italic> producing a shrinkage or a stretch of the peak. Bin duplication was allowed also for duplicated bins resulting in local stretching of varying length. Additionally, the orientation of the simulated peak was switched with probability <italic>fp</italic> in order to simulate anti-sense transcription. For each set of parameters (<italic>v</italic>, <italic>p</italic> and <italic>fp</italic>) we produced 99 simulated peaks starting from each seed thus obtaining a 500 peak dataset (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Generation of simulated data sets: Shown in <italic>blue</italic> are five <italic>seed regions</italic>, i.e. original ENCODE H3K4me3 read counts at the start of five known genes. For each of the seed regions we show 10 simulated modifications which are created by multiplying Gaussian noise to each bin (<italic>v</italic>: 0.1), by introducing insertions and deletions (<italic>p</italic>: 0.1) and by flipping the orientation of the peak with probability <italic>fp</italic>: 0.1. Individual panels (<bold>a</bold>–<bold>e</bold>) represent the different seed regions</p></caption><graphic xlink:href="12859_2016_1306_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>The Clustering results are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, both for a standard hierarchical clustering, as well as for DTW clustering. Figure <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref> and <xref rid="Fig4" ref-type="fig">b</xref> show resulting dendrograms for the simulation experiment with parameters (<italic>v</italic>: 0.25, <italic>p</italic>: 0.25, <italic>fp</italic>: 0.1). In contrast to standard hierarchical clustering DGW identifies 5 clusters with approximately 100 members each, corresponding well to the initial five seed patterns. We reproduced the data simulation and clustering phases varying the parameter sets in order to investigate a grid of increasing modifications of peak patterns. We quantitatively assess the accuracy of the clustering using the Matthews Correlation Coefficient (MCC) with the generalization for multi-class classification problems [<xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref>]. The results are presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Table <xref rid="Tab1" ref-type="table">1</xref>. The MCC ranges from -1 to 1, the extreme values represent completely incorrect and completely correct classifications, respectively and 0 the result of a random classification. Standard Hierarchical clustering is able to correctly group the simulated peaks according to the pattern they are originally derived from only if the added noise and modifications are small (<italic>v</italic>&lt;0.15,<italic>p</italic>&lt;0.15). With DGW optimal clustering can be achieved even if the extent of local modifications to the patterns is large (Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Table <xref rid="Tab1" ref-type="table">1</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Simulation results for parameter set (<italic>v</italic>: 0.25, <italic>p</italic>: 0.25, <italic>fp</italic>: 0.1). <bold>a</bold> Left panel shows the dendrogram of clustered peaks using hierarchical clustering only. Peaks assigned to each of five different cluster are shown in <italic>yellow</italic>, <italic>pink</italic>, <italic>blue</italic>, <italic>red</italic> and <italic>green</italic>. X axis represents the pairwise distances <bold>d</bold>. Right panel shows clustered peaks. Colour coding corresponds to normalized read counts. X axis represents original (unwarped) bins from start of the peaks. <bold>c</bold> Matthews Correlation Coefficient for hierarchical clustering based on a set of simulations with varying parameters (<italic>v</italic>,<italic>p</italic>) and <italic>fp</italic> fixed to 0.1. <bold>b</bold> and <bold>d</bold> as <bold>a</bold> and <bold>c</bold> but for DGW alignment followed by hierarchical clustering</p></caption><graphic xlink:href="12859_2016_1306_Fig4_HTML" id="MO4"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Matthews Correlation Coefficient values relative to the classifications of the synthetic peaks produced with the indicated values for <italic>p</italic> and <italic>v</italic> and <italic>fp</italic>=0.1</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left" colspan="10">No DTW</td></tr><tr><td align="left"><italic>p</italic>\<italic>v</italic></td><td align="left">0.0</td><td align="left">0.05</td><td align="left">0.1</td><td align="left">0.15</td><td align="left">0.2</td><td align="left">0.25</td><td align="left">0.3</td><td align="left">0.35</td><td align="left">0.4</td></tr><tr><td align="left">0.00</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.785</td><td align="left">0.699</td><td align="left">0.412</td></tr><tr><td align="left">0.05</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.773</td><td align="left">0.486</td></tr><tr><td align="left">0.10</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.785</td><td align="left">0.795</td><td align="left">0.707</td><td align="left">0.372</td></tr><tr><td align="left">0.15</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.998</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.723</td><td align="left">0.505</td><td align="left">0.671</td></tr><tr><td align="left">0.20</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.682</td><td align="left">1.000</td><td align="left">0.696</td><td align="left">0.572</td><td align="left">0.501</td></tr><tr><td align="left">0.25</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.600</td><td align="left">1.000</td><td align="left">0.748</td><td align="left">0.710</td><td align="left">0.618</td><td align="left">0.452</td></tr><tr><td align="left">0.30</td><td align="left">0.945</td><td align="left">0.995</td><td align="left">0.998</td><td align="left">0.907</td><td align="left">0.682</td><td align="left">0.995</td><td align="left">0.772</td><td align="left">0.767</td><td align="left">0.434</td></tr><tr><td align="left">0.35</td><td align="left">0.957</td><td align="left">0.927</td><td align="left">0.975</td><td align="left">0.613</td><td align="left">0.973</td><td align="left">0.604</td><td align="left">0.701</td><td align="left">0.259</td><td align="left">0.413</td></tr><tr><td align="left">0.40</td><td align="left">0.649</td><td align="left">0.619</td><td align="left">0.990</td><td align="left">0.704</td><td align="left">0.599</td><td align="left">0.746</td><td align="left">0.252</td><td align="left">0.617</td><td align="left">0.294</td></tr><tr><td align="left" colspan="10">DTW</td></tr><tr><td align="left"><italic>p</italic>\<italic>v</italic></td><td align="left">0.0</td><td align="left">0.05</td><td align="left">0.1</td><td align="left">0.15</td><td align="left">0.2</td><td align="left">0.25</td><td align="left">0.3</td><td align="left">0.35</td><td align="left">0.4</td></tr><tr><td align="left">0.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.995</td><td align="left">0.780</td><td align="left">0.773</td></tr><tr><td align="left">0.050</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.995</td><td align="left">0.772</td><td align="left">0.778</td></tr><tr><td align="left">0.100</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.788</td><td align="left">0.783</td><td align="left">0.766</td></tr><tr><td align="left">0.150</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.998</td><td align="left">0.975</td><td align="left">0.774</td><td align="left">0.978</td></tr><tr><td align="left">0.200</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.998</td><td align="left">0.774</td><td align="left">0.752</td><td align="left">0.760</td></tr><tr><td align="left">0.250</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.998</td><td align="left">0.988</td><td align="left">0.973</td><td align="left">0.948</td></tr><tr><td align="left">0.300</td><td align="left">1.000</td><td align="left">0.990</td><td align="left">0.988</td><td align="left">1.000</td><td align="left">1.000</td><td align="left">0.998</td><td align="left">0.901</td><td align="left">0.421</td><td align="left">0.764</td></tr><tr><td align="left">0.350</td><td align="left">1.000</td><td align="left">0.971</td><td align="left">1.000</td><td align="left">0.586</td><td align="left">0.978</td><td align="left">0.990</td><td align="left">0.297</td><td align="left">0.318</td><td align="left">0.710</td></tr><tr><td align="left">0.400</td><td align="left">1.000</td><td align="left">0.954</td><td align="left">0.964</td><td align="left">0.998</td><td align="left">0.988</td><td align="left">0.665</td><td align="left">0.973</td><td align="left">0.934</td><td align="left">0.401</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec8">
      <title>DGW automatically aligns genomic landmarks</title>
      <p>To assess the biological significance of DGW alignment and clustering, we considered two histone marks (H3K4me3 and H3K9ac) from the ENCODE data sets. These marks were chosen as they were shown to accumulate at transcription start sites as well as first splicing sites (FSSs) [<xref ref-type="bibr" rid="CR5">5</xref>]. Given that first exon length is highly variable, this provides a strong motivation for the local rescaling applied by DGW. For this experiment, enriched regions identified by the MACS2 peak caller were used for clustering such that no anchoring was provided. Using a bin size of 50, we restricted the analysed set of peaks to those that had a length larger than 5 and smaller than 1000 bins. Also we filtered out peaks with less than 10 counts. We used squared Euclidean distance for the local distance measure between the scaled reads and constrained the DTW with a Sakoe-Chiba Band of width 12.</p>
      <p>Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the dendrogram and heat maps for this data. Notice the high variability in peak length, making it virtually impossible to visually distinguish any patterns. Cutting the dendrogram at an appropriate level is a difficult choice. Empirically, cutting the dendrogram near the leaves gives better visualisations, as larger clusters force the algorithm to warp together potentially very different peaks. With this in mind, we chose a cut which resulted in 45 clusters. Figure <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">a</xref> and <xref rid="Fig6" ref-type="fig">b</xref> show the original and warped heat-maps for the two epigenomic marks within one particular cluster. TSS and First Splice Site positions are shown with red and orange dots, respectively. The heat-map of the warped data shows a well defined bimodal pattern of H3K4me3 with TSS aligning in the valley between the two sub-peaks. This is in good agreement with the known pattern of these marks around gene starts. It can be seen that these genomic landmarks or points of interest (POIs) are approximately aligned, without the usage of any prior knowledge of their position in the clustering. This is corroborated by considering the histograms of TSS and FSS positions in the raw and aligned data (Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">c</xref> and <xref rid="Fig6" ref-type="fig">d</xref>). Computing the change in entropy between the histograms shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, after rescaling the raw data to have the same length, we observe a decrease of 12.91 % for TSS and 7.72 % for FSS location distributions in the selected cluster after warping. On average, across all clusters, this effect is less pronounced, but still significant: 1.72 % decrease on average (95 % Bootstrap confidence interval 0.83 % ∼ 2.81 %) for TSS and 2.65 % (1.79 % ∼ 3.63 %) for FSS respectively, quantitatively demonstrating the ability of DGW to align these genomic landmarks.
<fig id="Fig5"><label>Fig. 5</label><caption><p>ENCODE data: DGW clustering of the H3K4me3 and H3K9ac marks in the K562 cell line. Shown are Dendrogram and heat-maps. TSS are shown as <italic>red dots</italic> in the heat-maps</p></caption><graphic xlink:href="12859_2016_1306_Fig5_HTML" id="MO5"/></fig>
<fig id="Fig6"><label>Fig. 6</label><caption><p>ENCODE data, a sample DGW cluster. <bold>a</bold> heat-maps of the raw and <bold>b</bold> aligned data. <italic>Red dots</italic> indicate transcription start sites, <italic>orange dots</italic> first splice sites. <bold>c</bold> Histograms of the positions of TSSs in raw (<italic>left</italic>) and aligned (<italic>right</italic>) data. <bold>d</bold> Histograms of the positions of first splice sites in raw (<italic>left</italic>) and aligned (<italic>right</italic>) data</p></caption><graphic xlink:href="12859_2016_1306_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
    <sec id="Sec9">
      <title>DGW clusters are enriched for co-factor binding sites</title>
      <p>To probe further the biological significance of the DGW clusters, we asked whether the cluster membership could be explained in part by considering shared binding co-factors. To test this hypothesis, we considered ChIP-Seq data sets for 34 transcription factors (TFs) assayed by ENCODE in the K562 cell line (see Availability of data and materials for lists of TFs and download sources). Several TFs have been mechanistically associated with histone modifying enzymes, and indeed TF binding has recently been reported to be very strongly predictive of histone modifications [<xref ref-type="bibr" rid="CR6">6</xref>]. We extracted peak information from these data sets, and then questioned the distribution of individual TFs binding sites across clusters. Under a reasonable null hypothesis of no relation between clustering and TF binding, one would expect the number of TF peaks falling into the genomic region corresponding to a cluster to be simply proportional to the size of the genomic region, i.e. a uniform distribution.</p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref> shows normalised cumulative occurrences of TF binding sites across clusters; For each TF, clusters are ranked by their relative overlap with the given TF. Each bar corresponds to the cumulative level of normalized overlap between the TF and the considered cluster plus all clusters to the left of it. The null hypothesis of uniform distribution would correspond to the red line. On the contrary, if all binding sites for a given TF could be found in a single cluster, all bars would have length 0 except for the right most one, which would have length 1. A large area between the red line and the cumulative plot therefore indicates a strongly non-uniform distribution. Occurrence distributions for some TF, such as TR4, ATF3 or NFE2 are remarkably non-uniform and demonstrate that some clusters are highly enriched for a specific set of TFs. While these tests do not yield an immediately interpretable biological outcome, they strongly hint at a biological significance for enriched regions clustered by DGW.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Cumulative levels of normalized overlap between each TF and the determined clusters. Each sub-plot corresponds to one TF. For each TF, clusters are ranked by their relative overlap with this TF. Each bar corresponds to the cumulative level of normalized overlap between the TF and the considered cluster plus all clusters to the left of it. The null hypothesis of uniform distribution corresponds to the <italic>red lines</italic>. The area between the <italic>red line</italic> and the cumulative plots is indicated below the TF name</p></caption><graphic xlink:href="12859_2016_1306_Fig7_HTML" id="MO7"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Data exploration and visualisation tools have played a central role in bioinformatics, and have contributed in no small part to the success of high-throughput methods in the last decade [<xref ref-type="bibr" rid="CR22">22</xref>]. Extending these methodologies for the complex next generation sequencing data sets poses computational and methodological challenges, yet the potential for hypothesis generation is considerable. ChIP-seq data sets, in particular, yield high dimensional, structured marks associated with genomic regions. The reproducibility of the spatial structure in the ChIP-seq signal has already inspired the development of shape-based statistical tests for ChIP-seq [<xref ref-type="bibr" rid="CR4">4</xref>]. In this paper, we addressed the natural question of whether spatial structures in ChIP-seq data can also be used to group genes with similar epigenomic marks. We have proposed a novel method, DGW, which aims to address these problems using ideas from signal processing and speech recognition. Our results show that DGW can be a practical and user friendly tool for exploratory data analysis of high throughput epigenomic data sets. DGW’s ability to recover in an unsupervised manner the observed accumulation of H3K4me3 and H3K9ac at transcription start sites and first splicing sites [<xref ref-type="bibr" rid="CR5">5</xref>], and to associate clusters with groups of transcription factors, also demonstrates its potential as a useful tool for biological hypothesis generation. We hope that DGW may become a valuable addition to the growing toolkit for epigenome bioinformatics.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank five anonymous reviewers for their useful suggestions and remarks, which have contributed to improve the paper.</p>
    <sec id="d29e2016">
      <title>Declarations</title>
      <p>This article has been published as part of <italic>BMC Bioinformatics</italic> Volume 17 Supplement 16, 2016: Proceedings of the Tenth International Workshop on Machine Learning in Systems Biology (MLSB 2016). The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-17-supplement-16">http://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-17-supplement-16</ext-link>.</p>
    </sec>
    <sec id="d29e2029">
      <title>Funding</title>
      <p>G.B.S. acknowledges funding from the EU under the Marie Curie actions. G.S. acknowledges funding from the ERC under grant MLC366999 which includes funding for the publication of this article.</p>
    </sec>
    <sec id="d29e2034">
      <title>Availability of data and materials</title>
      <p>All data used in this study are available from the ENCODE project repository [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. (IDs: wgEncodeBroadHistoneK562H3k4me3StdAlnRep1.bam, wgEncodeBroadHistoneK562H3k4me3StdAlnRep2.bam, wgEncodeBroadHistoneK562H3k9acStdAlnRep1.bam, wgEncodeBroadHistoneK562H3k9acStdAlnRep2.bam, wgEncodeBroadHistoneK562ControlStdAlnRep1.bam). DGW is available as a open-source Python package on Github [<ext-link ext-link-type="uri" xlink:href="https://lukauskas.github.com/dgw/">https://lukauskas.github.com/dgw/</ext-link>] [<xref ref-type="bibr" rid="CR19">19</xref>]. The manual illustrating the package is available from the same URL.</p>
    </sec>
    <sec id="d29e2053">
      <title>Authors’ contributions</title>
      <p>SL, GBS and GS designed the research. SL implemented the method and SL, RV and GBS carried out the experiments. All authors wrote the paper. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d29e2058">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e2063">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e2068">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>Chip-seq and beyond: new and improved methodologies to detect and characterize protein-dna interactions</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>840</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3306</pub-id>
        <?supplied-pmid 23090257?>
        <pub-id pub-id-type="pmid">23090257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cuddapah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Roh</surname>
            <given-names>TY</given-names>
          </name>
          <name>
            <surname>Schones</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chepelev</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>High-resolution profiling of histone methylations in the human genome</article-title>
        <source>Cell</source>
        <year>2007</year>
        <volume>129</volume>
        <issue>4</issue>
        <fpage>823</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.05.009</pub-id>
        <?supplied-pmid 17512414?>
        <pub-id pub-id-type="pmid">17512414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kyriazopoulou-Panagiotopoulou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Libbrecht</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Raha</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Winters</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Ubiquitous heterogeneity and asymmetry of the chromatin environment at regulatory elements</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>1735</fpage>
        <lpage>1747</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.136366.111</pub-id>
        <?supplied-pmid 22955985?>
        <pub-id pub-id-type="pmid">22955985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schweikert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cseke</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Clouaire</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bird</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mmdiff: quantitative testing for shape changes in chip-seq data sets</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>826</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-826</pub-id>
        <?supplied-pmid 24267901?>
        <pub-id pub-id-type="pmid">24267901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bieberstein</surname>
            <given-names>NI</given-names>
          </name>
          <name>
            <surname>Carrillo Oesterreich</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Straube</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Neugebauer</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>First exon length controls active chromatin signatures and transcription</article-title>
        <source>Cell Rep</source>
        <year>2012</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>62</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2012.05.019</pub-id>
        <?supplied-pmid 22840397?>
        <pub-id pub-id-type="pmid">22840397</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benveniste</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sonntag</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sproul</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Transcription factor binding predicts histone modifications in human cell lines</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>37</issue>
        <fpage>13367</fpage>
        <lpage>13372</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1412081111</pub-id>
        <?supplied-pmid 25187560?>
        <pub-id pub-id-type="pmid">25187560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Filion</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>van Bemmel</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Braunschweig</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Talhout</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Brugman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>de Castro</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Kerkhoven</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Bussemaker</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>van Steense</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Systematic protein location mapping reveals five principal chromatin types in drosophila cells</article-title>
        <source>Cell</source>
        <year>2010</year>
        <volume>143</volume>
        <issue>2</issue>
        <fpage>221</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2010.09.009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knijnenburg</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Ramsey</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Berman</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Smit</surname>
            <given-names>AFA</given-names>
          </name>
          <name>
            <surname>Wessels</surname>
            <given-names>LFA</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Aderem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shmulevich</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Multiscale representation of genomic signals</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>689</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2924</pub-id>
        <?supplied-pmid 24727652?>
        <pub-id pub-id-type="pmid">24727652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taslim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Parvin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Comparative study on chip-seq data: normalization and binding pattern characterization</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>18</issue>
        <fpage>2334</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp384</pub-id>
        <?supplied-pmid 19561022?>
        <pub-id pub-id-type="pmid">19561022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Eeckhoute</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakoe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chiba</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Dynamic programming algorithm optimisation for spoken word recognition</article-title>
        <source>IEEE Trans Speech Acoust Signal Process</source>
        <year>1978</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>62</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1109/TASSP.1978.1163055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Information Retrieval for Music and Motion</source>
        <year>2007</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of dna elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Giorgino T. Computing and visualizing dynamic time warping alignments in r: The dtw package. J Stat Softw. 2009; 31(7):1–24. doi:10.18637/jss.v031.i07 <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.18637/jss.v031.i07">http://dx.doi.org/10.18637/jss.v031.i07</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <mixed-citation publication-type="other">Begum N, Ulanova L, Wang J, Keogh E. Accelerating Dynamic Time Warping Clustering with a Novel Admissible Pruning Strategy. In: Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. New York: ACM: 2015. p. 49–58, doi:10.1145/2783258.2783286. <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/2783258.2783286">http://doi.acm.org/10.1145/2783258.2783286</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Hirano S, Tsumoto S. Empirical Comparison of Clustering Methods for Long Time-Series Databases In: Tsumoto S, Yamaguchi T, Numao M, Motoda H, editors. Active Mining: Second International Workshop, AM 2003, Maebashi, Japan, October 28, 2003. Revised Selected Papers. Berlin: Springer Berlin Heidelberg: 2005. p. 268–286, doi:10.1007/11423270_15. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/11423270_15">http://dx.doi.org/10.1007/11423270_15</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Heller KA, Ghahramani Z. Bayesian Hierarchical Clustering. In: Proceedings of the 22Nd International Conference on Machine Learning. New York: ACM: 2005. p. 297–304. <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/1102351.1102389">http://doi.acm.org/10.1145/1102351.1102389</ext-link>. doi:10.1145/1102351.1102389.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Niennattrakul V, Ratanamahatana CA. Shape averaging under time warping. In: 2009 6th International Conference on Electrical Engineering/Electronics, Computer, Telecommunications and Information Technology. IEEE: 2009. p. 626–629, doi:10.1109/ECTICON.2009.5137128. <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/document/5137128/">http://ieeexplore.ieee.org/document/5137128/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Lukauskas S. DGW Software Package. <ext-link ext-link-type="uri" xlink:href="https://lukauskas.github.com/dgw/">https://lukauskas.github.com/dgw/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matthews</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>
        <source>Biochim Biophys Acta</source>
        <year>1975</year>
        <volume>405</volume>
        <fpage>442</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1016/0005-2795(75)90109-9</pub-id>
        <?supplied-pmid 1180967?>
        <pub-id pub-id-type="pmid">1180967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurman</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Riccadonna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Furlanello</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A comparison of mcc and cen error measures in multi-class prediction</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>8</issue>
        <fpage>41882</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0041882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis and display of genome-wide expression patterns</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>1998</year>
        <volume>95</volume>
        <issue>25</issue>
        <fpage>14863</fpage>
        <lpage>14868</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id>
        <?supplied-pmid 9843981?>
        <pub-id pub-id-type="pmid">9843981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">ENCODE Project Consortium. Encode Data. <ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeBroadHistone/">http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeBroadHistone/</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
