<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4665391</article-id>
    <article-id pub-id-type="publisher-id">831</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-015-0831-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HiC-Pro: an optimized and flexible pipeline for Hi-C data processing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Servant</surname>
          <given-names>Nicolas</given-names>
        </name>
        <address>
          <email>nicolas.servant@curie.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Varoquaux</surname>
          <given-names>Nelle</given-names>
        </name>
        <address>
          <email>nelle.varoquaux@ensmp.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lajoie</surname>
          <given-names>Bryan R.</given-names>
        </name>
        <address>
          <email>Bryan.Lajoie@umassmed.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Viara</surname>
          <given-names>Eric</given-names>
        </name>
        <address>
          <email>viara@sysra.com</email>
        </address>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Chong-Jian</given-names>
        </name>
        <address>
          <email>cchen@annoroad.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
        <xref ref-type="aff" rid="Aff6"/>
        <xref ref-type="aff" rid="Aff7"/>
        <xref ref-type="aff" rid="Aff8"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vert</surname>
          <given-names>Jean-Philippe</given-names>
        </name>
        <address>
          <email>Jean-Philippe.Vert@mines.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Heard</surname>
          <given-names>Edith</given-names>
        </name>
        <address>
          <email>edith.heard@curie.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff6"/>
        <xref ref-type="aff" rid="Aff7"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dekker</surname>
          <given-names>Job</given-names>
        </name>
        <address>
          <email>job.dekker@umassmed.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff9"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barillot</surname>
          <given-names>Emmanuel</given-names>
        </name>
        <address>
          <email>emmanuel.barillot@curie.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <aff id="Aff1"><label/>Institut Curie, Paris, France </aff>
      <aff id="Aff2"><label/>INSERM, U900, Paris, France </aff>
      <aff id="Aff3"><label/>Mines ParisTech, PSL-Research University, CBIO-Centre for Computational Biology, Fontainebleau, France </aff>
      <aff id="Aff4"><label/>Program in Systems Biology, Department of Biochemistry and Molecular Pharmacology, University of Massachusetts Medical School, Worcester, MA USA </aff>
      <aff id="Aff5"><label/>Sysra, Yerres, France </aff>
      <aff id="Aff6"><label/>CNRS UMR3215, Paris, France </aff>
      <aff id="Aff7"><label/>INSERM U934, Paris, France </aff>
      <aff id="Aff8"><label/>Annoroad Gene Technology Co., Ltd, Beijing, China </aff>
      <aff id="Aff9"><label/>Howard Hughes Medical Institute, Program in Systems Biology, Department of Biochemistry and Molecular Pharmacology, University of Massachusetts Medical School, Worcester, MA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>259</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>8</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>11</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Servant et al. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>HiC-Pro is an optimized and flexible pipeline for processing Hi-C data from raw reads to normalized contact maps. HiC-Pro maps reads, detects valid ligation products, performs quality controls and generates intra- and inter-chromosomal contact maps. It includes a fast implementation of the iterative correction method and is based on a memory-efficient data format for Hi-C contact maps. In addition, HiC-Pro can use phased genotype data to build allele-specific contact maps. We applied HiC-Pro to different Hi-C datasets, demonstrating its ability to easily process large data in a reasonable time. Source code and documentation are available at <ext-link ext-link-type="uri" xlink:href="http://github.com/nservant/HiC-Pro">http://github.com/nservant/HiC-Pro</ext-link>.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-015-0831-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Chromosome conformation</kwd>
      <kwd>Hi-C</kwd>
      <kwd>Bioinformatics pipeline</kwd>
      <kwd>Normalization</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p>High-throughput chromosome conformation capture methods are now widely used to map chromatin interactions within regions of interest and across the genome. The use of Hi-C has notably changed our vision of genome organization and its impact on chromatin and gene regulation [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The Hi-C technique involves sequencing pairs of interacting DNA fragments, where each mate is associated with one interacting locus. Briefly, cells are crossed-linked, DNA is fragmented using a restriction enzyme [<xref ref-type="bibr" rid="CR3">3</xref>] or a nuclease [<xref ref-type="bibr" rid="CR4">4</xref>], and interacting fragments are ligated together. After paired-end sequencing, each pair of reads can be associated to one DNA interaction.</p>
    <p>In recent years, the Hi-C technique has demonstrated that the genome is partitioned into domains of different scale and compaction level. The first Hi-C application has described that the genome is partitioned into distinct compartments of open and closed chromatin [<xref ref-type="bibr" rid="CR3">3</xref>]. Higher throughput and resolution have then suggested the presence of megabase-long and evolutionarily conserved smaller domains. These topologically associating domains are characterized by a high frequency of intra-domain chromatin interactions but infrequent inter-domain chromatin interactions [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. More recently, very large data sets with deeper sequencing have been used to increase the Hi-C resolution in order to detect loops across the entire genome [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>As with any genome-wide sequencing data, Hi-C usually requires several millions to billions of paired-end sequencing reads, depending on genome size and on the desired resolution. Managing these data thus requires optimized bioinformatics workflows able to extract the contact frequencies in reasonable computational time and with reasonable resource and storage requirements. The overall strategy to process Hi-C data is converging among recent studies [<xref ref-type="bibr" rid="CR9">9</xref>], but there remains a lack of stable, flexible and efficient bioinformatics workflows to process such data. Solutions such as the HOMER [<xref ref-type="bibr" rid="CR10">10</xref>], HICUP [<xref ref-type="bibr" rid="CR11">11</xref>], HiC-inspector [<xref ref-type="bibr" rid="CR12">12</xref>], HiCdat [<xref ref-type="bibr" rid="CR13">13</xref>] and HiCbox [<xref ref-type="bibr" rid="CR14">14</xref>] pipelines are already available for Hi-C data processing. HOMER offers several functions to analyze Hi-C data but does not perform the mapping of reads nor the correction of systematic biases. HiCdat, HiC-inspector and HiCbox do not allow chimeric reads to be rescued during the mapping of reads. HICUP provides a complete pipeline until the detection of valid interaction products. Using HICUP together with the SNPsplit program [<xref ref-type="bibr" rid="CR15">15</xref>] allows the extraction of allele-specific interaction products whereas all other solutions do not allow allele-specific analysis. The HiCdat and HiCbox packages offer a means of correcting contact maps for systematic biases. Finally, none of these software were designed to process very large amounts of data in a parallel mode. The hiclib package is currently the most commonly used solution for Hi-C data processing. However, hiclib is a Python library that requires programming skills, such as knowledge of Python and advanced Linux command line, and cannot be used in a single command-line manner. In addition, parallelization is not straightforward and it has limitations with regard to the analysis and normalization of very high-resolution data (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparing solutions for Hi-C data processing</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Mapping</th><th>Detection of valid interactions</th><th>Binning</th><th>Correction of systematic noise</th><th>Parallel implementation</th><th>Allele-specific analysis</th></tr></thead><tbody><tr><td>HOMER</td><td/><td>x</td><td>x</td><td/><td/><td/></tr><tr><td>HICUP</td><td>x</td><td>x</td><td/><td/><td/><td>x</td></tr><tr><td>HiC-inspector</td><td>x<sup>a</sup>
</td><td>x</td><td>x</td><td/><td/><td/></tr><tr><td>HiC-Box</td><td>x<sup>a</sup>
</td><td>x</td><td>x</td><td>x</td><td/><td/></tr><tr><td>HiCdat</td><td>x<sup>a</sup>
</td><td>x</td><td>x</td><td>x</td><td/><td/></tr><tr><td>Hiclib</td><td>x</td><td>x</td><td>x</td><td>x</td><td/><td/></tr><tr><td>HiC-Pro</td><td>x</td><td>x</td><td>x</td><td>x</td><td>x</td><td>x</td></tr></tbody></table><table-wrap-foot><p>HOMER [<xref ref-type="bibr" rid="CR10">10</xref>] offers several programs to analysis Hi-C data from aligned reads. <sup>a</sup>HiC-inpector [<xref ref-type="bibr" rid="CR12">12</xref>], HiCdat [<xref ref-type="bibr" rid="CR13">13</xref>] and HiC-Box [<xref ref-type="bibr" rid="CR14">14</xref>] do not allow chimeric reads to be rescued during the mapping. HICUP [<xref ref-type="bibr" rid="CR11">11</xref>] provides a complete pipeline until the detection of valid interaction products. It can be used together with the SNPsplit software [<xref ref-type="bibr" rid="CR15">15</xref>] to extract allele-specific mapped reads. The hiclib Python library [<xref ref-type="bibr" rid="CR17">17</xref>] can be applied for all analysis steps but requires good programming skills and cannot be used in a single command-line manner. None of these software enable very large amounts of data to be processed easily in a parallel mode. Note that HOMER, hiclib and HiCdat also offer additional functions for downstream analysis. In the case of HiC-Pro, the downstream analysis is supported by the HiTC BioConductor package [<xref ref-type="bibr" rid="CR28">28</xref>]</p></table-wrap-foot></table-wrap></p>
    <p>Here, we present HiC-Pro, an easy-to-use and complete pipeline to process Hi-C data from raw sequencing reads to normalized contact maps. HiC-Pro allows the processing of data from Hi-C protocols based on restriction enzyme or nuclease digestion such as DNase Hi-C [<xref ref-type="bibr" rid="CR4">4</xref>] or Micro-C [<xref ref-type="bibr" rid="CR16">16</xref>]. When phased genotypes are available, HiC-Pro is able to distinguish allele-specific interactions and to build both maternal and paternal contact maps. It is optimized and offers a parallel mode for very high-resolution data as well as a fast implementation of the iterative correction method [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>HiC-Pro results and performance</title>
      <p>We processed Hi-C data from two public datasets: IMR90 human cell lines from Dixon et al. [<xref ref-type="bibr" rid="CR6">6</xref>] (IMR90) and from Rao et al. [<xref ref-type="bibr" rid="CR7">7</xref>] (IMR90_CCL186). The latter is currently one of the biggest datasets available, used to generate up to 5-kb contact maps. For each dataset, we ran HiC-Pro and generated normalized contact maps at 20 kb, 40 kb, 150 kb, 500 kb and 1 Mb resolution. Normalized contact maps at 5 kb were only generated for the IMR90_CCL186 dataset. The datasets were either used in their original form or split into chunks containing 10 or 20 million read pairs.</p>
      <p>Using HiC-Pro, the processing of the Dixon’s dataset (397.2 million read pairs split into 84 read chunks) was completed in 2 hours using 168 CPUs (Table <xref rid="Tab2" ref-type="table">2</xref>). Each chunk was mapped on the human genome using four CPUs (two for each mate) and 7 GB of RAM Processing the 84 chunks in parallel allows extraction of the list of valid interactions in less than 30 minutes. All chunks were then merged to generate and normalize the genome-wide contact map.<table-wrap id="Tab2"><label>Table 2</label><caption><p>HiC-Pro performance and comparison with hiclib</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>IMR90</th><th>IMR90</th><th>IMR90</th><th>IMR90_CCL186</th></tr></thead><tbody><tr><td>Number of reads</td><td>397,200,000</td><td>397,200,000</td><td>397,200,000</td><td>1,535,222,082</td></tr><tr><td>Pipeline</td><td>hiclib</td><td>HiC-Pro</td><td>HiC-Pro parallel</td><td>HiC-Pro parallel</td></tr><tr><td>Number of input files</td><td>10</td><td>10</td><td>84</td><td>160</td></tr><tr><td>Number of jobs</td><td>1</td><td>1</td><td>42</td><td>80</td></tr><tr><td>Number of CPUs per job</td><td>8</td><td>8</td><td>4</td><td>4</td></tr><tr><td>Maximum memory</td><td>10</td><td>7</td><td>7</td><td>24</td></tr><tr><td>Wall time</td><td>28:24</td><td>14:32</td><td>02:15</td><td>11:49</td></tr><tr><td> Mapping</td><td>22:03</td><td>10:31</td><td>00:21</td><td>05:56</td></tr><tr><td> Filtering</td><td>00:30</td><td>03:10</td><td>00:05</td><td>00:36</td></tr><tr><td> Merge</td><td/><td>00:20</td><td>00:18</td><td>00:50</td></tr><tr><td> Contacts maps</td><td>01:45</td><td>00:15</td><td>00:15</td><td>00:42</td></tr><tr><td>Normalization</td><td>04:06</td><td>01:16</td><td>01:16</td><td>03:49</td></tr></tbody></table><table-wrap-foot><p>HiC-Pro was run on the IMR90 Hi-C dataset from Dixon et al. and Rao et al. in order to generate contact maps at resolutions of 20 kb, 40 kb, 150 kb, 500 kb and 1 Mb. Contact maps at 5 kb were also generated for the IMR90_CCL186 dataset. The CPU time for each step of the pipeline is reported and compared with the hiclib Python library. The reported results include time of writing contact maps in text format. Times are minutes:seconds</p></table-wrap-foot></table-wrap></p>
      <p>In order to compare our results with the hiclib library, we ran HiC-Pro on the same dataset, and without initial read splitting, using eight CPUs. HiC-Pro performed the complete analysis in less than 15 hours compared with 28 hours for the hiclib pipeline. The main difference in speed is explained by our two-step mapping strategy compared with the iterative mapping strategy of hiclib, which aligned the 35 base pair (bp) reads in four steps. Optimization of the binning process and implementation of the normalization algorithm led to a three-fold decrease in time to generate and normalize the genome-wide contact map.</p>
      <p>The IMR90 sample from the Rao dataset (1.5 billion read pairs split into 160 read chunks) was processed in parallel using 320 CPUs to generate up to 5-kb contact maps in 12 hours, demonstrating the ability of HiC-Pro to analyze very large amounts of data in a reasonable time. At a 5-kb resolution, we observe the presence of chromatin loops as described by Rao et al. [<xref ref-type="bibr" rid="CR7">7</xref>] (Figure S1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The merged list of valid interactions was generated in less than 7.5 hours. Normalization of the genome-wide contact map at 1 Mb, 500 kb, 150 kb, 40 kb, 20 kb and 5 kb was performed in less than 4 hours. Details about the results and the implementation of the different solutions are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p>Finally, we compared the Hi-C processing results of hiclib and HiC-Pro on the IMR90 dataset. Although the processing and filtering steps of the two pipelines are not exactly the same, we observed a good concordance in the results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Using default parameters, HiC-Pro is less stringent than hiclib and used more valid interactions to build the contact maps. The two sets of normalized contact maps generated at different resolutions are highly similar (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). We further explored the similarity between the maps generated by the two pipelines by computing the Spearman correlation of the normalized intra-chromosomal maps. The average correlation coefficient across all chromosomes at different resolutions was 0.83 (0.65–0.95). Finally, since the inter-chromosomal data are usually very sparse, we summarized the inter-chromosomal signal using two one-dimensional coverage vectors of rows and columns [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. The average Spearman correlation coefficient of all coverage vectors between hiclib and HiC-Pro inter-chromosomal contact maps was 0.75 (0.46–0.98).<fig id="Fig1"><label>Fig. 1</label><caption><p>Comparison of HiC-Pro and hiclib processing. <bold>a</bold> Both pipelines generate concordant results across processing steps. The fraction of uniquely aligned read pairs is calculated on the total number of initial reads. Self-circle and dangling-end fractions are calculated on the total number of aligned read pairs. Intra- and inter-chromosomal contacts are calculated as a fraction of filtered valid interactions. <bold>b</bold> Boxplots of the Spearman correlation coefficients of intra- and inter-chromosomal maps generated at different resolutions by both pipelines. <bold>c</bold> Chromosome 6 contact maps generated by hiclib (<italic>top</italic>) and HiC-Pro (<italic>bottom</italic>) at different resolutions. The chromatin interaction data generated by the two pipelines are highly similar</p></caption><graphic xlink:href="13059_2015_831_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Implementation of the iterative correction algorithm</title>
      <p>We provide an implementation of the iterative correction procedure which emphasizes ease of use, performance, memory-efficiency and maintainability. We obtain higher or similar performance on a single core compared with the original ICE implementation from the hiclib library (Table <xref rid="Tab2" ref-type="table">2</xref>) and from the HiCorrector package [<xref ref-type="bibr" rid="CR20">20</xref>] (Table <xref rid="Tab3" ref-type="table">3</xref>).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance of iterative correction on IMR90 data</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>HiC-Pro – Iced (dense – 1 CPU)</th><th>HiC-Pro – Iced (sparse – 1 CPU)</th><th>HiCorrector – MES (dense – 1 CPU)</th><th>HiCorrector – MEP (dense – 8 CPUs)</th></tr></thead><tbody><tr><td>IMR90 1Mbp</td><td>00:00:12</td><td>00:00:25</td><td>00:00:25</td><td>00:00:06</td></tr><tr><td>IMR90 500 kbp</td><td>00:00:40</td><td>00:01:30</td><td>00:02:15</td><td>00:00:22</td></tr><tr><td>IMR90 150 kbp</td><td>-</td><td>00:04:28</td><td>00:13:21</td><td>00:03:10</td></tr><tr><td>IMR90 40 kbp</td><td>-</td><td>00:07:19</td><td>02:35:34</td><td>00:35:43</td></tr><tr><td>IMR90 2 0kbp</td><td>-</td><td>00:08:36</td><td>12:57:17</td><td>02:34:05</td></tr></tbody></table><table-wrap-foot><p>HiC-Pro is based on a fast implementation of the iterative correction algorithm. We therefore compare our method with the MES (Memory-Efficient Sequential) and MEP (Memory-Efficient Parallel) algorithms of the HiCorrector software [<xref ref-type="bibr" rid="CR20">20</xref>] for Hi-C data normalization (hours:minutes:seconds). All algorithms were terminated after 20 iterations (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details)</p></table-wrap-foot></table-wrap></p>
      <p>The HiCorrector package provides a parallel version of the iterative correction for dense matrices. We therefore compared the performance of HiCorrector with the HiC-Pro normalization at different Hi-C resolutions (Table <xref rid="Tab3" ref-type="table">3</xref>). All algorithms were terminated after 20 iterations for the purpose of performance comparison, as each iteration requires nearly the same running time. Choosing dense or sparse matrix-based implementation is dependent on the Hi-C data resolution and on the depth of coverage. Although our implementation can be run in either sparse or dense mode, the available data published at resolutions of 5–40 kb are currently characterized by a high degree of sparsity. At each level of Hi-C contact map resolution, we compared our dense or sparse implementation with the parallel and/or sequential version of HiCorrector. Our results demonstrate that using a compressed sparse row matrix structure is more efficient on high resolution contact maps (&lt;40 kb) than using parallel computing on dense matrices. As expected for low resolution contact maps (1 Mb, 500 kb), using a dense matrix implementation is more efficient in time, although the gain, in practice, remains negligible.</p>
      <p>The code for the normalization is available as a standalone package (<ext-link ext-link-type="uri" xlink:href="https://github.com/hiclib/iced">https://github.com/hiclib/iced</ext-link>) as well as being included in HiC-Pro. Our implementation based on sparse row matrices is able to normalize a 20-kb human genome map in less than 30 minutes with 5 GB of RAM (Table <xref rid="Tab3" ref-type="table">3</xref>). Genome-wide normalization at 5 kb can be achieved in less than 2.5 hours with 24 GB of RAM. Thus, compared to existing solutions, our implementation substantially speeds up and facilitates the normalization of Hi-C data prior to downstream analysis.</p>
    </sec>
    <sec id="Sec5">
      <title>Allele-specific contact maps</title>
      <p>We used HiC-Pro to generate allele-specific contact maps for the human GM12878 cell line. Differences in paternal and maternal X chromosome organization were recently described, with the presence of mega-domains on the inactive X chromosome, which are not seen in the active X chromosome [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. We used HiC-Pro to generate the maternal and paternal chromosome X contact maps of the GM12878 cell line using the Hi-C dataset published by Selvaraj et al. [<xref ref-type="bibr" rid="CR23">23</xref>]. Phasing data were gathered from the Illumina Platinum Genomes Project [<xref ref-type="bibr" rid="CR24">24</xref>]. Only good quality heterozygous phased single-nucleotide polymorphisms (SNPs) were selected. The final list contained 2,239,492 SNPs. We then masked the human genome hg19 by replacing the SNP position by an ‘N’ using the BEDTools utilities [<xref ref-type="bibr" rid="CR25">25</xref>] and generated the new bowtie2 indexes. In practice, the allele-specific analysis can be easily performed by simply specifying to HiC-Pro the list of SNPs and the N-masked indexes for read alignment through the configuration file.</p>
      <p>Among the initial 826 million read pairs, 61 % were classified as valid interactions by HiC-Pro. Around 6 % of valid interactions were then assigned to either the paternal or maternal genome and used to construct the haploid maps. As expected, the inactive X chromosome map is partitioned into two mega-domains (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The boundary between the two mega-domains lies near the DXZ4 micro-satellite.<fig id="Fig2"><label>Fig. 2</label><caption><p>Allele-specific analysis. <bold>a</bold> Allele-specific analysis of the GM12878 cell line. Phasing data were gathered from the Illumina Platinum Genomes Project. In total, 2,239,492 high quality SNPs from GM12878 data were used to distinguish both alleles. Around 6 % of the read pairs were assigned to each parental allele and used to build the allele-specific contact maps. <bold>b</bold> Intra-chromosomal contact maps of inactive and active X chromosome of the GM12878 cell line at 500-kb resolution. The inactive copy of chromosome X is partitioned into two mega-domains which are not seen in the active X chromosome. The boundary between the two mega-domains lies near the DXZ4 micro-satellite</p></caption><graphic xlink:href="13059_2015_831_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec id="Sec7">
      <title>HiC-Pro workflow</title>
      <p>HiC-Pro is organized into four distinct modules following the main steps of Hi-C data analysis: (i) read alignment, (ii) detection and filtering of valid interaction products, (iii) binning and (iv) contact map normalization (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>HiC-Pro workflow. Reads are first aligned on the reference genome. Only uniquely aligned reads are kept and assigned to a restriction fragment. Interactions are then classified and invalid pairs are discarded. If phased genotyping data and N-masked genome are provided, HiC-Pro will align the reads and assign them to a parental genome. For the Hi-C protocol based on restriction enzyme digestion, the read pairs will then be assigned to a restriction fragment and invalid ligation products will be filtered out. These first steps can be performed in parallel for each read chunk. Data from multiple chunks are then merged and binned to generate a single genome-wide interaction map. For allele-specific analysis, only pairs with at least one allele-specific read are used to build the contact maps. The normalization is finally applied to remove Hi-C systematic bias on the genome-wide contact map. <italic>MAPQ</italic> Mapping Quality , <italic>PE</italic> paired end</p></caption><graphic xlink:href="13059_2015_831_Fig3_HTML" id="MO3"/></fig></p>
      <sec id="Sec8">
        <title>Mapping</title>
        <p>Read pairs are first independently aligned on the reference genome to avoid any constraint on the proximity between the two reads. Most read pairs are expected to be uniquely aligned on the reference genome. A few percent, however, are likely to be chimeric reads, meaning that at least one read spans the ligation junction and therefore both interacting loci. As an alternative to the iterative mapping strategy proposed by Imakaev et al. [<xref ref-type="bibr" rid="CR17">17</xref>], we propose a two-step approach to rescue and align those reads (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). Reads are first aligned on the reference genome using the bowtie2 end-to-end algorithm [<xref ref-type="bibr" rid="CR26">26</xref>]. At this point, unmapped reads are mainly composed of chimeric fragments spanning the ligation junction. According to the Hi-C protocol and the fill-in strategy, HiC-Pro is then able to detect the ligation site using an exact matching procedure and to align back on the genome the 5′ fraction of the read. Both mapping steps are then merged in a single alignment file. Low mapping quality reads, multiple hits and singletons can be discarded.<fig id="Fig4"><label>Fig. 4</label><caption><p>Read pair alignment and filtering. <bold>a</bold> Read pairs are first independently aligned to the reference genome using an end-to-end algorithm. Then, reads spanning the ligation junction which were not aligned in the first step are trimmed at the ligation site and their 5′ extremity is realigned on the genome. All aligned reads after these two steps are used for further analysis. <bold>b</bold> According to the Hi-C protocol, digested fragments are ligated together to generate Hi-C products. A valid Hi-C product is expected to involve two different restriction fragments. Read pairs aligned on the same restriction fragment are classified as dangling end or self-circle products, and are not used to generate the contact maps. <italic>PE</italic> paired end, <italic>LS Ligation Site </italic>
</p></caption><graphic xlink:href="13059_2015_831_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec9">
        <title>Detection of valid interactions</title>
        <p>Each aligned read can be assigned to one restriction fragment according to the reference genome and the selected restriction enzyme. Both reads are expected to map near a restriction site, and with a distance within the range of molecule size distribution after shearing. Fragments with a size outside the expected range can be discarded if specified but are usually the result of random breaks or star activity of the enzyme, and can therefore be included in downstream analysis [<xref ref-type="bibr" rid="CR17">17</xref>]. Read pairs from invalid ligation products, such as dangling end and self-circle ligation, are discarded (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). Only valid pairs involving two different restriction fragments are used to build the contact maps. Duplicated valid pairs due to PCR artifacts can also be filtered out. Each read is finally tagged in a BAM file according to its mapping and fragment properties (Figure S2 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In the context of Hi-C methods which are not based on restriction enzyme digestion, no filtering of restriction fragments is applied. The uniquely mapped read pairs are directly used to build the contact maps. However, one way to filter out artifacts such as self-ligation is to discard intra-chromosomal pairs below a given distance threshold [<xref ref-type="bibr" rid="CR4">4</xref>]. HiC-Pro therefore allows these short range contacts to be filtered out.</p>
      </sec>
      <sec id="Sec10">
        <title>Binning</title>
        <p>In order to generate the contact maps, the genome is divided into bins of equal size, and the number of contacts observed between each pair of bins is reported. A single genome-wide interaction map containing both raw intra- and inter-chromosomal maps is generated for a set of resolutions defined by the user in the configuration file.</p>
      </sec>
      <sec id="Sec11">
        <title>Normalization</title>
        <p>In theory, the raw contact counts are expected to be proportional to the true contact frequency between two loci. As for any sequencing experiment, however, it is known that Hi-C data contain different biases mainly due to GC content, mappability and effective fragment length [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. An appropriate normalization method is therefore mandatory to correct for these biases. Over the last few years, several methods have been proposed using either an explicit-factor model for bias correction [<xref ref-type="bibr" rid="CR19">19</xref>] or implicit matrix balancing algorithm [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Among the matrix balancing algorithm, the iterative correction of biases based on the Sinkhorn-Knopp algorithm has been widely used by recent studies due to its conceptual simplicity, parameter-free nature and ability to correct for unknown biases, although its assumption of equal visibility across all loci may require further exploration. In theory, a genome-wide interaction matrix is of size O(N<sup>2</sup>), where N is the number of genomic bins. Therefore, applying a balancing algorithm on such a matrix can be difficult in practice, as it requires a significant amount of memory and computational time. The degree of sparsity of the Hi-C data is dependent on the bin size and on the sequencing depth of coverage. Even for extremely large sequencing coverage, the interaction frequency between intra-chromosomal loci is expected to decrease as the genomic distance between them increases. High-resolution data are therefore usually associated with a high level of sparsity. Exploiting matrix sparsity in the implementation can improve the performance of the balancing algorithm for high-resolution data. HiC-Pro proposes a fast sparse-based implementation of the iterative correction method [<xref ref-type="bibr" rid="CR17">17</xref>], allowing normalization of genome-wide high-resolution contact matrices in a short time and with reasonable memory requirements.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Quality controls</title>
      <p>To assess the quality of a Hi-C experiment, HiC-Pro performs a variety of quality controls at different steps of the pipeline (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The alignment statistics are the first available quality metric. According to the reference genome, a high-quality Hi-C experiment is usually associated with a high mapping rate. The number of reads aligned in the second mapping step is also an interesting control as it reflects the proportion of reads spanning the ligation junction. An abnormal level of chimeric reads can reflect a ligation issue during library preparation. Once the reads are aligned on the genome, the fraction of singleton or multiple hits is usually expected to be low. The ligation efficiency can also be assessed using the filtering of valid and invalid pairs. As ligation is a random process, it is expected that 25 % of each valid ligation class will be defined by distinct read pair orientation. In the same way, a high level of dangling-end or self-circle read pairs is associated with a bad quality experiment, and reveals a problem during the digestion, fill-in or ligation steps.<fig id="Fig5"><label>Fig. 5</label><caption><p>HiC-Pro quality controls. Quality controls reported by HiC-Pro (IMR90, Dixon et al. data). <bold>a</bold> Quality control on read alignment and pairing. Low quality alignment, singleton and multiple hits are usually removed at this step. <bold>b</bold> Read pair filtering. Read pairs are assigned to a restriction fragment. Invalid pairs, such as dangling-end and self-circle, are good indicators of the library quality and are tracked but discarded for subsequent further analysis. The fractions of duplicated reads, as well as short range versus long range interactions, are also reported</p></caption><graphic xlink:href="13059_2015_831_Fig5_HTML" id="MO5"/></fig></p>
      <p>Additional quality controls, such as fragment size distribution, can be extracted from the list of valid interaction products (Figure S3 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). A high level of duplication indicates poor molecular complexity and a potential PCR bias. Finally, an important metric is the fraction of intra- and inter-chromosomal interactions, as well as long-range versus short-range intra-chromosomal interactions. As two genomic loci close on the linear genome are more likely to randomly interact, a strong diagonal is expected on the raw contact maps. A low quality experiment will result in a low fraction of intra-chromosomal interactions depending on the organism and the biological context. A high quality Hi-C experiment on the human genome is typically characterized by at least 40 % of intra-chromosomal interactions [<xref ref-type="bibr" rid="CR9">9</xref>]. In the same way, a high quality experiment is usually characterized by a significant fraction (&gt;40 %) of long-range intra-chromosomal valid pairs [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Speed and scalability</title>
      <p>Generating genome-wide contact maps at 40 to 1 kb resolution requires a sequencing depth of hundreds of millions to multi-billions of paired-end reads depending on the organism [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. However, the main processing steps from read mapping to fragment reconstruction can be optimized using parallel computation of read chunks, significantly reducing the time taken by the Hi-C data processing. Next, all valid interactions are merged to remove the duplicates and to generate the final contact maps.</p>
      <p>The user can easily run the complete analysis workflow with a single command line either on a single laptop or on a computer cluster. Analysis parameters are all defined in a single configuration file. In addition, HiC-Pro is modular and sequential, allowing the user to focus on a sub-part of the processing without running the complete workflow. In this way, HiC-Pro can also be used to complement other methods, for instance, by running the workflow from already aligned files, or by simply normalizing published raw contact maps.</p>
      <p>The main steps of the pipeline are implemented in Python and C++ programming languages and are based on efficient data structures, such as compressed sparse row matrices for contact count data. Using an adequate data structure allows the data processing to be sped up as well circumvents memory limitations. In this way, HiC-Pro allows a genome-wide iterative correction to be run at very high resolution and in a short time. Our normalization implementation exploits <italic>numpy</italic>’s dense array format and fast operations, <italic>scipy</italic>’s sparse matrices representation and <italic>Cython</italic> to combine C and Python to reach the performance of C executables with the ease of use and maintainability of the Python language.</p>
    </sec>
    <sec id="Sec14">
      <title>Contact map storage</title>
      <p>Genome-wide contact maps are generated for resolutions defined by the user. A contact map is defined as a matrix of contact counts and a description of the associated genomic bins and is usually stored as a matrix, divided into bins of equal size. The bin size represents the resolution at which the data will be analyzed. For instance, a human 20 kb genome-wide map is represented by a square matrix of 150,000 rows and columns, which can be difficult to manage in practice. To address this issue, we propose a standard contact map format based on two main observations. Contact maps at high resolution are (i) usually sparse and (ii) expected to be symmetric. Storing the non-null contacts from half of the matrix is therefore enough to summarize all the contact frequencies. Using this format leads to a 10–150-fold reduction in disk space use compared with the dense format (Table <xref rid="Tab4" ref-type="table">4</xref>).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Comparison of contact map formats</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Dense format (MB)</th><th>Sparse symmetric format (MB)</th></tr></thead><tbody><tr><td>IMR90_CCL186 1 Mbp</td><td>27</td><td>49</td></tr><tr><td>IMR90_CL186 500 kbp</td><td>82</td><td>181</td></tr><tr><td>IMR90_CCL186 150 kbp</td><td>822</td><td>911</td></tr><tr><td>IMR90_CCL186 40 kbp</td><td>12,000</td><td>1900</td></tr><tr><td>IMR90_CL186 20 kbp</td><td>45,000</td><td>2600</td></tr><tr><td>IMR90_CL186 5 kbp</td><td>720,000</td><td>4200</td></tr></tbody></table><table-wrap-foot><p>Disk space for IMR90_CCL186 genome-wide contact maps generated using either the classical dense format or the sparse symmetric format at different resolutions</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec15">
      <title>Allele-specific analysis</title>
      <p>HiC-Pro is able to incorporate phased haplotype information in the Hi-C data processing in order to generate allele-specific contact maps (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In this context, the sequencing reads are first aligned on a reference genome for which all polymorphic sites were first N-masked. This masking strategy avoids systematic bias toward the reference allele, compared with the standard procedure where reads are mapped on an unmasked genome. Once aligned, HiC-Pro browses all reads spanning a polymorphic site, locates the nucleotide at the appropriate position, and assigns the read to either the maternal or paternal allele. Reads without SNP information as well as reads with conflicting allele assignment or unexpected alleles at polymorphic sites are flagged as unassigned. A BAM file with an allele-specific tag for each read is generated and can be used for further analysis. Then, we classify as allele-specific all pairs for which both reads are assigned to the same parental allele or for which one read is assigned to one parental allele and the other is unassigned. These allele-specific read pairs are then used to generate a genome-wide contact map for each parental genome. Finally, the two allele-specific genome-wide contact maps are independently normalized using the iterative correction algorithm.</p>
    </sec>
    <sec id="Sec16">
      <title>Software requirements</title>
      <p>The following additional software and libraries are required: the bowtie2 mapper [<xref ref-type="bibr" rid="CR26">26</xref>], R and the BioConductor packages <italic>RColorBrewer</italic>, <italic>ggplot2</italic>, <italic>grid</italic>, Samtools (&gt;0.1.19), Python (&gt;2.7) with the <italic>pysam</italic>, <italic>bx.python</italic>, <italic>numpy</italic> and <italic>scipy</italic> libraries, and the g++ compiler. Note that a bowtie2 version &gt; 2.2.2 is strongly recommended for allele-specific analysis, because, since this version, read alignment on an N-masked genome has been highly improved. Most of the installation steps are fully automatic using a simple command line. The bowtie2 and Samtools software are automatically downloaded and installed if not detected on the system. The HiC-Pro pipeline can be installed on a Linux/UNIX-like operating system.</p>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Conclusions</title>
    <p>As the Hi-C technique is maturing, it is now important to develop bioinformatics solutions which can be shared and used for any project. HiC-Pro is a flexible and efficient pipeline for Hi-C data processing. It is freely available under the BSD licence as a collaborative project at <ext-link ext-link-type="uri" xlink:href="https://github.com/nservant/HiC-Pro">https://github.com/nservant/HiC-Pro</ext-link>. It is optimized to address the challenge of processing high-resolution data and provides an efficient format for contact map sharing. In addition, for ease of use, HiC-Pro performs quality controls and can process Hi-C data from the raw sequencing reads to the normalized and ready-to-use genome-wide contact maps. HiC-Pro can process data generated from protocols based on restriction enzyme or nuclease digestion. The intra- and inter-chromosomal contact maps generated by HiC-Pro are highly similar to the ones generated by the hiclib package. In addition, when phased genotyping data are available, HiC-Pro allows the easy generation of allele-specific maps for homologous chromosomes. Finally, HiC-Pro includes an optimized version of the iterative correction algorithm, which substantially speeds up and facilitates the normalization of Hi-C data. The code is also available as a standalone package (<ext-link ext-link-type="uri" xlink:href="https://github.com/hiclib/iced">https://github.com/hiclib/iced</ext-link>).</p>
    <p>A complete online manual is available at <ext-link ext-link-type="uri" xlink:href="http://nservant.github.io/HiC-Pro">http://nservant.github.io/HiC-Pro</ext-link>. The raw and normalized contact maps are compatible with the HiTC Bioconductor package [<xref ref-type="bibr" rid="CR28">28</xref>], and can therefore be loaded in the R environment for visualization and further analysis.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec18">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13059_2015_831_MOESM1_ESM.docx" id="MOESM1">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>The supplementary data file contains a description of the dataset used for this study as well as details about how the HiC-Pro, hiclib and HiCorrector software were used in practice.</bold> It also includes supplementary figures about the HiC-Pro results and output. (DOCX 1452 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>PCR</term>
        <def>
          <p>polymerase chain reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>single-nucleotide polymorphism</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>N.S., B.R., C.C., J.D., E.H. and E.B. designed the main steps of the Hi-C analysis workflow. N.V. and J.V. developed the new iterative correction implementation. N.S., E.V., B.R. and N.V. developed, optimized and tested the HiC-Pro pipeline. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Felix Krueger for useful discussion about allele-specific analysis, and Jesse Dixon and Neva Cherniavsky for their advice in defining the best GM12878 phasing data. This work was supported by the France Genomique National infrastructure (ANR-10-INBS-09), the Labex Deep, the European Research Coucil (SMAC-ERC-280032), the ERC Advanced Investigator award (ERC-250367), the European Commission (HEALTH-F5-2012-305626), the ABS4NGS project (ANR-11-BINF-0001), the National Human Genome Research Institute (R01 HG003143), and the Paris Alliance of Cancer Research Institutes (PACRI-ANR). J.D. is an Investigator of the Howard Hughes Medical Institute.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Wit</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>de Laat</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A decade of 3C technologies: insights into nuclear organization</article-title>
        <source>Genes Dev.</source>
        <year>2012</year>
        <volume>26</volume>
        <fpage>11</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.179804.111</pub-id>
        <?supplied-pmid 22215806?>
        <pub-id pub-id-type="pmid">22215806</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Barutcu AR, Fritz AJ, Sayyed KZ, van Wijnen AJ, Lian JB, Stein JL, et al. C-ing the genome: A compendium of chromosome conformation capture methods to study higher-order chromatin organization. J Cell Physiol. 2015;1097–4652. doi:10.1002/jcp.25062.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5950</issue>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <?supplied-pmid 19815776?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gulsoy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fine-scale chromatin interaction maps reveal the cis-regulatory landscape of lincRNA genes in human cells</article-title>
        <source>Nat Methods.</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>71</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3205</pub-id>
        <?supplied-pmid 25437436?>
        <pub-id pub-id-type="pmid">25437436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nora</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Giorgetti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Servant</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial partitioning of the regulatory landscape of the x-inactivation centre</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7398</issue>
        <fpage>381</fpage>
        <lpage>385</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11049</pub-id>
        <?supplied-pmid 22495304?>
        <pub-id pub-id-type="pmid">22495304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7398</issue>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <?supplied-pmid 22495300?>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>SID</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Sanborn</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3d map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <issue>7</issue>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-resolution map of the three-dimensional chromatin interactome in human cells</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>503</volume>
        <issue>7475</issue>
        <fpage>290</fpage>
        <lpage>294</lpage>
        <?supplied-pmid 24141950?>
        <pub-id pub-id-type="pmid">24141950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The hitchhiker’s guide to hi-c analysis: Practical guidelines</article-title>
        <source>Methods.</source>
        <year>2015</year>
        <volume>72</volume>
        <fpage>65</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2014.10.031</pub-id>
        <?supplied-pmid 25448293?>
        <pub-id pub-id-type="pmid">25448293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Lasio</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>4</issue>
        <fpage>576</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <?supplied-pmid 20513432?>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">HiCUP. <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/hicup/">http://www.bioinformatics.babraham.ac.uk/projects/hicup/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Castellano G, Le Dily F, Hermoso Pulido A, Beato M, Roma G. Hi-Cpipe: a pipeline for high-throughput chromosome capture<italic>.</italic> bioRxiv 2015. Cold Spring Harbor Labs Journals. doi:10.1101/020636.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmid Marc</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Grob</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grossniklaus</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>HiCdat: a fast and easy-to-use Hi-C data analysis tool</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>277</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0678-x</pub-id>
        <?supplied-pmid 26334796?>
        <pub-id pub-id-type="pmid">26334796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">HiCbox. <ext-link ext-link-type="uri" xlink:href="https://github.com/koszullab/HiC-Box">https://github.com/koszullab/HiC-Box</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">SNPsplit. <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/SNPsplit/">http://www.bioinformatics.babraham.ac.uk/projects/SNPsplit/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsieh</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rando</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Mapping nucleosome resolution chromosome folding in yeast by micro-C</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <issue>1</issue>
        <fpage>108</fpage>
        <lpage>119</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.048</pub-id>
        <?supplied-pmid 26119342?>
        <pub-id pub-id-type="pmid">26119342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Patton McCord</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Iterative correction of hi-c data reveals hallmarks of chromosome organization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id>
        <?supplied-pmid 22941365?>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic modelling of Hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <issue>11</issue>
        <fpage>1059</fpage>
        <lpage>1065</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.947</pub-id>
        <?supplied-pmid 22001755?>
        <pub-id pub-id-type="pmid">22001755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>HiCNorm: removing biases in Hi-C data via poisson regression</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>23</issue>
        <fpage>3131</fpage>
        <lpage>3133</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts570</pub-id>
        <?supplied-pmid 23023982?>
        <pub-id pub-id-type="pmid">23023982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Alber Fand Zhou</surname>
            <given-names>XJ</given-names>
          </name>
        </person-group>
        <article-title>Hi-Corrector: a fast, scalable and memory-efficient package for normalizing large-scale hi-c data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>960</fpage>
        <lpage>962</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu747</pub-id>
        <?supplied-pmid 25391400?>
        <pub-id pub-id-type="pmid">25391400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Minajigi A, Froberg JE, Wei C, Sunwoo H, Kesner B, Colognori D, et al. A comprehensive Xist interactome reveals cohesin repulsion and an RNA-directed chromosome conformation. Science. 2015;349(6245):aab2276. doi:10.1126/science.aab2276.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ramani</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bipartite structure of the inactive mouse X chromosome</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>152</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0728-8</pub-id>
        <?supplied-pmid 26248554?>
        <pub-id pub-id-type="pmid">26248554</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome haplotype reconstruction using proximity-ligation ans shotgun sequencing</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>1111</fpage>
        <lpage>1118</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2728</pub-id>
        <?supplied-pmid 24185094?>
        <pub-id pub-id-type="pmid">24185094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Platinum Illumina Genomes Project. <ext-link ext-link-type="uri" xlink:href="http://www.illumina.com/platinumgenomes/">http://www.illumina.com/platinumgenomes/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <?supplied-pmid 20110278?>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie2</article-title>
        <source>Nat Methods.</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cournac</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marie-Nelly</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mozziconacci</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Normalization of a chromosomal contact map</article-title>
        <source>BMC Genomics.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>436</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-436</pub-id>
        <?supplied-pmid 22935139?>
        <pub-id pub-id-type="pmid">22935139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Servant</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Nora</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Giorgetti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HiTC: Exploration of high-throughput ‘C’ experiments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>21</issue>
        <fpage>2843</fpage>
        <lpage>2844</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts521</pub-id>
        <?supplied-pmid 22923296?>
        <pub-id pub-id-type="pmid">22923296</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
