<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10436670</article-id>
    <article-id pub-id-type="pmid">37596691</article-id>
    <article-id pub-id-type="publisher-id">3034</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-03034-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GTM-decon: guided-topic modeling of single-cell transcriptomes enables sub-cell-type and disease-subtype deconvolution of bulk transcriptomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Swapna</surname>
          <given-names>Lakshmipuram Seshadri</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3844-4865</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Yue</given-names>
        </name>
        <address>
          <email>yueli@cs.mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01pxwe438</institution-id><institution-id institution-id-type="GRID">grid.14709.3b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8649</institution-id><institution>School of Computer Science, </institution><institution>McGill University, </institution></institution-wrap>Montreal, QC Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>190</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Cell-type composition is an important indicator of health. We present Guided Topic Model for deconvolution (GTM-decon) to automatically infer cell-type-specific gene topic distributions from single-cell RNA-seq data for deconvolving bulk transcriptomes. GTM-decon performs competitively on deconvolving simulated and real bulk data compared with the state-of-the-art methods. Moreover, as demonstrated in deconvolving disease transcriptomes, GTM-decon can infer multiple cell-type-specific gene topic distributions per cell type, which captures sub-cell-type variations. GTM-decon can also use phenotype labels from single-cell or bulk data to infer phenotype-specific gene distributions. In a nested-guided design, GTM-decon identified cell-type-specific differentially expressed genes from bulk breast cancer transcriptomes.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-03034-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Cell-type deconvolution</kwd>
      <kwd>Single-cell transcriptome</kwd>
      <kwd>Topic models</kwd>
      <kwd>Variational inference</kwd>
      <kwd>Bayesian modeling</kwd>
      <kwd>Type 2 diabetes</kwd>
      <kwd>Cancer transcriptome</kwd>
      <kwd>Disease biomarkers</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NFRFE-2019-00980</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Yue</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001804</institution-id>
            <institution>Canada Research Chairs</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CRC-2021-00547</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Yue</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Cell-type composition and its relative proportions in a tissue is an indicator of health. For example, several studies have shown that type 2 diabetes is characterized by reduced beta cell mass and number in pancreatic tissue [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. In acute myeloid leukemia (AML), cell-type abundance variation between patients was indicative of degree of malignancy [<xref ref-type="bibr" rid="CR3">3</xref>]. Experimental approaches such as fluorescence-activated cell sorting (FACS) and immunohistochemistry (IHC) are used to elucidate cell-type composition of biological samples. Single-cell RNA-sequencing (scRNA-seq) technology enables high-resolution cell-type-specific (CTS) transcriptome analysis, providing molecular insights into the cell-type composition, cell-state behavior, and cell-type heterogeneity [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. In the context of cancer research, scRNA-seq has led to identification of distinct cancer cell states. These are shown to occur across a range of cancer types and are implicated in tumor progression, with high cell-type heterogeneity associated with poor prognostic outcomes [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. However, challenges such as high cost, lower throughput, and difficulties in dissociation of cell types in solid samples make it hard to apply these experimental approaches at the patient population scale.</p>
    <p id="Par3">On the other hand, bulk RNA-seq has been the workhorse behind transcriptome research over the past decades. Its falling costs and ease of experimental setup make it an attractive tool to work with any organism [<xref ref-type="bibr" rid="CR10">10</xref>]. Several databases host tremendous amounts of bulk RNA-seq data such as Gene Expression Omnibus (GEO) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], Genotype-Tissue Expression (GTEx) [<xref ref-type="bibr" rid="CR13">13</xref>], and The Cancer Genome Atlas (TCGA), a repository of bulk RNA-seq data for more than 11,000 primary cancer samples [<xref ref-type="bibr" rid="CR14">14</xref>]. However, bulk RNA-seq data are mixture of gene expression profiles in the tissue. Computational approaches have been developed to deconvolve these bulk RNA-seq profiles into their constituent cell types in the form of cell-type proportions, since these are substantially cheaper and easier to obtain than conducting scRNA-seq experiments. Moreover, deconvolving the bulk data into constituent cell-type components can not only yield the cell-type proportions facilitating clinical investigation but also enable high-resolution differential analysis of gene expression. Studying the differentially expressed genes at the cell-type or cell-state level can help uncover gene regulatory programs that drive different tissue states. Many deconvolution methods were developed to this end.</p>
    <p id="Par4">Most of the deconvolution approaches require a set of gene markers for each cell type of interest. These marker genes are derived from expert knowledge or differential expression analysis of purified samples of specific cell types. Early methods that leverage these marker genes could achieve good performance in deconvolving mixtures with highly distinct cell types such as blood [<xref ref-type="bibr" rid="CR15">15</xref>]. CIBERSORT improved on these approaches by incorporating a feature selection step, where genes are adaptively selected from the signature matrix based on the input bulk RNA-seq data [<xref ref-type="bibr" rid="CR16">16</xref>]. It uses a linear support vector regression (SVR) to delineate closely related cell types such as leukocytes. BSEQ-sc combined with CIBERSORT was an early method that used scRNA-seq data as a reference for bulk deconvolution [<xref ref-type="bibr" rid="CR17">17</xref>]. CIBERSORTx also uses scRNA-seq as reference profiles, along with improved normalization schemes to suppress cross-platform variation, and an adaptive noise filter to eliminate unreliably estimated genes [<xref ref-type="bibr" rid="CR18">18</xref>]. MuSiC adopts a weighted non-negative least-squares regression approach and addresses the issue of cross-subject heterogeneity as well as within-cell-type variation of gene expression [<xref ref-type="bibr" rid="CR19">19</xref>]. EPIC accommodates user-defined reference profiles to account for the presence of uncharacterized cell types in the target bulk samples [<xref ref-type="bibr" rid="CR20">20</xref>]. Bisque learns gene-specific transformations of the bulk data based on the single-cell reference profiles and the corresponding cell proportions to account for their differences [<xref ref-type="bibr" rid="CR21">21</xref>]. BayesPrism uses Bayesian inference to model scRNA-seq data jointly with bulk RNA-seq data to infer cell-type composition and their proportions [<xref ref-type="bibr" rid="CR22">22</xref>]. The joint modeling overcomes biases that may arise due to technical and biological differences. Beyond cell-type deconvolution, some recently developed methods can estimate CTS gene expression from the bulk samples [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. However, these methods rely on an external cell-type deconvolution method like those aforementioned ones and do not utilize or model the distribution of the scRNA-seq reference data to properly express statistical uncertainty while leveraging their information richness.</p>
    <p id="Par5">In this study, we present a guided topic model for cell-type deconvolution (GTM-decon). As an overview of our analysis, we first benchmark GTM-decon on deconvolving simulated and real bulk data in comparison with the state-of-the-art deconvolution methods. We then train GTM-decon on pancreatic and breast scRNA-seq datasets to deconvolve bulk RNA-seq datasets from pancreatic and breast tissues, respectively. When applied to deconvolving cancer bulk transcriptomes, GTM-decon successfully identifies the cell type of origin for pancreatic and breast cancer datasets. Interestingly, the results for human pancreatic cancer are recapitulated using the CTS topics inferred from the mouse pancreas scRNA-seq data, postulating cross-species deconvolution as an option where it is difficult to obtain scRNA-seq data due to technical or ethical challenges. Furthermore, our GTM framework also enables the inference of phenotype-specific topic distributions from bulk RNA-seq data by using the phenotypes (e.g., breast cancer subtypes) from single cell or bulk RNA-seq data as a guide for the topic inference. We leverage this capability to distinguish basal from estrogen receptor (ER) positive (ER +) breast tumor samples, not only achieving high classification accuracy but also identifying the genes and pathways that segregate the cancer subtypes. By fine-tuning the inferred CTS topic distributions guided by the breast cancer subtypes, we deconvolve the average differential gene expression into CTS expression changes, thereby enabling discovery of the subtype-specific aberrance of the gene regulatory programs.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>GTM-decon model overview</title>
      <p id="Par6">In GTM-decon, we have made <italic>three methodological contributions</italic>. As our <italic>first and the main contribution</italic>, GTM-decon is a marker-free method and automatically infers the contribution of each gene for each cell type in the form of CTS categorical distributions, which we define as “topics” [<xref ref-type="bibr" rid="CR25">25</xref>], without using marker gene information. Each CTS topic distribution is related to the transcriptional rate of each gene for each cell type. For instance, B cells have higher transcription rate for <italic>CD19</italic> compared to alpha cells, which have relatively high rate for <italic>FXYD5</italic>. Conceptually, we consider genes as vocabulary and cells as documents whose word tokens (i.e., scRNA-seq reads) are sampled from the vocabulary with the CTS topic probabilities. We incorporate the observed cell-type labels for each cell in the form of topic prior to guide the inference of CTS topic mixture, which reflects the uncertainty of the noisy cell-type label. Specifically, the cell-type mixture for cell <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M2"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq1.gif"/></alternatives></inline-formula> follows a K-dimensional asymmetric Dirichlet distribution, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}\sim Dir\left({{\varvec{\upalpha}}}_{m}+0.1\right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq2.gif"/></alternatives></inline-formula>, with the hyperparameter <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq3.gif"/></alternatives></inline-formula> set to a relatively high value (i.e., 0.9 by default) given the cell-type label <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}=k$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq4.gif"/></alternatives></inline-formula>; the rest of the K-1 <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{\alpha }}_{m,{\mathrm{k}}{\prime}}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq5.gif"/></alternatives></inline-formula> values, where <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\ne {k}{\prime}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq6.gif"/></alternatives></inline-formula>, are set to a relatively low values (i.e., randomly sampled from a range between 0.1 and 0.01). As a result, each topic is automatically identified with exactly one cell type. This differs from the standard topic model, where topics are not directly associated with any known concept and require post hoc manual inspection based on their top scoring words to interpret them. Given the CTS gene distributions, we can infer the CTS topic mixtures from the bulk transcriptomes, which are the desired cell-type mixing proportion in the context of deconvolution (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a).<fig id="Fig1"><label>Fig. 1</label><caption><p>GTM-decon overview. <bold>a</bold> Inferring cell-type-specific (CTS) topics from scRNA-seq reference data. In brief, GTM-decon infers CTS topics from scRNA-seq data by using a guided topic modeling approach utilizing cell-type labels from the reference. High prior values are assigned to the topic corresponding to the cell type, and lower prior values are assigned to the other topics, enabling it to learn a genes-by-CTS topics matrix, with each topic anchored to a specific cell type. This matrix is used to infer cell-type proportions in bulk RNA-seq data using standard topic modeling, capturing variations in cell type proportions between healthy and diseased tissue. The probabilistic graphical model (PGM) diagram depicts the data generative process assumed by the proposed guided topic model. Suppose there are K cell types in the scRNA-seq data. For each cell indexed by <inline-formula id="IEq145"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m\in \{1,\dots ,M\}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq145.gif"/></alternatives></inline-formula>, we use K-dimensional Dirichlet-distributed cell-type topic mixture <inline-formula id="IEq146"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}\sim \mathrm{Dir}({{\varvec{\upalpha}}}_{m})$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq146.gif"/></alternatives></inline-formula> to represent the statistical uncertainty of the noisy cell-type label <inline-formula id="IEq147"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq147.gif"/></alternatives></inline-formula>. Specifically, we clamp the Dirichlet hyperparameter <inline-formula id="IEq148"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{y}_{m}}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq148.gif"/></alternatives></inline-formula> of the Dirichlet variable to a relatively high value while setting the rest of the values of <inline-formula id="IEq149"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq149.gif"/></alternatives></inline-formula> (<inline-formula id="IEq150"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\ne {k}{\prime}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq150.gif"/></alternatives></inline-formula>) to relatively low values (i.e., 0.9 and [0.01, 0.1], respectively in the cartoon illustration of <italic>M</italic> = 8 cells and <italic>K</italic> = 3 cell types). The non-zero prior values for the <italic>K</italic> – 1 unobserved cell types allow the cell-type mixture variable <inline-formula id="IEq151"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq151.gif"/></alternatives></inline-formula> to have non-zero density over those cell types as dictated by the scRNA-seq data likelihood and therefore account for potentially mislabeled cell types. Suppose there are in total <inline-formula id="IEq152"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{m}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq152.gif"/></alternatives></inline-formula> reads in cell <inline-formula id="IEq153"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M30"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq153.gif"/></alternatives></inline-formula>. Each scRNA-seq read <inline-formula id="IEq154"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \left\{1,\dots ,{N}_{m}\right\}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq154.gif"/></alternatives></inline-formula> is assumed to be originated from one of the K CTS topics with the categorical rates fixed to the cell-type mixture, i.e., <inline-formula id="IEq155"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m} \sim \mathrm{Cat}({{\varvec{\uptheta}}}_{m})$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq155.gif"/></alternatives></inline-formula>. Given cell-type topic assignment <inline-formula id="IEq156"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq156.gif"/></alternatives></inline-formula>, the <italic>i</italic>th read is then mapped to one of the G genes as indexed by <inline-formula id="IEq157"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq157.gif"/></alternatives></inline-formula> with categorical rates set to be <inline-formula id="IEq158"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\upphi}}{}_{{z}_{i,m}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:msub><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq158.gif"/></alternatives></inline-formula>, which itself is a G-dimensional Dirichlet variable of flat hyperparameter <inline-formula id="IEq159"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M42"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq159.gif"/></alternatives></inline-formula>, i.e., <inline-formula id="IEq160"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}\sim \mathrm{Cat}({{\varvec{\upphi}}}_{{z}_{i,m}})$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq160.gif"/></alternatives></inline-formula>. To infer the latent variables, namely cell-type mixture proportion <inline-formula id="IEq161"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}\sim \mathrm{Dir}(\mathrm{\alpha })$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq161.gif"/></alternatives></inline-formula>, CTS topic assignments for each read <inline-formula id="IEq162"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq162.gif"/></alternatives></inline-formula>, and CTS topic distributions <inline-formula id="IEq163"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\Phi}}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq163.gif"/></alternatives></inline-formula>, we employ an efficient collapsed variational Bayes algorithm as detailed in the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section. The genes-by-CTS-topic <inline-formula id="IEq164"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M52"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq164.gif"/></alternatives></inline-formula> matrix estimated from the scRNA-seq reference then serves as a template when it comes to infer the cell-type mixing proportions <inline-formula id="IEq165"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uptheta }_{j}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq165.gif"/></alternatives></inline-formula> of a bulk RNA-seq sample <italic>j</italic> using essentially the same inference algorithm as in the scRNA-seq data modeling except for having a flat hyperparameter for the prior (e.g., <inline-formula id="IEq166"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{k}=1\forall k$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∀</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq166.gif"/></alternatives></inline-formula> by default) while fixing <inline-formula id="IEq167"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M58"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq167.gif"/></alternatives></inline-formula> and only inferring the expected total reads allocated for each CTS topics (i.e., <inline-formula id="IEq168"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{E}_{q}[n}_{.,j,k}]={E}_{q}[{\sum }_{i}[{z}_{i,j}=k]$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo></mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq168.gif"/></alternatives></inline-formula>]). <bold>b</bold> Phenotype-guided modeling of bulk RNA-seq data. GTM-decon can also use phenotype labels as a guide for topic inference to model sparsified bulk transcriptomes in a disease study. In this design, instead of having each row as a cell and each column as a cell type, each row corresponds to a bulk sample and each column to a phenotype class. For each subject <italic>j</italic>, we set the topic hyperparameter <inline-formula id="IEq169"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{j,{y}_{j}}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq169.gif"/></alternatives></inline-formula> based on the noisy phenotype label <inline-formula id="IEq170"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{j}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq170.gif"/></alternatives></inline-formula> of the subject. The inference algorithm is the same as in modeling the scRNA-seq reference data. Given a test subject <inline-formula id="IEq171"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j}{\prime}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq171.gif"/></alternatives></inline-formula>, the inferred topic mixture <inline-formula id="IEq172"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{{j}{\prime}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq172.gif"/></alternatives></inline-formula> represents the phenotypic probabilities of the subject. <bold>c</bold> Nested-guided topic model for detecting cell-type-specific differentially expressed genes between phenotypes. In this nested design, we treat the phenotype as level 1 and the cell types as level 2. The pretrained genes-by-CTS-topic distribution <inline-formula id="IEq173"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M70"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq173.gif"/></alternatives></inline-formula> learned from panel <bold>a</bold> are used to initialize the topic distributions for each phenotype in a sparsified bulk transcriptome disease study. As illustrated in the cartoon, for example, for 2 phenotypes and 3 cell types, there are 6 topics. GTM-decon then fine-tunes the combined cell-type-specific topic distribution by running the same algorithm described in panel <bold>b</bold>. The resulting topic distributions reflect the phenotypic influences on CTS gene distributions, which are the statistics for conducting differential expression analysis in a case–control study design</p></caption><graphic xlink:href="13059_2023_3034_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">As our <italic>second contribution</italic>, we extend GTM-decon to infer multiple topics per cell type. The rationale is that cells of the same cell type can manifest in different cell states due to the changes of environments or stimuli. As a result, these cells may exhibit expression patterns that are different from the canonical CTS expression pattern. While there are sophisticated hierarchical topic models involving Dirichlet Processes [<xref ref-type="bibr" rid="CR26">26</xref>], we took a simple and elegant design. Specifically, we extend the basic GTM-decon model to infer sub-cell-type topics by dedicating multiple topics per cell type (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). As our <italic>third contribution</italic>, we extend GTM-decon to infer phenotype-specific (PTS) topic distributions using the phenotype label (e.g., cancer subtypes or cancer stages) available in the single-cell or bulk transcriptome data as a guide to detect PTS gene expression (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). We then further extend it to a nested-guided topic model to conduct CTS differential expression analysis in the single-cell or bulk patient cohort data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). To that end, we use the phenotype labels as the level-1 guide and the cell-type labels as the level 2 guide. Through the same guided topic mechanism, GTM-decon updates the CTS topic distributions under each phenotype by fitting the data likelihood of the transcriptomes from either the single-cell or bulk data. The algorithmic details for the 3 contributions were described in “<xref rid="Sec8" ref-type="sec">Methods</xref>.”</p>
    </sec>
    <sec id="Sec4">
      <title>Experimentation of data preprocessing and GTM-decon model configurations</title>
      <p id="Par8">We experimented gene selection, data normalization, hyperparameter settings, and number of topics per cell type. We find that GTM-decon works the best with raw read count data using all genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S2 and S3), and it is fairly robust to different hyperparameter values for the topic mixture prior (Figs. S<xref rid="MOESM1" ref-type="media">4</xref>-S<xref rid="MOESM1" ref-type="media">6</xref>) and the CTS topic prior values (Fig. S<xref rid="MOESM1" ref-type="media">7</xref>). In general, GTM-decon confers better deconvolution performance using multiple topics per cell type than the baseline GTM-decon with one topic per cell type (Fig. S<xref rid="MOESM1" ref-type="media">8</xref>). Please refer to Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S1-S5 for more details.</p>
    </sec>
    <sec id="Sec5">
      <title>Evaluation of deconvolution of simulated bulk from scRNA-seq data</title>
      <p id="Par9">To quantitatively benchmark GTM-decon, we compared it against five existing deconvolution methods, namely Bisque [<xref ref-type="bibr" rid="CR21">21</xref>], Bseq-sc [<xref ref-type="bibr" rid="CR17">17</xref>], CIBERSORTx [<xref ref-type="bibr" rid="CR18">18</xref>], MuSiC [<xref ref-type="bibr" rid="CR19">19</xref>], and BayesPrism [<xref ref-type="bibr" rid="CR22">22</xref>] on artificially simulated bulk RNA-seq datasets from the scRNA-seq data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). To simulate bulk data, three human scRNA-seq datasets (Pancreas—E-MTAB-5061, Breast Tissue with GEO accession number GSE113197, and Rheumatoid Arthritis (RA) Synovium—SDY998), generated using different technologies (Smart-seq2, 10 × Genomics Chromium, CEL-Seq2) were used. The artificial bulk data for each individual was constructed by summing up the counts for each gene from all cells in that individual [<xref ref-type="bibr" rid="CR19">19</xref>]. This allowed us to use the cell-type proportions from the single-cell data as the ground-truth proportions. Artificially constructed bulk data from scRNA-seq data appear to be a good surrogate of the real bulk data, as observed from the excellent correlation of the log-transformed artificial counts with the log-transformed counts from real bulk data for each gene (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). We performed leave-one-out cross-validation (LOOCV), to avoid any leakage from training data, and used the single-cell RNA-seq of the left-out individual to simulate the bulk RNA-seq (i.e., the total read counts of each gene for that sample) as the validation data and its cell-type proportions as the ground-truth mixing proportions. GTM-decon performs better than other models on the Pancreas and Breast Tissue datasets in terms of both Spearman Rank-based correlation (Spearman R) and Cross Entropy and conferred comparable performance on the RA Synovium dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). Notably, GTM-decon achieves smaller variance for both the pancreatic and breast tissue datasets. We further ascertained the qualities of the predicted cell-type proportions of each method against the ground-truth cell-type proportions (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>a) and observed that GTM-decon recapitulates cell-type proportions well for pancreatic (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>b), breast tissues (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>c), and RA synovium dataset (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>d).</p>
    </sec>
    <sec id="Sec6">
      <title>Evaluation of deconvolution of real bulk with ground-truth cell-type proportions</title>
      <p id="Par10">We also benchmarked GTM-decon on 5 real bulk RNA-seq data with known ground-truth cell-type proportions from 3 different tissue types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 and S2; “<xref rid="Sec8" ref-type="sec">Methods</xref>”). We evaluated deconvolution performance using Spearman R and Root Mean Square Error (RMSE), by comparing the inferred proportions for the matching cell types against the ground-truth proportions for each sample. GTM-decon conferred on-par or superior performance compared to the existing methods for all the datasets (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a left). In particular, GTM-ALL performed the best for deconvolving PBMC-1 and PBMC-2. For deconvolving whole blood (WB), GTM-HVG performed the best in terms of both metrics and MuSiC is a close second. While deconvolving bulk RNA-seq from the prefrontal brain region from ROSMAP dataset, all methods except Bseq-sc and GTM-HVG performed reasonably well. It is possible that the HVG are the genes having high variance within the cell types, which caused the poor performance of GTM-HVG on this dataset. For the pancreatic dataset with the paired single-cell and bulk RNA-seq data collected from the same individuals, GTM-HVG performs the best with GTM-PP as the runner-up in terms of Spearman R, and RMSE are similar among all methods except MuSiC with notably higher error. In summary, GTM-ALL performed the best in 3 datasets; GTM-HVG performed the best in the other two datasets, where the CTS gene expression might exhibit more distinct inter-cell-type variability. Furthermore, we also evaluated the deconvolution performance for separate cell types in terms of the correlation between ground-truth proportions and predicted proportions for each cell type across samples. Overall, GTM-decon conferred competitive performance with the runner-up method being BayesPrism (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a right and b; Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S11-S15). Therefore, the results suggest the general effectiveness of topic modeling in cell-type deconvolution and the additional benefits conferred by GTM-decon due to its algorithmic innovations.<fig id="Fig2"><label>Fig. 2</label><caption><p>Evaluation of deconvolution performance on real bulk data. <bold>a</bold> Evaluation of sample deconvolution. We evaluated the deconvolution performance of GTM-decon using all genes (GTM-ALL), preprocessed genes (GTM-PP), and highly variable genes (GTM-HVG) with five SOTA methods—CIBERSORTx, MUSIC, BSEQ-sc, BISQUE, BayesPrism. The 3 immune bulk data and the brain data were deconvolved using independent references of a similar tissue, while the pancreas bulk data is deconvolved using single-cell reference from the same individuals in a leave-one-out cross-validation (LOOCV) manner. The bulk labeled PBMC-1 corresponds to SDY67 dataset, PBMC-2 corresponds to S13 cohort, whole blood to whole blood dataset, and prefrontal cortex to ROSMAP dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). For each test bulk sample, Spearman correlation and root mean square error (RMSE) were computed between its ground truth and predicted cell-type proportions by each method. The box and whiskers in each boxplot indicate the 25–75% quartile and min–max of the evaluation scores over all samples in a dataset, respectively. The boxplot on the left displays the evaluation across cell types per sample, and the boxplot on the right displays the evaluation across samples per cell type. <bold>b</bold> Heatmaps comparing the cell-type-specific deconvolution performance of GTM-decon against existing methods on 5 different real bulk datasets with known ground truth mixing proportions. The cell types are ordered from most to least prevalent in the bulk data (green barplots in first row indicate average proportion for each cell type in the bulk data). The middle row shows the Pearson correlation coefficient between the predicted and known cell-type proportions. The lower row shows the inverse RMSE (higher is better, scaled between 0 and 1), per cell type per dataset. The barplots on the right show the average performance over all cell types for each method. For each cell type, Pearson correlation and RMSE were computed between its ground truth and predicted cell-type proportion for each dataset by each method. <bold>c</bold> Cell-type prediction accuracy of the purified immune bulk RNA-seq samples. The two panels indicate the use of different independent immune references, for the deconvolution of two purified bulk immune datasets (Accession Numbers: GSE107011, GSE64655). For each purified bulk sample, the cell type corresponding to the highest inferred cell-type proportion by each method was used as the predicted cell type. The barplots show the prediction accuracy as the percentage of the correctly predicted samples</p></caption><graphic xlink:href="13059_2023_3034_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par11">Additionally, we evaluated the deconvolution accuracy for purified bulk RNA-seq data of immune cells (GEO accession numbers: GSE107011 and GSE64655; Table S<xref rid="MOESM1" ref-type="media">2</xref>) using two different independent references (HBC and PBMC2; Table S<xref rid="MOESM1" ref-type="media">1</xref>). Overlapping cell types were used to evaluate the performance on the purified bulk samples, whereby the highest deconvolution proportion was used as the predicted cell-type label for computing the prediction accuracy. GTM-HVG achieved the highest accuracy across all four experiments (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Moreover, since some cell types present in the bulk are missing in the scRNA-seq reference, a robust model should either find the closest-matched cell types or properly express statistical uncertainty in this situation. To this end, we examined the inferred cell proportions of the purified bulk for those missing cell types. Plasmablast samples are present among the purified PBMC samples (GSE107011) but absent in the HBC reference (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16a). GTM-decon assigned Plasmablast samples with high cell-type proportions for B-cell, a cell type that shares Plasmablast cell lineage. The inferred cell-type proportions for Basophils purified samples were split between HSPCs (immune progenitor cells) and neutrophils, which is also classified as granulocyte. Granulocytes are the most common white blood cells, consisting of 3 specific cell types—neutrophils, eosinophils, and basophils. Using PBMC2 as a reference to deconvolve the same purified bulk immune samples led to similar deconvolution patterns for the missing cell types of plasmablast and basophils (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16b). Interestingly, neutrophils were absent in the PMBC2 reference and inferred to be monocytes, which are related to the granulocyte family—a class of immune cells that include basophils, eosinophils, and neutrophils [<xref ref-type="bibr" rid="CR27">27</xref>]. Another missing cell type HSPC (hematopoietic stem and progenitor cells) have their signal spread across all the cell types. These results suggest that when some cell types are missing in the reference, GTM-decon either finds the closest match or appropriately expresses uncertainty.</p>
      <p id="Par12">Finally, we performed benchmarking on the time and memory usage of our GTM-decon software. GTM-decon scales linearly with both the number of topics per cell type and the number of cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6; Fig. S17), which is what we expected since its time and space complexity are both <inline-formula id="IEq7"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\times G\times K)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq7.gif"/></alternatives></inline-formula> for N cells, G genes, and K topics. For large number of cells, we can also perform stochastic variational inference [<xref ref-type="bibr" rid="CR28">28</xref>] to rapidly update model parameters based on mini-batches of cells with much lower memory overhead. It also compares favorably with BISQUE, BSEQ-sc, and MuSiC in terms of running time and memory usage.</p>
    </sec>
    <sec id="Sec7">
      <title>GTM-decon automatically learns CTS gene signatures from scRNA-seq reference</title>
      <p id="Par13">We evaluated the performance of GTM-decon in recapitulating cell-type-specific information as well as deconvolution using pancreatic tissue as a reference. The pancreas consists of several cell types including exocrine and endocrine. While the former aids digestion by secreting several enzymes, the latter regulates glucose uptake and processing by secreting hormones. With a vast literature documenting the biological roles of several cell types and their behavior in healthy and diseased conditions, such as diabetes and cancer, the pancreatic tissue serves as a good benchmark to assess GTM-decon. We trained GTM-decon on an scRNA-seq reference dataset of pancreatic tissue from Segerstolpe et al. [<xref ref-type="bibr" rid="CR29">29</xref>], consisting of 2209 cells, corresponding to 14 cell types from 10 individuals. GTM-decon captured distinct sets of CTS gene signatures, as shown by the gene-by-topic probability distributions (i.e., the matrix <inline-formula id="IEq8"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq8.gif"/></alternatives></inline-formula>) for the top 20 genes in each topic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Indeed, each topic recovers a large number of marker genes for the corresponding cell types based on two databases, namely CellMarker database [<xref ref-type="bibr" rid="CR30">30</xref>], a manually curated resource of cell markers in human and mouse and the PanglaoDB [<xref ref-type="bibr" rid="CR31">31</xref>], a database of marker genes generated from scRNA-seq datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). We further ascertained the cell-type coherence of each topic by Gene Set Enrichment Analysis (GSEA), while using the probabilities learnt for each cell type against the CellMarkerDB. For the three cell types with abundant marker genes—acinar, alpha, and beta, each of the 5 topics recovers the exact cell type as the top-most hit in the analysis, with the adjusted <italic>p</italic>-value ≤ 1 × 10<sup>−15</sup> (permutation test) in most cases (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Furthermore, the enrichment of known marker genes for the main cell types suggested that GTM-decon with 5 topics per cell type best captures the cell-type-specific signatures (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18). We also evaluated the effect of different number of cells per cell type. As expected, the topic confidence scores as measured by the average probabilities over the CTS gene distributions increase with the increasing number of cells for that cell type (i.e., evidence) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S19).<fig id="Fig3"><label>Fig. 3</label><caption><p>Cell-type-specific topic inference and deconvolution of pancreatic tissue. <bold>a</bold> Gene signatures of cell-type-specific topics in pancreas. We trained GTM-decon on the PI-Segerstolpe scRNA-seq dataset of pancreas tissue. We used 5 topics per cell type, allowing sub-cell-type inference. For the inferred genes-by-cell-type matrix <inline-formula id="IEq174"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq174.gif"/></alternatives></inline-formula>, we took the top 20 genes under each topic and visualized their topic distributions in heatmap. Whenever available from CellMarkerDB and PanglaoDB, cell-type marker genes are indicated on the left. For the cell types where marker genes are not available, “NA” were indicated on the left. The number of statistically significantly different genes in each cell type based on their topic scores (<italic>p</italic>-value &lt; 0.05; permutation test) is shown below. <bold>b</bold> Gene set enrichment analysis (GSEA) of inferred topics based on known marker genes. Cell-type-specific topics for acinar, alpha, and beta were evaluated based on whether the top genes are enriched for the known marker genes under that cell type. The bar plots show the − log<sub>10</sub> (p.adj values of enrichment score) for the gene set enrichment analysis for each of the 5 topics. The leading-edge plot for the topic with the best adj. <italic>p</italic>-value for that cell type is shown on the right. In each of the leading-edge plots, genes were ordered in decreasing order from left to right. The green curves indicate the running scores of enrichments. The barcode bars indicate cell-type marker genes. Adjusted <italic>p</italic>-values based on the GSEA enrichment scores are indicated in each panel. The three large panels display the most significantly enriched topic of among the five topics for each cell type and the 12 small panels display the remaining topics. <bold>c, e</bold> Deconvolution of bulk RNA-seq samples of 89 human pancreatic islet donors. The GTM-decon models separately trained on the Segerstolpe pancreas islet dataset (i.e., panel <bold>c</bold>) and Baron pancreas islet data (i.e., panel <bold>e</bold>) reference datasets were used to deconvolve the 89 bulk transcriptomes. As indicated by the legend, the 89 subjects consist of 51 normal, 15 impaired glucose tolerance, and 12 T2D individuals. In the heatmap, the rows represent subjects, and the columns represent cell types; the color intensity are proportional to the inferred cell-type proportions. <bold>d, f</bold> Deconvolved cell-type proportions as a function of Hemoglobin A1c (HbA1c) level. GTM-decon were trained on Segerstolpe (i.e., panel <bold>d</bold>) and Baron scRNA-seq (i.e., panel <bold>f</bold>) reference datasets. Each of the 10 panels displays a scatter plot of inferred cell-type proportion (<italic>y</italic>-axis) and HbA1c level (<italic>x</italic>-axis). The color legend indicates the 3 phenotypes. The heatmap on the right shows the deconvolved proportion of 3 most indicative cell types with subjects (rows) ordered on the basis of inferred beta cell-type proportions</p></caption><graphic xlink:href="13059_2023_3034_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>GTM-decon delineates the variations of cell-type proportions in pancreatic tissues of healthy and T2D subjects</title>
      <p id="Par14">Based on the inferred CTS topic distributions <inline-formula id="IEq9"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\upphi}}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq9.gif"/></alternatives></inline-formula>, we used GTM-decon with 5 topics per cell type to infer the cell-type proportions of bulk RNA-seq data from a cohort of 89 human pancreatic islet donors with and without type 2 diabetes (GEO accession number: GSE50244) [<xref ref-type="bibr" rid="CR32">32</xref>] (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). The dataset consists of 51 individuals with normal glucose tolerance (N), 15 with impaired glucose tolerance (IGT) and 12 with type 2 diabetes (T2D); it also has a good segregation of males (<italic>N</italic><sub>1</sub> = 54) and females (<italic>N</italic><sub>2</sub> = 35). As expected, the inferred proportions of most types of cells for these two sets of individuals are similar since they came from the same tissue. However, GTM-decon predicted a significant reduction in beta cells in T2D individuals (Pearson correlation coefficient (PCC) with HbA1c =  − 0.4, <italic>p</italic>-value = 0.00031; t-distribution with <italic>n</italic>-2 degrees of freedom) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). IGT and T2D individuals exhibit low Beta cell-type proportions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d), which was supported by the literature [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The increase in ductal cells is possibly caused by their regulation of glucose uptake (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). These results are consistent when using a different pancreatic dataset as reference (i.e., the PI-Baron reference dataset, generated via Drop-seq instead of PI-Segerstolpe, generated via Smart-seq) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, f).</p>
    </sec>
    <sec id="Sec9">
      <title>Deconvolving human pancreatic data from mouse pancreas scRNA-seq reference</title>
      <p id="Par15">For cases where scRNA-seq data were not available for the organism of interest, due to either ethical, technical, or financial challenges, there is a need to leverage scRNA-seq collected from a model organism. To this end, we investigated the possibility of deconvolving bulk RNA-seq data by training GTM-decon on a mouse scRNA-seq data. We separately trained two GTM-decon models on the human and mouse pancreatic datasets. Specifically, the human datasets include the Segerstolpe and Baron datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), which consist of 2209 cells from 10 individuals and 8569 cells from 4 individuals, respectively; the mouse dataset consists of 1886 cells collected from 2 mice. For comparative analysis, we focused on only the common set of high-confidence orthologous genes between the two species mapped by the Ensembl database [<xref ref-type="bibr" rid="CR33">33</xref>]. We visualized the cell-type proportions comparing against the ground-truth values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S20a). As expected, the cell-type proportions deconvolved using the two human datasets accurately recapitulate the ground-truth proportions (median PCC of 0.94 and 0.97). Interestingly, GTM-decon trained on the non-reference human dataset performed better than the one trained on the reference-matched dataset, which was probably due to the tenfold higher number of cells in the former scRNA-seq dataset. Moreover, GTM-decon trained on the mouse reference dataset also performed quite well in terms of the concordant proportions of the shared cell types (PCC of 0.94).</p>
    </sec>
    <sec id="Sec10">
      <title>Deconvolving pancreatic cancer transcriptomes identified tumor cell-type origin</title>
      <p id="Par16">We next turned to deconvolving pancreatic adenocarcinoma (PAAD) (also known as pancreatic ductal adenocarcinoma or PDAC) tumor bulk samples from TCGA. For this application, we also used GTM-decon with 5 topics per cell type. Since the tumor microenvironment is known to be infiltrated with immune cells [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>], we sought to train GTM-decon on a single-cell reference dataset derived from individuals with pancreatic cancer, in order to capture the cell types of both the tissue of interest and the immune cells in its tumor microenvironment. To this end, we trained GTM-decon on an scRNA-seq dataset comprised of the transcriptomic profiles of about 57,000 cells from 24 primary PAAD tumors and 11 healthy control pancreas samples [<xref ref-type="bibr" rid="CR36">36</xref>] in order to deconvolve the 174 bulk RNA-seq profiles from the TCGA-PAAD tumor samples. Additionally, we also sought to identify possible novel cell types or pathways present in the bulk RNA-seq, which are not represented in the reference profiles. This is achieved by running an unguided topic model (i.e., a standard LDA) on the sparsified bulk RNA-seq data to detect de novo bulk RNA-seq (bulkRS) topics (“<xref rid="Sec8" ref-type="sec">Methods</xref>”). We empirically chose the number of de novo bulkRS topics based on how well they could explain the variation observed in the clinical phenotypes.</p>
      <p id="Par17">We observe that the most prevalent cell types are 4 main pancreatic cell types, namely ductal (type 2), acinar, endocrine (alpha and beta cell types), and fibroblasts (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Notably, the cell type of tumor origin is correctly predicted for the samples: Ductal cells have the highest proportion among the PAAD samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; brown rectangle), and acinar for a subset of the PAAD samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; blue rectangle). This recapitulates the literature remarkably well, as ductal cells are known to be the site of the tumor origin for most cases of PAAD; however, a subset arises from acinar cells [<xref ref-type="bibr" rid="CR37">37</xref>]. More significantly, an unknown subtype is predicted to originate from endocrine cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; green rectangle). This is supported by the recent literature, which reported these samples as the derivatives of the pancreatic neuroendocrine tumor (PNET) were in fact misclassified as PAAD [<xref ref-type="bibr" rid="CR38">38</xref>]. PNET are supposed to originate from alpha or beta cells (endocrine cells) [<xref ref-type="bibr" rid="CR39">39</xref>]. In addition, most of the samples are predicted to have a high proportion of fibroblasts, which are known to be prevalent in pancreatic cancer (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; blue dot) [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR42">42</xref>]. Interestingly, deconvolving the pancreatic cancer PAAD dataset using mouse reference dataset also conferred high-quality patient clustering comparable to that of human dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S20b). Notably, the PAAD “other subtype” was predicted to originate from alpha cells (an endocrine cell), which mirrors the results from human reference data (Fig. S<xref rid="MOESM1" ref-type="media">20</xref>b; shown in blue rectangles).<fig id="Fig4"><label>Fig. 4</label><caption><p>Deconvolution of bulk RNA-seq samples for pancreatic cancer from TCGA-PAAD. GTM-decon was first trained on an scRNA-seq dataset from individuals with pancreatic cancer. The trained GTM-decon model was then used to infer the cell-type proportions of the 174 TCGA-PAAD bulk RNA-seq profiles. <bold>a</bold> The average inferred cell-type proportion across the TCGA-PAAD tumor samples. We summed up inferred cell-type proportions over all samples followed by normalization. The pie chart displays the resulting percentage of cell-type proportions. <bold>b</bold> Inferred cell-type proportions of individual TCGA-PAAD tumor samples. To complement the inferred proportions of known cell types, we also ran unguided topic model (i.e., LDA) on the TCGA-PAAD bulk RNA-seq profiles directly to detect de novo topics that are not present in scRNA-seq reference. The heatmap visualizes the combined deconvolution results based on the 10 pancreatic cell types, and 10 de novo topics (i.e., columns). Each of the 174 rows represents a subject. Three types of demographic or clinical phenotypes were shown in the legend to aid result interpretation. These include “days to death,” cancer subtype, and whether the cancer type is PNET or not. The regions in the highlighted boxes were discussed in more details in the main text. <bold>c</bold> Survival analysis of the CTS and de novo topics using inferred cell-type proportions. The 174 subjects were divided into two groups based on K*-means clustering with K* set to 2 (not to be confused with the K cell types or topics). Kaplan–Meier curves were generated for these groups and compared using log-rank test. The plot shows the − log<sub>10</sub>(<italic>p</italic>-value) from the log-rank test for all the CTS and de novo topics, in decreasing order of significance. <bold>d</bold> Kaplan–Meier curve for endocrine cell-type proportion. The curve and shaded area represent the mean and standard deviation of the cell-type proportions in the two groups, respectively. The number of subjects for each cluster was indicated in the bottom panel</p></caption><graphic xlink:href="13059_2023_3034_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par18">Interestingly, the de novo bulkRS topics cluster with the most abundant reference topics inferred from the scRNA-seq reference data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, blue circles). For example, bulkRS Topic 2 corresponds to the CTS topic for acinar cell type, Topic 10 to the CTS topic for endocrine cell type, Topic 9 to Ductal_type_2, Topic 8 to Fibroblast, and Topic 6 to stellate cells. However, there are a few de novo bulkRS topics, such as bulkRS Topic 1, Topic 4, and Topic 5, capturing distinct distributions for specific subsets of samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; red dots). These topics could correspond to either novel cell types or gene pathways in the bulk but not implicated in the scRNA-seq reference.</p>
      <p id="Par19">We next estimated whether variation in cell-type proportions or bulkRS topics is indicative of survival time. To this end, we performed Cox Regression to regress the number of days patients lived since their cancer diagnosis on their inferred cell-type proportions as well as the de novo bulkRS topics. Overall, the Cox Regression model is statistically significant compared to the bias term (adjusted <italic>p</italic>-value = 9 × 10<sup>−5</sup> based on likelihood ratio test). To explore the marginal effect of individual cell-type proportions on survival, we performed Kaplan–Meier analysis by separating patients into two groups based on K-means clustering (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). We observe that among the cell types, endocrine cell type exhibits a significant hazard ratio, predicting a good survival outcome (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d; <italic>p</italic>-value = 0.0091; log-rank test), which is supported by the literature as PNETs are mostly benign [<xref ref-type="bibr" rid="CR43">43</xref>]. However, ductal cell type 2 is associated with poor survival outcome, which is expected as pancreatic adeno carcinoma are aggressive (<italic>p</italic>-value = 0.03; log-rank test). On the other hand, Topic 1 and Topic 5 indicate poorer survival, with hazard ratios of 4 and 40 respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S21) although their roles are unclear since they do not cluster with any of the CTS topics (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). This reiterates the usefulness of using CTS topics in conjunction with de novo bulkRS topics to enable their interpretation wherever possible.</p>
      <p id="Par20">A similar analysis conducted using a separate scRNA-seq reference from healthy pancreatic subjects only reveals similar results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S22). However, in this analysis, only two of the de novo bulkRS topics clearly correspond to CTS topics (acinar and ductal), suggesting that the usage of an appropriate scRNA-seq reference with matched tumor environment is preferred.</p>
    </sec>
    <sec id="Sec11">
      <title>Deconvolving breast cancer transcriptomes revealed subtype-specific markers</title>
      <p id="Par21">To capture specific subtypes of breast tumor samples from the TCGA data, we trained GTM-decon on an scRNA-seq reference data from 26 primary tumors of breast cancer (BRCA) patients with three major clinical subtypes of BRCA, including 11 ER + , 5 HER2 + and 10 TNBC [<xref ref-type="bibr" rid="CR44">44</xref>]. The data consists of about 1 million cells and covers 7 major cell types and 29 minor cell types. This served as a high-resolution reference for annotating the TCGA-BRCA tumor samples (<italic>n</italic> = 1212) based on the major subtypes from the scRNA-seq dataset, namely Cancer-Basal, Cancer-Her2, Cancer-LumA, and Cancer-LumB (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23a). As expected, significantly higher proportions of endothelial and myoepithelial cell types are found in the normal-like samples, in comparison to the cancer subtypes (Fig. S<xref rid="MOESM1" ref-type="media">23</xref>a). Furthermore, basal subtype is enriched for cancer-basal cells (Fig. S<xref rid="MOESM1" ref-type="media">23</xref>b, shown in dotted brown rectangle), and the cancer-associated fibroblasts (CAFs) are enriched in almost all the samples (Fig. S<xref rid="MOESM1" ref-type="media">23</xref>b, shown in blue rectangles). Similar to the above analyses, some of the de novo bulkRS topics from sparsified samples overlap with the most represented cell types. For example, Topic 6 resembles myofibroblast-like cancer-associated fibroblasts (myCAF-like), and Topic 8 resembles LumA subtype cancer cells.</p>
      <p id="Par22">Deconvolution using the scRNA-seq reference from the healthy individuals also captures the cell type of origin for the different breast cancer subtypes implicated in the bulk samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S24). For this analysis, using highly variable genes is more discriminatory than all genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S25). The inferred CTS topic distributions from normal breast tissue recapitulate several marker genes from CellmarkerDB and PanglaoDB (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>a). Furthermore, GTM-decon-inferred cell-type proportions clearly distinguish TCGA breast tumor samples from GTEx normal breast tissues (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>b). Moreover, the basal cell type is predicted to have the highest proportion in the basal subtype defined by the PAM50 classification in comparison to other subtypes (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>c) [<xref ref-type="bibr" rid="CR45">45</xref>]. Also, we observed higher predicted proportion for Luminal_2 cell type in both LumA and LumB subtypes as expected [<xref ref-type="bibr" rid="CR46">46</xref>] (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>c). Among the de novo bulkRS topics from sparsified samples, Topic 5 is highly enriched in LumB, while Topic 7 and Topic 8 are enriched in basal and LumA subtypes (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>c). The guided topic score for the basal subtype also correlates with higher proliferation score as expected [<xref ref-type="bibr" rid="CR45">45</xref>]. Specifically, the basal cell type is enriched in this subtype (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>d; enclosed in green rectangle), whereas Luminal_2 is depleted (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>d; enclosed in green dashed rectangle). In contrast, ER + samples appear to be enriched for Luminal_2 cells (Wilcoxon test <italic>p</italic>-value = 4.5e − 10; Fig. S<xref rid="MOESM1" ref-type="media">26</xref>), as expected [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. Furthermore, Topic 7 clearly captures the basal subtype (enclosed in brown rectangle in Fig. S<xref rid="MOESM1" ref-type="media">24</xref>d), whereas there is no clear topic capturing the ER + phenotype.</p>
    </sec>
    <sec id="Sec12">
      <title>GTM-decon learns phenotype-guided gene topics specific to BRCA subtypes</title>
      <p id="Par23">Our guided topic mechanism is not limited to inferring CTS topics, but can be extended to inferring phenotype-specific topics (i.e., topics capturing phenotype-specific gene expression) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), thereby discovering gene signatures of subtypes or different cancer stages. We applied this approach to study the differences between basal and ER + BRCA subtypes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a–c) and the difference between ductal carcinoma and lobular carcinoma (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d–f). We modeled each phenotype using 5 topics each, based on a sparsified matrix of bulk RNA-seq data (“<xref rid="Sec8" ref-type="sec">Methods</xref>”), resulting in a genes-by-phenotypes matrix <inline-formula id="IEq10"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq10.gif"/></alternatives></inline-formula> with 5 topics per phenotype (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We then ranked genes by the topic scores under each topic. Almost all the genes identified by our approach were also deemed as differentially expressed (DE) genes by DESeq2 differential analysis [<xref ref-type="bibr" rid="CR48">48</xref>] (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). GSEA of the topics shows differences between the basal and ER + phenotypes, although there is not much difference among the 5 topics for basal (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). Moreover, the trained GTM-decon confers accurate phenotype classification with 97% accuracy for discriminating basal and ER + (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b) and 82% for discriminating ductal and lobular subtypes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d), which is comparable to the traditional supervised learning methods namely logistic regression and random forest (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f). We also evaluated phenotype classification accuracy as a function of sparsification rate (described in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S7 and illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S27) suggesting the importance of sparsification for inferring topics from bulk RNA-seq data using GTM-decon. We also trained GTM-decon only on the highly variable genes in the unsparsified bulk RNA-seq samples. This results in lower classification accuracy (76% for ductal-lobular samples as compared to 82%, and 95% for basal-ER + samples as compared to 97%), which might be due to information loss (HVG = 1391 for basal-ER + samples, HVG = 445 for ductal-lobular samples). Training using DE genes between the two phenotypes identified by DESeq2 also results in lower classification accuracy of 83% and 75%, respectively. These experiments suggest that GTM-decon can utilize more informative genes to discriminate the breast cancer subtypes than the traditional differential analysis approach.<fig id="Fig5"><label>Fig. 5</label><caption><p>Phenotype-guided topic modeling of bulk RNA-seq data of breast cancer. <bold>a</bold> Predicted top genes for the phenotype-guided topics for basal and ER + breast cancer subtypes. GTM-decon was trained on the sparsified TCGA-BRCA bulk RNA-seq data with the basal and ER + cancer subtypes as the guide. Five topics were used per subtype and therefore 10 topics in total. The heatmap illustrates the topic probabilities of the top 20 genes from each topic. As a comparison, the genes were also labeled as up- or downregulated if they were deemed differentially expressed by the DESeq2 analysis. <bold>b</bold> Classification of basal and ER + subtypes based on phenotype-guided topic scores. The 5 topics for the same subtype were summed to obtain the overall score for basal and ER + subtype. Subjects in the rows were sorted by their basal topic scores. <bold>c</bold> GSEA analysis of the basal and ER + subtype topics. Significantly enriched MSigDb HALLMARK pathways were identified for each topic and displayed as barplots. The heights of the bar indicate the − log10 adjusted <italic>p</italic>-values and the colors indicate enriched pathways. <bold>d</bold> Predicted top genes for the phenotype-guided topics for histological subtypes. Same as in panel <bold>a</bold> but for ductal and lobular subtypes. <bold>e</bold> Classification of histological subtypes. Same as in panel <bold>b</bold> but for ductal and lobular subtypes. <bold>f</bold> Evaluation of the subtype classification accuracy on the test breast tumor samples. We trained the phenotype-guided GTM-decon separately on 80% of the sparsified TCGA-BRCA tumor samples using basal/ER + and histological types as the guides and evaluated its phenotype prediction accuracy on the 20% held sparsified samples. As a comparison, we also trained and evaluated logistic regression and random forest on the same training and test split, respectively. The classification accuracy on the test set by each method were displayed in the barplots</p></caption><graphic xlink:href="13059_2023_3034_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Nested-guided topic modeling identifies CTS DE genes in breast cancer subtypes</title>
      <p id="Par24">scRNA-seq can facilitate molecular understanding of genes and pathways in specific cell types with respect to phenotypic states. This level of detail is absent in bulk RNA-seq data, which profiles only the averaged gene expression from all cell types in the tissue. However, due to the cost, scRNA-seq profiles at the patient cohort size are rare. To take advantage of both types of data, we sought a way to identify cell-type-specific gene expression differences corresponding to the phenotypes observed for the bulk samples. Briefly, we took a pretrained GTM-decon on a scRNA-seq reference data and then updated its CTS topics based on the corresponding phenotypes from the sparsified bulk data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). This is equivalent to treating the phenotype as level 1 and cell types as level 2 in a two-stage nested factor design in statistics.</p>
      <p id="Par25">For the TCGA-BRCA data, in particular, we first initialized the genes-by-topic matrix <inline-formula id="IEq11"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq11.gif"/></alternatives></inline-formula> with the <italic>pretrained</italic> guided topics learned from the scRNA-seq reference for normal breast tissue. We then <italic>fine-tuned</italic> 5 CTS topics for each phenotype (i.e., ER + or basal) from sparsified bulk data, resulting in a 10-topic model. During the fine-tuning, all CTS topics corresponding to the patient’s phenotype are assigned a prior value of 0.9. Applying this approach to 798 sparsified samples from TCGA-BRCA, corresponding to basal (<italic>N</italic><sub>1</sub> = 140) and ER + (<italic>N</italic><sub>2</sub> = 658) led to a new genes-by-topic matrix <inline-formula id="IEq12"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\upphi }^{*}$$\end{document}</tex-math><mml:math id="M84"><mml:msup><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq12.gif"/></alternatives></inline-formula>. First of all, the top genes for the topics corresponding to the same cell type are similar in both phenotypes, as they are expected to capture CTS signatures (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). However, differential analysis of genes between two phenotypes revealed upregulated genes in one phenotype being downregulated in the other (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). These differences between basal and ER + are statistically significant across all genes for all the cell types based on paired Wilcoxon signed-rank tests. Next, we evaluated the ability of the fine-tuned GTM-decon to classify the held-out test set and observed a 97% classification accuracy (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c, top panel). These higher-resolution deconvolved CTS breast cancer profiles reveal that ER + samples are enriched for Luminal-2 cell type, whereas the basal subtype is depleted for that cell type (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c).<fig id="Fig6"><label>Fig. 6</label><caption><p>Identification of cell-type-specific differentially expressed genes from bulk RNA-seq data for basal vs. ER + subtypes. <bold>a</bold> Top cell-type-specific gene signatures for basal and ER + . GTM-decon was pretrained on a scRNA-seq reference dataset from normal breast tissue to infer the expression distribution of 5 cell types, namely basal, basal myoepithelial, luminal 1–1, luminal 1–2, and luminal 2. The resulting genes-by-cell-type estimates were then used as the initial topic distributions for another GTM-decon, which is guided by the basal and ER + cancer subtypes in modeling the sparsified TCGA-BRCA bulk data. This led to a 10-topic distribution, each of which was specifically tailored for a combination of cell type and cancer subtype. The heatmap displays the probabilities of the top 20 genes for each topic. The left half displays the cell-type-specific topic distribution for basal and the right half for ER + . <bold>b</bold> Predicted differentially expressed (DE) genes for each cell type between basal and ER + . The top DE genes for basal in contrast to ER + were identified by subtracting the gene topic scores for ER + from the gene topic score for basal under the same cell type. The resulting DE scores were shown in the top half of the heatmap. The bottom half displays the DE scores of the top genes for ER + in contrast to basal. The pairwise Wilcox signed-rank tests were performed to compare the gene topic scores across all genes between the two subtypes for the same cell type. All tests yielded <italic>p</italic>-values lower than 2.2e<sup>−16</sup>. <bold>c</bold> Classification of basal and ER + based on the phenotype probabilities. As a validation for our nested phenotype-cell-type guided approach, we evaluated the classification accuracy on the 160 held-out sparsified breast tumor samples. For each subtype, we summed the cell-type-specific topic probabilities from bottom heatmap for each sample to obtain the phenotype scores, which are shown in the top heatmap. <bold>d</bold> Comparison of DE genes detected by our approach and by DESeq2. DESeq2 was applied to the bulk RNA-seq gene expression data to compare gene expression between ER + and basal samples. In total, 6815 DE genes were deemed significant by adjusted <italic>p</italic>-value &lt; 0.05 (Wald test) with 2952 upregulated and 3863 downregulated genes in ER + relative to basal. The grey bar and the heatmap on the left display the − log adjusted <italic>p</italic>-value for all of the upregulated genes (top half) and the downregulated genes (bottom half). Genes were ordered in decreasing order of the absolute test statistic for each half. The corresponding log<sub>2</sub> fold-change of ER + over basal was also shown as heatmap. The heatmap on the right displays the change of gene topic score from basal subtype to ER + subtype. <bold>e</bold> Cell-type-specific DE genes identified by nested-guided topic approach. The top and bottom part of the heatmap displays the topic scores for the upregulated and downregulated genes in basal relative to ER + , respectively (<italic>p</italic>-value &lt; 0.05; permutation test). Genes that were also detected by DESeq2 were labeled in the color bar. <bold>f</bold> ORA was applied to the differential topic scores of upregulated and downregulated genes in ER + relative to basal. MSigDb HALLMARK pathway gene sets were used in ORA. The − log <italic>p</italic>-values for the significant pathways were shown in the bar plot</p></caption><graphic xlink:href="13059_2023_3034_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par26">Next, we identified the DE genes per cell type by subtracting the genes-by-topic entries in the <inline-formula id="IEq13"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq13.gif"/></alternatives></inline-formula> matrix for phenotype <inline-formula id="IEq14"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M88"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq14.gif"/></alternatives></inline-formula> (e.g., basal) from phenotype <inline-formula id="IEq15"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}{\prime}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq15.gif"/></alternatives></inline-formula> (e.g., ER +) under the same cell type (e.g., Luminal 2). To evaluate the consistency of our DE genes, we compared them against the DE genes identified by DESeq2 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). We observe that all upregulated and downregulated DE genes nominated by DESeq2 in ER + versus basal comparison were also deemed upregulated and downregulated by our approach, respectively. We visualize the expression of the 630 statistically significant DE genes (adjusted <italic>p</italic>-value &lt; 0.05; permutation test) in the BRCA tumor samples (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e). We found that most of our DE genes do not only agree with those by DESeq2 but also exhibit CTS patterns. Notably, the most DE genes correspond to the Luminal_2 cell type (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e), which exhibit the larger difference between ER + and basal (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S26). Over representation analysis (ORA) of these CTS DE genes against Hallmark pathways from MSigDb revealed several meaningful pathways. As expected, estrogen response (early) and (late) pathways are highly upregulated in the ER + phenotype, mainly in the Luminal_2 cell type (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). Similarly, most DE genes in the basal phenotype are upregulated for typical pathways involved in cancer, such as G2M checkpoint, E2F targets, and mitotic spindle. This reflects the aggressive nature of basal cell type as the origin for the cancer subtype (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). The contribution of sparse genes (i.e., genes with zero counts due to sparsification) to CTS topics and DE analysis is described in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S7 and illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S28. We obtained similar results comparing the 2 histological subtypes—ductal carcinoma and lobular carcinoma (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S29).</p>
      <p id="Par27">To further demonstrate the phenotype-guided and phenotype + cell-type-guided functionality, we applied GTM-decon to the same scRNA-seq data from breast cancer tumors using phenotypes (i.e., ER + and TNBC) and cell-type labels as the guides and then used the inferred topics to deconvolve the bulk TCGA breast tumor transcriptome data. Detailed analyses are presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S8 and Fig. S<xref rid="MOESM1" ref-type="media">30</xref>. This was feasible because we have scRNA-seq references that were collected from similar tissue sites from patients of the same disease phenotypes as the target bulk transcriptomes.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par28">In this study, we developed a Bayesian approach called <italic>GTM-decon</italic> to infer CTS gene topic distributions from scRNA-seq reference data. During the topic inference of each cell, we introduce the guidance by setting the topic hyperparameter for the cell type of that cell to be relatively larger than the hyperparameters for other topics. This enables us to anchor each topic to a specific cell type and subsequently guide the inference of the global topic distributions over genes to automatically prioritize cell-type marker genes. The resulting topic distributions can then be used to infer the relative cell-type proportions from bulk RNA-seq datasets (i.e., cell-type deconvolution).</p>
    <p id="Par29">Through our analysis of the pancreatic and breast tissue datasets, we observe that for those cell types, where marker gene information is available, most of the top genes under the CTS topics correspond to known marker genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S24a). Because GTM-decon infers a distribution over all the genes under each cell-type-guided topic, it can be used to not only quantify the contribution of the known marker genes but also score novel marker genes. In terms of cell-type deconvolution, GTM-decon confers comparable performance to the existing state-of-the-art methods (Fig. <xref rid="Fig2" ref-type="fig">2</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10-15). The deconvolved cell-type proportions can be used to distinguish healthy and diseased samples as shown in the case of diabetic patients (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c,e) as well as cancer subtypes from pancreatic and breast tumors (Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23). This enables investigation of molecular contribution to the phenotypic differences. Phenotypic differences between healthy and diabetic patients were captured even when the scRNA-seq reference datasets were generated from different platforms (e.g., Smart-seq and Drop-seq) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d, f).</p>
    <p id="Par30">Using GTM-decon, we revisited two cancer datasets from TCGA, namely pancreatic adenocarcinoma (PAAD) and breast cancer (BRCA). To dissect the heterogeneous tumor microenvironment, we deconvolved these datasets based on scRNA-seq reference sets from pancreatic cancer and breast cancer, respectively. As a result, we identified the ductal and acinar origin of PAAD, the endocrine origin of pancreatic neuroendocrine tumors (PNET) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b), and enrichment of subtype-specific cells for the BRCA subtypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23a). Interestingly, using scRNA-seq references from pancreatic and breast tissues of healthy individuals is also sufficient to identify the cell type of origin for all subtypes in pancreatic cancer (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S22), as well as the basal origin of basal subtype and the luminal origin of ER + breast cancer (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S24). However, using a cancer-specific scRNA-seq dataset improves the resolution of deconvolution in identifying more subtypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23). By combining the de novo topics inferred directly from the bulk RNA-seq data with the scRNA-guided topics, we identified putative prognostic biomarkers that correlate with survival time (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S21, S22c).</p>
    <p id="Par31">We further extended GTM-decon by modeling the sparsified bulk RNA-seq data using the patient phenotype labels as the guide rather than cell types. In contrast to the traditional differential analysis approach, the phenotype-guided GTM-decon provides a different way to investigate gene signatures and molecular pathways underpinning the phenotypes of interest (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). To leverage the scRNA-seq reference data, we further extended this framework to a nested-guided topic model by fine-tuning a dedicated set of CTS topic distributions for each phenotypic state (e.g., BRCA subtypes) of the patients from the bulk RNA-seq data. This enables learning not only intra-phenotype changes of cell-type distributions but inter-phenotype changes of gene expression. The latter allowed us to identify CTS DE genes directly from bulk RNA-seq data (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). We extended this approach to infer phenotype and cell-type guided topics from single-cell breast cancer RNA-seq data with cancer subtypes as the phenotype guide. This led to accurate deconvolution of cancer subtypes from bulk TCGA-BRCA data, as well as identification of phenotype-specific and CTS DE genes from the single-cell data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S30). Only a few methods can perform both deconvolution and CTS DE analysis. For example, CIBERSORTx [<xref ref-type="bibr" rid="CR18">18</xref>] uses a non-negative matrix factorization approach based on partial observations to identify CTS DE genes across phenotypes. Other methods such as TOAST [<xref ref-type="bibr" rid="CR24">24</xref>] and bMIND [<xref ref-type="bibr" rid="CR23">23</xref>] that can estimate CTS DE require precomputed cell-type proportions by an external deconvolution method.</p>
    <p id="Par32">As future works, we can adapt GTM-decon to leverage other single-cell omic data such as scATAC-seq for reference and deconvolve the equivalent omic in bulk samples. It can also be extended to work with different cell states, like in BayesPrism [<xref ref-type="bibr" rid="CR22">22</xref>], by modeling the topics based on cell states instead of cell types. Like all other deconvolution approaches, GTM-decon alone is unable to identify novel cell types from bulk RNA-seq datasets (i.e., cell types that are not present in the reference scRNA-seq data GTM-decon is trained on), while it is able to capture perturbed cell types based on the phenotypes (e.g., Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). This can be addressed by training GTM-decon on an atlas-level scRNA-seq data such as the Human Cell Landscape [<xref ref-type="bibr" rid="CR49">49</xref>] and Tabula Sapiens [<xref ref-type="bibr" rid="CR50">50</xref>], which comprehensively covers most of the cell types in the primary tissues. The resulting model can then be used to deconvolve bulk samples of any given target tissue. Lastly, cell types are not independent entities but rather form a lineage. One future direction is to exploit the relations among the cell types, which may better capture the underlying phenotypic states of the subjects. A more recently developed method called CeDAR [<xref ref-type="bibr" rid="CR51">51</xref>] uses known cell-type hierarchy as prior to infer CTS expression in bulk data as opposed to our de novo sub-cell-type inference and will leave a more detailed comparison as future work. Moreover, we can also extend GTM-decon to modeling multi-omic single-cell data to identify multi-omic CTS topic distributions and then use them to deconvolve multi-omic bulk data. To this end, while several multi-omic modeling methods have been developed [<xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR55">55</xref>], their benefits in deconvolution are not fully realized. Lasty, deep-learning-based methods such as Scaden [<xref ref-type="bibr" rid="CR22">22</xref>] can train on simulated or real bulk RNA-seq datasets to predict cell-type proportions. While Scaden can confer accurate deconvolution results, it compromises interpretability because of its non-linear distributed representation of the gene expression features. Some recently developed variational autoencoder and embedded topic modeling frameworks [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>] may be extended to strike a balance between deconvolution accuracy and model interpretability.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par33">Computational cell-type deconvolution of heterogeneous bulk transcriptome is highly cost-effective in revealing the underlying phenotypic states and identifying CTS differentially expressed genes. GTM-decon represents a significant advance in the deconvolution methods with 3 prominent contributions: (1) automatic inference of interpretable CTS topic distributions by directly modeling large single-cell RNA-seq reference data without using known marker genes, therefore providing a principled and amenable reference map for the subsequent deconvolution; (2) identifying sub-CTS gene expression distributions by inferring multiple topics anchored at the same cell type, leading to a finer resolution of the deconvolution results; (3) detecting CTS DE genes directly from bulk or single-cell samples via an extended nested-guided topic design leveraging both the phenotype states and cell-type label information. Our comprehensive experiments on pancreatic and breast datasets demonstrated the utilities of all 3 contributions. Together, GTM-decon is an efficient marker-free deconvolution method that takes the full advantage of the single-cell RNA-seq reference data for cell-type deconvolution.</p>
  </sec>
  <sec id="Sec16">
    <title>Methods</title>
    <sec id="Sec17">
      <title>Modeling scRNA-seq reference data via topic inference guided by cell-type labels</title>
      <p id="Par34">We adapted GTM-decon from the MixEHR-Guided (Mixture of Electronic Health Records – Guided) [<xref ref-type="bibr" rid="CR58">58</xref>] (which was in turn inspired by MixEHR (Mixture of Electronic Health Records) [<xref ref-type="bibr" rid="CR59">59</xref>] and sureLDA (Surrogate-guided ensemble Latent Dirichlet Allocation) [<xref ref-type="bibr" rid="CR60">60</xref>]) to model gene expression from scRNA-seq data. We assume that the scRNA-seq data are generated from the following data generative process. Each cell indexed by m ∈ {1, …, M} is a mixture of the K cell types. The cell-type mixture <inline-formula id="IEq16"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq16.gif"/></alternatives></inline-formula> is sampled from a K-dimensional Dirichlet distribution <inline-formula id="IEq17"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\varvec{\uptheta}}}_{\mathrm{m}} \sim \mathrm{ Dir}({\varvec{\upalpha}}}_{m}+0.1)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq17.gif"/></alternatives></inline-formula> with the hyperparameter <inline-formula id="IEq18"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq18.gif"/></alternatives></inline-formula> being specific to the cell. The key assumption here that separates GTM-decon from the standard LDA [<xref ref-type="bibr" rid="CR25">25</xref>] is the use of noisy cell-type label <inline-formula id="IEq19"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\in \{1,..,K\}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq19.gif"/></alternatives></inline-formula> for the cell. The hyperparameter corresponding to the cell-type label <inline-formula id="IEq20"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}=k$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq20.gif"/></alternatives></inline-formula> has higher value (<inline-formula id="IEq21"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}= 0.9$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq21.gif"/></alternatives></inline-formula> by default) in contrast to the rest of the hyperparameters <inline-formula id="IEq22"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq22.gif"/></alternatives></inline-formula> for <inline-formula id="IEq23"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}{\prime}\ne k$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq23.gif"/></alternatives></inline-formula>, which are randomly set to small values between 0.01 and 0.1. Note that having non-zero <inline-formula id="IEq24"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq24.gif"/></alternatives></inline-formula> allows other cell types to be assigned to the cell (i.e., <inline-formula id="IEq25"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{m,{k}^{{\prime} } }\ge 0$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq25.gif"/></alternatives></inline-formula>) and therefore <inline-formula id="IEq26"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq26.gif"/></alternatives></inline-formula> reflects the statistical uncertainty of the cell-type label <inline-formula id="IEq27"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq27.gif"/></alternatives></inline-formula>, which can be error prone due to various technical and data preprocessing aspects of the scRNA-seq data. To not clutter the notation, we omit the baseline value 0.1 in the following model description and use the more general form of <inline-formula id="IEq28"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\varvec{\uptheta}}}_{\mathrm{m}} \sim \mathrm{ Dir}({\varvec{\upalpha}}}_{m})$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq28.gif"/></alternatives></inline-formula> instead. Following the above default setting, this is equivalent to setting <inline-formula id="IEq29"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}=1$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq29.gif"/></alternatives></inline-formula> for the observed cell type and <inline-formula id="IEq30"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}\in [0.11, 0.2]$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.11</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq30.gif"/></alternatives></inline-formula> for other cell types. For each cell <inline-formula id="IEq31"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M122"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq31.gif"/></alternatives></inline-formula>, each scRNA-sequenced read <inline-formula id="IEq32"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \left\{1,\dots , {N}_{m}\right\}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq32.gif"/></alternatives></inline-formula> originates from one of the <inline-formula id="IEq33"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M126"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq33.gif"/></alternatives></inline-formula> cell types with the probabilities dictated by its cell-type mixture (<inline-formula id="IEq34"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq34.gif"/></alternatives></inline-formula>): <inline-formula id="IEq35"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}\sim \mathrm{Cat}\left({{\varvec{\uptheta}}}_{m}\right)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq35.gif"/></alternatives></inline-formula>. Given the cell type <inline-formula id="IEq36"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}=k$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq36.gif"/></alternatives></inline-formula>, the <italic>i</italic>th read maps to a specific gene indexed by <inline-formula id="IEq37"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq37.gif"/></alternatives></inline-formula> with the probabilities dictated by the CTS topic distribution over all genes (<inline-formula id="IEq38"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq38.gif"/></alternatives></inline-formula>): <inline-formula id="IEq39"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m} \sim \mathrm{Cat}({{\varvec{\upphi}}}_{k})$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq39.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq40"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq40.gif"/></alternatives></inline-formula> follows a G-dimensional Dirichlet distribution with a fixed hyperparameter <inline-formula id="IEq41"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M142"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq41.gif"/></alternatives></inline-formula> across all <italic>K</italic> dimensions: <inline-formula id="IEq42"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}\sim \mathrm{Dir}\left(\beta \right)$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq42.gif"/></alternatives></inline-formula>. Since the topic mixture <inline-formula id="IEq43"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq43.gif"/></alternatives></inline-formula> are softly clamped to specific cell types via the <italic>K</italic>-dimensional hyperparameter <inline-formula id="IEq44"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq44.gif"/></alternatives></inline-formula>, by following the above data generative process, it is straightforward to see that the <italic>K</italic> sets of topic distributions <inline-formula id="IEq45"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq45.gif"/></alternatives></inline-formula>‘s are also CTS.</p>
      <p id="Par35">The posterior distribution for the latent variables <inline-formula id="IEq46"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq46.gif"/></alternatives></inline-formula>’s, <inline-formula id="IEq47"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq47.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq48"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq48.gif"/></alternatives></inline-formula>’s conditioned on the scRNA-seq reference data can be either approximated by Gibbs sampling [<xref ref-type="bibr" rid="CR61">61</xref>] or by collapsed mean-field variational inference [<xref ref-type="bibr" rid="CR62">62</xref>]. Specifically, for algorithmic convenience, we can leverage the conjugacy of the Dirichlet to categorical distribution by integrating out <inline-formula id="IEq49"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq50.gif"/></alternatives></inline-formula> resulting in two Dirichlet-Multinomial distributions [<xref ref-type="bibr" rid="CR63">63</xref>]:<disp-formula id="Equa"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(z\vert\alpha\right)=\int p\left(\theta\vert\alpha\right)p\left(z\vert\theta\right)d\theta=\prod_m\frac{\Gamma(\sum_k\alpha_{m,k})}{\prod_k\Gamma(\alpha_{m,k})}\frac{\prod_k\Gamma(\alpha_{m,k}+n_{.,m,k})}{\Gamma(\sum_k\alpha_{m,k}+n_{.,m,k})}$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(x|z\right)=\int p\left(\phi |\beta \right)p\left(x|z,\phi \right)d\phi ={\prod }_{k}\frac{\Gamma \left(G\beta \right)}{{\prod }_{g}\Gamma \left(\beta \right)}\frac{{\prod }_{g}\Gamma \left(\beta +{n}_{g,.,k}\right)}{\Gamma (G\beta +{\sum }_{g}{n}_{g,.,k})}$$\end{document}</tex-math><mml:math id="M164" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>G</mml:mi><mml:mi>β</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">Note that we can recover the expected values for <inline-formula id="IEq51"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq51.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq52"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq52.gif"/></alternatives></inline-formula>’s given the posterior estimates of <inline-formula id="IEq53"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}{\prime}s$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq53.gif"/></alternatives></inline-formula> as they are proportional to the unnormalized counts <inline-formula id="IEq54"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}={\sum }_{i}[{z}_{i,m}=k]$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq54.gif"/></alternatives></inline-formula> and <inline-formula id="IEq55"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}={\sum }_{m}\left[{z}_{i,m}=k,{x}_{i,m}=g\right]$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq55.gif"/></alternatives></inline-formula>, respectively.</p>
      <p id="Par37">The conditional distribution of the topic assignment for read <inline-formula id="IEq56"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M176"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq56.gif"/></alternatives></inline-formula> and cell <inline-formula id="IEq57"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M178"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq57.gif"/></alternatives></inline-formula> has a closed form expression:<disp-formula id="Equc"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(z_{i,m}=k\vert{x_{i,m}=g,z}^{-\left(i,m\right)},x^{-\left(i,m\right)}\right)\propto p\left(z_{i,m}=k,z^{-\left(i,m\right)}\vert\alpha_{m,k}\right)p\left(x_{i,m}=g,x^{-\left(i,m\right)}\vert z_{i,m}=k,z^{-\left(i,m\right)}\right)\propto\frac{\prod_k\Gamma\left(\alpha_{m,k}+n_{.,m,k}\right)}{\Gamma(\sum_k\alpha_{m,k}+n_{.,m,k})}\prod_k\frac{\prod_g\Gamma\left(\beta+n_{g,.,k}\right)}{\Gamma(G\beta+\sum_gn_{g,.,k})}\propto\prod_{{}_{k'\neq k}}\;\Gamma\left(\alpha_{m,k'}+n_{.,m,k'}^{\left(-i\right)}\right)\Gamma\left(\alpha_{m,k}+n_{.,m,k}^{\left(-i\right)}+1\right)\prod_{{}_{k'\neq k}}\;\frac{\prod_g\Gamma\left(\beta+n_{g,.,k}^{-\left(i,m\right)}\right)}{\Gamma(G\beta+\sum_gn_{g,.,k}^{-\left(i,m\right)})}\frac{\Gamma\left(\beta+n_{g,.,k}^{-\left(i,d\right)}+1\right)}{\Gamma(G\beta+\sum_gn_{g,.,k}^{-\left(i,d\right)}+1)}\propto\prod_k\Gamma\left(\alpha_{m,k'}+n_{.,m,k'}^{\left(-i\right)}\right)\left(\alpha_{m,k}+n_{.,m,k}^{\left(-i\right)}\right)\prod_k\frac{\prod_g\Gamma\left(\beta+n_{g,.,k}^{-\left(i,m\right)}\right)}{\Gamma(G\beta+\sum_gn_{g,.,k}^{-\left(i,m\right)})}\frac{\beta+n_{g,.,k}^{-\left(i,d\right)}}{G\beta+\sum_gn_{g,.,k}^{-\left(i,d\right)}}\propto\left(\alpha_{m,k}+n_{.,m,k}^{\left(-i\right)}\right)\left(\frac{\beta+n_{g,.,k}^{-\left(i,m\right)}}{G\beta+\sum_gn_{g,.,k}^{-\left(i,m\right)}}\right)$$\end{document}</tex-math><mml:math id="M180" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup></mml:mfenced><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup></mml:mfenced><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:msub><mml:mrow/><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mspace width="0.277778em"/><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:munder><mml:mo>∏</mml:mo><mml:msub><mml:mrow/><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mspace width="0.277778em"/><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where the second last equality exploits the property of the Gamma function, i.e., <inline-formula id="IEq58"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma \left(x+1\right)=\Gamma \left(x\right)x$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq58.gif"/></alternatives></inline-formula>. Here <inline-formula id="IEq59"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}^{(-i)}$$\end{document}</tex-math><mml:math id="M184"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq59.gif"/></alternatives></inline-formula> is the total number of scRNA-seq reads allocated for topic <italic>k</italic> for cell <italic>m</italic> without counting the current <italic>i</italic>th read, and <inline-formula id="IEq60"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}^{-\left(i,m\right)}$$\end{document}</tex-math><mml:math id="M186"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq60.gif"/></alternatives></inline-formula> is the total read counts for gene <italic>g</italic> under topic <italic>k</italic> across all of the <italic>M</italic> cells, without counting the current <italic>i</italic>th read in the <italic>m</italic>th cell:<disp-formula id="Equd"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{.,m,k}^{(-i)}=\sum_{i'\neq i}^{N_m}{\lbrack z}_{i',m}=k\rbrack$$\end{document}</tex-math><mml:math id="M188" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{g,.,k}^{-\left(i,m\right)}=\sum_{{}_{m'\neq m\mathrm{or}i'\neq i}}\;\left[z_{i',m'}=k,x_{i',m'}=g\right]$$\end{document}</tex-math><mml:math id="M190" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mrow/><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>m</mml:mi><mml:mi mathvariant="normal">or</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mspace width="0.277778em"/><mml:mfenced close="]" open="["><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">From here, the topic inference can be done by collapsed Gibbs sampling from <inline-formula id="IEq61"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({z}_{i,m}=k|{z}^{-\left(i,m\right)},x\right)$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq61.gif"/></alternatives></inline-formula>, while fixing the topic assignments for all other reads [<xref ref-type="bibr" rid="CR61">61</xref>]. For a large number of cells in the scRNA-seq data, the collapsed Gibbs sampling approach tends to be slow in reaching an equilibrium state. Therefore, we took a deterministic mean-field variational inference approach, known as the collapsed variational Bayes (CVB) [<xref ref-type="bibr" rid="CR62">62</xref>]. Specifically, we approximate the posterior distribution of the cell-type assignment <inline-formula id="IEq62"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({z}_{i.m}\right|\mathbf{x},{{\varvec{\upalpha}}}_{m})$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close="|" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq62.gif"/></alternatives></inline-formula> via the variational categorical distribution <inline-formula id="IEq63"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q\left({z}_{i,m} \right|{ x}_{i,m}=g$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi>q</mml:mi><mml:mfenced close="|" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq63.gif"/></alternatives></inline-formula>) = <inline-formula id="IEq64"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\prod_{k}{\gamma }_{i,m,k}^{\left[{z}_{i,m}=k\right]}$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close="]" open="["><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq64.gif"/></alternatives></inline-formula>, where<disp-formula id="Equf"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{i,m,k }\propto \left({\alpha }_{m,k }+{n}_{.,m,k}^{(-i)} \right)\left(\frac{\beta + {n}_{g,.,k}^{-\left(i,m\right)}}{G{\beta }+{\sum }_{g}{n}_{g,.,k}^{-(i,m)}}\right)$$\end{document}</tex-math><mml:math id="M200" display="block"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">Using the variational parameters for the topic assignments, the above sufficient statistics are replaced by the soft counts:<disp-formula id="Equg"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{.,m,k}^{\left(-i\right)}=\sum_{i'\neq i}^{N_m}\;\gamma_{i',m,k}$$\end{document}</tex-math><mml:math id="M202" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:munderover><mml:mspace width="0.277778em"/><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{g,.,k}^{-\left(i,m\right)}=\sum_{m'\neq m\mathrm{or}i'\neq i}\;\left[x_{i',m'}=g\right]\alpha_{m,k}\gamma_{i',m',k}$$\end{document}</tex-math><mml:math id="M204" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>m</mml:mi><mml:mi mathvariant="normal">or</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.277778em"/><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mfenced><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par40">Here in updating the global gene distribution in the second equation, we further make use of the CTS prior <inline-formula id="IEq65"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq65.gif"/></alternatives></inline-formula> to obtain more interpretable results.</p>
      <p id="Par41">The above topic inference formulation operates at the level of read. For computational efficiency, our actual implementation of the topic inference was simplified to operate at the level of gene instead of the level of read:<disp-formula id="Equi"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,m,k }\propto \left({\alpha }_{m,k }+{n}_{.,m,k}^{(-g)} \right)\left(\frac{\beta + {n}_{g,.,k}^{(-m)}}{G{\beta }+\sum_{g}{n}_{g,.,k}^{(-m)}}\right)$$\end{document}</tex-math><mml:math id="M208" display="block"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">Similar to the above sufficient statistics, <inline-formula id="IEq66"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}^{(-g)}= \sum_{{g}{\prime}\ne g}{\gamma }_{{g}{\prime},m,k}$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq66.gif"/></alternatives></inline-formula> is the total number of scRNA-seq reads allocated for topic <italic>k</italic> for cell <italic>m</italic>, and <inline-formula id="IEq67"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}^{\left(-m\right)}= \sum_{{m}{\prime}\ne m}{{\alpha }_{m,k}\gamma }_{{g,m}{\prime},k}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq67.gif"/></alternatives></inline-formula> is the total read counts for gene <italic>g</italic> under topic <italic>k</italic> across all of the <italic>M</italic> cells, without counting the <italic>g</italic>th gene for cell <italic>m</italic>. This is equivalent to a reasonable assumption that all the reads from the same gene for the same cell are originated from the same cell type, i.e., <inline-formula id="IEq68"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\forall }_{i,{i}{\prime}} {z}_{i,m}={z}_{{i}{\prime},m}$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:msub><mml:mo>∀</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq68.gif"/></alternatives></inline-formula> if <inline-formula id="IEq69"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}={x}_{{i}{\prime},m}$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq69.gif"/></alternatives></inline-formula>.</p>
      <p id="Par43">Together, the inference algorithm alternates between two simple steps: (1) for each cell and each gene, perform coordinate ascent by computing <inline-formula id="IEq70"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,m,k}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq70.gif"/></alternatives></inline-formula> while fixing the variational parameters <inline-formula id="IEq71"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{{g}{\prime},m,k}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq71.gif"/></alternatives></inline-formula> for other genes <inline-formula id="IEq72"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${g}{\prime}$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq72.gif"/></alternatives></inline-formula>; (2) update the sufficient statistics. This algorithm maximizes the evidence lower bound <inline-formula id="IEq73"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ELBO={E}_{q}\left[\mathrm{log}p\left(x|z\right)\right]+{E}_{q}[\mathrm{log}p(z|\alpha )]-{E}_{q}[\mathrm{log}q\left(z|\gamma \right)]$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">log</mml:mi><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>q</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>γ</mml:mi></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq73.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR62">62</xref>]. The model is deemed converged when ELBO stops improving by a small threshold (1e<sup>−6</sup> by default).</p>
      <p id="Par44">Upon convergence, the expected values for <inline-formula id="IEq74"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{\mathrm{m},\mathrm{k}}$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,k}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq75.gif"/></alternatives></inline-formula> are:<disp-formula id="Equj"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}_{q}\left[{\theta }_{m,k}\right]= \frac{{{\alpha }_{m,k}+n}_{.,m,k}}{{\sum }_{k}{{\alpha }_{m,k}+n}_{.,m,k}}\equiv {\widehat{\theta }}_{\mathrm{m},\mathrm{k}}; {\mathbb{E}}_{q}\left[{\phi }_{\mathrm{g},\mathrm{k}}\right]=\frac{\beta +{n}_{g,.,k}}{G\beta +{\sum }_{g}{n}_{g,.,k}}\equiv {\widehat{\phi }}_{\mathrm{g},\mathrm{k}}$$\end{document}</tex-math><mml:math id="M230" display="block"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≡</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≡</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq76"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}={\sum }_{i=1}^{{N}_{m}}{\gamma }_{i,m,k}$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}=\sum_{m=1}^{M}[{x}_{i,m}=g]{\alpha }_{m,k}{\gamma }_{i,m,k}$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq77.gif"/></alternatives></inline-formula>. Here <inline-formula id="IEq78"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\{\widehat{\theta }}_{\mathrm{m},\mathrm{k}}\}}_{M\times K}=\widehat{\Theta }$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq78.gif"/></alternatives></inline-formula> can be used to assess the “purity” of the single cells as a quality control step and <inline-formula id="IEq79"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\{\widehat{\phi }}_{\mathrm{g},\mathrm{k}}\}}_{\mathrm{G}\times \mathrm{K}}=\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq79.gif"/></alternatives></inline-formula> probabilities are used as the CTS topics in the subsequent deconvolution step.</p>
    </sec>
    <sec id="Sec18">
      <title>Inferring multiple topics per cell type</title>
      <p id="Par45">Suppose we use <inline-formula id="IEq80"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M240"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq80.gif"/></alternatives></inline-formula> topics per cell type for <inline-formula id="IEq81"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M242"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq81.gif"/></alternatives></inline-formula> cell types, the hyperparameter <inline-formula id="IEq82"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq82.gif"/></alternatives></inline-formula> for cell <inline-formula id="IEq83"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M246"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq83.gif"/></alternatives></inline-formula> can be formulated into a <inline-formula id="IEq84"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times L$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq84.gif"/></alternatives></inline-formula> matrix. Given that the cell-type label for cell <inline-formula id="IEq85"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M250"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq85.gif"/></alternatives></inline-formula> is <inline-formula id="IEq86"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}=k$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq86.gif"/></alternatives></inline-formula>, we set the <italic>k</italic>th row of <inline-formula id="IEq87"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq87.gif"/></alternatives></inline-formula> to relatively high values and the rest of the <italic>K</italic>-1 rows to relatively low values. For example, suppose we have 5 cell types and 3 sub-topics per cell type. If cell <inline-formula id="IEq88"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M256"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq88.gif"/></alternatives></inline-formula> is labeled with cell type 2, then the topic prior hyperparameter matrix <inline-formula id="IEq89"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq89.gif"/></alternatives></inline-formula> can be set to the following values: [0.01, 0.01, 0.01; 0.9, 0.9, 0.9; 0.01, 0.01, 0.01; 0.01, 0.01, 0.01; 0.01, 0.01, 0.01], where comma separates the columns and semicolons separate the rows. Here, the 3 topic prior values in the second row corresponding to cell type 2 are set to 0.9 and the values in the remaining rows are set to 0.01.</p>
      <p id="Par46">The data generative process is identical to the basic GTM-decon except having <inline-formula id="IEq90"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times L$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq90.gif"/></alternatives></inline-formula> topics instead of <inline-formula id="IEq91"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M262"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq91.gif"/></alternatives></inline-formula> topics. Specifically, to sample the cell-type mixture <inline-formula id="IEq92"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq92.gif"/></alternatives></inline-formula>, we flatten the <inline-formula id="IEq93"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times L$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq93.gif"/></alternatives></inline-formula> matrix for <inline-formula id="IEq94"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq94.gif"/></alternatives></inline-formula> to have a row vector of <inline-formula id="IEq95"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\times \left(K\times L\right)$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq95.gif"/></alternatives></inline-formula> so that the <inline-formula id="IEq96"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq96.gif"/></alternatives></inline-formula> will have relatively high expected value for the <inline-formula id="IEq97"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}^{th}$$\end{document}</tex-math><mml:math id="M274"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq97.gif"/></alternatives></inline-formula> consecutive <italic>L</italic> values that correspond to the labeled cell type and relatively low expected value for the rest of the entries. We experimented modeling each cell type using <inline-formula id="IEq98"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\in \{2, 3, 4, 5\}$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq98.gif"/></alternatives></inline-formula> topics per cell type, with the hyperparameters <inline-formula id="IEq99"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq99.gif"/></alternatives></inline-formula> for each cell of cell type <inline-formula id="IEq100"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M280"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq100.gif"/></alternatives></inline-formula> set to 0.45, 0.3, 0.22, and 0.18, respectively. The prior values for the remaining topics were assigned with random values between 0.001 and 0.01. These priors were heuristically chosen based on the hyperparameter of value 0.9 for one topic divided by the number of topics per cell type.</p>
    </sec>
    <sec id="Sec19">
      <title>Inferring mixing cell-type proportions in bulk transcriptome</title>
      <p id="Par47">We assume a similar data generative process of the bulk transcriptome as the single-cell transcriptome described above. In particular, each bulk sample <inline-formula id="IEq101"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j\in \{1,..,D\}$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq101.gif"/></alternatives></inline-formula> is a mixture of <inline-formula id="IEq102"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M284"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq102.gif"/></alternatives></inline-formula> cell types. Its cell-type mixture <inline-formula id="IEq103"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{j}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq103.gif"/></alternatives></inline-formula> is sampled from a K-dimensional symmetric Dirichlet distribution <inline-formula id="IEq104"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{j}}\sim \mathrm{Dir}({\varvec{\upalpha}})$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq104.gif"/></alternatives></inline-formula> with the hyperparameter fixed at a constant value across all <italic>K</italic> cell types (default: <inline-formula id="IEq105"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{k}=0.1\forall k$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>∀</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq105.gif"/></alternatives></inline-formula>). The flat hyperparameter value is used here since we typically do not have any prior information about the cell-type mixtures in the bulk RNA-seq data. For <inline-formula id="IEq106"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{j}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq106.gif"/></alternatives></inline-formula> total RNA-seq reads of bulk sample <italic>j</italic>, each read <inline-formula id="IEq107"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \{1,\dots ,{N}_{j}\}$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq107.gif"/></alternatives></inline-formula> originates from one of the <inline-formula id="IEq108"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M296"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq108.gif"/></alternatives></inline-formula> cell types with the categorical rates set to be <inline-formula id="IEq109"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{j}}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq109.gif"/></alternatives></inline-formula>: <inline-formula id="IEq110"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,j}\sim \mathrm{Cat}({{\varvec{\uptheta}}}_{j})$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq110.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq111"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,j}\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq111.gif"/></alternatives></inline-formula>, and maps to a specific gene indexed by <inline-formula id="IEq112"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,j}\in \{1,\dots ,G\}$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq112.gif"/></alternatives></inline-formula> with a <italic>known</italic> CTS categorical rates <inline-formula id="IEq113"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{{\varvec{\upphi}}}}_{{z}_{i,j}}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq113.gif"/></alternatives></inline-formula>: <inline-formula id="IEq114"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,j}\sim \mathrm{Cat}({\widehat{{\varvec{\upphi}}}}_{{z}_{i,j}})$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq114.gif"/></alternatives></inline-formula>.</p>
      <p id="Par48">Performing deconvolution on a bulk transcriptome profile is equivalent to inferring the posterior distribution of the CTS topic mixture given its gene expression and the CTS topic distributions: <inline-formula id="IEq115"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{p}({\varvec{\uptheta}}}_{\mathrm{j}}|{\mathbf{x}}_{j},\widehat{\Phi }$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq115.gif"/></alternatives></inline-formula>). To this end, we used the <inline-formula id="IEq116"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{G}\times K$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq116.gif"/></alternatives></inline-formula> genes-by-CTS-topic estimates <inline-formula id="IEq117"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\Phi }$$\end{document}</tex-math><mml:math id="M314"><mml:mover accent="true"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq117.gif"/></alternatives></inline-formula> inferred from the scRNA-seq reference data (described in section “<xref rid="Sec17" ref-type="sec">Modeling scRNA-seq reference data via topic inference guided by cell-type labels</xref>”) and perform variational inference to infer the cell-type mixture <inline-formula id="IEq118"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{j}$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq118.gif"/></alternatives></inline-formula> for the <italic>j</italic>th bulk RNA-seq profile. Implementation-wise, similar to the scRNA-seq topic modeling, we also use the simplified topic inference algorithm at the gene level <inline-formula id="IEq119"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g\in \{1,\dots ,G\}$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq119.gif"/></alternatives></inline-formula> as opposed to at read level. This involves alternating between the topic assignment inference for <inline-formula id="IEq120"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,j,k}$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq120.gif"/></alternatives></inline-formula> and computing the sufficient statistics <inline-formula id="IEq121"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,j,k}^{-\left(g\right)}$$\end{document}</tex-math><mml:math id="M322"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq121.gif"/></alternatives></inline-formula> while fixing <inline-formula id="IEq122"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\Phi }$$\end{document}</tex-math><mml:math id="M324"><mml:mover accent="true"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq122.gif"/></alternatives></inline-formula>. Algorithmically, for each gene, we infer the topic assignments:<disp-formula id="Equk"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,j,k }\propto \left({\alpha }+{n}_{.,j,k}^{(-g)} \right){\widehat{\phi }}_{g,k}$$\end{document}</tex-math><mml:math id="M326" display="block"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equk.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq123"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,j,k}^{(-g)}= \sum_{{g}{\prime}\ne g}{\gamma }_{{g}{\prime},j,k}$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq123.gif"/></alternatives></inline-formula>. Upon convergence, we compute the expected CTS-topic mixture:<disp-formula id="Equl"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}_{q}\left[{\theta }_{j,k}\right]= \frac{{\alpha +n}_{.,j,k}}{K\alpha +{\sum }_{k}{n}_{.,j,k}}$$\end{document}</tex-math><mml:math id="M330" display="block"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">The bulk sample is transformed in the same way as the scRNA-seq reference data as described in the “<xref rid="Sec24" ref-type="sec">Preprocessing the reference scRNA-seq data</xref>” section.</p>
      <p id="Par50">We also show that although GTM-decon infers RNA fractions instead of cell-type fractions, the correlation between the RNA fractions and cell-fractions is strong across cell types in multiple datasets, suggesting that RNA fractions per cell type can serve as a good surrogate to the cell fraction per cell type despite the potential differences in cell sizes among cell types (described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S9 and illustrated in Fig. S31).</p>
    </sec>
    <sec id="Sec20">
      <title>Sparsification of the bulk data to directly infer topic distributions from them</title>
      <p id="Par51">In order to identify de novo topics that are not present in the reference scRNA-seq data, we applied standard LDA using the CVB implementation from MixEHR [<xref ref-type="bibr" rid="CR59">59</xref>] to the sparsified bulk RNA-seq data. However, bulk RNA-seq data is a dense matrix with most genes having non-zero entries while topic models excel at modeling sparse matrices (e.g., scRNA-seq data). To make the bulk RNA-seq data amenable to our approach, we sparsified the dense matrix by setting all values below the 75th percentile to 0. This cutoff was derived from scRNA-seq datasets, where on average 25% of genes in a cell have non-zero count values. While sparsifying works well in our applications, as a caveat, we acknowledge that it will lead to information loss. We also experimented with two other approaches to sparsify the matrix: (1) training GTM-decon only using HVG genes in bulk RNA-seq data; (2) training GTM-decon using differentially expressed genes identified between the phenotypes using DESeq2 [<xref ref-type="bibr" rid="CR64">64</xref>].</p>
      <p id="Par52">Note that the sparsification procedure was done on the bulk data only when we directly inferred gene topic distributions from them, which pertains to the de novo topic inference from bulk samples, phenotype-guided topic inference from the bulk, and nest-guided CTS-phenotype topic inference. All of the deconvolution experiments, where we first inferred topics from a single-cell reference dataset and then applied the inferred topics to deconvolve bulk data, does not involve the sparsification procedure (i.e., deconvolving the original bulk transcriptomes as they are).</p>
    </sec>
    <sec id="Sec21">
      <title>Identifying statistically significant marker genes per cell type</title>
      <p id="Par53">After GTM-decon topic inference, marker genes for each cell type were identified using permutation test. Specifically, for gene <italic>g</italic> under topic <italic>k</italic>, we computed the difference of its topic score <inline-formula id="IEq124"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,k}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq124.gif"/></alternatives></inline-formula> from the average topic score over the rest of the <italic>K</italic>-1 topics <inline-formula id="IEq125"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,{k}{\prime}\ne k}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq125.gif"/></alternatives></inline-formula>. For example, for 3 cell types, the test statistic for cell type 1 is calculated as <inline-formula id="IEq126"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,1}-\left({\phi }_{g,2}+{\phi }_{g,3}\right)/2$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq126.gif"/></alternatives></inline-formula>. More generally, for <italic>K</italic> cell types and <italic>T</italic> topics per cell topic, the test statistic for cell type <italic>k</italic> and gene <italic>g</italic> is<disp-formula id="Equm"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{T}\left(\sum_{t=1}{\phi }_{k,g}^{\left\{t\right\}}- \frac{1}{K-1} \sum_{{k}{\prime}\ne k}\sum_{t=1}{\phi }_{{k}{\prime},g}^{\left\{t\right\}}\right)$$\end{document}</tex-math><mml:math id="M338" display="block"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mfenced close=")" open="("><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mfenced close="}" open="{"><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mfenced close="}" open="{"><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">The significance of the observed statistic is compared against the same statistic calculated from 100,000 permutations. The empirical <italic>p</italic>-value is computed as fraction of permutations, where the test statistic is greater than the observed value.</p>
    </sec>
    <sec id="Sec22">
      <title>Evaluation of deconvolution accuracy using simulated and real bulk data</title>
      <p id="Par55">We evaluated the deconvolution accuracy by comparing the inferred cell-type proportions against the ground truth values for the datasets. First, we simulated bulk RNA-seq data using the scRNA-seq dataset. We summed the gene expression counts of each sample from the scRNA-seq data to represent the bulk data of that sample (artificial bulk transcriptome). The ground-truth cell-type proportions are the fraction of cells for each cell type. To avoid information bias in the evaluation, we performed leave-one-out cross-validation (LOOCV) by inferring topics from scRNA-seq data for <italic>N</italic> − 1 subjects as the training examples and deconvolving the held-out subject as the validation example. The results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10.</p>
      <p id="Par56">In addition, we also used real bulk data with known cell-type proportion to benchmark our methods. To conduct different benchmarking and qualitative experiments, we used scRNA-seq datasets from several tissues for training GTM-decon (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1): <bold>a</bold> human pancreas (E-MTAB-5061, GSE81433) (with 4 type 2 diabetes and 3 healthy subjects) and mouse (GSE81433); <bold>b</bold> Peripheral blood mononucleocytes (PBMC) of healthy human (GSE132044); <bold>c</bold> human blood cells (HBC) of healthy humans (GSE149938); <bold>d</bold> post-mortem brain tissue of frontal cortex from adult human (GSE97930); <bold>e</bold> Breast tissue from healthy individuals (GSE113197). Apart from healthy individuals, scRNA-seq references from patients with <bold>a</bold> pancreatic cancer (CRA001160) and <bold>b</bold> breast cancer (GSE176078) were used to deconvolve cancer bulk RNA-seq datasets.</p>
      <p id="Par57">Bulk RNA-seq datasets with known ground truth values were chosen for benchmarking (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Datasets with known ground truth proportions from flow cytometry include <bold>a</bold> whole blood from 12 individuals (obtained from CIBERSORTx webpage), <bold>b</bold> PBMC from a cohort of 13 individuals (GSE107011), <bold>c</bold> PBMC from a cohort of 346 individuals (SDY67). For brain tissue, ground truth proportions from immunohistochemistry were available for a cohort of 41 individuals from the Religious Orders Study / Memory and Aging Project (ROSMAP) study (CortexCellDeconv). A unique dataset with both bulk RNA-seq data and scRNA-seq data from pancreas was accessed from E-MTAB-5060 and E-MTAB-5061, respectively, with the cell type proportions from scRNA-seq considered as ground truth values.</p>
      <p id="Par58">For the 3 immune (SDY67, whole blood, PBMC S13 cohort) and brain prefrontal cortex (ROSMAP) bulk datasets, we used two independent single-cell references with the most closely matched tissues of origin (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For the pancreatic dataset (Segerstolpe), paired single-cell and bulk data from the same individuals were used in the LOOCV manner, where we used the cell-type proportions from the single-cell dataset to compare the estimated proportions from the paired bulk data in the same held-out subject.</p>
      <p id="Par59">To evaluate the concordance between the ground truth <inline-formula id="IEq127"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{y}}_{m}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq127.gif"/></alternatives></inline-formula> and our inferred cell-type mixture <inline-formula id="IEq128"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uptheta }_{m}$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq128.gif"/></alternatives></inline-formula> for each test sample <italic>m</italic>, we computed four common metric scores: (1) Pearson correlation coefficient (PCC), (2) Spearman correlation (SCC), (3) cross entropy (CE), and (4) residual mean squared error (RMSE) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Moreover, we also evaluated the deconvolution performance at each cell type using PCC and RMSE across samples (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S11-15).</p>
      <p id="Par60">For the qualitative analyses on the cancer datasets, the bulk RNA-seq datasets for pancreatic cancer (PAAD) and breast cancer (BRCA) datasets from TCGA were downloaded from the GDC data portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</ext-link>). Similarly, bulk RNA-seq data from the pancreas of a cohort of 89 normal and diabetic individuals was obtained from GSE50244.</p>
    </sec>
    <sec id="Sec23">
      <title>Implementation of the existing deconvolution methods</title>
      <p id="Par61">We compared GTM-decon with other state-of-the-art methods, including BSEQ-sc, BISQUE, MuSiC, CIBERSORTx, and BayesPrism. For BSEQ-sc, marker genes were selected from CellmarkerDB for the brain and immune datasets, while the built-in pancreatic marker genes were used for the Segerstolpe dataset. BISQUE requires at least two paired reference bulk and reference single-cell samples, which is the case for the Segerstolpe dataset. When using human blood cell (HBC) scRNA-seq data as a reference, in order to use BISQUE, artificial bulk samples were constructed using single-cell data. For the other 3 bulk datasets, since we used only one scRNA-seq reference, we left out BISQUE from the evaluation. For CIBERSORTx, all genes were provided to the web portal (<ext-link ext-link-type="uri" xlink:href="https://cibersortx.stanford.edu/">https://cibersortx.stanford.edu/</ext-link>) for Signature Matrix generation and Cell Fraction imputation. For BayesPrism, all genes were provided to the web portal (<ext-link ext-link-type="uri" xlink:href="https://www.bayesprism.org/">https://www.bayesprism.org/</ext-link>) for cell type composition estimation, with the metadata column for tumor status set to 0 for all cells.</p>
    </sec>
    <sec id="Sec24">
      <title>Preprocessing the reference scRNA-seq data</title>
      <p id="Par62">The gene expression profiles of scRNA-seq data were used as training data. Since the performance of GTM-decon may vary depending on how the scRNA-seq count data are processed, we explored different gene selection and transformations of the scRNA-seq data. Specifically, the following gene selection were considered:<list list-type="simple"><list-item><label>(i)</label><p id="Par63"><italic>all</italic>: all genes without removal of any gene;</p></list-item><list-item><label>(ii)</label><p id="Par64"><italic>pp</italic>: preprocessed genes to remove uninformative genes (frequently expressed genes—found in ≥ 80% of cells, infrequently expressed genes—found in ≤ 5 cells);</p></list-item><list-item><label>(iii)</label><p id="Par65"><italic>hvg:</italic> highly variable genes identified using the highly_variable_genes (HVG) function of scanpy [<xref ref-type="bibr" rid="CR65">65</xref>].</p></list-item></list></p>
      <p id="Par66">Furthermore, for each of these gene sets, the following transformation were considered:<list list-type="simple"><list-item><label>(i)</label><p id="Par67"><italic>raw count</italic> (all / pp / hvg)—scRNA-seq read counts per gene;</p></list-item><list-item><label>(ii)</label><p id="Par68"><italic>normr</italic> (all_normr / pp_normr / hvg_normr)—normalize counts (while excluding highly expressed genes for calculating the normalization factor) as counts divided by the sum of counts per cell multiplied by a scaling factor of 10,000 (a commonly used factor for scRNA-seq data [<xref ref-type="bibr" rid="CR66">66</xref>]), and round the values to their nearest integer to make the input suitable for topic modeling;</p></list-item><list-item><label>(iii)</label><p id="Par69"><italic>normr_log1p</italic> (all_normr_log1p / pp_normr_log1p / hvg_normr_log1p): log-transform normalized counts in (ii), and round the values to their nearest integer to make the input suitable for topic modeling.</p></list-item></list></p>
    </sec>
    <sec id="Sec25">
      <title>Gene set enrichment analysis (GSEA)</title>
      <p id="Par70">GSEA was performed using the fgsea package from R, on two different gene sets: (a) gene sets corresponding to specific cell types from CellMarkerDB [<xref ref-type="bibr" rid="CR30">30</xref>]; (b) gene set corresponding to the HALLMARK pathways from MSigDb using msigdbr [<xref ref-type="bibr" rid="CR67">67</xref>].</p>
    </sec>
    <sec id="Sec26">
      <title>Survival analysis</title>
      <p id="Par71">For TCGA datasets, after cell-type proportions are inferred using GTM-decon, survival analysis is performed using the survival and survminer R packages in order to assess if there is any correlation between survival probability of the cancer subjects and cell-type proportions for the cell types. Kaplan–Meier curves were generated for those cell types, where the association is deemed statistically significant at <italic>p</italic>-value &lt; 0.05 based on log-rank test.</p>
    </sec>
    <sec id="Sec27">
      <title>Learning phenotype-specific gene signatures from bulk RNA-seq data</title>
      <p id="Par72">To identify phenotype-specific genes, we applied GTM-decon to directly infer phenotype-topics from the sparsified bulk RNA-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). To evaluate phenotype prediction accuracy, we randomly split the bulk RNA-seq samples into training and test datasets in 80:20 ratio. The training dataset is guided in a manner similar to GTM-decon for the scRNA-seq datasets. Briefly, for each subject, the hyperparameter(s) for the topic(s) corresponding to the observed phenotype was (were) set to the prior value of 0.9, and the hyperparameters for the rest of the topics were set to a small value between 0.01 and 0.1. Since a model of 5 topics per cell type worked well for several scRNA-seq datasets, we opted to model each phenotype by 5 topics as well. For the subjects in the 20% test data, we summed up the inferred phenotype mixture <inline-formula id="IEq129"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{d,k}$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq129.gif"/></alternatives></inline-formula> values for all topics corresponding to the same phenotype. The predicted phenotype was the one with the highest summed up topic score. As a comparison, we also evaluated two other common machine learning methods namely logistic regression and random forest. We used their scikit-learn implementations with the default settings [<xref ref-type="bibr" rid="CR68">68</xref>].</p>
    </sec>
    <sec id="Sec28">
      <title>Identifying CTS DE genes from bulk transcriptomes from nested-guided topics</title>
      <p id="Par73">In identifying phenotype-specific differentially expressed genes, we developed a way to leverage the CTS topics inferred from the scRNA-seq reference data by fine-tuning the CTS topics based on gene expression from the sparsified bulk RNA-seq data for different phenotypes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). Specifically, we initialized the genes-by-topic matrix <inline-formula id="IEq130"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Phi }_{d}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq130.gif"/></alternatives></inline-formula> for <italic>each</italic> phenotype <italic>d</italic>. For example, for <inline-formula id="IEq131"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D=3$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq131.gif"/></alternatives></inline-formula> phenotypes in a tissue with <inline-formula id="IEq132"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=5$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq132.gif"/></alternatives></inline-formula> cell types, we will have 15 topics, comprising of 3 sets of CTS <inline-formula id="IEq133"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Phi }_{\mathrm{d}}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq133.gif"/></alternatives></inline-formula> matrices of 5 columns each. These matrices are guided by the phenotype labels during the variational inference.</p>
      <p id="Par74">For subject <italic>j</italic>, suppose his/her phenotype label is <italic>d</italic>
<inline-formula id="IEq134"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d\in \{1,..,D\}$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq134.gif"/></alternatives></inline-formula>. The topic hyperparameters <inline-formula id="IEq135"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{j,d,k}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq135.gif"/></alternatives></inline-formula>’s for all the <italic>K</italic> topics corresponding to the phenotype label <italic>d</italic> were set to 0.9, and the <inline-formula id="IEq136"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{j,{d}{\prime},k}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq136.gif"/></alternatives></inline-formula> for the other phenotypes were set to a small value between 0.01 and 0.1. These values were propagated throughout the variational inference, guiding the phenotypic inference appropriately. The inference algorithm is identical to the one described in “<xref rid="Sec17" ref-type="sec">Modeling scRNA-seq reference data via topic inference guided by cell-type labels</xref>” section for modeling the scRNA-seq data. This approach also works with single-cell transcriptomes from a disease study such as the single-cell breast cancer study, where we not only have the cell type information but also phenotype states of the subjects (i.e., ER + vs TNBC) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S8 and Fig. S30).</p>
      <p id="Par75">From the learned matrix, the test statistic of a DE candidate gene <italic>g</italic> between phenotypes <italic>d</italic> and <inline-formula id="IEq137"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}{\prime}\ne d$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mi>d</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq137.gif"/></alternatives></inline-formula> per cell type <italic>k</italic> were identified by subtracting the <inline-formula id="IEq138"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,d,k}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq138.gif"/></alternatives></inline-formula> value for phenotype <inline-formula id="IEq139"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M364"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq139.gif"/></alternatives></inline-formula> from the <inline-formula id="IEq140"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,{d}{\prime},k}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq140.gif"/></alternatives></inline-formula> value for phenotype <inline-formula id="IEq141"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}{\prime}$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq141.gif"/></alternatives></inline-formula>. We identify statistically significant genes with a <italic>p</italic>-value &lt; 0.05 by permutation test calculated from the 100,000 randomly shuffled <inline-formula id="IEq142"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Phi }_{d}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq142.gif"/></alternatives></inline-formula> matrices. The <italic>p</italic>-value is the fraction of times the null statistic from the permutations is greater than the observed test statistic. As a reference, we compared our approach against the DE genes identified from the same samples using DESeq2 [<xref ref-type="bibr" rid="CR64">64</xref>]. We identified hallmark pathways from MSigDb which were enriched for the DE genes by Over Representation Analysis (ORA) using the ClusterProfiler package from R [<xref ref-type="bibr" rid="CR69">69</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec29">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_3034_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary Section S1 (Evaluation on gene selection strategies); S2 (Evaluation on raw count and transformation strategies); S3 (Experimenting hyperparameters <inline-formula id="IEq143"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha_{\mathrm m,\mathrm k}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq143.gif"/></alternatives></inline-formula> for cell-type mixture prior); S4 (Experimenting hyperparameter <inline-formula id="IEq144"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M374"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq144.gif"/></alternatives></inline-formula> for CTS topics); S5 (Experimenting number of topics per cell type); S6 (Benchmark time and memory usage); S7 (Effect of sparsification on phenotype classification); S8 (Phenotype-CTS topic modeling of single-cell breast cancer transcriptomes for TCGA-BRCA bulk deconvolution); S9 (Effect of cell size on inference of cell-type deconvolution); Table S1-S3; Figure S1-S31.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_3034_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2. </bold>Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Yixuan Li for helping troubleshoot the GTM-decon software at its later stage.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par76">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par77">Andrew Cosgrove was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Y.L. conceived of the study. S.S. and Y.L. analyzed and interpreted the data, wrote the manuscript, and wrote the code for GTM-decon. M.H. ran the experiments on benchmarking the deconvolutional accuracy. Y.L. supervised the project. All authors approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Y.L. is supported by Canada Research Chair (Tier 2) in Machine Learning for Genomics and Healthcare, New Frontier Research Fund – Exploration (NFRFE-2019–00980), and Canada First Research Excellence Fund Healthy Brains for Healthy Life (HBHL) initiative New Investigator start-up award (G249591).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed during the current study were obtained from publicly available repositories or data portals. All the scRNA-seq datasets [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR70">70</xref>–<xref ref-type="bibr" rid="CR81">81</xref>] used for training in this study are listed in Table S<xref rid="MOESM1" ref-type="media">1</xref>, and all the bulk RNA-seq datasets with known ground truth proportions used in this study are listed in Table S<xref rid="MOESM1" ref-type="media">2</xref>. The Human pancreatic islet single-cell datasets from Segerstolpe et al. used in this study is available in the ArrayExpress database under the accession code E-MTAB-5061 [<xref ref-type="bibr" rid="CR82">82</xref>], with the corresponding bulk datasets accessible using E-MTAB-5060 [<xref ref-type="bibr" rid="CR83">83</xref>]. The Human and Mouse pancreatic islet datasets from Baron et al. used in this study are available in the GEO database under the accession code GSE84133 [<xref ref-type="bibr" rid="CR84">84</xref>]. The cancerous pancreatic tissue dataset is available in the Genome Sequence Archive database under the accession code CRA001160 [<xref ref-type="bibr" rid="CR85">85</xref>]. The normal breast tissue dataset is available in the GEO database under the accession code GSE113197 [<xref ref-type="bibr" rid="CR86">86</xref>]. The cancerous breast tissue dataset is available in the GEO database under the accession code GSE176078 [<xref ref-type="bibr" rid="CR87">87</xref>]. scRNA-seq dataset for PBMC is available from the Single Cell Portal as PBMC2 or at GSE132044 [<xref ref-type="bibr" rid="CR88">88</xref>], and the dataset for human blood cells at GSE149938 [<xref ref-type="bibr" rid="CR89">89</xref>]. Post-mortem brain frontal cortex from adult human is available under the accession code GSE97930 [<xref ref-type="bibr" rid="CR90">90</xref>]. The RA synovium dataset is available in the ImmPort database under the accession code SDY998 [<xref ref-type="bibr" rid="CR91">91</xref>]. The bulk RNA-seq dataset for normal and type 2 diabetes patients is available in the GEO database under the accession code GSE50244 [<xref ref-type="bibr" rid="CR92">92</xref>]. The bulk RNA-seq datasets for pancreatic cancer (PAAD) and breast cancer (BRCA) datasets from TCGA can be downloaded from the GDC data portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</ext-link>). Bulk RNA-seq datasets for PBMC can be accessed using the accession code GSE107011 [<xref ref-type="bibr" rid="CR93">93</xref>] from GEO database, and SDY67 [<xref ref-type="bibr" rid="CR94">94</xref>] from Immport database. The bulk dataset for purified immune cells can be accessed using the GEO identifier GSE64655 [<xref ref-type="bibr" rid="CR95">95</xref>].</p>
    <p>GTM-decon source codes have been deposited at the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/li-lab-mcgill/gtm-decon">https://github.com/li-lab-mcgill/gtm-decon</ext-link>) [<xref ref-type="bibr" rid="CR96">96</xref>]. The repository is licensed under the open-source GPL-3.0. The source code was also deposited at Zenodo: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8200316">https://doi.org/10.5281/zenodo.8200316</ext-link> [<xref ref-type="bibr" rid="CR97">97</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par78">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par79">Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par80">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J-W</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>J-A</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>K-H</given-names>
          </name>
        </person-group>
        <article-title>β-cell mass in people with type 2 diabetes</article-title>
        <source>J Diab Investig</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>6</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1111/j.2040-1124.2010.00072.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sasaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saisho</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Inaishi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tsuchiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Makio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nishikawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kitago</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Reduced beta cell number rather than size is a major contributor to beta cell loss in type 2 diabetes</article-title>
        <source>Diabetologia</source>
        <year>2021</year>
        <volume>64</volume>
        <fpage>1816</fpage>
        <lpage>1821</lpage>
        <pub-id pub-id-type="doi">10.1007/s00125-021-05467-7</pub-id>
        <?supplied-pmid 33938968?>
        <pub-id pub-id-type="pmid">33938968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Galen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hovestadt</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wadsworth Ii</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Griffin</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Battaglia</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Verga</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Stephansky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pastika</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lombardi Story</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq reveals AML hierarchies relevant to disease progression and immunity</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <fpage>1265</fpage>
        <lpage>1281.e1224</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.01.031</pub-id>
        <?supplied-pmid 30827681?>
        <pub-id pub-id-type="pmid">30827681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-Seq technologies and related computational data analysis</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>317</fpage>
        <lpage>317</lpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00317</pub-id>
        <?supplied-pmid 31024627?>
        <pub-id pub-id-type="pmid">31024627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Lönnberg</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title>
        <source>Genome medicine</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>75</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-017-0467-4</pub-id>
        <?supplied-pmid 28821273?>
        <pub-id pub-id-type="pmid">28821273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bang</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>
        <source>Exp Mol Med</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/s12276-018-0071-8</pub-id>
        <?supplied-pmid 30416196?>
        <pub-id pub-id-type="pmid">30416196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Berge</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hembach</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tiberi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>RNA sequencing data: Hitchhiker's guide to expression analysis</article-title>
        <source>Ann Rev Biomed Data Sci</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>139</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biodatasci-072018-021255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barkley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>França</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Yanai</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Cancer cell states and emergent properties of the dynamic tumor system</article-title>
        <source>Genome Res</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>1719</fpage>
        <lpage>1727</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.275308.121</pub-id>
        <?supplied-pmid 34599005?>
        <pub-id pub-id-type="pmid">34599005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis-Marcisak</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Deshpande</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein-O'Brien</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Laheru</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Fertig</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Kagohara</surname>
            <given-names>LT</given-names>
          </name>
        </person-group>
        <article-title>From bench to bedside: single-cell analysis for cancer immunotherapy</article-title>
        <source>Cancer Cell</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1062</fpage>
        <lpage>1080</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2021.07.004</pub-id>
        <?supplied-pmid 34329587?>
        <pub-id pub-id-type="pmid">34329587</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Madrigal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gomez-Cabrero</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cervera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Szcześniak</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Gaffney</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Elo</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A survey of best practices for RNA-seq data analysis</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>13</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0881-8</pub-id>
        <?supplied-pmid 26813401?>
        <pub-id pub-id-type="pmid">26813401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clough</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The Gene Expression Omnibus Database</article-title>
        <source>Methods Mol Biol (Clifton, NJ)</source>
        <year>2016</year>
        <volume>1418</volume>
        <fpage>93</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-4939-3578-9_5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Domrachev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lash</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title>
        <source>Nucleic Acids Res</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>207</fpage>
        <lpage>210</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/30.1.207</pub-id>
        <?supplied-pmid 11752295?>
        <pub-id pub-id-type="pmid">11752295</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Consortium GT</collab>
        </person-group>
        <article-title>The Genotype-Tissue Expression (GTEx) project</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>580</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id>
        <pub-id pub-id-type="pmid">23715323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hinoue</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Lazar</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Drill</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Cherniack</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Thorsson</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-of-origin patterns dominate the molecular classification of 10,000 tumors from 33 types of cancer</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>291</fpage>
        <lpage>304.e296</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.022</pub-id>
        <?supplied-pmid 29625048?>
        <pub-id pub-id-type="pmid">29625048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Computational deconvolution: extracting cell type-specific information from heterogeneous samples</article-title>
        <source>Curr Opin Immunol</source>
        <year>2013</year>
        <volume>25</volume>
        <fpage>571</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coi.2013.09.015</pub-id>
        <?supplied-pmid 24148234?>
        <pub-id pub-id-type="pmid">24148234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Diehn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vetere</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360.e344</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Steen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chaudhuri</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Khodadoust</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Esfahani</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Luca</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>773</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0114-2</pub-id>
        <?supplied-pmid 31061481?>
        <pub-id pub-id-type="pmid">31061481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>380</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08023-x</pub-id>
        <?supplied-pmid 30670690?>
        <pub-id pub-id-type="pmid">30670690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Racle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gfeller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>EPIC: a tool to estimate the proportions of different cell types from bulk gene expression data</article-title>
        <source>Methods Mol Biol (Clifton, NJ)</source>
        <year>2020</year>
        <volume>2120</volume>
        <fpage>233</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-0716-0327-7_17</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jew</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rahmani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garske</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Sul</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Pietiläinen</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Pajukanta</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Accurate estimation of cell composition in bulk expression through robust integration of single-cell information</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1971</fpage>
        <lpage>1971</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15816-6</pub-id>
        <?supplied-pmid 32332754?>
        <pub-id pub-id-type="pmid">32332754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Pe’er D, Danko CG: Cell type and gene expression deconvolution with BayesPrism enables Bayesian integrative analysis across bulk and single-cell RNA sequencing in oncology</article-title>
        <source>Nature Cancer</source>
        <year>2022</year>
        <volume>3</volume>
        <fpage>505</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-022-00356-3</pub-id>
        <?supplied-pmid 35469013?>
        <pub-id pub-id-type="pmid">35469013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roeder</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bayesian estimation of cell type-specific gene expression with prior derived from single-cell data</article-title>
        <source>Genome Res</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>268722.268120</fpage>
        <pub-id pub-id-type="doi">10.1101/gr.268722.120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TOAST: improving reference-free cell composition estimation by cross-cell type differential analysis</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
        </person-group>
        <article-title>Latent dirichlet allocation</article-title>
        <source>J Mach Learn Res</source>
        <year>2003</year>
        <volume>3</volume>
        <fpage>993</fpage>
        <lpage>1022</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teh</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <source>Hierarchical dirichlet processes</source>
        <year>2006</year>
        <volume>101</volume>
        <fpage>1566</fpage>
        <lpage>1581</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geering</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stoeckle</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Conus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>H-U</given-names>
          </name>
        </person-group>
        <article-title>Living and dying for inflammation: neutrophils, eosinophils, basophils</article-title>
        <source>Trends Immunol</source>
        <year>2013</year>
        <volume>34</volume>
        <fpage>398</fpage>
        <lpage>409</lpage>
        <pub-id pub-id-type="doi">10.1016/j.it.2013.04.002</pub-id>
        <?supplied-pmid 23665135?>
        <pub-id pub-id-type="pmid">23665135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Paisley</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Stochastic variational inference</article-title>
        <source>J Mach Learn Res</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>1303</fpage>
        <lpage>1347</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>E-M</given-names>
          </name>
          <name>
            <surname>Andréasson</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell Marker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky900</pub-id>
        <?supplied-pmid 30289549?>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Franzén O, Gan LM, Björkegren JL. PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data. Database. 2019;2019:baz046.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fadista</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vikman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Laakso</surname>
            <given-names>EO</given-names>
          </name>
          <name>
            <surname>Mollet</surname>
            <given-names>IG</given-names>
          </name>
          <name>
            <surname>Esguerra</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Taneera</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Storm</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Osmark</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ladenvall</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>RB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global genomic and transcriptomic analysis of human pancreatic islets reveals novel genes influencing glucose metabolism</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>13924</fpage>
        <lpage>13929</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1402665111</pub-id>
        <?supplied-pmid 25201977?>
        <pub-id pub-id-type="pmid">25201977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alvarez-Jarreta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Armean Irina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Austine-Orimoloye</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Azov Andrey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2022</article-title>
        <source>Nucleic Acids Res</source>
        <year>2022</year>
        <volume>50</volume>
        <fpage>D988</fpage>
        <lpage>D995</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab1049</pub-id>
        <?supplied-pmid 34791404?>
        <pub-id pub-id-type="pmid">34791404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>The tumor microenvironment</article-title>
        <source>Curr Biol CB</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>R921</fpage>
        <lpage>R925</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2020.06.081</pub-id>
        <?supplied-pmid 32810447?>
        <pub-id pub-id-type="pmid">32810447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lei</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J-K</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>W-X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R-G</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>H-B</given-names>
          </name>
        </person-group>
        <article-title>Immune cells within the tumor microenvironment: biological functions and roles in cancer immunotherapy</article-title>
        <source>Cancer Lett</source>
        <year>2020</year>
        <volume>470</volume>
        <fpage>126</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1016/j.canlet.2019.11.009</pub-id>
        <?supplied-pmid 31730903?>
        <pub-id pub-id-type="pmid">31730903</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>B-F</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J-Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>G-S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intra-tumoral heterogeneity and malignant progression in pancreatic ductal adenocarcinoma</article-title>
        <source>Cell Res</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>725</fpage>
        <lpage>738</lpage>
        <pub-id pub-id-type="doi">10.1038/s41422-019-0195-y</pub-id>
        <?supplied-pmid 31273297?>
        <pub-id pub-id-type="pmid">31273297</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Xu Y, Liu J, Nipper M, Wang P. Ductal vs. acinar? Recent insights into identifying cell lineage of pancreatic ductal adenocarcinoma. Ann Pancreat Cancer. 2019;2:11. 10.21037/apc.2019.06.03.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peran</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Madhavan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Byers</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>McCoy</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Curation of the pancreatic ductal adenocarcinoma subset of the cancer genome atlas is essential for accurate conclusions about survival-related molecular mechanisms</article-title>
        <source>Clin Cancer Res</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>3813</fpage>
        <lpage>3819</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-18-0290</pub-id>
        <?supplied-pmid 29739787?>
        <pub-id pub-id-type="pmid">29739787</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Domenico</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pipinikas</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Maire</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Bräutigam</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Simillion</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dettmer</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Vassella</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Thirlwell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Perren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marinoni</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Epigenetic landscape of pancreatic neuroendocrine tumours reveals distinct cells of origin and means of tumour progression</article-title>
        <source>Commun Biol</source>
        <year>2020</year>
        <volume>3</volume>
        <fpage>740</fpage>
        <lpage>740</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-020-01479-y</pub-id>
        <?supplied-pmid 33288854?>
        <pub-id pub-id-type="pmid">33288854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whittle</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Hingorani</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Fibroblasts in pancreatic ductal adenocarcinoma: biological mechanisms and therapeutic targets</article-title>
        <source>Gastroenterology</source>
        <year>2019</year>
        <volume>156</volume>
        <fpage>2085</fpage>
        <lpage>2096</lpage>
        <pub-id pub-id-type="doi">10.1053/j.gastro.2018.12.044</pub-id>
        <?supplied-pmid 30721663?>
        <pub-id pub-id-type="pmid">30721663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Garcia PE, Scales MK, Allen BL, Pasca di Magliano M. Pancreatic Fibroblast Heterogeneity: From Development to Cancer. Cells. 2020;9(11):2464. 10.3390/cells9112464.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Alkasalias T, Moyano-Galceran L, Arsenian-Henriksson M, Lehti K. Fibroblasts in the Tumor Microenvironment: Shield or Spear? Int J Mol Sci. 2018;19(5):1532. 10.3390/ijms19051532.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Starzyńska T, Karczmarski J, Paziewska A, Kulecka M, Kuśnierz K, Żeber-Lubecka N, Ambrożkiewicz F, Mikula M, Kos-Kudła B, Ostrowski J. Differences between Well-Differentiated Neuroendocrine Tumors and Ductal Adenocarcinomas of the Pancreas Assessed by Multi-Omics Profiling. Int J Mol Sci. 2020;21(12):4470. 10.3390/ijms21124470.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>SZ</given-names>
          </name>
          <name>
            <surname>Al-Eryani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Roden</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Junankar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harvey</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thennavan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Torpy</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bartonicek</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell and spatially resolved atlas of human breast cancers</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>1334</fpage>
        <lpage>1347</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00911-1</pub-id>
        <?supplied-pmid 34493872?>
        <pub-id pub-id-type="pmid">34493872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertucci</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Finetti</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Birnbaum</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Basal breast cancer: a complex and deadly molecular subtype</article-title>
        <source>Curr Mol Med</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>96</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.2174/156652412798376134</pub-id>
        <?supplied-pmid 22082486?>
        <pub-id pub-id-type="pmid">22082486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Phung</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Willey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jabart</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2028</fpage>
        <lpage>2028</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04334-1</pub-id>
        <?supplied-pmid 29795293?>
        <pub-id pub-id-type="pmid">29795293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Breast cancer cell line classification and its relevance with breast tumor subtyping</article-title>
        <source>J Cancer</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>3131</fpage>
        <lpage>3141</lpage>
        <pub-id pub-id-type="doi">10.7150/jca.18457</pub-id>
        <?supplied-pmid 29158785?>
        <pub-id pub-id-type="pmid">29158785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential analysis of count data–the DESeq2 package</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>10</fpage>
        <lpage>1186</lpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Construction of a human cell landscape at single-cell level</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>581</volume>
        <fpage>303</fpage>
        <lpage>309</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2157-4</pub-id>
        <?supplied-pmid 32214235?>
        <pub-id pub-id-type="pmid">32214235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Consortium* TS, Jones RC, Karkanias J, Krasnow MA, Pisco AO, Quake SR, Salzman J, Yosef N, Bulthaup B, Brown P, et al: The Tabula Sapiens: a multiple-organ, single-cell transcriptomic atlas of humans. Science. 2022;376:eabl4896.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>CeDAR: incorporating cell type hierarchy improves cell type-specific differential analyses in bulk omics data</article-title>
        <source>Genome Biol</source>
        <year>2023</year>
        <volume>24</volume>
        <fpage>37</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-023-02857-5</pub-id>
        <?supplied-pmid 36855165?>
        <pub-id pub-id-type="pmid">36855165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Wilk</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Darby</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zager</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3573</fpage>
        <lpage>3587</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efremova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for single-cell omics across modalities</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>14</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0692-4</pub-id>
        <?supplied-pmid 31907463?>
        <pub-id pub-id-type="pmid">31907463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Mann-Krzisnik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Single-cell multi-omic topic embedding reveals cell-type-specific and COVID-19 severity-related immune signatures</article-title>
        <source>bioRxiv</source>
        <year>2023</year>
        <volume>2023.2001.2031</volume>
        <fpage>526312</fpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Argelaguet</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cuomo</surname>
            <given-names>ASE</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Computational principles and challenges in single-cell data integration</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1202</fpage>
        <lpage>1215</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00895-7</pub-id>
        <?supplied-pmid 33941931?>
        <pub-id pub-id-type="pmid">33941931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Learning interpretable cellular and gene signature embeddings from single-cell transcriptomic data</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>5261</fpage>
        <lpage>5261</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25534-2</pub-id>
        <?supplied-pmid 34489404?>
        <pub-id pub-id-type="pmid">34489404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Quon</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>siVAE: interpretable deep generative models for single-cell transcriptomes</article-title>
        <source>Genome Biol</source>
        <year>2023</year>
        <volume>24</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-023-02850-y</pub-id>
        <?supplied-pmid 36803416?>
        <pub-id pub-id-type="pmid">36803416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahuja</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Verma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buckeridge</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>MixEHR-Guided: a guided multi-modal topic modeling approach for large-scale automatic phenotyping using the electronic health record</article-title>
        <source>J Biomed Inform</source>
        <year>2022</year>
        <volume>134</volume>
        <fpage>104190</fpage>
        <lpage>104190</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2022.104190</pub-id>
        <?supplied-pmid 36058522?>
        <pub-id pub-id-type="pmid">36058522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Li Y, Nair P, Lu XH, Wen Z, Wang Y, Dehaghi AA, et al. Inferring multimodal latent topics from electronic health records. Nat Commun. 2020;11(1):2536. 10.1038/s41467-020-16378-3.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahuja</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Castro</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Gainer</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>sureLDA: A multidisease automated phenotyping method for the electronic health record</article-title>
        <source>J Am Med Inform Assoc</source>
        <year>2020</year>
        <volume>27</volume>
        <fpage>1235</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="doi">10.1093/jamia/ocaa079</pub-id>
        <?supplied-pmid 32548637?>
        <pub-id pub-id-type="pmid">32548637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Steyvers</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Finding scientific topics</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>Suppl 1</issue>
        <fpage>5228</fpage>
        <lpage>5235</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0307752101</pub-id>
        <?supplied-pmid 14872004?>
        <pub-id pub-id-type="pmid">14872004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Teh YW, Newman D, Welling M. A collapsed variational Bayesian inference algorithm for latent Dirichlet allocation. Advances in neural…2006.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Minka</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Estimating a Dirichlet distribution. Technical report, MIT</source>
        <year>2000</year>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <?supplied-pmid 29409532?>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Publ Group</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liberzon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Birger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection</article-title>
        <source>Cell Syst</source>
        <year>2015</year>
        <volume>1</volume>
        <fpage>417</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id>
        <?supplied-pmid 26771021?>
        <pub-id pub-id-type="pmid">26771021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <mixed-citation publication-type="other">Pedregosa F, Varoquaux G, Gramfort A, Michel V, Thirion B, Grisel O, Blondel M, Prettenhofer P, Weiss R, Dubourg V, Vanderplas J. Scikit-learn: Machine learning in Python. J Mach Learn Res. 2011;12:2825–30.</mixed-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>QY</given-names>
          </name>
        </person-group>
        <article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>
        <source>OMICS</source>
        <year>2012</year>
        <volume>16</volume>
        <fpage>284</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id>
        <?supplied-pmid 22455463?>
        <pub-id pub-id-type="pmid">22455463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Hession</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Marjanovic</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Wadsworth</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Burks</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>LT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>737</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0465-8</pub-id>
        <?supplied-pmid 32341560?>
        <pub-id pub-id-type="pmid">32341560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Huo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic landscape of human blood cells</article-title>
        <source>Natl Sci Rev</source>
        <year>2021</year>
        <volume>8</volume>
        <fpage>nwaa180</fpage>
        <pub-id pub-id-type="doi">10.1093/nsr/nwaa180</pub-id>
        <?supplied-pmid 34691592?>
        <pub-id pub-id-type="pmid">34691592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lake</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Ai</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kaeser</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Salathia</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wildberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neuronal subtypes and diversity revealed by single-nucleus RNA sequencing of the human brain</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>1586</fpage>
        <lpage>1590</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf1204</pub-id>
        <?supplied-pmid 27339989?>
        <pub-id pub-id-type="pmid">27339989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Phung</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Willey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jabart</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2028</year>
        <volume>2018</volume>
        <fpage>9</fpage>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Profiling cell type abundance and expression in bulk tissues with CIBERSORTx</article-title>
        <source>Methods Mol Biol</source>
        <year>2020</year>
        <volume>2117</volume>
        <fpage>135</fpage>
        <lpage>157</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-0716-0301-7_7</pub-id>
        <?supplied-pmid 31960376?>
        <pub-id pub-id-type="pmid">31960376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monaco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mustafah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Carre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Burdin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Visan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ceccarelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poidinger</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq signatures normalized by mRNA abundance allow absolute deconvolution of human immune cell types</article-title>
        <source>Cell Rep</source>
        <year>2019</year>
        <volume>26</volume>
        <issue>1627–1640</issue>
        <fpage>e1627</fpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.01.041</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmermann</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Grill</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Oberg</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Goergen</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Ovsyannikova</surname>
            <given-names>IG</given-names>
          </name>
          <name>
            <surname>Haralambieva</surname>
            <given-names>IH</given-names>
          </name>
          <name>
            <surname>Poland</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Integration of immune cell populations, mRNA-Seq, and CpG methylation to better predict humoral immunity to influenza vaccination: dependence of mRNA-Seq/CpG methylation on immune cell populations</article-title>
        <source>Front Immunol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>445</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2017.00445</pub-id>
        <?supplied-pmid 28484452?>
        <pub-id pub-id-type="pmid">28484452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoek</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Samir</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Howard</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Galassie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Allos</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Floyd</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A cell-based systems biology assessment of human blood to monitor immune responses after influenza vaccination</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>e0118528</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0118528</pub-id>
        <?supplied-pmid 25706537?>
        <pub-id pub-id-type="pmid">25706537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patrick</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Taga</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ergun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Casazza</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cimpean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Gaiteri</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconvolving the contributions of cell-type heterogeneity on cortical gene expression</article-title>
        <source>PLoS Comput Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1008120</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008120</pub-id>
        <?supplied-pmid 32804935?>
        <pub-id pub-id-type="pmid">32804935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <mixed-citation publication-type="other">Schulze A, Oshi M, Endo I, Takabe K. MYC Targets Scores Are Associated with Cancer Aggressiveness and Poor Survival in ER-Positive Primary and Metastatic Breast Cancer. Int J Mol Sci. 2020;21(21):8127. 10.3390/ijms21218127.</mixed-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <mixed-citation publication-type="other">Oshi M, Takahashi H, Tokumaru Y, Yan L, Rashid OM, Nagahashi M, Matsuyama R, Endo I, Takabe K. The E2F Pathway Score as a Predictive Biomarker of Response to Neoadjuvant Therapy in ER+/HER2- Breast Cancer. Cells. 2020;9(7):1643. 10.3390/cells9071643.</mixed-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <mixed-citation publication-type="other">Oshi M, Takahashi H, Tokumaru Y, Yan L, Rashid OM, Matsuyama R, Endo I, Takabe K. G2M Cell Cycle Pathway Score as a Prognostic Biomarker of Metastasis in Estrogen Receptor (ER)-Positive Breast Cancer. Int J Mol Sci. 2020;21(8):2921. 10.3390/ijms21082921.</mixed-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <mixed-citation publication-type="other">Sandberg R, Palasantza A, Segerstolpe A. Single-cell RNA-seq analysis of human pancreas from healthy individuals and type 2 diabetes patients. ArrayExpress. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <mixed-citation publication-type="other">Palasantza A, Sandberg R, Clausen M. Whole-islet RNA-sequencing analysis of human pancreas from healthy individuals and type 2 diabetes patients. ArrayExpress. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E-MTAB-5060">https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E-MTAB-5060</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <mixed-citation publication-type="other">Veres A, Baron M. A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure. Gene Expression Omnibus. 2016. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE84133">https://identifiers.org/geo:GSE84133</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Ying Y: GSA-PDAC. Genome Sequence Archive. 2018. <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn/gsa/browse/CRA001160">https://ngdc.cncb.ac.cn/gsa/browse/CRA001160</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <mixed-citation publication-type="other">Kessenbrock K. Single cell RNA sequencing of adult human breast epithelial cells. . Gene Expression Omnibus. 2018. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE113197">https://identifiers.org/geo:GSE113197</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <mixed-citation publication-type="other">Swarbrick A, Wu S, Al-Eryani G, Roden D. A single-cell and spatially resolved atlas of human breast cancers. . Gene Expression Omnibus. 2021. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE176078">https://identifiers.org/geo:GSE176078</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <mixed-citation publication-type="other">Ding J, Adiconis X, Simmons S, Kowalczyk M, Hession C, Marjanovic N, Hughes T, Wadsworth M, Burks T, Nguyen L, et al. Systematic comparative analysis of single cell RNA-sequencing methods. Gene Expression Omnibus. 2019. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE132044">https://identifiers.org/geo:GSE132044</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <mixed-citation publication-type="other">Zhu P, Cheng T. Single-cell transcriptomic landscape of human blood cells. Gene Expression Omnibus. 2020. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE149938">https://identifiers.org/geo:GSE149938</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <mixed-citation publication-type="other">Lake B, Chen S, Sos B, Fan JB, Yung Y, Chun J, Kharchenko P, Zhang K. Integrative single-cell analysis of transcriptional and epigenetic states in the human adult brain. Gene Expression Omnibus. 2017. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE97930">https://identifiers.org/geo:GSE97930</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <mixed-citation publication-type="other">Anolik J, Bykerk V, Moreland L, Holers M, McGeachy M, Seifert J, Filer A, Pitzalis C, Gregersen P, Firestein G, et al. AMP Rheumatoid Arthritis Phase 1. Immport. 2018. 10.21430/M3KXJHSP4T.</mixed-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">Fadista J, Groop L. Global transcriptomic analysis of human pancreatic islets reveals novel genes influencing glucose metabolism. Gene Expression Omnibus. 2014. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE50244">https://identifiers.org/geo:GSE50244</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">Monaco G, Lee B, Xu W, Hwang Y, Poidinger M, Poidinger M, de Magalhães J, Larbi A. RNA-Seq profiling of 29 immune cell types and peripheral blood mononuclear cells. Gene Expression Omnibus. 2019. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE107011">https://identifiers.org/geo:GSE107011</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <mixed-citation publication-type="other">Poland G: Bioinformatics Approach to 2010–2011 TIV Influenza A/H1N1 Vaccine Immune Profiling. Immport. 2015. 10.21430/M3OYWCJHO1.</mixed-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <mixed-citation publication-type="other">Hoek K, Link A. A cell-based systems biology assessment of human blood to monitor immune responses after influenza vaccination. Gene Expression Omnibus. 2015. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE64655">https://identifiers.org/geo:GSE64655</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <mixed-citation publication-type="other">Swapna LS, Huang M, Li Y: GTM-decon: Guided Topic Modeling for Deconvolution of cell types from bulk RNA-seq data. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/li-lab-mcgill/gtm-decon">https://github.com/li-lab-mcgill/gtm-decon</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <mixed-citation publication-type="other">Swapna LS, Huang M, Li Y. Source package and associated scripts for GTM-decon: guided-topic modelling of single-cell transcriptomes enables sub-cell-type and disease-subtype deconvolution of bulk transcriptomes. 2023. Zenodo. 10.5281/zenodo.8200316.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10436670</article-id>
    <article-id pub-id-type="pmid">37596691</article-id>
    <article-id pub-id-type="publisher-id">3034</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-03034-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GTM-decon: guided-topic modeling of single-cell transcriptomes enables sub-cell-type and disease-subtype deconvolution of bulk transcriptomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Swapna</surname>
          <given-names>Lakshmipuram Seshadri</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3844-4865</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Yue</given-names>
        </name>
        <address>
          <email>yueli@cs.mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01pxwe438</institution-id><institution-id institution-id-type="GRID">grid.14709.3b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8649</institution-id><institution>School of Computer Science, </institution><institution>McGill University, </institution></institution-wrap>Montreal, QC Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>190</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Cell-type composition is an important indicator of health. We present Guided Topic Model for deconvolution (GTM-decon) to automatically infer cell-type-specific gene topic distributions from single-cell RNA-seq data for deconvolving bulk transcriptomes. GTM-decon performs competitively on deconvolving simulated and real bulk data compared with the state-of-the-art methods. Moreover, as demonstrated in deconvolving disease transcriptomes, GTM-decon can infer multiple cell-type-specific gene topic distributions per cell type, which captures sub-cell-type variations. GTM-decon can also use phenotype labels from single-cell or bulk data to infer phenotype-specific gene distributions. In a nested-guided design, GTM-decon identified cell-type-specific differentially expressed genes from bulk breast cancer transcriptomes.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-03034-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Cell-type deconvolution</kwd>
      <kwd>Single-cell transcriptome</kwd>
      <kwd>Topic models</kwd>
      <kwd>Variational inference</kwd>
      <kwd>Bayesian modeling</kwd>
      <kwd>Type 2 diabetes</kwd>
      <kwd>Cancer transcriptome</kwd>
      <kwd>Disease biomarkers</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NFRFE-2019-00980</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Yue</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001804</institution-id>
            <institution>Canada Research Chairs</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CRC-2021-00547</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Yue</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Cell-type composition and its relative proportions in a tissue is an indicator of health. For example, several studies have shown that type 2 diabetes is characterized by reduced beta cell mass and number in pancreatic tissue [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. In acute myeloid leukemia (AML), cell-type abundance variation between patients was indicative of degree of malignancy [<xref ref-type="bibr" rid="CR3">3</xref>]. Experimental approaches such as fluorescence-activated cell sorting (FACS) and immunohistochemistry (IHC) are used to elucidate cell-type composition of biological samples. Single-cell RNA-sequencing (scRNA-seq) technology enables high-resolution cell-type-specific (CTS) transcriptome analysis, providing molecular insights into the cell-type composition, cell-state behavior, and cell-type heterogeneity [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. In the context of cancer research, scRNA-seq has led to identification of distinct cancer cell states. These are shown to occur across a range of cancer types and are implicated in tumor progression, with high cell-type heterogeneity associated with poor prognostic outcomes [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. However, challenges such as high cost, lower throughput, and difficulties in dissociation of cell types in solid samples make it hard to apply these experimental approaches at the patient population scale.</p>
    <p id="Par3">On the other hand, bulk RNA-seq has been the workhorse behind transcriptome research over the past decades. Its falling costs and ease of experimental setup make it an attractive tool to work with any organism [<xref ref-type="bibr" rid="CR10">10</xref>]. Several databases host tremendous amounts of bulk RNA-seq data such as Gene Expression Omnibus (GEO) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], Genotype-Tissue Expression (GTEx) [<xref ref-type="bibr" rid="CR13">13</xref>], and The Cancer Genome Atlas (TCGA), a repository of bulk RNA-seq data for more than 11,000 primary cancer samples [<xref ref-type="bibr" rid="CR14">14</xref>]. However, bulk RNA-seq data are mixture of gene expression profiles in the tissue. Computational approaches have been developed to deconvolve these bulk RNA-seq profiles into their constituent cell types in the form of cell-type proportions, since these are substantially cheaper and easier to obtain than conducting scRNA-seq experiments. Moreover, deconvolving the bulk data into constituent cell-type components can not only yield the cell-type proportions facilitating clinical investigation but also enable high-resolution differential analysis of gene expression. Studying the differentially expressed genes at the cell-type or cell-state level can help uncover gene regulatory programs that drive different tissue states. Many deconvolution methods were developed to this end.</p>
    <p id="Par4">Most of the deconvolution approaches require a set of gene markers for each cell type of interest. These marker genes are derived from expert knowledge or differential expression analysis of purified samples of specific cell types. Early methods that leverage these marker genes could achieve good performance in deconvolving mixtures with highly distinct cell types such as blood [<xref ref-type="bibr" rid="CR15">15</xref>]. CIBERSORT improved on these approaches by incorporating a feature selection step, where genes are adaptively selected from the signature matrix based on the input bulk RNA-seq data [<xref ref-type="bibr" rid="CR16">16</xref>]. It uses a linear support vector regression (SVR) to delineate closely related cell types such as leukocytes. BSEQ-sc combined with CIBERSORT was an early method that used scRNA-seq data as a reference for bulk deconvolution [<xref ref-type="bibr" rid="CR17">17</xref>]. CIBERSORTx also uses scRNA-seq as reference profiles, along with improved normalization schemes to suppress cross-platform variation, and an adaptive noise filter to eliminate unreliably estimated genes [<xref ref-type="bibr" rid="CR18">18</xref>]. MuSiC adopts a weighted non-negative least-squares regression approach and addresses the issue of cross-subject heterogeneity as well as within-cell-type variation of gene expression [<xref ref-type="bibr" rid="CR19">19</xref>]. EPIC accommodates user-defined reference profiles to account for the presence of uncharacterized cell types in the target bulk samples [<xref ref-type="bibr" rid="CR20">20</xref>]. Bisque learns gene-specific transformations of the bulk data based on the single-cell reference profiles and the corresponding cell proportions to account for their differences [<xref ref-type="bibr" rid="CR21">21</xref>]. BayesPrism uses Bayesian inference to model scRNA-seq data jointly with bulk RNA-seq data to infer cell-type composition and their proportions [<xref ref-type="bibr" rid="CR22">22</xref>]. The joint modeling overcomes biases that may arise due to technical and biological differences. Beyond cell-type deconvolution, some recently developed methods can estimate CTS gene expression from the bulk samples [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. However, these methods rely on an external cell-type deconvolution method like those aforementioned ones and do not utilize or model the distribution of the scRNA-seq reference data to properly express statistical uncertainty while leveraging their information richness.</p>
    <p id="Par5">In this study, we present a guided topic model for cell-type deconvolution (GTM-decon). As an overview of our analysis, we first benchmark GTM-decon on deconvolving simulated and real bulk data in comparison with the state-of-the-art deconvolution methods. We then train GTM-decon on pancreatic and breast scRNA-seq datasets to deconvolve bulk RNA-seq datasets from pancreatic and breast tissues, respectively. When applied to deconvolving cancer bulk transcriptomes, GTM-decon successfully identifies the cell type of origin for pancreatic and breast cancer datasets. Interestingly, the results for human pancreatic cancer are recapitulated using the CTS topics inferred from the mouse pancreas scRNA-seq data, postulating cross-species deconvolution as an option where it is difficult to obtain scRNA-seq data due to technical or ethical challenges. Furthermore, our GTM framework also enables the inference of phenotype-specific topic distributions from bulk RNA-seq data by using the phenotypes (e.g., breast cancer subtypes) from single cell or bulk RNA-seq data as a guide for the topic inference. We leverage this capability to distinguish basal from estrogen receptor (ER) positive (ER +) breast tumor samples, not only achieving high classification accuracy but also identifying the genes and pathways that segregate the cancer subtypes. By fine-tuning the inferred CTS topic distributions guided by the breast cancer subtypes, we deconvolve the average differential gene expression into CTS expression changes, thereby enabling discovery of the subtype-specific aberrance of the gene regulatory programs.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>GTM-decon model overview</title>
      <p id="Par6">In GTM-decon, we have made <italic>three methodological contributions</italic>. As our <italic>first and the main contribution</italic>, GTM-decon is a marker-free method and automatically infers the contribution of each gene for each cell type in the form of CTS categorical distributions, which we define as “topics” [<xref ref-type="bibr" rid="CR25">25</xref>], without using marker gene information. Each CTS topic distribution is related to the transcriptional rate of each gene for each cell type. For instance, B cells have higher transcription rate for <italic>CD19</italic> compared to alpha cells, which have relatively high rate for <italic>FXYD5</italic>. Conceptually, we consider genes as vocabulary and cells as documents whose word tokens (i.e., scRNA-seq reads) are sampled from the vocabulary with the CTS topic probabilities. We incorporate the observed cell-type labels for each cell in the form of topic prior to guide the inference of CTS topic mixture, which reflects the uncertainty of the noisy cell-type label. Specifically, the cell-type mixture for cell <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M2"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq1.gif"/></alternatives></inline-formula> follows a K-dimensional asymmetric Dirichlet distribution, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}\sim Dir\left({{\varvec{\upalpha}}}_{m}+0.1\right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq2.gif"/></alternatives></inline-formula>, with the hyperparameter <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq3.gif"/></alternatives></inline-formula> set to a relatively high value (i.e., 0.9 by default) given the cell-type label <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}=k$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq4.gif"/></alternatives></inline-formula>; the rest of the K-1 <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{\alpha }}_{m,{\mathrm{k}}{\prime}}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq5.gif"/></alternatives></inline-formula> values, where <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\ne {k}{\prime}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq6.gif"/></alternatives></inline-formula>, are set to a relatively low values (i.e., randomly sampled from a range between 0.1 and 0.01). As a result, each topic is automatically identified with exactly one cell type. This differs from the standard topic model, where topics are not directly associated with any known concept and require post hoc manual inspection based on their top scoring words to interpret them. Given the CTS gene distributions, we can infer the CTS topic mixtures from the bulk transcriptomes, which are the desired cell-type mixing proportion in the context of deconvolution (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a).<fig id="Fig1"><label>Fig. 1</label><caption><p>GTM-decon overview. <bold>a</bold> Inferring cell-type-specific (CTS) topics from scRNA-seq reference data. In brief, GTM-decon infers CTS topics from scRNA-seq data by using a guided topic modeling approach utilizing cell-type labels from the reference. High prior values are assigned to the topic corresponding to the cell type, and lower prior values are assigned to the other topics, enabling it to learn a genes-by-CTS topics matrix, with each topic anchored to a specific cell type. This matrix is used to infer cell-type proportions in bulk RNA-seq data using standard topic modeling, capturing variations in cell type proportions between healthy and diseased tissue. The probabilistic graphical model (PGM) diagram depicts the data generative process assumed by the proposed guided topic model. Suppose there are K cell types in the scRNA-seq data. For each cell indexed by <inline-formula id="IEq145"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m\in \{1,\dots ,M\}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq145.gif"/></alternatives></inline-formula>, we use K-dimensional Dirichlet-distributed cell-type topic mixture <inline-formula id="IEq146"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}\sim \mathrm{Dir}({{\varvec{\upalpha}}}_{m})$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq146.gif"/></alternatives></inline-formula> to represent the statistical uncertainty of the noisy cell-type label <inline-formula id="IEq147"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq147.gif"/></alternatives></inline-formula>. Specifically, we clamp the Dirichlet hyperparameter <inline-formula id="IEq148"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{y}_{m}}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq148.gif"/></alternatives></inline-formula> of the Dirichlet variable to a relatively high value while setting the rest of the values of <inline-formula id="IEq149"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq149.gif"/></alternatives></inline-formula> (<inline-formula id="IEq150"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\ne {k}{\prime}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq150.gif"/></alternatives></inline-formula>) to relatively low values (i.e., 0.9 and [0.01, 0.1], respectively in the cartoon illustration of <italic>M</italic> = 8 cells and <italic>K</italic> = 3 cell types). The non-zero prior values for the <italic>K</italic> – 1 unobserved cell types allow the cell-type mixture variable <inline-formula id="IEq151"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq151.gif"/></alternatives></inline-formula> to have non-zero density over those cell types as dictated by the scRNA-seq data likelihood and therefore account for potentially mislabeled cell types. Suppose there are in total <inline-formula id="IEq152"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{m}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq152.gif"/></alternatives></inline-formula> reads in cell <inline-formula id="IEq153"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M30"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq153.gif"/></alternatives></inline-formula>. Each scRNA-seq read <inline-formula id="IEq154"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \left\{1,\dots ,{N}_{m}\right\}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq154.gif"/></alternatives></inline-formula> is assumed to be originated from one of the K CTS topics with the categorical rates fixed to the cell-type mixture, i.e., <inline-formula id="IEq155"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m} \sim \mathrm{Cat}({{\varvec{\uptheta}}}_{m})$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq155.gif"/></alternatives></inline-formula>. Given cell-type topic assignment <inline-formula id="IEq156"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq156.gif"/></alternatives></inline-formula>, the <italic>i</italic>th read is then mapped to one of the G genes as indexed by <inline-formula id="IEq157"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq157.gif"/></alternatives></inline-formula> with categorical rates set to be <inline-formula id="IEq158"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\upphi}}{}_{{z}_{i,m}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:msub><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq158.gif"/></alternatives></inline-formula>, which itself is a G-dimensional Dirichlet variable of flat hyperparameter <inline-formula id="IEq159"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M42"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq159.gif"/></alternatives></inline-formula>, i.e., <inline-formula id="IEq160"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}\sim \mathrm{Cat}({{\varvec{\upphi}}}_{{z}_{i,m}})$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq160.gif"/></alternatives></inline-formula>. To infer the latent variables, namely cell-type mixture proportion <inline-formula id="IEq161"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}\sim \mathrm{Dir}(\mathrm{\alpha })$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq161.gif"/></alternatives></inline-formula>, CTS topic assignments for each read <inline-formula id="IEq162"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq162.gif"/></alternatives></inline-formula>, and CTS topic distributions <inline-formula id="IEq163"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\Phi}}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq163.gif"/></alternatives></inline-formula>, we employ an efficient collapsed variational Bayes algorithm as detailed in the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section. The genes-by-CTS-topic <inline-formula id="IEq164"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M52"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq164.gif"/></alternatives></inline-formula> matrix estimated from the scRNA-seq reference then serves as a template when it comes to infer the cell-type mixing proportions <inline-formula id="IEq165"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uptheta }_{j}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq165.gif"/></alternatives></inline-formula> of a bulk RNA-seq sample <italic>j</italic> using essentially the same inference algorithm as in the scRNA-seq data modeling except for having a flat hyperparameter for the prior (e.g., <inline-formula id="IEq166"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{k}=1\forall k$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∀</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq166.gif"/></alternatives></inline-formula> by default) while fixing <inline-formula id="IEq167"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M58"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq167.gif"/></alternatives></inline-formula> and only inferring the expected total reads allocated for each CTS topics (i.e., <inline-formula id="IEq168"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{E}_{q}[n}_{.,j,k}]={E}_{q}[{\sum }_{i}[{z}_{i,j}=k]$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo></mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq168.gif"/></alternatives></inline-formula>]). <bold>b</bold> Phenotype-guided modeling of bulk RNA-seq data. GTM-decon can also use phenotype labels as a guide for topic inference to model sparsified bulk transcriptomes in a disease study. In this design, instead of having each row as a cell and each column as a cell type, each row corresponds to a bulk sample and each column to a phenotype class. For each subject <italic>j</italic>, we set the topic hyperparameter <inline-formula id="IEq169"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{j,{y}_{j}}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq169.gif"/></alternatives></inline-formula> based on the noisy phenotype label <inline-formula id="IEq170"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{j}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq170.gif"/></alternatives></inline-formula> of the subject. The inference algorithm is the same as in modeling the scRNA-seq reference data. Given a test subject <inline-formula id="IEq171"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j}{\prime}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq171.gif"/></alternatives></inline-formula>, the inferred topic mixture <inline-formula id="IEq172"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{{j}{\prime}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq172.gif"/></alternatives></inline-formula> represents the phenotypic probabilities of the subject. <bold>c</bold> Nested-guided topic model for detecting cell-type-specific differentially expressed genes between phenotypes. In this nested design, we treat the phenotype as level 1 and the cell types as level 2. The pretrained genes-by-CTS-topic distribution <inline-formula id="IEq173"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M70"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq173.gif"/></alternatives></inline-formula> learned from panel <bold>a</bold> are used to initialize the topic distributions for each phenotype in a sparsified bulk transcriptome disease study. As illustrated in the cartoon, for example, for 2 phenotypes and 3 cell types, there are 6 topics. GTM-decon then fine-tunes the combined cell-type-specific topic distribution by running the same algorithm described in panel <bold>b</bold>. The resulting topic distributions reflect the phenotypic influences on CTS gene distributions, which are the statistics for conducting differential expression analysis in a case–control study design</p></caption><graphic xlink:href="13059_2023_3034_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">As our <italic>second contribution</italic>, we extend GTM-decon to infer multiple topics per cell type. The rationale is that cells of the same cell type can manifest in different cell states due to the changes of environments or stimuli. As a result, these cells may exhibit expression patterns that are different from the canonical CTS expression pattern. While there are sophisticated hierarchical topic models involving Dirichlet Processes [<xref ref-type="bibr" rid="CR26">26</xref>], we took a simple and elegant design. Specifically, we extend the basic GTM-decon model to infer sub-cell-type topics by dedicating multiple topics per cell type (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). As our <italic>third contribution</italic>, we extend GTM-decon to infer phenotype-specific (PTS) topic distributions using the phenotype label (e.g., cancer subtypes or cancer stages) available in the single-cell or bulk transcriptome data as a guide to detect PTS gene expression (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). We then further extend it to a nested-guided topic model to conduct CTS differential expression analysis in the single-cell or bulk patient cohort data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). To that end, we use the phenotype labels as the level-1 guide and the cell-type labels as the level 2 guide. Through the same guided topic mechanism, GTM-decon updates the CTS topic distributions under each phenotype by fitting the data likelihood of the transcriptomes from either the single-cell or bulk data. The algorithmic details for the 3 contributions were described in “<xref rid="Sec8" ref-type="sec">Methods</xref>.”</p>
    </sec>
    <sec id="Sec4">
      <title>Experimentation of data preprocessing and GTM-decon model configurations</title>
      <p id="Par8">We experimented gene selection, data normalization, hyperparameter settings, and number of topics per cell type. We find that GTM-decon works the best with raw read count data using all genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S2 and S3), and it is fairly robust to different hyperparameter values for the topic mixture prior (Figs. S<xref rid="MOESM1" ref-type="media">4</xref>-S<xref rid="MOESM1" ref-type="media">6</xref>) and the CTS topic prior values (Fig. S<xref rid="MOESM1" ref-type="media">7</xref>). In general, GTM-decon confers better deconvolution performance using multiple topics per cell type than the baseline GTM-decon with one topic per cell type (Fig. S<xref rid="MOESM1" ref-type="media">8</xref>). Please refer to Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S1-S5 for more details.</p>
    </sec>
    <sec id="Sec5">
      <title>Evaluation of deconvolution of simulated bulk from scRNA-seq data</title>
      <p id="Par9">To quantitatively benchmark GTM-decon, we compared it against five existing deconvolution methods, namely Bisque [<xref ref-type="bibr" rid="CR21">21</xref>], Bseq-sc [<xref ref-type="bibr" rid="CR17">17</xref>], CIBERSORTx [<xref ref-type="bibr" rid="CR18">18</xref>], MuSiC [<xref ref-type="bibr" rid="CR19">19</xref>], and BayesPrism [<xref ref-type="bibr" rid="CR22">22</xref>] on artificially simulated bulk RNA-seq datasets from the scRNA-seq data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). To simulate bulk data, three human scRNA-seq datasets (Pancreas—E-MTAB-5061, Breast Tissue with GEO accession number GSE113197, and Rheumatoid Arthritis (RA) Synovium—SDY998), generated using different technologies (Smart-seq2, 10 × Genomics Chromium, CEL-Seq2) were used. The artificial bulk data for each individual was constructed by summing up the counts for each gene from all cells in that individual [<xref ref-type="bibr" rid="CR19">19</xref>]. This allowed us to use the cell-type proportions from the single-cell data as the ground-truth proportions. Artificially constructed bulk data from scRNA-seq data appear to be a good surrogate of the real bulk data, as observed from the excellent correlation of the log-transformed artificial counts with the log-transformed counts from real bulk data for each gene (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). We performed leave-one-out cross-validation (LOOCV), to avoid any leakage from training data, and used the single-cell RNA-seq of the left-out individual to simulate the bulk RNA-seq (i.e., the total read counts of each gene for that sample) as the validation data and its cell-type proportions as the ground-truth mixing proportions. GTM-decon performs better than other models on the Pancreas and Breast Tissue datasets in terms of both Spearman Rank-based correlation (Spearman R) and Cross Entropy and conferred comparable performance on the RA Synovium dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). Notably, GTM-decon achieves smaller variance for both the pancreatic and breast tissue datasets. We further ascertained the qualities of the predicted cell-type proportions of each method against the ground-truth cell-type proportions (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>a) and observed that GTM-decon recapitulates cell-type proportions well for pancreatic (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>b), breast tissues (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>c), and RA synovium dataset (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>d).</p>
    </sec>
    <sec id="Sec6">
      <title>Evaluation of deconvolution of real bulk with ground-truth cell-type proportions</title>
      <p id="Par10">We also benchmarked GTM-decon on 5 real bulk RNA-seq data with known ground-truth cell-type proportions from 3 different tissue types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 and S2; “<xref rid="Sec8" ref-type="sec">Methods</xref>”). We evaluated deconvolution performance using Spearman R and Root Mean Square Error (RMSE), by comparing the inferred proportions for the matching cell types against the ground-truth proportions for each sample. GTM-decon conferred on-par or superior performance compared to the existing methods for all the datasets (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a left). In particular, GTM-ALL performed the best for deconvolving PBMC-1 and PBMC-2. For deconvolving whole blood (WB), GTM-HVG performed the best in terms of both metrics and MuSiC is a close second. While deconvolving bulk RNA-seq from the prefrontal brain region from ROSMAP dataset, all methods except Bseq-sc and GTM-HVG performed reasonably well. It is possible that the HVG are the genes having high variance within the cell types, which caused the poor performance of GTM-HVG on this dataset. For the pancreatic dataset with the paired single-cell and bulk RNA-seq data collected from the same individuals, GTM-HVG performs the best with GTM-PP as the runner-up in terms of Spearman R, and RMSE are similar among all methods except MuSiC with notably higher error. In summary, GTM-ALL performed the best in 3 datasets; GTM-HVG performed the best in the other two datasets, where the CTS gene expression might exhibit more distinct inter-cell-type variability. Furthermore, we also evaluated the deconvolution performance for separate cell types in terms of the correlation between ground-truth proportions and predicted proportions for each cell type across samples. Overall, GTM-decon conferred competitive performance with the runner-up method being BayesPrism (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a right and b; Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S11-S15). Therefore, the results suggest the general effectiveness of topic modeling in cell-type deconvolution and the additional benefits conferred by GTM-decon due to its algorithmic innovations.<fig id="Fig2"><label>Fig. 2</label><caption><p>Evaluation of deconvolution performance on real bulk data. <bold>a</bold> Evaluation of sample deconvolution. We evaluated the deconvolution performance of GTM-decon using all genes (GTM-ALL), preprocessed genes (GTM-PP), and highly variable genes (GTM-HVG) with five SOTA methods—CIBERSORTx, MUSIC, BSEQ-sc, BISQUE, BayesPrism. The 3 immune bulk data and the brain data were deconvolved using independent references of a similar tissue, while the pancreas bulk data is deconvolved using single-cell reference from the same individuals in a leave-one-out cross-validation (LOOCV) manner. The bulk labeled PBMC-1 corresponds to SDY67 dataset, PBMC-2 corresponds to S13 cohort, whole blood to whole blood dataset, and prefrontal cortex to ROSMAP dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). For each test bulk sample, Spearman correlation and root mean square error (RMSE) were computed between its ground truth and predicted cell-type proportions by each method. The box and whiskers in each boxplot indicate the 25–75% quartile and min–max of the evaluation scores over all samples in a dataset, respectively. The boxplot on the left displays the evaluation across cell types per sample, and the boxplot on the right displays the evaluation across samples per cell type. <bold>b</bold> Heatmaps comparing the cell-type-specific deconvolution performance of GTM-decon against existing methods on 5 different real bulk datasets with known ground truth mixing proportions. The cell types are ordered from most to least prevalent in the bulk data (green barplots in first row indicate average proportion for each cell type in the bulk data). The middle row shows the Pearson correlation coefficient between the predicted and known cell-type proportions. The lower row shows the inverse RMSE (higher is better, scaled between 0 and 1), per cell type per dataset. The barplots on the right show the average performance over all cell types for each method. For each cell type, Pearson correlation and RMSE were computed between its ground truth and predicted cell-type proportion for each dataset by each method. <bold>c</bold> Cell-type prediction accuracy of the purified immune bulk RNA-seq samples. The two panels indicate the use of different independent immune references, for the deconvolution of two purified bulk immune datasets (Accession Numbers: GSE107011, GSE64655). For each purified bulk sample, the cell type corresponding to the highest inferred cell-type proportion by each method was used as the predicted cell type. The barplots show the prediction accuracy as the percentage of the correctly predicted samples</p></caption><graphic xlink:href="13059_2023_3034_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par11">Additionally, we evaluated the deconvolution accuracy for purified bulk RNA-seq data of immune cells (GEO accession numbers: GSE107011 and GSE64655; Table S<xref rid="MOESM1" ref-type="media">2</xref>) using two different independent references (HBC and PBMC2; Table S<xref rid="MOESM1" ref-type="media">1</xref>). Overlapping cell types were used to evaluate the performance on the purified bulk samples, whereby the highest deconvolution proportion was used as the predicted cell-type label for computing the prediction accuracy. GTM-HVG achieved the highest accuracy across all four experiments (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Moreover, since some cell types present in the bulk are missing in the scRNA-seq reference, a robust model should either find the closest-matched cell types or properly express statistical uncertainty in this situation. To this end, we examined the inferred cell proportions of the purified bulk for those missing cell types. Plasmablast samples are present among the purified PBMC samples (GSE107011) but absent in the HBC reference (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16a). GTM-decon assigned Plasmablast samples with high cell-type proportions for B-cell, a cell type that shares Plasmablast cell lineage. The inferred cell-type proportions for Basophils purified samples were split between HSPCs (immune progenitor cells) and neutrophils, which is also classified as granulocyte. Granulocytes are the most common white blood cells, consisting of 3 specific cell types—neutrophils, eosinophils, and basophils. Using PBMC2 as a reference to deconvolve the same purified bulk immune samples led to similar deconvolution patterns for the missing cell types of plasmablast and basophils (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16b). Interestingly, neutrophils were absent in the PMBC2 reference and inferred to be monocytes, which are related to the granulocyte family—a class of immune cells that include basophils, eosinophils, and neutrophils [<xref ref-type="bibr" rid="CR27">27</xref>]. Another missing cell type HSPC (hematopoietic stem and progenitor cells) have their signal spread across all the cell types. These results suggest that when some cell types are missing in the reference, GTM-decon either finds the closest match or appropriately expresses uncertainty.</p>
      <p id="Par12">Finally, we performed benchmarking on the time and memory usage of our GTM-decon software. GTM-decon scales linearly with both the number of topics per cell type and the number of cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6; Fig. S17), which is what we expected since its time and space complexity are both <inline-formula id="IEq7"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N\times G\times K)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq7.gif"/></alternatives></inline-formula> for N cells, G genes, and K topics. For large number of cells, we can also perform stochastic variational inference [<xref ref-type="bibr" rid="CR28">28</xref>] to rapidly update model parameters based on mini-batches of cells with much lower memory overhead. It also compares favorably with BISQUE, BSEQ-sc, and MuSiC in terms of running time and memory usage.</p>
    </sec>
    <sec id="Sec7">
      <title>GTM-decon automatically learns CTS gene signatures from scRNA-seq reference</title>
      <p id="Par13">We evaluated the performance of GTM-decon in recapitulating cell-type-specific information as well as deconvolution using pancreatic tissue as a reference. The pancreas consists of several cell types including exocrine and endocrine. While the former aids digestion by secreting several enzymes, the latter regulates glucose uptake and processing by secreting hormones. With a vast literature documenting the biological roles of several cell types and their behavior in healthy and diseased conditions, such as diabetes and cancer, the pancreatic tissue serves as a good benchmark to assess GTM-decon. We trained GTM-decon on an scRNA-seq reference dataset of pancreatic tissue from Segerstolpe et al. [<xref ref-type="bibr" rid="CR29">29</xref>], consisting of 2209 cells, corresponding to 14 cell types from 10 individuals. GTM-decon captured distinct sets of CTS gene signatures, as shown by the gene-by-topic probability distributions (i.e., the matrix <inline-formula id="IEq8"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq8.gif"/></alternatives></inline-formula>) for the top 20 genes in each topic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Indeed, each topic recovers a large number of marker genes for the corresponding cell types based on two databases, namely CellMarker database [<xref ref-type="bibr" rid="CR30">30</xref>], a manually curated resource of cell markers in human and mouse and the PanglaoDB [<xref ref-type="bibr" rid="CR31">31</xref>], a database of marker genes generated from scRNA-seq datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). We further ascertained the cell-type coherence of each topic by Gene Set Enrichment Analysis (GSEA), while using the probabilities learnt for each cell type against the CellMarkerDB. For the three cell types with abundant marker genes—acinar, alpha, and beta, each of the 5 topics recovers the exact cell type as the top-most hit in the analysis, with the adjusted <italic>p</italic>-value ≤ 1 × 10<sup>−15</sup> (permutation test) in most cases (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Furthermore, the enrichment of known marker genes for the main cell types suggested that GTM-decon with 5 topics per cell type best captures the cell-type-specific signatures (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18). We also evaluated the effect of different number of cells per cell type. As expected, the topic confidence scores as measured by the average probabilities over the CTS gene distributions increase with the increasing number of cells for that cell type (i.e., evidence) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S19).<fig id="Fig3"><label>Fig. 3</label><caption><p>Cell-type-specific topic inference and deconvolution of pancreatic tissue. <bold>a</bold> Gene signatures of cell-type-specific topics in pancreas. We trained GTM-decon on the PI-Segerstolpe scRNA-seq dataset of pancreas tissue. We used 5 topics per cell type, allowing sub-cell-type inference. For the inferred genes-by-cell-type matrix <inline-formula id="IEq174"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq174.gif"/></alternatives></inline-formula>, we took the top 20 genes under each topic and visualized their topic distributions in heatmap. Whenever available from CellMarkerDB and PanglaoDB, cell-type marker genes are indicated on the left. For the cell types where marker genes are not available, “NA” were indicated on the left. The number of statistically significantly different genes in each cell type based on their topic scores (<italic>p</italic>-value &lt; 0.05; permutation test) is shown below. <bold>b</bold> Gene set enrichment analysis (GSEA) of inferred topics based on known marker genes. Cell-type-specific topics for acinar, alpha, and beta were evaluated based on whether the top genes are enriched for the known marker genes under that cell type. The bar plots show the − log<sub>10</sub> (p.adj values of enrichment score) for the gene set enrichment analysis for each of the 5 topics. The leading-edge plot for the topic with the best adj. <italic>p</italic>-value for that cell type is shown on the right. In each of the leading-edge plots, genes were ordered in decreasing order from left to right. The green curves indicate the running scores of enrichments. The barcode bars indicate cell-type marker genes. Adjusted <italic>p</italic>-values based on the GSEA enrichment scores are indicated in each panel. The three large panels display the most significantly enriched topic of among the five topics for each cell type and the 12 small panels display the remaining topics. <bold>c, e</bold> Deconvolution of bulk RNA-seq samples of 89 human pancreatic islet donors. The GTM-decon models separately trained on the Segerstolpe pancreas islet dataset (i.e., panel <bold>c</bold>) and Baron pancreas islet data (i.e., panel <bold>e</bold>) reference datasets were used to deconvolve the 89 bulk transcriptomes. As indicated by the legend, the 89 subjects consist of 51 normal, 15 impaired glucose tolerance, and 12 T2D individuals. In the heatmap, the rows represent subjects, and the columns represent cell types; the color intensity are proportional to the inferred cell-type proportions. <bold>d, f</bold> Deconvolved cell-type proportions as a function of Hemoglobin A1c (HbA1c) level. GTM-decon were trained on Segerstolpe (i.e., panel <bold>d</bold>) and Baron scRNA-seq (i.e., panel <bold>f</bold>) reference datasets. Each of the 10 panels displays a scatter plot of inferred cell-type proportion (<italic>y</italic>-axis) and HbA1c level (<italic>x</italic>-axis). The color legend indicates the 3 phenotypes. The heatmap on the right shows the deconvolved proportion of 3 most indicative cell types with subjects (rows) ordered on the basis of inferred beta cell-type proportions</p></caption><graphic xlink:href="13059_2023_3034_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>GTM-decon delineates the variations of cell-type proportions in pancreatic tissues of healthy and T2D subjects</title>
      <p id="Par14">Based on the inferred CTS topic distributions <inline-formula id="IEq9"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\upphi}}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq9.gif"/></alternatives></inline-formula>, we used GTM-decon with 5 topics per cell type to infer the cell-type proportions of bulk RNA-seq data from a cohort of 89 human pancreatic islet donors with and without type 2 diabetes (GEO accession number: GSE50244) [<xref ref-type="bibr" rid="CR32">32</xref>] (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). The dataset consists of 51 individuals with normal glucose tolerance (N), 15 with impaired glucose tolerance (IGT) and 12 with type 2 diabetes (T2D); it also has a good segregation of males (<italic>N</italic><sub>1</sub> = 54) and females (<italic>N</italic><sub>2</sub> = 35). As expected, the inferred proportions of most types of cells for these two sets of individuals are similar since they came from the same tissue. However, GTM-decon predicted a significant reduction in beta cells in T2D individuals (Pearson correlation coefficient (PCC) with HbA1c =  − 0.4, <italic>p</italic>-value = 0.00031; t-distribution with <italic>n</italic>-2 degrees of freedom) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). IGT and T2D individuals exhibit low Beta cell-type proportions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d), which was supported by the literature [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The increase in ductal cells is possibly caused by their regulation of glucose uptake (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). These results are consistent when using a different pancreatic dataset as reference (i.e., the PI-Baron reference dataset, generated via Drop-seq instead of PI-Segerstolpe, generated via Smart-seq) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, f).</p>
    </sec>
    <sec id="Sec9">
      <title>Deconvolving human pancreatic data from mouse pancreas scRNA-seq reference</title>
      <p id="Par15">For cases where scRNA-seq data were not available for the organism of interest, due to either ethical, technical, or financial challenges, there is a need to leverage scRNA-seq collected from a model organism. To this end, we investigated the possibility of deconvolving bulk RNA-seq data by training GTM-decon on a mouse scRNA-seq data. We separately trained two GTM-decon models on the human and mouse pancreatic datasets. Specifically, the human datasets include the Segerstolpe and Baron datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), which consist of 2209 cells from 10 individuals and 8569 cells from 4 individuals, respectively; the mouse dataset consists of 1886 cells collected from 2 mice. For comparative analysis, we focused on only the common set of high-confidence orthologous genes between the two species mapped by the Ensembl database [<xref ref-type="bibr" rid="CR33">33</xref>]. We visualized the cell-type proportions comparing against the ground-truth values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S20a). As expected, the cell-type proportions deconvolved using the two human datasets accurately recapitulate the ground-truth proportions (median PCC of 0.94 and 0.97). Interestingly, GTM-decon trained on the non-reference human dataset performed better than the one trained on the reference-matched dataset, which was probably due to the tenfold higher number of cells in the former scRNA-seq dataset. Moreover, GTM-decon trained on the mouse reference dataset also performed quite well in terms of the concordant proportions of the shared cell types (PCC of 0.94).</p>
    </sec>
    <sec id="Sec10">
      <title>Deconvolving pancreatic cancer transcriptomes identified tumor cell-type origin</title>
      <p id="Par16">We next turned to deconvolving pancreatic adenocarcinoma (PAAD) (also known as pancreatic ductal adenocarcinoma or PDAC) tumor bulk samples from TCGA. For this application, we also used GTM-decon with 5 topics per cell type. Since the tumor microenvironment is known to be infiltrated with immune cells [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>], we sought to train GTM-decon on a single-cell reference dataset derived from individuals with pancreatic cancer, in order to capture the cell types of both the tissue of interest and the immune cells in its tumor microenvironment. To this end, we trained GTM-decon on an scRNA-seq dataset comprised of the transcriptomic profiles of about 57,000 cells from 24 primary PAAD tumors and 11 healthy control pancreas samples [<xref ref-type="bibr" rid="CR36">36</xref>] in order to deconvolve the 174 bulk RNA-seq profiles from the TCGA-PAAD tumor samples. Additionally, we also sought to identify possible novel cell types or pathways present in the bulk RNA-seq, which are not represented in the reference profiles. This is achieved by running an unguided topic model (i.e., a standard LDA) on the sparsified bulk RNA-seq data to detect de novo bulk RNA-seq (bulkRS) topics (“<xref rid="Sec8" ref-type="sec">Methods</xref>”). We empirically chose the number of de novo bulkRS topics based on how well they could explain the variation observed in the clinical phenotypes.</p>
      <p id="Par17">We observe that the most prevalent cell types are 4 main pancreatic cell types, namely ductal (type 2), acinar, endocrine (alpha and beta cell types), and fibroblasts (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Notably, the cell type of tumor origin is correctly predicted for the samples: Ductal cells have the highest proportion among the PAAD samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; brown rectangle), and acinar for a subset of the PAAD samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; blue rectangle). This recapitulates the literature remarkably well, as ductal cells are known to be the site of the tumor origin for most cases of PAAD; however, a subset arises from acinar cells [<xref ref-type="bibr" rid="CR37">37</xref>]. More significantly, an unknown subtype is predicted to originate from endocrine cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; green rectangle). This is supported by the recent literature, which reported these samples as the derivatives of the pancreatic neuroendocrine tumor (PNET) were in fact misclassified as PAAD [<xref ref-type="bibr" rid="CR38">38</xref>]. PNET are supposed to originate from alpha or beta cells (endocrine cells) [<xref ref-type="bibr" rid="CR39">39</xref>]. In addition, most of the samples are predicted to have a high proportion of fibroblasts, which are known to be prevalent in pancreatic cancer (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; blue dot) [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR42">42</xref>]. Interestingly, deconvolving the pancreatic cancer PAAD dataset using mouse reference dataset also conferred high-quality patient clustering comparable to that of human dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S20b). Notably, the PAAD “other subtype” was predicted to originate from alpha cells (an endocrine cell), which mirrors the results from human reference data (Fig. S<xref rid="MOESM1" ref-type="media">20</xref>b; shown in blue rectangles).<fig id="Fig4"><label>Fig. 4</label><caption><p>Deconvolution of bulk RNA-seq samples for pancreatic cancer from TCGA-PAAD. GTM-decon was first trained on an scRNA-seq dataset from individuals with pancreatic cancer. The trained GTM-decon model was then used to infer the cell-type proportions of the 174 TCGA-PAAD bulk RNA-seq profiles. <bold>a</bold> The average inferred cell-type proportion across the TCGA-PAAD tumor samples. We summed up inferred cell-type proportions over all samples followed by normalization. The pie chart displays the resulting percentage of cell-type proportions. <bold>b</bold> Inferred cell-type proportions of individual TCGA-PAAD tumor samples. To complement the inferred proportions of known cell types, we also ran unguided topic model (i.e., LDA) on the TCGA-PAAD bulk RNA-seq profiles directly to detect de novo topics that are not present in scRNA-seq reference. The heatmap visualizes the combined deconvolution results based on the 10 pancreatic cell types, and 10 de novo topics (i.e., columns). Each of the 174 rows represents a subject. Three types of demographic or clinical phenotypes were shown in the legend to aid result interpretation. These include “days to death,” cancer subtype, and whether the cancer type is PNET or not. The regions in the highlighted boxes were discussed in more details in the main text. <bold>c</bold> Survival analysis of the CTS and de novo topics using inferred cell-type proportions. The 174 subjects were divided into two groups based on K*-means clustering with K* set to 2 (not to be confused with the K cell types or topics). Kaplan–Meier curves were generated for these groups and compared using log-rank test. The plot shows the − log<sub>10</sub>(<italic>p</italic>-value) from the log-rank test for all the CTS and de novo topics, in decreasing order of significance. <bold>d</bold> Kaplan–Meier curve for endocrine cell-type proportion. The curve and shaded area represent the mean and standard deviation of the cell-type proportions in the two groups, respectively. The number of subjects for each cluster was indicated in the bottom panel</p></caption><graphic xlink:href="13059_2023_3034_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par18">Interestingly, the de novo bulkRS topics cluster with the most abundant reference topics inferred from the scRNA-seq reference data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, blue circles). For example, bulkRS Topic 2 corresponds to the CTS topic for acinar cell type, Topic 10 to the CTS topic for endocrine cell type, Topic 9 to Ductal_type_2, Topic 8 to Fibroblast, and Topic 6 to stellate cells. However, there are a few de novo bulkRS topics, such as bulkRS Topic 1, Topic 4, and Topic 5, capturing distinct distributions for specific subsets of samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b; red dots). These topics could correspond to either novel cell types or gene pathways in the bulk but not implicated in the scRNA-seq reference.</p>
      <p id="Par19">We next estimated whether variation in cell-type proportions or bulkRS topics is indicative of survival time. To this end, we performed Cox Regression to regress the number of days patients lived since their cancer diagnosis on their inferred cell-type proportions as well as the de novo bulkRS topics. Overall, the Cox Regression model is statistically significant compared to the bias term (adjusted <italic>p</italic>-value = 9 × 10<sup>−5</sup> based on likelihood ratio test). To explore the marginal effect of individual cell-type proportions on survival, we performed Kaplan–Meier analysis by separating patients into two groups based on K-means clustering (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). We observe that among the cell types, endocrine cell type exhibits a significant hazard ratio, predicting a good survival outcome (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d; <italic>p</italic>-value = 0.0091; log-rank test), which is supported by the literature as PNETs are mostly benign [<xref ref-type="bibr" rid="CR43">43</xref>]. However, ductal cell type 2 is associated with poor survival outcome, which is expected as pancreatic adeno carcinoma are aggressive (<italic>p</italic>-value = 0.03; log-rank test). On the other hand, Topic 1 and Topic 5 indicate poorer survival, with hazard ratios of 4 and 40 respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S21) although their roles are unclear since they do not cluster with any of the CTS topics (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). This reiterates the usefulness of using CTS topics in conjunction with de novo bulkRS topics to enable their interpretation wherever possible.</p>
      <p id="Par20">A similar analysis conducted using a separate scRNA-seq reference from healthy pancreatic subjects only reveals similar results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S22). However, in this analysis, only two of the de novo bulkRS topics clearly correspond to CTS topics (acinar and ductal), suggesting that the usage of an appropriate scRNA-seq reference with matched tumor environment is preferred.</p>
    </sec>
    <sec id="Sec11">
      <title>Deconvolving breast cancer transcriptomes revealed subtype-specific markers</title>
      <p id="Par21">To capture specific subtypes of breast tumor samples from the TCGA data, we trained GTM-decon on an scRNA-seq reference data from 26 primary tumors of breast cancer (BRCA) patients with three major clinical subtypes of BRCA, including 11 ER + , 5 HER2 + and 10 TNBC [<xref ref-type="bibr" rid="CR44">44</xref>]. The data consists of about 1 million cells and covers 7 major cell types and 29 minor cell types. This served as a high-resolution reference for annotating the TCGA-BRCA tumor samples (<italic>n</italic> = 1212) based on the major subtypes from the scRNA-seq dataset, namely Cancer-Basal, Cancer-Her2, Cancer-LumA, and Cancer-LumB (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23a). As expected, significantly higher proportions of endothelial and myoepithelial cell types are found in the normal-like samples, in comparison to the cancer subtypes (Fig. S<xref rid="MOESM1" ref-type="media">23</xref>a). Furthermore, basal subtype is enriched for cancer-basal cells (Fig. S<xref rid="MOESM1" ref-type="media">23</xref>b, shown in dotted brown rectangle), and the cancer-associated fibroblasts (CAFs) are enriched in almost all the samples (Fig. S<xref rid="MOESM1" ref-type="media">23</xref>b, shown in blue rectangles). Similar to the above analyses, some of the de novo bulkRS topics from sparsified samples overlap with the most represented cell types. For example, Topic 6 resembles myofibroblast-like cancer-associated fibroblasts (myCAF-like), and Topic 8 resembles LumA subtype cancer cells.</p>
      <p id="Par22">Deconvolution using the scRNA-seq reference from the healthy individuals also captures the cell type of origin for the different breast cancer subtypes implicated in the bulk samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S24). For this analysis, using highly variable genes is more discriminatory than all genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S25). The inferred CTS topic distributions from normal breast tissue recapitulate several marker genes from CellmarkerDB and PanglaoDB (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>a). Furthermore, GTM-decon-inferred cell-type proportions clearly distinguish TCGA breast tumor samples from GTEx normal breast tissues (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>b). Moreover, the basal cell type is predicted to have the highest proportion in the basal subtype defined by the PAM50 classification in comparison to other subtypes (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>c) [<xref ref-type="bibr" rid="CR45">45</xref>]. Also, we observed higher predicted proportion for Luminal_2 cell type in both LumA and LumB subtypes as expected [<xref ref-type="bibr" rid="CR46">46</xref>] (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>c). Among the de novo bulkRS topics from sparsified samples, Topic 5 is highly enriched in LumB, while Topic 7 and Topic 8 are enriched in basal and LumA subtypes (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>c). The guided topic score for the basal subtype also correlates with higher proliferation score as expected [<xref ref-type="bibr" rid="CR45">45</xref>]. Specifically, the basal cell type is enriched in this subtype (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>d; enclosed in green rectangle), whereas Luminal_2 is depleted (Fig. S<xref rid="MOESM1" ref-type="media">24</xref>d; enclosed in green dashed rectangle). In contrast, ER + samples appear to be enriched for Luminal_2 cells (Wilcoxon test <italic>p</italic>-value = 4.5e − 10; Fig. S<xref rid="MOESM1" ref-type="media">26</xref>), as expected [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. Furthermore, Topic 7 clearly captures the basal subtype (enclosed in brown rectangle in Fig. S<xref rid="MOESM1" ref-type="media">24</xref>d), whereas there is no clear topic capturing the ER + phenotype.</p>
    </sec>
    <sec id="Sec12">
      <title>GTM-decon learns phenotype-guided gene topics specific to BRCA subtypes</title>
      <p id="Par23">Our guided topic mechanism is not limited to inferring CTS topics, but can be extended to inferring phenotype-specific topics (i.e., topics capturing phenotype-specific gene expression) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), thereby discovering gene signatures of subtypes or different cancer stages. We applied this approach to study the differences between basal and ER + BRCA subtypes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a–c) and the difference between ductal carcinoma and lobular carcinoma (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d–f). We modeled each phenotype using 5 topics each, based on a sparsified matrix of bulk RNA-seq data (“<xref rid="Sec8" ref-type="sec">Methods</xref>”), resulting in a genes-by-phenotypes matrix <inline-formula id="IEq10"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq10.gif"/></alternatives></inline-formula> with 5 topics per phenotype (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We then ranked genes by the topic scores under each topic. Almost all the genes identified by our approach were also deemed as differentially expressed (DE) genes by DESeq2 differential analysis [<xref ref-type="bibr" rid="CR48">48</xref>] (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). GSEA of the topics shows differences between the basal and ER + phenotypes, although there is not much difference among the 5 topics for basal (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). Moreover, the trained GTM-decon confers accurate phenotype classification with 97% accuracy for discriminating basal and ER + (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b) and 82% for discriminating ductal and lobular subtypes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d), which is comparable to the traditional supervised learning methods namely logistic regression and random forest (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f). We also evaluated phenotype classification accuracy as a function of sparsification rate (described in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S7 and illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S27) suggesting the importance of sparsification for inferring topics from bulk RNA-seq data using GTM-decon. We also trained GTM-decon only on the highly variable genes in the unsparsified bulk RNA-seq samples. This results in lower classification accuracy (76% for ductal-lobular samples as compared to 82%, and 95% for basal-ER + samples as compared to 97%), which might be due to information loss (HVG = 1391 for basal-ER + samples, HVG = 445 for ductal-lobular samples). Training using DE genes between the two phenotypes identified by DESeq2 also results in lower classification accuracy of 83% and 75%, respectively. These experiments suggest that GTM-decon can utilize more informative genes to discriminate the breast cancer subtypes than the traditional differential analysis approach.<fig id="Fig5"><label>Fig. 5</label><caption><p>Phenotype-guided topic modeling of bulk RNA-seq data of breast cancer. <bold>a</bold> Predicted top genes for the phenotype-guided topics for basal and ER + breast cancer subtypes. GTM-decon was trained on the sparsified TCGA-BRCA bulk RNA-seq data with the basal and ER + cancer subtypes as the guide. Five topics were used per subtype and therefore 10 topics in total. The heatmap illustrates the topic probabilities of the top 20 genes from each topic. As a comparison, the genes were also labeled as up- or downregulated if they were deemed differentially expressed by the DESeq2 analysis. <bold>b</bold> Classification of basal and ER + subtypes based on phenotype-guided topic scores. The 5 topics for the same subtype were summed to obtain the overall score for basal and ER + subtype. Subjects in the rows were sorted by their basal topic scores. <bold>c</bold> GSEA analysis of the basal and ER + subtype topics. Significantly enriched MSigDb HALLMARK pathways were identified for each topic and displayed as barplots. The heights of the bar indicate the − log10 adjusted <italic>p</italic>-values and the colors indicate enriched pathways. <bold>d</bold> Predicted top genes for the phenotype-guided topics for histological subtypes. Same as in panel <bold>a</bold> but for ductal and lobular subtypes. <bold>e</bold> Classification of histological subtypes. Same as in panel <bold>b</bold> but for ductal and lobular subtypes. <bold>f</bold> Evaluation of the subtype classification accuracy on the test breast tumor samples. We trained the phenotype-guided GTM-decon separately on 80% of the sparsified TCGA-BRCA tumor samples using basal/ER + and histological types as the guides and evaluated its phenotype prediction accuracy on the 20% held sparsified samples. As a comparison, we also trained and evaluated logistic regression and random forest on the same training and test split, respectively. The classification accuracy on the test set by each method were displayed in the barplots</p></caption><graphic xlink:href="13059_2023_3034_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Nested-guided topic modeling identifies CTS DE genes in breast cancer subtypes</title>
      <p id="Par24">scRNA-seq can facilitate molecular understanding of genes and pathways in specific cell types with respect to phenotypic states. This level of detail is absent in bulk RNA-seq data, which profiles only the averaged gene expression from all cell types in the tissue. However, due to the cost, scRNA-seq profiles at the patient cohort size are rare. To take advantage of both types of data, we sought a way to identify cell-type-specific gene expression differences corresponding to the phenotypes observed for the bulk samples. Briefly, we took a pretrained GTM-decon on a scRNA-seq reference data and then updated its CTS topics based on the corresponding phenotypes from the sparsified bulk data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). This is equivalent to treating the phenotype as level 1 and cell types as level 2 in a two-stage nested factor design in statistics.</p>
      <p id="Par25">For the TCGA-BRCA data, in particular, we first initialized the genes-by-topic matrix <inline-formula id="IEq11"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq11.gif"/></alternatives></inline-formula> with the <italic>pretrained</italic> guided topics learned from the scRNA-seq reference for normal breast tissue. We then <italic>fine-tuned</italic> 5 CTS topics for each phenotype (i.e., ER + or basal) from sparsified bulk data, resulting in a 10-topic model. During the fine-tuning, all CTS topics corresponding to the patient’s phenotype are assigned a prior value of 0.9. Applying this approach to 798 sparsified samples from TCGA-BRCA, corresponding to basal (<italic>N</italic><sub>1</sub> = 140) and ER + (<italic>N</italic><sub>2</sub> = 658) led to a new genes-by-topic matrix <inline-formula id="IEq12"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\upphi }^{*}$$\end{document}</tex-math><mml:math id="M84"><mml:msup><mml:mrow><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq12.gif"/></alternatives></inline-formula>. First of all, the top genes for the topics corresponding to the same cell type are similar in both phenotypes, as they are expected to capture CTS signatures (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). However, differential analysis of genes between two phenotypes revealed upregulated genes in one phenotype being downregulated in the other (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). These differences between basal and ER + are statistically significant across all genes for all the cell types based on paired Wilcoxon signed-rank tests. Next, we evaluated the ability of the fine-tuned GTM-decon to classify the held-out test set and observed a 97% classification accuracy (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c, top panel). These higher-resolution deconvolved CTS breast cancer profiles reveal that ER + samples are enriched for Luminal-2 cell type, whereas the basal subtype is depleted for that cell type (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c).<fig id="Fig6"><label>Fig. 6</label><caption><p>Identification of cell-type-specific differentially expressed genes from bulk RNA-seq data for basal vs. ER + subtypes. <bold>a</bold> Top cell-type-specific gene signatures for basal and ER + . GTM-decon was pretrained on a scRNA-seq reference dataset from normal breast tissue to infer the expression distribution of 5 cell types, namely basal, basal myoepithelial, luminal 1–1, luminal 1–2, and luminal 2. The resulting genes-by-cell-type estimates were then used as the initial topic distributions for another GTM-decon, which is guided by the basal and ER + cancer subtypes in modeling the sparsified TCGA-BRCA bulk data. This led to a 10-topic distribution, each of which was specifically tailored for a combination of cell type and cancer subtype. The heatmap displays the probabilities of the top 20 genes for each topic. The left half displays the cell-type-specific topic distribution for basal and the right half for ER + . <bold>b</bold> Predicted differentially expressed (DE) genes for each cell type between basal and ER + . The top DE genes for basal in contrast to ER + were identified by subtracting the gene topic scores for ER + from the gene topic score for basal under the same cell type. The resulting DE scores were shown in the top half of the heatmap. The bottom half displays the DE scores of the top genes for ER + in contrast to basal. The pairwise Wilcox signed-rank tests were performed to compare the gene topic scores across all genes between the two subtypes for the same cell type. All tests yielded <italic>p</italic>-values lower than 2.2e<sup>−16</sup>. <bold>c</bold> Classification of basal and ER + based on the phenotype probabilities. As a validation for our nested phenotype-cell-type guided approach, we evaluated the classification accuracy on the 160 held-out sparsified breast tumor samples. For each subtype, we summed the cell-type-specific topic probabilities from bottom heatmap for each sample to obtain the phenotype scores, which are shown in the top heatmap. <bold>d</bold> Comparison of DE genes detected by our approach and by DESeq2. DESeq2 was applied to the bulk RNA-seq gene expression data to compare gene expression between ER + and basal samples. In total, 6815 DE genes were deemed significant by adjusted <italic>p</italic>-value &lt; 0.05 (Wald test) with 2952 upregulated and 3863 downregulated genes in ER + relative to basal. The grey bar and the heatmap on the left display the − log adjusted <italic>p</italic>-value for all of the upregulated genes (top half) and the downregulated genes (bottom half). Genes were ordered in decreasing order of the absolute test statistic for each half. The corresponding log<sub>2</sub> fold-change of ER + over basal was also shown as heatmap. The heatmap on the right displays the change of gene topic score from basal subtype to ER + subtype. <bold>e</bold> Cell-type-specific DE genes identified by nested-guided topic approach. The top and bottom part of the heatmap displays the topic scores for the upregulated and downregulated genes in basal relative to ER + , respectively (<italic>p</italic>-value &lt; 0.05; permutation test). Genes that were also detected by DESeq2 were labeled in the color bar. <bold>f</bold> ORA was applied to the differential topic scores of upregulated and downregulated genes in ER + relative to basal. MSigDb HALLMARK pathway gene sets were used in ORA. The − log <italic>p</italic>-values for the significant pathways were shown in the bar plot</p></caption><graphic xlink:href="13059_2023_3034_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par26">Next, we identified the DE genes per cell type by subtracting the genes-by-topic entries in the <inline-formula id="IEq13"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upphi$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="normal">ϕ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq13.gif"/></alternatives></inline-formula> matrix for phenotype <inline-formula id="IEq14"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M88"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq14.gif"/></alternatives></inline-formula> (e.g., basal) from phenotype <inline-formula id="IEq15"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}{\prime}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq15.gif"/></alternatives></inline-formula> (e.g., ER +) under the same cell type (e.g., Luminal 2). To evaluate the consistency of our DE genes, we compared them against the DE genes identified by DESeq2 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). We observe that all upregulated and downregulated DE genes nominated by DESeq2 in ER + versus basal comparison were also deemed upregulated and downregulated by our approach, respectively. We visualize the expression of the 630 statistically significant DE genes (adjusted <italic>p</italic>-value &lt; 0.05; permutation test) in the BRCA tumor samples (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e). We found that most of our DE genes do not only agree with those by DESeq2 but also exhibit CTS patterns. Notably, the most DE genes correspond to the Luminal_2 cell type (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e), which exhibit the larger difference between ER + and basal (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S26). Over representation analysis (ORA) of these CTS DE genes against Hallmark pathways from MSigDb revealed several meaningful pathways. As expected, estrogen response (early) and (late) pathways are highly upregulated in the ER + phenotype, mainly in the Luminal_2 cell type (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). Similarly, most DE genes in the basal phenotype are upregulated for typical pathways involved in cancer, such as G2M checkpoint, E2F targets, and mitotic spindle. This reflects the aggressive nature of basal cell type as the origin for the cancer subtype (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). The contribution of sparse genes (i.e., genes with zero counts due to sparsification) to CTS topics and DE analysis is described in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S7 and illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S28. We obtained similar results comparing the 2 histological subtypes—ductal carcinoma and lobular carcinoma (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S29).</p>
      <p id="Par27">To further demonstrate the phenotype-guided and phenotype + cell-type-guided functionality, we applied GTM-decon to the same scRNA-seq data from breast cancer tumors using phenotypes (i.e., ER + and TNBC) and cell-type labels as the guides and then used the inferred topics to deconvolve the bulk TCGA breast tumor transcriptome data. Detailed analyses are presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref> Section S8 and Fig. S<xref rid="MOESM1" ref-type="media">30</xref>. This was feasible because we have scRNA-seq references that were collected from similar tissue sites from patients of the same disease phenotypes as the target bulk transcriptomes.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par28">In this study, we developed a Bayesian approach called <italic>GTM-decon</italic> to infer CTS gene topic distributions from scRNA-seq reference data. During the topic inference of each cell, we introduce the guidance by setting the topic hyperparameter for the cell type of that cell to be relatively larger than the hyperparameters for other topics. This enables us to anchor each topic to a specific cell type and subsequently guide the inference of the global topic distributions over genes to automatically prioritize cell-type marker genes. The resulting topic distributions can then be used to infer the relative cell-type proportions from bulk RNA-seq datasets (i.e., cell-type deconvolution).</p>
    <p id="Par29">Through our analysis of the pancreatic and breast tissue datasets, we observe that for those cell types, where marker gene information is available, most of the top genes under the CTS topics correspond to known marker genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S24a). Because GTM-decon infers a distribution over all the genes under each cell-type-guided topic, it can be used to not only quantify the contribution of the known marker genes but also score novel marker genes. In terms of cell-type deconvolution, GTM-decon confers comparable performance to the existing state-of-the-art methods (Fig. <xref rid="Fig2" ref-type="fig">2</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10-15). The deconvolved cell-type proportions can be used to distinguish healthy and diseased samples as shown in the case of diabetic patients (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c,e) as well as cancer subtypes from pancreatic and breast tumors (Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23). This enables investigation of molecular contribution to the phenotypic differences. Phenotypic differences between healthy and diabetic patients were captured even when the scRNA-seq reference datasets were generated from different platforms (e.g., Smart-seq and Drop-seq) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d, f).</p>
    <p id="Par30">Using GTM-decon, we revisited two cancer datasets from TCGA, namely pancreatic adenocarcinoma (PAAD) and breast cancer (BRCA). To dissect the heterogeneous tumor microenvironment, we deconvolved these datasets based on scRNA-seq reference sets from pancreatic cancer and breast cancer, respectively. As a result, we identified the ductal and acinar origin of PAAD, the endocrine origin of pancreatic neuroendocrine tumors (PNET) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b), and enrichment of subtype-specific cells for the BRCA subtypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23a). Interestingly, using scRNA-seq references from pancreatic and breast tissues of healthy individuals is also sufficient to identify the cell type of origin for all subtypes in pancreatic cancer (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S22), as well as the basal origin of basal subtype and the luminal origin of ER + breast cancer (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S24). However, using a cancer-specific scRNA-seq dataset improves the resolution of deconvolution in identifying more subtypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S23). By combining the de novo topics inferred directly from the bulk RNA-seq data with the scRNA-guided topics, we identified putative prognostic biomarkers that correlate with survival time (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S21, S22c).</p>
    <p id="Par31">We further extended GTM-decon by modeling the sparsified bulk RNA-seq data using the patient phenotype labels as the guide rather than cell types. In contrast to the traditional differential analysis approach, the phenotype-guided GTM-decon provides a different way to investigate gene signatures and molecular pathways underpinning the phenotypes of interest (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). To leverage the scRNA-seq reference data, we further extended this framework to a nested-guided topic model by fine-tuning a dedicated set of CTS topic distributions for each phenotypic state (e.g., BRCA subtypes) of the patients from the bulk RNA-seq data. This enables learning not only intra-phenotype changes of cell-type distributions but inter-phenotype changes of gene expression. The latter allowed us to identify CTS DE genes directly from bulk RNA-seq data (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). We extended this approach to infer phenotype and cell-type guided topics from single-cell breast cancer RNA-seq data with cancer subtypes as the phenotype guide. This led to accurate deconvolution of cancer subtypes from bulk TCGA-BRCA data, as well as identification of phenotype-specific and CTS DE genes from the single-cell data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S30). Only a few methods can perform both deconvolution and CTS DE analysis. For example, CIBERSORTx [<xref ref-type="bibr" rid="CR18">18</xref>] uses a non-negative matrix factorization approach based on partial observations to identify CTS DE genes across phenotypes. Other methods such as TOAST [<xref ref-type="bibr" rid="CR24">24</xref>] and bMIND [<xref ref-type="bibr" rid="CR23">23</xref>] that can estimate CTS DE require precomputed cell-type proportions by an external deconvolution method.</p>
    <p id="Par32">As future works, we can adapt GTM-decon to leverage other single-cell omic data such as scATAC-seq for reference and deconvolve the equivalent omic in bulk samples. It can also be extended to work with different cell states, like in BayesPrism [<xref ref-type="bibr" rid="CR22">22</xref>], by modeling the topics based on cell states instead of cell types. Like all other deconvolution approaches, GTM-decon alone is unable to identify novel cell types from bulk RNA-seq datasets (i.e., cell types that are not present in the reference scRNA-seq data GTM-decon is trained on), while it is able to capture perturbed cell types based on the phenotypes (e.g., Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). This can be addressed by training GTM-decon on an atlas-level scRNA-seq data such as the Human Cell Landscape [<xref ref-type="bibr" rid="CR49">49</xref>] and Tabula Sapiens [<xref ref-type="bibr" rid="CR50">50</xref>], which comprehensively covers most of the cell types in the primary tissues. The resulting model can then be used to deconvolve bulk samples of any given target tissue. Lastly, cell types are not independent entities but rather form a lineage. One future direction is to exploit the relations among the cell types, which may better capture the underlying phenotypic states of the subjects. A more recently developed method called CeDAR [<xref ref-type="bibr" rid="CR51">51</xref>] uses known cell-type hierarchy as prior to infer CTS expression in bulk data as opposed to our de novo sub-cell-type inference and will leave a more detailed comparison as future work. Moreover, we can also extend GTM-decon to modeling multi-omic single-cell data to identify multi-omic CTS topic distributions and then use them to deconvolve multi-omic bulk data. To this end, while several multi-omic modeling methods have been developed [<xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR55">55</xref>], their benefits in deconvolution are not fully realized. Lasty, deep-learning-based methods such as Scaden [<xref ref-type="bibr" rid="CR22">22</xref>] can train on simulated or real bulk RNA-seq datasets to predict cell-type proportions. While Scaden can confer accurate deconvolution results, it compromises interpretability because of its non-linear distributed representation of the gene expression features. Some recently developed variational autoencoder and embedded topic modeling frameworks [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>] may be extended to strike a balance between deconvolution accuracy and model interpretability.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par33">Computational cell-type deconvolution of heterogeneous bulk transcriptome is highly cost-effective in revealing the underlying phenotypic states and identifying CTS differentially expressed genes. GTM-decon represents a significant advance in the deconvolution methods with 3 prominent contributions: (1) automatic inference of interpretable CTS topic distributions by directly modeling large single-cell RNA-seq reference data without using known marker genes, therefore providing a principled and amenable reference map for the subsequent deconvolution; (2) identifying sub-CTS gene expression distributions by inferring multiple topics anchored at the same cell type, leading to a finer resolution of the deconvolution results; (3) detecting CTS DE genes directly from bulk or single-cell samples via an extended nested-guided topic design leveraging both the phenotype states and cell-type label information. Our comprehensive experiments on pancreatic and breast datasets demonstrated the utilities of all 3 contributions. Together, GTM-decon is an efficient marker-free deconvolution method that takes the full advantage of the single-cell RNA-seq reference data for cell-type deconvolution.</p>
  </sec>
  <sec id="Sec16">
    <title>Methods</title>
    <sec id="Sec17">
      <title>Modeling scRNA-seq reference data via topic inference guided by cell-type labels</title>
      <p id="Par34">We adapted GTM-decon from the MixEHR-Guided (Mixture of Electronic Health Records – Guided) [<xref ref-type="bibr" rid="CR58">58</xref>] (which was in turn inspired by MixEHR (Mixture of Electronic Health Records) [<xref ref-type="bibr" rid="CR59">59</xref>] and sureLDA (Surrogate-guided ensemble Latent Dirichlet Allocation) [<xref ref-type="bibr" rid="CR60">60</xref>]) to model gene expression from scRNA-seq data. We assume that the scRNA-seq data are generated from the following data generative process. Each cell indexed by m ∈ {1, …, M} is a mixture of the K cell types. The cell-type mixture <inline-formula id="IEq16"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq16.gif"/></alternatives></inline-formula> is sampled from a K-dimensional Dirichlet distribution <inline-formula id="IEq17"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\varvec{\uptheta}}}_{\mathrm{m}} \sim \mathrm{ Dir}({\varvec{\upalpha}}}_{m}+0.1)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq17.gif"/></alternatives></inline-formula> with the hyperparameter <inline-formula id="IEq18"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq18.gif"/></alternatives></inline-formula> being specific to the cell. The key assumption here that separates GTM-decon from the standard LDA [<xref ref-type="bibr" rid="CR25">25</xref>] is the use of noisy cell-type label <inline-formula id="IEq19"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}\in \{1,..,K\}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq19.gif"/></alternatives></inline-formula> for the cell. The hyperparameter corresponding to the cell-type label <inline-formula id="IEq20"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}=k$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq20.gif"/></alternatives></inline-formula> has higher value (<inline-formula id="IEq21"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}= 0.9$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq21.gif"/></alternatives></inline-formula> by default) in contrast to the rest of the hyperparameters <inline-formula id="IEq22"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq22.gif"/></alternatives></inline-formula> for <inline-formula id="IEq23"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}{\prime}\ne k$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq23.gif"/></alternatives></inline-formula>, which are randomly set to small values between 0.01 and 0.1. Note that having non-zero <inline-formula id="IEq24"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq24.gif"/></alternatives></inline-formula> allows other cell types to be assigned to the cell (i.e., <inline-formula id="IEq25"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{m,{k}^{{\prime} } }\ge 0$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq25.gif"/></alternatives></inline-formula>) and therefore <inline-formula id="IEq26"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq26.gif"/></alternatives></inline-formula> reflects the statistical uncertainty of the cell-type label <inline-formula id="IEq27"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq27.gif"/></alternatives></inline-formula>, which can be error prone due to various technical and data preprocessing aspects of the scRNA-seq data. To not clutter the notation, we omit the baseline value 0.1 in the following model description and use the more general form of <inline-formula id="IEq28"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\varvec{\uptheta}}}_{\mathrm{m}} \sim \mathrm{ Dir}({\varvec{\upalpha}}}_{m})$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq28.gif"/></alternatives></inline-formula> instead. Following the above default setting, this is equivalent to setting <inline-formula id="IEq29"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}=1$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq29.gif"/></alternatives></inline-formula> for the observed cell type and <inline-formula id="IEq30"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,{k}{\prime}}\in [0.11, 0.2]$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.11</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq30.gif"/></alternatives></inline-formula> for other cell types. For each cell <inline-formula id="IEq31"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M122"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq31.gif"/></alternatives></inline-formula>, each scRNA-sequenced read <inline-formula id="IEq32"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \left\{1,\dots , {N}_{m}\right\}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq32.gif"/></alternatives></inline-formula> originates from one of the <inline-formula id="IEq33"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M126"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq33.gif"/></alternatives></inline-formula> cell types with the probabilities dictated by its cell-type mixture (<inline-formula id="IEq34"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq34.gif"/></alternatives></inline-formula>): <inline-formula id="IEq35"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}\sim \mathrm{Cat}\left({{\varvec{\uptheta}}}_{m}\right)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq35.gif"/></alternatives></inline-formula>. Given the cell type <inline-formula id="IEq36"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}=k$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq36.gif"/></alternatives></inline-formula>, the <italic>i</italic>th read maps to a specific gene indexed by <inline-formula id="IEq37"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq37.gif"/></alternatives></inline-formula> with the probabilities dictated by the CTS topic distribution over all genes (<inline-formula id="IEq38"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq38.gif"/></alternatives></inline-formula>): <inline-formula id="IEq39"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m} \sim \mathrm{Cat}({{\varvec{\upphi}}}_{k})$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq39.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq40"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq40.gif"/></alternatives></inline-formula> follows a G-dimensional Dirichlet distribution with a fixed hyperparameter <inline-formula id="IEq41"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M142"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq41.gif"/></alternatives></inline-formula> across all <italic>K</italic> dimensions: <inline-formula id="IEq42"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}\sim \mathrm{Dir}\left(\beta \right)$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq42.gif"/></alternatives></inline-formula>. Since the topic mixture <inline-formula id="IEq43"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq43.gif"/></alternatives></inline-formula> are softly clamped to specific cell types via the <italic>K</italic>-dimensional hyperparameter <inline-formula id="IEq44"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq44.gif"/></alternatives></inline-formula>, by following the above data generative process, it is straightforward to see that the <italic>K</italic> sets of topic distributions <inline-formula id="IEq45"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq45.gif"/></alternatives></inline-formula>‘s are also CTS.</p>
      <p id="Par35">The posterior distribution for the latent variables <inline-formula id="IEq46"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{m}$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq46.gif"/></alternatives></inline-formula>’s, <inline-formula id="IEq47"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq47.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq48"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq48.gif"/></alternatives></inline-formula>’s conditioned on the scRNA-seq reference data can be either approximated by Gibbs sampling [<xref ref-type="bibr" rid="CR61">61</xref>] or by collapsed mean-field variational inference [<xref ref-type="bibr" rid="CR62">62</xref>]. Specifically, for algorithmic convenience, we can leverage the conjugacy of the Dirichlet to categorical distribution by integrating out <inline-formula id="IEq49"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq50.gif"/></alternatives></inline-formula> resulting in two Dirichlet-Multinomial distributions [<xref ref-type="bibr" rid="CR63">63</xref>]:<disp-formula id="Equa"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(z\vert\alpha\right)=\int p\left(\theta\vert\alpha\right)p\left(z\vert\theta\right)d\theta=\prod_m\frac{\Gamma(\sum_k\alpha_{m,k})}{\prod_k\Gamma(\alpha_{m,k})}\frac{\prod_k\Gamma(\alpha_{m,k}+n_{.,m,k})}{\Gamma(\sum_k\alpha_{m,k}+n_{.,m,k})}$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(x|z\right)=\int p\left(\phi |\beta \right)p\left(x|z,\phi \right)d\phi ={\prod }_{k}\frac{\Gamma \left(G\beta \right)}{{\prod }_{g}\Gamma \left(\beta \right)}\frac{{\prod }_{g}\Gamma \left(\beta +{n}_{g,.,k}\right)}{\Gamma (G\beta +{\sum }_{g}{n}_{g,.,k})}$$\end{document}</tex-math><mml:math id="M164" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>G</mml:mi><mml:mi>β</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">Note that we can recover the expected values for <inline-formula id="IEq51"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq51.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq52"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upphi}}}_{k}$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq52.gif"/></alternatives></inline-formula>’s given the posterior estimates of <inline-formula id="IEq53"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,m}{\prime}s$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq53.gif"/></alternatives></inline-formula> as they are proportional to the unnormalized counts <inline-formula id="IEq54"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}={\sum }_{i}[{z}_{i,m}=k]$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq54.gif"/></alternatives></inline-formula> and <inline-formula id="IEq55"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}={\sum }_{m}\left[{z}_{i,m}=k,{x}_{i,m}=g\right]$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq55.gif"/></alternatives></inline-formula>, respectively.</p>
      <p id="Par37">The conditional distribution of the topic assignment for read <inline-formula id="IEq56"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M176"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq56.gif"/></alternatives></inline-formula> and cell <inline-formula id="IEq57"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M178"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq57.gif"/></alternatives></inline-formula> has a closed form expression:<disp-formula id="Equc"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(z_{i,m}=k\vert{x_{i,m}=g,z}^{-\left(i,m\right)},x^{-\left(i,m\right)}\right)\propto p\left(z_{i,m}=k,z^{-\left(i,m\right)}\vert\alpha_{m,k}\right)p\left(x_{i,m}=g,x^{-\left(i,m\right)}\vert z_{i,m}=k,z^{-\left(i,m\right)}\right)\propto\frac{\prod_k\Gamma\left(\alpha_{m,k}+n_{.,m,k}\right)}{\Gamma(\sum_k\alpha_{m,k}+n_{.,m,k})}\prod_k\frac{\prod_g\Gamma\left(\beta+n_{g,.,k}\right)}{\Gamma(G\beta+\sum_gn_{g,.,k})}\propto\prod_{{}_{k'\neq k}}\;\Gamma\left(\alpha_{m,k'}+n_{.,m,k'}^{\left(-i\right)}\right)\Gamma\left(\alpha_{m,k}+n_{.,m,k}^{\left(-i\right)}+1\right)\prod_{{}_{k'\neq k}}\;\frac{\prod_g\Gamma\left(\beta+n_{g,.,k}^{-\left(i,m\right)}\right)}{\Gamma(G\beta+\sum_gn_{g,.,k}^{-\left(i,m\right)})}\frac{\Gamma\left(\beta+n_{g,.,k}^{-\left(i,d\right)}+1\right)}{\Gamma(G\beta+\sum_gn_{g,.,k}^{-\left(i,d\right)}+1)}\propto\prod_k\Gamma\left(\alpha_{m,k'}+n_{.,m,k'}^{\left(-i\right)}\right)\left(\alpha_{m,k}+n_{.,m,k}^{\left(-i\right)}\right)\prod_k\frac{\prod_g\Gamma\left(\beta+n_{g,.,k}^{-\left(i,m\right)}\right)}{\Gamma(G\beta+\sum_gn_{g,.,k}^{-\left(i,m\right)})}\frac{\beta+n_{g,.,k}^{-\left(i,d\right)}}{G\beta+\sum_gn_{g,.,k}^{-\left(i,d\right)}}\propto\left(\alpha_{m,k}+n_{.,m,k}^{\left(-i\right)}\right)\left(\frac{\beta+n_{g,.,k}^{-\left(i,m\right)}}{G\beta+\sum_gn_{g,.,k}^{-\left(i,m\right)}}\right)$$\end{document}</tex-math><mml:math id="M180" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup></mml:mfenced><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup></mml:mfenced><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:msub><mml:mrow/><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mspace width="0.277778em"/><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:munder><mml:mo>∏</mml:mo><mml:msub><mml:mrow/><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mspace width="0.277778em"/><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where the second last equality exploits the property of the Gamma function, i.e., <inline-formula id="IEq58"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma \left(x+1\right)=\Gamma \left(x\right)x$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq58.gif"/></alternatives></inline-formula>. Here <inline-formula id="IEq59"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}^{(-i)}$$\end{document}</tex-math><mml:math id="M184"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq59.gif"/></alternatives></inline-formula> is the total number of scRNA-seq reads allocated for topic <italic>k</italic> for cell <italic>m</italic> without counting the current <italic>i</italic>th read, and <inline-formula id="IEq60"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}^{-\left(i,m\right)}$$\end{document}</tex-math><mml:math id="M186"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq60.gif"/></alternatives></inline-formula> is the total read counts for gene <italic>g</italic> under topic <italic>k</italic> across all of the <italic>M</italic> cells, without counting the current <italic>i</italic>th read in the <italic>m</italic>th cell:<disp-formula id="Equd"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{.,m,k}^{(-i)}=\sum_{i'\neq i}^{N_m}{\lbrack z}_{i',m}=k\rbrack$$\end{document}</tex-math><mml:math id="M188" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{g,.,k}^{-\left(i,m\right)}=\sum_{{}_{m'\neq m\mathrm{or}i'\neq i}}\;\left[z_{i',m'}=k,x_{i',m'}=g\right]$$\end{document}</tex-math><mml:math id="M190" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mrow/><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>m</mml:mi><mml:mi mathvariant="normal">or</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mspace width="0.277778em"/><mml:mfenced close="]" open="["><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">From here, the topic inference can be done by collapsed Gibbs sampling from <inline-formula id="IEq61"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({z}_{i,m}=k|{z}^{-\left(i,m\right)},x\right)$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq61.gif"/></alternatives></inline-formula>, while fixing the topic assignments for all other reads [<xref ref-type="bibr" rid="CR61">61</xref>]. For a large number of cells in the scRNA-seq data, the collapsed Gibbs sampling approach tends to be slow in reaching an equilibrium state. Therefore, we took a deterministic mean-field variational inference approach, known as the collapsed variational Bayes (CVB) [<xref ref-type="bibr" rid="CR62">62</xref>]. Specifically, we approximate the posterior distribution of the cell-type assignment <inline-formula id="IEq62"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({z}_{i.m}\right|\mathbf{x},{{\varvec{\upalpha}}}_{m})$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close="|" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq62.gif"/></alternatives></inline-formula> via the variational categorical distribution <inline-formula id="IEq63"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q\left({z}_{i,m} \right|{ x}_{i,m}=g$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi>q</mml:mi><mml:mfenced close="|" open="("><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq63.gif"/></alternatives></inline-formula>) = <inline-formula id="IEq64"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\prod_{k}{\gamma }_{i,m,k}^{\left[{z}_{i,m}=k\right]}$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:msub><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close="]" open="["><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq64.gif"/></alternatives></inline-formula>, where<disp-formula id="Equf"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{i,m,k }\propto \left({\alpha }_{m,k }+{n}_{.,m,k}^{(-i)} \right)\left(\frac{\beta + {n}_{g,.,k}^{-\left(i,m\right)}}{G{\beta }+{\sum }_{g}{n}_{g,.,k}^{-(i,m)}}\right)$$\end{document}</tex-math><mml:math id="M200" display="block"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">Using the variational parameters for the topic assignments, the above sufficient statistics are replaced by the soft counts:<disp-formula id="Equg"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{.,m,k}^{\left(-i\right)}=\sum_{i'\neq i}^{N_m}\;\gamma_{i',m,k}$$\end{document}</tex-math><mml:math id="M202" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:munderover><mml:mspace width="0.277778em"/><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{g,.,k}^{-\left(i,m\right)}=\sum_{m'\neq m\mathrm{or}i'\neq i}\;\left[x_{i',m'}=g\right]\alpha_{m,k}\gamma_{i',m',k}$$\end{document}</tex-math><mml:math id="M204" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>m</mml:mi><mml:mi mathvariant="normal">or</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.277778em"/><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mfenced><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par40">Here in updating the global gene distribution in the second equation, we further make use of the CTS prior <inline-formula id="IEq65"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq65.gif"/></alternatives></inline-formula> to obtain more interpretable results.</p>
      <p id="Par41">The above topic inference formulation operates at the level of read. For computational efficiency, our actual implementation of the topic inference was simplified to operate at the level of gene instead of the level of read:<disp-formula id="Equi"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,m,k }\propto \left({\alpha }_{m,k }+{n}_{.,m,k}^{(-g)} \right)\left(\frac{\beta + {n}_{g,.,k}^{(-m)}}{G{\beta }+\sum_{g}{n}_{g,.,k}^{(-m)}}\right)$$\end{document}</tex-math><mml:math id="M208" display="block"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">Similar to the above sufficient statistics, <inline-formula id="IEq66"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}^{(-g)}= \sum_{{g}{\prime}\ne g}{\gamma }_{{g}{\prime},m,k}$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq66.gif"/></alternatives></inline-formula> is the total number of scRNA-seq reads allocated for topic <italic>k</italic> for cell <italic>m</italic>, and <inline-formula id="IEq67"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}^{\left(-m\right)}= \sum_{{m}{\prime}\ne m}{{\alpha }_{m,k}\gamma }_{{g,m}{\prime},k}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>m</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq67.gif"/></alternatives></inline-formula> is the total read counts for gene <italic>g</italic> under topic <italic>k</italic> across all of the <italic>M</italic> cells, without counting the <italic>g</italic>th gene for cell <italic>m</italic>. This is equivalent to a reasonable assumption that all the reads from the same gene for the same cell are originated from the same cell type, i.e., <inline-formula id="IEq68"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\forall }_{i,{i}{\prime}} {z}_{i,m}={z}_{{i}{\prime},m}$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:msub><mml:mo>∀</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq68.gif"/></alternatives></inline-formula> if <inline-formula id="IEq69"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,m}={x}_{{i}{\prime},m}$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq69.gif"/></alternatives></inline-formula>.</p>
      <p id="Par43">Together, the inference algorithm alternates between two simple steps: (1) for each cell and each gene, perform coordinate ascent by computing <inline-formula id="IEq70"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,m,k}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq70.gif"/></alternatives></inline-formula> while fixing the variational parameters <inline-formula id="IEq71"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{{g}{\prime},m,k}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq71.gif"/></alternatives></inline-formula> for other genes <inline-formula id="IEq72"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${g}{\prime}$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq72.gif"/></alternatives></inline-formula>; (2) update the sufficient statistics. This algorithm maximizes the evidence lower bound <inline-formula id="IEq73"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ELBO={E}_{q}\left[\mathrm{log}p\left(x|z\right)\right]+{E}_{q}[\mathrm{log}p(z|\alpha )]-{E}_{q}[\mathrm{log}q\left(z|\gamma \right)]$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">log</mml:mi><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mi>q</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>γ</mml:mi></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq73.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR62">62</xref>]. The model is deemed converged when ELBO stops improving by a small threshold (1e<sup>−6</sup> by default).</p>
      <p id="Par44">Upon convergence, the expected values for <inline-formula id="IEq74"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{\mathrm{m},\mathrm{k}}$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,k}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq75.gif"/></alternatives></inline-formula> are:<disp-formula id="Equj"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}_{q}\left[{\theta }_{m,k}\right]= \frac{{{\alpha }_{m,k}+n}_{.,m,k}}{{\sum }_{k}{{\alpha }_{m,k}+n}_{.,m,k}}\equiv {\widehat{\theta }}_{\mathrm{m},\mathrm{k}}; {\mathbb{E}}_{q}\left[{\phi }_{\mathrm{g},\mathrm{k}}\right]=\frac{\beta +{n}_{g,.,k}}{G\beta +{\sum }_{g}{n}_{g,.,k}}\equiv {\widehat{\phi }}_{\mathrm{g},\mathrm{k}}$$\end{document}</tex-math><mml:math id="M230" display="block"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≡</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≡</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq76"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,m,k}={\sum }_{i=1}^{{N}_{m}}{\gamma }_{i,m,k}$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{g,.,k}=\sum_{m=1}^{M}[{x}_{i,m}=g]{\alpha }_{m,k}{\gamma }_{i,m,k}$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq77.gif"/></alternatives></inline-formula>. Here <inline-formula id="IEq78"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\{\widehat{\theta }}_{\mathrm{m},\mathrm{k}}\}}_{M\times K}=\widehat{\Theta }$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq78.gif"/></alternatives></inline-formula> can be used to assess the “purity” of the single cells as a quality control step and <inline-formula id="IEq79"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\{\widehat{\phi }}_{\mathrm{g},\mathrm{k}}\}}_{\mathrm{G}\times \mathrm{K}}=\widehat{{\varvec{\Phi}}}$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq79.gif"/></alternatives></inline-formula> probabilities are used as the CTS topics in the subsequent deconvolution step.</p>
    </sec>
    <sec id="Sec18">
      <title>Inferring multiple topics per cell type</title>
      <p id="Par45">Suppose we use <inline-formula id="IEq80"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M240"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq80.gif"/></alternatives></inline-formula> topics per cell type for <inline-formula id="IEq81"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M242"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq81.gif"/></alternatives></inline-formula> cell types, the hyperparameter <inline-formula id="IEq82"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq82.gif"/></alternatives></inline-formula> for cell <inline-formula id="IEq83"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M246"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq83.gif"/></alternatives></inline-formula> can be formulated into a <inline-formula id="IEq84"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times L$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq84.gif"/></alternatives></inline-formula> matrix. Given that the cell-type label for cell <inline-formula id="IEq85"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M250"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq85.gif"/></alternatives></inline-formula> is <inline-formula id="IEq86"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}=k$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq86.gif"/></alternatives></inline-formula>, we set the <italic>k</italic>th row of <inline-formula id="IEq87"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq87.gif"/></alternatives></inline-formula> to relatively high values and the rest of the <italic>K</italic>-1 rows to relatively low values. For example, suppose we have 5 cell types and 3 sub-topics per cell type. If cell <inline-formula id="IEq88"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M256"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq88.gif"/></alternatives></inline-formula> is labeled with cell type 2, then the topic prior hyperparameter matrix <inline-formula id="IEq89"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq89.gif"/></alternatives></inline-formula> can be set to the following values: [0.01, 0.01, 0.01; 0.9, 0.9, 0.9; 0.01, 0.01, 0.01; 0.01, 0.01, 0.01; 0.01, 0.01, 0.01], where comma separates the columns and semicolons separate the rows. Here, the 3 topic prior values in the second row corresponding to cell type 2 are set to 0.9 and the values in the remaining rows are set to 0.01.</p>
      <p id="Par46">The data generative process is identical to the basic GTM-decon except having <inline-formula id="IEq90"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times L$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq90.gif"/></alternatives></inline-formula> topics instead of <inline-formula id="IEq91"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M262"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq91.gif"/></alternatives></inline-formula> topics. Specifically, to sample the cell-type mixture <inline-formula id="IEq92"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq92.gif"/></alternatives></inline-formula>, we flatten the <inline-formula id="IEq93"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times L$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq93.gif"/></alternatives></inline-formula> matrix for <inline-formula id="IEq94"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\upalpha}}}_{m}$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq94.gif"/></alternatives></inline-formula> to have a row vector of <inline-formula id="IEq95"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\times \left(K\times L\right)$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq95.gif"/></alternatives></inline-formula> so that the <inline-formula id="IEq96"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{m}}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq96.gif"/></alternatives></inline-formula> will have relatively high expected value for the <inline-formula id="IEq97"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{m}^{th}$$\end{document}</tex-math><mml:math id="M274"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq97.gif"/></alternatives></inline-formula> consecutive <italic>L</italic> values that correspond to the labeled cell type and relatively low expected value for the rest of the entries. We experimented modeling each cell type using <inline-formula id="IEq98"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\in \{2, 3, 4, 5\}$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq98.gif"/></alternatives></inline-formula> topics per cell type, with the hyperparameters <inline-formula id="IEq99"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{m,k}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq99.gif"/></alternatives></inline-formula> for each cell of cell type <inline-formula id="IEq100"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M280"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq100.gif"/></alternatives></inline-formula> set to 0.45, 0.3, 0.22, and 0.18, respectively. The prior values for the remaining topics were assigned with random values between 0.001 and 0.01. These priors were heuristically chosen based on the hyperparameter of value 0.9 for one topic divided by the number of topics per cell type.</p>
    </sec>
    <sec id="Sec19">
      <title>Inferring mixing cell-type proportions in bulk transcriptome</title>
      <p id="Par47">We assume a similar data generative process of the bulk transcriptome as the single-cell transcriptome described above. In particular, each bulk sample <inline-formula id="IEq101"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j\in \{1,..,D\}$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq101.gif"/></alternatives></inline-formula> is a mixture of <inline-formula id="IEq102"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M284"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq102.gif"/></alternatives></inline-formula> cell types. Its cell-type mixture <inline-formula id="IEq103"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{j}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq103.gif"/></alternatives></inline-formula> is sampled from a K-dimensional symmetric Dirichlet distribution <inline-formula id="IEq104"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{j}}\sim \mathrm{Dir}({\varvec{\upalpha}})$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Dir</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq104.gif"/></alternatives></inline-formula> with the hyperparameter fixed at a constant value across all <italic>K</italic> cell types (default: <inline-formula id="IEq105"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{k}=0.1\forall k$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>∀</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq105.gif"/></alternatives></inline-formula>). The flat hyperparameter value is used here since we typically do not have any prior information about the cell-type mixtures in the bulk RNA-seq data. For <inline-formula id="IEq106"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{j}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq106.gif"/></alternatives></inline-formula> total RNA-seq reads of bulk sample <italic>j</italic>, each read <inline-formula id="IEq107"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \{1,\dots ,{N}_{j}\}$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq107.gif"/></alternatives></inline-formula> originates from one of the <inline-formula id="IEq108"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M296"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq108.gif"/></alternatives></inline-formula> cell types with the categorical rates set to be <inline-formula id="IEq109"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{\mathrm{j}}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq109.gif"/></alternatives></inline-formula>: <inline-formula id="IEq110"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,j}\sim \mathrm{Cat}({{\varvec{\uptheta}}}_{j})$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq110.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq111"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{i,j}\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq111.gif"/></alternatives></inline-formula>, and maps to a specific gene indexed by <inline-formula id="IEq112"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,j}\in \{1,\dots ,G\}$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq112.gif"/></alternatives></inline-formula> with a <italic>known</italic> CTS categorical rates <inline-formula id="IEq113"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{{\varvec{\upphi}}}}_{{z}_{i,j}}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq113.gif"/></alternatives></inline-formula>: <inline-formula id="IEq114"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i,j}\sim \mathrm{Cat}({\widehat{{\varvec{\upphi}}}}_{{z}_{i,j}})$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Cat</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">ϕ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq114.gif"/></alternatives></inline-formula>.</p>
      <p id="Par48">Performing deconvolution on a bulk transcriptome profile is equivalent to inferring the posterior distribution of the CTS topic mixture given its gene expression and the CTS topic distributions: <inline-formula id="IEq115"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{p}({\varvec{\uptheta}}}_{\mathrm{j}}|{\mathbf{x}}_{j},\widehat{\Phi }$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq115.gif"/></alternatives></inline-formula>). To this end, we used the <inline-formula id="IEq116"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{G}\times K$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq116.gif"/></alternatives></inline-formula> genes-by-CTS-topic estimates <inline-formula id="IEq117"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\Phi }$$\end{document}</tex-math><mml:math id="M314"><mml:mover accent="true"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq117.gif"/></alternatives></inline-formula> inferred from the scRNA-seq reference data (described in section “<xref rid="Sec17" ref-type="sec">Modeling scRNA-seq reference data via topic inference guided by cell-type labels</xref>”) and perform variational inference to infer the cell-type mixture <inline-formula id="IEq118"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\uptheta}}}_{j}$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq118.gif"/></alternatives></inline-formula> for the <italic>j</italic>th bulk RNA-seq profile. Implementation-wise, similar to the scRNA-seq topic modeling, we also use the simplified topic inference algorithm at the gene level <inline-formula id="IEq119"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g\in \{1,\dots ,G\}$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq119.gif"/></alternatives></inline-formula> as opposed to at read level. This involves alternating between the topic assignment inference for <inline-formula id="IEq120"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,j,k}$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq120.gif"/></alternatives></inline-formula> and computing the sufficient statistics <inline-formula id="IEq121"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,j,k}^{-\left(g\right)}$$\end{document}</tex-math><mml:math id="M322"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>g</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq121.gif"/></alternatives></inline-formula> while fixing <inline-formula id="IEq122"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\Phi }$$\end{document}</tex-math><mml:math id="M324"><mml:mover accent="true"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq122.gif"/></alternatives></inline-formula>. Algorithmically, for each gene, we infer the topic assignments:<disp-formula id="Equk"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{g,j,k }\propto \left({\alpha }+{n}_{.,j,k}^{(-g)} \right){\widehat{\phi }}_{g,k}$$\end{document}</tex-math><mml:math id="M326" display="block"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equk.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq123"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{.,j,k}^{(-g)}= \sum_{{g}{\prime}\ne g}{\gamma }_{{g}{\prime},j,k}$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq123.gif"/></alternatives></inline-formula>. Upon convergence, we compute the expected CTS-topic mixture:<disp-formula id="Equl"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}_{q}\left[{\theta }_{j,k}\right]= \frac{{\alpha +n}_{.,j,k}}{K\alpha +{\sum }_{k}{n}_{.,j,k}}$$\end{document}</tex-math><mml:math id="M330" display="block"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>K</mml:mi><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">The bulk sample is transformed in the same way as the scRNA-seq reference data as described in the “<xref rid="Sec24" ref-type="sec">Preprocessing the reference scRNA-seq data</xref>” section.</p>
      <p id="Par50">We also show that although GTM-decon infers RNA fractions instead of cell-type fractions, the correlation between the RNA fractions and cell-fractions is strong across cell types in multiple datasets, suggesting that RNA fractions per cell type can serve as a good surrogate to the cell fraction per cell type despite the potential differences in cell sizes among cell types (described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S9 and illustrated in Fig. S31).</p>
    </sec>
    <sec id="Sec20">
      <title>Sparsification of the bulk data to directly infer topic distributions from them</title>
      <p id="Par51">In order to identify de novo topics that are not present in the reference scRNA-seq data, we applied standard LDA using the CVB implementation from MixEHR [<xref ref-type="bibr" rid="CR59">59</xref>] to the sparsified bulk RNA-seq data. However, bulk RNA-seq data is a dense matrix with most genes having non-zero entries while topic models excel at modeling sparse matrices (e.g., scRNA-seq data). To make the bulk RNA-seq data amenable to our approach, we sparsified the dense matrix by setting all values below the 75th percentile to 0. This cutoff was derived from scRNA-seq datasets, where on average 25% of genes in a cell have non-zero count values. While sparsifying works well in our applications, as a caveat, we acknowledge that it will lead to information loss. We also experimented with two other approaches to sparsify the matrix: (1) training GTM-decon only using HVG genes in bulk RNA-seq data; (2) training GTM-decon using differentially expressed genes identified between the phenotypes using DESeq2 [<xref ref-type="bibr" rid="CR64">64</xref>].</p>
      <p id="Par52">Note that the sparsification procedure was done on the bulk data only when we directly inferred gene topic distributions from them, which pertains to the de novo topic inference from bulk samples, phenotype-guided topic inference from the bulk, and nest-guided CTS-phenotype topic inference. All of the deconvolution experiments, where we first inferred topics from a single-cell reference dataset and then applied the inferred topics to deconvolve bulk data, does not involve the sparsification procedure (i.e., deconvolving the original bulk transcriptomes as they are).</p>
    </sec>
    <sec id="Sec21">
      <title>Identifying statistically significant marker genes per cell type</title>
      <p id="Par53">After GTM-decon topic inference, marker genes for each cell type were identified using permutation test. Specifically, for gene <italic>g</italic> under topic <italic>k</italic>, we computed the difference of its topic score <inline-formula id="IEq124"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,k}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq124.gif"/></alternatives></inline-formula> from the average topic score over the rest of the <italic>K</italic>-1 topics <inline-formula id="IEq125"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,{k}{\prime}\ne k}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq125.gif"/></alternatives></inline-formula>. For example, for 3 cell types, the test statistic for cell type 1 is calculated as <inline-formula id="IEq126"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,1}-\left({\phi }_{g,2}+{\phi }_{g,3}\right)/2$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq126.gif"/></alternatives></inline-formula>. More generally, for <italic>K</italic> cell types and <italic>T</italic> topics per cell topic, the test statistic for cell type <italic>k</italic> and gene <italic>g</italic> is<disp-formula id="Equm"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{T}\left(\sum_{t=1}{\phi }_{k,g}^{\left\{t\right\}}- \frac{1}{K-1} \sum_{{k}{\prime}\ne k}\sum_{t=1}{\phi }_{{k}{\prime},g}^{\left\{t\right\}}\right)$$\end{document}</tex-math><mml:math id="M338" display="block"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mfenced close=")" open="("><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mfenced close="}" open="{"><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mfenced close="}" open="{"><mml:mi>t</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_3034_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">The significance of the observed statistic is compared against the same statistic calculated from 100,000 permutations. The empirical <italic>p</italic>-value is computed as fraction of permutations, where the test statistic is greater than the observed value.</p>
    </sec>
    <sec id="Sec22">
      <title>Evaluation of deconvolution accuracy using simulated and real bulk data</title>
      <p id="Par55">We evaluated the deconvolution accuracy by comparing the inferred cell-type proportions against the ground truth values for the datasets. First, we simulated bulk RNA-seq data using the scRNA-seq dataset. We summed the gene expression counts of each sample from the scRNA-seq data to represent the bulk data of that sample (artificial bulk transcriptome). The ground-truth cell-type proportions are the fraction of cells for each cell type. To avoid information bias in the evaluation, we performed leave-one-out cross-validation (LOOCV) by inferring topics from scRNA-seq data for <italic>N</italic> − 1 subjects as the training examples and deconvolving the held-out subject as the validation example. The results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10.</p>
      <p id="Par56">In addition, we also used real bulk data with known cell-type proportion to benchmark our methods. To conduct different benchmarking and qualitative experiments, we used scRNA-seq datasets from several tissues for training GTM-decon (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1): <bold>a</bold> human pancreas (E-MTAB-5061, GSE81433) (with 4 type 2 diabetes and 3 healthy subjects) and mouse (GSE81433); <bold>b</bold> Peripheral blood mononucleocytes (PBMC) of healthy human (GSE132044); <bold>c</bold> human blood cells (HBC) of healthy humans (GSE149938); <bold>d</bold> post-mortem brain tissue of frontal cortex from adult human (GSE97930); <bold>e</bold> Breast tissue from healthy individuals (GSE113197). Apart from healthy individuals, scRNA-seq references from patients with <bold>a</bold> pancreatic cancer (CRA001160) and <bold>b</bold> breast cancer (GSE176078) were used to deconvolve cancer bulk RNA-seq datasets.</p>
      <p id="Par57">Bulk RNA-seq datasets with known ground truth values were chosen for benchmarking (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Datasets with known ground truth proportions from flow cytometry include <bold>a</bold> whole blood from 12 individuals (obtained from CIBERSORTx webpage), <bold>b</bold> PBMC from a cohort of 13 individuals (GSE107011), <bold>c</bold> PBMC from a cohort of 346 individuals (SDY67). For brain tissue, ground truth proportions from immunohistochemistry were available for a cohort of 41 individuals from the Religious Orders Study / Memory and Aging Project (ROSMAP) study (CortexCellDeconv). A unique dataset with both bulk RNA-seq data and scRNA-seq data from pancreas was accessed from E-MTAB-5060 and E-MTAB-5061, respectively, with the cell type proportions from scRNA-seq considered as ground truth values.</p>
      <p id="Par58">For the 3 immune (SDY67, whole blood, PBMC S13 cohort) and brain prefrontal cortex (ROSMAP) bulk datasets, we used two independent single-cell references with the most closely matched tissues of origin (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For the pancreatic dataset (Segerstolpe), paired single-cell and bulk data from the same individuals were used in the LOOCV manner, where we used the cell-type proportions from the single-cell dataset to compare the estimated proportions from the paired bulk data in the same held-out subject.</p>
      <p id="Par59">To evaluate the concordance between the ground truth <inline-formula id="IEq127"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{y}}_{m}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi mathvariant="normal">y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq127.gif"/></alternatives></inline-formula> and our inferred cell-type mixture <inline-formula id="IEq128"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uptheta }_{m}$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq128.gif"/></alternatives></inline-formula> for each test sample <italic>m</italic>, we computed four common metric scores: (1) Pearson correlation coefficient (PCC), (2) Spearman correlation (SCC), (3) cross entropy (CE), and (4) residual mean squared error (RMSE) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Moreover, we also evaluated the deconvolution performance at each cell type using PCC and RMSE across samples (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S11-15).</p>
      <p id="Par60">For the qualitative analyses on the cancer datasets, the bulk RNA-seq datasets for pancreatic cancer (PAAD) and breast cancer (BRCA) datasets from TCGA were downloaded from the GDC data portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</ext-link>). Similarly, bulk RNA-seq data from the pancreas of a cohort of 89 normal and diabetic individuals was obtained from GSE50244.</p>
    </sec>
    <sec id="Sec23">
      <title>Implementation of the existing deconvolution methods</title>
      <p id="Par61">We compared GTM-decon with other state-of-the-art methods, including BSEQ-sc, BISQUE, MuSiC, CIBERSORTx, and BayesPrism. For BSEQ-sc, marker genes were selected from CellmarkerDB for the brain and immune datasets, while the built-in pancreatic marker genes were used for the Segerstolpe dataset. BISQUE requires at least two paired reference bulk and reference single-cell samples, which is the case for the Segerstolpe dataset. When using human blood cell (HBC) scRNA-seq data as a reference, in order to use BISQUE, artificial bulk samples were constructed using single-cell data. For the other 3 bulk datasets, since we used only one scRNA-seq reference, we left out BISQUE from the evaluation. For CIBERSORTx, all genes were provided to the web portal (<ext-link ext-link-type="uri" xlink:href="https://cibersortx.stanford.edu/">https://cibersortx.stanford.edu/</ext-link>) for Signature Matrix generation and Cell Fraction imputation. For BayesPrism, all genes were provided to the web portal (<ext-link ext-link-type="uri" xlink:href="https://www.bayesprism.org/">https://www.bayesprism.org/</ext-link>) for cell type composition estimation, with the metadata column for tumor status set to 0 for all cells.</p>
    </sec>
    <sec id="Sec24">
      <title>Preprocessing the reference scRNA-seq data</title>
      <p id="Par62">The gene expression profiles of scRNA-seq data were used as training data. Since the performance of GTM-decon may vary depending on how the scRNA-seq count data are processed, we explored different gene selection and transformations of the scRNA-seq data. Specifically, the following gene selection were considered:<list list-type="simple"><list-item><label>(i)</label><p id="Par63"><italic>all</italic>: all genes without removal of any gene;</p></list-item><list-item><label>(ii)</label><p id="Par64"><italic>pp</italic>: preprocessed genes to remove uninformative genes (frequently expressed genes—found in ≥ 80% of cells, infrequently expressed genes—found in ≤ 5 cells);</p></list-item><list-item><label>(iii)</label><p id="Par65"><italic>hvg:</italic> highly variable genes identified using the highly_variable_genes (HVG) function of scanpy [<xref ref-type="bibr" rid="CR65">65</xref>].</p></list-item></list></p>
      <p id="Par66">Furthermore, for each of these gene sets, the following transformation were considered:<list list-type="simple"><list-item><label>(i)</label><p id="Par67"><italic>raw count</italic> (all / pp / hvg)—scRNA-seq read counts per gene;</p></list-item><list-item><label>(ii)</label><p id="Par68"><italic>normr</italic> (all_normr / pp_normr / hvg_normr)—normalize counts (while excluding highly expressed genes for calculating the normalization factor) as counts divided by the sum of counts per cell multiplied by a scaling factor of 10,000 (a commonly used factor for scRNA-seq data [<xref ref-type="bibr" rid="CR66">66</xref>]), and round the values to their nearest integer to make the input suitable for topic modeling;</p></list-item><list-item><label>(iii)</label><p id="Par69"><italic>normr_log1p</italic> (all_normr_log1p / pp_normr_log1p / hvg_normr_log1p): log-transform normalized counts in (ii), and round the values to their nearest integer to make the input suitable for topic modeling.</p></list-item></list></p>
    </sec>
    <sec id="Sec25">
      <title>Gene set enrichment analysis (GSEA)</title>
      <p id="Par70">GSEA was performed using the fgsea package from R, on two different gene sets: (a) gene sets corresponding to specific cell types from CellMarkerDB [<xref ref-type="bibr" rid="CR30">30</xref>]; (b) gene set corresponding to the HALLMARK pathways from MSigDb using msigdbr [<xref ref-type="bibr" rid="CR67">67</xref>].</p>
    </sec>
    <sec id="Sec26">
      <title>Survival analysis</title>
      <p id="Par71">For TCGA datasets, after cell-type proportions are inferred using GTM-decon, survival analysis is performed using the survival and survminer R packages in order to assess if there is any correlation between survival probability of the cancer subjects and cell-type proportions for the cell types. Kaplan–Meier curves were generated for those cell types, where the association is deemed statistically significant at <italic>p</italic>-value &lt; 0.05 based on log-rank test.</p>
    </sec>
    <sec id="Sec27">
      <title>Learning phenotype-specific gene signatures from bulk RNA-seq data</title>
      <p id="Par72">To identify phenotype-specific genes, we applied GTM-decon to directly infer phenotype-topics from the sparsified bulk RNA-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). To evaluate phenotype prediction accuracy, we randomly split the bulk RNA-seq samples into training and test datasets in 80:20 ratio. The training dataset is guided in a manner similar to GTM-decon for the scRNA-seq datasets. Briefly, for each subject, the hyperparameter(s) for the topic(s) corresponding to the observed phenotype was (were) set to the prior value of 0.9, and the hyperparameters for the rest of the topics were set to a small value between 0.01 and 0.1. Since a model of 5 topics per cell type worked well for several scRNA-seq datasets, we opted to model each phenotype by 5 topics as well. For the subjects in the 20% test data, we summed up the inferred phenotype mixture <inline-formula id="IEq129"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{d,k}$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq129.gif"/></alternatives></inline-formula> values for all topics corresponding to the same phenotype. The predicted phenotype was the one with the highest summed up topic score. As a comparison, we also evaluated two other common machine learning methods namely logistic regression and random forest. We used their scikit-learn implementations with the default settings [<xref ref-type="bibr" rid="CR68">68</xref>].</p>
    </sec>
    <sec id="Sec28">
      <title>Identifying CTS DE genes from bulk transcriptomes from nested-guided topics</title>
      <p id="Par73">In identifying phenotype-specific differentially expressed genes, we developed a way to leverage the CTS topics inferred from the scRNA-seq reference data by fine-tuning the CTS topics based on gene expression from the sparsified bulk RNA-seq data for different phenotypes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). Specifically, we initialized the genes-by-topic matrix <inline-formula id="IEq130"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Phi }_{d}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq130.gif"/></alternatives></inline-formula> for <italic>each</italic> phenotype <italic>d</italic>. For example, for <inline-formula id="IEq131"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D=3$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq131.gif"/></alternatives></inline-formula> phenotypes in a tissue with <inline-formula id="IEq132"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=5$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq132.gif"/></alternatives></inline-formula> cell types, we will have 15 topics, comprising of 3 sets of CTS <inline-formula id="IEq133"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Phi }_{\mathrm{d}}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq133.gif"/></alternatives></inline-formula> matrices of 5 columns each. These matrices are guided by the phenotype labels during the variational inference.</p>
      <p id="Par74">For subject <italic>j</italic>, suppose his/her phenotype label is <italic>d</italic>
<inline-formula id="IEq134"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d\in \{1,..,D\}$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq134.gif"/></alternatives></inline-formula>. The topic hyperparameters <inline-formula id="IEq135"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{j,d,k}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq135.gif"/></alternatives></inline-formula>’s for all the <italic>K</italic> topics corresponding to the phenotype label <italic>d</italic> were set to 0.9, and the <inline-formula id="IEq136"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{j,{d}{\prime},k}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq136.gif"/></alternatives></inline-formula> for the other phenotypes were set to a small value between 0.01 and 0.1. These values were propagated throughout the variational inference, guiding the phenotypic inference appropriately. The inference algorithm is identical to the one described in “<xref rid="Sec17" ref-type="sec">Modeling scRNA-seq reference data via topic inference guided by cell-type labels</xref>” section for modeling the scRNA-seq data. This approach also works with single-cell transcriptomes from a disease study such as the single-cell breast cancer study, where we not only have the cell type information but also phenotype states of the subjects (i.e., ER + vs TNBC) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S8 and Fig. S30).</p>
      <p id="Par75">From the learned matrix, the test statistic of a DE candidate gene <italic>g</italic> between phenotypes <italic>d</italic> and <inline-formula id="IEq137"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}{\prime}\ne d$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mi>d</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq137.gif"/></alternatives></inline-formula> per cell type <italic>k</italic> were identified by subtracting the <inline-formula id="IEq138"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,d,k}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq138.gif"/></alternatives></inline-formula> value for phenotype <inline-formula id="IEq139"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M364"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq139.gif"/></alternatives></inline-formula> from the <inline-formula id="IEq140"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{g,{d}{\prime},k}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq140.gif"/></alternatives></inline-formula> value for phenotype <inline-formula id="IEq141"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}{\prime}$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq141.gif"/></alternatives></inline-formula>. We identify statistically significant genes with a <italic>p</italic>-value &lt; 0.05 by permutation test calculated from the 100,000 randomly shuffled <inline-formula id="IEq142"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Phi }_{d}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq142.gif"/></alternatives></inline-formula> matrices. The <italic>p</italic>-value is the fraction of times the null statistic from the permutations is greater than the observed test statistic. As a reference, we compared our approach against the DE genes identified from the same samples using DESeq2 [<xref ref-type="bibr" rid="CR64">64</xref>]. We identified hallmark pathways from MSigDb which were enriched for the DE genes by Over Representation Analysis (ORA) using the ClusterProfiler package from R [<xref ref-type="bibr" rid="CR69">69</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec29">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_3034_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary Section S1 (Evaluation on gene selection strategies); S2 (Evaluation on raw count and transformation strategies); S3 (Experimenting hyperparameters <inline-formula id="IEq143"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha_{\mathrm m,\mathrm k}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq143.gif"/></alternatives></inline-formula> for cell-type mixture prior); S4 (Experimenting hyperparameter <inline-formula id="IEq144"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M374"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3034_Article_IEq144.gif"/></alternatives></inline-formula> for CTS topics); S5 (Experimenting number of topics per cell type); S6 (Benchmark time and memory usage); S7 (Effect of sparsification on phenotype classification); S8 (Phenotype-CTS topic modeling of single-cell breast cancer transcriptomes for TCGA-BRCA bulk deconvolution); S9 (Effect of cell size on inference of cell-type deconvolution); Table S1-S3; Figure S1-S31.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_3034_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2. </bold>Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Yixuan Li for helping troubleshoot the GTM-decon software at its later stage.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par76">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par77">Andrew Cosgrove was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Y.L. conceived of the study. S.S. and Y.L. analyzed and interpreted the data, wrote the manuscript, and wrote the code for GTM-decon. M.H. ran the experiments on benchmarking the deconvolutional accuracy. Y.L. supervised the project. All authors approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Y.L. is supported by Canada Research Chair (Tier 2) in Machine Learning for Genomics and Healthcare, New Frontier Research Fund – Exploration (NFRFE-2019–00980), and Canada First Research Excellence Fund Healthy Brains for Healthy Life (HBHL) initiative New Investigator start-up award (G249591).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed during the current study were obtained from publicly available repositories or data portals. All the scRNA-seq datasets [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR70">70</xref>–<xref ref-type="bibr" rid="CR81">81</xref>] used for training in this study are listed in Table S<xref rid="MOESM1" ref-type="media">1</xref>, and all the bulk RNA-seq datasets with known ground truth proportions used in this study are listed in Table S<xref rid="MOESM1" ref-type="media">2</xref>. The Human pancreatic islet single-cell datasets from Segerstolpe et al. used in this study is available in the ArrayExpress database under the accession code E-MTAB-5061 [<xref ref-type="bibr" rid="CR82">82</xref>], with the corresponding bulk datasets accessible using E-MTAB-5060 [<xref ref-type="bibr" rid="CR83">83</xref>]. The Human and Mouse pancreatic islet datasets from Baron et al. used in this study are available in the GEO database under the accession code GSE84133 [<xref ref-type="bibr" rid="CR84">84</xref>]. The cancerous pancreatic tissue dataset is available in the Genome Sequence Archive database under the accession code CRA001160 [<xref ref-type="bibr" rid="CR85">85</xref>]. The normal breast tissue dataset is available in the GEO database under the accession code GSE113197 [<xref ref-type="bibr" rid="CR86">86</xref>]. The cancerous breast tissue dataset is available in the GEO database under the accession code GSE176078 [<xref ref-type="bibr" rid="CR87">87</xref>]. scRNA-seq dataset for PBMC is available from the Single Cell Portal as PBMC2 or at GSE132044 [<xref ref-type="bibr" rid="CR88">88</xref>], and the dataset for human blood cells at GSE149938 [<xref ref-type="bibr" rid="CR89">89</xref>]. Post-mortem brain frontal cortex from adult human is available under the accession code GSE97930 [<xref ref-type="bibr" rid="CR90">90</xref>]. The RA synovium dataset is available in the ImmPort database under the accession code SDY998 [<xref ref-type="bibr" rid="CR91">91</xref>]. The bulk RNA-seq dataset for normal and type 2 diabetes patients is available in the GEO database under the accession code GSE50244 [<xref ref-type="bibr" rid="CR92">92</xref>]. The bulk RNA-seq datasets for pancreatic cancer (PAAD) and breast cancer (BRCA) datasets from TCGA can be downloaded from the GDC data portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</ext-link>). Bulk RNA-seq datasets for PBMC can be accessed using the accession code GSE107011 [<xref ref-type="bibr" rid="CR93">93</xref>] from GEO database, and SDY67 [<xref ref-type="bibr" rid="CR94">94</xref>] from Immport database. The bulk dataset for purified immune cells can be accessed using the GEO identifier GSE64655 [<xref ref-type="bibr" rid="CR95">95</xref>].</p>
    <p>GTM-decon source codes have been deposited at the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/li-lab-mcgill/gtm-decon">https://github.com/li-lab-mcgill/gtm-decon</ext-link>) [<xref ref-type="bibr" rid="CR96">96</xref>]. The repository is licensed under the open-source GPL-3.0. The source code was also deposited at Zenodo: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8200316">https://doi.org/10.5281/zenodo.8200316</ext-link> [<xref ref-type="bibr" rid="CR97">97</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par78">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par79">Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par80">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J-W</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>J-A</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>K-H</given-names>
          </name>
        </person-group>
        <article-title>β-cell mass in people with type 2 diabetes</article-title>
        <source>J Diab Investig</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>6</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1111/j.2040-1124.2010.00072.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sasaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saisho</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Inaishi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tsuchiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Makio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nishikawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kitago</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Reduced beta cell number rather than size is a major contributor to beta cell loss in type 2 diabetes</article-title>
        <source>Diabetologia</source>
        <year>2021</year>
        <volume>64</volume>
        <fpage>1816</fpage>
        <lpage>1821</lpage>
        <pub-id pub-id-type="doi">10.1007/s00125-021-05467-7</pub-id>
        <?supplied-pmid 33938968?>
        <pub-id pub-id-type="pmid">33938968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Galen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hovestadt</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wadsworth Ii</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Griffin</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Battaglia</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Verga</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Stephansky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pastika</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lombardi Story</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq reveals AML hierarchies relevant to disease progression and immunity</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <fpage>1265</fpage>
        <lpage>1281.e1224</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.01.031</pub-id>
        <?supplied-pmid 30827681?>
        <pub-id pub-id-type="pmid">30827681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-Seq technologies and related computational data analysis</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>317</fpage>
        <lpage>317</lpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00317</pub-id>
        <?supplied-pmid 31024627?>
        <pub-id pub-id-type="pmid">31024627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Lönnberg</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title>
        <source>Genome medicine</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>75</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-017-0467-4</pub-id>
        <?supplied-pmid 28821273?>
        <pub-id pub-id-type="pmid">28821273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bang</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>
        <source>Exp Mol Med</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/s12276-018-0071-8</pub-id>
        <?supplied-pmid 30416196?>
        <pub-id pub-id-type="pmid">30416196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Berge</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hembach</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tiberi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>RNA sequencing data: Hitchhiker's guide to expression analysis</article-title>
        <source>Ann Rev Biomed Data Sci</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>139</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biodatasci-072018-021255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barkley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>França</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Yanai</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Cancer cell states and emergent properties of the dynamic tumor system</article-title>
        <source>Genome Res</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>1719</fpage>
        <lpage>1727</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.275308.121</pub-id>
        <?supplied-pmid 34599005?>
        <pub-id pub-id-type="pmid">34599005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis-Marcisak</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Deshpande</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein-O'Brien</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Laheru</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Fertig</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Kagohara</surname>
            <given-names>LT</given-names>
          </name>
        </person-group>
        <article-title>From bench to bedside: single-cell analysis for cancer immunotherapy</article-title>
        <source>Cancer Cell</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1062</fpage>
        <lpage>1080</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2021.07.004</pub-id>
        <?supplied-pmid 34329587?>
        <pub-id pub-id-type="pmid">34329587</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Madrigal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gomez-Cabrero</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cervera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Szcześniak</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Gaffney</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Elo</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A survey of best practices for RNA-seq data analysis</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>13</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0881-8</pub-id>
        <?supplied-pmid 26813401?>
        <pub-id pub-id-type="pmid">26813401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clough</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The Gene Expression Omnibus Database</article-title>
        <source>Methods Mol Biol (Clifton, NJ)</source>
        <year>2016</year>
        <volume>1418</volume>
        <fpage>93</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-4939-3578-9_5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Domrachev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lash</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title>
        <source>Nucleic Acids Res</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>207</fpage>
        <lpage>210</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/30.1.207</pub-id>
        <?supplied-pmid 11752295?>
        <pub-id pub-id-type="pmid">11752295</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Consortium GT</collab>
        </person-group>
        <article-title>The Genotype-Tissue Expression (GTEx) project</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>580</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id>
        <pub-id pub-id-type="pmid">23715323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hinoue</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Lazar</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Drill</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Cherniack</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Thorsson</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-of-origin patterns dominate the molecular classification of 10,000 tumors from 33 types of cancer</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>291</fpage>
        <lpage>304.e296</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.022</pub-id>
        <?supplied-pmid 29625048?>
        <pub-id pub-id-type="pmid">29625048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Computational deconvolution: extracting cell type-specific information from heterogeneous samples</article-title>
        <source>Curr Opin Immunol</source>
        <year>2013</year>
        <volume>25</volume>
        <fpage>571</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coi.2013.09.015</pub-id>
        <?supplied-pmid 24148234?>
        <pub-id pub-id-type="pmid">24148234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Diehn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vetere</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360.e344</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Steen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chaudhuri</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Khodadoust</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Esfahani</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Luca</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>773</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0114-2</pub-id>
        <?supplied-pmid 31061481?>
        <pub-id pub-id-type="pmid">31061481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>380</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08023-x</pub-id>
        <?supplied-pmid 30670690?>
        <pub-id pub-id-type="pmid">30670690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Racle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gfeller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>EPIC: a tool to estimate the proportions of different cell types from bulk gene expression data</article-title>
        <source>Methods Mol Biol (Clifton, NJ)</source>
        <year>2020</year>
        <volume>2120</volume>
        <fpage>233</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-0716-0327-7_17</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jew</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rahmani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garske</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Sul</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Pietiläinen</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Pajukanta</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Accurate estimation of cell composition in bulk expression through robust integration of single-cell information</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1971</fpage>
        <lpage>1971</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15816-6</pub-id>
        <?supplied-pmid 32332754?>
        <pub-id pub-id-type="pmid">32332754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Pe’er D, Danko CG: Cell type and gene expression deconvolution with BayesPrism enables Bayesian integrative analysis across bulk and single-cell RNA sequencing in oncology</article-title>
        <source>Nature Cancer</source>
        <year>2022</year>
        <volume>3</volume>
        <fpage>505</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-022-00356-3</pub-id>
        <?supplied-pmid 35469013?>
        <pub-id pub-id-type="pmid">35469013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roeder</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bayesian estimation of cell type-specific gene expression with prior derived from single-cell data</article-title>
        <source>Genome Res</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>268722.268120</fpage>
        <pub-id pub-id-type="doi">10.1101/gr.268722.120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TOAST: improving reference-free cell composition estimation by cross-cell type differential analysis</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
        </person-group>
        <article-title>Latent dirichlet allocation</article-title>
        <source>J Mach Learn Res</source>
        <year>2003</year>
        <volume>3</volume>
        <fpage>993</fpage>
        <lpage>1022</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teh</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <source>Hierarchical dirichlet processes</source>
        <year>2006</year>
        <volume>101</volume>
        <fpage>1566</fpage>
        <lpage>1581</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geering</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stoeckle</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Conus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>H-U</given-names>
          </name>
        </person-group>
        <article-title>Living and dying for inflammation: neutrophils, eosinophils, basophils</article-title>
        <source>Trends Immunol</source>
        <year>2013</year>
        <volume>34</volume>
        <fpage>398</fpage>
        <lpage>409</lpage>
        <pub-id pub-id-type="doi">10.1016/j.it.2013.04.002</pub-id>
        <?supplied-pmid 23665135?>
        <pub-id pub-id-type="pmid">23665135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Paisley</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Stochastic variational inference</article-title>
        <source>J Mach Learn Res</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>1303</fpage>
        <lpage>1347</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>E-M</given-names>
          </name>
          <name>
            <surname>Andréasson</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell Marker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky900</pub-id>
        <?supplied-pmid 30289549?>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Franzén O, Gan LM, Björkegren JL. PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data. Database. 2019;2019:baz046.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fadista</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vikman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Laakso</surname>
            <given-names>EO</given-names>
          </name>
          <name>
            <surname>Mollet</surname>
            <given-names>IG</given-names>
          </name>
          <name>
            <surname>Esguerra</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Taneera</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Storm</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Osmark</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ladenvall</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>RB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global genomic and transcriptomic analysis of human pancreatic islets reveals novel genes influencing glucose metabolism</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>13924</fpage>
        <lpage>13929</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1402665111</pub-id>
        <?supplied-pmid 25201977?>
        <pub-id pub-id-type="pmid">25201977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alvarez-Jarreta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Armean Irina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Austine-Orimoloye</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Azov Andrey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2022</article-title>
        <source>Nucleic Acids Res</source>
        <year>2022</year>
        <volume>50</volume>
        <fpage>D988</fpage>
        <lpage>D995</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab1049</pub-id>
        <?supplied-pmid 34791404?>
        <pub-id pub-id-type="pmid">34791404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>The tumor microenvironment</article-title>
        <source>Curr Biol CB</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>R921</fpage>
        <lpage>R925</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2020.06.081</pub-id>
        <?supplied-pmid 32810447?>
        <pub-id pub-id-type="pmid">32810447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lei</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J-K</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>W-X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R-G</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>H-B</given-names>
          </name>
        </person-group>
        <article-title>Immune cells within the tumor microenvironment: biological functions and roles in cancer immunotherapy</article-title>
        <source>Cancer Lett</source>
        <year>2020</year>
        <volume>470</volume>
        <fpage>126</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1016/j.canlet.2019.11.009</pub-id>
        <?supplied-pmid 31730903?>
        <pub-id pub-id-type="pmid">31730903</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>B-F</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J-Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>G-S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intra-tumoral heterogeneity and malignant progression in pancreatic ductal adenocarcinoma</article-title>
        <source>Cell Res</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>725</fpage>
        <lpage>738</lpage>
        <pub-id pub-id-type="doi">10.1038/s41422-019-0195-y</pub-id>
        <?supplied-pmid 31273297?>
        <pub-id pub-id-type="pmid">31273297</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Xu Y, Liu J, Nipper M, Wang P. Ductal vs. acinar? Recent insights into identifying cell lineage of pancreatic ductal adenocarcinoma. Ann Pancreat Cancer. 2019;2:11. 10.21037/apc.2019.06.03.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peran</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Madhavan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Byers</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>McCoy</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Curation of the pancreatic ductal adenocarcinoma subset of the cancer genome atlas is essential for accurate conclusions about survival-related molecular mechanisms</article-title>
        <source>Clin Cancer Res</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>3813</fpage>
        <lpage>3819</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-18-0290</pub-id>
        <?supplied-pmid 29739787?>
        <pub-id pub-id-type="pmid">29739787</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Domenico</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pipinikas</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Maire</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Bräutigam</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Simillion</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dettmer</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Vassella</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Thirlwell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Perren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marinoni</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Epigenetic landscape of pancreatic neuroendocrine tumours reveals distinct cells of origin and means of tumour progression</article-title>
        <source>Commun Biol</source>
        <year>2020</year>
        <volume>3</volume>
        <fpage>740</fpage>
        <lpage>740</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-020-01479-y</pub-id>
        <?supplied-pmid 33288854?>
        <pub-id pub-id-type="pmid">33288854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whittle</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Hingorani</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Fibroblasts in pancreatic ductal adenocarcinoma: biological mechanisms and therapeutic targets</article-title>
        <source>Gastroenterology</source>
        <year>2019</year>
        <volume>156</volume>
        <fpage>2085</fpage>
        <lpage>2096</lpage>
        <pub-id pub-id-type="doi">10.1053/j.gastro.2018.12.044</pub-id>
        <?supplied-pmid 30721663?>
        <pub-id pub-id-type="pmid">30721663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Garcia PE, Scales MK, Allen BL, Pasca di Magliano M. Pancreatic Fibroblast Heterogeneity: From Development to Cancer. Cells. 2020;9(11):2464. 10.3390/cells9112464.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Alkasalias T, Moyano-Galceran L, Arsenian-Henriksson M, Lehti K. Fibroblasts in the Tumor Microenvironment: Shield or Spear? Int J Mol Sci. 2018;19(5):1532. 10.3390/ijms19051532.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Starzyńska T, Karczmarski J, Paziewska A, Kulecka M, Kuśnierz K, Żeber-Lubecka N, Ambrożkiewicz F, Mikula M, Kos-Kudła B, Ostrowski J. Differences between Well-Differentiated Neuroendocrine Tumors and Ductal Adenocarcinomas of the Pancreas Assessed by Multi-Omics Profiling. Int J Mol Sci. 2020;21(12):4470. 10.3390/ijms21124470.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>SZ</given-names>
          </name>
          <name>
            <surname>Al-Eryani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Roden</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Junankar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harvey</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thennavan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Torpy</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bartonicek</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell and spatially resolved atlas of human breast cancers</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>1334</fpage>
        <lpage>1347</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00911-1</pub-id>
        <?supplied-pmid 34493872?>
        <pub-id pub-id-type="pmid">34493872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertucci</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Finetti</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Birnbaum</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Basal breast cancer: a complex and deadly molecular subtype</article-title>
        <source>Curr Mol Med</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>96</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.2174/156652412798376134</pub-id>
        <?supplied-pmid 22082486?>
        <pub-id pub-id-type="pmid">22082486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Phung</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Willey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jabart</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2028</fpage>
        <lpage>2028</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04334-1</pub-id>
        <?supplied-pmid 29795293?>
        <pub-id pub-id-type="pmid">29795293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Breast cancer cell line classification and its relevance with breast tumor subtyping</article-title>
        <source>J Cancer</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>3131</fpage>
        <lpage>3141</lpage>
        <pub-id pub-id-type="doi">10.7150/jca.18457</pub-id>
        <?supplied-pmid 29158785?>
        <pub-id pub-id-type="pmid">29158785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential analysis of count data–the DESeq2 package</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>10</fpage>
        <lpage>1186</lpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Construction of a human cell landscape at single-cell level</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>581</volume>
        <fpage>303</fpage>
        <lpage>309</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2157-4</pub-id>
        <?supplied-pmid 32214235?>
        <pub-id pub-id-type="pmid">32214235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Consortium* TS, Jones RC, Karkanias J, Krasnow MA, Pisco AO, Quake SR, Salzman J, Yosef N, Bulthaup B, Brown P, et al: The Tabula Sapiens: a multiple-organ, single-cell transcriptomic atlas of humans. Science. 2022;376:eabl4896.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>CeDAR: incorporating cell type hierarchy improves cell type-specific differential analyses in bulk omics data</article-title>
        <source>Genome Biol</source>
        <year>2023</year>
        <volume>24</volume>
        <fpage>37</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-023-02857-5</pub-id>
        <?supplied-pmid 36855165?>
        <pub-id pub-id-type="pmid">36855165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Wilk</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Darby</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zager</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3573</fpage>
        <lpage>3587</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efremova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for single-cell omics across modalities</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>14</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0692-4</pub-id>
        <?supplied-pmid 31907463?>
        <pub-id pub-id-type="pmid">31907463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Mann-Krzisnik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Single-cell multi-omic topic embedding reveals cell-type-specific and COVID-19 severity-related immune signatures</article-title>
        <source>bioRxiv</source>
        <year>2023</year>
        <volume>2023.2001.2031</volume>
        <fpage>526312</fpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Argelaguet</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cuomo</surname>
            <given-names>ASE</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Computational principles and challenges in single-cell data integration</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1202</fpage>
        <lpage>1215</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00895-7</pub-id>
        <?supplied-pmid 33941931?>
        <pub-id pub-id-type="pmid">33941931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Learning interpretable cellular and gene signature embeddings from single-cell transcriptomic data</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>5261</fpage>
        <lpage>5261</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25534-2</pub-id>
        <?supplied-pmid 34489404?>
        <pub-id pub-id-type="pmid">34489404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Quon</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>siVAE: interpretable deep generative models for single-cell transcriptomes</article-title>
        <source>Genome Biol</source>
        <year>2023</year>
        <volume>24</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-023-02850-y</pub-id>
        <?supplied-pmid 36803416?>
        <pub-id pub-id-type="pmid">36803416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahuja</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Verma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buckeridge</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>MixEHR-Guided: a guided multi-modal topic modeling approach for large-scale automatic phenotyping using the electronic health record</article-title>
        <source>J Biomed Inform</source>
        <year>2022</year>
        <volume>134</volume>
        <fpage>104190</fpage>
        <lpage>104190</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2022.104190</pub-id>
        <?supplied-pmid 36058522?>
        <pub-id pub-id-type="pmid">36058522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Li Y, Nair P, Lu XH, Wen Z, Wang Y, Dehaghi AA, et al. Inferring multimodal latent topics from electronic health records. Nat Commun. 2020;11(1):2536. 10.1038/s41467-020-16378-3.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahuja</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Castro</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Gainer</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>sureLDA: A multidisease automated phenotyping method for the electronic health record</article-title>
        <source>J Am Med Inform Assoc</source>
        <year>2020</year>
        <volume>27</volume>
        <fpage>1235</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="doi">10.1093/jamia/ocaa079</pub-id>
        <?supplied-pmid 32548637?>
        <pub-id pub-id-type="pmid">32548637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Steyvers</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Finding scientific topics</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>Suppl 1</issue>
        <fpage>5228</fpage>
        <lpage>5235</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0307752101</pub-id>
        <?supplied-pmid 14872004?>
        <pub-id pub-id-type="pmid">14872004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Teh YW, Newman D, Welling M. A collapsed variational Bayesian inference algorithm for latent Dirichlet allocation. Advances in neural…2006.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Minka</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Estimating a Dirichlet distribution. Technical report, MIT</source>
        <year>2000</year>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <?supplied-pmid 29409532?>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Publ Group</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liberzon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Birger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection</article-title>
        <source>Cell Syst</source>
        <year>2015</year>
        <volume>1</volume>
        <fpage>417</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id>
        <?supplied-pmid 26771021?>
        <pub-id pub-id-type="pmid">26771021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <mixed-citation publication-type="other">Pedregosa F, Varoquaux G, Gramfort A, Michel V, Thirion B, Grisel O, Blondel M, Prettenhofer P, Weiss R, Dubourg V, Vanderplas J. Scikit-learn: Machine learning in Python. J Mach Learn Res. 2011;12:2825–30.</mixed-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>QY</given-names>
          </name>
        </person-group>
        <article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>
        <source>OMICS</source>
        <year>2012</year>
        <volume>16</volume>
        <fpage>284</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id>
        <?supplied-pmid 22455463?>
        <pub-id pub-id-type="pmid">22455463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Hession</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Marjanovic</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Wadsworth</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Burks</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>LT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>737</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0465-8</pub-id>
        <?supplied-pmid 32341560?>
        <pub-id pub-id-type="pmid">32341560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Huo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic landscape of human blood cells</article-title>
        <source>Natl Sci Rev</source>
        <year>2021</year>
        <volume>8</volume>
        <fpage>nwaa180</fpage>
        <pub-id pub-id-type="doi">10.1093/nsr/nwaa180</pub-id>
        <?supplied-pmid 34691592?>
        <pub-id pub-id-type="pmid">34691592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lake</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Ai</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kaeser</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Salathia</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wildberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neuronal subtypes and diversity revealed by single-nucleus RNA sequencing of the human brain</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>1586</fpage>
        <lpage>1590</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf1204</pub-id>
        <?supplied-pmid 27339989?>
        <pub-id pub-id-type="pmid">27339989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Phung</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Willey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jabart</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2028</year>
        <volume>2018</volume>
        <fpage>9</fpage>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Profiling cell type abundance and expression in bulk tissues with CIBERSORTx</article-title>
        <source>Methods Mol Biol</source>
        <year>2020</year>
        <volume>2117</volume>
        <fpage>135</fpage>
        <lpage>157</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-0716-0301-7_7</pub-id>
        <?supplied-pmid 31960376?>
        <pub-id pub-id-type="pmid">31960376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monaco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mustafah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Carre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Burdin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Visan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ceccarelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poidinger</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq signatures normalized by mRNA abundance allow absolute deconvolution of human immune cell types</article-title>
        <source>Cell Rep</source>
        <year>2019</year>
        <volume>26</volume>
        <issue>1627–1640</issue>
        <fpage>e1627</fpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.01.041</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmermann</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Grill</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Oberg</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Goergen</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Ovsyannikova</surname>
            <given-names>IG</given-names>
          </name>
          <name>
            <surname>Haralambieva</surname>
            <given-names>IH</given-names>
          </name>
          <name>
            <surname>Poland</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Integration of immune cell populations, mRNA-Seq, and CpG methylation to better predict humoral immunity to influenza vaccination: dependence of mRNA-Seq/CpG methylation on immune cell populations</article-title>
        <source>Front Immunol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>445</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2017.00445</pub-id>
        <?supplied-pmid 28484452?>
        <pub-id pub-id-type="pmid">28484452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoek</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Samir</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Howard</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Galassie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Allos</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Floyd</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A cell-based systems biology assessment of human blood to monitor immune responses after influenza vaccination</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>e0118528</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0118528</pub-id>
        <?supplied-pmid 25706537?>
        <pub-id pub-id-type="pmid">25706537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patrick</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Taga</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ergun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Casazza</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cimpean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Gaiteri</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconvolving the contributions of cell-type heterogeneity on cortical gene expression</article-title>
        <source>PLoS Comput Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1008120</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008120</pub-id>
        <?supplied-pmid 32804935?>
        <pub-id pub-id-type="pmid">32804935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <mixed-citation publication-type="other">Schulze A, Oshi M, Endo I, Takabe K. MYC Targets Scores Are Associated with Cancer Aggressiveness and Poor Survival in ER-Positive Primary and Metastatic Breast Cancer. Int J Mol Sci. 2020;21(21):8127. 10.3390/ijms21218127.</mixed-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <mixed-citation publication-type="other">Oshi M, Takahashi H, Tokumaru Y, Yan L, Rashid OM, Nagahashi M, Matsuyama R, Endo I, Takabe K. The E2F Pathway Score as a Predictive Biomarker of Response to Neoadjuvant Therapy in ER+/HER2- Breast Cancer. Cells. 2020;9(7):1643. 10.3390/cells9071643.</mixed-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <mixed-citation publication-type="other">Oshi M, Takahashi H, Tokumaru Y, Yan L, Rashid OM, Matsuyama R, Endo I, Takabe K. G2M Cell Cycle Pathway Score as a Prognostic Biomarker of Metastasis in Estrogen Receptor (ER)-Positive Breast Cancer. Int J Mol Sci. 2020;21(8):2921. 10.3390/ijms21082921.</mixed-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <mixed-citation publication-type="other">Sandberg R, Palasantza A, Segerstolpe A. Single-cell RNA-seq analysis of human pancreas from healthy individuals and type 2 diabetes patients. ArrayExpress. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <mixed-citation publication-type="other">Palasantza A, Sandberg R, Clausen M. Whole-islet RNA-sequencing analysis of human pancreas from healthy individuals and type 2 diabetes patients. ArrayExpress. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E-MTAB-5060">https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E-MTAB-5060</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <mixed-citation publication-type="other">Veres A, Baron M. A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure. Gene Expression Omnibus. 2016. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE84133">https://identifiers.org/geo:GSE84133</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Ying Y: GSA-PDAC. Genome Sequence Archive. 2018. <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn/gsa/browse/CRA001160">https://ngdc.cncb.ac.cn/gsa/browse/CRA001160</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <mixed-citation publication-type="other">Kessenbrock K. Single cell RNA sequencing of adult human breast epithelial cells. . Gene Expression Omnibus. 2018. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE113197">https://identifiers.org/geo:GSE113197</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <mixed-citation publication-type="other">Swarbrick A, Wu S, Al-Eryani G, Roden D. A single-cell and spatially resolved atlas of human breast cancers. . Gene Expression Omnibus. 2021. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE176078">https://identifiers.org/geo:GSE176078</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <mixed-citation publication-type="other">Ding J, Adiconis X, Simmons S, Kowalczyk M, Hession C, Marjanovic N, Hughes T, Wadsworth M, Burks T, Nguyen L, et al. Systematic comparative analysis of single cell RNA-sequencing methods. Gene Expression Omnibus. 2019. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE132044">https://identifiers.org/geo:GSE132044</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <mixed-citation publication-type="other">Zhu P, Cheng T. Single-cell transcriptomic landscape of human blood cells. Gene Expression Omnibus. 2020. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE149938">https://identifiers.org/geo:GSE149938</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <mixed-citation publication-type="other">Lake B, Chen S, Sos B, Fan JB, Yung Y, Chun J, Kharchenko P, Zhang K. Integrative single-cell analysis of transcriptional and epigenetic states in the human adult brain. Gene Expression Omnibus. 2017. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE97930">https://identifiers.org/geo:GSE97930</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <mixed-citation publication-type="other">Anolik J, Bykerk V, Moreland L, Holers M, McGeachy M, Seifert J, Filer A, Pitzalis C, Gregersen P, Firestein G, et al. AMP Rheumatoid Arthritis Phase 1. Immport. 2018. 10.21430/M3KXJHSP4T.</mixed-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">Fadista J, Groop L. Global transcriptomic analysis of human pancreatic islets reveals novel genes influencing glucose metabolism. Gene Expression Omnibus. 2014. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE50244">https://identifiers.org/geo:GSE50244</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">Monaco G, Lee B, Xu W, Hwang Y, Poidinger M, Poidinger M, de Magalhães J, Larbi A. RNA-Seq profiling of 29 immune cell types and peripheral blood mononuclear cells. Gene Expression Omnibus. 2019. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE107011">https://identifiers.org/geo:GSE107011</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <mixed-citation publication-type="other">Poland G: Bioinformatics Approach to 2010–2011 TIV Influenza A/H1N1 Vaccine Immune Profiling. Immport. 2015. 10.21430/M3OYWCJHO1.</mixed-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <mixed-citation publication-type="other">Hoek K, Link A. A cell-based systems biology assessment of human blood to monitor immune responses after influenza vaccination. Gene Expression Omnibus. 2015. <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo:GSE64655">https://identifiers.org/geo:GSE64655</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <mixed-citation publication-type="other">Swapna LS, Huang M, Li Y: GTM-decon: Guided Topic Modeling for Deconvolution of cell types from bulk RNA-seq data. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/li-lab-mcgill/gtm-decon">https://github.com/li-lab-mcgill/gtm-decon</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <mixed-citation publication-type="other">Swapna LS, Huang M, Li Y. Source package and associated scripts for GTM-decon: guided-topic modelling of single-cell transcriptomes enables sub-cell-type and disease-subtype deconvolution of bulk transcriptomes. 2023. Zenodo. 10.5281/zenodo.8200316.</mixed-citation>
    </ref>
  </ref-list>
</back>
