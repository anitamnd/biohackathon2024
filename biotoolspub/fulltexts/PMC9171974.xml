<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9171974</article-id>
    <article-id pub-id-type="publisher-id">1266</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-022-01266-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Phylogeny-guided microbiome OTU-specific association test (POST)</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Caizhi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Callahan</surname>
          <given-names>Benjamin J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Michael C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Holloway</surname>
          <given-names>Shannon T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brochu</surname>
          <given-names>Hayden</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Wenbin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Xinxia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5505-1775</contrib-id>
        <name>
          <surname>Tzeng</surname>
          <given-names>Jung-Ying</given-names>
        </name>
        <address>
          <email>jytzeng@ncsu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.40803.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2173 6074</institution-id><institution>Bioinformatics Research Center, </institution><institution>North Carolina State University, </institution></institution-wrap>Raleigh, 27606 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.40803.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2173 6074</institution-id><institution>Department of Population Health and Pathobiology, </institution><institution>North Carolina State University, </institution></institution-wrap>Raleigh, 27607 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.270240.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2180 1622</institution-id><institution>Division of Public Health Sciences, </institution><institution>Fred Hutchinson Cancer Research Center, </institution></institution-wrap>Seattle, 98109 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.40803.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2173 6074</institution-id><institution>Department of Statistics, </institution><institution>North Carolina State University, </institution></institution-wrap>Raleigh, 27606 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.40803.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2173 6074</institution-id><institution>Department of Molecular Biomedical Sciences, </institution><institution>North Carolina State University, </institution></institution-wrap>Raleigh, 27607 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>86</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The relationship between host conditions and microbiome profiles, typically characterized by operational taxonomic units (OTUs), contains important information about the microbial role in human health. Traditional association testing frameworks are challenged by the high dimensionality and sparsity of typical microbiome profiles. Phylogenetic information is often incorporated to address these challenges with the assumption that evolutionarily similar taxa tend to behave similarly. However, this assumption may not always be valid due to the complex effects of microbes, and phylogenetic information should be incorporated in a <italic>data-supervised</italic> fashion.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this work, we propose a local collapsing test called phylogeny-guided microbiome OTU-specific association test (POST). In POST, whether or not to borrow information and how much information to borrow from the neighboring OTUs in the phylogenetic tree are supervised by phylogenetic distance and the outcome-OTU association. POST is constructed under the kernel machine framework to accommodate complex OTU effects and extends kernel machine microbiome tests from community level to OTU level. Using simulation studies, we show that when the phylogenetic tree is informative, POST has better performance than existing OTU-level association tests. When the phylogenetic tree is not informative, POST achieves similar performance as existing methods. Finally, in real data applications on bacterial vaginosis and on preterm birth, we find that POST can identify similar or more outcome-associated OTUs that are of biological relevance compared to existing methods.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Using POST, we show that adaptively leveraging the phylogenetic information can enhance the selection performance of associated microbiome features by improving the overall true-positive and false-positive detection. We developed a user friendly R package <italic>POSTm</italic> which is freely available on CRAN (<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=POSTm">https://CRAN.R-project.org/package=POSTm</ext-link>).</p>
        <p id="Par4">
          <media xlink:href="40168_2022_1266_MOESM10_ESM.mp4" id="MOESM10">
            <caption>
              <p>Video Abstract.</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s40168-022-01266-3).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Association test</kwd>
      <kwd>Phylogenetic tree</kwd>
      <kwd>Kernel machine regression</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>T32ES007329</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM133745</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21AI120713</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U19AI144181</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P01CA142538</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institutes of Health</institution>
        </funding-source>
        <award-id>P01CA142538</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institutes of Health</institution>
        </funding-source>
        <award-id>P01CA142538</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HHSN272201800008C</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RF1AG074328</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RF1AG074328</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RF1AG074328</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM133745</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21AI120713</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U19AI144181</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HHSN272201800008C</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM129512</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HL155417</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The human microbiome is the collection of microorganisms residing in the human body and has been definitively shown to impact human disease and health [<xref ref-type="bibr" rid="CR1">1</xref>]. Multiple resources are now available that enable the characterization of microbial communities in the human body and further our understanding of how the human microbiota affect clinical outcomes of the host, e.g., the Human Microbiome Project [<xref ref-type="bibr" rid="CR2">2</xref>] and Integrative Human Microbiome Project [<xref ref-type="bibr" rid="CR3">3</xref>]. One common strategy to determine microbial compositions is marker gene sequencing, which amplifies and sequences a fingerprint gene (e.g., 16S rRNA gene) that carries species-specific identifiers. The generated sequencing reads can be either clustered into operational taxonomic units (OTUs) based on sequence similarity [<xref ref-type="bibr" rid="CR4">4</xref>] or denoised into amplicon sequence variants (ASVs) with exact sequences [<xref ref-type="bibr" rid="CR5">5</xref>]. For simplicity, hereafter, we use “OTU” as a general reference to a taxonomic unit when discussing the overall concepts. We will explicitly distinguish OTU and ASV when the two terms need to be discerned, such as in the real data analysis.</p>
    <p>Comparison of OTU profiles with respect to differential conditions or clinical outcomes lends important knowledge towards understanding the microbial roles in affecting health [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], and distance-based approaches are widely adopted to evaluate such association at the community level [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. It is also of interest to identify specific OTUs or organisms as biomarkers that drive the global association, which can provide crucial insights into the microbial functions and mechanisms in diseases. For example, the correlation between <italic>Lactobacillus crispatus</italic> abundance and host vaginal cytokine IP-10/CXCL10 levels may help to explain the induction of preterm birth [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p>OTU-level analysis can be challenging due to sparse OTU counts, low OTU abundance, and high OTU dimensionality. Multiple studies have shown that incorporating phylogenetic structure among OTUs can increase the detecting power or predictive accuracy of a microbiome analysis because phylogenetically related species or OTUs are expected to impact or respond to environmental disturbances in a similar way [<xref ref-type="bibr" rid="CR13">13</xref>]. For example, Xiao et al. [<xref ref-type="bibr" rid="CR14">14</xref>] introduced a false discovery rate (FDR) control procedure, TreeFDR, that uses the phylogenetic tree to specify the prior correlation among the <italic>p</italic>-values of individual OTUs. TreeFDR is more powerful than the classic FDR controlling methods (e.g., the Benjamini-Hochberg (BH) FDR method) as well as those that incorporate grouping structure [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Xiao et al. [<xref ref-type="bibr" rid="CR17">17</xref>] introduced a predictive method, glmmTree, based on a generalized linear mixed model that encourages the nearby OTUs in the phylogenetic tree to share similar effects and showed that glmmTree improves prediction performance, especially when associated OTUs are clustered on the tree. Kim et al. [<xref ref-type="bibr" rid="CR18">18</xref>] introduced a genus-level collapsing association test, TMAT, that first assesses the association for each OTU within a genus and then uses the minimum OTU <italic>p</italic>-value to determine the genus significance.</p>
    <p>However, it has been noted that inappropriate incorporation of phylogenetic information can degrade testing performance when phylogeny is not informative of association patterns among OTUs [<xref ref-type="bibr" rid="CR19">19</xref>]. Furthermore, evolutionarily close OTUs can act differently and even in opposite ways. For example, two close species in <italic>Lactobacillus</italic> genus, i.e., <italic>Lactobacillus iners</italic> and <italic>Lactobacillus crispatus</italic>, exhibit opposite associations with preterm birth—<italic>Lactobacillus crispatus</italic> dominance was negatively associated with preterm birth while <italic>Lactobacillus iners</italic> dominance was positively associated with preterm birth [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p>To address these challenges in the incorporation of phylogenetic information, we propose the phylogeny-guided microbiome OTU-specific association test (POST), which boosts the detecting power of the target OTU by adaptively borrowing information from its phylogenetically close OTUs. Whether or not to borrow information and how much information to borrow from the neighboring OTUs are supervised by phylogenetic distance and the outcome-OTU association. POST is built on a kernel machine regression framework, which can flexibly accommodate complex microbiome effects, easily adjust for covariates, and be applicable to continuous and binary outcomes. Compared to existing phylogeny-informed single-OTU methods, POST can better handle sparse OTU data and allow information collapsing from OTUs of opposite effects because kernel methods collapse OTU information at similarity/kernel level instead of at the level of <italic>p</italic>-values or abundance counts. POST extends the current community-level kernel tests [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] to OTU-level test. Finally, POST is computationally efficient for OTU-wide analysis as its <italic>p</italic>-value can be analytically obtained. Through extensive numerical studies, we show that POST has favorable performance in identifying associated OTUs over existing methods in simulations and real data applications, including detecting the association of vaginal microbiome with bacterial vaginosis and with preterm birth.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p>Suppose that for subject <italic>i</italic>, <italic>i</italic>=1,⋯,<italic>n</italic>, we observe the outcome value <italic>y</italic><sub><italic>i</italic></sub>, which can be continuous or binary; the vector of <italic>p</italic> covariates <bold><italic>x</italic></bold><sub><italic>i</italic></sub>=(<italic>x</italic><sub><italic>i</italic>1</sub>,⋯,<italic>x</italic><sub><italic>ip</italic></sub>)<sup>⊤</sup>, and the abundance vector of <italic>M</italic> OTUs <bold><italic>z</italic></bold><sub><italic>i</italic></sub>=(<italic>z</italic><sub><italic>i</italic>1</sub>,⋯,<italic>z</italic><sub><italic>iM</italic></sub>)<sup>⊤</sup>, after sequence processing. In matrix presentation, we have the <italic>n</italic>×<italic>M</italic> matrix of OTU abundance <bold><italic>Z</italic></bold>=(<bold><italic>z</italic></bold><sub>1</sub>,<bold><italic>z</italic></bold><sub>2</sub>,…,<bold><italic>z</italic></bold><sub><italic>n</italic></sub>)<sup>⊤</sup>, the <italic>n</italic>×<italic>p</italic> covariate matrix <bold><italic>X</italic></bold>=(<bold><italic>x</italic></bold><sub>1</sub>,<bold><italic>x</italic></bold><sub>2</sub>,⋯,<bold><italic>x</italic></bold><sub><italic>n</italic></sub>)<sup>⊤</sup>, and the outcome vector <bold><italic>y</italic></bold>=(<italic>y</italic><sub>1</sub>,<italic>y</italic><sub>2</sub>,⋯,<italic>y</italic><sub><italic>n</italic></sub>)<sup>⊤</sup>.</p>
    <p>POST uses a kernel machine regression [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] to model the relationship between OTU <italic>m</italic> and the outcome variable: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ g(\boldsymbol{\mu}) = \boldsymbol{X}\boldsymbol{\gamma}+h^{m}(\boldsymbol{Z}),   $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2022_1266_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>where <bold><italic>μ</italic></bold>=<italic>E</italic>(<bold><italic>y</italic></bold>|<bold><italic>X</italic></bold>,<bold><italic>Z</italic></bold>), the conditional expectation of <bold><italic>y</italic></bold> given the microbiome and covariate information; <italic>g</italic>(·) is the link function, which can be set to be the identity function for continuous outcomes and the logistic function for binary outcomes; <bold><italic>γ</italic></bold> is the <italic>p</italic>×1 vector of covariate regression coefficients; <italic>h</italic><sup><italic>m</italic></sup>(·) is a smooth function in a reproducing kernel Hilbert space generated by a kernel function <italic>k</italic><sup><italic>m</italic></sup>(<bold><italic>z</italic></bold><sub><italic>i</italic></sub>,<bold><italic>z</italic></bold><sub><italic>j</italic></sub>). Function <italic>h</italic><sup><italic>m</italic></sup>(·) characterizes the effect of OTU <italic>m</italic> and can be specified by <italic>k</italic><sup><italic>m</italic></sup>(<bold><italic>z</italic></bold><sub><italic>i</italic></sub>,<bold><italic>z</italic></bold><sub><italic>j</italic></sub>) using the dual representation of a function in kernel methods, i.e., <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$h^{m}(\boldsymbol {z}_{i})=\sum _{j=1}^{n}\alpha ^{m}_{j} k^{m}(\boldsymbol {z}_{i},\boldsymbol {z}_{j})$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq1.gif"/></alternatives></inline-formula> with <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha ^{m}_{1},\cdots,\alpha ^{m}_{n}$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq2.gif"/></alternatives></inline-formula> the unknown parameters. The association between OTU <italic>m</italic> and the outcome can be evaluated by testing <italic>H</italic><sub>0</sub>:<italic>h</italic><sup><italic>m</italic></sup>(<bold><italic>Z</italic></bold>)=<bold><italic>0</italic></bold>.</p>
    <p>In POST, instead of using a global kernel as in the community-level test, we propose an OTU-specific kernel function <italic>k</italic><sup><italic>m</italic></sup>(·,·) for OTU <italic>m</italic> to permit the local OTU test to borrow information from its neighboring OTUs in the phylogenetic tree. Figure <xref rid="Fig1" ref-type="fig">1</xref> describes the key steps of POST: (1) to quantify the pairwise OTU correlation based on their phylogenetic relationship, (2) to compute the subject kernel matrix <bold><italic>K</italic></bold><sup><italic>m</italic></sup> for OTU <italic>m</italic> using OTU abundance and OTU correlation data, and (3) to evaluate the association of OTU <italic>m</italic> with the outcome variable using the local kernel test that seeks for the optimal amount of information borrowing. The detail of each step is described below.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of phylogeny-guided microbiome OTU-specific association test (POST)</p></caption><graphic xlink:href="40168_2022_1266_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Step 1: Quantifying OTU phylogenetic correlation</title>
      <p>The first step of POST is to compute the OTU correlation matrix based on the phylogenetic relationship. To do so, we start with constructing the phylogenetic tree with <italic>M</italic> tips based on the sequences of the <italic>M</italic> OTUs using <italic>FastTree2</italic> [<xref ref-type="bibr" rid="CR23">23</xref>]. We then quantify the pairwise distance between OTUs <italic>ℓ</italic> and <italic>m</italic> (denoted by <italic>d</italic><sub><italic>ℓ</italic><italic>m</italic></sub>) by taking the sum of branch lengths from OTU <italic>ℓ</italic> to OTU <italic>m</italic> through the first common node in the tree, which can be done using the R function “cophenetic.” Finally, we convert the distance to correlation (denoted by <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub>) using the Gaussian function, i.e., <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{\ell m} = \exp \left \{-\frac {d_{\ell m}^{2}}{c\times s}\right \}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓm</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq3.gif"/></alternatives></inline-formula>, where <italic>s</italic> is the standard deviation (SD) of <italic>d</italic><sub><italic>ℓ</italic><italic>m</italic></sub>’s, <italic>ℓ</italic>,<italic>m</italic>∈{1,⋯,<italic>M</italic>};, and <italic>c</italic> is a positive data-adaptive parameter that controls how fast the OTU correlation decreases when the between-OTU distance increases. Parameter <italic>c</italic> is measured on the unit of distance SD so as to be scale-free and robust to trees generated from different tools (e.g., <italic>FastTree2</italic>, hclust). As detailed in step 2, neighboring OTUs with non-zero <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub>, <italic>ℓ</italic>≠<italic>m</italic> will contribute in the association test of OTU <italic>m</italic>, and <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub> controls the amount of information contributed from OTU <italic>ℓ</italic> into the test via <italic>c</italic>. We illustrate in Fig. <xref rid="Fig2" ref-type="fig">2</xref> a typical relationship between <italic>c</italic> and <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub> using the dataset of Charlson et al. [<xref ref-type="bibr" rid="CR24">24</xref>] considered in the simulation study. Without loss of generality, we focus on OTU3438 and its 16 neighboring OTUs in the phylogenetic tree (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) and show the values of <italic>r</italic><sub><italic>ℓ</italic>,3438</sub> for the neighboring OTU <italic>ℓ</italic> under different <italic>c</italic>’s in Fig. <xref rid="Fig2" ref-type="fig">2</xref>B. We see that smaller <italic>c</italic> (e.g., <italic>c</italic>=0.02) yields a more rapid correlation decay with increasing distance, and consequently, OTU <italic>m</italic> can borrow a non-negligible amount of information only from a few OTUs. In contrast, larger <italic>c</italic> (e.g., <italic>c</italic>=0.08) yields a slower correlation decay with increasing distance and defines a larger “neighborhood” of OTU <italic>m</italic> from which OTU <italic>m</italic> may borrow information. When <italic>c</italic>=0, <italic>r</italic><sub><italic>mm</italic></sub>=1 and <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub>=0 for all <italic>ℓ</italic>≠<italic>m</italic>, and the local association test becomes a strict single OTU test because only information of target OTU <italic>m</italic> is used (e.g., Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, panel of <italic>c</italic>=0). When <italic>c</italic>=<italic>∞</italic>, <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub>=1 for all <italic>ℓ</italic>, and the local association test becomes a global, community-level test because all OTUs contribute equally into the test (e.g., Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, panel of <italic>c</italic>=100).
<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>A</bold> Phylogenetic relationship between the target OTU (OTU3438) and its neighboring OTUs. <bold>B</bold> OTU phylogenetic correlation <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub> under different values of the tuning parameter <italic>c</italic>, illustrated by setting <italic>m</italic> = OTU3438 as the target OTU. The <italic>x</italic>-axis is the OTUs shown in the same order as the tree tips. The <italic>y</italic>-axis is <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub>, the correlation between OTU3438 and the remaining OTUs</p></caption><graphic xlink:href="40168_2022_1266_Fig2_HTML" id="MO2"/></fig></p>
      <p>When conducting POST association test in step 3, we use data to determine the optimal <italic>c</italic> value. Specifically, we compute the <italic>p</italic>-values for a grid of <italic>c</italic> between 0 and <italic>c</italic><sub>max</sub> and use the Cauchy combination (CC) method [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] to aggregate the <italic>p</italic>-values of different <italic>c</italic>’s. As detailed in the simulation studies, we set the <italic>c</italic><sub>max</sub>=0.05 to ensure information sharing is limited within a small, concentrated neighborhood of the target OTU. The adaptively determined <italic>c</italic> also ensures that only informative neighbors will make contributions to the target OTU.</p>
    </sec>
    <sec id="Sec4">
      <title>Step 2: Computing subject kernel similarity</title>
      <p>In kernel machine regression (<xref rid="Equ1" ref-type="">1</xref>), one crucial component is to specify the local kernel function <italic>k</italic><sup><italic>m</italic></sup>(<bold><italic>z</italic></bold><sub><italic>i</italic></sub>,<bold><italic>z</italic></bold><sub><italic>j</italic></sub>), which consequently determines the OTU effects, i.e., <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$h^{m}(\boldsymbol {z}_{i})=\sum _{j=1}^{n}\alpha ^{m}_{j} k^{m}(\boldsymbol {z}_{i},\boldsymbol {z}_{j})$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq4.gif"/></alternatives></inline-formula>. Several kernel choices are available for microbiome compositions in community-level tests [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The key is to start with a distance metric to quantify the pairwise abundance dissimilarities, store them in the <italic>n</italic>×<italic>n</italic> abundance dissimilarity matrix <bold><italic>A</italic></bold>, and then transform <bold><italic>A</italic></bold> to the kernel similarity matrix <bold><italic>K</italic></bold> using Gower’s matrix, i.e., <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {K}=-\frac {1}{2} \left (\boldsymbol {I}-\frac {\mathbf {1} \mathbf {1}^{\top }}{n}\right)\boldsymbol {A}^{2} \left (\boldsymbol {I}-\frac {\mathbf {1} \mathbf {1}^{\top }}{n}\right)$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq5.gif"/></alternatives></inline-formula>, where <bold><italic>A</italic></bold><sup>2</sup> is the element-wise square of <bold><italic>A</italic></bold>, <bold><italic>I</italic></bold> is the <italic>n</italic>×<italic>n</italic> identity matrix, and 1 is a vector of ones with length <italic>n</italic> [<xref ref-type="bibr" rid="CR22">22</xref>]. For POST, we propose to construct a local, OTU-specific kernel <bold><italic>K</italic></bold><sup><italic>m</italic></sup> so that only local information around the target OTU is used. First, obtain the local dissimilarity matrix <bold><italic>A</italic></bold><sup><italic>m</italic></sup> by incorporating <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub> into the original dissimilarity matrix <bold><italic>A</italic></bold>. Next, perform Gower’s transformation on <bold><italic>A</italic></bold><sup><italic>m</italic></sup> to obtain <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {K}^{m}\equiv \left \{ k^{m}({\boldsymbol {z}_{i},\boldsymbol {z}_{j})} \right \} = -\frac {1}{2} \left (\boldsymbol {I}-\frac {\mathbf {1} \mathbf {1}^{\top }}{n}\right)(\boldsymbol {A}^{m})^{2} \left (\boldsymbol {I}-\frac {\mathbf {1} \mathbf {1}^{\top }}{n}\right)$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>≡</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq6.gif"/></alternatives></inline-formula>. Although such local kernel construction can be applied on arbitrary distance metrics, in POST, we choose to use the Aitchison distance, a non-phylogenetic distance measure accounting for the compositional nature of abundance data, to avoid the potential overuse of phylogenetic information. Aitchison distance is the Euclidean distance of centered log-ratio (CLR) transformed abundance data, and the “local” Aitchison distance for OTU <italic>m</italic> between subjects <italic>i</italic> and <italic>j</italic> can be obtained by: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \boldsymbol{A}_{ij}^{m} = \sqrt{\sum_{\ell=1}^{M} r_{\ell m}\times (z_{i \ell}^{*}-z_{j\ell }^{*})^{2}},   $$ \end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓm</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>iℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>jℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2022_1266_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z_{i\ell }^{*}=\log \left [\frac {z_{i\ell }}{\mathrm {G}(\boldsymbol {z}_{i})}\right ]$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>iℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>iℓ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq7.gif"/></alternatives></inline-formula>, i.e., the CLR transformation of the original abundance count <italic>z</italic><sub><italic>i</italic><italic>ℓ</italic></sub> for OTU <italic>ℓ</italic>, and <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {G}(\boldsymbol {z}_{i})=\sqrt [M]{z_{i1} \cdots z_{iM}}$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="normal">G</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iM</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mroot></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq8.gif"/></alternatives></inline-formula> is the geometric mean of OTU abundance for subject <italic>i</italic>. A pseudo-count 0.5 is added to the OTU counts table before doing CLR transformation. If proportion data is used, a pseudo-proportion 1e −6 can be added to the proportion table [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Step 3: Performing OTU-specific association test</title>
      <p>The association of OTU <italic>m</italic> can be detected by testing for <italic>H</italic><sub>0</sub>:<italic>h</italic><sup><italic>m</italic></sup>(<bold><italic>Z</italic></bold>)=<bold><italic>0</italic></bold> in model (<xref rid="Equ1" ref-type="">1</xref>). Such a test can be constructed through the connection of kernel machine regression and generalized linear mixed models (GLMM) [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. That is, <italic>h</italic><sup><italic>m</italic></sup>(<bold><italic>Z</italic></bold>) can be viewed as subject-specific random effects with <italic>h</italic><sup><italic>m</italic></sup>(<bold><italic>Z</italic></bold>)∼<italic>N</italic>(<bold><italic>0</italic></bold>,<italic>τ</italic><bold><italic>K</italic></bold><sup><italic>m</italic></sup>), and then testing for <italic>H</italic><sub>0</sub>:<italic>h</italic><sup><italic>m</italic></sup>(<bold><italic>Z</italic></bold>)=<bold><italic>0</italic></bold> is equivalent to the variance component test of <italic>H</italic><sub>0</sub>:<italic>τ</italic>=0. Under the GLMM framework, a variance component score test can be obtained as <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T^{m,c} = \frac {1}{2\hat {\phi }} \left (\boldsymbol {y}-\hat {\boldsymbol {\mu }}_{0}\right)^{\top } \boldsymbol {K}^{m} \left (\boldsymbol {y}-\hat {\boldsymbol {\mu }}_{0}\right)$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq9.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}_{0}=g^{-1}\left (\boldsymbol {X}\hat {\boldsymbol {\gamma }}\right)$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq10.gif"/></alternatives></inline-formula> with <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\gamma }}$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq11.gif"/></alternatives></inline-formula> the estimated covariate coefficient under the null model: <italic>g</italic>(<bold><italic>μ</italic></bold>)=<bold><italic>X</italic></bold><bold><italic>γ</italic></bold>, and <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\phi }$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq12.gif"/></alternatives></inline-formula> is the estimator of the dispersion parameter under <italic>H</italic><sub>0</sub>. For continuous outcome, <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}_{0}=\boldsymbol {X}\hat {\boldsymbol {\gamma }}$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\phi }$\end{document}</tex-math><mml:math id="M32"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq14.gif"/></alternatives></inline-formula> equals to the estimated residual variance under <italic>H</italic><sub>0</sub>. For binary outcome, <italic>ϕ</italic>=1 and <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}_{0}=\exp \left \{\boldsymbol {X}\hat {\boldsymbol {\gamma }}\right \} / \left (1+\exp \left \{\boldsymbol {X}\hat {\boldsymbol {\gamma }}\right \}\right)$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq15.gif"/></alternatives></inline-formula>. With a fixed <italic>c</italic>, <italic>T</italic><sup><italic>m</italic>,<italic>c</italic></sup> asymptotically follows a weighted mixtures of <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\chi ^{2}_{(1)}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq16.gif"/></alternatives></inline-formula> distribution under <italic>H</italic><sub>0</sub>, based on which the <italic>p</italic>-value, denoted by <italic>p</italic><sub><italic>m</italic>,<italic>c</italic></sub>, can be computed. Because the sample size tends to be moderate in microbiome studies, we use the small-sample distribution derived in Chen et al. [<xref ref-type="bibr" rid="CR30">30</xref>] to compute <italic>p</italic><sub><italic>m</italic>,<italic>c</italic></sub>. Finally, as the optimal <italic>c</italic> is unknown in reality, in POST, we consider a grid of <italic>c</italic>∈{<italic>c</italic><sub>1</sub>,⋯,<italic>c</italic><sub><italic>J</italic></sub>}, use the CC method [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] to combine the transformed <italic>p</italic>-values of different <italic>c</italic>’s by computing <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T^{m} = \sum _{j=1}^{J} \tan \left \{ \left (0.5-p_{m,c_{j}}\right)\pi \right \}$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:munderover><mml:mo>tan</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>π</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq17.gif"/></alternatives></inline-formula>, and obtain the <italic>p</italic>-value of <italic>T</italic><sup><italic>m</italic></sup> (denoted by <italic>p</italic><sub><italic>m</italic></sub>) by <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{m} =\frac {1}{2}-\{\text {arctan}(T^{m}/J)\}/\pi.$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mo>{</mml:mo><mml:mtext>arctan</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mo>/</mml:mo><mml:mi>π.</mml:mi></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq18.gif"/></alternatives></inline-formula> The CC method behaves like the minimum <italic>p</italic>-value method as <italic>T</italic><sup><italic>m</italic></sup> is dominated by the smallest <italic>p</italic>-values; yet, the CC method becomes a computationally fast alternative to the minimum <italic>p</italic>-value method because the <italic>p</italic>-value of <italic>T</italic><sup><italic>m</italic></sup> can be analytically obtained from a Cauchy distribution, even with correlated <italic>p</italic>-values [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Simulation study</title>
      <p>We conducted simulation studies to evaluate the performance of POST in identifying outcome-associated OTUs. We generated OTU data based on the real dataset from the upper respiratory tract microbiome study [<xref ref-type="bibr" rid="CR24">24</xref>], obtained from the R package <italic>GuniFrac</italic> [<xref ref-type="bibr" rid="CR7">7</xref>]. The dataset consists of 856 OTU data from 60 subjects (from R object “throat.otu.tab”) and the OTU phylogenetic tree (from R object “throat.tree” constructed using <italic>FastTree</italic> [<xref ref-type="bibr" rid="CR7">7</xref>]). We considered 2 different simulation settings (simulations A and B); for each simulation, we simulated OTU counts for <italic>n</italic>=100 individuals following Chen and Li [<xref ref-type="bibr" rid="CR22">22</xref>] and focused on the <italic>M</italic>=400 most abundant OTUs in the original data. We modeled the observed OTU counts using the Dirichlet-multinomial distribution with parameters (<italic>π</italic><sub>1</sub>,⋯,<italic>π</italic><sub><italic>M</italic></sub>,<italic>θ</italic>), where <italic>π</italic><sub><italic>ℓ</italic></sub>’s are the means of the OTU-proportions and <italic>θ</italic> is the over-dispersion parameter [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], and obtained their maximum likelihood estimates <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\hat \pi _{1},\cdots,\hat \pi _{M}, \hat \theta)$\end{document}</tex-math><mml:math id="M42"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq19.gif"/></alternatives></inline-formula>. Next, we generated the OTU abundance proportions (<italic>p</italic><sub>1</sub>,⋯,<italic>p</italic><sub><italic>M</italic></sub>) from Dirichlet <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\hat \pi _{1}, \cdots,\hat \pi _{M},\hat \theta)$\end{document}</tex-math><mml:math id="M44"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq20.gif"/></alternatives></inline-formula>; we also generated the total counts of individual <italic>i</italic>, <italic>N</italic><sub><italic>i</italic></sub>, from a negative binomial distribution with mean 10,000 and size 25. Finally, we generated the OTU counts of individual <italic>i</italic> (<italic>z</italic><sub><italic>i</italic>1</sub>,⋯,<italic>z</italic><sub><italic>iM</italic></sub>) from multinomial (<italic>N</italic><sub><italic>i</italic></sub>,<italic>p</italic><sub>1</sub>,⋯,<italic>p</italic><sub><italic>M</italic></sub>); the OTU count matrix <bold><italic>Z</italic></bold> comprises the resulting simulated counts.</p>
      <sec id="Sec7">
        <title>Simulation A</title>
        <p>In simulation A, we adopted the simulation design of Xiao et al. and considered a case-control study with 50 cases (i.e., <italic>y</italic><sub><italic>i</italic></sub>=1) and 50 controls (i.e., <italic>y</italic><sub><italic>i</italic></sub>=0). Specifically, we used the R package <italic>pam</italic> to partition the 400 OTUs into 20 clusters based on the phylogenetic tree and selected causal OTUs from the 8 most abundant clusters. Given <bold><italic>Z</italic></bold> with <italic>M</italic>=400 and <italic>n</italic>=100, we then multiplied the counts of cases with a fold change vector [ exp(<italic>β</italic><sub>1</sub>),⋯, exp(<italic>β</italic><sub>400</sub>)], where <italic>β</italic><sub><italic>m</italic></sub> is the effect size of OTU <italic>m</italic> generated from normal (<italic>ν</italic>,1) if OTU <italic>m</italic> is causal and 0 otherwise. We considered |<italic>ν</italic>| to be 1 (small effect size) or 2 (large effect size).</p>
        <p>We consider five scenarios for causal OTUs as illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Scenarios 1–3 consider the same set of causal OTUs, which form multiple “causal OTU hubs” in the phylogenetic tree, with 1 causal hub from each of the top 8 abundant clusters and 7–10 causal OTUs per causal hub. In scenario 1, <italic>β</italic><sub><italic>m</italic></sub>’s are generated from <italic>N</italic>(<italic>ν</italic>,1) for all causal OTUs. In scenario 2, <italic>β</italic><sub><italic>m</italic></sub>∼<italic>N</italic>(<italic>ν</italic>,1) for half of the causal hubs and <italic>β</italic><sub><italic>m</italic></sub>∼<italic>N</italic>(−<italic>ν</italic>,1) for the other half of the causal hubs. In scenario 3, a random half of the causal OTUs have their <italic>β</italic><sub><italic>m</italic></sub>’s generated from <italic>N</italic>(<italic>ν</italic>,1), and the remaining half have their <italic>β</italic><sub><italic>m</italic></sub>’s from <italic>N</italic>(−<italic>ν</italic>,1); consequently, a causal hub may contain a fair number of positive-effect and negative-effect causal OTUs. Scenario 4 considers the case of smaller causal hubs with 2–3 causal OTUs per hub (i.e., less-informative trees): a random half of the causal hubs with <italic>β</italic><sub><italic>m</italic></sub>∼<italic>N</italic>(<italic>ν</italic>,1) and the other half causal hubs with <italic>β</italic><sub><italic>m</italic></sub>∼<italic>N</italic>(−<italic>ν</italic>,1). Scenario 5 considers the case where causal OTUs are randomly chosen from the entire phylogenetic tree (i.e., non-informative trees), where a random half of the causal OTUs have <italic>β</italic><sub><italic>m</italic></sub>∼<italic>N</italic>(<italic>ν</italic>,1) and the other half OTUs have <italic>β</italic><sub><italic>m</italic></sub>∼<italic>N</italic>(−<italic>ν</italic>,1).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Illustration of the five causal OTU scenarios considered in the simulation. Scenarios 1 to 3 consider larger “causal hubs,” each containing about 7–10 causal OTUs; scenario 4 considers smaller causal hubs of 2–3 causal OTUs; scenario 5 considers causal OTUs with random positions in the phylogenetic tree. Red (blue) circles indicate that causal effect size tends to be positive (negative)</p></caption><graphic xlink:href="40168_2022_1266_Fig3_HTML" id="MO3"/></fig></p>
      </sec>
      <sec id="Sec8">
        <title>Simulation B</title>
        <p>In simulation B, we considered both continuous and binary outcomes and adopted the simulation design of Zhao et al. [<xref ref-type="bibr" rid="CR10">10</xref>] and Koh et al. [<xref ref-type="bibr" rid="CR11">11</xref>]. Given the simulated OTU counts <bold><italic>Z</italic></bold>={<italic>z</italic><sub><italic>im</italic></sub>} and the same set of causal OTUs as simulation A, we generated the outcome value of individual <italic>i</italic> by <italic>y</italic><sub><italic>i</italic></sub>∼<italic>N</italic>(<italic>η</italic><sub><italic>i</italic></sub>,1) for continuous outcomes and <italic>y</italic><sub><italic>i</italic></sub>∼Bernoulli(<italic>Π</italic><sub><italic>i</italic></sub>) with <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Pi _{i}= \frac {\exp (\eta _{i}) }{1+\exp (\eta _{i})}$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq21.gif"/></alternatives></inline-formula> for binary outcomes. Value <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{i}=0.5{\omega } \times (\text {scale}(x_{1i})+\text {scale}(x_{2i})) + \sum _{m=1}^{M}\beta _{m}\times \text {scale}(z_{im})$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mi>ω</mml:mi><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mtext>scale</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mtext>scale</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mtext>scale</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">im</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq22.gif"/></alternatives></inline-formula>, where <italic>x</italic><sub>1<italic>i</italic></sub> and <italic>x</italic><sub>2<italic>i</italic></sub> are covariates; <italic>z</italic><sub><italic>im</italic></sub> is the count of causal OTU <italic>m</italic> for subject <italic>i</italic>; and <italic>ω</italic>=1 or 0 is a parameter controlling if there are covariate effects. The “scale” function is to standardize the variable to mean 0 and standard deviation 1. Variable <italic>x</italic><sub>1<italic>i</italic></sub> is simulated from Bernoulli(0.5) and is independent of the OTU counts, while variable <italic>x</italic><sub>2<italic>i</italic></sub> is correlated with causal OTUs by letting <italic>x</italic><sub>2<italic>i</italic></sub>∼<italic>N</italic>(<italic>δ</italic><sub><italic>i</italic></sub>,1) with <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta _{i} =\text {scale}(\sum _{m \in \text {causal OTUs}}z_{im})$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>scale</mml:mtext><mml:mo>(</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mtext>causal OTUs</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">im</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq23.gif"/></alternatives></inline-formula>. For non-causal OTUs, <italic>β</italic><sub><italic>m</italic></sub>=0; for causal OTUs, <italic>β</italic><sub><italic>m</italic></sub>∼normal(<italic>ν</italic>,<italic>ν</italic>/5) or normal (−<italic>ν</italic>,<italic>ν</italic>/5) dependent on the scenario. We considered |<italic>ν</italic>| to be 0.2 (small effect size) and 0.5 (large effect size) for continuous outcomes and to be 0.3 (small effect size) and 1 (large effect size) for binary outcomes. In each setting, we considered <italic>ω</italic>=0 (no covariate effects) and <italic>ω</italic>=1 (with covariate effects).</p>
      </sec>
      <sec id="Sec9">
        <title>Determining appropriate <italic>c</italic><sub>max</sub></title>
        <p>To determine the appropriate <italic>c</italic><sub>max</sub> for POST, we conducted 100 replications under each of the 5 causal scenarios in simulations A and B and used the decision rule that an OTU is selected as important if <italic>p</italic>-value &lt;0.05 and as not important otherwise. Using this decision rule, we report the true-positive rate (TPR), false-positive rate (FPR) and a composite measure by taking the harmonic mean of TPR and (1-FPR), which is referred to as the pseudo-<italic>F</italic> score. The TPR was obtained by first computing the fraction of detected causal OTUs among all causal OTUs in each replication and then averaging across the 100 replications; the FPR was obtained by first computing the fraction of detected non-causal OTUs among all non-causal OTUs in each replication and then averaging across the 100 replications; and the pseudo-<italic>F</italic> was obtained by taking the harmonic mean of the TPR and 1 −FPR in each replication and then averaging across the 100 replications.</p>
      </sec>
      <sec id="Sec10">
        <title>Performance assessment</title>
        <p>To examine the validity of POST, we set <italic>β</italic><sub><italic>m</italic></sub>=0 for all OTUs and report the type I error rates and the quantile-quantile (Q-Q) plots of the null <italic>p</italic>-values based on 4000 replications under simulations A and B. To examine the performance of selecting causal OTUs, we report the area under the receiver operating characteristic (ROC) curves (AUC in short) based on the 100 replications under each simulation setting from the 5 causal scenarios. AUC can assess the performance over various selection thresholds and account for both TPR and FPR. The AUC was obtained as follows. (1) In each replication, we computed the FDR-adjusted <italic>p</italic>-values of a method, based on which we then computed the FPR and TPR at varying significance thresholds. (2) We took the average FPR and average TPR across the 100 replications at each of the significant thresholds. (3) We constructed the ROC curve using the average FPRs and TPRs and computed the corresponding AUC. We used the two-stage BH (TSBH) FDR procedure [<xref ref-type="bibr" rid="CR33">33</xref>] to compute the FDR-adjusted <italic>p</italic>-values for all methods except for TF, which directly gives FDR-adjust <italic>p</italic>-values. TSBH has been shown to yield good performance for correlated <italic>p</italic>-values [<xref ref-type="bibr" rid="CR34">34</xref>] and is implemented in R function “mt.rawp2adjp” of R package <italic>multtest</italic>.</p>
        <p>We compare POST with 7 baseline approaches: (1) TreeFDR (TF) of Xiao et al. [<xref ref-type="bibr" rid="CR14">14</xref>] as implemented by the function “MicrobiomeSeqTreeFDR” in R package <italic>StructFDR</italic>; (2) single-OTU test (SO), by setting <italic>c</italic>=0 in POST; (3) DESeq2 (DE) of Love et al. [<xref ref-type="bibr" rid="CR35">35</xref>] as implemented by the function “DESeq” with the default Wald test in the R package <italic>DeSeq2</italic>; (4) ANCOM-BC (AB) of Lin et al. [<xref ref-type="bibr" rid="CR36">36</xref>] as implemented by the function “ancombc” in the R package <italic>ANCOMBC</italic>; (5) LinDA (LD) of Zhou et al. [<xref ref-type="bibr" rid="CR37">37</xref>] as implemented in the function “linda” in R package <italic>LinDA</italic>; and (6) Wilcoxon rank-sum test on the proportional data (WR-P) and on the CLR transformed data (WR-R) as implemented in the function “wilcox.test.” The Wilcoxon test is only appropriate for binary outcomes with no covariate effects. We also consider (7) Spearman correlation test on proportional data (SC-P) and on the CLR transformed data (SC-R) as implemented by the function “cor.test” of the <italic>stats</italic> R package. The Spearman test is only appropriate for continuous outcomes with no covariate effects. Among these methods, POST and TF incorporate phylogenetic tree information. POST, SO, LD, WR-R, and SC-R use the CLR transformation to address the compositional nature of microbiome data.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <sec id="Sec12">
      <title>Simulation results</title>
      <sec id="Sec13">
        <title>Appropriate <italic>c</italic><sub>max</sub></title>
        <p>To identify the appropriate value of <italic>c</italic><sub>max</sub>, the upper bound of <italic>c</italic>, we examined the trajectory of pseudo-<italic>F</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1) over different values of <italic>c</italic><sub>max</sub>, ranging from 0 (which corresponds to zero OTU neighbors) and 0.1 (which corresponds to a relatively large number of OTU neighbors) as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. An ideal <italic>c</italic><sub>max</sub> should permit information borrowing only from OTUs within a localized neighborhood in the phylogenetic tree. In addition, because incorporating too much information from irrelevant phylogenetic neighboring OTUs would lead to undesirable TPRs and FPRs, the ideal <italic>c</italic><sub>max</sub> is expected to occur at some turning point with which the increment of pseudo-<italic>F</italic> trajectory stops or slows down. Factoring in these two criteria, we found that <italic>c</italic><sub>max</sub>=0.05 appears to offer a robust choice across the different scenarios in simulations A and B and implemented POST with <italic>c</italic><sub>max</sub>=0.05 hereafter.</p>
      </sec>
      <sec id="Sec14">
        <title>Validity of POST</title>
        <p>We checked the behavior of POST under the global null hypothesis of no causal OTUs. Table <xref rid="Tab1" ref-type="table">1</xref> shows that the type I error rate is appropriately controlled at nominal levels of 0.05, 0.01, and 0.001. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2 shows the corresponding Q-Q plots of POST <italic>p</italic>-values, where the observed POST <italic>p</italic>-values agree with the expected <italic>p</italic>-values from Uniform (0,1), confirming the validity of POST.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Type I error rates at the significance levels of 0.05, 0.01, and 0.001 for POST</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Simulation</th><th align="left">Outcome</th><th align="left"><italic>a</italic> = 0.05</th><th align="left"><italic>a</italic> = 0.01</th><th align="left"><italic>a</italic> = 0.001</th><th align="left"><italic>a</italic> = 0.0001</th></tr></thead><tbody><tr><td align="left">A</td><td align="left">Binary</td><td align="left">0.047</td><td align="left">0.007</td><td align="left">0.0006</td><td align="left">0.00005</td></tr><tr><td align="left">B</td><td align="left">Continuous</td><td align="left">0.051</td><td align="left">0.010</td><td align="left">0.0010</td><td align="left">0.00008</td></tr><tr><td align="left"/><td align="left">Binary</td><td align="left">0.047</td><td align="left">0.008</td><td align="left">0.0006</td><td align="left">0.00007</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec15">
        <title>Selection performance</title>
        <p>Next, we examined the relative performance of POST against the baseline methods using AUC (Table <xref rid="Tab2" ref-type="table">2</xref> for simulations A and B without covariate effects; Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1 for simulation B with covariate effects). In simulation A, we observe that POST and TF have larger AUC than those methods that do not use tree information when causal OTUs are clustered in large hubs (scenarios 1–3) or small hubs (scenario 4) (Table <xref rid="Tab2" ref-type="table">2</xref>; Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Furthermore, POST has larger AUC than TF, suggesting that POST can further boost power through adaptive information collapsing from evolutionarily close OTUs at the level of OTU abundances, compared to TF, which collapses information at the level of OTU <italic>p</italic>-values. The superior performance of POST is consistently observed regardless of whether the effects of nearby causal OTUs are in the same direction (scenarios 1 and 2) or opposite directions (scenarios 3 and 4), and whether the effect sizes are large or small. In scenario 5, where causal OTUs are randomly distributed in the phylogenetic tree, POST performed comparably to the best-performing methods. Among the non-tree based methods, SO, DE, AB, and LD had similar AUCs and are better than the Wilcoxon rank-sum test. The Wilcoxon rank-sum test using proportional data have slightly higher AUC than using CLR transformed data.
<fig id="Fig4"><label>Fig. 4</label><caption><p>ROC curves of simulation A with large OTU effect size (top row) and small OTU effect size (bottom row) for POST, Single-OTU test (SO), TreeFDR (TF), DESeq2 (DE), ANCOM-BC (AB), LinDA (DA), and Wilcoxon rank-sum test (WR) under the 5 causal scenarios. Scenarios 1 to 3 consider larger “causal hubs,” each containing about 7–10 causal OTUs; scenario 4 considers smaller causal hubs of 2–3 causal OTUs; scenario 5 considers causal OTUs with random positions in the phylogenetic tree</p></caption><graphic xlink:href="40168_2022_1266_Fig4_HTML" id="MO4"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>AUC of different methods in simulations A and B. Methods considered include POST, TreeFDR (TF), Single-OTU test (SO) implemented by POST with <italic>c</italic>=0, DESeq2 (DE), ANCOM-BC (AB) and LinDA (LD), Wilcoxon rank-sum test with proportional data (WR-P) or CLR transformed data (WR-R) for binary outcomes, and Spearman correlation test with proportional data (SC-P) or CLR transformed data (SC-R) for continuous outcomes. The outcome values are simulated assuming no covariate effects and 5 different causal OTU scenarios. Scenarios 1 to 3 consider larger “causal hubs,” each containing about 7–10 causal OTUs; scenario 4 considers smaller causal hubs of 2–3 causal OTUs; scenario 5 considers causal OTUs with random positions in the phylogenetic tree. Methods with the highest AUC are shown in bold</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Simulation</th><th align="left" colspan="8">Simulation A</th><th align="left" colspan="16">Simulation B</th></tr><tr><th align="left">Outcome</th><th align="left" colspan="8">Binary outcome</th><th align="left" colspan="8">Continuous outcome</th><th align="left" colspan="8">Binary outcome</th></tr><tr><th align="left">Method</th><th align="left">POST</th><th align="left">TF</th><th align="left">SO</th><th align="left">DE</th><th align="left">AB</th><th align="left">LD</th><th align="left">WR-P</th><th align="left">WR-R</th><th align="left">POST</th><th align="left">TF</th><th align="left">SO</th><th align="left">DE</th><th align="left">AB</th><th align="left">LD</th><th align="left">SC-P</th><th align="left">SC-R</th><th align="left">POST</th><th align="left">TF</th><th align="left">SO</th><th align="left">DE</th><th align="left">AB</th><th align="left">LD</th><th align="left">WR-P</th><th align="left">WR-R</th></tr></thead><tbody><tr><td align="left" colspan="25">Large effect size*</td></tr><tr><td align="left"> Scenario1</td><td align="left"><bold>0.80</bold></td><td align="left">0.78</td><td align="left">0.62</td><td align="left">0.69</td><td align="left">0.54</td><td align="left">0.56</td><td align="left">0.51</td><td align="left">0.51</td><td align="left"><bold>0.64</bold></td><td align="left">0.52</td><td align="left">0.58</td><td align="left">0.61</td><td align="left">0.57</td><td align="left">0.61</td><td align="left">0.57</td><td align="left">0.61</td><td align="left">0.58</td><td align="left">0.53</td><td align="left">0.55</td><td align="left">0.52</td><td align="left">0.57</td><td align="left"><bold>0.59</bold></td><td align="left">0.54</td><td align="left">0.55</td></tr><tr><td align="left"> Scenario2</td><td align="left"><bold>0.88</bold></td><td align="left">0.77</td><td align="left">0.71</td><td align="left">0.71</td><td align="left">0.70</td><td align="left">0.67</td><td align="left">0.62</td><td align="left">0.58</td><td align="left"><bold>0.66</bold></td><td align="left">0.50</td><td align="left">0.62</td><td align="left">0.65</td><td align="left">0.62</td><td align="left">0.62</td><td align="left">0.57</td><td align="left">0.51</td><td align="left">0.60</td><td align="left">0.48</td><td align="left">0.56</td><td align="left">0.57</td><td align="left"><bold>0.61</bold></td><td align="left">0.56</td><td align="left">0.52</td><td align="left">0.51</td></tr><tr><td align="left"> Scenario3</td><td align="left"><bold>0.88</bold></td><td align="left">0.78</td><td align="left">0.72</td><td align="left">0.70</td><td align="left">0.64</td><td align="left">0.64</td><td align="left">0.60</td><td align="left">0.60</td><td align="left"><bold>0.70</bold></td><td align="left">0.49</td><td align="left">0.62</td><td align="left">0.63</td><td align="left">0.61</td><td align="left">0.62</td><td align="left">0.58</td><td align="left">0.51</td><td align="left"><bold>0.63</bold></td><td align="left">0.50</td><td align="left">0.59</td><td align="left">0.55</td><td align="left">0.58</td><td align="left">0.58</td><td align="left">0.57</td><td align="left">0.51</td></tr><tr><td align="left"> Scenario4</td><td align="left"><bold>0.78</bold></td><td align="left">0.75</td><td align="left">0.70</td><td align="left">0.69</td><td align="left">0.70</td><td align="left">0.67</td><td align="left">0.62</td><td align="left">0.58</td><td align="left"><bold>0.63</bold></td><td align="left">0.48</td><td align="left">0.61</td><td align="left"><bold>0.63</bold></td><td align="left">0.58</td><td align="left">0.61</td><td align="left">0.58</td><td align="left">0.52</td><td align="left"><bold>0.56</bold></td><td align="left">0.49</td><td align="left"><bold>0.56</bold></td><td align="left">0.54</td><td align="left">0.55</td><td align="left">0.55</td><td align="left">0.55</td><td align="left">0.51</td></tr><tr><td align="left"> Scenario5</td><td align="left">0.66</td><td align="left"><bold>0.72</bold></td><td align="left">0.67</td><td align="left">0.64</td><td align="left">0.65</td><td align="left">0.63</td><td align="left">0.57</td><td align="left">0.55</td><td align="left">0.59</td><td align="left">0.48</td><td align="left">0.60</td><td align="left"><bold>0.61</bold></td><td align="left">0.59</td><td align="left">0.60</td><td align="left">0.54</td><td align="left">0.51</td><td align="left">0.54</td><td align="left">0.50</td><td align="left">0.54</td><td align="left">0.52</td><td align="left"><bold>0.57</bold></td><td align="left">0.55</td><td align="left">0.53</td><td align="left">0.50</td></tr><tr><td align="left" colspan="25">Small effect size*</td></tr><tr><td align="left"> Scenario1</td><td align="left"><bold>0.72</bold></td><td align="left">0.65</td><td align="left">0.59</td><td align="left">0.62</td><td align="left">0.57</td><td align="left">0.57</td><td align="left">0.53</td><td align="left">0.51</td><td align="left"><bold>0.62</bold></td><td align="left">0.48</td><td align="left">0.56</td><td align="left">0.58</td><td align="left">0.56</td><td align="left">0.59</td><td align="left">0.55</td><td align="left">0.56</td><td align="left">0.56</td><td align="left">0.49</td><td align="left">0.53</td><td align="left">0.52</td><td align="left">0.54</td><td align="left"><bold>0.57</bold></td><td align="left">0.52</td><td align="left">0.52</td></tr><tr><td align="left"> Scenario2</td><td align="left"><bold>0.76</bold></td><td align="left">0.65</td><td align="left">0.61</td><td align="left">0.62</td><td align="left">0.63</td><td align="left">0.62</td><td align="left">0.58</td><td align="left">0.55</td><td align="left"><bold>0.62</bold></td><td align="left">0.49</td><td align="left">0.59</td><td align="left">0.61</td><td align="left">0.59</td><td align="left">0.59</td><td align="left">0.54</td><td align="left">0.51</td><td align="left">0.54</td><td align="left">0.49</td><td align="left">0.53</td><td align="left">0.55</td><td align="left"><bold>0.56</bold></td><td align="left">0.53</td><td align="left">0.51</td><td align="left">0.50</td></tr><tr><td align="left"> Scenario3</td><td align="left"><bold>0.76</bold></td><td align="left">0.65</td><td align="left">0.63</td><td align="left">0.62</td><td align="left">0.62</td><td align="left">0.60</td><td align="left">0.57</td><td align="left">0.55</td><td align="left"><bold>0.66</bold></td><td align="left">0.49</td><td align="left">0.60</td><td align="left">0.60</td><td align="left">0.58</td><td align="left">0.60</td><td align="left">0.56</td><td align="left">0.50</td><td align="left"><bold>0.59</bold></td><td align="left">0.50</td><td align="left">0.56</td><td align="left">0.55</td><td align="left">0.55</td><td align="left">0.56</td><td align="left">0.54</td><td align="left">0.50</td></tr><tr><td align="left"> Scenario4</td><td align="left"><bold>0.69</bold></td><td align="left">0.65</td><td align="left">0.62</td><td align="left">0.62</td><td align="left">0.64</td><td align="left">0.62</td><td align="left">0.58</td><td align="left">0.55</td><td align="left"><bold>0.60</bold></td><td align="left">0.48</td><td align="left">0.58</td><td align="left"><bold>0.60</bold></td><td align="left">0.57</td><td align="left">0.58</td><td align="left">0.56</td><td align="left">0.51</td><td align="left"><bold>0.54</bold></td><td align="left">0.50</td><td align="left">0.53</td><td align="left">0.53</td><td align="left">0.52</td><td align="left"><bold>0.54</bold></td><td align="left">0.53</td><td align="left">0.51</td></tr><tr><td align="left"> Scenario5</td><td align="left">0.59</td><td align="left">0.58</td><td align="left">0.59</td><td align="left">0.58</td><td align="left"><bold>0.60</bold></td><td align="left">0.58</td><td align="left">0.54</td><td align="left">0.52</td><td align="left">0.56</td><td align="left">0.50</td><td align="left">0.56</td><td align="left"><bold>0.57</bold></td><td align="left">0.56</td><td align="left"><bold>0.57</bold></td><td align="left">0.53</td><td align="left">0.50</td><td align="left"><bold>0.53</bold></td><td align="left">0.50</td><td align="left">0.52</td><td align="left">0.52</td><td align="left"><bold>0.53</bold></td><td align="left"><bold>0.53</bold></td><td align="left">0.52</td><td align="left">0.50</td></tr></tbody></table><table-wrap-foot><p>*For simulation A, small OTU effect size is from <italic>N</italic>(±1,1) and large OTU effect size is from <italic>N</italic>(±2,1). For simulations B, small OTU effect size is simulated from <italic>N</italic>(±0.2, 0.04) and <italic>N</italic>(±0.3,0.06) for continuous and binary outcomes, respectively; large OTU effect size is simulated from <italic>N</italic>(±0.5, 0.1) and <italic>N</italic>(±1,0.2) for continuous and binary outcomes, respectively</p></table-wrap-foot></table-wrap></p>
        <p>In simulation B, POST has the largest AUC or similar AUC to the best-performing method in all scenarios, regardless of the effect sizes, without covariates (Table <xref rid="Tab2" ref-type="table">2</xref>) or with covariates (Additional File <xref rid="MOESM3" ref-type="media">3</xref>: Table S1). DE, AB, and LD had similar AUCs and can perform the best even in some of scenarios 1–4 although they did not incorporate tree information. We also observe that TF has an AUC around 0.5 in most scenarios. A closer examination suggests that this may be because the signal strengths in simulation B are much smaller than those in simulation A, based on the way that the data were simulated. Consequently, TF yields many large, tied FDR adjusted <italic>p</italic>-values in simulation B, while other methods yield fewer tied adjusted <italic>p</italic>-values with relatively smaller values than those of TF.</p>
        <p>In summary, across different simulation scenarios, POST has better or comparable performance compared to the baseline methods. POST tends to have the largest AUC among all methods (e.g., in scenarios 1–4 of informative trees); if not (e.g., in scenario 5 of non-informative trees), POST has its AUC comparable to the top methods, which can either be TF, SO, DE, AB or LD, depending on simulation settings.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Real data analysis</title>
      <p>We applied POST to two microbiome datasets, both at the level of OTUs formed at ≤3% dissimilarity and at the level of ASVs. We present the OTU-level results below and the ASV-level results in Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Section S1. In all analyses, we considered TF, SO, AB, LD, WR-P, and WR-R as baselines. We included race as a covariate except for WR-based methods. We used the TSBH procedure [<xref ref-type="bibr" rid="CR33">33</xref>] to compute the FDR-adjusted <italic>p</italic>-values except for TF, which outputted its own FDR-adjusted <italic>p</italic>-values. We selected important OTUs/ASVs using the decision rule of FDR-adjusted <italic>p</italic>-values &lt;0.05.</p>
      <sec id="Sec17">
        <title>Association study of vaginal microbiome and bacterial vaginosis</title>
        <p>Bacterial vaginosis (BV) is a type of vaginal inflammation and is characterized by low levels of lactobacilli and overgrowth of various anaerobic bacteria [<xref ref-type="bibr" rid="CR38">38</xref>]. BV is most often diagnosed using the Amsel criteria or microscopy-based Nugent scoring [<xref ref-type="bibr" rid="CR39">39</xref>] but with limited accuracy [<xref ref-type="bibr" rid="CR40">40</xref>]. High-throughput sequencing technologies such as 16S rRNA amplicon sequencing have been used to study the species diversity of vaginal microbiota and have shown promise as an alternative assessment of BV for practical and accurate diagnosis [<xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR43">43</xref>].</p>
        <p>We conducted an OTU-specific analysis using the 16S rRNA gene sequencing dataset of vaginal microbiome from [<xref ref-type="bibr" rid="CR43">43</xref>] to evaluate the association between BV and the normal vaginal microbiome. The dataset consists 39 individuals, and the sequencing data and metadata are publicly available at NCBI SRA database (PRJNA600021). Initial processing leads to the abundance data of 2711 OTUs formed at 97% similarity. We employed <italic>FastTree2</italic> [<xref ref-type="bibr" rid="CR23">23</xref>] to infer the phylogenetic tree using the OTU sequences. Finally, we filtered out OTUs with abundance &lt; 0.005% and prevalence &lt; 10% and analyzed the resulting 186 OTUs of 39 individuals for BV association studies.</p>
        <p>The Upset plot (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A) shows that POST, TF, SO, DE, AB, LD, WR-P, and WR-R identified 7, 2, 1, 5, 1, 1, 3, and 1 significant OTUs, respectively. Table <xref rid="Tab3" ref-type="table">3</xref> lists the OTUs detected by each method and their mapped genus/species with 100% sequence identity among vaginal microbiome. We organized our findings as follows. (i) Among the 7 POST-detected OTUs, OTU3 (mapped to <italic>Lactobacillus crispatus</italic>) is also identified by SO, DE, AB, LD, and WR-R. Depletion of <italic>Lactobacillus crispatus</italic> has been shown to be highly associated with BV [<xref ref-type="bibr" rid="CR44">44</xref>]. POST also identifies 6 additional OTUs as important (among which OTU66 is also identified by DE); these OTUs are all mapped to <italic>Lactobacillus</italic>species, including <italic>Lactobacillus jensennii</italic>, <italic>Lactobacillus gasseri</italic>, and <italic>Lactobacillus iners</italic>. These vaginal <italic>Lactobacillus</italic> species have been shown to have different abundances in women with vs. without BV [<xref ref-type="bibr" rid="CR44">44</xref>] and play important roles in ithe vaginal ecosystem [<xref ref-type="bibr" rid="CR45">45</xref>]. (ii) TF identified 2 OTUs, i.e., OTU112 (mapped to <italic>Peptoniphilus</italic> sp. and also identified by WR-P) and OTU85 (mapped to <italic>Gemella</italic> sp.); these genera have also been detected in BV cases [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. (iii) Besides the OTUs discussed above, DE and/or WR-P also identify 4 other OTUs (i.e., OTU11, OTU12, OTU16, and OTU91), which are all mapped to genus <italic>Prevotella</italic>, and OTU16 (<italic>Prevotella timonensis</italic>) has been found to be associated with BV [<xref ref-type="bibr" rid="CR48">48</xref>]. (iv) It seems that POST, SO, LD, and WR-R (i.e., methods based on CLR-transformed data) miss some of the OTUs identified by TF, DE, and WR-P (i.e., methods based on proportional data), although there are also OTUs detected by both types of methods. (v) Fig. <xref rid="Fig5" ref-type="fig">5</xref>B shows the relative positions of the identified OTUs in the phylogenetic tree, where POST identified OTUs tend to be more clustered together compared to other methods.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Upset plot of detected OTUs at FDR level of 0.05 and phylogenetic trees of the analyzed OTUs with detected OTUs for bacterial vaginosis study. SO, single-OTU test implemented by POST with <italic>c</italic> = 0; TF, TreeFDR; DE, DESeq2; AB, ANCOM-BC; LD, LinDA; WR-P, Wilcoxon rank-sum test using proportional data; WR-R, Wilcoxon rank-sum test using CLR transformed data</p></caption><graphic xlink:href="40168_2022_1266_Fig5_HTML" id="MO5"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>OTUs significantly associated with bacterial vaginosis (BV) at FDR level of 0.05. TF, TreeFDR; SO, Single-OTU test implemented by POST with <italic>c</italic> = 0; DE, DESeq2; AB, ANCOM-BC; LD, LinDA; WR-P, Wilcoxon rank-sum test using proportional data; WR-R, Wilcoxon rank-sum test using the CLR transformed data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">OTU</th><th align="left" colspan="8">FDR-adjusted <italic>p</italic>-value</th><th align="left">Detected method</th><th align="left">Genus/species</th><th align="left">Direction**</th></tr><tr><th align="left"/><th align="left">POST</th><th align="left">TF</th><th align="left">SO</th><th align="left">DE</th><th align="left">AB</th><th align="left">LD</th><th align="left">WR-P*</th><th align="left">WR-R*</th><th align="left"/><th align="left"/><th align="left"/></tr></thead><tbody><tr><td align="left">OTU3</td><td align="left">0.039</td><td align="left">0.089</td><td align="left">0.045</td><td align="left">0.002</td><td align="left">0.006</td><td align="left">0.041</td><td align="left">0.178</td><td align="left">0.025</td><td align="left">POST/SO/DE/AB/LD/WR-R</td><td align="left"><italic>Lactobacillus crispatus</italic></td><td align="left">-</td></tr><tr><td align="left">OTU90</td><td align="left">0.039</td><td align="left">0.245</td><td align="left">0.953</td><td align="left">0.950</td><td align="left">0.983</td><td align="left">0.961</td><td align="left">0.375</td><td align="left">0.989</td><td align="left">POST</td><td align="left"><italic>Lactobacillus</italic> sp.</td><td align="left">+</td></tr><tr><td align="left">OTU7</td><td align="left">0.039</td><td align="left">0.653</td><td align="left">0.881</td><td align="left">0.147</td><td align="left">0.766</td><td align="left">0.729</td><td align="left">0.760</td><td align="left">0.932</td><td align="left">POST</td><td align="left"><italic>Lactobacillus jensenii</italic></td><td align="left">-</td></tr><tr><td align="left">OTU82</td><td align="left">0.039</td><td align="left">0.517</td><td align="left">0.985</td><td align="left">0.970</td><td align="left">0.963</td><td align="left">0.976</td><td align="left">0.258</td><td align="left">0.989</td><td align="left">POST</td><td align="left"><italic>Lactobacillus gasseri</italic></td><td align="left">-</td></tr><tr><td align="left">OTU66</td><td align="left">0.039</td><td align="left">0.544</td><td align="left">0.701</td><td align="left">0.027</td><td align="left">0.379</td><td align="left">0.615</td><td align="left">0.378</td><td align="left">0.932</td><td align="left">POST/DE</td><td align="left"><italic>Lactobacillus</italic> sp.</td><td align="left">-</td></tr><tr><td align="left">OTU2</td><td align="left">0.039</td><td align="left">0.180</td><td align="left">0.917</td><td align="left">0.876</td><td align="left">0.766</td><td align="left">0.923</td><td align="left">0.235</td><td align="left">0.989</td><td align="left">POST</td><td align="left"><italic>Lactobacillus iners</italic></td><td align="left">+</td></tr><tr><td align="left">OTU58</td><td align="left">0.039</td><td align="left">0.839</td><td align="left">0.917</td><td align="left">0.876</td><td align="left">0.871</td><td align="left">0.923</td><td align="left">0.791</td><td align="left">0.989</td><td align="left">POST</td><td align="left"><italic>Lactobacillus</italic> sp.</td><td align="left">+</td></tr><tr><td align="left">OTU112</td><td align="left">0.411</td><td align="left">0.046</td><td align="left">0.701</td><td align="left">0.422</td><td align="left">0.379</td><td align="left">0.678</td><td align="left">0.040</td><td align="left">0.932</td><td align="left">TF/WR-P</td><td align="left"><italic>Peptoniphilus</italic> sp.</td><td align="left">+</td></tr><tr><td align="left">OTU85</td><td align="left">0.470</td><td align="left">0.046</td><td align="left">0.906</td><td align="left">0.372</td><td align="left">0.766</td><td align="left">0.870</td><td align="left">0.097</td><td align="left">0.989</td><td align="left">TF</td><td align="left"><italic>Gemella</italic> sp.</td><td align="left">+</td></tr><tr><td align="left">OTU11</td><td align="left">0.918</td><td align="left">0.286</td><td align="left">0.943</td><td align="left">0.000</td><td align="left">0.869</td><td align="left">0.923</td><td align="left">0.220</td><td align="left">0.989</td><td align="left">DE</td><td align="left"><italic>Prevotella</italic> sp.</td><td align="left">+</td></tr><tr><td align="left">OTU12</td><td align="left">0.391</td><td align="left">0.089</td><td align="left">0.701</td><td align="left">0.013</td><td align="left">0.338</td><td align="left">0.615</td><td align="left">0.040</td><td align="left">0.942</td><td align="left">DE/WR-P</td><td align="left"><italic>Prevotella</italic> sp.</td><td align="left">+</td></tr><tr><td align="left">OTU16</td><td align="left">0.680</td><td align="left">0.155</td><td align="left">0.881</td><td align="left">0.001</td><td align="left">0.766</td><td align="left">0.918</td><td align="left">0.097</td><td align="left">0.989</td><td align="left">DE</td><td align="left"><italic>Prevotella timonensis</italic></td><td align="left">+</td></tr><tr><td align="left">OTU91</td><td align="left">0.680</td><td align="left">0.092</td><td align="left">0.881</td><td align="left">0.505</td><td align="left">0.766</td><td align="left">0.852</td><td align="left">0.040</td><td align="left">0.989</td><td align="left">WR-P</td><td align="left"><italic>Prevotella</italic> sp.</td><td align="left">+</td></tr></tbody></table><table-wrap-foot><p>*WR-P and WR-R did not adjust for race</p><p>**+ (and −) indicates that the OTU is positively (and negatively) associated with BV risk from a logistic regression</p></table-wrap-foot></table-wrap></p>
        <p>We further illustrated the data-adaptiveness of POST using OTU2 (average proportional abundance 0.22, mapped to <italic>Lactobacillus iners</italic>, and only identified by POST) and OTU3 (average proportional abundance 0.26, mapped to <italic>Lactobacillus crispatus</italic>, and identified by POST, SO, DE, AB, LD, and WR-R). The abundance boxplots (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Fig. S3) show that OTU2 has higher abundance in BV patients compared to healthy women, while OTU3 has an opposite pattern. Our findings agree with the literature that BV patients have loss of many <italic>Lactobacillus</italic> species except <italic>Lactobacillus iners</italic> [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR49">49</xref>]. When testing for OTU2, the best <italic>c</italic> determined by the data is <italic>c</italic>=0.03, suggesting some information borrowing from neighboring OTUs (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Fig. S4A), e.g., OTU7 has <italic>r</italic><sub>7,2</sub>=0.74 and OTU3 has <italic>r</italic><sub>3,2</sub>=0.52 in Eq. (<xref rid="Equ2" ref-type="">2</xref>). This example illustrates that (i) POST can incorporate information with opposite directions, and (ii) the information borrowing is OTU-specific and data-driven—when testing for OTU3, the best <italic>c</italic> is <italic>c</italic>=0, i.e., no information borrowing from any neighboring OTUs (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Fig. S4B).</p>
      </sec>
      <sec id="Sec18">
        <title>Association study of vaginal microbiome and preterm birth</title>
        <p>Preterm birth is a major cause of neonatal morbidity and mortality. Previous studies have suggested that the risk of preterm birth is associated with vaginal microbiota composition, especially certain species/genera including <italic>Lactobacillus crispatus</italic>, <italic>Lactobacillus iners</italic>, <italic>BVAB1</italic>, <italic>Sneathia amnii</italic>, and some <italic>Prevotella</italic> species [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. We performed an OTU-specific analysis on the Stanford cohort data of Callahan et al. [<xref ref-type="bibr" rid="CR50">50</xref>] to identify OTUs associated with preterm birth. We applied the same data processing steps as in the BV study and obtained 746 OTUs and 39 individuals. After excluding OTUs with abundance &lt;0.005<italic>%</italic> and present rate &lt;10<italic>%</italic>, we based our analysis on the 95 remaining OTUs.</p>
        <p>Figure <xref rid="Fig6" ref-type="fig">6</xref>A shows that POST, TF, SO, DE, AB, LD, WR-P, and WR-R identified 3, 2, 1, 11, 6, 4, 10, and 2 significant OTUs, respectively. Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S2 shows the significant OTUs, their detection methods, and the corresponding genus/species. Figure <xref rid="Fig6" ref-type="fig">6</xref>B shows the relative positions of the identified OTUs in the phylogenetic tree. The results can be summarized as follows. (i) All of the 3 POST-detected OTUs have also been detected by at least 1 baseline method, i.e., OTU131 (mapped to <italic>Prevotella</italic> sp.), which is also found significant by all baseline methods except TF; OTU40 (mapped to <italic>Prevotella melaninogenica</italic>), which is also identified by DE; and OTU153 (mapped to <italic>Neisseria</italic> sp.), which is also identified by all baseline methods except SO. The <italic>Prevotella</italic> genus has been reported to be associated with preterm birth [<xref ref-type="bibr" rid="CR12">12</xref>]; OTU153 has 97.45% (229/235) sequence identity with <italic>Neisseria gonorrhoeae</italic>, which causes one type of sexually transmitted infection and has been reported to be associated with preterm birth [<xref ref-type="bibr" rid="CR51">51</xref>, <xref ref-type="bibr" rid="CR52">52</xref>]. (ii) There were 4 OTUs that were identified by ≥1 baseline method but missed by POST: OTU72, OTU126, OTU31, and OTU44. OTU72 (mapped to <italic>Haemophilus parainfluenzae</italic>) was identified by TF, AB, LD, and WR-P, and <italic>Haemophilus parainfluenzae</italic> has been reported to play a potential role in preterm birth [<xref ref-type="bibr" rid="CR53">53</xref>]. OTU44 (mapped to <italic>Fusobacterium nucleatum</italic> and identified by AB, LD, and WR-P), has been reported associated with preterm birth [<xref ref-type="bibr" rid="CR54">54</xref>]. We found no supporting evidence in the literature regarding the association with preterm birth for OTU126 (mapped to <italic>Cloacibacterium</italic> sp. and identified by DE and WR-P) or for OTU31 (mapped to <italic>Staphylococcus anginosus</italic> and identified by AB and WR-P).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Upset plot of detected OTUs at FDR level of 0.05 and phylogenetic trees of the analyzed OTUs with detected OTUs for preterm birth study. SO, Single-OTU test implemented by POST with <italic>c</italic> = 0; TF, TreeFDR; DE, DESeq2; AB, ANCOM-BC; LD, LinDA; WR-P, Wilcoxon rank-sum test using proportional data; WR-R,Wilcoxon rank-sum test using the CLR transformed data</p></caption><graphic xlink:href="40168_2022_1266_Fig6_HTML" id="MO6"/></fig></p>
        <p>(iii) Besides the OTUs discussed above, DE uniquely identified 7 OTUs. Among these OTUs, OTU2 (mapped to <italic>Lactobacillus crispatus</italic>) and OTU8 (mapped to <italic>Prevotella</italic> sp.) have been found associated with preterm birth in the literature [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. OTU4 (mapped to Veillonellaceae bacterium), OTU71 (mapped to <italic>Alloscardovia omnicolens</italic>), and OTU19 (mapped to <italic>Staphylococcus aureus</italic>) have also be discussed in the literature, although they are reported as not associated with preterm birth [<xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR56">56</xref>]. We found no supporting evidence in the literature regarding the association with preterm birth for OTU114 (mapped to <italic>Lacticaseibacillus rhamnosus</italic>) or for OTU15 (mapped to <italic>Mycoplasma hominis</italic>). (iv) AB uniquely identified OTU7 (mapped to <italic>Clostridiales genomosp. BVAB1</italic>), which has been reported to be associated with preterm birth [<xref ref-type="bibr" rid="CR12">12</xref>]. (v) WR-P uniquely identified 4 OTUs, for which we did not find supporting evidence in the literature, and the associations diminish if switching to WR-R. (vi) We also observed that the CLR-based methods (e.g., POST, SO, LD, and WR-R) tend to identify fewer OTUs compared to the proportional-based methods (e.g., DE and WR-P).</p>
        <p>A final note is that the two data applications show different relative performance of POST compared to the baseline methods. In the BV study, POST detected several significant unique OTUs that were not identified by other methods. We discussed the biological relevance of these identified OTUs and examined the phylogenetic relationship among the identified OTUs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). The results suggest that these OTUs tend to be evolutionarily close and their signals might be easier to be detected by borrowing an appropriate amount information from appropriate neighboring OTUs. In contrast, in the preterm birth study, POST only identified OTUs that are also identified by other non-tree-based methods. In particular, POST had similar performance to SO, LD, and WR-R, suggesting the compatibility of POST to the non-tree based methods on CLR transformed data and the robustness of POST to non-informative phylogeny.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion and conclusions</title>
    <p>In this work, we proposed a phylogeny-guided OTU-specific test, POST. POST extends the kernel-based approaches from community-level analysis to OTU-level analysis, and evaluates the association of a focal OTU based on the abundance of itself as well as its phylogenetically close neighbors. POST allows closer neighboring OTUs to contribute more than distant neighbors and includes the standard single OTU tests as a special case (i.e., zero contribution from all neighboring OTUs). The actual contribution from neighboring OTUs is adaptively determined by data, using a tuning parameter <italic>c</italic> to identify the appropriate OTUs and the optimal amount from which to borrow information. We evaluated the performance of POST in different simulated scenarios and in real data applications. We showed that POST can enhance the selection performance by yielding more desirable true positive and false-positive detection when compared to commonly used tree-free and tree-guided methods: POST tends to have higher AUC when the phylogenetic tree is informative and have similar AUC when the phylogenetic tree is not informative.</p>
    <p>Here, we described POST based on OTUs formed at ≤3% sequence dissimilarity and the corresponding phylogenetic tree constructed using <italic>FastTree2</italic> [<xref ref-type="bibr" rid="CR23">23</xref>]. Although our specific testing results are restricted to this framework, the POST method is relevant to a broader class of metagenomic sequencing methods including marker-gene and shotgun sequencing methods, where reads are assigned taxonomy against a reference database with a pre-calculated phylogeny. However, there are a couple of points to keep in mind when extending the described framework to these more general scenarios. Recall that for a target OTU, its neighborhood and the amount of information to borrow are controlled via <italic>c</italic>. Because <italic>c</italic> is measured on the scale of the SD of pairwise OTU distances in the phylogenetic tree, <italic>c</italic> does not depend on the actual values of the OTU distance in a tree, and thus, POST can be applied on phylogenetic trees from different tools. For different taxonomic levels, some modifications may be needed because the upper bound of <italic>c</italic>, <italic>c</italic><sub>max</sub>, which controls the neighborhood boundary of an OTU, may or may not always be generalizable to OTUs defined at different level. For example, it would be dangerous to directly apply the current <italic>c</italic><sub>max</sub> to OTUs formed at &gt; 3% dissimilarity or higher taxonomic ranks (e.g., genus) because the current <italic>c</italic><sub>max</sub> may lead to too large a neighborhood in the tree for the focal OTU. On the other hand, the current <italic>c</italic><sub>max</sub> can be used for OTUs formed at ASV levels (i.e., 0% dissimilarity), with the price of possibly having a smaller OTU neighborhood than the actual optimal neighborhood to borrow information from. When needed, the proper <italic>c</italic><sub>max</sub> can be explored and determined using a similar simulation procedure as conducted in the paper so to assure that only OTUs from a meaningful, localized neighborhood would contribute to the association assessment of the focal OTU.</p>
    <p>It is possible to extend the POST framework to incorporate OTU correlation based on abundance/co-occurrence instead of phylogeny. Method 1 is to replace the OTU phylogenetic correlation (<italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub>) in step 1 with the OTU abundance correlations (such as computing <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub> using SparCC [<xref ref-type="bibr" rid="CR57">57</xref>]). A hyperparameter c will need to be integrated into <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub> to permit that the information borrowing is conducted in an outcome-supervised fashion. Method 2 is to replace the input phylogenetic tree in step 1 with a tree constructed based on abundance correlation or some network structures [<xref ref-type="bibr" rid="CR58">58</xref>], e.g., by first converting the abundance correlation to a dissimilarity matrix and then performing hierarchical clustering to form a “tree” as outlined in Bichat et al. [<xref ref-type="bibr" rid="CR19">19</xref>]. Method 2 can be directly implemented by the existing POST R package <italic>POSTm</italic>, although additional numerical studies would be needed to determine an appropriate <italic>c</italic><sub>max</sub> value. However, method 2 appears to incorporate some redundancy because in the existing POST workflow, the “tree” will then be converted into correlation (i.e., <italic>r</italic><sub><italic>ℓ</italic><italic>m</italic></sub>). Finally, given that which correlation type (abundance vs. phylogeny) would be informative of the underlying OTU association patterns is unknown in real practice, an important next step will be to construct an omnibus framework that can adaptively determine “which types” of correlation information to use besides “how much” information to borrow from correlated OTUs.</p>
    <p>In the real data analyses, we added a pseudo-count of 0.5 to the OTU count tables to handle the zero-count issues. It has been shown in the literature that the choice of pseudo-count can affect the association results [<xref ref-type="bibr" rid="CR59">59</xref>, <xref ref-type="bibr" rid="CR60">60</xref>]. For POST, we conducted sensitivity analyses to assess the impact of pseudo-counts, by comparing the results of pseudo-count 0.5 and pseudo-count 1 under simulation A (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S3) and in real data analyses (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Fig. S5). We observed that (1) the AUCs based on different pseudo-counts (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S3) are very similar across different scenarios and effect sizes. (2) The <italic>p</italic>-values obtained using different pseudo-counts (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Fig. S5) are highly correlated and fall along the 45-degree lines in the scatter plots. While some deviations may occur (e.g., in the BV analysis), the deviations were from non-small <italic>p</italic>-values. These results suggest that POST is fairly robust to the choices of pseudo-counts.</p>
    <p>In POST, we build the kernel matrix based on the non-phylogenetic Aitchison distance to account for the compositional nature of microbiome data [<xref ref-type="bibr" rid="CR61">61</xref>]. It is possible to construct local kernel using other distance metrics, such as the UniFrac distance family. For example, we can compute the local weighted UniFrac (WU) distance for OTU <italic>m</italic> between subjects <italic>i</italic> and <italic>j</italic> by <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {WU}_{ij}^{m} = \frac {\sum _{t=1}^{T} b_{t}|[\boldsymbol {r}_{m}]_{t}^{\top }(\boldsymbol {q}_{t}^{i}-\boldsymbol {q}_{t}^{j})|}{\sum _{t=1}^{T} b_{t}|[\boldsymbol {r}_{m}]_{t}^{\top }(\boldsymbol {q}_{t}^{i}+\boldsymbol {q}_{t}^{j})|}$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">WU</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq24.gif"/></alternatives></inline-formula> where <italic>b</italic><sub><italic>t</italic></sub> is the length of branch <italic>t</italic> and <italic>T</italic> is the total number of branches. Assuming that there are <italic>n</italic><sub><italic>t</italic></sub> OTUs connected to branch <italic>t</italic> in the phylogenetic tree, then <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {q}_{t}^{i}$\end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2022_1266_Article_IEq25.gif"/></alternatives></inline-formula> is a length- <italic>n</italic><sub><italic>t</italic></sub> vector recording the abundance proportions of the <italic>n</italic><sub><italic>t</italic></sub> OTUs connected to branch <italic>t</italic> for subject <italic>i</italic>; [<bold><italic>r</italic></bold><sub><italic>m</italic></sub>]<sub><italic>t</italic></sub> is a length- <italic>n</italic><sub><italic>t</italic></sub> vector recording the correlation between OTU <italic>m</italic> and those OTUs connected to branch <italic>t</italic> as obtained in the “<xref rid="Sec3" ref-type="sec">Step 1: Quantifying OTU phylogenetic correlation</xref>” section and dependent on <italic>c</italic>. The above equation quantifies the “local” weighted UniFrac distance for OTU <italic>m</italic> by weighting the proportion difference of the branch-<italic>t</italic>-related OTUs according to their correlations with OTU <italic>m</italic>. If <bold><italic>r</italic></bold><sub><italic>m</italic></sub> equals <bold><italic>1</italic></bold>, the above equation is the global weighted UniFrac distance. However, in these phylogenetic distances, the phylogenetic information seems to be used twice, one embedded in the original distance definition and one in the use of <bold><italic>r</italic></bold><sub><italic>m</italic></sub>. Further examinations are needed to understand the pros and cons of local tests on phylogenetic-based distance.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="40168_2022_1266_MOESM1_ESM.jpeg">
            <caption>
              <p><bold>Additional file 1</bold> Figure S1. Pseudo-F plots from Simulations A and B with large effect size (left) and small effect size (right) of causal OTUs for all five scenarios. Simulation A considers binary outcomes (1st row), which were simulated assuming no covariate effects besides OTU effects; Simulations B consider both binary outcomes (2nd rows) and continuous outcomes (3rd rows), which were simulated assuming OTU and covariate effects.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="40168_2022_1266_MOESM2_ESM.jpeg">
            <caption>
              <p><bold>Additional file 2</bold> Figure S2. QQ plot of POST <italic>p</italic>-values under the null hypothesis of no causal OTUs. The plots from left to right are for Simulations A, B-continuous and B-binary respectively. The outcomes in Simulation A were generated assuming no OTU effects and no covariate effects; the outcomes in Simulations B were generated assuming no OTU effects but with covariate effects.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="40168_2022_1266_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3</bold> Table S1. AUC of different methods in Simulation B. The methods considered include POST, TreeFDR (TF), Single-OTU test (SO), DESeq2 (DE), ANCOM-BC (AB) and LinDA (LD). The outcome values are simulated assuming covariate effects and 5 different causal-OTU scenarios. Scenarios 1 to 3 consider larger “causal hubs”, each containing about 7–10 causal OTUs; Scenario 4 considers smaller causal hubs of 2–3 causal OTUs; Scenario 5 considers causal OTUs with random positions in the phylogenetic tree. Wilcoxon rank-sum test (WR; for binary outcomes) and Spearman correlation test (SC; for continuous outcomes) are not included because they cannot account for covariates. Methods with the highest AUC are shown in bold.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="40168_2022_1266_MOESM4_ESM.png">
            <caption>
              <p><bold>Additional file 4</bold> Figure S3. Boxplots of OTU2 (<italic>Lactobacillus.iners</italic>) and OTU3 (<italic>Lactobacillus.crispatus</italic>) for BV and healthy women in the BV study.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="40168_2022_1266_MOESM5_ESM.png">
            <caption>
              <p><bold>Additional file 5</bold> Figure S4. OTU phylogenetic correlation for OTU2 and OTU3 with best <italic>c</italic> values 0.03 and 0, respectively. Only neighboring OTUs inside genus <italic>Lactobacillus</italic> are shown.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="40168_2022_1266_MOESM6_ESM.docx">
            <caption>
              <p><bold>Additional file 6</bold> Table S2. OTUs significantly associated with preterm birth at FDR level of 0.05. TF: TreeFDR; SO: Single-OTU test implemented by POST with c=0; DE: DESeq2; WR-P: Wilcoxon rank-sum test using proportional data; WR-R: Wilcoxon rank-sum test using CLR transformed data.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="40168_2022_1266_MOESM7_ESM.docx">
            <caption>
              <p><bold>Additional file 7</bold> Section S1. In this section, we conducted association analysis at the ASV level (i.e., 0% dissimilarity) using the same analysis strategies as described in the main texts for the bacterial vaginosis (BV) and the preterm birth (PTB) association studies.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="40168_2022_1266_MOESM8_ESM.docx">
            <caption>
              <p><bold>Additional file 8</bold> Table S3. The AUC using different pseudo-counts in Simulation A. The AUCs based on pseudo-count 0.5 are very close to the AUCs based on pseudo-count 1 across different scenarios and effect sizes.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="40168_2022_1266_MOESM9_ESM.png">
            <caption>
              <p><bold>Additional file 9</bold> Figure S5. Scatter plots of -log10 <italic>p</italic>-values obtained using pseudo-count 0.5 (X-axis) and those obtained using pseudo-count 1 (Y-axis) in the BV study (left) and the PTB study (right). The <italic>p</italic>-values of different pseudo-counts are highly correlated (R=0.995 in BV and 0.998 in PTB) and fall along the 45-degree lines.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>POST</term>
        <def>
          <p>Phylogeny-guided microbiome OTU-specific association test</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p>Operational taxonomic units</p>
        </def>
      </def-item>
      <def-item>
        <term>ASV</term>
        <def>
          <p>Amplicon sequence variant</p>
        </def>
      </def-item>
      <def-item>
        <term>FPR</term>
        <def>
          <p>False-positive rate</p>
        </def>
      </def-item>
      <def-item>
        <term>TPR</term>
        <def>
          <p>True-positive rate</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p>Area under the receiver operating characteristic curves</p>
        </def>
      </def-item>
      <def-item>
        <term>TSBH</term>
        <def>
          <p>Two-stage Benjamini–Hochberg procedure</p>
        </def>
      </def-item>
      <def-item>
        <term>TF</term>
        <def>
          <p>TreeFDR</p>
        </def>
      </def-item>
      <def-item>
        <term>DE</term>
        <def>
          <p>DESeq2</p>
        </def>
      </def-item>
      <def-item>
        <term>AB</term>
        <def>
          <p>ANCOM-BC</p>
        </def>
      </def-item>
      <def-item>
        <term>LD</term>
        <def>
          <p>LinDA</p>
        </def>
      </def-item>
      <def-item>
        <term>WR-P</term>
        <def>
          <p>Wilcoxon rank-sum test using proportional data</p>
        </def>
      </def-item>
      <def-item>
        <term>WR-R</term>
        <def>
          <p>Wilcoxon rank-sum test using CLR transformed data</p>
        </def>
      </def-item>
      <def-item>
        <term>SO</term>
        <def>
          <p>Single-OTU test</p>
        </def>
      </def-item>
      <def-item>
        <term>BV</term>
        <def>
          <p>Bacterial vaginosis</p>
        </def>
      </def-item>
      <def-item>
        <term>WU</term>
        <def>
          <p>weighted UniFrac</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr. Michael McLaren for his helpful discussions on this work.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CH, MCW, WL, and JYT conceived the presented ideas and study design. CH implemented the methods and performed the numerical studies under the supervision of BC, MCW, XP, and JYT. CH, BC, HB, XP, and JYT contributed to the data processing, analysis, and result interpretation of the real data analysis. CH and STH created the R package with input from BC, MCW, HB, WL, XP, and JYT. CH, BC, and JYT drafted the manuscript with input from MCW, STH, HB, WL, and XP. All authors helped shape the research, discussed the results, and contributed to the final manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been partially supported by the National Institute of Health Grants T32ES007329 (to CH), R35GM133745 (to CH and BC), P01CA142538 (to STH, WL and JYT), RF1AG074328 (to STH, WL and JYT), R01GM129512 (to MW), R01HL155417 (to MW), R21AI120713 (to HB and XP), U19AI144181 (subcontract to HB and XP), and National Institute of Health Contract HHSN272201800008C (subcontract to XP and HB).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The dataset of upper respiratory tract microbiome study [<xref ref-type="bibr" rid="CR24">24</xref>] used in our simulation study is available in R package <italic>GUniFrac</italic>. The 16S rRNA sequencing dataset and metadata of the vaginal microbiome and bacterial vaginosis study [<xref ref-type="bibr" rid="CR43">43</xref>] used in the real data analysis are publicly available at NCBI SRA database with project number PRJNA600021. The processed sequencing data and metadata of the vaginal microbiome and preterm birth [<xref ref-type="bibr" rid="CR50">50</xref>] used in the real data analysis are publicly available at the Stanford Digital Repository (<ext-link ext-link-type="uri" xlink:href="https://purl.stanford.edu/yb681vm1809">https://purl.stanford.edu/yb681vm1809</ext-link>). Our POST method is implemented by R package <italic>POSTm</italic>, and it is now available at CRAN (<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=POSTm">https://CRAN.R-project.org/package=POSTm</ext-link>). The R codes used for simulation, real data analysis, and data visualization are available through GitHub by request.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p>No ethics approval or consent to participate was required.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p>No consent for publication was required.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>The human microbiome: at the interface of health and disease</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>4</issue>
        <fpage>260</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3182</pub-id>
        <pub-id pub-id-type="pmid">22411464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Hamady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fraser-Liggett</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>The human microbiome project</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <issue>7164</issue>
        <fpage>804</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06244</pub-id>
        <pub-id pub-id-type="pmid">17943116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <mixed-citation publication-type="other">et al.The integrative human microbiome project. Nature. 2019; 569:641–8.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Introducing dotur, a computer program for defining operational taxonomic units and estimating species richness</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2005</year>
        <volume>71</volume>
        <issue>3</issue>
        <fpage>1501</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.71.3.1501-1506.2005</pub-id>
        <pub-id pub-id-type="pmid">15746353</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Exact sequence variants should replace operational taxonomic units in marker-gene data analysis</article-title>
        <source>ISME J</source>
        <year>2017</year>
        <volume>11</volume>
        <issue>12</issue>
        <fpage>2639</fpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2017.119</pub-id>
        <pub-id pub-id-type="pmid">28731476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alekseyenko</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Perez-Perez</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>De Souza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Strober</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bihan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Methé</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Community differentiation of the cutaneous microbiota in psoriasis</article-title>
        <source>Microbiome</source>
        <year>2013</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-1-31</pub-id>
        <pub-id pub-id-type="pmid">24451201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Charlson</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Collman</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Associating microbiome composition with environmental covariates using generalized unifrac distances</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>16</issue>
        <fpage>2106</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts342</pub-id>
        <pub-id pub-id-type="pmid">22711789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fukuyama</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Dethlefsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Relman</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparisons of distance methods for combining covariates and abundances in microbiome studies</article-title>
        <source>Biocomputing 2012</source>
        <year>2012</year>
        <publisher-loc>Singapore</publisher-loc>
        <publisher-name>World Scientific</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Z-Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Alekseyenko</surname>
            <given-names>AV</given-names>
          </name>
        </person-group>
        <article-title>PERMANOVA-S: association test for microbial community composition that accommodates confounders and multiple distances</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>17</issue>
        <fpage>2618</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw311</pub-id>
        <pub-id pub-id-type="pmid">27197815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Ringel-Kulka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Ringel</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Testing in microbiome-profiling studies with mirkat, the microbiome regression-based kernel association test</article-title>
        <source>Am J Hum Genet</source>
        <year>2015</year>
        <volume>96</volume>
        <issue>5</issue>
        <fpage>797</fpage>
        <lpage>807</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.04.003</pub-id>
        <pub-id pub-id-type="pmid">25957468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A powerful microbiome-based association test and a microbial taxa discovery framework for comprehensive association mapping</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0262-x</pub-id>
        <pub-id pub-id-type="pmid">28438217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fettweis</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Serrano</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Girerd</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Parikh</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Arodz</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Edupuganti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Glascock</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The vaginal microbiome and preterm birth</article-title>
        <source>Nat Med</source>
        <year>2019</year>
        <volume>25</volume>
        <issue>6</issue>
        <fpage>1012</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-019-0450-2</pub-id>
        <pub-id pub-id-type="pmid">31142849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martiny</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Martiny</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Microbiomes in light of traits: a phylogenetic perspective</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>350</volume>
        <issue>6261</issue>
        <fpage>9323</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aac9323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>False discovery rate control incorporating phylogenetic tree increases detection power in microbiome-wide multiple testing</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>18</issue>
        <fpage>2873</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx311</pub-id>
        <pub-id pub-id-type="pmid">28505251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>HH</given-names>
          </name>
        </person-group>
        <article-title>False discovery rate control with groups</article-title>
        <source>J Am Stat Assoc</source>
        <year>2010</year>
        <volume>105</volume>
        <issue>491</issue>
        <fpage>1215</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1198/jasa.2010.tm09329</pub-id>
        <pub-id pub-id-type="pmid">21931466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical false discovery rate–controlling methodology</article-title>
        <source>J Am Stat Assoc</source>
        <year>2008</year>
        <volume>103</volume>
        <issue>481</issue>
        <fpage>309</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1198/016214507000001373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Predictive modeling of microbiome data using a phylogeny-regularized generalized linear mixed model</article-title>
        <source>Front Microbiol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1391</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2018.01391</pub-id>
        <pub-id pub-id-type="pmid">29997602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>S-C</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic tree-based microbiome association test</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>1000</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">31504188</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bichat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Plassais</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ambroise</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mariadassou</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Incorporating phylogenetic information in microbiome differential abundance studies has no effect on detection power and fdr control</article-title>
        <source>Front Microbiol</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>649</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2020.00649</pub-id>
        <pub-id pub-id-type="pmid">32351481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kindinger</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Marchesi</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cacciatore</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Teoh</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>MacIntyre</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>The interaction between vaginal microbiota, cervical length, and vaginal progesterone treatment for preterm birth risk</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-016-0223-9</pub-id>
        <pub-id pub-id-type="pmid">28103952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>An adaptive association test for microbiome data</article-title>
        <source>Genome Med</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-016-0302-3</pub-id>
        <pub-id pub-id-type="pmid">27198579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Kernel methods for regression analysis of microbiome compositional data</article-title>
        <source>Topics in Applied Statistics</source>
        <year>2013</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Fasttree 2–approximately maximum-likelihood trees for large alignments</article-title>
        <source>PloS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>e9490</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>
        <pub-id pub-id-type="pmid">20224823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charlson</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Custers-Allen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Collman</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <article-title>Disordered microbial communities in the upper respiratory tract of cigarette smokers</article-title>
        <source>PloS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>12</issue>
        <fpage>e15216</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015216</pub-id>
        <pub-id pub-id-type="pmid">21188149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Cauchy combination test: a powerful test with analytic <italic>p</italic>-value calculation under arbitrary dependency structures</article-title>
        <source>J Am Stat Assoc</source>
        <year>2020</year>
        <volume>115</volume>
        <issue>529</issue>
        <fpage>393</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2018.1554485</pub-id>
        <pub-id pub-id-type="pmid">33012899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Acat: a fast and powerful <italic>p</italic> value combination method for rare-variant analysis in sequencing studies</article-title>
        <source>Am J Hum Genet</source>
        <year>2019</year>
        <volume>104</volume>
        <issue>3</issue>
        <fpage>410</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2019.01.002</pub-id>
        <pub-id pub-id-type="pmid">30849328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Plantinga</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jenq</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>pldist: ecological dissimilarities for paired and longitudinal microbiome association analysis</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>19</issue>
        <fpage>3567</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz120</pub-id>
        <pub-id pub-id-type="pmid">30863868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Semiparametric regression of multidimensional genetic pathway data: least-squares kernel machines and linear mixed models</article-title>
        <source>Biometrics</source>
        <year>2007</year>
        <volume>63</volume>
        <issue>4</issue>
        <fpage>1079</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2007.00799.x</pub-id>
        <pub-id pub-id-type="pmid">18078480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Estimation and testing for the effect of a genetic pathway on a disease outcome using logistic kernel machine regression via logistic mixed models</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>292</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-292</pub-id>
        <pub-id pub-id-type="pmid">18577223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Schaid</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Small sample kernel association tests for human genetic and microbiome association studies</article-title>
        <source>Genet Epidemiol</source>
        <year>2016</year>
        <volume>40</volume>
        <issue>1</issue>
        <fpage>5</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1002/gepi.21934</pub-id>
        <pub-id pub-id-type="pmid">26643881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mosimann</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>On the compound multinomial distribution, the multivariate <italic>β</italic>-distribution, and correlations among proportions</article-title>
        <source>Biometrika</source>
        <year>1962</year>
        <volume>49</volume>
        <issue>1/2</issue>
        <fpage>65</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.2307/2333468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tvedebrink</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Overdispersion in allelic counts and <italic>θ</italic>-correction in forensic genetics</article-title>
        <source>Theor Popul Biol</source>
        <year>2010</year>
        <volume>78</volume>
        <issue>3</issue>
        <fpage>200</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tpb.2010.07.002</pub-id>
        <pub-id pub-id-type="pmid">20633572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Krieger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Adaptive linear step-up procedures that control the false discovery rate</article-title>
        <source>Biometrika</source>
        <year>2006</year>
        <volume>93</volume>
        <issue>3</issue>
        <fpage>491</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/93.3.491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stevens</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Al Masud</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Suyundikov</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A comparison of multiple testing adjustment methods with block-correlation positively-dependent tests</article-title>
        <source>Plos ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>e0176124</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0176124</pub-id>
        <pub-id pub-id-type="pmid">28453517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with deseq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of compositions of microbiomes with bias correction</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13993-7</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Linda: Linear models for differential abundance analysis of microbiome compositional data</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-1-r1</pub-id>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sobel</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Bacterial vaginosis</article-title>
        <source>Annu Rev Med</source>
        <year>2000</year>
        <volume>51</volume>
        <issue>1</issue>
        <fpage>349</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.med.51.1.349</pub-id>
        <pub-id pub-id-type="pmid">10774469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gutman</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Peipert</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Weitzen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blume</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of clinical methods for diagnosing bacterial vaginosis</article-title>
        <source>Obstet Gynecol</source>
        <year>2005</year>
        <volume>105</volume>
        <issue>3</issue>
        <fpage>551</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1097/01.AOG.0000145752.97999.67</pub-id>
        <pub-id pub-id-type="pmid">15738023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kahwati</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Berkman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Urrutia</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Viswanathan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Screening for bacterial vaginosis in pregnant adolescents and women to prevent preterm delivery: updated evidence report and systematic review for the us preventive services task force</article-title>
        <source>Jama</source>
        <year>2020</year>
        <volume>323</volume>
        <issue>13</issue>
        <fpage>1293</fpage>
        <lpage>309</lpage>
        <pub-id pub-id-type="doi">10.1001/jama.2020.0233</pub-id>
        <pub-id pub-id-type="pmid">32259235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dols</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Molenaar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>van der Helm</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Caspers</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>de Kat Angelino-Bart</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schuren</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Speksnijder</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Westerhoff</surname>
            <given-names>HV</given-names>
          </name>
          <name>
            <surname>Richardus</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular assessment of bacterial vaginosis by lactobacillus abundance and species diversity</article-title>
        <source>BMC Infect Dis</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>180</fpage>
        <pub-id pub-id-type="doi">10.1186/s12879-016-1513-3</pub-id>
        <pub-id pub-id-type="pmid">27107961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vitali</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cruciani</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Picone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Parolin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Donders</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Laghi</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Vaginal microbiome and metabolome highlight specific signatures of bacterial vaginosis</article-title>
        <source>Eur J Clin Microbiol Infect Dis</source>
        <year>2015</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>2367</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1007/s10096-015-2490-y</pub-id>
        <pub-id pub-id-type="pmid">26385347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramaniam</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cliver</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Zhi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Szychowski</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Abramovici</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Biggio</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lefkowitz</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Morrow</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>Vaginal microbiota in pregnancy: evaluation based on vaginal flora, birth outcome, and race</article-title>
        <source>Am J Perinatol</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>04</issue>
        <fpage>401</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">26479170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <mixed-citation publication-type="other">Srinivasan S, Fredricks DN. The human vaginal bacterial biota and bacterial vaginosis. Interdisc Perspect Infect Dis. 2008:750479.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petrova</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Lievens</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Imholz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lebeer</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Lactobacillus species as biomarkers and agents that can promote various aspects of vaginal health</article-title>
        <source>Front Physiol</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>81</fpage>
        <pub-id pub-id-type="doi">10.3389/fphys.2015.00081</pub-id>
        <pub-id pub-id-type="pmid">25859220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Diop</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michelle</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Richez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rathored</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bretelle</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>P-E</given-names>
          </name>
          <name>
            <surname>Fenollar</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Description of three new peptoniphilus species cultured in the vaginal fluid of a woman diagnosed with bacterial vaginosis: Peptoniphilus pacaensis sp. nov., peptoniphilus raoultii sp. nov., and peptoniphilus vaginalis sp. nov</article-title>
        <source>MicrobiologyOpen</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>00661</fpage>
        <pub-id pub-id-type="doi">10.1002/mbo3.661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coleman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Gaydos</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Molecular diagnosis of bacterial vaginosis: an update</article-title>
        <source>J Clin Microbiol</source>
        <year>2018</year>
        <volume>56</volume>
        <issue>9</issue>
        <fpage>00342</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00342-18</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Teijlingen</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Helgers</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Zijlstra-Willems</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>van Hamme</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Strijbis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Geijtenbeek</surname>
            <given-names>TB</given-names>
          </name>
        </person-group>
        <article-title>Vaginal dysbiosis associated-bacteria megasphaera elsdenii and prevotella timonensis induce immune activation via dendritic cells</article-title>
        <source>J Reprod Immunol</source>
        <year>2020</year>
        <volume>138</volume>
        <fpage>103085</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jri.2020.103085</pub-id>
        <pub-id pub-id-type="pmid">32004804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fredricks</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Fiedler</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Marrazzo</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Molecular identification of bacteria associated with bacterial vaginosis</article-title>
        <source>N Engl J Med</source>
        <year>2005</year>
        <volume>353</volume>
        <issue>18</issue>
        <fpage>1899</fpage>
        <lpage>911</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa043802</pub-id>
        <pub-id pub-id-type="pmid">16267321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>DiGiulio</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Goltsman</surname>
            <given-names>DSA</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Jeganathan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Biggio</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Druzin</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>GM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Replication and refinement of a vaginal microbial signature of preterm birth in two racially distinct cohorts of us women</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2017</year>
        <volume>114</volume>
        <issue>37</issue>
        <fpage>9966</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1705899114</pub-id>
        <pub-id pub-id-type="pmid">28847941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pararas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Skevaki</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kafetzis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Preterm birth due to maternal infection: causative pathogens and modes of prevention</article-title>
        <source>Eur J Clin Microbiol Infect Dis</source>
        <year>2006</year>
        <volume>25</volume>
        <issue>9</issue>
        <fpage>562</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1007/s10096-006-0190-3</pub-id>
        <pub-id pub-id-type="pmid">16953371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choi</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>IH</given-names>
          </name>
          <name>
            <surname>Uh</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The prevalence of vaginal microorganisms in pregnant women with preterm labor and preterm birth</article-title>
        <source>Ann Lab Med</source>
        <year>2012</year>
        <volume>32</volume>
        <issue>3</issue>
        <fpage>194</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="doi">10.3343/alm.2012.32.3.194</pub-id>
        <pub-id pub-id-type="pmid">22563554</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mendz</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Petersen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Quinlivan</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Kaakoush</surname>
            <given-names>NO</given-names>
          </name>
        </person-group>
        <article-title>Potential involvement of campylobacter curvus and haemophilus parainfluenzae in preterm birth</article-title>
        <source>Case Rep</source>
        <year>2014</year>
        <volume>2014</volume>
        <fpage>2014205282</fpage>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Redline</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>McCormick</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>Fusobacterium nucleatum induces premature and term stillbirths in pregnant mice: implication of oral bacteria in preterm birth</article-title>
        <source>Infect Immun</source>
        <year>2004</year>
        <volume>72</volume>
        <issue>4</issue>
        <fpage>2272</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1128/IAI.72.4.2272-2279.2004</pub-id>
        <pub-id pub-id-type="pmid">15039352</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabatabaei</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Eren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barreiro</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yotova</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Dumaine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Allard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Vaginal microbiome in early pregnancy and subsequent risk of spontaneous preterm birth: a case–control study</article-title>
        <source>BJOG Int J Obstet Gynaecol</source>
        <year>2019</year>
        <volume>126</volume>
        <issue>3</issue>
        <fpage>349</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1111/1471-0528.15299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Son</surname>
            <given-names>K-A</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>YM</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>S-J</given-names>
          </name>
          <name>
            <surname>Oh</surname>
            <given-names>S-y</given-names>
          </name>
          <name>
            <surname>Roh</surname>
            <given-names>C-R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J-H</given-names>
          </name>
        </person-group>
        <article-title>Prevalence of vaginal microorganisms among pregnant women according to trimester and association with preterm birth</article-title>
        <source>Obstet Gynecol Sci</source>
        <year>2018</year>
        <volume>61</volume>
        <issue>1</issue>
        <fpage>38</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.5468/ogs.2018.61.1.38</pub-id>
        <pub-id pub-id-type="pmid">29372148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alm</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <source>Inferring correlation networks from genomic survey data</source>
        <year>2012</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>Public Library of Science San Francisco</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matchado</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Lauber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reitmeier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kacprowski</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Baumbach</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>List</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Network analysis methods for studying microbial communities: a mini review</article-title>
        <source>Comput Struct Biotechnol J</source>
        <year>2021</year>
        <volume>19</volume>
        <fpage>2687</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2021.05.001</pub-id>
        <pub-id pub-id-type="pmid">34093985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costea</surname>
            <given-names>PI</given-names>
          </name>
          <name>
            <surname>Zeller</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A fair comparison</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>359</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Reply to: “a fair comparison”</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>359</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Microbiome datasets are compositional: and this is not optional</article-title>
        <source>Front Microbiol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2224</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id>
        <pub-id pub-id-type="pmid">29187837</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
