<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Neuroinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Neuroinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Neuroinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Neuroinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1662-5196</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9196133</article-id>
    <article-id pub-id-type="doi">10.3389/fninf.2022.835657</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NNMT: Mean-Field Based Analysis Tools for Neuronal Network Models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Layer</surname>
          <given-names>Moritz</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">
          <sup>*</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1239384/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Senk</surname>
          <given-names>Johanna</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/472690/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Essink</surname>
          <given-names>Simon</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1715550/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van Meegen</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1598939/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bos</surname>
          <given-names>Hannah</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/1749370/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Helias</surname>
          <given-names>Moritz</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
        <uri xlink:href="http://loop.frontiersin.org/people/2031/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Institute of Neuroscience and Medicine (INM-6) and Institute for Advanced Simulation (IAS-6) and JARA-Institute Brain Structure-Function Relationships (INM-10), Jülich Research Centre</institution>, <addr-line>Jülich</addr-line>, <country>Germany</country></aff>
    <aff id="aff2"><sup>2</sup><institution>RWTH Aachen University</institution>, <addr-line>Aachen</addr-line>, <country>Germany</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Institute of Zoology, Faculty of Mathematics and Natural Sciences, University of Cologne</institution>, <addr-line>Cologne</addr-line>, <country>Germany</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Department of Physics, Faculty 1, RWTH Aachen University</institution>, <addr-line>Aachen</addr-line>, <country>Germany</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: John David Griffiths, University of Toronto, Canada</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Caglar Cakan, Technical University of Berlin, Germany; Richard Gast, Max Planck Institute for Human Cognitive and Brain Sciences, Germany</p>
      </fn>
      <corresp id="c001">*Correspondence: Moritz Layer <email>m.layer@fz-juelich.de</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>835657</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Layer, Senk, Essink, van Meegen, Bos and Helias.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Layer, Senk, Essink, van Meegen, Bos and Helias</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Mean-field theory of neuronal networks has led to numerous advances in our analytical and intuitive understanding of their dynamics during the past decades. In order to make mean-field based analysis tools more accessible, we implemented an extensible, easy-to-use open-source Python toolbox that collects a variety of mean-field methods for the leaky integrate-and-fire neuron model. The Neuronal Network Mean-field Toolbox (NNMT) in its current state allows for estimating properties of large neuronal networks, such as firing rates, power spectra, and dynamical stability in mean-field and linear response approximation, without running simulations. In this article, we describe how the toolbox is implemented, show how it is used to reproduce results of previous studies, and discuss different use-cases, such as parameter space explorations, or mapping different network models. Although the initial version of the toolbox focuses on methods for leaky integrate-and-fire neurons, its structure is designed to be open and extensible. It aims to provide a platform for collecting analytical methods for neuronal network model analysis, such that the neuroscientific community can take maximal advantage of them.</p>
    </abstract>
    <kwd-group>
      <kwd>mean-field theory</kwd>
      <kwd>(spiking) neuronal network</kwd>
      <kwd>integrate-and-fire neuron</kwd>
      <kwd>open-source software</kwd>
      <kwd>parameter space exploration</kwd>
      <kwd>(hybrid) modeling</kwd>
      <kwd>python</kwd>
      <kwd>computational neuroscience</kwd>
    </kwd-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="1"/>
      <equation-count count="36"/>
      <ref-count count="102"/>
      <page-count count="22"/>
      <word-count count="16156"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>1. Introduction</title>
    <p>Biological neuronal networks are composed of large numbers of recurrently connected neurons, with a single cortical neuron typically receiving synaptic inputs from thousands of other neurons (Braitenberg and Schüz, <xref rid="B9" ref-type="bibr">1998</xref>; DeFelipe et al., <xref rid="B22" ref-type="bibr">2002</xref>). Although the inputs of distinct neurons are integrated in a complex fashion, such large numbers of weak synaptic inputs imply that average properties of entire populations of neurons do not depend strongly on the contributions of individual neurons (Amit and Tsodyks, <xref rid="B7" ref-type="bibr">1991</xref>). Based on this observation, it is possible to develop analytically tractable theories of population properties, in which the effects of individual neurons are averaged out and the complex, recurrent input to individual neurons is replaced by a self-consistent effective input (reviewed, e.g., in Gerstner et al., <xref rid="B30" ref-type="bibr">2014</xref>). In classical physics terms (e.g., Goldenfeld, <xref rid="B34" ref-type="bibr">1992</xref>), this effective input is called <italic>mean-field</italic>, because it is the self-consistent mean of a <italic>field</italic>, which here is just another name for the input the neuron is receiving. The term <italic>self-consistent</italic> refers to the fact that the population of neurons that receives the effective input is the same that contributes to this very input in a recurrent fashion: the population's output determines its input and vice-versa. The stationary statistics of the effective input therefore can be found in a self-consistent manner: the input to a neuron must be set exactly such that the caused output leads to the respective input.</p>
    <p>Mean-field theories have been developed for many different kinds of synapse, neuron, and network models. They have been successfully applied to study average population firing rates (van Vreeswijk and Sompolinsky, <xref rid="B97" ref-type="bibr">1996</xref>, <xref rid="B98" ref-type="bibr">1998</xref>; Amit and Brunel, <xref rid="B6" ref-type="bibr">1997b</xref>), and the various activity states a network of spiking neurons can exhibit, depending on the network parameters (Amit and Brunel, <xref rid="B5" ref-type="bibr">1997a</xref>; Brunel, <xref rid="B12" ref-type="bibr">2000</xref>; Ostojic, <xref rid="B61" ref-type="bibr">2014</xref>), as well as the effects that different kinds of synapses have on firing rates (Fourcaud and Brunel, <xref rid="B27" ref-type="bibr">2002</xref>; Lindner, <xref rid="B52" ref-type="bibr">2004</xref>; Schuecker et al., <xref rid="B78" ref-type="bibr">2015</xref>; Schwalger et al., <xref rid="B81" ref-type="bibr">2015</xref>; Mattia et al., <xref rid="B56" ref-type="bibr">2019</xref>). They have been used to investigate how neuronal networks respond to external inputs (Lindner and Schimansky-Geier, <xref rid="B55" ref-type="bibr">2001</xref>; Lindner and Longtin, <xref rid="B54" ref-type="bibr">2005</xref>), and they explain why neuronal networks can track external input on much faster time scales than a single neuron could (van Vreeswijk and Sompolinsky, <xref rid="B97" ref-type="bibr">1996</xref>, <xref rid="B98" ref-type="bibr">1998</xref>). Mean-field theories allow studying correlations of neuronal activity (Sejnowski, <xref rid="B82" ref-type="bibr">1976</xref>; Ginzburg and Sompolinsky, <xref rid="B33" ref-type="bibr">1994</xref>; Lindner et al., <xref rid="B53" ref-type="bibr">2005</xref>; Trousdale et al., <xref rid="B92" ref-type="bibr">2012</xref>) and were able to reveal why pairs of neurons in random networks, despite receiving a high proportion of common input, can show low output correlations (Hertz, <xref rid="B42" ref-type="bibr">2010</xref>; Renart et al., <xref rid="B67" ref-type="bibr">2010</xref>; Tetzlaff et al., <xref rid="B90" ref-type="bibr">2012</xref>; Helias et al., <xref rid="B41" ref-type="bibr">2014</xref>), which for example has important implication for information processing. They describe pair-wise correlations in network with spatial organization (Rosenbaum and Doiron, <xref rid="B71" ref-type="bibr">2014</xref>; Rosenbaum et al., <xref rid="B72" ref-type="bibr">2017</xref>; Dahmen et al., <xref rid="B20" ref-type="bibr">2022</xref>) and can be generalized to correlations of higher orders (Buice and Chow, <xref rid="B16" ref-type="bibr">2013</xref>). Mean-field theories were utilized to show that neuronal networks can exhibit chaotic dynamics (Sompolinsky et al., <xref rid="B87" ref-type="bibr">1988</xref>; van Vreeswijk and Sompolinsky, <xref rid="B97" ref-type="bibr">1996</xref>, <xref rid="B98" ref-type="bibr">1998</xref>), in which two slightly different initial states can lead to totally different network responses, which has been linked to the network's memory capacity (Toyoizumi and Abbott, <xref rid="B91" ref-type="bibr">2011</xref>; Schuecker et al., <xref rid="B79" ref-type="bibr">2018</xref>). Most of the results mentioned above have been derived for networks of either rate, binary, or spiking neurons of a linear integrate-and-fire type. But various other models have been investigated with similar tools as well; for example, just to mention a few, Hawkes processes, non-linear integrate-and-fire neurons (Brunel and Latham, <xref rid="B15" ref-type="bibr">2003</xref>; Fourcaud-Trocmé et al., <xref rid="B28" ref-type="bibr">2003</xref>; Richardson, <xref rid="B68" ref-type="bibr">2007</xref>, <xref rid="B69" ref-type="bibr">2008</xref>; Grabska-Barwinska and Latham, <xref rid="B36" ref-type="bibr">2014</xref>; Montbrió et al., <xref rid="B57" ref-type="bibr">2015</xref>), or Kuramoto-type models (Stiller and Radons, <xref rid="B88" ref-type="bibr">1998</xref>; van Meegen and Lindner, <xref rid="B95" ref-type="bibr">2018</xref>). Additionally, there is an ongoing effort showing that many of the results derived for distinct models are indeed equivalent and that those models can be mapped to each other under certain circumstances (Ostojic and Brunel, <xref rid="B62" ref-type="bibr">2011</xref>; Grytskyy et al., <xref rid="B37" ref-type="bibr">2013</xref>; Senk et al., <xref rid="B83" ref-type="bibr">2020</xref>).</p>
    <p>Other theories for describing mean population rates in networks with spatially organized connectivity, based on taking a continuum limit, have been developed. These theories, known as neural field theories, have deepened our understanding of spatially and temporally structured activity patterns emerging in cortical networks, starting with the seminal work by Wilson and Cowan (<xref rid="B101" ref-type="bibr">1972</xref>, <xref rid="B102" ref-type="bibr">1973</xref>), who investigated global activity patterns, and Amari (<xref rid="B3" ref-type="bibr">1975</xref>, <xref rid="B4" ref-type="bibr">1977</xref>), who studied stable localized neuronal activity. They were successfully applied to explain hallucination patterns (Ermentrout and Cowan, <xref rid="B26" ref-type="bibr">1979</xref>; Bressloff et al., <xref rid="B11" ref-type="bibr">2001</xref>), as well as EEG and MEG rhythms (Nunez, <xref rid="B59" ref-type="bibr">1974</xref>; Jirsa and Haken, <xref rid="B45" ref-type="bibr">1996</xref>, <xref rid="B46" ref-type="bibr">1997</xref>). The neural field approach has been used to model working memory (Laing et al., <xref rid="B49" ref-type="bibr">2002</xref>; Laing and Troy, <xref rid="B48" ref-type="bibr">2003</xref>), motion perception (Giese, <xref rid="B32" ref-type="bibr">2012</xref>), cognition (Schöner, <xref rid="B76" ref-type="bibr">2008</xref>), and more; for extensive reviews of the literature, we refer the reader to Coombes (<xref rid="B17" ref-type="bibr">2005</xref>), Bressloff (<xref rid="B10" ref-type="bibr">2012</xref>), and Coombes et al. (<xref rid="B18" ref-type="bibr">2014</xref>).</p>
    <p>Clearly, analytical theories have contributed to our understanding of neuronal networks and they provide a plethora of powerful and efficient methods for network model analysis. Comparing the predictions of analytical theories to simulations, experimental data, or other theories necessitates a numerical implementation applicable to various network models, depending on the research question. Such an implementation is often far from straightforward and at times requires investing substantial time and effort. Commonly, such tools are implemented as the need arises, and their reuse is not organized systematically and restricted to within a single lab. This way, not only are effort and costs spent by the neuroscientific community duplicated over and over again, but also are many scientists deterred from taking maximal advantage of those methods although they might open new avenues for investigating their research questions.</p>
    <p>In order to make analytical tools for neuronal network model analysis accessible to a wider part of the neuroscientific community, and to create a platform for collecting well-tested and validated implementations of such tools, we have developed the Python toolbox NNMT (Layer et al., <xref rid="B51" ref-type="bibr">2021</xref>), short for Neuronal Network Mean-field Toolbox. We would like to emphasize that NNMT is not a simulation tool; NNMT is a collection of numerically solved mean-field equations that directly relate the parameters of a microscopic network model to the statistics of its dynamics. NNMT has been designed to fit the diversity of mean-field theories, and the key features we are aiming for are modularity, extensibility, and a simple usability. Furthermore, it features an extensive test suite to ensure the validity of the implementations as well as a comprehensive user documentation. The current version of NNMT mainly comprises tools for investigating networks of leaky integrate-and-fire neurons as well as some methods for studying binary neurons and neural field models. The toolbox is open-source and publicly available on GitHub.<xref rid="fn0001" ref-type="fn"><sup>1</sup></xref></p>
    <p>In the following, we present the design considerations that led to the structure and implementation of NNMT as well as a representative set of use cases. Section 2 first introduces its architecture. Section 3 then explains its usage by reproducing previously published network model analyses from Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>), Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>), Sanzeni et al. (<xref rid="B74" ref-type="bibr">2020</xref>), and Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>). Section 4 compares NNMT to other available toolboxes for neuronal network model analysis, discusses its use cases from a more general perspective, indicates current limitations and prospective advancements of NNMT, and explains how new tools can be contributed.</p>
  </sec>
  <sec id="s2">
    <title>2. Workflows and Architecture</title>
    <p>What are the requirements a package for collecting analytical methods for neuronal network model analysis needs to fulfill? To begin with, it should be adaptable and modular enough to accommodate many and diverse analytical methods while avoiding code repetition and a complex interdependency of package components. It should enable the application of the collected algorithms to various network models in a simple and transparent manner. It should make the tools easy to use for new users, while also providing experts with direct access to all parameters and options. Finally, the methods need to be thoroughly tested and well documented.</p>
    <p>These are the main considerations that guided the development of NNMT. <xref rid="F1" ref-type="fig">Figures 1A,B</xref> illustrate how the toolbox can be used in to two different workflows, depending on the preferences and goals of the user. In the <italic>basic workflow</italic> the individual method implementations called <italic>tools</italic> are directly accessed, whereas the <italic>model workflow</italic> provides additional functionality for the handling of parameters and results.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p>Structure and workflows of the Neuronal Network Mean-field Toolbox (NNMT). <bold>(A)</bold> Basic workflow: individual mean-field based analysis methods are implemented as functions, called <monospace>_tools()</monospace>, that can be used directly by explicitly passing the required arguments. <bold>(B)</bold> Model workflow: to facilitate the handling of parameters and results, they can be stored in a model class instance, which can be passed to a <monospace>tool()</monospace>, which wraps the basic workflow of the respective <monospace>_tool()</monospace>. <bold>(C)</bold> Structure of the Python package. In addition to the tool collection (red frame), containing the <monospace>tools()</monospace> and the <monospace>_tools()</monospace>, and pre-defined model classes, the package provides utility functions for handling parameter files and unit conversions, as well as software aiding the implementation of new methods.</p>
      </caption>
      <graphic xlink:href="fninf-16-835657-g0001" position="float"/>
    </fig>
    <sec>
      <title>2.1. Basic Workflow</title>
      <p>The core of NNMT is a collection of low-level functions that take specific parameters (or pre-computed results) as input arguments and return analytical results of network properties. In <xref rid="F1" ref-type="fig">Figure 1A</xref>, we refer to such basic functions as <monospace>_tools()</monospace>, as their names always start with an underscore. We term this lightweight approach of directly using these functions the basic workflow. The top part of <xref rid="F10" ref-type="fig">Listing 1</xref> demonstrates this usage; for example, the quantity to be computed could be the mean firing rate of a neuronal population and the arguments could be parameters which define neuron model and external drive. While the basic workflow gives full flexibility and direct access to every parameter of the calculation, it remains the user's responsibility to insert the arguments correctly, e.g., in the right units.</p>
      <fig position="float" id="F10">
        <label>Listing 1</label>
        <caption>
          <p>The two modes of using NNMT: In the basic workflow (top), quantities are calculated by passing all required arguments directly to the underscored tool functions available in the submodules of NNMT. In the model workflow (bottom), a model class is instantiated with parameter sets and the model instance is passed to the non-underscored tool functions which automatically extract the relevant parameters.</p>
        </caption>
        <graphic xlink:href="fninf-16-835657-g0010" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2. Model Workflow</title>
      <p>The model workflow is a convenient wrapper of the basic workflow (<xref rid="F1" ref-type="fig">Figure 1B</xref>). A <italic>model</italic> in this context is an object that stores a larger set of parameters and can be passed directly to a <monospace>tool()</monospace>, the non-underscored wrapper of the respective <monospace>_tool()</monospace>. The <monospace>tool()</monospace> automatically extracts the relevant parameters from the model, passes them as arguments to the corresponding core function <monospace>_tool()</monospace>, returns the results, and stores them in the model. The bottom part of <xref rid="F10" ref-type="fig">Listing 1</xref> shows how a model is initialized with parameters and then passed to a <monospace>tool()</monospace> function.</p>
      <p>Models are implemented as Python classes and can be found in the submodule <monospace>nnmt.models</monospace>. We provide the class <monospace>nnmt.models.Network</monospace> as a parent class and a few child classes which inherit the generic methods and properties but are tailored to specific network models; custom models can be created straightforwardly. The parameters distinguish network parameters, which define neuron models and network connectivity, and analysis parameters; an example for an analysis parameter is a frequency range over which a function is evaluated. Upon model instantiation, parameter sets defining values and corresponding units are passed as Python dictionaries or <monospace>yaml</monospace> files. The model constructor takes care of reading in these parameters, computing dependent parameters from the imported parameters, and converting all units to SI units for internal computations. Consequently, the parameters passed as arguments and the functions for computing dependent parameters of a specific child class need to be aligned. This design encourages a clear separation between a concise set of base parameters and functionality that transforms these parameters to the generic (vectorized) format that the tools work with. To illustrate this, consider the weight matrix of a network of excitatory and inhibitory neuron populations in which all excitatory connections have the same weight and all inhibitory ones another weight. As argument one could pass just a tuple of two different weight values and the corresponding model class would take care of constructing the full weight matrix. This happens in the example presented in Section 3.2.2: The parameter file <monospace>network_params_microcircuit.yaml</monospace> contains the excitatory synaptic weight and the ratio of inhibitory to excitatory weights. On instantiation, the full weight matrix is constructed from these two parameters, following the rules defined in <monospace>nnmt.models.Microcircuit</monospace>.</p>
      <p>When a <monospace>tool()</monospace> is called, it checks whether the provided model object contains all required parameters and previously computed results. Then the <monospace>tool()</monospace> extracts the required arguments, calls the respective <monospace>_tool()</monospace>, and caches and returns the result. If the user attempts to compute the same property twice, using identical parameters, the <monospace>tool()</monospace> will retrieve the already computed result from the model's cache and return that value. Results can be exported to an HDF5 file and also loaded.</p>
      <p>Using the model workflow instead of the basic workflow comes with the initial overhead of choosing a suitable combination of parameters and a model class, but has the advantages of a higher level of automation with built-in mechanisms for checking correctness of input (e.g., regarding units), reduced redundancy, and the options to store and load results. Both modes of using the toolbox can also be combined.</p>
    </sec>
    <sec>
      <title>2.3. Structure of the Toolbox</title>
      <p>The structure of the Python package NNMT is depicted in <xref rid="F1" ref-type="fig">Figure 1C</xref>. It is subdivided into submodules containing the tools (e.g., <monospace>nnmt.lif.exp</monospace>, or <monospace>nnmt.binary</monospace>), the model classes (<monospace>nnmt.models</monospace>), helper routines for handling parameter files and unit conversions, as well as modules that collect reusable code employed in implementations for multiple neuron models (cf. Section 4.4). The tools are organized in a modular, extensible fashion with a streamlined hierarchy. To give an example, a large part of the currently implemented tools apply to networks of leaky integrate-and-fire (LIF) neurons, and they are located in the submodule <monospace>nnmt.lif</monospace>. The mean-field theory for networks of LIF neurons distinguishes between neurons with instantaneous synapses, also called delta synapses, and those with exponentially decaying post-synaptic currents. Similarly, the submodule for LIF neurons is split further into the two submodules <monospace>nnmt.lif.delta</monospace> and <monospace>nnmt.lif.exp</monospace>. NNMT also collects different implementations for computing the same quantity using different approximations or numerics, allowing for a comparison of different approaches.</p>
      <p>Apart from the core package, NNMT comes with an extensive online documentation,<xref rid="fn0002" ref-type="fn"><sup>2</sup></xref> including a quickstart tutorial, all examples presented in this paper, a complete documentation of all tools, as well as a guide for contributors.</p>
      <p>Furthermore, we provide an extensive test suite that validates the tools by checking them against previously published results and alternative implementations where possible. This ensures that future improvements of the numerics do not break the tools.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>3. How to Use the Toolbox</title>
    <p>In this section, we demonstrate the practical use of NNMT by replicating a variety of previously published results. The examples presented have been chosen to cover a broad range of common use cases and network models. We include analyses of both stationary and dynamic network features, as mean-field theory is typically divided into two parts: stationary theory, which describes time-independent network properties of systems in a stationary state, and dynamical theory, which describes time-dependent network properties. Additionally, we show how to use the toolbox to map a spiking to a simpler rate model, as well as how to perform a linear stability analysis. All examples, including the used parameter files, are part of the online documentation.<sup>2</sup></p>
    <sec>
      <title>3.1. Installation and Setup</title>
      <p>The toolbox can be either installed using pip:</p>
      <p>
        <inline-graphic xlink:href="fninf-16-835657-i0001.jpg"/>
      </p>
      <p>or by installing it directly from the repository, which is described in detail in the online documentation. After the installation, the module can be imported:</p>
      <p>
        <inline-graphic xlink:href="fninf-16-835657-i0002.jpg"/>
      </p>
    </sec>
    <sec>
      <title>3.2. Stationary Quantities</title>
      <sec>
        <title>3.2.1. Response Nonlinearities</title>
        <p>Networks of excitatory and inhibitory neurons (EI networks, <xref rid="F2" ref-type="fig">Figure 2A</xref>) are widely used in computational neuroscience (Gerstner et al., <xref rid="B30" ref-type="bibr">2014</xref>), e.g., to show analytically that a balanced state featuring asynchronous, irregular activity emerges dynamically in a broad region of the parameter space (van Vreeswijk and Sompolinsky, <xref rid="B97" ref-type="bibr">1996</xref>, <xref rid="B98" ref-type="bibr">1998</xref>; Brunel, <xref rid="B12" ref-type="bibr">2000</xref>; Hertz, <xref rid="B42" ref-type="bibr">2010</xref>; Renart et al., <xref rid="B67" ref-type="bibr">2010</xref>). Remarkably, such balance states emerge in inhibition dominated networks for a variety of neuron models if the indegree is large, <italic>K</italic> ≫ 1, and the weights scale as <inline-formula><mml:math id="M1" overflow="scroll"><mml:mi>J</mml:mi><mml:mo>∝</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msqrt></mml:math></inline-formula> (Sanzeni et al., <xref rid="B74" ref-type="bibr">2020</xref>; Ahmadian and Miller, <xref rid="B2" ref-type="bibr">2021</xref>). Furthermore, in a balanced state, a network responds linearly to external input in the limit <italic>K</italic> → ∞ (van Vreeswijk and Sompolinsky, <xref rid="B97" ref-type="bibr">1996</xref>, <xref rid="B98" ref-type="bibr">1998</xref>; Brunel, <xref rid="B12" ref-type="bibr">2000</xref>; Sanzeni et al., <xref rid="B74" ref-type="bibr">2020</xref>; Ahmadian and Miller, <xref rid="B2" ref-type="bibr">2021</xref>). How do EI networks of LIF neurons respond to external input at finite indegrees? Sanzeni et al. (<xref rid="B74" ref-type="bibr">2020</xref>) uncover five different types of nonlinearities in the network response depending on the network parameters. Here, we show how to use the toolbox to reproduce their result (<xref rid="F2" ref-type="fig">Figures 2B–F</xref>).</p>
        <fig position="float" id="F2">
          <label>Figure 2</label>
          <caption>
            <p>Response nonlinearities in EI-networks. <bold>(A)</bold> Network diagram with nodes and edges according to the graphical notation proposed by Senk et al. (<xref rid="B84" ref-type="bibr">in press</xref>). <bold>(B–F)</bold> Firing rate of excitatory (blue) and inhibitory (red) population for varying external input rate ν<sub><italic>X</italic></sub>. Specific choices for synaptic weights (<italic><bold>J</bold></italic>, <italic><bold>J</bold></italic><sub>ext</sub>) and in-degrees (<italic><bold>K</bold></italic>, <italic><bold>K</bold></italic><sub>ext</sub>) lead to five types of nonlinearities: <bold>(B)</bold> saturation-driven nonlinearity, <bold>(C)</bold> saturation-driven multi-solution, <bold>(D)</bold> response-onset supersaturation, <bold>(E)</bold> mean-driven multi-solution, and <bold>(F)</bold> noise-driven multi-solution. See Figure 8 in Sanzeni et al. (<xref rid="B74" ref-type="bibr">2020</xref>) for parameters.</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0002" position="float"/>
        </fig>
        <p>The network consists of two populations, E and I, of identical LIF neurons with instantaneous (<italic>delta</italic>) synapses (Gerstner et al., <xref rid="B30" ref-type="bibr">2014</xref>). The subthreshold dynamics of the membrane potential <italic>V</italic><sub><italic>i</italic></sub> of neuron <italic>i</italic> obeys</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M2" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mo>˙</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>V</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where τ<sub>m</sub> denotes the membrane time constant, <italic>R</italic> the membrane resistance, and <italic>I</italic><sub><italic>i</italic></sub> the input current. If the membrane potential exceeds a threshold <italic>V</italic><sub>th</sub>, a spike is emitted and the membrane voltage is reset to the reset potential <italic>V</italic><sub>0</sub> and clamped to this value during the refractory time τ<sub>r</sub>. After the refractory period, the dynamics continue according to Equation (1). For instantaneous synapses, the input current is given by</p>
        <disp-formula id="E2">
          <label>(2)</label>
          <mml:math id="M3" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>R</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                  <mml:mi>δ</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <italic>J</italic><sub><italic>ij</italic></sub> is the synaptic weight from presynaptic neuron <italic>j</italic> to postsynaptic neuron <italic>i</italic> (with <italic>J</italic><sub><italic>ij</italic></sub> = 0 if there is no synapse), the <italic>t</italic><sub><italic>j,k</italic></sub> are the spike times of neuron <italic>j</italic>, and <italic>d</italic><sub><italic>ij</italic></sub> is a synaptic delay (in this example <italic>d</italic><sub><italic>ij</italic></sub> = <italic>d</italic> for all pairs of neurons). In total, there are <italic>N</italic><sub>E</sub> and <italic>N</italic><sub>I</sub> neurons in the respective populations. Each neuron is connected to a fixed number of randomly chosen presynaptic neurons (fixed in-degree); additionally, all neurons receive external input from independent Poisson processes with rate ν<sub>X</sub>. The synaptic weights and in-degrees of recurrent and external connections are population-specific:</p>
        <disp-formula id="E3">
          <label>(3)</label>
          <mml:math id="M4" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>J</mml:mi>
                  </mml:mstyle>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true">(</mml:mo>
                    <mml:mrow>
                      <mml:mtable style="text-align:axis;" equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>J</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">EE</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd>
                            <mml:mo>-</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>J</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">EI</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>J</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">IE</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd>
                            <mml:mo>-</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>J</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">II</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                    <mml:mo stretchy="true">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>J</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">ext</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true">(</mml:mo>
                    <mml:mrow>
                      <mml:mtable style="text-align:axis;" equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>J</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">EX</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>J</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">IX</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                    <mml:mo stretchy="true">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>K</mml:mi>
                  </mml:mstyle>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true">(</mml:mo>
                    <mml:mrow>
                      <mml:mtable style="text-align:axis;" equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">EE</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">EI</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">IE</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">II</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                    <mml:mo stretchy="true">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>K</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">ext</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true">(</mml:mo>
                    <mml:mrow>
                      <mml:mtable style="text-align:axis;" equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">EX</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">IX</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                    <mml:mo stretchy="true">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>All weights are positive, implying an excitatory external input.</p>
        <p>The core idea of mean-field theory is to approximate the input to a neuron as Gaussian white noise ξ(<italic>t</italic>) with mean 〈ξ(<italic>t</italic>)〉 = μ and noise intensity <inline-formula><mml:math id="M6" overflow="scroll"><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>ξ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">m</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This approximation is well-suited for asynchronous, irregular network states (van Vreeswijk and Sompolinsky, <xref rid="B97" ref-type="bibr">1996</xref>, <xref rid="B98" ref-type="bibr">1998</xref>; Amit and Brunel, <xref rid="B6" ref-type="bibr">1997b</xref>). For a LIF neuron driven by such Gaussian white noise, the firing rate is given by (Siegert, <xref rid="B86" ref-type="bibr">1951</xref>; Tuckwell, <xref rid="B93" ref-type="bibr">1988</xref>; Amit and Brunel, <xref rid="B6" ref-type="bibr">1997b</xref>)</p>
        <disp-formula id="E5">
          <label>(4)</label>
          <mml:math id="M7" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="true">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>τ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">r</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>τ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mi>π</mml:mi>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:mstyle displaystyle="true">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mo>∫</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mi>V</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>~</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>0</mml:mn>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>μ</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>σ</mml:mi>
                                  </mml:mrow>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mi>V</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>~</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">th</mml:mtext>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>μ</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>σ</mml:mi>
                                  </mml:mrow>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mstyle>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>e</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:mtext class="textrm" mathvariant="normal">erf</mml:mtext>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="true">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>-</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where the rescaled reset- and threshold-voltages are</p>
        <disp-formula id="E6">
          <label>(5)</label>
          <mml:math id="M8" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>-</mml:mo>
                      <mml:mi>μ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>,</mml:mo>
                  <mml:mtext>      </mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">th</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">th</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>-</mml:mo>
                      <mml:mi>μ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>The first term in Equation (4) is the refractory period and the second term is the mean first-passage time of the membrane voltage from reset to threshold. The mean and the noise intensity of the input to a neuron in a population <italic>a</italic> ∈ {<italic>E, I</italic>}, which control the mean first-passage time through Equation (5), are determined by (Amit and Brunel, <xref rid="B6" ref-type="bibr">1997b</xref>)</p>
        <disp-formula id="E7">
          <label>(6)</label>
          <mml:math id="M9" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>J</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">E</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">E</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>ν</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">E</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>J</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">I</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">I</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>ν</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">I</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>J</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">X</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">X</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>ν</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">X</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E8">
          <label>(7)</label>
          <mml:math id="M10" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>J</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">E</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">E</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>ν</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">E</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>J</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">I</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">I</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>ν</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">I</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>J</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">X</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mtext class="textrm" mathvariant="normal">X</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>ν</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">X</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>respectively, where each term reflects the contribution of one population, with the corresponding firing rates of the excitatory ν<sub>E</sub>, inhibitory ν<sub>I</sub>, and external population ν<sub>X</sub>. Note that we use the letters <italic>i, j, k</italic>, …  to index single neurons and <italic>a, b, c</italic>, …  to index neuronal populations. Both μ<sub><italic>a</italic></sub> and σ<sub><italic>a</italic></sub> depend on the firing rate of the neurons ν<sub><italic>a</italic></sub>, which is in turn given by Equation (4). Thus, one arrives at the self-consistency problem</p>
        <disp-formula id="E9">
          <label>(8)</label>
          <mml:math id="M11" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>ν</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>μ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>which is coupled across the populations due to Equation (6) and Equation (7).</p>
        <p>Our toolbox provides two algorithms to solve Equation (8): (1) Integrating the auxiliary ordinary differential equation (ODE) <inline-formula><mml:math id="M12" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with initial values ν<sub><italic>a</italic></sub>(0) = ν<sub><italic>a</italic>,0</sub> using <monospace>scipy.integrate.solve_ivp</monospace> (Virtanen et al., <xref rid="B99" ref-type="bibr">2020</xref>) until it reaches a fixed point <inline-formula><mml:math id="M13" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, where Equation (8) holds by construction. (2) Minimizing the quadratic deviation <inline-formula><mml:math id="M14" overflow="scroll"><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, using the least squares (LSTSQ) solver <monospace>scipy.optimize.least_squares</monospace> (Virtanen et al., <xref rid="B99" ref-type="bibr">2020</xref>) starting from an initial guess ν<sub><italic>a</italic>,0</sub>. The ODE method is robust to changes in the initial values and hence a good first choice. However, it cannot find self-consistent solutions that correspond to an unstable fixed point of the auxiliary ODE (note that the stability of the auxiliary ODE does not indicate the stability of the solution). To this end, the LSTSQ method can be used. Its drawback is that it needs a good initial guess, because otherwise the found minimum might be a local one where the quadratic deviation does not vanish, <inline-formula><mml:math id="M15" overflow="scroll"><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, and which accordingly does not correspond to a self-consistent solution, ν<sub><italic>a</italic></sub> ≠ ϕ(μ<sub><italic>a</italic></sub>, σ<sub><italic>a</italic></sub>). A prerequisite for both methods is a numerical solution of the integral in Equation (4); this is discussed in <xref rid="app1" ref-type="sec">Section A.1</xref> in the <xref rid="A1" ref-type="app">Appendix</xref>.</p>
        <p>The solutions of the self-consistency problem Equation (8) for varying ν<sub>X</sub> and fixed <italic><bold>J</bold></italic>, <italic><bold>J</bold></italic><sub>ext</sub>, <italic><bold>K</bold></italic>, and <italic><bold>K</bold></italic><sub>ext</sub> reveal the five types of response nonlinearities (<xref rid="F2" ref-type="fig">Figure 2</xref>). Different response nonlinearities arise through specific choices of synaptic weights, <italic><bold>J</bold></italic> and <italic><bold>J</bold></italic><sub>ext</sub>, and in-degrees, <italic><bold>K</bold></italic> and <italic><bold>K</bold></italic><sub>ext</sub>, which suggests that already a simple EI-network possesses a rich capacity for nonlinear computations. Whenever possible, we use the ODE method and resort to the LSTSQ method only if the self-consistent solution corresponds to an unstable fixed point of the auxiliary ODE. Combining both methods, we can reproduce the first columns of Figure 8 in Sanzeni et al. (<xref rid="B74" ref-type="bibr">2020</xref>), where all five types of nonlinearities are presented.</p>
        <p>In all cases, we chose appropriate initial values ν<sub><italic>a</italic>,0</sub> for either method. Note that an exploratory analysis is necessary if the stability properties of a network model are unknown, and potentially multiple fixed points are to be uncovered because there are, to the best of our knowledge, no systematic methods in <italic>d</italic> &gt; 1 dimensions that provide all solutions of a nonlinear system of equations.</p>
        <p>In <xref rid="F11" ref-type="fig">Listing 2</xref>, we show a minimal example to produce the data shown in <xref rid="F2" ref-type="fig">Figure 2B</xref>. After importing the function that solves the self-consistency Equation (8), we collect the neuron and network parameters in a dictionary. Then, we loop through different values for the external rate ν<sub><italic>X</italic></sub> and determine the network rates using the ODE method, which is sufficient in this example. In <xref rid="F11" ref-type="fig">Listing 2</xref> and to produce <xref rid="F2" ref-type="fig">Figure 2B</xref>, we use the basic workflow because only one isolated tool of NNMT (<monospace>nnmt.lif.delta._firing_rates()</monospace>) is employed, which requires only a few parameters defining the simple EI-network.</p>
        <fig position="float" id="F11">
          <label>Listing 2</label>
          <caption>
            <p>Example script to produce the data shown in <xref rid="F2" ref-type="fig">Figure 2B</xref> using the ODE method (initial value ν<sub><italic>a</italic>,0</sub> = 0 for population <italic>a</italic> ∈ {<italic>E, I</italic>}).</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0011" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.2.2. Firing Rates of Microcircuit Model</title>
        <p>Here we show how to use the model workflow to calculate the firing rates of the cortical microcircuit model by Potjans and Diesmann (<xref rid="B64" ref-type="bibr">2014</xref>). The circuit is a simplified point neuron network model with biologically plausible parameters, which has been recently used in a number of other works: for example, to study network properties such as layer-dependent attentional processing (Wagatsuma et al., <xref rid="B100" ref-type="bibr">2011</xref>), connectivity structure with respect to oscillations (Bos et al., <xref rid="B8" ref-type="bibr">2016</xref>), and the effect of synaptic weight resolution on activity statistics (Dasbach, Tetzlaff, Diesmann, and Senk, <xref rid="B21" ref-type="bibr">2021</xref>); to assess the performance of different simulator technologies such as neuromorphic hardware (van Albada et al., <xref rid="B94" ref-type="bibr">2018</xref>) and GPUs (Knight and Nowotny, <xref rid="B47" ref-type="bibr">2018</xref>; Golosio et al., <xref rid="B35" ref-type="bibr">2021</xref>); to demonstrate forward-model prediction of local-field potentials from spiking activity (Hagen et al., <xref rid="B38" ref-type="bibr">2016</xref>); and to serve as a building block for large-scale models (Schmidt et al., <xref rid="B75" ref-type="bibr">2018</xref>).</p>
        <p>The model consists of eight populations of LIF neurons, corresponding to the excitatory and inhibitory populations of four cortical layers: 2/3E, 2/3I, 4E, 4I, 5E, 5I, 6E, and 6I (see <xref rid="F3" ref-type="fig">Figure 3A</xref>). It defines the number of neurons in each population, the number of connections between the populations, the single neuron properties, and the external input. Simulations show that the model yields realistic firing rates for the different populations as observed in particular in the healthy resting-state of early sensory cortex (Potjans and Diesmann, <xref rid="B64" ref-type="bibr">2014</xref>, Table 6).</p>
        <fig position="float" id="F3">
          <label>Figure 3</label>
          <caption>
            <p>Cortical microcircuit model by Potjans and Diesmann (<xref rid="B64" ref-type="bibr">2014</xref>). <bold>(A)</bold> Network diagram (only the strongest connections are shown as in Figure 1 of the original publication). Same notation as in <xref rid="F2" ref-type="fig">Figure 2A</xref>. <bold>(B)</bold> Simulation and mean-field estimate for average population firing rates using the parameters from Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>).</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0003" position="float"/>
        </fig>
        <p>In contrast to the EI-network model investigated in Section 3.2.1, the neurons in the microcircuit model have exponentially shaped post-synaptic currents: Equation (2) is replaced by Fourcaud and Brunel (<xref rid="B27" ref-type="bibr">2002</xref>)</p>
        <disp-formula id="E10">
          <label>(9)</label>
          <mml:math id="M16" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">s</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>R</mml:mi>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>I</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                  <mml:mi>δ</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with synaptic time constant τ<sub>s</sub>. Note that <italic>J</italic><sub><italic>ij</italic></sub> is a measure in volts here. As discussed in Section 3.2.1, in mean-field theory the second term, representing the neuronal input, is approximated by Gaussian white noise. The additional synaptic filtering leads to the membrane potential (Equation 1) receiving colored noise input. Fourcaud and Brunel (<xref rid="B27" ref-type="bibr">2002</xref>) developed a method for calculating the firing rate for this synapse type. They have shown that, if the synaptic time constant τ<sub>s</sub> is much smaller than the membrane time constant τ<sub>m</sub>, the firing rate for LIF neurons with exponential synapses can be calculated using Equation (4) with shifted integration boundaries</p>
        <disp-formula id="E11">
          <label>(10)</label>
          <mml:math id="M17" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">cn</mml:mtext>
                      <mml:mo>,</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>τ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">s</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>τ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:msqrt>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">cn,th</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">th</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>τ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">s</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>τ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:msqrt>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the rescaled reset- and threshold-voltages from Equation (5) and <inline-formula><mml:math id="M19" overflow="scroll"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msqrt><mml:mo>|</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>≈</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mn>07</mml:mn></mml:math></inline-formula>, where ζ(<italic>x</italic>) denotes the Riemann zeta function; the subscript cn stands for “colored noise”.</p>
        <p>The microcircuit has been implemented as an NNMT model (<monospace>nnmt.models.Microcircuit</monospace>). We here use the parameters of the circuit as published in Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>) which is slightly differently parameterized than the original model (see <xref rid="T1" ref-type="table">Table A1</xref> in the <xref rid="A1" ref-type="app">Appendix</xref>). The parameters of the model are specified in a <monospace>yaml</monospace> file, which uses Python-like indentation and a dictionary-style syntax. List elements are indicated by hyphens, and arrays can be defined as nested lists. Parameters with units can be defined by using the keys <monospace>val</monospace> and <monospace>unit</monospace>, whereas unitless variables can be defined without any keys. <xref rid="F12" ref-type="fig">Listing 3</xref> shows an example of how some of the microcircuit network parameters used here are defined. Which parameters need to be provided in the yaml file depends on the model used and is indicated in their respective docstrings.</p>
        <fig position="float" id="F12">
          <label>Listing 3</label>
          <caption>
            <p>Some microcircuit network parameters defined in a yaml file. A dictionary-like structure with the keys <monospace>val</monospace> (value) and <monospace>unit</monospace> is used to define the membrane time constant, which is the same across all populations. The numbers of neurons in each population are defined as a list. Only the numbers for the first three populations are displayed.</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0012" position="float"/>
        </fig>
        <p>Once the parameters are defined, a microcircuit model is instantiated by passing the respective parameter file to the model constructor; the units are automatically converted to SI units. Then the firing rates are computed. For comparison, we finally load the simulated rates from Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>):</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0003.jpg"/>
        </p>
        <p>The simulated rates have been obtained by a numerical network simulation (for simulation details see Bos et al., <xref rid="B8" ref-type="bibr">2016</xref>) in which the neuron populations are connected according to the model's original connectivity rule: “random, fixed total number with multapses (autapses prohibited)”, see Senk et al. (<xref rid="B84" ref-type="bibr">in press</xref>) as a reference for connectivity concepts. The term <italic>multapses</italic> refers to multiple connections between the same pair of neurons and <italic>autapses</italic> are self-connections; with this connectivity rule multapses can occur in a network realization but autapses are not allowed. For simplicity, the theoretical predictions assume a connectivity with a fixed in-degree for each neuron. Dasbach et al. (<xref rid="B21" ref-type="bibr">2021</xref>) show that simulated spike activity data of networks with these two different connectivity rules are characterized by differently shaped rate distributions (“reference” in their Figures 3d and 4d). In addition, the weights in the simulation are normally distributed while the theory replaces each distribution by its mean; this corresponds to the case <italic>N</italic><sub>bins</sub> = 1 in Dasbach et al. (<xref rid="B21" ref-type="bibr">2021</xref>). Nevertheless, our mean-field theoretical estimate of the average population firing rates is in good agreement with the simulated rates (<xref rid="F3" ref-type="fig">Figure 3B</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>3.3. Dynamical Quantities</title>
      <sec>
        <title>3.3.1. Transfer Function</title>
        <p>One of the most important dynamical properties of a neuronal network is how it reacts to external input. A systematic way to study the network response is to apply an oscillatory external input current leading to a periodically modulated mean input μ(<italic>t</italic>) = μ+δμRe(e<sup>iω<italic>t</italic></sup>) (cf. Equation 6), with fixed frequency ω, phase, and amplitude δμ, and observe the emerging frequency, phase, and amplitude of the output. If the amplitude of the external input is small compared to the stationary input, the network responds in a linear fashion: it only modifies phase and amplitude, while the output frequency equals the input frequency. This relationship is captured by the input-output transfer function <italic>N</italic>(ω) (Brunel and Hakim, <xref rid="B14" ref-type="bibr">1999</xref>; Brunel et al., <xref rid="B13" ref-type="bibr">2001</xref>; Lindner and Schimansky-Geier, <xref rid="B55" ref-type="bibr">2001</xref>), which describes the frequency-dependent modulation of the output firing rate of a neuron population</p>
        <disp-formula id="E13">
          <mml:math id="M20" overflow="scroll">
            <mml:mrow>
              <mml:mi>ν</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>ν</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mtext class="textrm" mathvariant="normal">Re</mml:mtext>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>ω</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mi>δ</mml:mi>
                <mml:mi>μ</mml:mi>
                <mml:msup>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">e</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">i</mml:mtext>
                    <mml:mi>ω</mml:mi>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Note that in this section we only study the linear response to a modulation of the mean input, although in general, a modulation of the noise intensity (Equation 7) can also be included (Lindner and Schimansky-Geier, <xref rid="B55" ref-type="bibr">2001</xref>; Schuecker et al., <xref rid="B78" ref-type="bibr">2015</xref>). The transfer function <italic>N</italic>(ω) is a complex function: Its absolute value describes the relative modulation of the firing rate. Its phase, the angle relative to the real axis, describes the phase shift that occurs between input and output. We denote the transfer function for a network of LIF neurons with instantaneous synapses in linear-response approximation as</p>
        <disp-formula id="E14">
          <label>(11)</label>
          <mml:math id="M21" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>N</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msqrt>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msqrt>
                      <mml:mi>ν</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:mtext class="textrm" mathvariant="normal">i</mml:mtext>
                      <mml:mi>ω</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>τ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>Φ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>ω</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>′</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>Φ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>ω</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the rescaled reset- and threshold-voltages <inline-formula><mml:math id="M22" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M23" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">th</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:math></inline-formula> as defined in Equation (5) and <inline-formula><mml:math id="M24" overflow="scroll"><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">i</mml:mtext></mml:mstyle><mml:mi>ω</mml:mi><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">m</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> using the parabolic cylinder functions <inline-formula><mml:math id="M25" overflow="scroll"><mml:mi>U</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">i</mml:mtext></mml:mstyle><mml:mi>ω</mml:mi><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">m</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> as defined in (Abramowitz and Stegun, <xref rid="B1" ref-type="bibr">1974</xref>, Section 19.3) and (Olver et al., <xref rid="B60" ref-type="bibr">2021</xref>, Section 12.2). <inline-formula><mml:math id="M26" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes the first derivative by <italic>x</italic>. A comparison of our notation and the transfer function given in Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>, Equation 29) can be found in <xref rid="app2" ref-type="sec">Section A.2.1</xref> in the <xref rid="A1" ref-type="app">Appendix</xref>.</p>
        <p>For a neuronal network of LIF neurons with exponentially shaped post-synaptic currents, introduced in Section 3.2.2, Schuecker et al. (<xref rid="B77" ref-type="bibr">2014</xref>, <xref rid="B78" ref-type="bibr">2015</xref>) show that an analytical approximation of the transfer function can be obtained by a shift of integration boundaries, akin to Equation (10):</p>
        <disp-formula id="E15">
          <label>(12)</label>
          <mml:math id="M27" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">cn</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msqrt>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msqrt>
                      <mml:mi>ν</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:mtext class="textrm" mathvariant="normal">i</mml:mtext>
                      <mml:mi>ω</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>τ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">m</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>Φ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>ω</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>′</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">cn,</mml:mtext>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">cn,th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>Φ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>ω</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">cn,</mml:mtext>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msqrt>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">cn,th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>To take into account the effect of the synaptic dynamics, we include an additional low-pass filter:</p>
        <disp-formula id="E16">
          <label>(13)</label>
          <mml:math id="M28" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">cn,s</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">cn</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:mtext class="textrm" mathvariant="normal">i</mml:mtext>
                      <mml:mi>ω</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>τ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">s</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>If the synaptic time constant is much smaller than the membrane time constant (τ<sub>s</sub> ≪ τ<sub>m</sub>), an equivalent expression for the transfer function is obtained by a Taylor expansion around the original boundaries (cf. Schuecker et al. <xref rid="B78" ref-type="bibr">2015</xref>, Equation 30). The toolbox implements both variants and offers choosing between them by setting the argument <monospace>method</monospace> of <monospace>nnmt.lif.exp.transfer_function</monospace> to either <monospace>shift</monospace> or <monospace>taylor</monospace>.</p>
        <p>Here, we demonstrate how to calculate the analytical “shift version” of the transfer function for different means and noise intensities of the input current (see <xref rid="F4" ref-type="fig">Figure 4</xref>) and thereby reproduce Figure 4 in Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>).</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p>Colored-noise transfer function <italic>N</italic><sub>cn</sub> of LIF model in different regimes. <bold>(A)</bold> Absolute value and <bold>(B)</bold> phase of the “shift” version of the transfer function as a function of the log-scaled frequency. Neuron parameters are set to <italic>V</italic><sub>th</sub> = 20 mV, <italic>V</italic><sub>0</sub> = 15 mv, τ<sub>m</sub> = 20 ms, and τ<sub>s</sub> = 0.5 ms. For given noise intensities of input current, σ = 4 mV (solid line) and σ = 1.5 mV (dashed line), the mean input μ is chosen such that firing rates ν = 10 Hz (black) and ν = 30 Hz (gray) are obtained.</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0004" position="float"/>
        </fig>
        <p>The crucial parts for producing <xref rid="F4" ref-type="fig">Figure 4</xref> using NNMT are shown in <xref rid="F13" ref-type="fig">Listing 4</xref> for one example combination of mean and noise intensity of the input current. Instead of using the model workflow with <monospace>nnmt.lif.exp.transfer_function</monospace>, we here employ the basic workflow, using <monospace>nnmt.lif.exp._transfer_function</monospace> directly. This allows changing the mean input and its noise intensity independently of a network model's structure, but requires two additional steps: First, the necessary parameters are loaded from a <monospace>yaml</monospace> file, converted to SI units and then stripped off the units using the utility function <monospace>nnmt.utils._convert_to_si_and_strip_units</monospace>. Second, the analysis frequencies are defined manually. In this example we choose logarithmically spaced frequencies, as we want to plot the results on a log-scale. Finally, the complex-valued transfer function is calculated and then split into its absolute value and phase. <xref rid="F4" ref-type="fig">Figure 4</xref> shows that the transfer function acts as a low-pass filter that suppresses the amplitude of high frequency activity, introduces a phase lag, and can lead to resonance phenomena for certain configurations of mean input current and noise intensity.</p>
        <fig position="float" id="F13">
          <label>Listing 4</label>
          <caption>
            <p>Example script for computing a transfer function shown in <xref rid="F4" ref-type="fig">Figure 4</xref> using the method of shifted integration boundaries.</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0013" position="float"/>
        </fig>
        <p>The replication of the results from Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>) outlined here is also used in the integration tests of the toolbox. Note that the implemented analytical form of the transfer function by Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>) is an approximation for low frequencies, and deviations from a simulated ground truth are expected for higher frequencies (ω/2π ≳ 100 Hz at the given parameters).</p>
      </sec>
      <sec>
        <title>3.3.2. Power Spectrum</title>
        <p>Another frequently studied dynamical property is the power spectrum, which describes how the power of a signal is distributed across its different frequency components, revealing oscillations of the population activity. The power is the Fourier transformed auto-correlation of the population activities (c.f. Bos et al. <xref rid="B8" ref-type="bibr">2016</xref>, Equations 16-18). Linear response theory on top of a mean-field approximation, allows computing the power, dependent on the network architecture, the stationary firing rates, and the neurons' transfer function (Bos et al., <xref rid="B8" ref-type="bibr">2016</xref>). The corresponding analytical expression for the power spectra of population <italic>a</italic> at angular frequency ω is given by the diagonal elements of the correlation matrix</p>
        <disp-formula id="E17">
          <label>(14)</label>
          <mml:math id="M29" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>             </mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mn>1</mml:mn>
                                    </mml:mstyle>
                                    <mml:mo>-</mml:mo>
                                  </mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="false">
                                        <mml:mrow>
                                          <mml:mstyle mathvariant="bold">
                                            <mml:mtext>M</mml:mtext>
                                          </mml:mstyle>
                                        </mml:mrow>
                                        <mml:mo>~</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>ω</mml:mi>
                                    </mml:mrow>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mtext class="textrm" mathvariant="normal">diag</mml:mtext>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>ν</mml:mi>
                              </mml:mstyle>
                              <mml:mo>⊘</mml:mo>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>n</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mn>1</mml:mn>
                                    </mml:mstyle>
                                    <mml:mo>-</mml:mo>
                                  </mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="false">
                                        <mml:mrow>
                                          <mml:mstyle mathvariant="bold">
                                            <mml:mtext>M</mml:mtext>
                                          </mml:mstyle>
                                        </mml:mrow>
                                        <mml:mo>~</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mo>-</mml:mo>
                                      <mml:mi>ω</mml:mi>
                                    </mml:mrow>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mtext class="textrm" mathvariant="normal">T</mml:mtext>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with ⊘ denoting the elementwise (Hadamard) division, the effective connectivity matrix <inline-formula><mml:math id="M31" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">d</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">m</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>N</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">cn,s</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>J</mml:mi></mml:mstyle><mml:mo>⊙</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>K</mml:mi></mml:mstyle><mml:mo>⊙</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>D</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where the dot denotes the scalar product, while ⊙ denotes the elementwise (Hadamard) product, the mean population firing rates <italic><bold>ν</bold></italic>, and the numbers of neurons in each population <italic><bold>n</bold></italic>. The effective connectivity combines the static, anatomical connectivity <italic><bold>J</bold></italic> ⊙ <italic><bold>K</bold></italic>, represented by synaptic weight matrix <italic><bold>J</bold></italic> and in-degree matrix <italic><bold>K</bold></italic>, and dynamical quantities, represented by the transfer functions <italic>N</italic><sub>cn,s,<italic>a</italic></sub>(ω) (Equation (13)), and the contribution of the delays in (Equation 13), represented by their Fourier transformed distributions <italic>D</italic><sub><italic>ab</italic></sub>(ω) (cf. Bos et al. <xref rid="B8" ref-type="bibr">2016</xref>, Equations 14, 15).</p>
        <p>The modular structure in combination with the model workflow of this toolbox permits a step-by-step calculation of the power spectra, as shown in <xref rid="F14" ref-type="fig">Listing 5</xref>. The inherent structure of the theory is emphasized in these steps: After instantiating the network model class with given network parameters, we determine the working point, which characterizes the statistics of the model's stationary dynamics. It is defined by the population firing rates, the mean, and the standard deviation of the input to a neuron of the respective population. This is necessary for determining the transfer functions. The calculation of the delay distribution matrix is then required for calculating the effective connectivity and to finally get an estimate of the power spectra. <xref rid="F5" ref-type="fig">Figure 5</xref> reproduces Figure 1E in Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>) and shows the spectra for each population of the adjusted version (see <xref rid="T1" ref-type="table">Table A1</xref> in the <xref rid="A1" ref-type="app">Appendix</xref>) of the microcircuit model.</p>
        <fig position="float" id="F14">
          <label>Listing 5</label>
          <caption>
            <p>Example script to produce the theoretical prediction (black lines) shown in <xref rid="F5" ref-type="fig">Figure 5B</xref>.</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0014" position="float"/>
        </fig>
        <fig position="float" id="F5">
          <label>Figure 5</label>
          <caption>
            <p>Power spectra of the population spiking activity in the adapted cortical microcircuit from Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>). The spiking activity of each population in a 10 s simulation of the model is binned with 1 ms resolution and the power spectrum of the resulting histogram is calculated by a fast Fourier transform (FFT; light gray curves). In addition, the simulation is split into 500 ms windows, the power spectrum calculated for each window and averaged across windows (gray curves). Black curves correspond to analytical prediction obtained with NNMT as described in <xref rid="F14" ref-type="fig">Listing 5</xref>. The panels show the spectra for the excitatory (top) and inhibitory (bottom) populations within each layer of the microcircuit.</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0005" position="float"/>
        </fig>
        <p>The numerical predictions obtained from the toolbox largely coincide with simulated data taken from the original publication (Bos et al., <xref rid="B8" ref-type="bibr">2016</xref>) and reveal dominant oscillations of the population activities in the low-γ range around 63 Hz. Furthermore, faster oscillations with peak power around 300 Hz are predicted with higher magnitudes in the inhibitory populations 4I, 5I, and 6I.</p>
        <p>The deviation between predicted and simulated power spectra seen at ~130 Hz in population 2/3E could be a harmonic of the correctly predicted, prominent 63 Hz peak; a non-linear effect not captured in linear response theory. Furthermore, the systematic overestimation of the power spectrum at large frequencies is explained by the limited validity of the analytical approximation of the transfer function for high frequencies.</p>
      </sec>
      <sec>
        <title>3.3.3. Sensitivity Measure</title>
        <p>The power spectra shown in the previous section exhibit prominent peaks at certain frequencies, which indicate oscillatory activity. Naturally, this begs the question: which mechanism causes these oscillations? Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>) expose the crucial role that the microcircuit's connectivity plays in shaping the power spectra of this network model. They have developed a method called <italic>sensitivity measure</italic> to directly relate the influence of the anatomical connections, especially the in-degree matrix, on the power spectra.</p>
        <p>The power spectrum of the <italic>a</italic>-th population <italic>P</italic><sub><italic>a</italic></sub>(ω) receives a contribution from each eigenvalue λ<sub><italic>b</italic></sub> of the effective connectivity matrix, <inline-formula><mml:math id="M34" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. Such a contribution consequently diverges as the complex-valued λ<sub><italic>b</italic></sub> approaches 1+0i in the complex plane, which is referred to as the point of instability. This relation can be derived by replacing the effective connectivity matrix <inline-formula><mml:math id="M35" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>M</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">d</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in Equation (14) by its eigendecomposition. The sensitivity measure leverages this relationship and evaluates how a change in the in-degree matrix affects the eigenvalues of the effective connectivity and thus indirectly the power spectrum. Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>) introduce a small perturbation α<sub><italic>cd</italic></sub> of the in-degree matrix, which allows writing the effective connectivity matrix as <inline-formula><mml:math id="M36" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where we dropped the delay subscript d. The sensitivity measure <italic>Z</italic><sub><italic>b,cd</italic></sub>(ω) describes how the <italic>b</italic>-th eigenvalue of the effective connectivity matrix varies when the <italic>cd</italic>-th element of the in-degree matrix is changed</p>
        <disp-formula id="E19">
          <label>(15)</label>
          <mml:math id="M37" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>c</mml:mi>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>λ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mi>ω</mml:mi>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mi>d</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>α</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mover accent="false">
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                            <mml:mo>~</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>u</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>v</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">T</mml:mtext>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>·</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>u</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula><mml:math id="M38" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> is the partial derivative of the eigenvalue with respect to a change in connectivity, <inline-formula><mml:math id="M39" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>v</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">T</mml:mtext></mml:mstyle></mml:mrow></mml:msubsup></mml:math></inline-formula> and <bold>u</bold><sub><italic>b</italic></sub> are the left and right eigenvectors of <inline-formula><mml:math id="M40" overflow="scroll"><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> corresponding to eigenvalue λ<sub><italic>b</italic></sub>(ω).</p>
        <p>The complex sensitivity measure can be understood in terms of two components: <inline-formula><mml:math id="M41" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>Z</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">amp</mml:mtext></mml:mstyle></mml:mrow></mml:msubsup></mml:math></inline-formula> is the projection of the matrix <bold>Z</bold><sub><italic>b</italic></sub> onto the direction in the complex plane defined by 1 − λ<sub><italic>b</italic></sub>(ω); it describes how, when the in-degree matrix is perturbed, the complex-valued λ<sub><italic>b</italic></sub>(ω) moves toward or away from the instability 1 + 0i, and consequently how the amplitude of the power spectrum at frequency ω increases or decreases. <inline-formula><mml:math id="M42" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>Z</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">freq</mml:mtext></mml:mstyle></mml:mrow></mml:msubsup></mml:math></inline-formula> is the projection onto the perpendicular direction and thus describes how the peak frequency of the power spectrum changes with the perturbation of the in-degree matrix. For a visualization of these projections, refer to Figure 5B in Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>).</p>
        <p>The toolbox makes this intricate measure accessible by supplying two tools: After computing the required working point, transfer function, and delay distribution, the tool <monospace>nnmt.lif.exp.sensitivity_measure</monospace> computes the sensitivity measure at a given frequency for one specific eigenvalue. By default, this is the eigenvalue which is closest to the instability 1 + 0i. To perform the computation, we just need to add one line to <xref rid="F14" ref-type="fig">Listing 5</xref>:</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0004.jpg"/>
        </p>
        <p>The result is returned in form of a dictionary that contains the sensitivity measure and its projections. The tool <monospace>nnmt.lif.exp.sensitivity_measure_all_eigenmodes</monospace> wraps that basic function and calculates the sensitivity measure for all eigenvalues at the frequency for which each eigenvalue is closest to instability.</p>
        <p>According to the original publication (Bos et al., <xref rid="B8" ref-type="bibr">2016</xref>), the peak around 63Hz has contributions from one eigenvalue of the effective connectivity matrix. <xref rid="F6" ref-type="fig">Figure 6</xref> shows the projections of the sensitivity measure at the frequency for which this eigenvalue is closest to the instability, as illustrated in Figure 4 of Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>). The sensitivity measure returns one value for each connection between populations in the network model. For <inline-formula><mml:math id="M43" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>Z</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">amp</mml:mtext></mml:mstyle></mml:mrow></mml:msubsup></mml:math></inline-formula> a negative value indicates that increasing the in-degrees of a specific connection causes the amplitude of the power spectrum at the evaluated frequency to drop. If the value is positive, the amplitude is predicted to grow as the in-degrees increase. Similarly, for positive <inline-formula><mml:math id="M44" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>Z</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">freq</mml:mtext></mml:mstyle></mml:mrow></mml:msubsup></mml:math></inline-formula> the frequency of the peak in the power spectrum shifts toward higher values as in-degrees increase, and vice versa. The main finding in this analysis is that the low-γ peak seems to be affected by excitatory-inhibitory loops in layer 2/3 and layer 4.</p>
        <fig position="float" id="F6">
          <label>Figure 6</label>
          <caption>
            <p>Sensitivity measure at low-γ frequency and corresponding power spectrum of microcircuit with adjusted connectivity. <bold>(A)</bold> Sensitivity measure of one eigenmode of the effective connectivity relevant for low-γ oscillations. The sensitivity measure for this mode is evaluated at the frequency where the corresponding eigenvalue is closest to the point of instability 1 + 0i in complex plane. <inline-formula><mml:math id="M32" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">amp</mml:mtext></mml:mstyle></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (left subpanel) visualizes the influence of a perturbation of a connection on the peak amplitude of the power spectrum. <inline-formula><mml:math id="M33" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">freq</mml:mtext></mml:mstyle></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (right subpanel) shows the impact on the peak frequency. Non-existent connections are masked white. <bold>(B)</bold> Mean-field prediction of power spectrum of population 4I with original connectivity parameters (solid line), 5% increase (dashed line) and 10% increase (dotted line) in connections <italic>K</italic><sub>4I → 4I</sub>. The increase in inhibitory input to population 4I was counteracted by an increase of the excitatory external input <italic>K</italic><sub>ext → 4I</sub> to maintain the working point.</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0006" position="float"/>
        </fig>
        <p>To decrease the low–γ peak in the power spectrum, one could therefore increase the 4I to 4I connections (cp. <xref rid="F6" ref-type="fig">Figure 6A</xref>):</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0005.jpg"/>
        </p>
        <p>and calculate the power spectrum as in <xref rid="F14" ref-type="fig">Listing 5</xref> again to validate the change. Note that a change in connectivity leads to a shift in the working point. We are interested in the impact of the modified connectivity on the fluctuation dynamics at the same working point and thus need to counteract the change in connectivity by adjusting the external input. In the chosen example this is ensured by satisfying <italic>J</italic><sub>4I → 4<italic>I</italic></sub>Δ<italic>K</italic><sub>4I → 4<italic>I</italic></sub>ν<sub>4I</sub> = −<italic>J</italic><sub>ext → 4I</sub>Δ<italic>K</italic><sub>ext → 4I</sub>ν<sub>ext</sub>, which yields <inline-formula><mml:math id="M45" overflow="scroll"><mml:mo>Δ</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">ext</mml:mtext></mml:mstyle><mml:mo>→</mml:mo><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">4I</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">4I</mml:mtext></mml:mstyle><mml:mo>→</mml:mo><mml:mn>4</mml:mn><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>Δ</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">4I</mml:mtext></mml:mstyle><mml:mo>→</mml:mo><mml:mn>4</mml:mn><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">4I</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">ext</mml:mtext></mml:mstyle><mml:mo>→</mml:mo><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">4I</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">ext</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p>
        <p>If several eigenvalues of the effective connectivity matrix influence the power spectra in the same frequency range, adjustments of the connectivity are more involved. This is because a change in connectivity would inevitably affect all eigenvalues simultaneously. Further care has to be taken because the sensitivity measure is subject to the same constraints as the current implementation of the transfer function, which is only valid for low frequencies and enters the sensitivity measure directly.</p>
      </sec>
    </sec>
    <sec>
      <title>3.4. Fitting Spiking to Rate Model and Predicting Pattern Formation</title>
      <p>If the neurons of a network are spatially organized and connected according to a distance-dependent profile, the spiking activity may exhibit pattern formation in space and time, including wave-like phenomena. Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>) set out to scrutinize the non-trivial relationship between the parameters of such a network model and the emerging activity patterns. The model they use is a two-population network of excitatory E and inhibitory I spiking neurons, illustrated in <xref rid="F7" ref-type="fig">Figure 7</xref>. All neurons are of type LIF with exponentially shaped post-synaptic currents. The neuron populations are recurrently connected to each other and themselves and they receive additional external excitatory E<sub>ext</sub> and inhibitory I<sub>ext</sub> Poisson spike input of adjustable rate as shown in <xref rid="F7" ref-type="fig">Figure 7A</xref>. The spatial arrangement of neurons on a ring is illustrated in <xref rid="F7" ref-type="fig">Figure 7B</xref> and the boxcar-shaped connectivity profiles in <xref rid="F7" ref-type="fig">Figure 7C</xref>.</p>
      <fig position="float" id="F7">
        <label>Figure 7</label>
        <caption>
          <p>Illustrations of spiking network model by Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>). <bold>(A)</bold> Excitatory and inhibitory neuronal populations randomly connected with fixed in-degree and multapses allowed (autapses prohibited). External excitatory and inhibitory Poisson drive to all neurons. Same notation as in <xref rid="F2" ref-type="fig">Figure 2A</xref>. <bold>(B)</bold> One inhibitory and four excitatory neurons per grid position on a one-dimensional domain with periodic boundary conditions (ring network). <bold>(C)</bold> Normalized, boxcar-shaped connection probability with wider excitation than inhibition; the grid spacing is here 10<sup>−3</sup> mm. For model details and parameters, see Tables II–IV of Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>); the specific values given in the caption of their Figure 6 are used throughout here.</p>
        </caption>
        <graphic xlink:href="fninf-16-835657-g0007" position="float"/>
      </fig>
      <p>In the following, we consider a mean-field approximation of the spiking model with spatial averaging, that is a time and space continuous approximation of the discrete model as derived in Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Section E. Linearization of spiking network model). We demonstrate three methods used in the original study: First, Section 3.4.1 explains how a model can be brought to a defined state characterized by its working point. The working point is given by the mean μ and noise intensity σ of the input to a neuron, which are both quantities derived from network parameters and require the calculation of the firing rates. With the spiking model in that defined state, Section 3.4.2 then maps its transfer function to the one of a rate model. Section 3.4.3 finally shows that this working-point dependent rate model allows for an analytical linear stability analysis of the network accounting for its spatial structure. This analysis can reveal transitions to spatial and temporal oscillatory states which, when mapped back to the parameters of the spiking model, may manifest in distinct patterns of simulated spiking activity after a startup transient.</p>
      <sec>
        <title>3.4.1. Setting the Working Point by Changing Network Parameters</title>
        <p>With network and analysis parameters predefined in <monospace>yaml</monospace> files, we set up a network model using the example model class <monospace>Basic</monospace>:</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0006.jpg"/>
        </p>
        <p>Upon initialization the given parameters are automatically converted into the format used by NNMT's tools. For instance, relative spike reset and threshold potentials are derived from the absolute values, connection strengths in units of volt are computed from the post-synaptic current amplitudes in ampere, and all values are scaled to SI units.</p>
        <p>We aim to bring the network to a defined state by fixing the working point but also want to explore if the procedure of fitting the transfer function still works for different network states. For a parameter space exploration, we use a method to change parameters provided by the model class and scan through a number of different working points of the network. To obtain the required input for a target working point, we adjust the external excitatory and inhibitory firing rates accordingly; NNMT uses a vectorized version of the equations given in Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Appendix F: Fixing the working point) to calculate the external rates needed:</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0007.jpg"/>
        </p>
        <p>The implementation uses only one excitatory and one inhibitory Poisson source to represent the external input rates which typically originate from a large number of external source neurons. These two external sources are connected to the network with the same relative inhibition <italic>g</italic> as used for the internal connections. The resulting external rates for different choices of (μ, σ) are color-coded in the first two plots of <xref rid="F8" ref-type="fig">Figure 8A</xref>. The third plot shows the corresponding firing rates of the neurons, which are stored in the results of the model instance when computing the working point explicitly:</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0008.jpg"/>
        </p>
        <fig position="float" id="F8">
          <label>Figure 8</label>
          <caption>
            <p>Network parameters and mean-field results from scanning through different working points. Working point (μ, σ) combines mean input μ and noise intensity of input σ. <bold>(A)</bold> External excitatory ν<sub>ext,E</sub> and inhibitory ν<sub>ext,I</sub> Poisson rates required to set (μ, σ) and resulting firing rates ν. <bold>(B)</bold> Transfer function <italic>N</italic><sub>cn,s</sub> of spiking model and fitted rate-model approximation with low-pass filter for selected (μ, σ) (top: amplitude, bottom: phase). <bold>(C)</bold> Fit results (time constants τ and excitatory weights <italic>w</italic><sub>E</sub>) and fit errors η. The inhibitory weights are <italic>w</italic><sub>I</sub> = −<italic>gw</italic><sub>E</sub> with <italic>g</italic> = 5. Star marker in panels <bold>(A)</bold> and <bold>(C)</bold> denotes target working point (10, 10) mV. Similar displays as in Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Figure 5).</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0008" position="float"/>
        </fig>
        <p>Although the external rates are substantially higher than the firing rates, since a neuron is recurrently connected to hundreds of neurons, the total external and recurrent inputs are of the same order.</p>
      </sec>
      <sec>
        <title>3.4.2. Parameter Mapping by Fitting the Transfer Function</title>
        <p>We map the parameters of the spiking model to a corresponding rate model by, first, computing the transfer function <italic><bold>N</bold></italic><sub>cn,s</sub> given in Equation (13) of the spiking model, and second, fitting the simpler transfer function of the rate model, for details see Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Section F. Comparison of neural-field and spiking models). The dynamics of the rate model can be written as a differential equation for the linearized activity <italic>r</italic><sub><italic>a</italic></sub> with populations <italic>a, b</italic> ∈ {E, I}:</p>
        <disp-formula id="E20">
          <label>(16)</label>
          <mml:math id="M46" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>τ</mml:mi>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the delay <italic>d</italic>; τ is the time constant and <italic>w</italic><sub><italic>b</italic></sub> are the unitless weights that only depend on the presynaptic population. The transfer function is just the one of a low-pass filter, <italic>N</italic><sub>LP</sub> = 1/(1 + λτ), where λ is the frequency in Laplace domain. The tool to fit the transfer function requires that the actual transfer function <italic><bold>N</bold></italic><sub>cn,s</sub> has been computed beforehand and fits <italic>N</italic><sub>LP</sub><italic><bold>w</bold></italic> to τ<sub>m</sub><italic><bold>N</bold></italic><sub>cn,s</sub>·<italic><bold>J</bold></italic> ⊙ <italic><bold>K</bold></italic> for the same frequencies together with τ, <italic><bold>w</bold></italic>, and the combined fit error η:</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0009.jpg"/>
        </p>
        <p>The absolute value of the transfer function is fitted with non-linear least-squares using the solver <monospace>scipy.optimize.curve_fit</monospace>. <xref rid="F8" ref-type="fig">Figure 8B</xref> illustrates the amplitude and phase of the transfer function and its fit for a few (μ, σ) combinations. The plots of <xref rid="F8" ref-type="fig">Figure 8C</xref> show the fitted time constants, the fitted excitatory weight, and the combined fit error. The inhibitory weight is proportional to the excitatory one in the same way as the post-synaptic current amplitudes.</p>
      </sec>
      <sec>
        <title>3.4.3. Linear Stability Analysis of Spatially Structured Model With Delay</title>
        <p>Sections 3.4.1 and 3.4.2 considered a mean-field approximation of the spiking model without taking space into account. In the following, we assume a spatial averaging of the discrete network depicted in <xref rid="F7" ref-type="fig">Figure 7</xref> and introduce the spatial connectivity profiles <italic>p</italic><sub><italic>a</italic></sub>(<italic>x</italic>). Changing Equation (16) to the integro-differential equation</p>
        <disp-formula id="E21">
          <label>(17)</label>
          <mml:math id="M47" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>τ</mml:mi>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>∂</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>∂</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>∫</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>-</mml:mo>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mtext class="textrm" mathvariant="normal">d</mml:mtext>
                  <mml:mi>y</mml:mi>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>yields a neural field model defined in continuous space <italic>x</italic>. This model lends itself to analytical linear stability analysis, as described in detail in Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Section A. Linear stability analysis of a neural-field model). In brief, we analyze the stability of a fixed-point solution to this differential equation system which, together with parameter continuation methods and bifurcation analysis, allows us to determine points in parameter space where transitions from homogeneous steady states to oscillatory states can occur. These transitions are given as a function of a bifurcation parameter, here the constant delay <italic>d</italic>, which is the same for all connections. The complex-valued, temporal eigenvalue λ of the linearized time-delay system is an indicator for the system's overall stability and can serve as a predictor for temporal oscillations, whereas the spatial oscillations are characterized by the real-valued wave number <italic>k</italic>. Solutions that relate λ and <italic>k</italic> with the model parameters are given by a characteristic equation, which in our case reads (Senk et al., <xref rid="B83" ref-type="bibr">2020</xref>, Equation 7):</p>
        <disp-formula id="E22">
          <label>(18)</label>
          <mml:math id="M48" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>λ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>B</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>W</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>B</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>τ</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">e</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>τ</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo stretchy="true">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the time constant of the rate model τ, the multi-valued Lambert <italic>W</italic><sub><italic>B</italic></sub> function<xref rid="fn0003" ref-type="fn"><sup>3</sup></xref> on branch <italic>B</italic> (Corless et al., <xref rid="B19" ref-type="bibr">1996</xref>), and the effective connectivity profile <italic>c</italic>(<italic>k</italic>), which combines the weights <italic>w</italic><sub><italic>b</italic></sub> and the Fourier transforms of the spatial connectivity profiles. Note that the approach generalizes from the boxcar-shaped profiles used here to any symmetric probability density function. NNMT provides an implementation to solve this characteristic equation in its <monospace>linear_stability</monospace> module using the <monospace>spatial</monospace> module for the profile:</p>
        <p>
          <inline-graphic xlink:href="fninf-16-835657-i0010.jpg"/>
        </p>
        <p><xref rid="F9" ref-type="fig">Figure 9A</xref> shows that the computed eigenvalues come for the given network parameters in complex conjugate pairs. The branch with the largest real part is the principal branch (<italic>B</italic> = 0). Temporal oscillations are expected to occur if the real part of the eigenvalue on the principal branch becomes positive; the oscillation frequency can then be read off the imaginary part of that eigenvalue. In this example, the largest eigenvalue λ<sup>*</sup> on the principal branch has a real part that is just above zero. There exists a supercritical Hopf bifurcation and the delay as the bifurcation parameter is chosen large enough such that the model is just beyond the bifurcation point separating the stable from the instable state. The respective wave number <italic>k</italic><sup>*</sup> is positive, which indicates spatial oscillations as well. The oscillations in both time and space predicted for the rate model imply that the activity of the corresponding spiking model might exhibit wave trains, i.e., temporally and spatially periodic patterns. The predicted propagation speed of the wave trains is given by the phase velocity Im[λ<sup>*</sup>]/<italic>k</italic><sup>*</sup>.</p>
        <fig position="float" id="F9">
          <label>Figure 9</label>
          <caption>
            <p>Linear stability analysis of spatially structured network model. <bold>(A)</bold> Analytically exact solution for real (top) and imaginary (bottom) part of eigenvalue λ vs. wavenumber <italic>k</italic> using rate model derived by fit of spiking model at working point (μ, σ) = (10, 10) mV. Color-coded branches of Lambert <italic>W</italic><sub><italic>B</italic></sub> function; maximum real eigenvalue (star marker) on principal branch (<italic>B</italic> = 0). <bold>(B)</bold> Linear interpolation between rate (α = 0) and spiking model (α = 1) by numerical integration of Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Equation 30) (solid line) and by numerically solving the characteristic equation in Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Equation 29) (circular markers). Star markers at same data points as in <bold>(A)</bold>. Similar displays as in Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Figure 6).</p>
          </caption>
          <graphic xlink:href="fninf-16-835657-g0009" position="float"/>
        </fig>
        <p>To determine whether the results obtained with the rate model are transferable to the spiking model, <xref rid="F9" ref-type="fig">Figure 9B</xref> interpolates the analytical solutions of the rate model [α = 0, evaluating Equation (18)] to solutions of the spiking model (α = 1, accounting for the transfer function <italic><bold>N</bold></italic><sub>cn,s</sub>), which can only be computed numerically. Thus, the parameter α interpolates between the characteristic equations of these two models which primarily differ in their transfer function; for details see Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>, Section F.2 Linear interpolation between the transfer functions). Since the eigenvalues estimated this way show only little differences between rate and spiking model, we conclude that predictions from the rate model should hold also for the spiking model in the parameter regime tested. Following the argument of Senk et al. (<xref rid="B83" ref-type="bibr">2020</xref>), the predicted pattern formation could next be tested in a numerical simulation of the discrete spiking network model. Their Figure 7c for the delay <italic>d</italic> = 1.5 ms shows such results with the same parameters as used here; this figure also illustrates transitions from homogeneous states to oscillatory states by changing the delay (panels b, c, and e).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>4. Discussion</title>
    <p>Mean-field theory grants important insights into the dynamics of neuronal networks. However, the lack of a publicly available numerical implementation for most methods entails a significant initial investment of time and effort prior to any scientific investigations. In this paper, we present the open-source toolbox NNMT, which currently focuses on methods for LIF neurons but is intended as a platform for collecting standard implementations of various neuronal network model analyses based on mean-field theory that have been thoroughly tested and validated by the neuroscientific community (Riquelme and Gjorgjieva, <xref rid="B70" ref-type="bibr">2021</xref>). As use cases, we reproduce known results from the literature: the non-linear relation between the firing rates and the external input of an E-I-network (Sanzeni et al., <xref rid="B74" ref-type="bibr">2020</xref>), the firing rates of a cortical microcircuit model, its response to oscillatory input, its power spectrum, and the identification of the connections that predominantly contribute to the model's low frequency oscillations (Schuecker et al., <xref rid="B78" ref-type="bibr">2015</xref>; Bos et al., <xref rid="B8" ref-type="bibr">2016</xref>), and pattern formation in a spiking network, analyzed by mapping it to a rate model and conducting a linear stability analysis (Senk et al., <xref rid="B83" ref-type="bibr">2020</xref>).</p>
    <p>In the remainder of the discussion, we compare NNMT to other tools suited for network model analysis. We expand on the different use cases of NNMT and also point out the inherent limitations of analytical methods for neuronal network analysis. We conclude with suggestions on how new tools can be added to NNMT and how the toolbox may grow and develop in the future.</p>
    <sec>
      <title>4.1. Comparison to Other Tools</title>
      <p>There are various approaches and corresponding tools that can help to gain a better understanding of a neuronal network model. There are numerous simulators that numerically solve the dynamical equations for concrete realizations of a network model and all its stochastic components, often focusing either on the resolution of single-neurons, for example NEST (Gewaltig and Diesmann, <xref rid="B31" ref-type="bibr">2007</xref>), Brian (Stimberg et al., <xref rid="B89" ref-type="bibr">2019</xref>), or Neuron (Hines and Carnevale, <xref rid="B43" ref-type="bibr">2001</xref>), or on the population level, for example TheVirtualBrain (Sanz Leon et al., <xref rid="B73" ref-type="bibr">2013</xref>). Similarly, general-purpose dynamical system software like XPPAUT (Ermentrout, <xref rid="B25" ref-type="bibr">2002</xref>) can be used. Simulation tools, like DynaSim (Sherfey et al., <xref rid="B85" ref-type="bibr">2018</xref>), come with enhanced functionality for simplifying batch analysis and parameter explorations. All these tools yield time-series of activity, and some of them even provide the methods for analyzing the generated data. However, simulations only indirectly link a model's parameters with its activity: to gain an understanding of how a model's parameters influence the statistics of their activity, it is necessary to run many simulations with different parameters and analyze the generated data subsequently.</p>
      <p>Other approaches provide a more direct insight into a model's behavior on an abstract level: TheVirtualBrain and the Brain Dynamics Toolbox (Heitmann et al., <xref rid="B40" ref-type="bibr">2018</xref>), for example, allow plotting a model's phase space vector field while the parameters can be changed interactively, allowing for exploration of low-dimensional systems defined by differential equations without the need for simulations. XPPAUT has an interface to AUTO-07P (Doedel and Oldeman, <xref rid="B23" ref-type="bibr">1998</xref>), a software for performing numerical bifurcation and continuation analysis. It is worth noting that such tools are limited to models that are defined in terms of differential equations. Models specified in terms of update rules, such as binary neurons, need to be analyzed differently, for example using mean-field theory.</p>
      <p>A third approach is to simplify the model analytically and simulate the simplified version. The simulation platform DiPDE<xref rid="fn0004" ref-type="fn"><sup>4</sup></xref> utilizes the population density approach to simulate the statistical evolution of a network model's dynamics. Schwalger et al. (<xref rid="B80" ref-type="bibr">2017</xref>) start from a microscopic model of generalized integrate-and-fire neurons and derive mesoscopic mean-field population equations, which reproduce the statistical and qualitative behavior of the homogeneous neuronal sub-populations. Similarly, Montbrió et al. (<xref rid="B57" ref-type="bibr">2015</xref>) derive a set of non-linear differential equations describing the dynamics of the rate and mean membrane potentials of a population of quadratic integrate-and-fire (QIF) neurons. The simulation platform PyRates (Gast et al., <xref rid="B29" ref-type="bibr">2019</xref>) provides an implementation of this QIF mean-field model, and allows simulating them to obtain the temporal evolution of the population activity measures.</p>
      <p>However, mean-field and related theories can go beyond such reduced dynamical equations: they can directly link model parameters to activity statistics, and they can even provide access to informative network properties that might not be accessible otherwise. The spectral bound (Rajan and Abbott, <xref rid="B66" ref-type="bibr">2006</xref>) of the effective connectivity matrix in linear response theory (Lindner et al., <xref rid="B53" ref-type="bibr">2005</xref>; Pernice et al., <xref rid="B63" ref-type="bibr">2011</xref>; Trousdale et al., <xref rid="B92" ref-type="bibr">2012</xref>) is an example of such a property. It is a measure for the stability of the linearized system and determines, for example, the occurrence of slow dynamics and long-range correlations (Dahmen et al., <xref rid="B20" ref-type="bibr">2022</xref>). Another example is the sensitivity measure presented in Section 3.3.3, which directly links a network model's connectivity with the properties of its power spectrum. These measures are not accessible via simulations. They require analytical calculation.</p>
      <p>Similarly, NNMT is not a simulator. NNMT is a collection of mean-field equation implementations that directly relate a model's parameters to the statistics of its dynamics or to other informative properties. It provides these implementations in a format that makes them applicable to as many network models as possible. This is not to say that NNMT does not involve numerical integration procedures; solving self-consistent equations, such as in the case of the firing rates calculations in Section 3.2.1 and Section 3.2.2, is a common task, and a collection of respective solvers is part of NNMT.</p>
    </sec>
    <sec>
      <title>4.2. Use Cases</title>
      <p>In Section 3, we present concrete examples of how to apply some of the tools available. Here, we revisit some of the examples to highlight the use cases NNMT lends itself to, as well as provide some ideas for how the toolbox could be utilized in future projects.</p>
      <p>Analytical methods have the advantage of being fast, and typically they only require a limited amount of computational resources. The computational costs for calculating analytical estimates of dynamical network properties like firing rates, as opposed to the costs of running simulations of a network model, are independent of the number of neurons the network is composed of. This is especially relevant for parameter space explorations, for which many simulations have to be performed. To speed up prototyping, a modeler can first perform a parameter scan using analytical tools from NNMT to get an estimate of the right parameter regimes and subsequently run simulations on this restricted set of parameters to arrive at the final model parameters. An example of such a parameter scan is given in Section 3.2.1, where the firing rates of a network are studied as a function of the external input.</p>
      <p>Additionally to speeding up parameter space explorations, analytical methods may guide parameter space explorations in another way: namely, by providing an analytical relation between network model parameters and network dynamics, which allows a targeted adjustment of specific parameters to achieve a desired network activity. The prime example implemented in NNMT is the sensitivity measure presented in Section 3.3.3, which provides an intuitive relation between the network connectivity and the peaks of the power spectrum corresponding to the dominant oscillation frequencies. As shown in the final part of Section 3.3.3, the sensitivity measure identifies the connections which need to be adjusted in order to modify the dominant oscillation mode in a desired manner. This illustrates a mean-field method that provides a modeler with additional information about the origin of a model's dynamics, such that a parameter space exploration can be restricted to the few identified crucial model parameters.</p>
      <p>A modeler investigating which features of a network model are crucial for the emergence of certain activity characteristics observed in simulations might be interested in comparing models of differing complexity. The respective mappings can be derived in mean-field theory, and one variant included in NNMT, which is presented in Section 3.4, allows mapping a LIF network to a simpler rate network. This is useful to investigate whether spiking dynamics is crucial for the observed phenomenon.</p>
      <p>On a general note, which kind of questions researchers pursue is limited by and therefore depends on the tools they have at hand (Dyson, <xref rid="B24" ref-type="bibr">2012</xref>). The availability of sophisticated neural network simulators for example has lead to the development of conceptually new and more complex neural network models, precisely because their users could focus on actual research questions instead of implementations. We hope that collecting useful implementations of analytical tools for network model analysis will have a similar effect on the development of new tools and that it might lead to new, creative ways of applying them.</p>
    </sec>
    <sec>
      <title>4.3. Limitations</title>
      <p>As a collection of analytical methods, NNMT comes with inherent limitations that apply to any toolbox for analytical methods: it is restricted to network, neuron, and synapse models, as well as observables, for which a mean-field theory exists, and the tools are based on analytical assumptions, simplifications, and approximations, restricting their valid parameter regimes and their explanatory power, which we expand upon in the next paragraphs.</p>
      <p>Analytical methods can provide good estimates of network model properties, but there are limitations that must be considered when interpreting results provided by NNMT: First of all, the employed numerical solvers introduce numerical inaccuracies, but they can be remedied by changing hyperparameters such as integration step sizes or iteration termination thresholds. More importantly, analytical methods almost always rely on approximations, which can only be justified if certain assumptions are fulfilled. Typical examples of such assumptions are fast or slow synapses, or a random connectivity. If such assumptions are not met, at least approximately, and the valid parameter regime of a tool is left, the corresponding method is not guaranteed to give reliable results. Hence, it is important to be aware of a tool's limitations, which we aim to document as thoroughly as possible.</p>
      <p>An important assumption of mean-field theory is uncorrelated Poissonian inputs. As discussed in Section 3.2.1, asynchronous irregular activity is a robust feature of inhibition dominated networks, and mean-field theory is well-suited to describe the activity of such models. However, if a network model features highly correlated activity, or strong external input common to many neurons, approximating the input by uncorrelated noise no longer holds and mean-field estimates become unreliable.</p>
      <p>In addition to the breakdown of such assumptions, some approaches, like linear response theory, rely on neglecting higher order terms. This restricts the tools' explanatory power, as they cannot predict higher order effects, such as the presence of higher harmonics in a network's power spectrum. Addressing these deficiencies necessitates using more elaborate analyses, and users should be aware of such limitations when interpreting the results.</p>
      <p>Finally, a specific limitation of NNMT is that it currently only collects methods for LIF neurons. However, one of the aims of this paper is to encourage other scientists to contribute to the collection, and we outline how to do so in the following section.</p>
    </sec>
    <sec>
      <title>4.4. How to Contribute and Outlook</title>
      <p>A toolbox like NNMT always is an ongoing project, and there are various aspects that can be improved. In this section, we briefly discuss how available methods could be improved, what and how new tools could be added, as well as the benefits of implementing a new method with the help of NNMT.</p>
      <p>First of all, NNMT in its current state is partly vectorized but the included methods are not parallelized, e.g., using multiprocessing or MPI for Python <monospace>(mpi4py</monospace>). Vectorization relies on <monospace>NumPy</monospace> (Harris et al., <xref rid="B39" ref-type="bibr">2020</xref>) and <monospace>SciPy</monospace> (Virtanen et al., <xref rid="B99" ref-type="bibr">2020</xref>), which are thread-parallel for specific backends, e.g., IntelMKL. With the tools available in the toolbox at the moment, run-time only becomes an issue in extensive parameter scans, for instance, when the transfer function needs to be calculated for a large range of frequencies. To further reduce the runtime, the code could be made fully vectorized. Alternatively, parallelization of many tools in NNMT is straightforward, as many of them include <monospace>for</monospace> loops over the different populations of a network model and <monospace>for</monospace> loops over the different analysis frequencies. A third option is just-in-time compilation, as provided by <monospace>Numba</monospace> (Lam et al., <xref rid="B50" ref-type="bibr">2015</xref>).</p>
      <p>Another aspect to consider is the range of network models a tool can be applied to. Thus far, the toolbox primarily supports arbitrary block structured networks. Future developments could extend the class of networks to even more general models.</p>
      <p>Due to the research focus at our lab, NNMT presently mainly contains tools for LIF neurons in the fast synaptic regime and networks with random connectivity. Nonetheless, the structure of NNMT allows for adding methods for different neuron types, like for example binary (Ginzburg and Sompolinsky, <xref rid="B33" ref-type="bibr">1994</xref>) or conductance-based neurons (Izhikevich, <xref rid="B44" ref-type="bibr">2007</xref>; Richardson, <xref rid="B68" ref-type="bibr">2007</xref>), as well as more elaborate network models. Another way to improve the toolbox is adding tools that complement the existing ones: As discussed in Section 4.3, many mean-field methods only give valid results for certain parameter ranges. Sometimes, there exist different approximations for the same quantity, valid in complementary parameter regimes. A concrete example is the currently implemented version of the transfer function for leaky integrate-and-fire neurons, based on Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>), which gives a good estimate for small synaptic time constants compared to the membrane time constant τ<sub>s</sub>/τ<sub>m</sub> ≪ 1. A complementary estimate for τ<sub>s</sub>/τ<sub>m</sub> ≫ 1 has been developed by Moreno-Bote and Parga (<xref rid="B58" ref-type="bibr">2006</xref>). Similarly, the current implementation of the firing rates of leaky integrate-and-fire neurons, based on the work of Fourcaud and Brunel (<xref rid="B27" ref-type="bibr">2002</xref>), is valid for τ<sub>s</sub>/τ<sub>m</sub> ≪ 1. Recently, van Vreeswijk and Farkhooi (<xref rid="B96" ref-type="bibr">2019</xref>) have developed a method accurate for all combinations of synaptic and membrane time constants.</p>
      <p>In the following, we explain how such implementations can be added and how using NNMT helps implementing new methods. Clearly, the implementations of NNMT help implementing methods that build on already existing ones. An example is the firing rate for LIF neurons with exponential synapses <monospace>nnmt.lif.exp._firing_rates()</monospace> which wraps the calculation of firing rates for LIF neurons with delta synapses <monospace>nnmt.lif.delta._firing_rates()</monospace>. Additionally, the toolbox may support the implementation of tools for other neuron models. As an illustration, let us consider adding the computation of the mean activity for a network of binary neurons (included in NNMT 1.1.0). We start with the equations for the mean input μ<sub><italic>a</italic></sub>, its variance <inline-formula><mml:math id="M50" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, and the firing rates <italic><bold>m</bold></italic> (Helias et al., <xref rid="B41" ref-type="bibr">2014</xref>, Equations 4, 6, and 7)</p>
      <disp-formula id="E23">
        <label>(19)</label>
        <mml:math id="M51" overflow="scroll">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>μ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mi>m</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>K</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>J</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mi>m</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>K</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>J</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msubsup>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo>-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mtext class="textrm" mathvariant="normal">erfc</mml:mtext>
                <mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>Θ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>-</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>σ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>with indegree matrix <italic>K</italic><sub><italic>ab</italic></sub> from population <italic>b</italic> to population <italic>a</italic>, synaptic weight matrix <italic>J</italic><sub><italic>ab</italic></sub>, and firing-threshold Θ<sub><italic>a</italic></sub>. The sum <inline-formula><mml:math id="M54" overflow="scroll"><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> may include an external population providing input to the model. This set of self-consistent equations has the same structure as the self-consistent equations for the firing rates of a network of LIF neurons, Equation (8): the input statistics are given as functions of the rate, and the rate is given as a function of the input statistics. Therefore, it is possible to reuse the firing rate integration procedure for LIF neurons, providing immediate access to the two different methods presented in Section 3.2.1. Accordingly, it is sufficient to implement Equation (19) in a new submodule <monospace>nnmt.binary</monospace> and apply the solver provided by NNMT to extend the toolbox to binary neurons.</p>
      <p>The above example demonstrates the benefits of collecting analytical tools for network model analysis in a common framework. The more methods and corresponding solvers the toolbox comprises, the easier implementing new methods becomes. Therefore, contributions to the toolbox are highly welcome; this can be done via the standard pull request workflow on GitHub (see the “Contributors guide” of the official documentation of NNMT<sup>2</sup>). We hope that in the future, many scientists will contribute to this collection of analytical methods for neuronal network model analysis, such that, at some point, we will have tools from all parts of mean-field theory of neuronal networks, made accessible in a usable format to all neuroscientists.</p>
    </sec>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>Publicly available datasets were used in this study, and the corresponding sources are cited in the main text. The toolbox's repository can be found at <ext-link xlink:href="https://github.com/INM-6/nnmt" ext-link-type="uri">https://github.com/INM-6/nnmt</ext-link>, and the parameter files used in the presented examples can be found in the examples section of the online documentation <ext-link xlink:href="https://nnmt.readthedocs.io/en/latest/" ext-link-type="uri">https://nnmt.readthedocs.io/en/latest/</ext-link>.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>HB and MH developed and implemented the code base and the initial version of the toolbox. ML, JS, and SE designed the current version of the toolbox. ML implemented the current version of the toolbox, vectorized and generalized tools, developed and implemented the test suite, wrote the documentation, and created the example shown in Section 3.2.2. AM improved the numerics of the firing rate integration (Methods) and created the example shown in Section 3.2.1. SE implemented integration tests, improved the functions related to the <monospace>sensitivity_measure</monospace>, and created the examples shown in Section 3.3. JS developed and implemented the tools used in Section 3.4 and created the respective example. ML, JS, SE, AM, and MH wrote this article. All authors approved the submitted version.</p>
  </sec>
  <sec sec-type="funding-information" id="s7">
    <title>Funding</title>
    <p>This project has received funding from the European Union's Horizon 2020 Framework Programme for Research and Innovation under Specific Grant Agreement Nos. 720270 (HBP SGA1), 785907 (HBP SGA2), and 945539 (HBP SGA3), has been partially funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) – 368482240/GRK2416, and has been partially funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) – 491111487. This research was supported by the Joint Lab “Supercomputing and Modeling for the Human Brain”.</p>
  </sec>
  <sec sec-type="COI-statement" id="conf1">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s8">
    <title>Publisher's Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank Jannis Schuecker, who has contributed to the development and implementation of the code base and the initial version of the toolbox, and Angela Fischer, who supported us designing <xref rid="F1" ref-type="fig">Figure 1</xref>. Additionally, we would also like to thank our reviewers for the thorough and constructive feedback, which lead to significant improvements.</p>
  </ack>
  <fn-group>
    <fn id="fn0001">
      <p>
        <sup>1</sup>
        <ext-link xlink:href="https://github.com/INM-6/nnmt" ext-link-type="uri">https://github.com/INM-6/nnmt</ext-link>
      </p>
    </fn>
    <fn id="fn0002">
      <p>
        <sup>2</sup>
        <ext-link xlink:href="https://nnmt.readthedocs.io/" ext-link-type="uri">https://nnmt.readthedocs.io/</ext-link>
      </p>
    </fn>
    <fn id="fn0003">
      <p><sup>3</sup>The Lambert <italic>W</italic><sub><italic>B</italic></sub> function is defined as <inline-formula><mml:math id="M49" overflow="scroll"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">e</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> for <italic>z</italic> ∈ ℂ and has infinitely many solutions, numbered by the branches <italic>B</italic>.</p>
    </fn>
    <fn id="fn0004">
      <p>
        <sup>4</sup>
        <ext-link xlink:href="http://alleninstitute.github.io/dipde" ext-link-type="uri">http://alleninstitute.github.io/dipde</ext-link>
      </p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Abramowitz</surname><given-names>M.</given-names></name><name><surname>Stegun</surname><given-names>I. A.</given-names></name></person-group> (<year>1974</year>). <source>Handbook of Mathematical Functions: With Formulas, Graphs, and Mathematical Tables</source> (<publisher-loc>New York</publisher-loc>: <publisher-name>Dover Publications</publisher-name>).</mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmadian</surname><given-names>Y.</given-names></name><name><surname>Miller</surname><given-names>K. D.</given-names></name></person-group> (<year>2021</year>). <article-title>What is the dynamical regime of cerebral cortex?</article-title>
<source>Neuron</source>
<volume>109</volume>, <fpage>3373</fpage>–<lpage>3391</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2021.07.031</pub-id><?supplied-pmid 34464597?><pub-id pub-id-type="pmid">34464597</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amari</surname><given-names>S.-I.</given-names></name></person-group> (<year>1975</year>). <article-title>Homogeneous nets of neuron-like elements</article-title>. <source>Biol. Cybern.</source>
<volume>17</volume>, <fpage>211</fpage>–<lpage>220</lpage>. <pub-id pub-id-type="doi">10.1007/BF00339367</pub-id><?supplied-pmid 1125349?><pub-id pub-id-type="pmid">1125349</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amari</surname><given-names>S.-I.</given-names></name></person-group> (<year>1977</year>). <article-title>Dynamics of pattern formation in lateral-inhibition type neural fields</article-title>. <source>Biol. Cybern.</source>
<volume>27</volume>, <fpage>77</fpage>–<lpage>87</lpage>. <pub-id pub-id-type="doi">10.1007/bf00337259</pub-id><?supplied-pmid 911931?><pub-id pub-id-type="pmid">911931</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amit</surname><given-names>D. J.</given-names></name><name><surname>Brunel</surname><given-names>N.</given-names></name></person-group> (<year>1997a</year>). <article-title>Dynamics of a recurrent network of spiking neurons before and following learning</article-title>. <source>Netw. Comp. Neural Sys.</source>
<volume>8</volume>, <fpage>373</fpage>–<lpage>404</lpage>. <pub-id pub-id-type="doi">10.1088/0954-898x_8_4_003</pub-id><?supplied-pmid 26463272?><pub-id pub-id-type="pmid">26463272</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amit</surname><given-names>D. J.</given-names></name><name><surname>Brunel</surname><given-names>N.</given-names></name></person-group> (<year>1997b</year>). <article-title>Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex</article-title>. <source>Cereb. Cortex</source>
<volume>7</volume>, <fpage>237</fpage>–<lpage>252</lpage>. <pub-id pub-id-type="doi">10.1093/cercor/7.3.237</pub-id><?supplied-pmid 9143444?><pub-id pub-id-type="pmid">9143444</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amit</surname><given-names>D. J.</given-names></name><name><surname>Tsodyks</surname><given-names>M. V.</given-names></name></person-group> (<year>1991</year>). <article-title>Quantitative study of attractor neural network retrieving at low spike rates I: substrate–spikes, rates and neuronal gain</article-title>. <source>Network</source>
<volume>2</volume>, <fpage>259</fpage>. <pub-id pub-id-type="doi">10.1088/0954-898X_2_3_003</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bos</surname><given-names>H.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><name><surname>Helias</surname><given-names>M.</given-names></name></person-group> (<year>2016</year>). <article-title>Identifying anatomical origins of coexisting oscillations in the cortical microcircuit</article-title>. <source>PLOS Comput. Biol.</source>
<volume>12</volume>, <fpage>e1005132</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005132</pub-id><?supplied-pmid 27736873?><pub-id pub-id-type="pmid">27736873</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Braitenberg</surname><given-names>V.</given-names></name><name><surname>Schüz</surname><given-names>A.</given-names></name></person-group> (<year>1998</year>). <source>Cortex: Statistics and Geometry of Neuronal Connectivity, 2nd Edn.</source>
<publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bressloff</surname><given-names>P. C.</given-names></name></person-group> (<year>2012</year>). <article-title>Spatiotemporal dynamics of continuum neural fields</article-title>. <source>J. Phys. A</source>
<volume>45</volume>, <fpage>033001</fpage>. <pub-id pub-id-type="doi">10.1088/1751-8113/45/3/033001</pub-id><?supplied-pmid 20457860?><pub-id pub-id-type="pmid">20457860</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bressloff</surname><given-names>P. C.</given-names></name><name><surname>Cowan</surname><given-names>J. D.</given-names></name><name><surname>Golubitsky</surname><given-names>M.</given-names></name><name><surname>Thomas</surname><given-names>P. J.</given-names></name><name><surname>Wiener</surname><given-names>M. C.</given-names></name></person-group> (<year>2001</year>). <article-title>Geometric visual hallucinations, euclidean symmetry and the functional architecture of striate cortex</article-title>. <source>Phil. Trans. R. Soc. B</source>
<volume>356</volume>, <fpage>299</fpage>–<lpage>330</lpage>. <pub-id pub-id-type="doi">10.1098/rstb.2000.0769</pub-id><?supplied-pmid 11316482?><pub-id pub-id-type="pmid">11316482</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname><given-names>N.</given-names></name></person-group> (<year>2000</year>). <article-title>Dynamics of sparsely connected networks of excitatory and inhibitory spiking neurons</article-title>. <source>J. Comput. Neurosci.</source>
<volume>8</volume>, <fpage>183</fpage>–<lpage>208</lpage>. <pub-id pub-id-type="doi">10.1023/a:1008925309027</pub-id><?supplied-pmid 10809012?><pub-id pub-id-type="pmid">10809012</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname><given-names>N.</given-names></name><name><surname>Chance</surname><given-names>F. S.</given-names></name><name><surname>Fourcaud</surname><given-names>N.</given-names></name><name><surname>Abbott</surname><given-names>L. F.</given-names></name></person-group> (<year>2001</year>). <article-title>Effects of synaptic noise and filtering on the frequency response of spiking neurons</article-title>. <source>Phys. Rev. Lett.</source>
<volume>86</volume>, <fpage>2186</fpage>–<lpage>2189</lpage>. <pub-id pub-id-type="doi">10.1103/physrevlett.86.2186</pub-id><?supplied-pmid 11289886?><pub-id pub-id-type="pmid">11289886</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname><given-names>N.</given-names></name><name><surname>Hakim</surname><given-names>V.</given-names></name></person-group> (<year>1999</year>). <article-title>Fast global oscillations in networks of integrate-and-fire neurons with low firing rates</article-title>. <source>Neural Comput.</source>
<volume>11</volume>, <fpage>1621</fpage>–<lpage>1671</lpage>. <pub-id pub-id-type="doi">10.1162/089976699300016179</pub-id><?supplied-pmid 10490941?><pub-id pub-id-type="pmid">10490941</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname><given-names>N.</given-names></name><name><surname>Latham</surname><given-names>P.</given-names></name></person-group> (<year>2003</year>). <article-title>Firing rate of the noisy quadratic integrate-and-fire neuron</article-title>. <source>Neural Comput.</source>
<volume>15</volume>, <fpage>2281</fpage>–<lpage>2306</lpage>. <pub-id pub-id-type="doi">10.1162/089976603322362365</pub-id><?supplied-pmid 14511522?><pub-id pub-id-type="pmid">14511522</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buice</surname><given-names>M. A.</given-names></name><name><surname>Chow</surname><given-names>C. C.</given-names></name></person-group> (<year>2013</year>). <article-title>Beyond mean field theory: statistical field theory for neural networks</article-title>. <source>J. Stat. Mech.</source>
<volume>2013</volume>, <fpage>P03003</fpage>. <pub-id pub-id-type="doi">10.1088/1742-5468/2013/03/P03003</pub-id><?supplied-pmid 25243014?><pub-id pub-id-type="pmid">25243014</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coombes</surname><given-names>S.</given-names></name></person-group> (<year>2005</year>). <article-title>Waves, bumps, and patterns in neural field theories</article-title>. <source>Biol. Cybern.</source>
<volume>93</volume>, <fpage>91</fpage>–<lpage>108</lpage>. <pub-id pub-id-type="doi">10.1007/s00422-005-0574-y</pub-id><?supplied-pmid 16059785?><pub-id pub-id-type="pmid">16059785</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Coombes</surname><given-names>S.</given-names></name><name><surname>bei Graben</surname><given-names>P.</given-names></name><name><surname>Potthast</surname><given-names>R.</given-names></name><name><surname>Wright</surname><given-names>J.</given-names></name></person-group> (<year>2014</year>). <source>Neural Fields. Theory and Applications.</source>
<publisher-loc>Berlin; Heidelberg</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corless</surname><given-names>R. M.</given-names></name><name><surname>Gonnet</surname><given-names>G. H.</given-names></name><name><surname>Hare</surname><given-names>D. E. G.</given-names></name><name><surname>Jeffrey</surname><given-names>D. J.</given-names></name><name><surname>Knuth</surname><given-names>D. E.</given-names></name></person-group> (<year>1996</year>). <article-title>On the lambert w function</article-title>. <source>Adv. Comput. Math.</source>
<volume>5</volume>, <fpage>329</fpage>–<lpage>359</lpage>. <pub-id pub-id-type="doi">10.1007/BF02124750</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dahmen</surname><given-names>D.</given-names></name><name><surname>Layer</surname><given-names>M.</given-names></name><name><surname>Deutz</surname><given-names>L.</given-names></name><name><surname>Dąbrowska</surname><given-names>P. A.</given-names></name><name><surname>Voges</surname><given-names>N.</given-names></name><name><surname>von Papen</surname><given-names>M.</given-names></name><etal/></person-group>. (<year>2022</year>). <article-title>Global organization of neuronal activity only requires unstructured local connectivity</article-title>. <source>eLife</source><volume>11</volume>, <fpage>e68422</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.68422.sa0</pub-id><?supplied-pmid 35049496?><pub-id pub-id-type="pmid">35049496</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dasbach</surname><given-names>S.</given-names></name><name><surname>Tetzlaff</surname><given-names>T.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><name><surname>Senk</surname><given-names>J.</given-names></name></person-group> (<year>2021</year>). <article-title>Dynamical characteristics of recurrent neuronal networks are robust against low synaptic weight resolution</article-title>. <source>Front. Neurosci.</source>
<volume>15</volume>, <fpage>757790</fpage>. <pub-id pub-id-type="doi">10.3389/fnins.2021.757790</pub-id><?supplied-pmid 35002599?><pub-id pub-id-type="pmid">35002599</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeFelipe</surname><given-names>J.</given-names></name><name><surname>Alonso-Nanclares</surname><given-names>L.</given-names></name><name><surname>Arellano</surname><given-names>J.</given-names></name></person-group> (<year>2002</year>). <article-title>Microstructure of the neocortex: comparative aspects</article-title>. <source>J. Neurocytol.</source>
<volume>31</volume>, <fpage>299</fpage>–<lpage>316</lpage>. <pub-id pub-id-type="doi">10.1023/A:1024130211265</pub-id><?supplied-pmid 12815249?><pub-id pub-id-type="pmid">12815249</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Doedel</surname><given-names>E. J.</given-names></name><name><surname>Oldeman</surname><given-names>B.</given-names></name></person-group> (<year>1998</year>). <source>Auto-07p: Continuation and Bifurcation Software.</source>
<publisher-loc>Montreal, QC</publisher-loc>: <publisher-name>Concordia University Canada</publisher-name></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dyson</surname><given-names>F. J.</given-names></name></person-group> (<year>2012</year>). <article-title>Is science mostly driven by ideas or by tools?</article-title>
<source>Science</source>
<volume>338</volume>, <fpage>1426</fpage>–<lpage>1427</lpage>. <pub-id pub-id-type="doi">10.1126/science.1232773</pub-id><?supplied-pmid 23239721?><pub-id pub-id-type="pmid">23239721</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ermentrout</surname><given-names>B.</given-names></name></person-group> (<year>2002</year>). <source>Simulating, Analyzing, and Animating Dynamical Systems: A Guide to Xppaut for Researchers and Students (Software, Environments, Tools).</source>
<publisher-loc>Philadelphia, PA</publisher-loc>: <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ermentrout</surname><given-names>G. B.</given-names></name><name><surname>Cowan</surname><given-names>J. D.</given-names></name></person-group> (<year>1979</year>). <article-title>A mathematical theory of visual hallucination patterns</article-title>. <source>Biol. Cybern.</source>
<volume>34</volume>, <fpage>137</fpage>–<lpage>150</lpage>. <pub-id pub-id-type="doi">10.1007/BF00336965</pub-id><?supplied-pmid 486593?><pub-id pub-id-type="pmid">486593</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fourcaud</surname><given-names>N.</given-names></name><name><surname>Brunel</surname><given-names>N.</given-names></name></person-group> (<year>2002</year>). <article-title>Dynamics of the firing probability of noisy integrate-and-fire neurons</article-title>. <source>Neural Comput.</source>
<volume>14</volume>, <fpage>2057</fpage>–<lpage>2110</lpage>. <pub-id pub-id-type="doi">10.1162/089976602320264015</pub-id><?supplied-pmid 12184844?><pub-id pub-id-type="pmid">12184844</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fourcaud-Trocmé</surname><given-names>N.</given-names></name><name><surname>Hansel</surname><given-names>D.</given-names></name><name><surname>van Vreeswijk</surname><given-names>C.</given-names></name><name><surname>Brunel</surname><given-names>N.</given-names></name></person-group> (<year>2003</year>). <article-title>How spike generation mechanisms determine the neuronal response to fluctuating inputs</article-title>. <source>J. Neurosci.</source>
<volume>23</volume>, <fpage>11628</fpage>–<lpage>11640</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-37-11628.2003</pub-id><?supplied-pmid 14684865?><pub-id pub-id-type="pmid">14684865</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gast</surname><given-names>R.</given-names></name><name><surname>Rose</surname><given-names>D.</given-names></name><name><surname>Salomon</surname><given-names>C.</given-names></name><name><surname>Möller</surname><given-names>H. E.</given-names></name><name><surname>Weiskopf</surname><given-names>N.</given-names></name><name><surname>Knösche</surname><given-names>T. R.</given-names></name></person-group> (<year>2019</year>). <article-title>Pyrates - a python framework for rate-based neural simulations</article-title>. <source>PLoS ONE</source>
<volume>14</volume>, <fpage>e0225900</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0225900</pub-id><?supplied-pmid 31841550?><pub-id pub-id-type="pmid">31841550</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname><given-names>W.</given-names></name><name><surname>Kistler</surname><given-names>W. M.</given-names></name><name><surname>Naud</surname><given-names>R.</given-names></name><name><surname>Paninski</surname><given-names>L.</given-names></name></person-group> (<year>2014</year>). <source>Neuronal Dynamics. From Single Neurons to Networks and Models of Cognition.</source>
<publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gewaltig</surname><given-names>M.-O.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name></person-group> (<year>2007</year>). <article-title>NEST (nEural simulation tool)</article-title>. <source>Scholarpedia</source>
<volume>2</volume>, <fpage>1430</fpage>. <pub-id pub-id-type="doi">10.4249/scholarpedia.1430</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Giese</surname><given-names>M. A.</given-names></name></person-group> (<year>2012</year>). <source>Dynamic Neural Field Theory for Motion Perception, Vol. 469.</source>
<publisher-loc>Berlin; Heidelberg</publisher-loc>: <publisher-name>Springer Science &amp; Business Media</publisher-name>)</mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ginzburg</surname><given-names>I.</given-names></name><name><surname>Sompolinsky</surname><given-names>H.</given-names></name></person-group> (<year>1994</year>). <article-title>Theory of correlations in stochastic neural networks</article-title>. <source>Phys. Rev. E</source>
<volume>50</volume>, <fpage>3171</fpage>–<lpage>3191</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.50.3171</pub-id><?supplied-pmid 9962363?><pub-id pub-id-type="pmid">9962363</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Goldenfeld</surname><given-names>N.</given-names></name></person-group> (<year>1992</year>). <source>Lectures on Phase Transitions and the Renormalization Group.</source>
<publisher-loc>Reading, MA</publisher-loc>: <publisher-name>Perseus books</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golosio</surname><given-names>B.</given-names></name><name><surname>Tiddia</surname><given-names>G.</given-names></name><name><surname>Luca</surname><given-names>C. D.</given-names></name><name><surname>Pastorelli</surname><given-names>E.</given-names></name><name><surname>Simula</surname><given-names>F.</given-names></name><name><surname>Paolucci</surname><given-names>P. S.</given-names></name></person-group> (<year>2021</year>). <article-title>Fast simulations of highly-connected spiking cortical models using GPUs</article-title>. <source>Front. Comput. Neurosci.</source>
<volume>15</volume>, <fpage>627620</fpage>. <pub-id pub-id-type="doi">10.3389/fncom.2021.627620</pub-id><?supplied-pmid 33679358?><pub-id pub-id-type="pmid">33679358</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grabska-Barwinska</surname><given-names>A.</given-names></name><name><surname>Latham</surname><given-names>P.</given-names></name></person-group> (<year>2014</year>). <article-title>How well do mean field theories of spiking quadratic-integrate-and-fire networks work in realistic parameter regimes?</article-title>
<source>J. Comput. Neurosci.</source>
<volume>36</volume>, <fpage>469</fpage>–<lpage>481</lpage>. <pub-id pub-id-type="doi">10.1007/s10827-013-0481-5</pub-id><?supplied-pmid 24091644?><pub-id pub-id-type="pmid">24091644</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grytskyy</surname><given-names>D.</given-names></name><name><surname>Tetzlaff</surname><given-names>T.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><name><surname>Helias</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>). <article-title>A unified view on weakly correlated recurrent networks</article-title>. <source>Front. Comput. Neurosci.</source>
<volume>7</volume>, <fpage>131</fpage>. <pub-id pub-id-type="doi">10.3389/fncom.2013.00131</pub-id><?supplied-pmid 24151463?><pub-id pub-id-type="pmid">24151463</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagen</surname><given-names>E.</given-names></name><name><surname>Dahmen</surname><given-names>D.</given-names></name><name><surname>Stavrinou</surname><given-names>M. L.</given-names></name><name><surname>Lindén</surname><given-names>H.</given-names></name><name><surname>Tetzlaff</surname><given-names>T.</given-names></name><name><surname>van Albada</surname><given-names>S. J.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Hybrid scheme for modeling local field potentials from point-neuron networks</article-title>. <source>Cereb. Cortex</source><volume>26</volume>, <fpage>4461</fpage>–<lpage>4496</lpage>. <pub-id pub-id-type="doi">10.1093/cercor/bhw237</pub-id><?supplied-pmid 27797828?><pub-id pub-id-type="pmid">27797828</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>C. R.</given-names></name><name><surname>Millman</surname><given-names>K. J.</given-names></name><name><surname>van der Walt</surname><given-names>S. J.</given-names></name><name><surname>Gommers</surname><given-names>R.</given-names></name><name><surname>Virtanen</surname><given-names>P.</given-names></name><name><surname>Cournapeau</surname><given-names>D.</given-names></name><etal/></person-group>. (<year>2020</year>). <article-title>Array programming with NumPy</article-title>. <source>Nature</source><volume>585</volume>, <fpage>357</fpage>–<lpage>362</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id><?supplied-pmid 32939066?><pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heitmann</surname><given-names>S.</given-names></name><name><surname>Aburn</surname><given-names>M. J.</given-names></name><name><surname>Breakspear</surname><given-names>M.</given-names></name></person-group> (<year>2018</year>). <article-title>The brain dynamics toolbox for matlab</article-title>. <source>Neurocomputing</source>
<volume>315</volume>, <fpage>82</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/j.neucom.2018.06.026</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Helias</surname><given-names>M.</given-names></name><name><surname>Tetzlaff</surname><given-names>T.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name></person-group> (<year>2014</year>). <article-title>The correlation structure of local cortical networks intrinsically results from recurrent dynamics</article-title>. <source>PLoS Comput. Biol.</source>
<volume>10</volume>, <fpage>e1003428</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003428</pub-id><?supplied-pmid 24453955?><pub-id pub-id-type="pmid">24453955</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hertz</surname><given-names>J.</given-names></name></person-group> (<year>2010</year>). <article-title>Cross-correlations in high-conductance states of a model cortical network</article-title>. <source>Neural Comput.</source>
<volume>22</volume>, <fpage>427</fpage>–<lpage>447</lpage>. <pub-id pub-id-type="doi">10.1162/neco.2009.06-08-806</pub-id><?supplied-pmid 19842988?><pub-id pub-id-type="pmid">19842988</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hines</surname><given-names>M. L.</given-names></name><name><surname>Carnevale</surname><given-names>N. T.</given-names></name></person-group> (<year>2001</year>). <article-title>NEURON: a tool for neuroscientists</article-title>. <source>Neuroscientist</source>
<volume>7</volume>, <fpage>123</fpage>–<lpage>135</lpage>. <pub-id pub-id-type="doi">10.1177/107385840100700207</pub-id><?supplied-pmid 11496923?><pub-id pub-id-type="pmid">11496923</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Izhikevich</surname><given-names>E. M.</given-names></name></person-group> (<year>2007</year>). <source>Dynamical Systems in Neuroscience: The Geometry of Excitability and Bursting.</source>
<publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>.<?supplied-pmid 32266428?></mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jirsa</surname><given-names>V. K.</given-names></name><name><surname>Haken</surname><given-names>H.</given-names></name></person-group> (<year>1996</year>). <article-title>Field theory of electromagnetic brain activity</article-title>. <source>Phys. Rev. Lett.</source>
<volume>77</volume>, <fpage>960</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.77.960</pub-id><?supplied-pmid 10062950?><pub-id pub-id-type="pmid">10062950</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jirsa</surname><given-names>V. K.</given-names></name><name><surname>Haken</surname><given-names>H.</given-names></name></person-group> (<year>1997</year>). <article-title>A derivation of a macroscopic field theory of the brain from the quasi-microscopic neural dynamics</article-title>. <source>Phys. D</source>
<volume>99</volume>, <fpage>503</fpage>–<lpage>526</lpage>. <pub-id pub-id-type="doi">10.1016/S0167-2789(96)00166-2</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname><given-names>J. C.</given-names></name><name><surname>Nowotny</surname><given-names>T.</given-names></name></person-group> (<year>2018</year>). <article-title>GPUs outperform current HPC and neuromorphic solutions in terms of speed and energy when simulating a highly-connected cortical model</article-title>. <source>Front. Neurosci.</source>
<volume>12</volume>, <fpage>941</fpage>. <pub-id pub-id-type="doi">10.3389/fnins.2018.00941</pub-id><?supplied-pmid 30618570?><pub-id pub-id-type="pmid">30618570</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laing</surname><given-names>C. R.</given-names></name><name><surname>Troy</surname><given-names>W. C.</given-names></name></person-group> (<year>2003</year>). <article-title>Two-bump solutions of amari-type models of neuronal pattern formation</article-title>. <source>Phys. D</source>
<volume>178</volume>, <fpage>190</fpage>–<lpage>218</lpage>. <pub-id pub-id-type="doi">10.1016/S0167-2789(03)00013-7</pub-id><?supplied-pmid 34417880?><pub-id pub-id-type="pmid">34417880</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laing</surname><given-names>C. R.</given-names></name><name><surname>Troy</surname><given-names>W. C.</given-names></name><name><surname>Gutkin</surname><given-names>B.</given-names></name><name><surname>Ermentrout</surname><given-names>B. G.</given-names></name></person-group> (<year>2002</year>). <article-title>Multiple bumps in a neuronal model of working memory</article-title>. <source>SIAM J. Appl. Math.</source>
<volume>63</volume>, <fpage>62</fpage>–<lpage>97</lpage>. <pub-id pub-id-type="doi">10.1137/s0036139901389495</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lam</surname><given-names>S. K.</given-names></name><name><surname>Pitrou</surname><given-names>A.</given-names></name><name><surname>Seibert</surname><given-names>S.</given-names></name></person-group> (<year>2015</year>). <article-title>Numba: a llvm-based python jit compiler</article-title>, in <source>Proceedings of the Second Workshop on the LLVM Compiler Infrastructure in HPC</source>, <publisher-loc>Austin, TX</publisher-loc>, <fpage>1</fpage>–<lpage>6</lpage><?supplied-pmid 35500032?></mixed-citation>
    </ref>
    <ref id="B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Layer</surname><given-names>M.</given-names></name><name><surname>Senk</surname><given-names>J.</given-names></name><name><surname>Essink</surname><given-names>S.</given-names></name><name><surname>van Meegen</surname><given-names>A.</given-names></name><name><surname>Bos</surname><given-names>H.</given-names></name><name><surname>Helias</surname><given-names>M.</given-names></name></person-group> (<year>2021</year>). <article-title>NNMT (1.0.0)</article-title>. <source>Zenodo</source>. <pub-id pub-id-type="doi">10.5281/zenodo.5779548</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindner</surname><given-names>B.</given-names></name></person-group> (<year>2004</year>). <article-title>Interspike interval statistics of neurons driven by colored noise</article-title>. <source>Phys. Rev. E</source>
<volume>69</volume>, <fpage>0229011</fpage>–<lpage>0229014</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.69.022901</pub-id><?supplied-pmid 14995506?><pub-id pub-id-type="pmid">14995506</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindner</surname><given-names>B.</given-names></name><name><surname>Doiron</surname><given-names>B.</given-names></name><name><surname>Longtin</surname><given-names>A.</given-names></name></person-group> (<year>2005</year>). <article-title>Theory of oscillatory firing induced by spatially correlated noise and delayed inhibitory feedback</article-title>. <source>Phys. Rev. E</source>
<volume>72</volume>, <fpage>061919</fpage>. <pub-id pub-id-type="doi">10.1103/physreve.72.061919</pub-id><?supplied-pmid 16485986?><pub-id pub-id-type="pmid">16485986</pub-id></mixed-citation>
    </ref>
    <ref id="B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindner</surname><given-names>B.</given-names></name><name><surname>Longtin</surname><given-names>A.</given-names></name></person-group> (<year>2005</year>). <article-title>Effect of an exponentially decaying threshold on the firing statistis of a stochastic integate-and-fire neuron</article-title>. <source>J. Theor. Biol.</source>
<volume>232</volume>, <fpage>505</fpage>–<lpage>521</lpage>. <pub-id pub-id-type="doi">10.1016/j.jtbi.2004.08.030</pub-id><?supplied-pmid 15588632?><pub-id pub-id-type="pmid">15588632</pub-id></mixed-citation>
    </ref>
    <ref id="B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindner</surname><given-names>B.</given-names></name><name><surname>Schimansky-Geier</surname><given-names>L.</given-names></name></person-group> (<year>2001</year>). <article-title>Transmission of noise coded versus additive signals through a neuronal ensemble</article-title>. <source>Phys. Rev. Lett.</source>
<volume>86</volume>, <fpage>2934</fpage>–<lpage>2937</lpage>. <pub-id pub-id-type="doi">10.1103/physrevlett.86.2934</pub-id><?supplied-pmid 11290076?><pub-id pub-id-type="pmid">11290076</pub-id></mixed-citation>
    </ref>
    <ref id="B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mattia</surname><given-names>M.</given-names></name><name><surname>Biggio</surname><given-names>M.</given-names></name><name><surname>Galluzzi</surname><given-names>A.</given-names></name><name><surname>Storace</surname><given-names>M.</given-names></name></person-group> (<year>2019</year>). <article-title>Dimensional reduction in networks of non-markovian spiking neurons: Equivalence of synaptic filtering and heterogeneous propagation delays</article-title>. <source>PLoS Comput. Biol.</source>
<volume>15</volume>, <fpage>e1007404</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007404</pub-id><?supplied-pmid 31593569?><pub-id pub-id-type="pmid">31593569</pub-id></mixed-citation>
    </ref>
    <ref id="B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montbrió</surname><given-names>E.</given-names></name><name><surname>Pazó</surname><given-names>D.</given-names></name><name><surname>Roxin</surname><given-names>A.</given-names></name></person-group> (<year>2015</year>). <article-title>Macroscopic description for networks of spiking neurons</article-title>. <source>Phys Rev X</source>
<volume>5</volume>, <fpage>021028</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevX.5.021028</pub-id></mixed-citation>
    </ref>
    <ref id="B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moreno-Bote</surname><given-names>R.</given-names></name><name><surname>Parga</surname><given-names>N.</given-names></name></person-group> (<year>2006</year>). <article-title>Auto- and crosscorrelograms for the spike response of leaky integrate-and-fire neurons with slow synapses</article-title>. <source>Phys. Rev. Lett.</source>
<volume>96</volume>, <fpage>028101</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.96.028101</pub-id><?supplied-pmid 16486646?><pub-id pub-id-type="pmid">16486646</pub-id></mixed-citation>
    </ref>
    <ref id="B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nunez</surname><given-names>P. L.</given-names></name></person-group> (<year>1974</year>). <article-title>The brain wave equation: a model for the eeg</article-title>. <source>Math. Biosci.</source>
<volume>21</volume>, <fpage>279</fpage>–<lpage>297</lpage>. <pub-id pub-id-type="doi">10.1016/0025-5564(74)90020-0</pub-id></mixed-citation>
    </ref>
    <ref id="B60">
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Olver</surname><given-names>F. W. J.</given-names></name><name><surname>Olde Daalhuis</surname><given-names>A. B.</given-names></name><name><surname>Lozier</surname><given-names>D. W.</given-names></name><name><surname>Schneider</surname><given-names>B. I.</given-names></name><name><surname>Boisvert</surname><given-names>R. F.</given-names></name><name><surname>Clark</surname><given-names>C. W.</given-names></name><etal/></person-group>. (<year>2021</year>). <source>NIST Digital Library of Mathematical Functions</source>. Available online at: <ext-link xlink:href="http://dlmf.nist.gov/" ext-link-type="uri">http://dlmf.nist.gov/</ext-link></mixed-citation>
    </ref>
    <ref id="B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostojic</surname><given-names>S.</given-names></name></person-group> (<year>2014</year>). <article-title>Two types of asynchronous activity in networks of excitatory and inhibitory spiking neurons</article-title>. <source>Nat. Neurosci.</source>
<volume>17</volume>, <fpage>594</fpage>–<lpage>600</lpage>. <pub-id pub-id-type="doi">10.1038/nn.3658</pub-id><?supplied-pmid 27746905?><pub-id pub-id-type="pmid">24561997</pub-id></mixed-citation>
    </ref>
    <ref id="B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostojic</surname><given-names>S.</given-names></name><name><surname>Brunel</surname><given-names>N.</given-names></name></person-group> (<year>2011</year>). <article-title>From spiking neuron models to linear-nonlinear models</article-title>. <source>PLoS Comput. Biol.</source>
<volume>7</volume>, <fpage>e1001056</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1001056</pub-id><?supplied-pmid 21283777?><pub-id pub-id-type="pmid">21283777</pub-id></mixed-citation>
    </ref>
    <ref id="B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pernice</surname><given-names>V.</given-names></name><name><surname>Staude</surname><given-names>B.</given-names></name><name><surname>Cardanobile</surname><given-names>S.</given-names></name><name><surname>Rotter</surname><given-names>S.</given-names></name></person-group> (<year>2011</year>). <article-title>How structure determines correlations in neuronal networks</article-title>. <source>PLoS Comput. Biol.</source>
<volume>7</volume>, <fpage>e1002059</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002059</pub-id><?supplied-pmid 21625580?><pub-id pub-id-type="pmid">21625580</pub-id></mixed-citation>
    </ref>
    <ref id="B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potjans</surname><given-names>T. C.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name></person-group> (<year>2014</year>). <article-title>The cell-type specific cortical microcircuit: relating structure and activity in a full-scale spiking network model</article-title>. <source>Cereb. Cortex</source>
<volume>24</volume>, <fpage>785</fpage>–<lpage>806</lpage>. <pub-id pub-id-type="doi">10.1093/cercor/bhs358</pub-id><?supplied-pmid 23203991?><pub-id pub-id-type="pmid">23203991</pub-id></mixed-citation>
    </ref>
    <ref id="B65">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Press</surname><given-names>W. H.</given-names></name><name><surname>Teukolsky</surname><given-names>S. A.</given-names></name><name><surname>Vetterling</surname><given-names>W. T.</given-names></name><name><surname>Flannery</surname><given-names>B. P.</given-names></name></person-group> (<year>2007</year>). <source>Numerical Recipes: The Art of Scientific Computing</source>, <edition>3rd edn.</edition>
<publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajan</surname><given-names>K.</given-names></name><name><surname>Abbott</surname><given-names>L. F.</given-names></name></person-group> (<year>2006</year>). <article-title>Eigenvalue spectra of random matrices for neural networks</article-title>. <source>Phys. Rev. Lett.</source>
<volume>97</volume>, <fpage>188104</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.97.188104</pub-id><?supplied-pmid 23005171?><pub-id pub-id-type="pmid">17155583</pub-id></mixed-citation>
    </ref>
    <ref id="B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Renart</surname><given-names>A.</given-names></name><name><surname>De La Rocha</surname><given-names>J.</given-names></name><name><surname>Bartho</surname><given-names>P.</given-names></name><name><surname>Hollender</surname><given-names>L.</given-names></name><name><surname>Parga</surname><given-names>N.</given-names></name><name><surname>Reyes</surname><given-names>A.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>The asynchronous state in cortical circuits</article-title>. <source>Science</source><volume>327</volume>, <fpage>587</fpage>–<lpage>590</lpage>. <pub-id pub-id-type="doi">10.1126/science.1179850</pub-id><?supplied-pmid 20110507?><pub-id pub-id-type="pmid">20110507</pub-id></mixed-citation>
    </ref>
    <ref id="B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richardson</surname><given-names>M. J. E.</given-names></name></person-group> (<year>2007</year>). <article-title>Firing-rate response of linear and nonlinear integrate-and-fire neurons to modulated current-based and conductance-based synaptic drive</article-title>. <source>Phys. Rev. E</source>
<volume>76</volume>, <fpage>1</fpage>–<lpage>15</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.76.021919</pub-id><?supplied-pmid 17930077?><pub-id pub-id-type="pmid">17930077</pub-id></mixed-citation>
    </ref>
    <ref id="B69">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richardson</surname><given-names>M. J. E.</given-names></name></person-group> (<year>2008</year>). <article-title>Spike-train spectra and network response functions for non-linear integrate-and-fire neurons</article-title>. <source>Biol. Cybern.</source>
<volume>99</volume>, <fpage>381</fpage>–<lpage>392</lpage>. <pub-id pub-id-type="doi">10.1007/s00422-008-0244-y</pub-id><?supplied-pmid 19011926?><pub-id pub-id-type="pmid">19011926</pub-id></mixed-citation>
    </ref>
    <ref id="B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riquelme</surname><given-names>J. L.</given-names></name><name><surname>Gjorgjieva</surname><given-names>J.</given-names></name></person-group> (<year>2021</year>). <article-title>Towards readable code in neuroscience</article-title>. <source>Nat. Rev. Neurosci.</source>
<volume>22</volume>, <fpage>257</fpage>–<lpage>258</lpage>. <pub-id pub-id-type="doi">10.1038/s41583-021-00450-y</pub-id><?supplied-pmid 33707744?><pub-id pub-id-type="pmid">33707744</pub-id></mixed-citation>
    </ref>
    <ref id="B71">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenbaum</surname><given-names>R.</given-names></name><name><surname>Doiron</surname><given-names>B.</given-names></name></person-group> (<year>2014</year>). <article-title>Balanced networks of spiking neurons with spatially dependent recurrent connections</article-title>. <source>Phys. Rev. X</source>
<volume>4</volume>, <fpage>021039</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevX.4.021039</pub-id></mixed-citation>
    </ref>
    <ref id="B72">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenbaum</surname><given-names>R.</given-names></name><name><surname>Smith</surname><given-names>M. A.</given-names></name><name><surname>Kohn</surname><given-names>A.</given-names></name><name><surname>Rubin</surname><given-names>J. E.</given-names></name><name><surname>Doiron</surname><given-names>B.</given-names></name></person-group> (<year>2017</year>). <article-title>The spatial structure of correlated neuronal variability</article-title>. <source>Nat. Neurosci.</source>
<volume>20</volume>, <fpage>107</fpage>–<lpage>114</lpage>. <pub-id pub-id-type="doi">10.1038/nn.4433</pub-id><?supplied-pmid 27798630?><pub-id pub-id-type="pmid">27798630</pub-id></mixed-citation>
    </ref>
    <ref id="B73">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanz Leon</surname><given-names>P.</given-names></name><name><surname>Knock</surname><given-names>S.</given-names></name><name><surname>Woodman</surname><given-names>M.</given-names></name><name><surname>Domide</surname><given-names>L.</given-names></name><name><surname>Mersmann</surname><given-names>J.</given-names></name><name><surname>McIntosh</surname><given-names>A.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>The virtual brain: a simulator of primate brain network dynamics</article-title>. <source>Front. Neuroinform.</source><volume>7</volume>, <fpage>10</fpage>. <pub-id pub-id-type="doi">10.3389/fninf.2013.00010</pub-id><?supplied-pmid 23781198?><pub-id pub-id-type="pmid">23781198</pub-id></mixed-citation>
    </ref>
    <ref id="B74">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanzeni</surname><given-names>A.</given-names></name><name><surname>Histed</surname><given-names>M. H.</given-names></name><name><surname>Brunel</surname><given-names>N.</given-names></name></person-group> (<year>2020</year>). <article-title>Response nonlinearities in networks of spiking neurons</article-title>. <source>PLOS Comput. Biol.</source>
<volume>16</volume>, <fpage>e1008165</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008165</pub-id><?supplied-pmid 32941457?><pub-id pub-id-type="pmid">32941457</pub-id></mixed-citation>
    </ref>
    <ref id="B75">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>M.</given-names></name><name><surname>Bakker</surname><given-names>R.</given-names></name><name><surname>Hilgetag</surname><given-names>C. C.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><name><surname>van Albada</surname><given-names>S. J.</given-names></name></person-group> (<year>2018</year>). <article-title>Multi-scale account of the network structure of macaque visual cortex</article-title>. <source>Brain Struct. Func.</source>
<volume>223</volume>, <fpage>1409</fpage>–<lpage>1435</lpage>. <pub-id pub-id-type="doi">10.1007/s00429-017-1554-4</pub-id><?supplied-pmid 32052112?><pub-id pub-id-type="pmid">32052112</pub-id></mixed-citation>
    </ref>
    <ref id="B76">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schöner</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>). <article-title>Dynamical systems approaches to cognition</article-title>, in <source>Cambridge Handbook of Computational Cognitive Modeling</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>, <fpage>101</fpage>–<lpage>126</lpage>.<?supplied-pmid 20598626?></mixed-citation>
    </ref>
    <ref id="B77">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuecker</surname><given-names>J.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><name><surname>Helias</surname><given-names>M.</given-names></name></person-group> (<year>2014</year>). <article-title>Reduction of colored noise in excitable systems to white noise and dynamic boundary conditions</article-title>. <source>arXiv[Preprint].arXiv:1410.8799.</source>
<pub-id pub-id-type="doi">10.48550/arXiv.1410.8799</pub-id></mixed-citation>
    </ref>
    <ref id="B78">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuecker</surname><given-names>J.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><name><surname>Helias</surname><given-names>M.</given-names></name></person-group> (<year>2015</year>). <article-title>Modulated escape from a metastable state driven by colored noise</article-title>. <source>Phys. Rev. E</source>
<volume>92</volume>, <fpage>052119</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.92.052119</pub-id><?supplied-pmid 26651659?><pub-id pub-id-type="pmid">26651659</pub-id></mixed-citation>
    </ref>
    <ref id="B79">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuecker</surname><given-names>J.</given-names></name><name><surname>Goedeke</surname><given-names>S.</given-names></name><name><surname>Helias</surname><given-names>M.</given-names></name></person-group> (<year>2018</year>). <article-title>Optimal sequence memory in driven random networks</article-title>. <source>Phys. Rev. X</source>
<volume>8</volume>, <fpage>041029</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevX.8.041029</pub-id></mixed-citation>
    </ref>
    <ref id="B80">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwalger</surname><given-names>T.</given-names></name><name><surname>Deger</surname><given-names>M.</given-names></name><name><surname>Gerstner</surname><given-names>W.</given-names></name></person-group> (<year>2017</year>). <article-title>Towards a theory of cortical columns: From spiking neurons to interacting neural populations of finite size</article-title>. <source>PLoS Comput. Biol.</source>
<volume>13</volume>, <fpage>e1005507</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005507</pub-id><?supplied-pmid 28422957?><pub-id pub-id-type="pmid">28422957</pub-id></mixed-citation>
    </ref>
    <ref id="B81">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwalger</surname><given-names>T.</given-names></name><name><surname>Droste</surname><given-names>F.</given-names></name><name><surname>Lindner</surname><given-names>B.</given-names></name></person-group> (<year>2015</year>). <article-title>Statistical structure of neural spiking under non-poissonian or other non-white stimulation</article-title>. <source>J. Comput. Neurosci.</source>
<volume>39</volume>, <fpage>29</fpage>. <pub-id pub-id-type="doi">10.1007/s10827-015-0560-x</pub-id><?supplied-pmid 25936628?><pub-id pub-id-type="pmid">25936628</pub-id></mixed-citation>
    </ref>
    <ref id="B82">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sejnowski</surname><given-names>T.</given-names></name></person-group> (<year>1976</year>). <article-title>On the stochastic dynamics of neuronal interaction</article-title>. <source>Biol. Cybern.</source>
<volume>22</volume>, <fpage>203</fpage>–<lpage>211</lpage>. <pub-id pub-id-type="doi">10.1007/BF00365086</pub-id><?supplied-pmid 953078?><pub-id pub-id-type="pmid">953078</pub-id></mixed-citation>
    </ref>
    <ref id="B83">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Senk</surname><given-names>J.</given-names></name><name><surname>Korvasová</surname><given-names>K.</given-names></name><name><surname>Schuecker</surname><given-names>J.</given-names></name><name><surname>Hagen</surname><given-names>E.</given-names></name><name><surname>Tetzlaff</surname><given-names>T.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><etal/></person-group>. (<year>2020</year>). <article-title>Conditions for wave trains in spiking neural networks</article-title>. <source>Phys. Rev. Res.</source><volume>2</volume>, <fpage>023174</fpage>. <pub-id pub-id-type="doi">10.1103/physrevresearch.2.023174</pub-id></mixed-citation>
    </ref>
    <ref id="B84">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Senk</surname><given-names>J.</given-names></name><name><surname>Kriener</surname><given-names>B.</given-names></name><name><surname>Djurfeldt</surname><given-names>M.</given-names></name><name><surname>Voges</surname><given-names>N.</given-names></name><name><surname>Jiang</surname><given-names>H.-J.</given-names></name><name><surname>Schüttler</surname><given-names>L.</given-names></name></person-group> (in press). <article-title>Connectivity concepts in neuronal network modeling</article-title>. <source>PLOS Comput. Biol.</source></mixed-citation>
    </ref>
    <ref id="B85">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherfey</surname><given-names>J. S.</given-names></name><name><surname>Soplata</surname><given-names>A. E.</given-names></name><name><surname>Ardid</surname><given-names>S.</given-names></name><name><surname>Roberts</surname><given-names>E. A.</given-names></name><name><surname>Stanley</surname><given-names>D. A.</given-names></name><name><surname>Pittman-Polletta</surname><given-names>B. R.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>Dynasim: a matlab toolbox for neural modeling and simulation</article-title>. <source>Front. Neuroinform.</source><volume>12</volume>, <fpage>10</fpage>. <pub-id pub-id-type="doi">10.3389/fninf.2018.00010</pub-id><?supplied-pmid 29599715?><pub-id pub-id-type="pmid">29599715</pub-id></mixed-citation>
    </ref>
    <ref id="B86">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siegert</surname><given-names>A. J.</given-names></name></person-group> (<year>1951</year>). <article-title>On the first passage time probability problem</article-title>. <source>Phys. Rev.</source>
<volume>81</volume>, <fpage>617</fpage>–<lpage>623</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRev.81.617</pub-id></mixed-citation>
    </ref>
    <ref id="B87">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sompolinsky</surname><given-names>H.</given-names></name><name><surname>Crisanti</surname><given-names>A.</given-names></name><name><surname>Sommers</surname><given-names>H. J.</given-names></name></person-group> (<year>1988</year>). <article-title>Chaos in random neural networks</article-title>. <source>Phys. Rev. Lett.</source>
<volume>61</volume>, <fpage>259</fpage>–<lpage>262</lpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.61.259</pub-id><?supplied-pmid 10039285?><pub-id pub-id-type="pmid">10039285</pub-id></mixed-citation>
    </ref>
    <ref id="B88">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stiller</surname><given-names>J.</given-names></name><name><surname>Radons</surname><given-names>G.</given-names></name></person-group> (<year>1998</year>). <article-title>Dynamics of nonlinear oscillators with random interactions</article-title>. <source>Phys. Rev. E</source>
<volume>58</volume>, <fpage>1789</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.58.1789</pub-id></mixed-citation>
    </ref>
    <ref id="B89">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stimberg</surname><given-names>M.</given-names></name><name><surname>Brette</surname><given-names>R.</given-names></name><name><surname>Goodman</surname><given-names>D. F.</given-names></name></person-group> (<year>2019</year>). <article-title>Brian 2, an intuitive and efficient neural simulator</article-title>. <source>eLife</source>
<volume>8</volume>, <fpage>e47314</fpage>. <pub-id pub-id-type="doi">10.7554/elife.47314</pub-id><?supplied-pmid 31429824?><pub-id pub-id-type="pmid">31429824</pub-id></mixed-citation>
    </ref>
    <ref id="B90">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tetzlaff</surname><given-names>T.</given-names></name><name><surname>Helias</surname><given-names>M.</given-names></name><name><surname>Einevoll</surname><given-names>G. T.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name></person-group> (<year>2012</year>). <article-title>Decorrelation of neural-network activity by inhibitory feedback</article-title>. <source>PLOS Comput. Biol.</source>
<volume>8</volume>, <fpage>e1002596</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002596</pub-id><?supplied-pmid 23133368?><pub-id pub-id-type="pmid">23133368</pub-id></mixed-citation>
    </ref>
    <ref id="B91">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toyoizumi</surname><given-names>T.</given-names></name><name><surname>Abbott</surname><given-names>L. F.</given-names></name></person-group> (<year>2011</year>). <article-title>Beyond the edge of chaos: Amplification and temporal integration by recurrent networks in the chaotic regime</article-title>. <source>Phys. Rev. E</source>
<volume>84</volume>, <fpage>051908</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.84.051908</pub-id><?supplied-pmid 22181445?><pub-id pub-id-type="pmid">22181445</pub-id></mixed-citation>
    </ref>
    <ref id="B92">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trousdale</surname><given-names>J.</given-names></name><name><surname>Hu</surname><given-names>Y.</given-names></name><name><surname>Shea-Brown</surname><given-names>E.</given-names></name><name><surname>Josic</surname><given-names>K.</given-names></name></person-group> (<year>2012</year>). <article-title>Impact of network structure and cellular response on spike time correlations</article-title>. <source>PLoS Comput. Biol.</source>
<volume>8</volume>, <fpage>e1002408</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002408</pub-id><?supplied-pmid 22457608?><pub-id pub-id-type="pmid">22457608</pub-id></mixed-citation>
    </ref>
    <ref id="B93">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tuckwell</surname><given-names>H. C.</given-names></name></person-group> (<year>1988</year>). <source>Introduction to Theoretical Neurobiology, Vol. 2</source>
<publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B94">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Albada</surname><given-names>S. J.</given-names></name><name><surname>Rowley</surname><given-names>A. G.</given-names></name><name><surname>Senk</surname><given-names>J.</given-names></name><name><surname>Hopkins</surname><given-names>M.</given-names></name><name><surname>Schmidt</surname><given-names>M.</given-names></name><name><surname>Stokes</surname><given-names>A. B.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>Performance comparison of the digital neuromorphic hardware SpiNNaker and the neural network simulation software NEST for a full-scale cortical microcircuit model</article-title>. <source>Front. Neurosci.</source><volume>12</volume>, <fpage>291</fpage>. <pub-id pub-id-type="doi">10.3389/fnins.2018.00291</pub-id><?supplied-pmid 29875620?><pub-id pub-id-type="pmid">29875620</pub-id></mixed-citation>
    </ref>
    <ref id="B95">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Meegen</surname><given-names>A.</given-names></name><name><surname>Lindner</surname><given-names>B.</given-names></name></person-group> (<year>2018</year>). <article-title>Self-consistent correlations of randomly coupled rotators in the asynchronous state</article-title>. <source>Phys. Rev. Lett.</source>
<volume>121</volume>, <fpage>258302</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.121.258302</pub-id><?supplied-pmid 30608814?><pub-id pub-id-type="pmid">30608814</pub-id></mixed-citation>
    </ref>
    <ref id="B96">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vreeswijk</surname><given-names>C.</given-names></name><name><surname>Farkhooi</surname><given-names>F.</given-names></name></person-group> (<year>2019</year>). <article-title>Fredholm theory for the mean first-passage time of integrate-and-fire oscillators with colored noise input</article-title>. <source>Phys. Rev. E</source>
<volume>100</volume>, <fpage>060402</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.100.060402</pub-id><?supplied-pmid 31962454?><pub-id pub-id-type="pmid">31962454</pub-id></mixed-citation>
    </ref>
    <ref id="B97">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vreeswijk</surname><given-names>C.</given-names></name><name><surname>Sompolinsky</surname><given-names>H.</given-names></name></person-group> (<year>1996</year>). <article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title>. <source>Science</source>
<volume>274</volume>, <fpage>1724</fpage>–<lpage>1726</lpage>. <pub-id pub-id-type="doi">10.1126/science.274.5293.1724</pub-id><?supplied-pmid 8939866?><pub-id pub-id-type="pmid">8939866</pub-id></mixed-citation>
    </ref>
    <ref id="B98">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vreeswijk</surname><given-names>C.</given-names></name><name><surname>Sompolinsky</surname><given-names>H.</given-names></name></person-group> (<year>1998</year>). <article-title>Chaotic balanced state in a model of cortical circuits</article-title>. <source>Neural Comput.</source>
<volume>10</volume>, <fpage>1321</fpage>–<lpage>1371</lpage>. <pub-id pub-id-type="doi">10.1162/089976698300017214</pub-id><?supplied-pmid 9698348?><pub-id pub-id-type="pmid">9698348</pub-id></mixed-citation>
    </ref>
    <ref id="B99">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P.</given-names></name><name><surname>Gommers</surname><given-names>R.</given-names></name><name><surname>Oliphant</surname><given-names>T. E.</given-names></name><name><surname>Haberland</surname><given-names>M.</given-names></name><name><surname>Reddy</surname><given-names>T.</given-names></name><name><surname>Cournapeau</surname><given-names>D.</given-names></name><etal/></person-group>. (<year>2020</year>). <article-title>SciPy 1.0: fundamental algorithms for scientific computing in python</article-title>. <source>Nat. Methods</source><volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><?supplied-pmid 32094914?><pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="B100">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagatsuma</surname><given-names>N.</given-names></name><name><surname>Potjans</surname><given-names>T. C.</given-names></name><name><surname>Diesmann</surname><given-names>M.</given-names></name><name><surname>Fukai</surname><given-names>T.</given-names></name></person-group> (<year>2011</year>). <article-title>Layer-dependent attentional processing by top-down signals in a visual cortical microcircuit model</article-title>. <source>Front. Comput. Neurosci.</source>
<volume>5</volume>, <fpage>31</fpage>. <pub-id pub-id-type="doi">10.3389/fncom.2011.00031</pub-id><?supplied-pmid 21779240?><pub-id pub-id-type="pmid">21779240</pub-id></mixed-citation>
    </ref>
    <ref id="B101">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>H. R.</given-names></name><name><surname>Cowan</surname><given-names>J. D.</given-names></name></person-group> (<year>1972</year>). <article-title>Excitatory and inhibitory interactions in localized populations of model neurons</article-title>. <source>Biophys. J.</source>
<volume>12</volume>, <fpage>1</fpage> – <lpage>24</lpage>. <pub-id pub-id-type="doi">10.1016/S0006-3495(72)86068-5</pub-id><?supplied-pmid 4332108?><pub-id pub-id-type="pmid">4332108</pub-id></mixed-citation>
    </ref>
    <ref id="B102">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>H. R.</given-names></name><name><surname>Cowan</surname><given-names>J. D.</given-names></name></person-group> (<year>1973</year>). <article-title>A mathematical theory of the functional dynamics of cortical and thalamic nervous tissue</article-title>. <source>Kybernetik</source>
<volume>13</volume>, <fpage>55</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1007/BF00288786</pub-id><?supplied-pmid 4767470?><pub-id pub-id-type="pmid">4767470</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="A1">
      <title>Appendix</title>
      <sec id="app1">
        <title>A.1. Siegert Implementation</title>
        <p>Here, we describe how we solve the integral in Equation (4) numerically in a fully vectorized manner. The difficulty in Equation (4), <inline-formula><mml:math id="M55" overflow="scroll"><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mtext>r</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mtext>m</mml:mtext></mml:mrow></mml:msub><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="M56" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M57" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are determined by either Equation (5) or Equation (10), is posed by the integral</p>
        <disp-formula id="E26">
          <label>(A1)</label>
          <mml:math id="M58" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>I</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mover accent="false">
                            <mml:mrow>
                              <mml:mi>V</mml:mi>
                            </mml:mrow>
                            <mml:mo>~</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mover accent="false">
                            <mml:mrow>
                              <mml:mi>V</mml:mi>
                            </mml:mrow>
                            <mml:mo>~</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext>th</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>∫</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mstyle>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:mtext class="textrm" mathvariant="normal">erf</mml:mtext>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mtext>d</mml:mtext>
                  <mml:mi>s</mml:mi>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>This integral is problematic due to the multiplication of <italic>e</italic><sup><italic>s</italic><sup>2</sup></sup> and 1 + erf(<italic>s</italic>) in the integrand which leads to overflow and loss of significance.</p>
        <p>To address this, we split the integral into different domains depending on the sign of the integration variable. Furthermore, we use the scaled complementary error function</p>
        <disp-formula id="E27">
          <label>(A2)</label>
          <mml:math id="M59" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>erf</mml:mtext>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>-</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>-</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mtext>erfcx</mml:mtext>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>to extract the leading exponential contribution. Importantly, erfcx(<italic>s</italic>) decreases monotonically from erfcx(0) = 1 with power law asymptotics <inline-formula><mml:math id="M60" overflow="scroll"><mml:mtext>erfcx</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, hence it does not contain any exponential contribution. For positive <italic>s</italic>, the exponential contribution in the prefactor of erfcx(<italic>s</italic>) cancels the <italic>e</italic><sup><italic>s</italic><sup>2</sup></sup> factor in the integrand. For negative <italic>s</italic>, the integrand simplifies even further to <italic>e</italic><sup><italic>s</italic><sup>2</sup></sup>(1 + erf(−<italic>s</italic>)) = erfcx(<italic>s</italic>) using erf(−<italic>s</italic>) = −erf(<italic>s</italic>). In addition to erfcx(<italic>s</italic>), we employ the Dawson function</p>
        <disp-formula id="E28">
          <label>(A3)</label>
          <mml:math id="M61" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>D</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>-</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mstyle displaystyle="true">
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>∫</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mstyle>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mtext>d</mml:mtext>
                  <mml:mi>r</mml:mi>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>to solve some of the integrals analytically. The Dawson function has a power law tail, <italic>D</italic>(<italic>s</italic>) ~ 1/(2<italic>s</italic>); hence, it also does not carry an exponential contribution. Both erfcx(<italic>s</italic>) and the Dawson function are fully vectorized in <monospace>SciPy</monospace> (Virtanen et al., <xref rid="B99" ref-type="bibr">2020</xref>).</p>
        <p>Any remaining integrals are solved using Gauss–Legendre quadrature (Press et al., <xref rid="B65" ref-type="bibr">2007</xref>). By construction, Gauss–Legendre quadrature of order <italic>k</italic> solves integrals of polynomials up to degree <italic>k</italic> on the interval [−1, 1] exactly. Thus, it gives very good results if the integrand is well approximated by a polynomial of degree <italic>k</italic>. The quadrature rule itself is</p>
        <disp-formula id="E29">
          <label>(A4)</label>
          <mml:math id="M62" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mstyle displaystyle="true">
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>∫</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mstyle>
                  <mml:mi>f</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mtext>d</mml:mtext>
                  <mml:mi>s</mml:mi>
                </mml:mtd>
                <mml:mtd>
                  <mml:mo>≈</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>f</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true">(</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>-</mml:mo>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>u</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo stretchy="true">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where the <italic>u</italic><sub><italic>i</italic></sub> are the roots of the Legendre polynomial of order <italic>k</italic> and the <italic>w</italic><sub><italic>i</italic></sub> are appropriate weights such that a polynomial of degree <italic>k</italic> is integrated exactly. We use a fixed order quadrature for which Equation (4) is straightforward to vectorize to multiple <italic>a</italic> and <italic>b</italic>. We determine the order of the quadrature iteratively by comparison with an adaptive quadrature rule; usually, a small order <italic>k</italic> = <italic>O</italic>(10) already yields very good results for an erfcx(<italic>s</italic>) integrand.</p>
        <sec>
          <title>Inhibitory Regime</title>
          <p>First, we consider the case where lower and upper bound of the integral are positive, <inline-formula><mml:math id="M63" overflow="scroll"><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. This corresponds to strongly inhibitory mean input. Expressing the integrand in terms of erfcx(<italic>s</italic>) and using the Dawson function, we get</p>
          <disp-formula id="E30">
            <mml:math id="M64" overflow="scroll">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>I</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>inh</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>D</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>D</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>∫</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mstyle>
                    <mml:mtext>erfcx</mml:mtext>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mtext>d</mml:mtext>
                    <mml:mi>s</mml:mi>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>The remaining integral is evaluated using Gauss–Legendre quadrature, Equation (4). We extract the leading contribution <inline-formula><mml:math id="M65" overflow="scroll"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup></mml:math></inline-formula> from the denominator in Equation (4) and arrive at</p>
          <disp-formula id="E31">
            <label>(A5)</label>
            <mml:math id="M66" overflow="scroll">
              <mml:mtable class="eqnarray" columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>ϕ</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mi>V</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>~</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>th</mml:mtext>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtable style="text-align:axis;" equalrows="false" equalcolumns="false" class="array">
                          <mml:mtr>
                            <mml:mtd>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>τ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext>r</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>-</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mover accent="false">
                                        <mml:mrow>
                                          <mml:mi>V</mml:mi>
                                        </mml:mrow>
                                        <mml:mo>~</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext>th</mml:mtext>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>τ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext>m</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msqrt>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                              </mml:msqrt>
                              <mml:mrow>
                                <mml:mo stretchy="true">(</mml:mo>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mi>e</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>-</mml:mo>
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mover accent="false">
                                            <mml:mrow>
                                              <mml:mi>V</mml:mi>
                                            </mml:mrow>
                                            <mml:mo>~</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mtext>th</mml:mtext>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:mrow>
                                      </mml:msubsup>
                                    </mml:mrow>
                                  </mml:msup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>I</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext>inh</mml:mtext>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mover accent="false">
                                            <mml:mrow>
                                              <mml:mi>V</mml:mi>
                                            </mml:mrow>
                                            <mml:mo>~</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mn>0</mml:mn>
                                        </mml:mrow>
                                      </mml:msub>
                                      <mml:mo>,</mml:mo>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mover accent="false">
                                            <mml:mrow>
                                              <mml:mi>V</mml:mi>
                                            </mml:mrow>
                                            <mml:mo>~</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mtext>th</mml:mtext>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mo stretchy="true">)</mml:mo>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>Extracting <inline-formula><mml:math id="M67" overflow="scroll"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup></mml:math></inline-formula> from the denominator reduces the latter to <inline-formula><mml:math id="M68" overflow="scroll"><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mtext>m</mml:mtext></mml:mrow></mml:msub><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and exponentially small correction terms (remember <inline-formula><mml:math id="M69" overflow="scroll"><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> because <italic>V</italic><sub>0</sub> &lt; <italic>V</italic><sub>th</sub>), thereby preventing overflow.</p>
        </sec>
        <sec>
          <title>Excitatory Regime</title>
          <p>Second, we consider the case where lower and upper bound of the integral are negative, <inline-formula><mml:math id="M70" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>. This corresponds to strongly excitatory mean input. In this regime, we change variables <italic>s</italic> → −<italic>s</italic> to make the domain of integration positive. Using erf(−<italic>s</italic>) = −erf(<italic>s</italic>) as well as erfcx(<italic>s</italic>), we get</p>
          <disp-formula id="E32">
            <mml:math id="M71" overflow="scroll">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>I</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>exc</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>∫</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mstyle>
                    <mml:mtext>erfcx</mml:mtext>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mtext>d</mml:mtext>
                    <mml:mi>s</mml:mi>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>Thus, we evaluate Equation (4) as</p>
          <disp-formula id="E33">
            <label>(A6)</label>
            <mml:math id="M72" overflow="scroll">
              <mml:mtable class="eqnarray" columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>ϕ</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>r</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>m</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mi>π</mml:mi>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∫</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>|</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mi>V</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>~</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>th</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>|</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>|</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mi>V</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>~</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>0</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>|</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mtext>erfcx</mml:mtext>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mtext>d</mml:mtext>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>In particular, there is no exponential contribution involved in this regime.</p>
        </sec>
        <sec>
          <title>Intermediate Regime</title>
          <p>Last, we consider the remaining case <inline-formula><mml:math id="M73" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>. We split the integral at zero and use the previous steps for the respective parts to get</p>
          <disp-formula id="E34">
            <mml:math id="M74" overflow="scroll">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>I</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>interm</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>D</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>∫</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mstyle>
                    <mml:mtext>erfcx</mml:mtext>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mtext>d</mml:mtext>
                    <mml:mi>s</mml:mi>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>Note that the sign of the second integral depends on whether <inline-formula><mml:math id="M75" overflow="scroll"><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> (+) or not (−). Again, we extract the leading contribution <inline-formula><mml:math id="M76" overflow="scroll"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup></mml:math></inline-formula> from the denominator in Equation (4) and arrive at</p>
          <disp-formula id="E35">
            <label>(A7)</label>
            <mml:math id="M77" overflow="scroll">
              <mml:mtable class="eqnarray" columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>ϕ</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mi>V</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>~</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>th</mml:mtext>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>r</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mi>V</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>~</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>th</mml:mtext>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>m</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mi>π</mml:mi>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mrow>
                          <mml:mo stretchy="true">(</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>e</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>-</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mi>V</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>~</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext>th</mml:mtext>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:msup>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>I</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>interm</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mi>V</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>~</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>0</mml:mn>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mi>V</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>~</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext>th</mml:mtext>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo stretchy="true">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>As before, extracting <inline-formula><mml:math id="M78" overflow="scroll"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup></mml:math></inline-formula> from the denominator prevents overflow.</p>
        </sec>
        <sec>
          <title>Deterministic Limit</title>
          <p>The deterministic limit σ → 0 corresponds to <inline-formula><mml:math id="M79" overflow="scroll"><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:math></inline-formula> for both Equation (5) and Equation (10). In the inhibitory and the intermediate regime, we see immediately that ϕ(μ, σ → 0) → 0 due to the dominant contribution <inline-formula><mml:math id="M80" overflow="scroll"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup></mml:math></inline-formula>. In the excitatory regime, we use the asymptotics <inline-formula><mml:math id="M81" overflow="scroll"><mml:mtext>erfcx</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to get</p>
          <disp-formula id="E36">
            <mml:math id="M82" overflow="scroll">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>I</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo>~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>→</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>∫</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>th</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mstyle>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mi>π</mml:mi>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mtext>d</mml:mtext>
                    <mml:mi>s</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mi>π</mml:mi>
                          </mml:mrow>
                        </mml:msqrt>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo class="qopname">ln</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mo>|</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo class="qopname">~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>|</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>|</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                              </mml:mrow>
                              <mml:mo class="qopname">~</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>th</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>|</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>Inserting this into Equation (4) yields</p>
          <disp-formula id="E37">
            <label>(A8)</label>
            <mml:math id="M83" overflow="scroll">
              <mml:mtable class="eqnarray" columnalign="left">
                <mml:mtr columnalign="left">
                  <mml:mtd>
                    <mml:mi>ϕ</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>→</mml:mo>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:mrow>
                        <mml:mtable style="text-align:axis;" equalrows="false" columnlines="none" equalcolumns="false" class="array">
                          <mml:mtr columnalign="left">
                            <mml:mtd>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>τ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext>r</mml:mtext>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>+</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>τ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext>m</mml:mtext>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="qopname">ln</mml:mo>
                                  <mml:mfrac>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                      <mml:mo>-</mml:mo>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>V</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mn>0</mml:mn>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                      <mml:mo>-</mml:mo>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>V</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mtext>th</mml:mtext>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:mfrac>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd>
                              <mml:mtext class="textrm" mathvariant="normal">if </mml:mtext>
                              <mml:mi>μ</mml:mi>
                              <mml:mo>&gt;</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext>th</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr columnalign="left">
                            <mml:mtd>
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd>
                              <mml:mtext class="textrm" mathvariant="normal">otherwise</mml:mtext>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
          <p>which is the firing rate of a leaky integrate-and-fire neuron driven by a constant input (Gerstner et al., <xref rid="B30" ref-type="bibr">2014</xref>). Thus, this implementation also tolerates the deterministic limit of a very small noise intensity σ.</p>
          <table-wrap position="anchor" id="T1">
            <label>Table A1</label>
            <caption>
              <p>Microcircuit Parameters.</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <th valign="top" align="left" rowspan="1" colspan="1">
                    <bold>Symbol</bold>
                  </th>
                  <th valign="top" align="left" rowspan="1" colspan="1">
                    <bold>Value (Potjans and Diesmann, <xref rid="B64" ref-type="bibr">2014</xref>)</bold>
                  </th>
                  <th valign="top" align="left" rowspan="1" colspan="1">
                    <bold>Value (Bos et al., <xref rid="B8" ref-type="bibr">2016</xref>)</bold>
                  </th>
                  <th valign="top" align="left" rowspan="1" colspan="1">
                    <bold>Description</bold>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td valign="top" align="left" rowspan="1" colspan="1">
                    <italic>K</italic>
                    <sub>4E, 4I</sub>
                  </td>
                  <td valign="top" align="left" rowspan="1" colspan="1">795</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">675</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">In-degree from 4I to 4E</td>
                </tr>
                <tr>
                  <td valign="top" align="left" rowspan="1" colspan="1">
                    <italic>K</italic>
                    <sub>4E, ext</sub>
                  </td>
                  <td valign="top" align="left" rowspan="1" colspan="1">2100</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">1780</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">External in-degree to 4E</td>
                </tr>
                <tr>
                  <td valign="top" align="left" rowspan="1" colspan="1"><italic>D</italic>(ω)</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">none</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">truncated Gaussian</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">Delay distribution</td>
                </tr>
                <tr>
                  <td valign="top" align="left" rowspan="1" colspan="1"><italic>d</italic><sub><italic>e</italic></sub> ± δ<italic>d</italic><sub><italic>e</italic></sub></td>
                  <td valign="top" align="left" rowspan="1" colspan="1">1.5 ± 0.75 ms</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">1.5 ± 1.5 ms</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">Mean and standard deviation of excitatory delay</td>
                </tr>
                <tr>
                  <td valign="top" align="left" rowspan="1" colspan="1"><italic>d</italic><sub><italic>i</italic></sub> ± δ<italic>d</italic><sub><italic>i</italic></sub></td>
                  <td valign="top" align="left" rowspan="1" colspan="1">0.75 ± 0.375 ms</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">0.75 ± 0.75 ms</td>
                  <td valign="top" align="left" rowspan="1" colspan="1">Mean and standard deviation of inhibitory delay</td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <p><italic>Parameter adaptions used here are introduced by Bos et al. (<xref rid="B8" ref-type="bibr">2016</xref>) compared to original microcircuit model. K<sub>ij</sub> denotes the in-degrees from population j to population i. The delays in the simulated networks were drawn from a truncated Gaussian distribution with the given mean and standard deviation. The mean-field approximation of the microcircuit by Potjans and Diesmann (<xref rid="B64" ref-type="bibr">2014</xref>) assumes the delay to be fixed at the mean value, which is specified in the toolbox by setting the parameter <monospace>delay_dist</monospace> to <monospace>none</monospace></italic>.</p>
            </table-wrap-foot>
          </table-wrap>
        </sec>
      </sec>
      <sec id="app2">
        <title>A.2. Transfer Function Notations</title>
        <p>In Section 3.3.1 we introduce the analytical form of the transfer function implemented in the toolbox. Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>), derive a more general form of the transfer function, which includes a modulation of the variance of the input. Here we compare the notation used in Equation (11) to the notation used in Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>, Eq. 29).</p>
        <p>Schuecker et al. (<xref rid="B78" ref-type="bibr">2015</xref>) define the modulations of input mean and variance as</p>
        <disp-formula id="E38">
          <label>(A9)</label>
          <mml:math id="M84" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>μ</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mi>μ</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi>ϵ</mml:mi>
                  <mml:mi>μ</mml:mi>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mtext>e</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>i</mml:mtext>
                      <mml:mi>ω</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:mi>H</mml:mi>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mtext>e</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>i</mml:mtext>
                      <mml:mi>ω</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>and introduce the transfer function in terms of its influence on the firing rate</p>
        <disp-formula id="E40">
          <mml:math id="M86" overflow="scroll">
            <mml:mrow>
              <mml:mi>ν</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:mo>/</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ν</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>0</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>+</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:mi>ω</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mtext>e</mml:mtext>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>i</mml:mtext>
                  <mml:mi>ω</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where ν<sub>0</sub> is the stationary firing rate. Here the transfer function <italic>n</italic>(ω) includes contributions of both the modulation of the mean <italic>n</italic><sub><italic>G</italic></sub>(ω) ∝ ϵ and the modulation of the variance <italic>n</italic><sub><italic>H</italic></sub>(ω) ∝ <italic>H</italic>. We write the modulation of the mean as</p>
        <disp-formula id="E41">
          <mml:math id="M87" overflow="scroll">
            <mml:mrow>
              <mml:mi>μ</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>μ</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>δ</mml:mi>
              <mml:mi>μ</mml:mi>
              <mml:msup>
                <mml:mrow>
                  <mml:mtext>e</mml:mtext>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>i</mml:mtext>
                  <mml:mi>ω</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>implying that δμ corresponds to ϵμ in Equation (9). As we only consider the modulation of the mean, the firing rate can be rewritten as</p>
        <disp-formula id="E42">
          <mml:math id="M88" overflow="scroll">
            <mml:mrow>
              <mml:mi>ν</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>ν</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>N</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:mi>ω</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:mi>δ</mml:mi>
              <mml:mi>μ</mml:mi>
              <mml:msup>
                <mml:mrow>
                  <mml:mtext>e</mml:mtext>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>i</mml:mtext>
                  <mml:mi>ω</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where we moved the stationary firing rate ν to the right hand side and included it in the definition of the transfer function <italic>N</italic>(ω). In the main text we emphasize that μ(<italic>t</italic>) and ν(<italic>t</italic>) are physical quantities by only considering the real part of complex contributions. Additionally, we swap the voltage boundaries in Equation (11), introducing a canceling sign change in both the numerator and the denominator. This reformulation was chosen to align the presented formula with the implementation in the toolbox.</p>
      </sec>
    </app>
  </app-group>
</back>
