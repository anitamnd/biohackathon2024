<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6267036</article-id>
    <article-id pub-id-type="publisher-id">2485</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2485-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Purge Haplotigs: allelic contig reassignment for third-gen diploid genome assemblies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1488-5148</contrib-id>
        <name>
          <surname>Roach</surname>
          <given-names>Michael J.</given-names>
        </name>
        <address>
          <phone>+61 8313 6600</phone>
          <email>michael.roach@awri.com.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmidt</surname>
          <given-names>Simon A.</given-names>
        </name>
        <address>
          <email>simon.schmidt@awri.com.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Borneman</surname>
          <given-names>Anthony R.</given-names>
        </name>
        <address>
          <email>Anthony.borneman@awri.com.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0405 222X</institution-id><institution-id institution-id-type="GRID">grid.452839.1</institution-id><institution>The Australian Wine Research Institute, </institution></institution-wrap>PO Box 197, Glen Osmond, SA 5064 Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>460</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>4</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>11</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Recent developments in third-gen long read sequencing and diploid-aware assemblers have resulted in the rapid release of numerous reference-quality assemblies for diploid genomes. However, assembly of highly heterozygous genomes is still problematic when regional heterogeneity is so high that haplotype homology is not recognised during assembly. This results in regional duplication rather than consolidation into allelic variants and can cause issues with downstream analysis, for example variant discovery, or haplotype reconstruction using the diploid assembly with unpaired allelic contigs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">A new pipeline—Purge Haplotigs—was developed specifically for third-gen sequencing-based assemblies to automate the reassignment of allelic contigs, and to assist in the manual curation of genome assemblies. The pipeline uses a draft haplotype-fused assembly or a diploid assembly, read alignments, and repeat annotations to identify allelic variants in the primary assembly. The pipeline was tested on a simulated dataset and on four recent diploid (phased) de novo assemblies from third-generation long-read sequencing, and compared with a similar tool. After processing with Purge Haplotigs, haploid assemblies were less duplicated with minimal impact on genome completeness, and diploid assemblies had more pairings of allelic contigs.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Purge Haplotigs improves the haploid and diploid representations of third-gen sequencing based genome assemblies by identifying and reassigning allelic contigs. The implementation is fast and scales well with large genomes, and it is less likely to over-purge repetitive or paralogous elements compared to alignment-only based methods. The software is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/mroachawri/purge_haplotigs">https://bitbucket.org/mroachawri/purge_haplotigs</ext-link> under a permissive MIT licence.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-018-2485-7) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Synteny reduction</kwd>
      <kwd>Redundant contigs</kwd>
      <kwd>Polymorphic genome</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007915</institution-id>
            <institution>Wine Australia</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Bioplatforms Australia</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">Recent advances in third-generation single-molecule sequencing have enabled de novo genome assemblies that have extremely high levels of contiguity and completeness [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Furthermore, recent advances in ‘diploid aware’ genome assemblers have considerably improved the quality of highly heterozygous diploid genome assemblies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Diploid-aware assemblers such as FALCON and Canu are available that will produce a haplotype-fused representation of a diploid genome [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], and some assemblers such as FALCON Unzip and Supernova will go further to produce large phase blocks where both parent alleles are represented separately [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. For FALCON Unzip assemblies, which are the focus of this study, phasing occurs on the assembly graph to produce ‘primary contigs’ (the haploid assembly) and associated ‘haplotigs’, with the diploid assembly consisting of the union of these primary contigs and secondary haplotigs.</p>
    <p id="Par9">An ideal haploid representation (primary contigs) would consist of one allelic copy of all heterozygous regions in the two haplomes, as well as all hemizygous regions from both haplomes. This ensures that any region in either haplome aligns in its entirety to a single location in the haploid representation. The secondary haplotigs should contain one of the two allelic copies of the heterozygous regions found in both haplomes; in this regard the haplotigs serve as phasing information for the haploid representation.</p>
    <p id="Par10">Regions of very high heterozygosity still present a problem for de novo genome assembly [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. In this situation, once a pair of allelic sequences exceeds a certain threshold of nucleotide diversity, most algorithms will assemble these regions as separate contigs, rather than the expected single haplotype-fused contig [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. This results in an assembly that is significantly larger than haploid genome size, and the presence of these allelic contigs in a haploid assembly is problematic for downstream analysis [<xref ref-type="bibr" rid="CR13">13</xref>]. In the case of producing a diploid assembly, while both alleles may be present, steps are still required to identify the allelic contig pairings.</p>
    <p id="Par11">Several tools have attempted to deal with this problem. The HaploMerger2 toolkit [<xref ref-type="bibr" rid="CR14">14</xref>] and Redundans assembly pipeline [<xref ref-type="bibr" rid="CR15">15</xref>] were designed to produce haplotype-fused assemblies from short-read sequences. However, the automated removal of contigs based only on alignments of contigs to each other without considering read depth of coverage may lead to repetitive and paralogous contigs being over-purged. Furthermore, resolving the haplotype sequences and producing a phased assembly has proven to be advantageous [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Scripts available for use with long-read assemblies include; get_homologs.py, which uses sequence alignments to identify homologues and assist in manual curation [<xref ref-type="bibr" rid="CR18">18</xref>] and HomolContigsByAnnotation, which uses gene annotations to match syntenic regions [<xref ref-type="bibr" rid="CR19">19</xref>]. Each has its unique strengths and drawbacks, but both suffer from requiring manual reassignment of contigs by the user.</p>
    <p id="Par12">The aim of this study was to develop a new pipeline that could quickly and automatically identify and reassign allelic contigs specifically in assemblies produced with single-molecule long-read sequencing technology. Purge Haplotigs is designed to be easy to install and requires only three commands to complete. It will work on either the haploid assembly to produce a deduplicated haploid assembly, or on the diploid assembly to produce an improved, deduplicated primary haploid assembly and a more complete secondary haplotig assembly. Finally, the pipeline also produces several outputs designed to assist in the manual inspection and curation of an assembly if desired.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par13">The Purge Haplotigs pipeline is outlined in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The pipeline requires two input files: a draft assembly in FASTA format, and an alignment file of reads mapped to the assembly in BAM format. The input draft assembly can be either a haploid assembly (e.g. FALCON or CANU) or a diploid assembly (e.g. FALCON Unzip). Repeat annotations can optionally be supplied (in BED format) for improved handling of repeat-rich contigs. For the aligned reads, the pipeline works best when the long-reads that were used for generating the assembly are mapped, but it will also work using short reads. A ‘random best’ alignment should be used for multi-mapping reads and the library should be one that produces an unbiased flat read-coverage.<fig id="Fig1"><label>Fig. 1</label><caption><p>Flow-chart for the Purge Haplotigs pipeline</p></caption><graphic xlink:href="12859_2018_2485_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Read-depth analysis</title>
      <p id="Par14">The first stage involves a read-depth analysis of the BAM file. A read-depth histogram is initially produced for the assembly. For collapsed haplotype contigs the reads from both alleles will map, whereas if the alleles have assembled as separate contigs the reads will be split over the two contigs, resulting in half the read-depth. This is leveraged to identify contigs that are likely to be haplotigs.</p>
      <p id="Par15">For a haploid assembly, a bimodal distribution should be observed if duplication has occurred (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). The 0.5× read-depth peak results from the duplicated regions and the 1× read-depth peak results from regions that are properly haplotype-fused. For a diploid assembly, as the entire assembly should be duplicated, the 1× peak may only be very small or not visible at all. The user chooses three cut-offs to capture the two peaks and the pipeline then calculates a breakdown of the read-depth proportions for each contig (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Contigs with a low proportion of bases within the 1× read-depth range (by default ≤ 80%) are flagged for further analysis. For a diploid assembly, as both haplotypes should be present, most of the contigs would be expected to be flagged for further analysis. Contigs with a high proportion of bases (by default ≥ 80%) at an abnormally low read-depth are likely to be assembly artefacts, and at an abnormally high read-depth are likely to be collapsed repeats or organelle contigs. These contigs optionally can be separated from the rest of the assembly.<fig id="Fig2"><label>Fig. 2</label><caption><p>Purge Haplotigs Implementation. <bold>a</bold> Genome-wide read-depth histogram. Bimodal distribution results from the presence of allelic contigs (0.5× coverage) and haplotype-fused contigs (1× coverage). This example histogram uses a low cutoff of 15, a midpoint of 65, and a high cutoff of 190—required in the second step for Purge Haplotigs. <bold>b</bold> Read-depth of individual contigs is used to identify contigs that are suspected to be duplicated. Contigs with abnormally low or high coverage are optionally removed from the assembly. <bold>c</bold> Contigs are aligned and haplotigs are removed iteratively</p></caption><graphic xlink:href="12859_2018_2485_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Identification and assignment of homologous sequences</title>
      <p id="Par16">Contigs that were flagged for further analysis according to read-depth are then subject to sequence alignment to attempt to identify synteny with its allelic companion contig. All flagged contigs therefore undergo a Minimap2 search [<xref ref-type="bibr" rid="CR20">20</xref>] against the entire assembly to identify discrete regions of nucleotide similarity. Using these data Purge Haplotigs ranks the hit contigs for each flagged contig by total number of matching bases. It then calculates both the total portion of the flagged contig that aligns at least once (alignment score) and the sum of all alignments (max match score) between the flagged contig and its two best hit contigs. If repeat annotations have been supplied, alignments to repetitive regions will be ignored when calculating the alignment and max match scores. Contigs with an alignment score greater than the cut-off (by default ≥ 70%) are marked for reassignment as haplotigs. Contigs marked for reassignment with a max match score greater than the cut-off (by default ≥ 250%) are further labelled as repetitive to highlight potential problematic contigs such as collapsed repeats or low-complexity regions.</p>
      <p id="Par17">Conflicts may arise where haplotigs are nested, overlap, or are comprised of mostly repetitive sequence. This can cause individual contigs to be both marked for reassignment and used as a reference for marking another contig for reassignment (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). If a contig and its best hit are both marked for reassignment then only the shorter contig will be reassigned and the longer contig will need to be reanalysed. For this reason, the hit contig identification, alignment scoring, conflict resolution and contig reassignment steps occur iteratively until no more conflicts occur and no more contigs meet the conditions for reassignment as a haplotig.</p>
    </sec>
    <sec id="Sec5">
      <title>Outputs</title>
      <p id="Par18">Purge Haplotigs produces three FASTA format files for the curated assembly: the curated contigs, the contigs reassigned as haplotigs, and the abnormal coverage contigs reassigned as artefacts. If the original input were a draft haploid assembly, then the curated contigs would represent the haploid assembly. Alternatively, if the original input were a draft diploid assembly then the curated contigs represent the haploid assembly, while the revised diploid assembly would consist of the combination of both the curated primary contigs and the reassigned haplotigs. The revised diploid assembly is identical to the draft diploid assembly with the exceptions that allelic contigs are paired and abnormal coverage contigs are optionally removed.</p>
      <p id="Par19">In addition to the FASTA output, Purge Haplotigs also produces several metrics to aid in the manual assessment of the automatic contig assignment function, including the optional production of dotplots juxtaposed with read-depth tracks for each reassigned and ambiguous contig. A data table is produced which lists each contig reassignment and includes both the alignment and max match scores. Finally, a text file is produced to show the contig purging order for the situations in which conflicts were detected. This last file is particularly useful for producing dotplots for visualising haplotig nesting and overlaps, as well as assessing any potential over-purging (for instance if the threshold for reassignment were set too low).</p>
    </sec>
    <sec id="Sec6">
      <title>Limitations</title>
      <p id="Par20">Purge Haplotigs has currently only been tested against diploid genomes. It should be noted that haplotype switching often occurs in the FALCON Unzip primary contigs between neighbouring phase blocks. Breaks in phasing may occur due to a large distance between consecutive variants and longer-range connectivity information is generally needed to completely reconstruct the two haplomes. As such Purge Haplotigs cannot resolve haplotype switching. Instead, it will only attempt to identify contigs that are allelic and produce a deduplicated representation of the genome.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results and discussion</title>
    <sec id="Sec8">
      <title>Materials and methods used for pipeline evaluation</title>
      <p id="Par21">The Purge Haplotigs pipeline was first validated using a synthetic dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). However, to fully investigate the practical aspects and impact of synteny reduction, Purge Haplotigs was also tested on four draft assemblies produced by FALCON Unzip. Assemblies for <italic>Arabidopsis thaliana</italic> (Cvi-0 × Col-0), <italic>Clavicorona pyxidata</italic> (a coral fungus), and <italic>Vitis vinifera L. Cv.</italic> Cabernet Sauvignon (grapevine) were sourced from Chin, Peluso [<xref ref-type="bibr" rid="CR4">4</xref>], and a fourth assembly for <italic>Taeniopygia guttata</italic> (Zebra finch) genome was sourced from Korlach, Gedman [<xref ref-type="bibr" rid="CR5">5</xref>]. Inbred Col-0 and Cvi-0 assemblies were also sourced from Chin, Peluso [<xref ref-type="bibr" rid="CR4">4</xref>] for analysis of this <italic>Arabidopsis</italic> trio. For each assembly, alignment files which consisted of PacBio RS II SMRT subreads mapped to each of the draft diploid assemblies, were generously provided by Pacific Biosciences.</p>
      <p id="Par22">Purge Haplotigs and Redundans were tested using a 16-core Intel® Xeon® E5-2670 based workstation with 64 GB of available RAM, running Ubuntu 16.04 LTS. Pipelines were instructed to utilise all 32 threads, except for the Purge Haplotigs ‘purge’ stages for <italic>V. vinifera</italic> (16 threads), and <italic>T. guttata</italic> (10 threads) due to RAM constraints. Repeat annotations were produced with RepeatMasker [<xref ref-type="bibr" rid="CR21">21</xref>] using RepBase version 2017-01-27 [<xref ref-type="bibr" rid="CR22">22</xref>]. Assembly metrics were calculated using Quast v4.5 [<xref ref-type="bibr" rid="CR23">23</xref>]. Genome completeness, duplication, and fragmentation were predicted using Benchmarking Universal Single-Copy Orthologs (BUSCOs) using the pipeline of the same name—BUSCO v3.0.1 [<xref ref-type="bibr" rid="CR24">24</xref>]. Phasing coverage was calculated and visualised from whole genome alignments, and genome sequence comparisons were conducted using the MUMmer package v4.0.0 [<xref ref-type="bibr" rid="CR25">25</xref>]. Haploid assemblies were assessed for uniform read depth of coverage and heterozygous SNP detection using short read data. Suitable Illumina paired-end (PE) short reads were publicly available from the Sequence Read Archive (SRA) for <italic>A. thaliana</italic> Col-0 × Cvi-0 (SRA accessions: SRR3703081, SRR3703082, SRR3703105), <italic>C. pyxidata</italic> (SRA accession: SRR1800147), and <italic>T. guttata</italic> (SRA accession: ERR1013157). PE reads were downloaded and mapped using BWA-MEM v0.7.12 [<xref ref-type="bibr" rid="CR26">26</xref>] to the draft and curated haploid assemblies. Heterozygous SNPs were called using VarScan v2.3.9 [<xref ref-type="bibr" rid="CR27">27</xref>], and read-depth and SNP density were analysed using BEDTools v2.25.0 [<xref ref-type="bibr" rid="CR28">28</xref>]. The SNP density and read-depth histograms were visualised as Circos plots [<xref ref-type="bibr" rid="CR29">29</xref>]. Detailed workflows for processing with Purge Haplotigs and subsequent analysis are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec9">
      <title>Resource usage</title>
      <p id="Par23">Total runtime and peak RAM usage of Redundans and Purge Haplotigs against all four genomes are reported in Table <xref rid="Tab1" ref-type="table">1</xref>. Purge Haplotigs is optimised for thread utilisation. As such, it was able to process all four genomes quickly with runtime scaling well with genome size. Peak RAM usage for Purge Haplotigs occurs during the parallel Minimap2 alignments. For <italic>A. thaliana</italic>, peak RAM was just under 1 GB per parallel Minimap2 alignment. For <italic>V. vinifera</italic> and <italic>T. guttata</italic>, the parallel Minimap2 alignments had to be reduced to 16 and 10 respectively as the peak RAM was much higher for these larger genomes (approximately 3 GB and 10 GB per parallel Minimap2 alignment respectively).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Pipeline runtimes and peak RAM usage for Redundans and Purge Haplotigs</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th rowspan="2">Diploid genome size (Mbp)</th><th colspan="2">Redundans</th><th colspan="2">Purge Haplotigs</th></tr><tr><th>Runtime (hh:mm:ss)</th><th>Peak RAM (GB)</th><th>Runtime (hh:mm:ss)</th><th>Peak RAM (GB)</th></tr></thead><tbody><tr><td><italic>C. pyxidata</italic></td><td>65.4</td><td>00:01:54</td><td>1</td><td>00:01:04</td><td>10</td></tr><tr><td><italic>A. thaliana</italic></td><td>245</td><td>00:35:56</td><td>1</td><td>00:04:17</td><td>30</td></tr><tr><td><italic>V. vinifera</italic></td><td>959</td><td>15:48:27</td><td>6</td><td>00:34:40</td><td>47</td></tr><tr><td><italic>T. guttata</italic></td><td>1983</td><td>06:14:06</td><td>6</td><td>01:04:51</td><td>60</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec10">
      <title>Purge Haplotigs effectively optimises Arabidopsis model assembly</title>
      <p id="Par24">In order to quantify the effectiveness of the Purge Haplotigs pipeline, its performance was assessed using genome assemblies from a previously-established trio of <italic>A. thaliana</italic> isolates [<xref ref-type="bibr" rid="CR4">4</xref>]. These consist of a draft diploid assembly of a heterozygous F1 line as well as highly contiguous and accurate assemblies of both homozygous parents (Col-0 and its most divergent relative Cvi-0). Furthermore, the chromosome-resolved assembly for Col-0 (TAIR10) was also available to enable detailed chromosome-scale comparisons [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
      <p id="Par25">The ideal haploid representation of the F1 cross of Col-0 and Cvi-0 should consist of one allelic copy of all common regions between the Col-0 and Cvi-0 parent genomes, as well as all hemizygous regions from both parent genomes. The haplotigs should consist of the other allelic copies of the Col-0 and Cvi-0 common regions. The Col-0 and Cvi-0 parent genomes should therefore align in their entirety to the haploid representation (primary contigs), and as completely as possible to the haplotigs. To determine if Purge Haplotigs provided improvements to this metric, the draft assembly and the Purge Haplotigs- and Redundans-processed assemblies were compared with the two parent genome assemblies.</p>
      <p id="Par26">The coverage of the Col-0 and Cvi-0 parent genomes by the draft primary contigs was high at 97.9% for both (Table <xref rid="Tab2" ref-type="table">2</xref>). However, the draft haplotigs only aligned to an average 87.6% of the parent genomes. The Purge Haplotigs-processed primary contigs showed a 1% decrease in coverage of the parent genomes, indicating that some over-purging is occurring. However, there was an average 94.4% coverage of the parent genomes by haplotigs. This increase is much higher than the drop in coverage and suggests a strong enrichment for deduplication over reduction in genome completeness.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Whole genome alignments of the <italic>A. thaliana</italic> draft and processed assemblies to the homozygous parent genomes</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th colspan="2">Col-0 alignments</th><th colspan="2">Cvi-0 alignments</th></tr><tr><th>Coverage<break/>(% Col-0 length)</th><th>Identity<break/>(%)</th><th>Coverage<break/>(% Cvi-0 length)</th><th>Identity<break/>(%)</th></tr></thead><tbody><tr><td colspan="5">FALCON Unzip</td></tr><tr><td> - Primary contigs</td><td>97.9</td><td>98.7</td><td>97.9</td><td>98.6</td></tr><tr><td> - Haplotigs</td><td>87.5</td><td>98.5</td><td>87.7</td><td>98.6</td></tr><tr><td colspan="5">Purge Haplotigs</td></tr><tr><td> - Primary contigs</td><td>96.9</td><td>98.8</td><td>96.6</td><td>98.6</td></tr><tr><td> - Haplotigs</td><td>94.2</td><td>98.5</td><td>94.9</td><td>98.6</td></tr><tr><td colspan="5">Redundans</td></tr><tr><td> - Reduced contigs</td><td>95.5</td><td>98.8</td><td>94.6</td><td>98.5</td></tr></tbody></table></table-wrap></p>
      <p id="Par27">Purge Haplotigs fills gaps in the haplotig tiling path using duplicated allelic contigs from the primary contig pool. This solves both the problem of duplication in the haploid representation (primary contigs) as well as the problem of phasing gaps in the haplotigs. In order to visualise this on a chromosome-scale, the draft assembly and the Purge Haplotigs- and Redundans-processed assemblies were aligned to the chromosome-resolved TAIR10 (Col-0) reference assembly. Chromosome 5 was selected to highlight the utility of contig reassignment, and the contig alignments for this chromosome are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> as stacked bars. For the draft assembly, there are two large gaps in the coverage of haplotig alignments to Chromosome 5; this coincides with duplicate alignments in the primary contigs. Primary contig duplication is reduced and haplotig coverage of the reference genome is greatly improved following the reassignment of duplicated contigs by Purge Haplotigs.<fig id="Fig3"><label>Fig. 3</label><caption><p>Alignments of contigs to Chromosome 5 of the TAIR10 (Col-0) reference genome. Alignments for the draft FALCON Unzip, and the Purge Haplotigs- and Redundans-processed assemblies are shown as stacked horizontal bars and are juxtaposed vertically</p></caption><graphic xlink:href="12859_2018_2485_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>Deduplication reduces assembly size</title>
      <p id="Par28">Once it had been established that Purge Haplotigs was able to accurately deduplicate the <italic>A. thaliana</italic> dataset, the assembly statistics were examined. As mentioned, haploid assemblies contaminated by allelic contigs can be significantly larger than the haploid genome size. The draft FALCON Unzip haploid assembly for <italic>A. thaliana</italic> was 140 Mb, much larger than the current TAIR10 (Col-0) reference genome of 119 Mb [<xref ref-type="bibr" rid="CR30">30</xref>]. The haploid assembly size was reduced to 126 Mbp by Purge Haplotigs, placing it closer to the Col-0 haploid size (Table <xref rid="Tab3" ref-type="table">3</xref>). Furthermore, the reduction in haploid genome size is almost entirely attributed to the identification and reassignment of haplotigs, rather than the removal of artefactual contigs which only accounted for 1.7 Mbp of the assembly. The Redundans-processed assembly was reduced to 119 Mbp; while this mirrors the haploid genome size, the haploid representation of the heterozygous genome is expected to be larger if it includes the hemizygous regions from both parents. For the other assemblies in this case study, the haploid sizes were also reduced by between 4.1% (<italic>C. pyxidata</italic>) and 12.0% (<italic>V. vinifera</italic>) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>) after processing with Purge Haplotigs.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Assembly statistics for draft FALCON Unzip, Redundans-processed and Purge Haplotigs-processed <italic>A. thaliana</italic> assemblies</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th colspan="3">Haploid Assemblies (Primary contigs)</th><th colspan="2">Haplotigs</th><th>Artefacts</th></tr><tr><th>FALCON Unzip</th><th>Purge Haplotigs</th><th>Redundans</th><th>FALCON Unzip</th><th>Purge Haplotigs</th><th>Purge Haplotigs</th></tr></thead><tbody><tr><td>Contigs</td><td>172</td><td>120</td><td>93</td><td>248</td><td>200</td><td>100</td></tr><tr><td>Contigs &gt; = 1000 bp</td><td>171</td><td>119</td><td>92</td><td>248</td><td>200</td><td>100</td></tr><tr><td>Contigs &gt; = 10,000 bp</td><td>171</td><td>108</td><td>92</td><td>214</td><td>200</td><td>77</td></tr><tr><td>Total length (Mbp)</td><td>140.0</td><td>125.6</td><td>119.2</td><td>104.9</td><td>117.7</td><td>1.740</td></tr><tr><td>GC (%)</td><td>36.7</td><td>36.7</td><td>36.6</td><td>36.1</td><td>36.1</td><td>38.5</td></tr><tr><td>N50 (Mbp)</td><td>7.96</td><td>7.98</td><td>7.98</td><td>6.92</td><td>4.63</td><td>0.0199</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec12">
      <title>Genome completeness is unaffected by contig reassignment</title>
      <p id="Par29">While the Arabidopsis trio was useful in evaluating the performance of Purge Haplotigs for the <italic>A. thaliana</italic> assembly, an orthologous method was required for the other assemblies in this case study. BUSCOs are sets of known gene orthologs that are predicted to be present as a single copy in a genome. They are used extensively for estimating the completeness, duplication and fragmentation of genome assemblies [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. The primary contigs and haplotigs of the draft FACLON Unzip and the Purge Haplotigs-processed assemblies were therefore evaluated using the BUSCO pipeline, as were the Redundans-processed (haploid) assemblies (<italic>A. thaliana</italic> Table <xref rid="Tab4" ref-type="table">4</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>). The TAIR10 and Cvi-0 assemblies are also included for comparison in Additional file <xref rid="MOESM2" ref-type="media">2</xref>. Finally, the artefact contigs removed by Purge Haplotigs were also assessed to determine if the removal of these contigs was detrimental to the predicted completeness of the genome assemblies.<table-wrap id="Tab4"><label>Table 4</label><caption><p>BUSCO statistics for draft FALCON Unzip, Redundans-processed, and Purge Haplotigs-processed <italic>A. thaliana</italic> assemblies</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="3"/><th colspan="6">Haploid Assemblies (Primary contigs)</th><th colspan="4">Haplotigs</th><th colspan="2">Artefacts</th></tr><tr><th colspan="2">FALCON Unzip</th><th colspan="2">Purge Haplotigs</th><th colspan="2">Redundans</th><th colspan="2">FALCON Unzip</th><th colspan="2">Purge Haplotigs</th><th colspan="2">Purge Haplotigs</th></tr><tr><th>#</th><th>%</th><th>#</th><th>%</th><th>#</th><th>%</th><th>#</th><th>%</th><th>#</th><th>%</th><th>#</th><th>%</th></tr></thead><tbody><tr><td>Total BUSCOs</td><td>1440</td><td>100.0</td><td>1440</td><td>100.0</td><td>1440</td><td>100.0</td><td>1440</td><td>100.0</td><td>1440</td><td>100.0</td><td>1440</td><td>100.0</td></tr><tr><td>Complete BUSCOs</td><td>1413</td><td>98.1</td><td>1407</td><td>97.7</td><td>1407</td><td>97.7</td><td>1342</td><td>93.2</td><td>1400</td><td>97.2</td><td>17</td><td>1.2</td></tr><tr><td> - single-copy</td><td>1324</td><td>91.9</td><td>1377</td><td>95.6</td><td>1378</td><td>95.7</td><td>1313</td><td>91.2</td><td>1372</td><td>95.3</td><td>17</td><td>1.2</td></tr><tr><td> - duplicated</td><td>89</td><td>6.2</td><td>30</td><td>2.1</td><td>29</td><td>2.0</td><td>29</td><td>2.0</td><td>28</td><td>1.9</td><td>0</td><td>0.0</td></tr><tr><td>Fragmented BUSCOs</td><td>5</td><td>0.3</td><td>8</td><td>0.6</td><td>8</td><td>0.6</td><td>5</td><td>0.3</td><td>5</td><td>0.3</td><td>3</td><td>0.2</td></tr><tr><td>Missing BUSCOs</td><td>22</td><td>1.5</td><td>25</td><td>1.7</td><td>25</td><td>1.7</td><td>93</td><td>6.5</td><td>35</td><td>2.4</td><td>1420</td><td>98.6</td></tr></tbody></table></table-wrap></p>
      <p id="Par30">The Purge Haplotigs haploid assemblies (primary contigs) contained between 39% (<italic>C. pyxidata</italic>) and 66% (<italic>A. thaliana</italic>) fewer duplicated BUSCOs compared to the draft assemblies, and contained similar total BUSCOs, ranging from 0.4% fewer (<italic>A. thaliana</italic>) to 3.6% more (<italic>V. vinifera</italic>) BUSCOs. An increase in total BUSCOs found in the primary contigs can occur where a FALCON Unzip haplotig is longer than its primary contig due to the inclusion of large structural variants. These large structural variants may contain extra BUSCOs. Purge Haplotigs will always keep the longer contig which results in an occasional ‘swapping’ of primary contigs and haplotigs compared to the draft FALCON Unzip assembly. When comparing Purge Haplotigs to Redundans, the Purge Haplotigs haploid assemblies contained between 3.4% more (<italic>A. thaliana</italic>) and 70.8% fewer (<italic>C. pyxidata</italic>) duplicated BUSCOs, and there was very little difference in the number of complete BUSCOs found.</p>
      <p id="Par31">The haplotigs from the draft assemblies and the Purge Haplotigs-processed assemblies were compared. The processed haplotigs contained between 7.1% (<italic>C. pyxidata</italic>) and 62.4% (<italic>A. thaliana</italic>) fewer missing BUSCOs. This suggests that the haplotigs are themselves more complete representations of their genomes after processing with Purge Haplotigs. This is consistent with the findings of the genome comparisons using the Arabidopsis trio. Finally, there were only between 0.2% (<italic>C. pyxidata</italic>) and 1.4% (<italic>V. vinifera</italic>) of BUSCOs found in the Purge Haplotigs artefactual contigs, and in all cases, all BUSCOs identified were confirmed to be copies that were also present in the assembly’s remaining contigs.</p>
    </sec>
    <sec id="Sec13">
      <title>Contig reassignment improves haplotig coverage</title>
      <p id="Par32">Proper identification of allelic contig pairs results in improved phasing coverage of diploid assemblies. This is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> for <italic>A. thaliana</italic>. To assess if Purge Haplotigs provided improvements to this metric, pairwise alignments were performed between the primary contigs and haplotigs for both the draft and Purge Haplotigs-processed assemblies. The total coverage of primary contigs by haplotigs was calculated and visualised (<italic>A. thaliana</italic> Fig. <xref rid="Fig4" ref-type="fig">4</xref>; Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Coverage of primary contigs by haplotigs increased for all four assemblies. For the <italic>C. pyxidata</italic> and <italic>T. guttata</italic> assemblies the phasing coverage increased by 2.5 and 5.6% respectively. The two plant assemblies—which had higher predicted duplication—showed larger increases in phasing coverage of 11.8 and 11.3% for <italic>A. thaliana</italic> and <italic>V. vinifera</italic> respectively.<fig id="Fig4"><label>Fig. 4</label><caption><p>Dotplots for <italic>Arabidopsis thaliana</italic> assemblies. Haplotigs were aligned to primary contigs, total coverage of primary contigs by haplotigs was calculated, dotplots for one-to-one best alignments are shown. There was 78.7 and 90.5% coverage of primary contigs by haplotigs for the draft FALCON Unzip and the Purge Haplotigs-processed assemblies respectively. Vertical gaps correspond to sequence in haplotigs that is not present in the primary contigs, and horizontal gaps correspond to sequence in the primary contigs not present in the haplotigs</p></caption><graphic xlink:href="12859_2018_2485_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Genome deduplication improves SNP detection</title>
      <p id="Par33">As mentioned previously, the erroneous presence of both allelic contigs in a haploid assembly results in the presence of mapped regions displaying half the average read-depth and few (if any) heterozygous variant calls relative to the rest of the genome. To determine if the use of short-reads for genomic analysis was improved after processing, combined read-depth and heterozygous SNP density plots were generated for the draft assemblies and the Purge Haplotigs-processed assemblies of <italic>A. thaliana</italic>, <italic>C. pyxidata</italic>, and <italic>T. guttata</italic>, based upon the results from mapping illumina PE short-read data to the haploid assemblies. Heterozygous SNPs were stringently filtered to only consider regions with single-copy read-depth (i.e. within the 1× peak in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). There were between 2.7% (<italic>T. guttata</italic>) and 15.6% (<italic>A. thaliana</italic>) more heterozygous SNPs called from the Purge Haplotigs-processed assembly compared to the draft FALCON Unzip assembly (<italic>A. thaliana</italic> Fig. <xref rid="Fig5" ref-type="fig">5</xref>; Additional file <xref rid="MOESM4" ref-type="media">4</xref>). Furthermore, there were between 0.3% (<italic>A. thaliana</italic>) and 21.1% (<italic>C. pyxidata</italic>) more SNPs called in the Purge Haplotigs-processed assembly compared to the Redundans-processed assembly.<fig id="Fig5"><label>Fig. 5</label><caption><p>Circos plots for <italic>Arabidopsis thaliana</italic> haploid assemblies. Illumina PE reads were mapped, and heterozygous SNPs were called for the draft FALCON Unzip assembly (<bold>a</bold>) and the assembly curated with Purge Haplotigs (<bold>b</bold>). The tracks shown in the circos plots are: Contigs (ordered by length) (i), Read-depth histogram (reads per genome window; blue: median read-depth, yellow: half read-depth, red: very low/high read-depth) (ii), and SNP density (SNPs per genome window; blue: low SNP density, red: high SNP density) (iii). There were 577.0, 667.0, and 665.1 thousand filtered heterozygous SNP calls for the draft, Purge Hapltogs-processed, and Redundans-processed assemblies respectively</p></caption><graphic xlink:href="12859_2018_2485_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par34">Purge Haplotigs is an effective tool for the early stages of curating highly heterozygous genome assemblies produced from third-generation long read sequencing. Purge Haplotigs is fast with runtime scaling well with genome size. It can produce a mostly deduplicated haploid representation of a genome which is important for downstream analysis such as variant discovery. Purge Haplotigs can also generate an improved diploid representation of a genome with more allelic contigs identified and properly paired. This is particularly important for diploid assemblies, for instance if attempting to reconstruct parent haplomes.</p>
  </sec>
  <sec id="Sec16">
    <title>Availability and requirements</title>
    <p id="Par35"><bold>Project name:</bold> Purge Haplotigs</p>
    <p id="Par36">
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/mroachawri/purge_haplotigs">https://bitbucket.org/mroachawri/purge_haplotigs</ext-link>
    </p>
    <p id="Par37"><bold>Operating system:</bold> Linux (tested on Ubuntu 16.04 LTS)</p>
    <p id="Par38"><bold>Programming language:</bold> Perl</p>
    <p id="Par39"><bold>Dependencies:</bold> BEDTools, SAMtools, Minimap2, Perl, Rscript (with ggplot2)</p>
    <p id="Par40"><bold>License:</bold> MIT</p>
    <p id="Par41"><bold>Restrictions:</bold> None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2018_2485_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p>Workflows for Purge Haplotigs and subsequent analysis. (PDF 466 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2018_2485_MOESM2_ESM.xlsx">
            <label>Additional file 2:</label>
            <caption>
              <p>Quast and BUSCO analysis results for all assemblies. (XLSX 22 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2018_2485_MOESM3_ESM.pdf">
            <label>Additional file 3:</label>
            <caption>
              <p>Dotplots and coverage for <italic>C. pyxidata</italic>, <italic>V. vinifera L. Cv.</italic> Cabernet Sauvignon, and <italic>T. guttata</italic>. (PDF 728 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2018_2485_MOESM4_ESM.pdf">
            <label>Additional file 4:</label>
            <caption>
              <p>Circos Plots and mapping statistics for <italic>C. pyxidata</italic>, and <italic>T. guttata</italic>. (PDF 3318 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BUSCO</term>
        <def>
          <p id="Par4">The name of the pipeline for detecting BUSCOs</p>
        </def>
      </def-item>
      <def-item>
        <term>BUSCO(s)</term>
        <def>
          <p id="Par5">Benchmarking Universal Single-Copy Ortholog(s)</p>
        </def>
      </def-item>
      <def-item>
        <term>PE</term>
        <def>
          <p id="Par6">Paired End</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p id="Par7">Sequence Read Archive</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Sarah Kingan, Gregory Concepcion, Jason Chin and Pacific Biosciences for providing the BAM files for the assemblies and for helpful discussions. We would also like to thank the reviewers for their helpful comments and suggestions.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par42">The AWRI, a member of the Wine Innovation Cluster in Adelaide, is supported by Australia’s grapegrowers and winemakers through their investment body Wine Australia with matching funds from the Australian Government. This work was also supported by Bioplatforms Australia (BPA) through the Australian Government National Collaborative Research Infrastructure Strategy (NCRIS) scheme.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par43">The simulated genome dataset is available at: 10.5281/zenodo.1042847. The dataset for the analysis described in this study of the draft and curated genome assemblies is available at: 10.5281/zenodo.1419699.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MJR conceived and coded the pipeline; collected, analysed, and interpreted data; and drafted the manuscript. SAS and ARB assisted in the pipeline’s conception and design, data analysis and interpretation. SAS and ARB critically reviewed the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests<bold>.</bold></p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Badouin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gouzy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Grassa</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Murat</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Staton</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Cottret</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sunflower genome provides insights into oil metabolism, flowering and Asterid evolution</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>546</volume>
        <issue>7656</issue>
        <fpage>148</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22380</pub-id>
        <pub-id pub-id-type="pmid">28538728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Jarvis DE, Ho YS, Lightfoot DJ, Schmöckel SM, Li B, Borm TJA, et al. The genome of <italic>Chenopodium quinoa</italic>. Nature. 2017;542(7641):307–12.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Loman NJ, Quick J, Simpson JT. A complete bacterial genome assembled <italic>de novo</italic> using only nanopore sequencing data. Nat Meth. 2015;12(8):733–5.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>C-S</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Clum</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phased diploid genome assembly with single-molecule real-time sequencing</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>1050</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4035</pub-id>
        <pub-id pub-id-type="pmid">27749838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Korlach J, Gedman G, Kingan SB, Chin C-S, Howard JT, Audet J-N, et al. De novo PacBio long-read and phased avian genome assemblies correct and add to reference genes generated with intermediate and short reads. GigaScience. 2017;6(10):gix085-gix.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Koren S, Walenz BP, Berlin K, Miller JR, Bergman NH, Phillippy AM. Canu: scalable and accurate long-read assembly via adaptive <italic>k</italic>-mer weighting and repeat separation. Genome Res. 2017;27(5):722–36.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weisenfeld</surname>
            <given-names>NI</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Direct determination of diploid genome sequences</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>757</fpage>
        <lpage>767</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214874.116</pub-id>
        <pub-id pub-id-type="pmid">28381613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Kajitani R, Toshimoto K, Noguchi H, Toyoda A, Ogura Y, Okuno M, et al. Efficient de novo assembly of highly heterozygous genomes from whole-genome shotgun short reads. Genome Res. 2014;24(8):1384–95.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Safonova</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>dipSPAdes: assembler for highly polymorphic diploid genomes</article-title>
        <source>J Comput Biol</source>
        <year>2015</year>
        <volume>22</volume>
        <issue>6</issue>
        <fpage>528</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2014.0153</pub-id>
        <pub-id pub-id-type="pmid">25734602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Vinson JP, Jaffe DB, O'Neill K, Karlsson EK, Stange-Thomann N, Anderson S, et al. Assembly of polymorphic genomes: algorithms and application to<italic> Ciona savignyi</italic>. Genome Res. 2005;15(8):1127–35.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Pryszcz LP, Németh T, Gácser A, Gabaldón T. Genome comparison of <italic>Candida orthopsilosis</italic> clinical strains reveals the existence of hybrids between two distinct subspecies. Genome Biol Evol. 2014;6(5):1069–78.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Small KS, Brudno M, Hill MM, Sidow A. A haplome alignment and reference sequence of the highly polymorphic <italic>Ciona savignyi</italic> genome. Genome Biol. 2007;8(3):R41.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Colman</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Sahl</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Schupp</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Best practices for evaluating single nucleotide variant calling methods for microbial genomics</article-title>
        <source>Front Genet</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>235</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2015.00235</pub-id>
        <pub-id pub-id-type="pmid">26217378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>HaploMerger2: rebuilding both haploid sub-assemblies from high-heterozygosity diploid genome assembly</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>16</issue>
        <fpage>2577</fpage>
        <lpage>2579</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx220</pub-id>
        <pub-id pub-id-type="pmid">28407147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pryszcz</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Gabaldon</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Redundans: an assembly pipeline for highly heterozygous genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>12</issue>
        <fpage>e113</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw294</pub-id>
        <pub-id pub-id-type="pmid">27131372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Schwessinger B, Sperschneider J, Cuddy WS, Garnica DP, Miller ME, Taylor JM, et al. A Near-Complete Haplotype-Phased Genome of the Dikaryotic Wheat Stripe Rust Fungus<italic> Puccinia striiformis</italic> f. sp. <italic>tritici </italic>Reveals High Interhaplotype Diversity. mBio. 2018;9(1):e02275–17.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">VanBuren R, Wai CM, Ou S, Pardo J, Bryant D, Jiang N, et al. Extreme haplotype variation in the desiccation-tolerant clubmoss <italic>Selaginella lepidophylla</italic>. Nat Commun. 2018;9(1):13.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Concepcion G. get_homologs.py 2016 [Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/PacificBiosciences/apps-scripts">https://github.com/PacificBiosciences/apps-scripts</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Kingan S. HomolContigsByAnnotation 2016 [Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/skingan/HomolContigsByAnnotation">https://github.com/skingan/HomolContigsByAnnotation</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Smit A, Hubley R, Green P. RepeatMasker Open-4.0. 2013-2015 [Available from: <ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org">http://www.repeatmasker.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kojima</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Kohany</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Repbase update, a database of repetitive elements in eukaryotic genomes</article-title>
        <source>Mob DNA</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.1186/s13100-015-0041-9</pub-id>
        <pub-id pub-id-type="pmid">26045719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1072</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>3210</fpage>
        <lpage>3212</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv351</pub-id>
        <pub-id pub-id-type="pmid">26059717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Smoot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Versatile and open software for comparing large genomes</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>R12</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-2-r12</pub-id>
        <pub-id pub-id-type="pmid">14759262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. ARXIV</source>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>568</fpage>
        <lpage>576</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.129684.111</pub-id>
        <pub-id pub-id-type="pmid">22300766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krzywinski</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Schein</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Birol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Connors</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gascoyne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Horsman</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circos: An information aesthetic for comparative genomics</article-title>
        <source>Genome Research</source>
        <year>2009</year>
        <volume>19</volume>
        <issue>9</issue>
        <fpage>1639</fpage>
        <lpage>1645</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.092759.109</pub-id>
        <pub-id pub-id-type="pmid">19541911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lamesch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Berardini</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Swarbreck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilks</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sasidharan</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Arabidopsis information resource (TAIR): improved gene annotation and new tools</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>Database issue</issue>
        <fpage>D1202</fpage>
        <lpage>D1D10</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1090</pub-id>
        <pub-id pub-id-type="pmid">22140109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Bickhart DM, Rosen BD, Koren S, Sayre BL, Hastie AR, Chan S, et al. Single-molecule sequencing and chromatin conformation capture enable <italic>de novo</italic> reference assembly of the domestic goat genome. Nat Genet. 2017;49:643.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Daccord N, Celton J-M, Linsmith G, Becker C, Choisne N, Schijlen E, et al. High-quality <italic>de novo</italic> assembly of the apple genome and methylome dynamics of early fruit development. Nat Genet. 2017;49:1099.</mixed-citation>
    </ref>
  </ref-list>
</back>
