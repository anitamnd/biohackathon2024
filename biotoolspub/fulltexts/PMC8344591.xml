<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Virus Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Virus Evol</journal-id>
    <journal-id journal-id-type="publisher-id">vevolu</journal-id>
    <journal-title-group>
      <journal-title>Virus Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-1577</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8344591</article-id>
    <article-id pub-id-type="pmid">34527285</article-id>
    <article-id pub-id-type="doi">10.1093/ve/veab064</article-id>
    <article-id pub-id-type="publisher-id">veab064</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00860</subject>
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI02285</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Assignment of epidemiological lineages in an emerging pandemic using the pangolin tool</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8083-474X</contrib-id>
        <name>
          <surname>O’Toole</surname>
          <given-names>Áine</given-names>
        </name>
        <!--aine.otoole@ed.ac.uk-->
        <xref rid="COR0001" ref-type="corresp"/>
        <xref rid="FN10" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5401-5879</contrib-id>
        <name>
          <surname>Scher</surname>
          <given-names>Emily</given-names>
        </name>
        <xref rid="FN01" ref-type="author-notes"/>
        <xref rid="FN10" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Underwood</surname>
          <given-names>Anthony</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9981-0649</contrib-id>
        <name>
          <surname>Jackson</surname>
          <given-names>Ben</given-names>
        </name>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3509-8146</contrib-id>
        <name>
          <surname>Hill</surname>
          <given-names>Verity</given-names>
        </name>
        <xref rid="FN02" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McCrone</surname>
          <given-names>John T</given-names>
        </name>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5577-9897</contrib-id>
        <name>
          <surname>Colquhoun</surname>
          <given-names>Rachel</given-names>
        </name>
        <xref rid="FN03" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruis</surname>
          <given-names>Chris</given-names>
        </name>
        <aff><institution>Department of Medicine, University of Cambridge</institution>, Cambridge CB2 0SP, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abu-Dahab</surname>
          <given-names>Khalil</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Taylor</surname>
          <given-names>Ben</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0080-6242</contrib-id>
        <name>
          <surname>Yeats</surname>
          <given-names>Corin</given-names>
        </name>
        <xref rid="FN04" ref-type="author-notes"/>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>du Plessis</surname>
          <given-names>Louis</given-names>
        </name>
        <aff><institution content-type="department">Department of Zoology, University of Oxford</institution>, Oxford, Oxfordshire OX1 3SZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maloney</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7833-5909</contrib-id>
        <name>
          <surname>Medd</surname>
          <given-names>Nathan</given-names>
        </name>
        <xref rid="FN05" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1717-1677</contrib-id>
        <name>
          <surname>Attwood</surname>
          <given-names>Stephen W</given-names>
        </name>
        <xref rid="FN06" ref-type="author-notes"/>
        <aff><institution content-type="department">Department of Zoology, University of Oxford</institution>, Oxford, Oxfordshire OX1 3SZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aanensen</surname>
          <given-names>David M</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9596-3552</contrib-id>
        <name>
          <surname>Holmes</surname>
          <given-names>Edward C</given-names>
        </name>
        <xref rid="FN07" ref-type="author-notes"/>
        <aff><institution content-type="department">School of Life and Environmental Sciences and School of Medical Sciences, University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8797-2667</contrib-id>
        <name>
          <surname>Pybus</surname>
          <given-names>Oliver G</given-names>
        </name>
        <xref rid="FN08" ref-type="author-notes"/>
        <aff><institution content-type="department">Department of Zoology, University of Oxford</institution>, Oxford, Oxfordshire OX1 3SZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4337-3707</contrib-id>
        <name>
          <surname>Rambaut</surname>
          <given-names>Andrew</given-names>
        </name>
        <xref rid="FN09" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR0001">*Corresponding author: E-mail: <email xlink:href="aine.otoole@ed.ac.uk">aine.otoole@ed.ac.uk</email></corresp>
      <fn id="FN10">
        <label>
          <sup>†</sup>
        </label>
        <p>Áine O’Toole and Emily Scher contributed equally.</p>
      </fn>
      <fn id="FN01">
        <label>
          <sup>‡</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-5401-5879" ext-link-type="uri">http://orcid.org/0000-0002-5401-5879</ext-link>
        </p>
      </fn>
      <fn id="FN02">
        <label>
          <sup>§</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-3509-8146" ext-link-type="uri">http://orcid.org/0000-0002-3509-8146</ext-link>
        </p>
      </fn>
      <fn id="FN03">
        <label>
          <sup>**</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-5577-9897" ext-link-type="uri">http://orcid.org/0000-0002-5577-9897</ext-link>
        </p>
      </fn>
      <fn id="FN04">
        <label>
          <sup>††</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0003-0080-6242" ext-link-type="uri">http://orcid.org/0000-0003-0080-6242</ext-link>
        </p>
      </fn>
      <fn id="FN05">
        <label>
          <sup>‡‡</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0001-7833-5909" ext-link-type="uri">http://orcid.org/0000-0001-7833-5909</ext-link>
        </p>
      </fn>
      <fn id="FN06">
        <label>
          <sup>§§</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0003-1717-1677" ext-link-type="uri">http://orcid.org/0000-0003-1717-1677</ext-link>
        </p>
      </fn>
      <fn id="FN07">
        <label>
          <sup>***</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0001-9596-3552" ext-link-type="uri">http://orcid.org/0000-0001-9596-3552</ext-link>
        </p>
      </fn>
      <fn id="FN08">
        <label>
          <sup>†††</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-8797-2667" ext-link-type="uri">http://orcid.org/0000-0002-8797-2667</ext-link>
        </p>
      </fn>
      <fn id="FN09">
        <label>
          <sup>‡‡‡</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0003-4337-3707" ext-link-type="uri">http://orcid.org/0000-0003-4337-3707</ext-link>
        </p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-30">
      <day>30</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>7</volume>
    <issue>2</issue>
    <elocation-id>veab064</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>28</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <!--Advance access publication date: xx xxx xxx-->
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="veab064.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The response of the global virus genomics community to the severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) pandemic has been unprecedented, with significant advances made towards the ‘real-time’ generation and sharing of SARS-CoV-2 genomic data. The rapid growth in virus genome data production has necessitated the development of new analytical methods that can deal with orders of magnitude of more genomes than previously available. Here, we present and describe Phylogenetic Assignment of Named Global Outbreak Lineages (pangolin), a computational tool that has been developed to assign the most likely lineage to a given SARS-CoV-2 genome sequence according to the Pango dynamic lineage nomenclature scheme. To date, nearly two million virus genomes have been submitted to the web-application implementation of pangolin, which has facilitated the SARS-CoV-2 genomic epidemiology and provided researchers with access to actionable information about the pandemic’s transmission lineages.</p>
    </abstract>
    <kwd-group>
      <kwd>SARS-CoV-2</kwd>
      <kwd>genomic surveillance</kwd>
      <kwd>phylogenetics</kwd>
      <kwd>software</kwd>
      <kwd>lineage</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000781</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>725422-ReservoirDOCS</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>203783/Z/16/Z</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fast Grants</institution>
            <institution-id institution-id-type="DOI">10.13039/100016127</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2236</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Oxford Martin School, University of Oxford</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004211</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <label>1.</label>
    <title>Introduction</title>
    <p>The response of the global virus genomics community to the coronavirus disease 2019 (COVID-19) (severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2)) pandemic has been unprecedented, with a concerted and cooperative effort toward the generation and timely sharing of large numbers of SARS-CoV-2 genomes. At the time of writing, more than 1.8 million SARS-CoV-2 genomes have been submitted to GISAID from over 180 different countries, and this number continues to grow (<xref rid="F1" ref-type="fig">Fig. 1A</xref>). The rapid sharing of high volumes of virus genomes has given public health bodies potential access to actionable data as the pandemic has unfolded. This contrasts with the generation and application of virus genomes during some previous global health public emergencies, such as the West African Ebola virus epidemic and Zika virus in the Americas, during which sequencing was more retrospective and undertaken on a smaller scale (<xref rid="R16" ref-type="bibr">Rota et al. 2003</xref>; <xref rid="R3" ref-type="bibr">Dudas et al. 2017</xref>; <xref rid="R5" ref-type="bibr">Faria et al. 2017</xref>; <xref rid="R19" ref-type="bibr">Worobey, Cox, and Gill 2019</xref>). The rapid generation and sharing of thousands of SARS-CoV-2 genomes, sampled longitudinally as virus transmission, has unfolded worldwide and has created an urgent need for accessible tools and systems for managing and interpreting this vast data resource.</p>
    <fig position="float" id="F1" fig-type="figure">
      <label>Figure 1.</label>
      <caption>
        <p>(A) Time series of the number of countries that have reported SARS-CoV-2 genome sequences (shaded area) and a curve showing trends in the geographic variation of reporting, quantified as the Shannon diversity (H) of sequence sampling location labels (curved). (B) The accumulation of SARS-CoV-2 genetic diversity over time, measured as the mean genetic distance of sampled sequences from the reference sequence (accession: EPI_ISL_406801). Shaded regions indicate one standard deviation from the mean. (C) Number of designated Pango lineages over the course of the pandemic. As more countries have contributed sequences, and as genetic diversity has accumulated throughout, the Pango nomenclature has continued to define distinct lineages that represent the emerging edge of the pandemic. SARS-CoV-2 genome sequences and metadata described were sourced from GISAID on 31 May 2021.</p>
      </caption>
      <graphic xlink:href="veab064f1" position="float"/>
    </fig>
    <p>In April 2020, <xref rid="R14" ref-type="bibr">Rambaut et al. (2020)</xref> proposed and developed a dynamic nomenclature system to name and track global transmission lineages of SARS-CoV-2. This is called the Pango nomenclature (<xref rid="R15" ref-type="bibr">Rambaut et al. 2021</xref>) and complements two other SARS-CoV-2 nomenclature systems (NextStrain and GISAID) that focus on broader phylogenetic ‘clades’, and which incorporate criteria for minimum prevalence and persistence. The Pango lineage nomenclature system is hierarchical and fine scaled and designed to capture the leading edge of pandemic transmission. Each Pango lineage aims to define an epidemiologically relevant phylogenetic cluster, for instance an introduction into a distinct geographic area with evidence of onward transmission (<xref rid="R14" ref-type="bibr">Rambaut et al. 2020</xref>). Pango lineages are particularly suited to outbreak investigations at national or regional scales. At the time of writing, there are 1,293 Pango lineages, compared to 12 and 9 clades for the NextStrain and GISAID nomenclatures, respectively.</p>
    <p>However, the identification and assignment of SARS-CoV-2 phylogenetic lineages is not a trivial problem, due to the huge size and rapid growth of the virus’ global genome data set. The high intensity of genomic sampling of SARS-CoV-2, and the relatively low evolutionary rate of the virus compared to some other RNA viruses (phylogeny branches accrue approximately one nucleotide substitution every 2 weeks on average; <xref rid="R2" ref-type="bibr">Duchêne et al. 2020</xref>), mean that the fine-scaled lineages of the Pango nomenclature system may differ at very few nucleotide positions. This relatively low level of genetic diversity leaves SARS-CoV-2 classification sensitive to data issues such as missing data, laboratory artefacts, and homoplasy (instances where the same mutation has arisen multiple times across a phylogeny). Some estimates of homoplasy rates for SARS-CoV-2 are as high as 30 per cent of variable sites (<xref rid="R1" ref-type="bibr">De Maio et al. 2020</xref>), and sequencing amplicon dropouts can account for the loss of sequence information from some genomic regions. Consequently, it is not possible to define high-resolution Pango lineages using only the presence or absence of nucleotide changes at a subset of variable sites. Only by using full genome alignments can we estimate the <italic toggle="yes">most likely</italic> placement of a new genome sequence within the global SARS-CoV-2 phylogeny and thereby assign a lineage name to a sequence. However, even with perfect data, estimating a phylogenetic tree containing &gt;500,000 virus genome sequences is a considerable computational challenge, and efforts have been made to provide ‘best-practice’ solutions for estimating the global SARS-CoV-2 phylogeny (<xref rid="R6" ref-type="bibr">Jackson and Colquhoun 2020</xref>; <xref rid="R9" ref-type="bibr">Lanfear 2020</xref>).</p>
    <p>To overcome these challenges, we developed a computational tool, named Phylogenetic Assignment of Named Global Outbreak Lineages (pangolin), to enable access to actionable information from SARS-CoV-2 genomic data. We have continued to adapt this system as the pandemic progressed to account for the rising number of SARS-CoV-2 genome sequences from a growing list of countries (<xref rid="F1" ref-type="fig">Fig. 1A</xref>), the accumulation of genetic diversity among sequences (<xref rid="F1" ref-type="fig">Fig. 1B</xref>), and the growing number of designated Pango lineages (<xref rid="F1" ref-type="fig">Fig. 1C</xref>).</p>
    <p><xref rid="F2" ref-type="fig">Figure 2</xref> describes the relationship between the Pango nomenclature system, the implementation of that nomenclature in the form of Pango lineage designations, and the software tool pangolin that can be used to assign the most likely lineage to a given sequence. Using the nomenclature system and rules set out in <xref rid="R14" ref-type="bibr">Rambaut et al. (2020)</xref> and maintained by the Pango Network (<ext-link xlink:href="http://pango.network" ext-link-type="uri">http://pango.network</ext-link>), lineages are regularly designated by manually curating the global SARS-CoV-2 phylogeny. The Pango Network maintains these designations, publishes an up-to-date record of designated sequences (the ‘sequence designation list’ at <ext-link xlink:href="https://github.com/cov-lineages/pango-designation" ext-link-type="uri">https://github.com/cov-lineages/pango-designation</ext-link>; last accessed: 29 June 2021), and responds to lineage requests via the GitHub repository (<ext-link xlink:href="https://github.com/cov-lineages/pango-designation" ext-link-type="uri">https://github.com/cov-lineages/pango-designation</ext-link>; last accessed: 29 June 2021). When a novel lineage is designated, the sequence designation list is tagged on GitHub with a description of the changes. This list is then used, together with sequence data from GISAID, to train a machine learning model that can be used to assign lineages (<xref rid="F2" ref-type="fig">Fig. 2</xref>). This model, called pangoLEARN, is distributed as a dependency to pangolin (<ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link>; last accessed: 29 June 2021). For the end user, pangolin can be run as a command line tool or by using the pangolin web application that implements a simple ‘drag-and-drop’ interface (<ext-link xlink:href="https://pangolin.cog-uk.io" ext-link-type="uri">https://pangolin.cog-uk.io</ext-link>; last accessed: 29 June 2021), seen in <xref rid="F3" ref-type="fig">Fig. 3</xref>.</p>
    <fig position="float" id="F2" fig-type="figure">
      <label>Figure 2.</label>
      <caption>
        <p>Workflow describing the process of Pango lineage designation and assignment of lineages to SARS-CoV-2 genome sequences using pangolin. An estimated global SARS-CoV-2 phylogeny is periodically manually curated to ‘designate’ lineages and sequences (left). A list of sequences and the lineages to which they have been designated (the ‘sequence designation list’) is maintained by the Pango team at <ext-link xlink:href="https://github.com/cov-lineages/pango-designation" ext-link-type="uri">https://github.com/cov-lineages/pango-designation</ext-link> (last accessed: 29 June 2021<underline>)</underline>. These designations and the associated genome sequences from GISAID are used as input for the pangoLEARN training pipeline (<ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link>; last accessed: 29 June 2021) (centre). Once this is completed a new pangoLEARN data release is tagged (centre). This creates the machine learning model that pangolin uses to assign genomes (right). Users can then submit a SARS-CoV-2 genome query sequence and pangolin will assign the most likely lineage based on the currently established lineage designations. *In addition to assignment using the pangoLEARN model, certain lineages of interest are assigned by checking for specific defining SNPs with some built-in flexibility (e.g. B.1.1.7 is assigned by checking for the presence of at least 5 of the 17 defining SNPs that fall on the basal branch of the lineage). These additional ad hoc rules may be subject to revision or removal to maintain performance of the pangolin system.</p>
      </caption>
      <graphic xlink:href="veab064f2" position="float"/>
    </fig>
    <fig position="float" id="F3" fig-type="figure">
      <label>Figure 3.</label>
      <caption>
        <p>Pangolin web application interface. (A) The image shows the landing page of the pangolin web application where users can either select or drag and drop a local file into the web browser. (B) The results page showing a processed file, the sequence name for each sequence and the assigned lineage. Links to the UK and global microreact.org builds, as well as the cov-lineages.org web pages for each lineage are represented by the three icons on the right.</p>
      </caption>
      <graphic xlink:href="veab064f3" position="float"/>
    </fig>
    <p>Here, we formally describe pangolin, a computational tool to assign the most likely Pango lineage to one or more SARS-CoV-2 query genomes. Using pangolin, researchers across the globe have been able to retrieve lineage information; as of 27 May 2021, more than 1.8 million genome sequences have been assigned to lineages using the pangolin web application. This has helped public health networks and researchers worldwide by extracting usable and actionable information from the huge volume of available SARS-CoV-2 genomes.</p>
  </sec>
  <sec id="s2">
    <label>2.</label>
    <title>Methods</title>
    <sec id="s2-s1">
      <label>2.1</label>
      <title>Global SARS-CoV-2 phylogeny estimation</title>
      <p>Whole genome sequences were downloaded from GISAID (full table of GISAID acknowledgements hosted here: <ext-link xlink:href="https://cov-lineages.org/gisaid_acknowledgements.html" ext-link-type="uri">https://cov-lineages.org/gisaid_acknowledgements.html</ext-link>, last accessed: 29 June 2021). Using the tools available at grapevine (<ext-link xlink:href="https://github.com/COG-UK/grapevine" ext-link-type="uri">https://github.com/COG-UK/grapevine</ext-link>), these sequences were mapped against the canonical SARS-CoV-2 reference genome (Genbank ID<ext-link xlink:href="NC_045512.2" ext-link-type="DDBJ/EMBL/GenBank">NC_045512.2</ext-link>) using minimap2 v2.17 (<xref rid="R10" ref-type="bibr">Li 2018</xref>). Genome sequences were trimmed to the region defined by positions 265–29,674, which correspond to the untranslated regions (UTRs), and the missing 5ʹ and 3ʹ UTRs subsequently masked as N’s. Early data releases were based on complete trees containing all sequences, constructed with IQ-TREE v1.6.2, using ultrafast bootstrapping (<xref rid="R11" ref-type="bibr">Minh et al. 2020</xref>). However, as the number of sequences increased, an ‘allocate-and-graft’ method was adopted. This involved using the previous list of designated sequences to provisionally <italic toggle="yes">allocate</italic> new sequences to the most likely major viral lineage (A, B, B.1 and B.1.1, and later B.1.1.7 and B.1.177). A separate alignment for each of these major lineages was constructed and a tree for each was estimated using FastTree (<xref rid="R13" ref-type="bibr">Price, Dehal, and Arkin 2010</xref>), with a representative from the basal polytomy of that lineage as an outgroup. The lineage trees were then <italic toggle="yes">grafted</italic> together to construct the global phylogeny. More recently, this potential circularity during sequence designation has been avoided by inferring a large maximum parsimony tree <italic toggle="yes">de novo</italic> using FastTree (<xref rid="R13" ref-type="bibr">Price, Dehal, and Arkin 2010</xref>). At time of writing, we continue to estimate large maximum parsimony trees as a guide and for specific lineage cases build smaller maximum likelihood trees that include the diversity of interest using IQ-TREE v2.0 (with -blmin 0.0000000001 -m GTR+G -bb 1000 and all other parameters as default; <xref rid="R11" ref-type="bibr">Minh et al. 2020</xref>).</p>
    </sec>
    <sec id="s2-s2">
      <label>2.2</label>
      <title>Manual lineage curation</title>
      <p>Using the lineage designation criteria outlined in <xref rid="R14" ref-type="bibr">Rambaut et al. (2020)</xref>, lineages are curated by hand and annotated onto the global phylogeny in the tree visualisation software, FigTree (<ext-link xlink:href="http://tree.bio.ed.ac.uk/software/figtree/" ext-link-type="uri">http://tree.bio.ed.ac.uk/software/figtree/</ext-link>, last accessed: 29 June 2021). As illustrated in <xref rid="F4" ref-type="fig">Fig. 4</xref>, sequences that are 95 per cent complete (i.e. &lt;5 per cent of nucleotide sites in coding regions are ambiguous) on GISAID are considered for lineage designation. As such, not all SARS-CoV-2 genomes on GISAID will get a lineage designation, but pangolin can be used to estimate the most likely lineage of those sequences.</p>
      <fig position="float" id="F4" fig-type="figure">
        <label>Figure 4.</label>
        <caption>
          <p>Distribution of genome completeness as a percentage of informative coding region sites for all SARS-CoV-2 sequences on GISAID. 1,382,550 sequences were assessed for ambiguity in coding regions, including both whole genome sequences with high ambiguity content and short fragments that have been uploaded to GISAID. 1,284,427 sequences had &lt;5 per cent ambiguous sites across the virus coding region (i.e. were at least 95 per cent complete). Sequences that have designated a lineage are indicated (<italic toggle="yes">n</italic> = 438,440). This 95 per cent completeness threshold was enacted as of Pango designation version 1.2 (GISAID data sourced on 7 May 2021).</p>
        </caption>
        <graphic xlink:href="veab064f4" position="float"/>
      </fig>
    </sec>
    <sec id="s2-s3">
      <label>2.3</label>
      <title>pangoLEARN</title>
      <p>The pangoLEARN model is a machine learning model that uses the sequence designation list and SARS-CoV-2 whole genome sequences as input for training. It is built using sci-kit learn (<xref rid="R12" ref-type="bibr">Pedregosa et al. 2011</xref>) and can account for the complete genetic diversity of a lineage. While the underlying data being modelled are hierarchical (i.e. phylogenetic), it was not immediately clear to us that the model needed to represent hierarchy in order to provide accurate classifications. We therefore trialled three types of models: logistic regressions, decision trees, and random forests, using the sci-kit learn implementations (<xref rid="R12" ref-type="bibr">Pedregosa et al. 2011</xref>).</p>
      <p>The decision tree and the random forest models were developed in tandem. A decision tree represents a classification task in a way similar to a flow chart. Each node in the tree represents a decision made based on a value, splitting the problem space into finer and finer pieces until a classification is reached. A random forest is an ensemble of decision trees, each built using a subset of the training samples. Classifications are made when each individual tree ‘votes’ on the final decision. Both of these models inherently represent hierarchy. When trained, their structures ought to approximate the structure underlying the training data.</p>
      <p>The trained model provides rapid lineage assignments from within pangolin when queried. On a single thread, pangoLEARN can assign 1,000 genome sequences in ∼25 seconds. For all pangoLEARN models, the model was trained using sequences and their designated lineages (outlined above). To account for ambiguities in the data and the limitations of heuristic tree search algorithms used, any identical sequences with conflicting manual assignments were removed from the data set prior to training.</p>
      <p>When training the models, each sequence was represented as a vector of one-hot encoded nucleotides. Invariant—and thus uninformative—sites in the alignment were discarded. To handle ambiguity due to sequencing errors, unknown nucleotides were imputed with the reference nucleotide from this location. Tagged versions of the trained pangoLEARN model and header files are hosted on <ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link> alongside associated metadata and lineage curation notes (last accessed: 29 June 2021<underline>)</underline>.</p>
    </sec>
    <sec id="s2-s4">
      <label>2.4</label>
      <title>Lineage assignment using pangolin</title>
      <p>Pangolin is a python-based assignment pipeline built using Snakemake (<xref rid="R8" ref-type="bibr">Koster et al. 2012</xref>). An input fasta file, containing one or more query sequences, is processed if it fulfils the minimum length (default 10,000 bases) and a maximum percentage of N bases in the genome sequence (default 50 per cent) criteria. Each individual query sequence is mapped against an anonymised lineage A genome from Wuhan using minimap2 v2.17 (<xref rid="R10" ref-type="bibr">Li 2018</xref>). Genome sequences are trimmed to only the coding region (positions 265–29,674) and the missing 5ʹ and 3ʹ regions subsequently masked as N’s. These aligned genomes are then assigned the most likely genome using the pangoLEARN model. In a few instances, specific lineages of interest, such as lineage B.1.1.7 and B.1.351, are also assigned using a set of heuristic rules that explicitly check for the presence of certain Single Nucleotide Polymorphisms (SNPs), allowing for a controlled level of ambiguity at crucial sites. In its output report, pangolin documents the version of pangoLEARN model and Pango designations used to assign lineages.</p>
    </sec>
    <sec id="s2-s5">
      <label>2.5</label>
      <title>Limit testing of pangolin</title>
      <p>We evaluated pangolin’s ability to assign lineages in cases of excess diversity, varying levels of ambiguity and in the face of novel recombinants. We selected the most complete SARS-CoV-2 genome for each designated lineage as a representative set (<italic toggle="yes">n</italic> = 1,253 from Pango designation v1.1.23). For each representative genome, we simulated diversity from a given genome ranging from 100 per cent to 90 per cent divergence at 0.2 per cent intervals, producing genomes from 100 per cent to 90 per cent identity of the representative. For each divergence interval, we randomly selected a given number of sites and replaced the nucleotide at that position with a random base distinct from the original base (i.e. 1 per cent divergence equates to 299 sites replaced). We repeated this entire process 10 times, generating 625,000 simulated genomes in total, and assigned lineages to these genomes using pangolin v2.3.2 (pangoLEARN release 10 May 2021).</p>
      <p>To test pangolin’s behaviour in response to increasing ambiguity, we took the most complete sequence for every lineage as a representative (<italic toggle="yes">n</italic> = 1,253) and randomly replaced a given percentage of sites (in the range of 1–100 per cent) with N. All simulated sequences with &gt;25 per cent N content failed to map against the reference, so results are shown only for simulated genomes within the range 1–25 per cent (<xref rid="F7" ref-type="fig">Fig. 7A</xref>). This approach tests how pangolin responds to increasing amounts of random missing data. However, in practice, ambiguous or missing sites are often clustered together as amplicon dropouts. Therefore, we subsequently simulated a sliding window of triple amplicon dropouts for each representative genome corresponding to the amplicons formed in the ARTIC primer scheme v3 (<ext-link xlink:href="https://github.com/artic-network/artic-ncov2019" ext-link-type="uri">https://github.com/artic-network/artic-ncov2019</ext-link>; last accessed: 29 June 2021) and ran pangolin v2.3.2 (pangoLEARN release 10 May 2021) on the simulated genomes (<italic toggle="yes">n</italic> = 1,253 X 98 amplicons).</p>
      <fig position="float" id="F7" fig-type="figure">
        <label>Figure 7.</label>
        <caption>
          <p>Performance of pangolin in response to missing data. (A) pangolin assignment accuracy over a gradient of percentage ambiguities. Correct assignments decline with increasing numbers of ambiguous sites, and this initially leads to a greater proportion of genomes assigned to the parent lineage. At greater percentage of ambiguities, minimap2 fails to effectively map against the reference genome and beyond 24 per cent ambiguity all genomes fail to map. (B) Overlapping amplicons generated from the ARTIC ncov2019 primer scheme v3 (98 amplicons across two pools). (C) Pangolin assignments over a sliding window of triple amplicon dropouts coloured by correct lineage assignment, ancestor lineage assigned or incorrect assignment. SARS-CoV-2 genome schema with genome positions and largest genes (ORF1ab, S, M and N) labelled.</p>
        </caption>
        <graphic xlink:href="veab064f7" position="float"/>
      </fig>
      <p>In order to assess how pangolin assigns novel recombinants, we randomly chose 62,650 distinct lineage pairs from a set containing a single representative genome per lineage (<italic toggle="yes">n</italic> = 1,253). From these pairs, we simulated recombination between the pair for positions at 10 per cent intervals across the genome (i.e. positions 2,990, 5,980, 8,970, etc.; <xref rid="F8" ref-type="fig">Fig. 8A</xref>). Each pair was included as the 3ʹ and 5ʹ lineage to ensure that the simulations were symmetrical. We then ran a naive pangoLEARN model (i.e. not trained on the recombinant sequences) on these simulated recombinants (pangolin v2.3.2, pangoLEARN release 10 May 2021).</p>
      <fig position="float" id="F8" fig-type="figure">
        <label>Figure 8.</label>
        <caption>
          <p>The behaviour of pangolin in response to simulated recombinant genomes. (A) Genome graph of SARS-CoV-2. The position of percentage cut-off sites is shown along the top of the graph and nucleotide base position along the bottom. (B) Schema describing the structure of simulated recombinants. Each recombinant is a combination of two distinct lineages in varying proportions. The three example recombinants show a 20 per cent 5ʹ lineage (80 per cent 3ʹ lineage) recombinant, a 50:50 recombinant and an 80 per cent 5ʹ lineage (20 per cent 3ʹ lineage) recombinant. (C) A density curve over the SARS-CoV-2 genome highlighting the relative importance of particular sites within the decision tree. The density is calculated based on the number of rules in the decision tree that include a given site in the genome. (D) The horizontal axis indicates the percentage of the 5ʹ lineage present in a given recombinant genome. Each bar represents 125,300 simulated recombinants. Stacked colours indicate the count of the recombinants that had either the 5ʹ lineage assigned, the 3ʹ lineage assigned, an ancestral lineage assigned, or an incorrect assignment (i.e. a sibling or unrelated lineage).</p>
        </caption>
        <graphic xlink:href="veab064f8" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="s3">
    <label>3.</label>
    <title>Results and discussion</title>
    <p>A comparison of the performance and training time of the three model types used in the various pangoLEARN releases between July and October 2020 is shown in <xref rid="F5" ref-type="fig">Fig. 5</xref>. The statistics shown are based on 10-fold cross-validation. The first model to be used was multinomial logistic regression, which provides no representation of phylogenetic hierarchy. Each possible classification was associated with a collection of SNPs, and these associations alone were used to assign each query sequence a lineage. This relatively simple model offered acceptable accuracy, practically matching the performance of a maximum likelihood phylogenetic inference approach, whilst providing classifications in seconds instead of minutes. An additional benefit of this model was the intuitive interpretability of the regression coefficients, as each represented how strongly associated each individual SNP was with a particular lineage assignment. However, training time for this approach depends on not only the number of parameters, but also on the number of classes and samples. Consequently, training time for this model quickly became unsustainable (<xref rid="F5" ref-type="fig">Fig. 5B</xref>).</p>
    <fig position="float" id="F5" fig-type="figure">
      <label>Figure 5.</label>
      <caption>
        <p>Performance of different pangoLEARN models. (A) Number of genomes submitted to GISAID by the date of model training, and thus number of genomes included in a given model training. (B) Training time (hours) for each model type (logistic regression, random forest, decision tree), tested on SARS-CoV-2 genome data releases from April to October 2020. All models except the multinomial logistic regression scale acceptably with increasing sequence and lineage counts. (C) The average lineage recall rate for each model for each data release. All models performed well, with the random forests each slightly beating the decision trees. (D) The average F1 scores for each of the models for each of the data releases. These scores were closely correlated with the recall rate.</p>
      </caption>
      <graphic xlink:href="veab064f5" position="float"/>
    </fig>
    <p>To better represent the hierarchical nature of the data, we next trailed the decision tree and random forest models. <xref rid="F5" ref-type="fig">Fig. 5</xref> demonstrates the performances of these two model types. For our data sets and problem, the decision tree and the random forest approaches performed similarly. We ultimately adopted the decision tree model because the decisions it makes are more easily interpreted, whereas it is often very difficult to interpret the decisions made within random forests. Because each constituent of a random forest is built using only a subset of the model’s features, each constituent tree is unlikely to resemble the structure of the underlying data. The output of each of these trees is useful only when used together with the rest of the ensemble. In contrast, the decision tree model meaningfully represents the tree structure in a way that can be easily validated. Additionally, we harnessed the tendency of decision trees to overfit in order to make the model more likely to correctly classify smaller lineages whilst another model might overwhelmingly prefer to suggest a larger lineage. If the methods were applied to a virus with more genetic diversity or a different mode of evolution, the relative performances of these methods, and thus our choice of model, may be different. The modularity of our system (<xref rid="F2" ref-type="fig">Fig. 2</xref>) provides a useful level of flexibility: for each lineage release, each model can be re-evaluated and the currently best-performing model can be substituted into the framework.</p>
    <p>As with many tools for genomic epidemiology developed in response to the COVID-19 pandemic, it has been challenging to maintain sufficiently fast computation times in the context of data sets that have grown exponentially in size. Our experience to date suggests that many kinds of ‘flat’ models (those in which the hierarchical structure of the underlying data is ignored) may well be intractable given the hundreds of lineages, thousands of parameters, and hundreds of thousands of genomes available for analysis.</p>
    <sec id="s3-s1">
      <label>3.1</label>
      <title>Limit testing of pangolin</title>
      <p>In order to test how pangolin performs as sequences become increasingly different from the training data, we simulated a distribution of genomes that were up to 10 per cent divergent at the nucleotide level from a representative of each lineage present in the training dataset (<italic toggle="yes">n</italic> = 625,000 simulated genomes from 1,253 lineage representatives). At 100 per cent identity, pangolin correctly assigns 94 per cent of lineages (<xref rid="F6" ref-type="fig">Fig. 6</xref>). Of all simulated genomes, 179,628 genomes were assigned the same lineage as the designation of the genome they had been simulated from (‘correct’ lineage assignment). Of genomes that were not assigned the same lineage as source genome lineage designation, 154,176 genomes were assigned the parent lineage, 3,791 were assigned a descendant ‘child’ lineage of the designated lineage, and 301,435 genomes were assigned an incorrect lineage. <xref rid="F6" ref-type="fig">Fig. 6A</xref> shows that 95 per cent of correct assignments occur when simulated divergence is 98.8 per cent identity or more (i.e. &lt;1.2 per cent divergence from the lineage reference) or 358 nucleotide substitutions across the virus genome. <xref rid="F6" ref-type="fig">Fig. 6B</xref> shows there to be a drop off in accuracy when the pangoLEARN model encounters sequences that are very different from what it has been trained on. We are aware of this decline and to compensate for it and minimise its effects we regularly and frequently train new pangoLEARN models with the latest list of designated sequences.</p>
      <fig position="float" id="F6" fig-type="figure">
        <label>Figure 6.</label>
        <caption>
          <p>Performance of pangolin for genomes with increasing numbers of simulated additional mutations. (A) Boxplot showing the spread of the majority of data, separated by whether the lineage was correctly assigned, assigned an ancestral lineage of the designated lineage, assigned a descendant lineage, or incorrectly assigned. The whiskers define the 5th and 95th percentile range. (B) Proportion of genomes assigned correctly, incorrectly or to an ancestral or descendant (child) lineage, normalised for a given percentage identity.</p>
        </caption>
        <graphic xlink:href="veab064f6" position="float"/>
      </fig>
      <p>We simulated random ambiguities across SARS-CoV-2 coding regions for a set of representative genomes for all lineages (<italic toggle="yes">n</italic> = 1,253). <xref rid="F7" ref-type="fig">Fig. 7A</xref> shows pangolin performs well and is robust to some missing data. As the percentage of ambiguity increases, the number of correct assignments declines; however, the proportion of genomes assigned to parent lineages then increases (this is the designed behaviour of our method). We observe a small increase in incorrect assignments; however, beyond 24 per cent ambiguity, minimap2 fails to map and therefore a lineage cannot be assigned.</p>
      <p>These simulations generate N’s randomly across the coding regions of the virus genome. In practice, we often see clusters of ambiguities that reflect low-coverage regions or amplicon dropouts in the data, inflating the overall ambiguity percentage, but still allowing minimap2 to successfully map the rest of the genome. We tested this case with a sliding window of triple amplicon dropouts across the genome (<xref rid="F7" ref-type="fig">Fig. 7B</xref> shows amplicons corresponding to the ARTIC ncov2019 primer scheme v3 and their genomic location). A total of 126,553 simulated genomes were assigned using pangolin (<xref rid="F7" ref-type="fig">Fig. 7C</xref>). Overall, pangolin is robust to amplicon dropouts; however, there are some key regions that, when missing, lead to a greater proportion of misassignments (either of an ancestral lineage or an incongruous lineage).</p>
      <p>Lastly, we tested pangolin’s behaviour in response to novel recombinant genomes made up of two distinct lineages (<xref rid="F8" ref-type="fig">Fig. 8</xref>). We randomly chose 62,650 distinct lineage pairs from a set of representative genomes (<italic toggle="yes">n</italic> = 1,253) and recombined them in varying proportions at 10 per cent intervals across the length of the genome (<xref rid="F8" ref-type="fig">Fig. 8A, B</xref>). Each lineage of the pair was recombined as the 5ʹ lineage and the 3ʹ lineage to ensure recombination simulations were symmetrical. We ran 1,378,300 tests of pangoLEARN to assess how it responds to novel recombinants. Intuitively, recombinants highly skewed towards one lineage over the other are more likely to get assigned the dominant lineage (e.g. the 10 per cent 5ʹ recombinant; <xref rid="F8" ref-type="fig">Fig. 8D</xref>). As the proportion of the 5ʹ lineage increases, the 5ʹ lineage is more often assigned and the proportion of genomes assigned to an ancestral lineage of the two lineages increases. There is a skew towards assigning the lineage with its 3ʹ end represented, which suggests that there may be features at the 3ʹ end of the genome that may be more informative for lineage assignment. Similar to <xref rid="F7" ref-type="fig">Fig. 7C</xref>, certain key sites at the 3ʹ end of the genome appear to be important for accurate assignments. We investigated this using the decision tree rules output by the pangoLEARN model (<ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link>; last accessed: 29 June 2021) and <xref rid="F8" ref-type="fig">Fig. 8C</xref> shows a density curve reflecting the number of rules within the decision tree model that a given site in the SARS-CoV-2 genome is included in. The large spike towards the 3ʹ end of the genome equates to position 28,882 in the reference genome and is one of the three defining SNPs of the B.1.1 lineage. At present, pangolin cannot detect novel recombinants and can only assign based on previously designated lineages.</p>
    </sec>
    <sec id="s3-s2">
      <label>3.2</label>
      <title>Limitations</title>
      <p>The approach to lineage assignment currently implemented in pangolin provides a responsive, scalable tool. We continue to reflect the latest diversity of SARS-CoV-2 by retraining the pangoLEARN model each week, and this model can assign lineages to the entire GISAID database in a matter of hours. However, our approach has a number of limitations. Unlike phylogenetic assignment, the machine learning approach implemented in pangolin does not natively handle ambiguous data. To allow for nucleotide ambiguities, using an early lineage A reference sequence (accession: EPI_ISL_406801), we impute reference nucleotide states at sites with missing or ambiguous data. However, the reference nucleotide is not equivalent to an N and the consequences of this approach may be to provide more rootward (basal) lineage assignments for sequences with low coverage. As the Pango nomenclature system is hierarchical, a more rootward assignment can be interpreted as a lower resolution (high taxonomic level) classification rather than an incorrect one (i.e. the sequence could belong to the assigned lineage or any of its descendant lineages). As is common practice in machine learning applications, we treat our training data and query data in the same way. To limit how this imputation may affect the training and therefore the model, we do not allow highly ambiguous sequences in the training set (cut-off of 5 per cent ambiguity).</p>
      <p>Another consideration of our approach is that, except for particular lineages of concern, the assignments are largely unsupervised. Decisions are being made internally by the trained model and accurate assignment for a given lineage may rely on one or two key SNPS. This can lead to misassignments when incomplete data are queried with pangolin. For example, a sequence that might rightly belong in lineage B.1.177 but which has Ns in lieu of one or two important SNPs would be in fact assigned to a more basal lineage in the tree, such as B.1. We also commonly observe homoplasies in SARS-CoV-2 genome sequence data, which in combination with other mutations may inform assignment decisions for multiple lineages. Theoretically, if some key sites are missing, there may be identical sequences informing multiple lineages once their unknown values are imputed. To avoid such conflicts in the training data, we have implemented a 5 per cent ambiguity cut-off for the training set (as of Pango designation version 1.2) and any conflicting sequences are identified in a pre-screening process before training, and sequences belonging to a minority lineage are removed.</p>
      <p>A further limitation of our approach is that the quality of the machine learning assignments decline as genetic distance from the training set increases, as described in <xref rid="F6" ref-type="fig">Fig. 6</xref>. This means that the pangoLEARN model depends on regular updates to the list of Pango designated sequences as input. Pango designation has recently become a more formalised process, with the formation of the Pango Network (<ext-link xlink:href="https://www.pango.network/" ext-link-type="uri">https://www.pango.network/</ext-link>; last accessed: 29 June 2021), a team of experts and volunteers from around the world who will work to maintain these lineage designations alongside crowdsourced input through GitHub requests.</p>
    </sec>
    <sec id="s3-s3">
      <label>3.3</label>
      <title>Future directions</title>
      <p>The pangolin tool is being developed as virus transmission and diversification is ongoing and in the context of rapidly growing numbers of SARS-CoV-2 genome sequences. We are exploring and trialling more sophisticated machine learning models, including a hierarchical logistic regression model. The current pangolin model can accept all designated sequences for training, which now comprises &gt;400,000 genome sequences. In the future, it may be necessary to downsample this input. Indeed, as some lineages become unobserved, inactive, and eventually extinct in the global SARS-CoV-2 data set, they can be removed from the training set. Similarly, using a single large global phylogeny may not continue to be practical beyond a million sequences and we may need to consider only more recently sampled genomes, with deeper nodes in the global phylogeny being represented by fewer samples. This approach may have implications for countries not generating or sharing sequence data promptly or if SARS-CoV-2 diversity in some areas of the world has been poorly characterised or unsampled. In this case, we will be able to retrain our models rapidly and incorporate new virus genetic diversity that may come to light in the future. With the current global push towards real-time data generation and sharing and the growing global genomics capacity, these approaches for exceptionally large data sets will be needed.</p>
      <p>Although pangolin is a SARS-CoV-2 lineage assignment tool, the framework it implements could be adapted easily for use in future outbreaks involving another virus. A similar selection process among machine learning models would likely be needed as each virus evolves differently and presents unique analytical challenges. However, the modular toolkit and suite of machine learning models that we have developed and implemented in pangolin will enable it to become a generalised pathogen typing tool. Indeed, for other more established viruses with greater diversity, we predict the pangoLEARN approach would effectively assign virus subtypes.</p>
      <p>Since its initial release, pangolin has provided researchers with the ability to easily compare SARS-CoV-2 sequences and gain information to inform public health decision-making. Using the associated pangolin web-application and command line tools, phylogenetic information from SARS-CoV-2 genomics is readily accessible. Remarkably, almost 2 million unique sequences have been assigned by the pangolin web-application alone to date. By making the code and the lineage assignments openly available, we invite the broader community to contribute to the growing, dynamic list of SARS-CoV-2 lineages.</p>
    </sec>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank users who submitted suggestions on the pangolin GitHub repository, with particular thanks to Torsten Seeman and Art Poon for their comments and feedback. We thank Rob Lanfear for discussions and for maintaining a best practice phylogeny. We would also like to extend our gratitude to all involved in the global SARS-CoV-2 genome sequencing effort and continuing to share data on GISAID (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org/</ext-link>; last accessed: 29 June 2021, <xref rid="R4" ref-type="bibr">Elbe and Buckland-Merrett 2017</xref>), contributing to open science and enabling tools like pangolin to represent the latest diversity of SARS-CoV-2.</p>
  </ack>
  <sec sec-type="data-availability" id="s4">
    <title>Data availability</title>
    <p>pangolin is hosted publically on GitHub and available under a GNU General Public License v3.0. The pangolin web application is available at <ext-link xlink:href="https://pangolin.cog-uk.io/" ext-link-type="uri">https://pangolin.cog-uk.io/</ext-link> (last accessed: 29 June 2021<underline>)</underline>. Daily updated information about all Pango lineages and links to all resources are hosted at <ext-link xlink:href="https://cov-lineages.org/" ext-link-type="uri">https://cov-lineages.org/</ext-link>.</p>
  </sec>
  <sec id="s5">
    <title>Funding</title>
    <p>A.O.T. is supported by the Wellcome Trust Hosts, Pathogens &amp; Global Health Programme [grant number: grant.203783/Z/16/Z] and Fast Grants [award number: 2236]. O.G.P. and L.dP. acknowledge support from the Oxford Martin School. A.R., R.C., and J.T.M. acknowledge support from the Wellcome Trust (Collaborators Award 206298/Z/17/Z ARTIC network). E.C. and A.R. are supported by the European Research Council (grant agreement no. 725422-ReservoirDOCS).</p>
  </sec>
  <sec sec-type="COI-statement" id="s6">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="R1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>De Maio</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) <article-title>Issues with SARS-CoV-2 Sequencing Data Virological</article-title>. &lt;<ext-link xlink:href="https://virological.org/t/issues-with-sars-cov-2-sequencing-data/473" ext-link-type="uri">https://virological.org/t/issues-with-sars-cov-2-sequencing-data/473</ext-link>&gt; accessed<comment>27 Jan 2021</comment>.</mixed-citation>
    </ref>
    <ref id="R2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duchene</surname>
 <given-names>S.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) ‘<article-title>Temporal Signal and the Phylodynamic Threshold of SARS-CoV-2</article-title>’, <source><italic toggle="yes">Virus Evolution</italic></source>, <volume>6</volume>: <page-range>veaa061</page-range>.</mixed-citation>
    </ref>
    <ref id="R3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dudas</surname>
 <given-names>G.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2017</year>) ‘<article-title>Virus Genomes Reveal Factors that Spread and Sustained the Ebola Epidemic</article-title>’, <source><italic toggle="yes">Nature</italic></source>, <volume>544</volume>: <fpage>309</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">28405027</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elbe</surname>
 <given-names>S.</given-names></string-name>, and <string-name><surname>Buckland-Merrett</surname><given-names>G.</given-names></string-name></person-group> (<year>2017</year>) ‘<article-title>Data, Disease and Diplomacy: GISAID’s Innovative Contribution to Global Health</article-title>’, <source><italic toggle="yes">Global Challenges</italic></source>, <volume>1</volume>: <fpage>33</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">31565258</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Faria</surname>
 <given-names>N. R.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2017</year>) ‘<article-title>Establishment and Cryptic Transmission of Zika Virus in Brazil and the Americas</article-title>’, <source><italic toggle="yes">Nature</italic></source>, <volume>546</volume>: <fpage>406</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">28538727</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Jackson</surname>
 <given-names>B.</given-names></string-name>, and <string-name><surname>Colquhoun</surname><given-names>R.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Grapevine</article-title>. &lt;<ext-link xlink:href="https://github.com/COG-UK/grapevine" ext-link-type="uri">https://github.com/COG-UK/grapevine</ext-link>&gt; accessed <comment>29 Jun 2021</comment>.</mixed-citation>
    </ref>
    <ref id="R8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Köster</surname>
 <given-names>J.</given-names></string-name>, and <string-name><surname>Rahmann</surname><given-names>S.</given-names></string-name></person-group> (<year>2012</year>) ‘<article-title>Snakemake—A Scalable Bioinformatics Workflow Engine</article-title>’, <source><italic toggle="yes">Bioinformatics</italic></source>, <volume>28</volume>: <fpage>2520</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lanfear</surname>
 <given-names>R.</given-names></string-name></person-group> (<year>2020</year>) <article-title>A Global Phylogeny of SARS-CoV-2 Sequences from GISAID</article-title>. &lt;<ext-link xlink:href="https://github.com/roblanf/sarscov2phylo" ext-link-type="uri">https://github.com/roblanf/sarscov2phylo</ext-link>&gt; accessed <comment>29 Jun 2021</comment>.</mixed-citation>
    </ref>
    <ref id="R10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>
 <given-names>H.</given-names></string-name></person-group> (<year>2018</year>) ‘<article-title>Minimap2: Pairwise Alignment for Nucleotide Sequences</article-title>’, <source><italic toggle="yes">Bioinformatics</italic></source>, <volume>34</volume>: <fpage>3094</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>
 <given-names>B. Q.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) ‘<article-title>IQ-TREE 2: New Models and Efficient Methods for Phylogenetic Inference in the Genomic Era</article-title>’, <source><italic toggle="yes">Molecular Biology and Evolution</italic></source>, <volume>37</volume>: <fpage>1530</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname>
 <given-names>F.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2011</year>) ‘<article-title>Scikit-learn: Machine Learning in Python</article-title>’, <source><italic toggle="yes">The Journal of Machine Learning Research</italic></source>, <volume>12</volume>: <fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="R13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname>
 <given-names>M. N.</given-names></string-name>, <string-name><surname>Dehal</surname><given-names>P. S.</given-names></string-name>, and <string-name><surname>Arkin</surname><given-names>A. P.</given-names></string-name></person-group> (<year>2010</year>) ‘<article-title>FastTree 2—Approximately Maximum-likelihood Trees for Large Alignments</article-title>’, <source><italic toggle="yes">PLoS One</italic></source>, <volume>5</volume>: <page-range>e9490</page-range>. doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>.</mixed-citation>
    </ref>
    <ref id="R14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rambaut</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) ‘<article-title>A Dynamic Nomenclature Proposal for SARS-CoV-2 Lineages to Assist Genomic Epidemiology</article-title>’, <source><italic toggle="yes">Nature Microbiology</italic></source>, <volume>5</volume>: <fpage>1403</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="R15">
      <mixed-citation publication-type="journal">Rambaut, A. <etal>et al.</etal> (<year>2021</year>) ‘<article-title>Addendum: A Dynamic Nomenclature Proposal for SARS-CoV-2 Lineages to Assist Genomic Epidemiology</article-title>’, <source><italic toggle="yes">Nature Microbiology</italic></source>, 6: 415.</mixed-citation>
    </ref>
    <ref id="R16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rota</surname>
 <given-names>P. A.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2003</year>) ‘<article-title>Characterization of a Novel Coronavirus Associated with Severe Acute Respiratory Syndrome</article-title>’, <source><italic toggle="yes">Science</italic></source>, <volume>300</volume>: <fpage>1394</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">12730500</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Worobey</surname>
 <given-names>M.</given-names></string-name>, <string-name><surname>Cox</surname><given-names>J.</given-names></string-name>, and <string-name><surname>Gill</surname><given-names>D.</given-names></string-name></person-group> (<year>2019</year>) ‘<article-title>The Origins of the Great Pandemic</article-title>’, <source><italic toggle="yes">Evolution, Medicine and Public Health</italic></source>, <volume>2019</volume>: <fpage>18</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">30805187</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Virus Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Virus Evol</journal-id>
    <journal-id journal-id-type="publisher-id">vevolu</journal-id>
    <journal-title-group>
      <journal-title>Virus Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-1577</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8344591</article-id>
    <article-id pub-id-type="pmid">34527285</article-id>
    <article-id pub-id-type="doi">10.1093/ve/veab064</article-id>
    <article-id pub-id-type="publisher-id">veab064</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00860</subject>
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI02285</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Assignment of epidemiological lineages in an emerging pandemic using the pangolin tool</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8083-474X</contrib-id>
        <name>
          <surname>O’Toole</surname>
          <given-names>Áine</given-names>
        </name>
        <!--aine.otoole@ed.ac.uk-->
        <xref rid="COR0001" ref-type="corresp"/>
        <xref rid="FN10" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5401-5879</contrib-id>
        <name>
          <surname>Scher</surname>
          <given-names>Emily</given-names>
        </name>
        <xref rid="FN01" ref-type="author-notes"/>
        <xref rid="FN10" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Underwood</surname>
          <given-names>Anthony</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9981-0649</contrib-id>
        <name>
          <surname>Jackson</surname>
          <given-names>Ben</given-names>
        </name>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3509-8146</contrib-id>
        <name>
          <surname>Hill</surname>
          <given-names>Verity</given-names>
        </name>
        <xref rid="FN02" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McCrone</surname>
          <given-names>John T</given-names>
        </name>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5577-9897</contrib-id>
        <name>
          <surname>Colquhoun</surname>
          <given-names>Rachel</given-names>
        </name>
        <xref rid="FN03" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruis</surname>
          <given-names>Chris</given-names>
        </name>
        <aff><institution>Department of Medicine, University of Cambridge</institution>, Cambridge CB2 0SP, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abu-Dahab</surname>
          <given-names>Khalil</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Taylor</surname>
          <given-names>Ben</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0080-6242</contrib-id>
        <name>
          <surname>Yeats</surname>
          <given-names>Corin</given-names>
        </name>
        <xref rid="FN04" ref-type="author-notes"/>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>du Plessis</surname>
          <given-names>Louis</given-names>
        </name>
        <aff><institution content-type="department">Department of Zoology, University of Oxford</institution>, Oxford, Oxfordshire OX1 3SZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maloney</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7833-5909</contrib-id>
        <name>
          <surname>Medd</surname>
          <given-names>Nathan</given-names>
        </name>
        <xref rid="FN05" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1717-1677</contrib-id>
        <name>
          <surname>Attwood</surname>
          <given-names>Stephen W</given-names>
        </name>
        <xref rid="FN06" ref-type="author-notes"/>
        <aff><institution content-type="department">Department of Zoology, University of Oxford</institution>, Oxford, Oxfordshire OX1 3SZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aanensen</surname>
          <given-names>David M</given-names>
        </name>
        <aff><institution content-type="department">The Centre for Genomic Pathogen Surveillance, Big Data Institute, University of Oxford</institution>, Oxford, Oxfordshire OX3 7LF, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9596-3552</contrib-id>
        <name>
          <surname>Holmes</surname>
          <given-names>Edward C</given-names>
        </name>
        <xref rid="FN07" ref-type="author-notes"/>
        <aff><institution content-type="department">School of Life and Environmental Sciences and School of Medical Sciences, University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8797-2667</contrib-id>
        <name>
          <surname>Pybus</surname>
          <given-names>Oliver G</given-names>
        </name>
        <xref rid="FN08" ref-type="author-notes"/>
        <aff><institution content-type="department">Department of Zoology, University of Oxford</institution>, Oxford, Oxfordshire OX1 3SZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4337-3707</contrib-id>
        <name>
          <surname>Rambaut</surname>
          <given-names>Andrew</given-names>
        </name>
        <xref rid="FN09" ref-type="author-notes"/>
        <aff><institution content-type="department">Institute of Evolutionary Biology, University of Edinburgh</institution>, Edinburgh EH93FL, <country country="GB">UK</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR0001">*Corresponding author: E-mail: <email xlink:href="aine.otoole@ed.ac.uk">aine.otoole@ed.ac.uk</email></corresp>
      <fn id="FN10">
        <label>
          <sup>†</sup>
        </label>
        <p>Áine O’Toole and Emily Scher contributed equally.</p>
      </fn>
      <fn id="FN01">
        <label>
          <sup>‡</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-5401-5879" ext-link-type="uri">http://orcid.org/0000-0002-5401-5879</ext-link>
        </p>
      </fn>
      <fn id="FN02">
        <label>
          <sup>§</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-3509-8146" ext-link-type="uri">http://orcid.org/0000-0002-3509-8146</ext-link>
        </p>
      </fn>
      <fn id="FN03">
        <label>
          <sup>**</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-5577-9897" ext-link-type="uri">http://orcid.org/0000-0002-5577-9897</ext-link>
        </p>
      </fn>
      <fn id="FN04">
        <label>
          <sup>††</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0003-0080-6242" ext-link-type="uri">http://orcid.org/0000-0003-0080-6242</ext-link>
        </p>
      </fn>
      <fn id="FN05">
        <label>
          <sup>‡‡</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0001-7833-5909" ext-link-type="uri">http://orcid.org/0000-0001-7833-5909</ext-link>
        </p>
      </fn>
      <fn id="FN06">
        <label>
          <sup>§§</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0003-1717-1677" ext-link-type="uri">http://orcid.org/0000-0003-1717-1677</ext-link>
        </p>
      </fn>
      <fn id="FN07">
        <label>
          <sup>***</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0001-9596-3552" ext-link-type="uri">http://orcid.org/0000-0001-9596-3552</ext-link>
        </p>
      </fn>
      <fn id="FN08">
        <label>
          <sup>†††</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0002-8797-2667" ext-link-type="uri">http://orcid.org/0000-0002-8797-2667</ext-link>
        </p>
      </fn>
      <fn id="FN09">
        <label>
          <sup>‡‡‡</sup>
        </label>
        <p>
          <ext-link xlink:href="http://orcid.org/0000-0003-4337-3707" ext-link-type="uri">http://orcid.org/0000-0003-4337-3707</ext-link>
        </p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-30">
      <day>30</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>7</volume>
    <issue>2</issue>
    <elocation-id>veab064</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>28</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <!--Advance access publication date: xx xxx xxx-->
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="veab064.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The response of the global virus genomics community to the severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) pandemic has been unprecedented, with significant advances made towards the ‘real-time’ generation and sharing of SARS-CoV-2 genomic data. The rapid growth in virus genome data production has necessitated the development of new analytical methods that can deal with orders of magnitude of more genomes than previously available. Here, we present and describe Phylogenetic Assignment of Named Global Outbreak Lineages (pangolin), a computational tool that has been developed to assign the most likely lineage to a given SARS-CoV-2 genome sequence according to the Pango dynamic lineage nomenclature scheme. To date, nearly two million virus genomes have been submitted to the web-application implementation of pangolin, which has facilitated the SARS-CoV-2 genomic epidemiology and provided researchers with access to actionable information about the pandemic’s transmission lineages.</p>
    </abstract>
    <kwd-group>
      <kwd>SARS-CoV-2</kwd>
      <kwd>genomic surveillance</kwd>
      <kwd>phylogenetics</kwd>
      <kwd>software</kwd>
      <kwd>lineage</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000781</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>725422-ReservoirDOCS</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>203783/Z/16/Z</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fast Grants</institution>
            <institution-id institution-id-type="DOI">10.13039/100016127</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2236</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Oxford Martin School, University of Oxford</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004211</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <label>1.</label>
    <title>Introduction</title>
    <p>The response of the global virus genomics community to the coronavirus disease 2019 (COVID-19) (severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2)) pandemic has been unprecedented, with a concerted and cooperative effort toward the generation and timely sharing of large numbers of SARS-CoV-2 genomes. At the time of writing, more than 1.8 million SARS-CoV-2 genomes have been submitted to GISAID from over 180 different countries, and this number continues to grow (<xref rid="F1" ref-type="fig">Fig. 1A</xref>). The rapid sharing of high volumes of virus genomes has given public health bodies potential access to actionable data as the pandemic has unfolded. This contrasts with the generation and application of virus genomes during some previous global health public emergencies, such as the West African Ebola virus epidemic and Zika virus in the Americas, during which sequencing was more retrospective and undertaken on a smaller scale (<xref rid="R16" ref-type="bibr">Rota et al. 2003</xref>; <xref rid="R3" ref-type="bibr">Dudas et al. 2017</xref>; <xref rid="R5" ref-type="bibr">Faria et al. 2017</xref>; <xref rid="R19" ref-type="bibr">Worobey, Cox, and Gill 2019</xref>). The rapid generation and sharing of thousands of SARS-CoV-2 genomes, sampled longitudinally as virus transmission, has unfolded worldwide and has created an urgent need for accessible tools and systems for managing and interpreting this vast data resource.</p>
    <fig position="float" id="F1" fig-type="figure">
      <label>Figure 1.</label>
      <caption>
        <p>(A) Time series of the number of countries that have reported SARS-CoV-2 genome sequences (shaded area) and a curve showing trends in the geographic variation of reporting, quantified as the Shannon diversity (H) of sequence sampling location labels (curved). (B) The accumulation of SARS-CoV-2 genetic diversity over time, measured as the mean genetic distance of sampled sequences from the reference sequence (accession: EPI_ISL_406801). Shaded regions indicate one standard deviation from the mean. (C) Number of designated Pango lineages over the course of the pandemic. As more countries have contributed sequences, and as genetic diversity has accumulated throughout, the Pango nomenclature has continued to define distinct lineages that represent the emerging edge of the pandemic. SARS-CoV-2 genome sequences and metadata described were sourced from GISAID on 31 May 2021.</p>
      </caption>
      <graphic xlink:href="veab064f1" position="float"/>
    </fig>
    <p>In April 2020, <xref rid="R14" ref-type="bibr">Rambaut et al. (2020)</xref> proposed and developed a dynamic nomenclature system to name and track global transmission lineages of SARS-CoV-2. This is called the Pango nomenclature (<xref rid="R15" ref-type="bibr">Rambaut et al. 2021</xref>) and complements two other SARS-CoV-2 nomenclature systems (NextStrain and GISAID) that focus on broader phylogenetic ‘clades’, and which incorporate criteria for minimum prevalence and persistence. The Pango lineage nomenclature system is hierarchical and fine scaled and designed to capture the leading edge of pandemic transmission. Each Pango lineage aims to define an epidemiologically relevant phylogenetic cluster, for instance an introduction into a distinct geographic area with evidence of onward transmission (<xref rid="R14" ref-type="bibr">Rambaut et al. 2020</xref>). Pango lineages are particularly suited to outbreak investigations at national or regional scales. At the time of writing, there are 1,293 Pango lineages, compared to 12 and 9 clades for the NextStrain and GISAID nomenclatures, respectively.</p>
    <p>However, the identification and assignment of SARS-CoV-2 phylogenetic lineages is not a trivial problem, due to the huge size and rapid growth of the virus’ global genome data set. The high intensity of genomic sampling of SARS-CoV-2, and the relatively low evolutionary rate of the virus compared to some other RNA viruses (phylogeny branches accrue approximately one nucleotide substitution every 2 weeks on average; <xref rid="R2" ref-type="bibr">Duchêne et al. 2020</xref>), mean that the fine-scaled lineages of the Pango nomenclature system may differ at very few nucleotide positions. This relatively low level of genetic diversity leaves SARS-CoV-2 classification sensitive to data issues such as missing data, laboratory artefacts, and homoplasy (instances where the same mutation has arisen multiple times across a phylogeny). Some estimates of homoplasy rates for SARS-CoV-2 are as high as 30 per cent of variable sites (<xref rid="R1" ref-type="bibr">De Maio et al. 2020</xref>), and sequencing amplicon dropouts can account for the loss of sequence information from some genomic regions. Consequently, it is not possible to define high-resolution Pango lineages using only the presence or absence of nucleotide changes at a subset of variable sites. Only by using full genome alignments can we estimate the <italic toggle="yes">most likely</italic> placement of a new genome sequence within the global SARS-CoV-2 phylogeny and thereby assign a lineage name to a sequence. However, even with perfect data, estimating a phylogenetic tree containing &gt;500,000 virus genome sequences is a considerable computational challenge, and efforts have been made to provide ‘best-practice’ solutions for estimating the global SARS-CoV-2 phylogeny (<xref rid="R6" ref-type="bibr">Jackson and Colquhoun 2020</xref>; <xref rid="R9" ref-type="bibr">Lanfear 2020</xref>).</p>
    <p>To overcome these challenges, we developed a computational tool, named Phylogenetic Assignment of Named Global Outbreak Lineages (pangolin), to enable access to actionable information from SARS-CoV-2 genomic data. We have continued to adapt this system as the pandemic progressed to account for the rising number of SARS-CoV-2 genome sequences from a growing list of countries (<xref rid="F1" ref-type="fig">Fig. 1A</xref>), the accumulation of genetic diversity among sequences (<xref rid="F1" ref-type="fig">Fig. 1B</xref>), and the growing number of designated Pango lineages (<xref rid="F1" ref-type="fig">Fig. 1C</xref>).</p>
    <p><xref rid="F2" ref-type="fig">Figure 2</xref> describes the relationship between the Pango nomenclature system, the implementation of that nomenclature in the form of Pango lineage designations, and the software tool pangolin that can be used to assign the most likely lineage to a given sequence. Using the nomenclature system and rules set out in <xref rid="R14" ref-type="bibr">Rambaut et al. (2020)</xref> and maintained by the Pango Network (<ext-link xlink:href="http://pango.network" ext-link-type="uri">http://pango.network</ext-link>), lineages are regularly designated by manually curating the global SARS-CoV-2 phylogeny. The Pango Network maintains these designations, publishes an up-to-date record of designated sequences (the ‘sequence designation list’ at <ext-link xlink:href="https://github.com/cov-lineages/pango-designation" ext-link-type="uri">https://github.com/cov-lineages/pango-designation</ext-link>; last accessed: 29 June 2021), and responds to lineage requests via the GitHub repository (<ext-link xlink:href="https://github.com/cov-lineages/pango-designation" ext-link-type="uri">https://github.com/cov-lineages/pango-designation</ext-link>; last accessed: 29 June 2021). When a novel lineage is designated, the sequence designation list is tagged on GitHub with a description of the changes. This list is then used, together with sequence data from GISAID, to train a machine learning model that can be used to assign lineages (<xref rid="F2" ref-type="fig">Fig. 2</xref>). This model, called pangoLEARN, is distributed as a dependency to pangolin (<ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link>; last accessed: 29 June 2021). For the end user, pangolin can be run as a command line tool or by using the pangolin web application that implements a simple ‘drag-and-drop’ interface (<ext-link xlink:href="https://pangolin.cog-uk.io" ext-link-type="uri">https://pangolin.cog-uk.io</ext-link>; last accessed: 29 June 2021), seen in <xref rid="F3" ref-type="fig">Fig. 3</xref>.</p>
    <fig position="float" id="F2" fig-type="figure">
      <label>Figure 2.</label>
      <caption>
        <p>Workflow describing the process of Pango lineage designation and assignment of lineages to SARS-CoV-2 genome sequences using pangolin. An estimated global SARS-CoV-2 phylogeny is periodically manually curated to ‘designate’ lineages and sequences (left). A list of sequences and the lineages to which they have been designated (the ‘sequence designation list’) is maintained by the Pango team at <ext-link xlink:href="https://github.com/cov-lineages/pango-designation" ext-link-type="uri">https://github.com/cov-lineages/pango-designation</ext-link> (last accessed: 29 June 2021<underline>)</underline>. These designations and the associated genome sequences from GISAID are used as input for the pangoLEARN training pipeline (<ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link>; last accessed: 29 June 2021) (centre). Once this is completed a new pangoLEARN data release is tagged (centre). This creates the machine learning model that pangolin uses to assign genomes (right). Users can then submit a SARS-CoV-2 genome query sequence and pangolin will assign the most likely lineage based on the currently established lineage designations. *In addition to assignment using the pangoLEARN model, certain lineages of interest are assigned by checking for specific defining SNPs with some built-in flexibility (e.g. B.1.1.7 is assigned by checking for the presence of at least 5 of the 17 defining SNPs that fall on the basal branch of the lineage). These additional ad hoc rules may be subject to revision or removal to maintain performance of the pangolin system.</p>
      </caption>
      <graphic xlink:href="veab064f2" position="float"/>
    </fig>
    <fig position="float" id="F3" fig-type="figure">
      <label>Figure 3.</label>
      <caption>
        <p>Pangolin web application interface. (A) The image shows the landing page of the pangolin web application where users can either select or drag and drop a local file into the web browser. (B) The results page showing a processed file, the sequence name for each sequence and the assigned lineage. Links to the UK and global microreact.org builds, as well as the cov-lineages.org web pages for each lineage are represented by the three icons on the right.</p>
      </caption>
      <graphic xlink:href="veab064f3" position="float"/>
    </fig>
    <p>Here, we formally describe pangolin, a computational tool to assign the most likely Pango lineage to one or more SARS-CoV-2 query genomes. Using pangolin, researchers across the globe have been able to retrieve lineage information; as of 27 May 2021, more than 1.8 million genome sequences have been assigned to lineages using the pangolin web application. This has helped public health networks and researchers worldwide by extracting usable and actionable information from the huge volume of available SARS-CoV-2 genomes.</p>
  </sec>
  <sec id="s2">
    <label>2.</label>
    <title>Methods</title>
    <sec id="s2-s1">
      <label>2.1</label>
      <title>Global SARS-CoV-2 phylogeny estimation</title>
      <p>Whole genome sequences were downloaded from GISAID (full table of GISAID acknowledgements hosted here: <ext-link xlink:href="https://cov-lineages.org/gisaid_acknowledgements.html" ext-link-type="uri">https://cov-lineages.org/gisaid_acknowledgements.html</ext-link>, last accessed: 29 June 2021). Using the tools available at grapevine (<ext-link xlink:href="https://github.com/COG-UK/grapevine" ext-link-type="uri">https://github.com/COG-UK/grapevine</ext-link>), these sequences were mapped against the canonical SARS-CoV-2 reference genome (Genbank ID<ext-link xlink:href="NC_045512.2" ext-link-type="DDBJ/EMBL/GenBank">NC_045512.2</ext-link>) using minimap2 v2.17 (<xref rid="R10" ref-type="bibr">Li 2018</xref>). Genome sequences were trimmed to the region defined by positions 265–29,674, which correspond to the untranslated regions (UTRs), and the missing 5ʹ and 3ʹ UTRs subsequently masked as N’s. Early data releases were based on complete trees containing all sequences, constructed with IQ-TREE v1.6.2, using ultrafast bootstrapping (<xref rid="R11" ref-type="bibr">Minh et al. 2020</xref>). However, as the number of sequences increased, an ‘allocate-and-graft’ method was adopted. This involved using the previous list of designated sequences to provisionally <italic toggle="yes">allocate</italic> new sequences to the most likely major viral lineage (A, B, B.1 and B.1.1, and later B.1.1.7 and B.1.177). A separate alignment for each of these major lineages was constructed and a tree for each was estimated using FastTree (<xref rid="R13" ref-type="bibr">Price, Dehal, and Arkin 2010</xref>), with a representative from the basal polytomy of that lineage as an outgroup. The lineage trees were then <italic toggle="yes">grafted</italic> together to construct the global phylogeny. More recently, this potential circularity during sequence designation has been avoided by inferring a large maximum parsimony tree <italic toggle="yes">de novo</italic> using FastTree (<xref rid="R13" ref-type="bibr">Price, Dehal, and Arkin 2010</xref>). At time of writing, we continue to estimate large maximum parsimony trees as a guide and for specific lineage cases build smaller maximum likelihood trees that include the diversity of interest using IQ-TREE v2.0 (with -blmin 0.0000000001 -m GTR+G -bb 1000 and all other parameters as default; <xref rid="R11" ref-type="bibr">Minh et al. 2020</xref>).</p>
    </sec>
    <sec id="s2-s2">
      <label>2.2</label>
      <title>Manual lineage curation</title>
      <p>Using the lineage designation criteria outlined in <xref rid="R14" ref-type="bibr">Rambaut et al. (2020)</xref>, lineages are curated by hand and annotated onto the global phylogeny in the tree visualisation software, FigTree (<ext-link xlink:href="http://tree.bio.ed.ac.uk/software/figtree/" ext-link-type="uri">http://tree.bio.ed.ac.uk/software/figtree/</ext-link>, last accessed: 29 June 2021). As illustrated in <xref rid="F4" ref-type="fig">Fig. 4</xref>, sequences that are 95 per cent complete (i.e. &lt;5 per cent of nucleotide sites in coding regions are ambiguous) on GISAID are considered for lineage designation. As such, not all SARS-CoV-2 genomes on GISAID will get a lineage designation, but pangolin can be used to estimate the most likely lineage of those sequences.</p>
      <fig position="float" id="F4" fig-type="figure">
        <label>Figure 4.</label>
        <caption>
          <p>Distribution of genome completeness as a percentage of informative coding region sites for all SARS-CoV-2 sequences on GISAID. 1,382,550 sequences were assessed for ambiguity in coding regions, including both whole genome sequences with high ambiguity content and short fragments that have been uploaded to GISAID. 1,284,427 sequences had &lt;5 per cent ambiguous sites across the virus coding region (i.e. were at least 95 per cent complete). Sequences that have designated a lineage are indicated (<italic toggle="yes">n</italic> = 438,440). This 95 per cent completeness threshold was enacted as of Pango designation version 1.2 (GISAID data sourced on 7 May 2021).</p>
        </caption>
        <graphic xlink:href="veab064f4" position="float"/>
      </fig>
    </sec>
    <sec id="s2-s3">
      <label>2.3</label>
      <title>pangoLEARN</title>
      <p>The pangoLEARN model is a machine learning model that uses the sequence designation list and SARS-CoV-2 whole genome sequences as input for training. It is built using sci-kit learn (<xref rid="R12" ref-type="bibr">Pedregosa et al. 2011</xref>) and can account for the complete genetic diversity of a lineage. While the underlying data being modelled are hierarchical (i.e. phylogenetic), it was not immediately clear to us that the model needed to represent hierarchy in order to provide accurate classifications. We therefore trialled three types of models: logistic regressions, decision trees, and random forests, using the sci-kit learn implementations (<xref rid="R12" ref-type="bibr">Pedregosa et al. 2011</xref>).</p>
      <p>The decision tree and the random forest models were developed in tandem. A decision tree represents a classification task in a way similar to a flow chart. Each node in the tree represents a decision made based on a value, splitting the problem space into finer and finer pieces until a classification is reached. A random forest is an ensemble of decision trees, each built using a subset of the training samples. Classifications are made when each individual tree ‘votes’ on the final decision. Both of these models inherently represent hierarchy. When trained, their structures ought to approximate the structure underlying the training data.</p>
      <p>The trained model provides rapid lineage assignments from within pangolin when queried. On a single thread, pangoLEARN can assign 1,000 genome sequences in ∼25 seconds. For all pangoLEARN models, the model was trained using sequences and their designated lineages (outlined above). To account for ambiguities in the data and the limitations of heuristic tree search algorithms used, any identical sequences with conflicting manual assignments were removed from the data set prior to training.</p>
      <p>When training the models, each sequence was represented as a vector of one-hot encoded nucleotides. Invariant—and thus uninformative—sites in the alignment were discarded. To handle ambiguity due to sequencing errors, unknown nucleotides were imputed with the reference nucleotide from this location. Tagged versions of the trained pangoLEARN model and header files are hosted on <ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link> alongside associated metadata and lineage curation notes (last accessed: 29 June 2021<underline>)</underline>.</p>
    </sec>
    <sec id="s2-s4">
      <label>2.4</label>
      <title>Lineage assignment using pangolin</title>
      <p>Pangolin is a python-based assignment pipeline built using Snakemake (<xref rid="R8" ref-type="bibr">Koster et al. 2012</xref>). An input fasta file, containing one or more query sequences, is processed if it fulfils the minimum length (default 10,000 bases) and a maximum percentage of N bases in the genome sequence (default 50 per cent) criteria. Each individual query sequence is mapped against an anonymised lineage A genome from Wuhan using minimap2 v2.17 (<xref rid="R10" ref-type="bibr">Li 2018</xref>). Genome sequences are trimmed to only the coding region (positions 265–29,674) and the missing 5ʹ and 3ʹ regions subsequently masked as N’s. These aligned genomes are then assigned the most likely genome using the pangoLEARN model. In a few instances, specific lineages of interest, such as lineage B.1.1.7 and B.1.351, are also assigned using a set of heuristic rules that explicitly check for the presence of certain Single Nucleotide Polymorphisms (SNPs), allowing for a controlled level of ambiguity at crucial sites. In its output report, pangolin documents the version of pangoLEARN model and Pango designations used to assign lineages.</p>
    </sec>
    <sec id="s2-s5">
      <label>2.5</label>
      <title>Limit testing of pangolin</title>
      <p>We evaluated pangolin’s ability to assign lineages in cases of excess diversity, varying levels of ambiguity and in the face of novel recombinants. We selected the most complete SARS-CoV-2 genome for each designated lineage as a representative set (<italic toggle="yes">n</italic> = 1,253 from Pango designation v1.1.23). For each representative genome, we simulated diversity from a given genome ranging from 100 per cent to 90 per cent divergence at 0.2 per cent intervals, producing genomes from 100 per cent to 90 per cent identity of the representative. For each divergence interval, we randomly selected a given number of sites and replaced the nucleotide at that position with a random base distinct from the original base (i.e. 1 per cent divergence equates to 299 sites replaced). We repeated this entire process 10 times, generating 625,000 simulated genomes in total, and assigned lineages to these genomes using pangolin v2.3.2 (pangoLEARN release 10 May 2021).</p>
      <p>To test pangolin’s behaviour in response to increasing ambiguity, we took the most complete sequence for every lineage as a representative (<italic toggle="yes">n</italic> = 1,253) and randomly replaced a given percentage of sites (in the range of 1–100 per cent) with N. All simulated sequences with &gt;25 per cent N content failed to map against the reference, so results are shown only for simulated genomes within the range 1–25 per cent (<xref rid="F7" ref-type="fig">Fig. 7A</xref>). This approach tests how pangolin responds to increasing amounts of random missing data. However, in practice, ambiguous or missing sites are often clustered together as amplicon dropouts. Therefore, we subsequently simulated a sliding window of triple amplicon dropouts for each representative genome corresponding to the amplicons formed in the ARTIC primer scheme v3 (<ext-link xlink:href="https://github.com/artic-network/artic-ncov2019" ext-link-type="uri">https://github.com/artic-network/artic-ncov2019</ext-link>; last accessed: 29 June 2021) and ran pangolin v2.3.2 (pangoLEARN release 10 May 2021) on the simulated genomes (<italic toggle="yes">n</italic> = 1,253 X 98 amplicons).</p>
      <fig position="float" id="F7" fig-type="figure">
        <label>Figure 7.</label>
        <caption>
          <p>Performance of pangolin in response to missing data. (A) pangolin assignment accuracy over a gradient of percentage ambiguities. Correct assignments decline with increasing numbers of ambiguous sites, and this initially leads to a greater proportion of genomes assigned to the parent lineage. At greater percentage of ambiguities, minimap2 fails to effectively map against the reference genome and beyond 24 per cent ambiguity all genomes fail to map. (B) Overlapping amplicons generated from the ARTIC ncov2019 primer scheme v3 (98 amplicons across two pools). (C) Pangolin assignments over a sliding window of triple amplicon dropouts coloured by correct lineage assignment, ancestor lineage assigned or incorrect assignment. SARS-CoV-2 genome schema with genome positions and largest genes (ORF1ab, S, M and N) labelled.</p>
        </caption>
        <graphic xlink:href="veab064f7" position="float"/>
      </fig>
      <p>In order to assess how pangolin assigns novel recombinants, we randomly chose 62,650 distinct lineage pairs from a set containing a single representative genome per lineage (<italic toggle="yes">n</italic> = 1,253). From these pairs, we simulated recombination between the pair for positions at 10 per cent intervals across the genome (i.e. positions 2,990, 5,980, 8,970, etc.; <xref rid="F8" ref-type="fig">Fig. 8A</xref>). Each pair was included as the 3ʹ and 5ʹ lineage to ensure that the simulations were symmetrical. We then ran a naive pangoLEARN model (i.e. not trained on the recombinant sequences) on these simulated recombinants (pangolin v2.3.2, pangoLEARN release 10 May 2021).</p>
      <fig position="float" id="F8" fig-type="figure">
        <label>Figure 8.</label>
        <caption>
          <p>The behaviour of pangolin in response to simulated recombinant genomes. (A) Genome graph of SARS-CoV-2. The position of percentage cut-off sites is shown along the top of the graph and nucleotide base position along the bottom. (B) Schema describing the structure of simulated recombinants. Each recombinant is a combination of two distinct lineages in varying proportions. The three example recombinants show a 20 per cent 5ʹ lineage (80 per cent 3ʹ lineage) recombinant, a 50:50 recombinant and an 80 per cent 5ʹ lineage (20 per cent 3ʹ lineage) recombinant. (C) A density curve over the SARS-CoV-2 genome highlighting the relative importance of particular sites within the decision tree. The density is calculated based on the number of rules in the decision tree that include a given site in the genome. (D) The horizontal axis indicates the percentage of the 5ʹ lineage present in a given recombinant genome. Each bar represents 125,300 simulated recombinants. Stacked colours indicate the count of the recombinants that had either the 5ʹ lineage assigned, the 3ʹ lineage assigned, an ancestral lineage assigned, or an incorrect assignment (i.e. a sibling or unrelated lineage).</p>
        </caption>
        <graphic xlink:href="veab064f8" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="s3">
    <label>3.</label>
    <title>Results and discussion</title>
    <p>A comparison of the performance and training time of the three model types used in the various pangoLEARN releases between July and October 2020 is shown in <xref rid="F5" ref-type="fig">Fig. 5</xref>. The statistics shown are based on 10-fold cross-validation. The first model to be used was multinomial logistic regression, which provides no representation of phylogenetic hierarchy. Each possible classification was associated with a collection of SNPs, and these associations alone were used to assign each query sequence a lineage. This relatively simple model offered acceptable accuracy, practically matching the performance of a maximum likelihood phylogenetic inference approach, whilst providing classifications in seconds instead of minutes. An additional benefit of this model was the intuitive interpretability of the regression coefficients, as each represented how strongly associated each individual SNP was with a particular lineage assignment. However, training time for this approach depends on not only the number of parameters, but also on the number of classes and samples. Consequently, training time for this model quickly became unsustainable (<xref rid="F5" ref-type="fig">Fig. 5B</xref>).</p>
    <fig position="float" id="F5" fig-type="figure">
      <label>Figure 5.</label>
      <caption>
        <p>Performance of different pangoLEARN models. (A) Number of genomes submitted to GISAID by the date of model training, and thus number of genomes included in a given model training. (B) Training time (hours) for each model type (logistic regression, random forest, decision tree), tested on SARS-CoV-2 genome data releases from April to October 2020. All models except the multinomial logistic regression scale acceptably with increasing sequence and lineage counts. (C) The average lineage recall rate for each model for each data release. All models performed well, with the random forests each slightly beating the decision trees. (D) The average F1 scores for each of the models for each of the data releases. These scores were closely correlated with the recall rate.</p>
      </caption>
      <graphic xlink:href="veab064f5" position="float"/>
    </fig>
    <p>To better represent the hierarchical nature of the data, we next trailed the decision tree and random forest models. <xref rid="F5" ref-type="fig">Fig. 5</xref> demonstrates the performances of these two model types. For our data sets and problem, the decision tree and the random forest approaches performed similarly. We ultimately adopted the decision tree model because the decisions it makes are more easily interpreted, whereas it is often very difficult to interpret the decisions made within random forests. Because each constituent of a random forest is built using only a subset of the model’s features, each constituent tree is unlikely to resemble the structure of the underlying data. The output of each of these trees is useful only when used together with the rest of the ensemble. In contrast, the decision tree model meaningfully represents the tree structure in a way that can be easily validated. Additionally, we harnessed the tendency of decision trees to overfit in order to make the model more likely to correctly classify smaller lineages whilst another model might overwhelmingly prefer to suggest a larger lineage. If the methods were applied to a virus with more genetic diversity or a different mode of evolution, the relative performances of these methods, and thus our choice of model, may be different. The modularity of our system (<xref rid="F2" ref-type="fig">Fig. 2</xref>) provides a useful level of flexibility: for each lineage release, each model can be re-evaluated and the currently best-performing model can be substituted into the framework.</p>
    <p>As with many tools for genomic epidemiology developed in response to the COVID-19 pandemic, it has been challenging to maintain sufficiently fast computation times in the context of data sets that have grown exponentially in size. Our experience to date suggests that many kinds of ‘flat’ models (those in which the hierarchical structure of the underlying data is ignored) may well be intractable given the hundreds of lineages, thousands of parameters, and hundreds of thousands of genomes available for analysis.</p>
    <sec id="s3-s1">
      <label>3.1</label>
      <title>Limit testing of pangolin</title>
      <p>In order to test how pangolin performs as sequences become increasingly different from the training data, we simulated a distribution of genomes that were up to 10 per cent divergent at the nucleotide level from a representative of each lineage present in the training dataset (<italic toggle="yes">n</italic> = 625,000 simulated genomes from 1,253 lineage representatives). At 100 per cent identity, pangolin correctly assigns 94 per cent of lineages (<xref rid="F6" ref-type="fig">Fig. 6</xref>). Of all simulated genomes, 179,628 genomes were assigned the same lineage as the designation of the genome they had been simulated from (‘correct’ lineage assignment). Of genomes that were not assigned the same lineage as source genome lineage designation, 154,176 genomes were assigned the parent lineage, 3,791 were assigned a descendant ‘child’ lineage of the designated lineage, and 301,435 genomes were assigned an incorrect lineage. <xref rid="F6" ref-type="fig">Fig. 6A</xref> shows that 95 per cent of correct assignments occur when simulated divergence is 98.8 per cent identity or more (i.e. &lt;1.2 per cent divergence from the lineage reference) or 358 nucleotide substitutions across the virus genome. <xref rid="F6" ref-type="fig">Fig. 6B</xref> shows there to be a drop off in accuracy when the pangoLEARN model encounters sequences that are very different from what it has been trained on. We are aware of this decline and to compensate for it and minimise its effects we regularly and frequently train new pangoLEARN models with the latest list of designated sequences.</p>
      <fig position="float" id="F6" fig-type="figure">
        <label>Figure 6.</label>
        <caption>
          <p>Performance of pangolin for genomes with increasing numbers of simulated additional mutations. (A) Boxplot showing the spread of the majority of data, separated by whether the lineage was correctly assigned, assigned an ancestral lineage of the designated lineage, assigned a descendant lineage, or incorrectly assigned. The whiskers define the 5th and 95th percentile range. (B) Proportion of genomes assigned correctly, incorrectly or to an ancestral or descendant (child) lineage, normalised for a given percentage identity.</p>
        </caption>
        <graphic xlink:href="veab064f6" position="float"/>
      </fig>
      <p>We simulated random ambiguities across SARS-CoV-2 coding regions for a set of representative genomes for all lineages (<italic toggle="yes">n</italic> = 1,253). <xref rid="F7" ref-type="fig">Fig. 7A</xref> shows pangolin performs well and is robust to some missing data. As the percentage of ambiguity increases, the number of correct assignments declines; however, the proportion of genomes assigned to parent lineages then increases (this is the designed behaviour of our method). We observe a small increase in incorrect assignments; however, beyond 24 per cent ambiguity, minimap2 fails to map and therefore a lineage cannot be assigned.</p>
      <p>These simulations generate N’s randomly across the coding regions of the virus genome. In practice, we often see clusters of ambiguities that reflect low-coverage regions or amplicon dropouts in the data, inflating the overall ambiguity percentage, but still allowing minimap2 to successfully map the rest of the genome. We tested this case with a sliding window of triple amplicon dropouts across the genome (<xref rid="F7" ref-type="fig">Fig. 7B</xref> shows amplicons corresponding to the ARTIC ncov2019 primer scheme v3 and their genomic location). A total of 126,553 simulated genomes were assigned using pangolin (<xref rid="F7" ref-type="fig">Fig. 7C</xref>). Overall, pangolin is robust to amplicon dropouts; however, there are some key regions that, when missing, lead to a greater proportion of misassignments (either of an ancestral lineage or an incongruous lineage).</p>
      <p>Lastly, we tested pangolin’s behaviour in response to novel recombinant genomes made up of two distinct lineages (<xref rid="F8" ref-type="fig">Fig. 8</xref>). We randomly chose 62,650 distinct lineage pairs from a set of representative genomes (<italic toggle="yes">n</italic> = 1,253) and recombined them in varying proportions at 10 per cent intervals across the length of the genome (<xref rid="F8" ref-type="fig">Fig. 8A, B</xref>). Each lineage of the pair was recombined as the 5ʹ lineage and the 3ʹ lineage to ensure recombination simulations were symmetrical. We ran 1,378,300 tests of pangoLEARN to assess how it responds to novel recombinants. Intuitively, recombinants highly skewed towards one lineage over the other are more likely to get assigned the dominant lineage (e.g. the 10 per cent 5ʹ recombinant; <xref rid="F8" ref-type="fig">Fig. 8D</xref>). As the proportion of the 5ʹ lineage increases, the 5ʹ lineage is more often assigned and the proportion of genomes assigned to an ancestral lineage of the two lineages increases. There is a skew towards assigning the lineage with its 3ʹ end represented, which suggests that there may be features at the 3ʹ end of the genome that may be more informative for lineage assignment. Similar to <xref rid="F7" ref-type="fig">Fig. 7C</xref>, certain key sites at the 3ʹ end of the genome appear to be important for accurate assignments. We investigated this using the decision tree rules output by the pangoLEARN model (<ext-link xlink:href="https://github.com/cov-lineages/pangoLEARN" ext-link-type="uri">https://github.com/cov-lineages/pangoLEARN</ext-link>; last accessed: 29 June 2021) and <xref rid="F8" ref-type="fig">Fig. 8C</xref> shows a density curve reflecting the number of rules within the decision tree model that a given site in the SARS-CoV-2 genome is included in. The large spike towards the 3ʹ end of the genome equates to position 28,882 in the reference genome and is one of the three defining SNPs of the B.1.1 lineage. At present, pangolin cannot detect novel recombinants and can only assign based on previously designated lineages.</p>
    </sec>
    <sec id="s3-s2">
      <label>3.2</label>
      <title>Limitations</title>
      <p>The approach to lineage assignment currently implemented in pangolin provides a responsive, scalable tool. We continue to reflect the latest diversity of SARS-CoV-2 by retraining the pangoLEARN model each week, and this model can assign lineages to the entire GISAID database in a matter of hours. However, our approach has a number of limitations. Unlike phylogenetic assignment, the machine learning approach implemented in pangolin does not natively handle ambiguous data. To allow for nucleotide ambiguities, using an early lineage A reference sequence (accession: EPI_ISL_406801), we impute reference nucleotide states at sites with missing or ambiguous data. However, the reference nucleotide is not equivalent to an N and the consequences of this approach may be to provide more rootward (basal) lineage assignments for sequences with low coverage. As the Pango nomenclature system is hierarchical, a more rootward assignment can be interpreted as a lower resolution (high taxonomic level) classification rather than an incorrect one (i.e. the sequence could belong to the assigned lineage or any of its descendant lineages). As is common practice in machine learning applications, we treat our training data and query data in the same way. To limit how this imputation may affect the training and therefore the model, we do not allow highly ambiguous sequences in the training set (cut-off of 5 per cent ambiguity).</p>
      <p>Another consideration of our approach is that, except for particular lineages of concern, the assignments are largely unsupervised. Decisions are being made internally by the trained model and accurate assignment for a given lineage may rely on one or two key SNPS. This can lead to misassignments when incomplete data are queried with pangolin. For example, a sequence that might rightly belong in lineage B.1.177 but which has Ns in lieu of one or two important SNPs would be in fact assigned to a more basal lineage in the tree, such as B.1. We also commonly observe homoplasies in SARS-CoV-2 genome sequence data, which in combination with other mutations may inform assignment decisions for multiple lineages. Theoretically, if some key sites are missing, there may be identical sequences informing multiple lineages once their unknown values are imputed. To avoid such conflicts in the training data, we have implemented a 5 per cent ambiguity cut-off for the training set (as of Pango designation version 1.2) and any conflicting sequences are identified in a pre-screening process before training, and sequences belonging to a minority lineage are removed.</p>
      <p>A further limitation of our approach is that the quality of the machine learning assignments decline as genetic distance from the training set increases, as described in <xref rid="F6" ref-type="fig">Fig. 6</xref>. This means that the pangoLEARN model depends on regular updates to the list of Pango designated sequences as input. Pango designation has recently become a more formalised process, with the formation of the Pango Network (<ext-link xlink:href="https://www.pango.network/" ext-link-type="uri">https://www.pango.network/</ext-link>; last accessed: 29 June 2021), a team of experts and volunteers from around the world who will work to maintain these lineage designations alongside crowdsourced input through GitHub requests.</p>
    </sec>
    <sec id="s3-s3">
      <label>3.3</label>
      <title>Future directions</title>
      <p>The pangolin tool is being developed as virus transmission and diversification is ongoing and in the context of rapidly growing numbers of SARS-CoV-2 genome sequences. We are exploring and trialling more sophisticated machine learning models, including a hierarchical logistic regression model. The current pangolin model can accept all designated sequences for training, which now comprises &gt;400,000 genome sequences. In the future, it may be necessary to downsample this input. Indeed, as some lineages become unobserved, inactive, and eventually extinct in the global SARS-CoV-2 data set, they can be removed from the training set. Similarly, using a single large global phylogeny may not continue to be practical beyond a million sequences and we may need to consider only more recently sampled genomes, with deeper nodes in the global phylogeny being represented by fewer samples. This approach may have implications for countries not generating or sharing sequence data promptly or if SARS-CoV-2 diversity in some areas of the world has been poorly characterised or unsampled. In this case, we will be able to retrain our models rapidly and incorporate new virus genetic diversity that may come to light in the future. With the current global push towards real-time data generation and sharing and the growing global genomics capacity, these approaches for exceptionally large data sets will be needed.</p>
      <p>Although pangolin is a SARS-CoV-2 lineage assignment tool, the framework it implements could be adapted easily for use in future outbreaks involving another virus. A similar selection process among machine learning models would likely be needed as each virus evolves differently and presents unique analytical challenges. However, the modular toolkit and suite of machine learning models that we have developed and implemented in pangolin will enable it to become a generalised pathogen typing tool. Indeed, for other more established viruses with greater diversity, we predict the pangoLEARN approach would effectively assign virus subtypes.</p>
      <p>Since its initial release, pangolin has provided researchers with the ability to easily compare SARS-CoV-2 sequences and gain information to inform public health decision-making. Using the associated pangolin web-application and command line tools, phylogenetic information from SARS-CoV-2 genomics is readily accessible. Remarkably, almost 2 million unique sequences have been assigned by the pangolin web-application alone to date. By making the code and the lineage assignments openly available, we invite the broader community to contribute to the growing, dynamic list of SARS-CoV-2 lineages.</p>
    </sec>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank users who submitted suggestions on the pangolin GitHub repository, with particular thanks to Torsten Seeman and Art Poon for their comments and feedback. We thank Rob Lanfear for discussions and for maintaining a best practice phylogeny. We would also like to extend our gratitude to all involved in the global SARS-CoV-2 genome sequencing effort and continuing to share data on GISAID (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org/</ext-link>; last accessed: 29 June 2021, <xref rid="R4" ref-type="bibr">Elbe and Buckland-Merrett 2017</xref>), contributing to open science and enabling tools like pangolin to represent the latest diversity of SARS-CoV-2.</p>
  </ack>
  <sec sec-type="data-availability" id="s4">
    <title>Data availability</title>
    <p>pangolin is hosted publically on GitHub and available under a GNU General Public License v3.0. The pangolin web application is available at <ext-link xlink:href="https://pangolin.cog-uk.io/" ext-link-type="uri">https://pangolin.cog-uk.io/</ext-link> (last accessed: 29 June 2021<underline>)</underline>. Daily updated information about all Pango lineages and links to all resources are hosted at <ext-link xlink:href="https://cov-lineages.org/" ext-link-type="uri">https://cov-lineages.org/</ext-link>.</p>
  </sec>
  <sec id="s5">
    <title>Funding</title>
    <p>A.O.T. is supported by the Wellcome Trust Hosts, Pathogens &amp; Global Health Programme [grant number: grant.203783/Z/16/Z] and Fast Grants [award number: 2236]. O.G.P. and L.dP. acknowledge support from the Oxford Martin School. A.R., R.C., and J.T.M. acknowledge support from the Wellcome Trust (Collaborators Award 206298/Z/17/Z ARTIC network). E.C. and A.R. are supported by the European Research Council (grant agreement no. 725422-ReservoirDOCS).</p>
  </sec>
  <sec sec-type="COI-statement" id="s6">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="R1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>De Maio</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) <article-title>Issues with SARS-CoV-2 Sequencing Data Virological</article-title>. &lt;<ext-link xlink:href="https://virological.org/t/issues-with-sars-cov-2-sequencing-data/473" ext-link-type="uri">https://virological.org/t/issues-with-sars-cov-2-sequencing-data/473</ext-link>&gt; accessed<comment>27 Jan 2021</comment>.</mixed-citation>
    </ref>
    <ref id="R2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duchene</surname>
 <given-names>S.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) ‘<article-title>Temporal Signal and the Phylodynamic Threshold of SARS-CoV-2</article-title>’, <source><italic toggle="yes">Virus Evolution</italic></source>, <volume>6</volume>: <page-range>veaa061</page-range>.</mixed-citation>
    </ref>
    <ref id="R3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dudas</surname>
 <given-names>G.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2017</year>) ‘<article-title>Virus Genomes Reveal Factors that Spread and Sustained the Ebola Epidemic</article-title>’, <source><italic toggle="yes">Nature</italic></source>, <volume>544</volume>: <fpage>309</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">28405027</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elbe</surname>
 <given-names>S.</given-names></string-name>, and <string-name><surname>Buckland-Merrett</surname><given-names>G.</given-names></string-name></person-group> (<year>2017</year>) ‘<article-title>Data, Disease and Diplomacy: GISAID’s Innovative Contribution to Global Health</article-title>’, <source><italic toggle="yes">Global Challenges</italic></source>, <volume>1</volume>: <fpage>33</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">31565258</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Faria</surname>
 <given-names>N. R.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2017</year>) ‘<article-title>Establishment and Cryptic Transmission of Zika Virus in Brazil and the Americas</article-title>’, <source><italic toggle="yes">Nature</italic></source>, <volume>546</volume>: <fpage>406</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">28538727</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Jackson</surname>
 <given-names>B.</given-names></string-name>, and <string-name><surname>Colquhoun</surname><given-names>R.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Grapevine</article-title>. &lt;<ext-link xlink:href="https://github.com/COG-UK/grapevine" ext-link-type="uri">https://github.com/COG-UK/grapevine</ext-link>&gt; accessed <comment>29 Jun 2021</comment>.</mixed-citation>
    </ref>
    <ref id="R8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Köster</surname>
 <given-names>J.</given-names></string-name>, and <string-name><surname>Rahmann</surname><given-names>S.</given-names></string-name></person-group> (<year>2012</year>) ‘<article-title>Snakemake—A Scalable Bioinformatics Workflow Engine</article-title>’, <source><italic toggle="yes">Bioinformatics</italic></source>, <volume>28</volume>: <fpage>2520</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lanfear</surname>
 <given-names>R.</given-names></string-name></person-group> (<year>2020</year>) <article-title>A Global Phylogeny of SARS-CoV-2 Sequences from GISAID</article-title>. &lt;<ext-link xlink:href="https://github.com/roblanf/sarscov2phylo" ext-link-type="uri">https://github.com/roblanf/sarscov2phylo</ext-link>&gt; accessed <comment>29 Jun 2021</comment>.</mixed-citation>
    </ref>
    <ref id="R10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>
 <given-names>H.</given-names></string-name></person-group> (<year>2018</year>) ‘<article-title>Minimap2: Pairwise Alignment for Nucleotide Sequences</article-title>’, <source><italic toggle="yes">Bioinformatics</italic></source>, <volume>34</volume>: <fpage>3094</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>
 <given-names>B. Q.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) ‘<article-title>IQ-TREE 2: New Models and Efficient Methods for Phylogenetic Inference in the Genomic Era</article-title>’, <source><italic toggle="yes">Molecular Biology and Evolution</italic></source>, <volume>37</volume>: <fpage>1530</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname>
 <given-names>F.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2011</year>) ‘<article-title>Scikit-learn: Machine Learning in Python</article-title>’, <source><italic toggle="yes">The Journal of Machine Learning Research</italic></source>, <volume>12</volume>: <fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="R13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname>
 <given-names>M. N.</given-names></string-name>, <string-name><surname>Dehal</surname><given-names>P. S.</given-names></string-name>, and <string-name><surname>Arkin</surname><given-names>A. P.</given-names></string-name></person-group> (<year>2010</year>) ‘<article-title>FastTree 2—Approximately Maximum-likelihood Trees for Large Alignments</article-title>’, <source><italic toggle="yes">PLoS One</italic></source>, <volume>5</volume>: <page-range>e9490</page-range>. doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>.</mixed-citation>
    </ref>
    <ref id="R14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rambaut</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2020</year>) ‘<article-title>A Dynamic Nomenclature Proposal for SARS-CoV-2 Lineages to Assist Genomic Epidemiology</article-title>’, <source><italic toggle="yes">Nature Microbiology</italic></source>, <volume>5</volume>: <fpage>1403</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="R15">
      <mixed-citation publication-type="journal">Rambaut, A. <etal>et al.</etal> (<year>2021</year>) ‘<article-title>Addendum: A Dynamic Nomenclature Proposal for SARS-CoV-2 Lineages to Assist Genomic Epidemiology</article-title>’, <source><italic toggle="yes">Nature Microbiology</italic></source>, 6: 415.</mixed-citation>
    </ref>
    <ref id="R16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rota</surname>
 <given-names>P. A.</given-names></string-name></person-group>
 <etal>et al.</etal> (<year>2003</year>) ‘<article-title>Characterization of a Novel Coronavirus Associated with Severe Acute Respiratory Syndrome</article-title>’, <source><italic toggle="yes">Science</italic></source>, <volume>300</volume>: <fpage>1394</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">12730500</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Worobey</surname>
 <given-names>M.</given-names></string-name>, <string-name><surname>Cox</surname><given-names>J.</given-names></string-name>, and <string-name><surname>Gill</surname><given-names>D.</given-names></string-name></person-group> (<year>2019</year>) ‘<article-title>The Origins of the Great Pandemic</article-title>’, <source><italic toggle="yes">Evolution, Medicine and Public Health</italic></source>, <volume>2019</volume>: <fpage>18</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">30805187</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
