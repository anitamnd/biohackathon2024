<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4690251</article-id>
    <article-id pub-id-type="pmid">26703974</article-id>
    <article-id pub-id-type="publisher-id">834</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0834-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MixChIP: a probabilistic method for cell type specific protein-DNA binding analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rautio</surname>
          <given-names>Sini</given-names>
        </name>
        <address>
          <email>sini.rautio@aalto.fi</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lähdesmäki</surname>
          <given-names>Harri</given-names>
        </name>
        <address>
          <email>harri.lahdesmaki@aalto.fi</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000000108389418</institution-id><institution-id institution-id-type="GRID">grid.5373.2</institution-id><institution>Department of Computer Science, </institution><institution>Aalto University, </institution></institution-wrap>Aalto, FI-00076 Finland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>413</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>9</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>11</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Rautio and Lähdesmäki. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Transcription factors (TFs) are proteins that bind to DNA and regulate gene expression. To understand details of gene regulation, characterizing TF binding sites in different cell types, diseases and among individuals is essential. However, sometimes TF binding can only be measured from biological samples that contain multiple cell or tissue types. Sample heterogeneity can have a considerable effect on TF binding site detection. While manual separation techniques can be used to isolate a cell type of interest from heterogeneous samples, such techniques are challenging and can change intra-cellular interactions, including protein-DNA binding. Computational deconvolution methods have emerged as an alternative strategy to study heterogeneous samples and numerous methods have been proposed to analyze gene expression. However, no computational method exists to deconvolve cell type specific TF binding from heterogeneous samples.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a probabilistic method, MixChIP, to identify cell type specific TF binding sites from heterogeneous chromatin immunoprecipitation sequencing (ChIP-seq) data. Our method simultaneously estimates the binding strength in different cell types as well as the proportions of different cell types in each sample when only partial prior information about cell type composition is available. We demonstrate the utility of MixChIP by analyzing ChIP-seq data from two cell lines which we artificially mix to generate (simulated) heterogeneous samples and by analyzing ChIP-seq data from breast cancer patients measuring oestrogen receptor (ER) binding in primary breast cancer tissues. We show that MixChIP is more accurate in detecting TF binding sites from multiple heterogeneous ChIP-seq samples than the standard methods which do not account for sample heterogeneity.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Our results show that MixChIP can estimate cell-type proportions and identify cell type specific TF binding sites from heterogeneous ChIP-seq samples. Thus, MixChIP can be an invaluable tool in analyzing heterogeneous ChIP-seq samples, such as those originating from cancer studies. R implementation is available at <ext-link ext-link-type="uri" xlink:href="http://research.ics.aalto.fi/csb/software/mixchip/">http://research.ics.aalto.fi/csb/software/mixchip/</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0834-3) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Tumor heterogeneity</kwd>
      <kwd>Deconvolution</kwd>
      <kwd>ChIP-seq</kwd>
      <kwd>Transcription factor binding sites</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Transcription factors are DNA-binding proteins that regulate expression of neighboring or distal genes. Most of the TFs bind only a small proportion of potential genomic sites as defined by their DNA binding domains [<xref ref-type="bibr" rid="CR1">1</xref>]. Detailed mapping of TF binding in different cell types, conditions, diseases and among individuals is central for understanding transcriptional regulation. Three factors contribute to TF binding: sequence preference of a TF, local chromatin context, and TF coactivators and repressors [<xref ref-type="bibr" rid="CR2">2</xref>]. Furthermore, TFs often bind to distinct subsets of potential binding sites in different cell types which results in variation in gene regulation. As an example, it is shown that on average one third of measured TF binding sites overlap between the cell lines K562 and HelaS3 [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p>In some applications, DNA-protein interactions are measured from biological samples that contain multiple cell or tissue types. Sample heterogeneity is a major confounding factor e.g. in clinical studies [<xref ref-type="bibr" rid="CR3">3</xref>] and it can have a significant effect in TF binding profiling and it limits the conclusions that can be made about binding specificity [<xref ref-type="bibr" rid="CR4">4</xref>]. For instance, tumor biopsy sample taken from a patient often contains unknown proportions of normal or other infiltrating cells [<xref ref-type="bibr" rid="CR5">5</xref>]. This is problematic especially if the heterogeneous tumor sample is compared to a healthy sample or to another heterogeneous tumor sample with different proportions of contaminating cell types. As an example, different subtypes of breast cancer can be defined based on their gene expression characteristics. One of the identified subtypes is a normal-like subtype which has similar expression pattern to normal breast tissue. Nevertheless, it is argued that a normal-like subtype is only an artifact resulting from contamination of samples with normal breast tissue [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>Manual cell separation techniques, such as cell sorting, enrichment and laser-capture microdissection can be used to isolate cell types of interest from complex tissue samples, but are expensive, time-consuming and may affect cell physiology and important interactions between different cell types [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. Computational deconvolution methods have emerged as an alternative to solve these problems. <italic>In silico</italic> purification allows us to process data that are measured from a mixture of several cell types by performing computational deconvolution after measuring the samples. Previously, many <italic>in silico</italic> purification methods have been published for gene expression [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR15">15</xref>] and DNA methylation data [<xref ref-type="bibr" rid="CR5">5</xref>]. To our knowledge, however, there is no method to estimate cell type specific TF binding sites and cell type proportions using ChIP-seq data from heterogeneous samples.</p>
    <p>The ChIP-seq protocol produces short sequence reads of genomic DNA that are enriched for a target of interest (here binding sites of a TF). After mapping the sequence reads to a reference genome the main analysis task is to identify TF binding sites by selecting regions with significantly large numbers of mapped reads [<xref ref-type="bibr" rid="CR16">16</xref>]. However, it is now known that regions with high read counts do not necessarily correspond to real binding sites as read counts are affected by many biases, such as local GC content, mappability, chromatin structure and copy number variation [<xref ref-type="bibr" rid="CR17">17</xref>]. If matching input control samples exist, such as samples generated from genomic DNA (without immunoprecipitation) or by using non-specific antibody, they can be used to estimate local background biases [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p>Given that it is important to study heterogeneous samples and knowing the aforementioned challenges and limitations, we introduce a probabilistic method for identifying cell type specific binding sites from heterogeneous ChIP-seq samples.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data</title>
      <sec id="Sec4">
        <title>In silico simulated data</title>
        <p>We used publicly available ChIP-seq data from The Encyclopedia of DNA Elements (ENCODE) project [<xref ref-type="bibr" rid="CR19">19</xref>] to demonstrate the proof-of-principle of our method. We simulated <italic>in silico</italic> a mixture of ChIP-seq data measuring JUND binding in two different cell lines, HepG2 and K562. Each heterogeneous sample was generated by taking, with a fixed ratio, randomly subsampled sequence reads from HepG2 and K562 samples. The selected mixture ratios of the two cell lines were 10:90, 20:80, 50:50, 80:20 and 90:10 <italic>%</italic>. For instance, a sample with ratio 20:80 <italic>%</italic> has 20 <italic>%</italic> of the total reads from HepG2 sample and 80 <italic>%</italic> of the total reads from K562 sample. All in all, we simulated three samples with each mixture proportion totaling 15 samples altogether. For each simulated mixture sample, the corresponding input control with the same mixture ratio was simulated using rabbit IgG control from the same HepG2 and K562 cell lines. All the generated ChIP samples had around 21 million aligned reads whereas input control samples had approximately 48 million aligned reads. Samples and their matching input controls are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
        <p>All simulated mixture samples were mapped to hg19 genome using Bowtie [<xref ref-type="bibr" rid="CR20">20</xref>]. Fragment sizes were estimated with spp software using cross-correlation of positive and negative strand tag densities [<xref ref-type="bibr" rid="CR21">21</xref>]. Next, reads were shifted according the fragment size estimates, clonal reads were removed and reads mapping to each candidate binding sites were calculated using a custom python script with HTSeq [<xref ref-type="bibr" rid="CR22">22</xref>]. For validation purposes, true cell type specific JUND binding sites in HepG2 and K562 cell lines were detected from the original pure samples using MACS [<xref ref-type="bibr" rid="CR18">18</xref>] with a stringent <italic>p</italic>-value &lt;10<sup>−7</sup>. To validate the usefulness of the model 10, 000 binding sites that were found in HepG2 cell line but not in K562 were selected to represent a set of true JUND binding sites in HepG2. Similarly, the same amount of binding sites detected only in K562 cell line were selected as true JUND binding sites in K562. In addition, we selected 3160 random genomic loci which did not overlap with any of the detected JUND binding sites in the two cell lines and had on average at least three aligned reads. Thus, altogether 23, 160 candidate binding sites were used in our analysis. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the simulated heterogeneous ChIP-seq signal at selected candidate binding sites.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Read coverage at four representative JUND binding sites in the simulated heterogeneous samples. Signals are shown as counts per 10 million reads. The first and third columns show two binding sites where JUND is bound in HepG2 cell line but not in K562. The binding sites in the second and fourth column are JUND binding site in K562 cell line but not in HepG2. The proportions of the two cell lines in each sample are depicted on right</p></caption><graphic xlink:href="12859_2015_834_Fig1_HTML" id="MO1"/></fig>
</p>
      </sec>
      <sec id="Sec5">
        <title>Oestrogen binding data</title>
        <p>We also applied our method to the breast cancer data from Ross-Innes <italic>et al.</italic> [<xref ref-type="bibr" rid="CR23">23</xref>]. The data set consists of measurements of oestrogen receptor- <italic>α</italic> (ER) binding in primary breast cancer tissues and metastases. Patients were further classified in good outcome and poor outcome groups based on the tumour type. We decided to select the samples from the good outcome group patients because data from these patients correlate better with each other compared to the data from poor outcome group patients. Each patient sample has also a corresponding genomic DNA sample, which we used in the model as input controls. Samples together with their corresponding input controls and GEO accession names are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2.</p>
        <p>We used altogether four samples (G5.1, G5.2, G7, G8) in our model to estimate breast cancer tissue specific ER binding sites. These samples had estimated breast cancer cell percentages of 90, 90, 70 and 70 <italic>%</italic>. Since the ground truth of ER binding in primary breast cancer tissue is not known we used the remaining four samples to define a set of true (or most likely) binding sites. A genomic locus was considered as a true binding site if it was detected as a peak in all of the four samples G1, G2, G4 and G6. The peak calling was performed using MACS [<xref ref-type="bibr" rid="CR18">18</xref>] with the default <italic>p</italic>-value threshold of 10<sup>−5</sup>. As a result, altogether 678 regions were selected as true binding sites. The negative set was constructed by taking random regions in the genome and discarding those which overlapped with the detected peaks from the four individual samples (G1, G2, G4 and G6) and those which had on average less than 15 reads mapped to that region, resulting in 293 loci in the negative set. Three illustrative examples of strong binding sites in the four samples used for the modeling are shown in Fig <xref rid="Fig2" ref-type="fig">2</xref>. Data were preprocessed in the same way as the ENCODE data set. The samples used for modeling and the <italic>a priori</italic> assumed proportions of breast cancer tissue in each sample are shown in Table <xref rid="Tab1" ref-type="table">1</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Illustrative ER binding sites in four samples used for the modeling: G5.1, G5.2, G7, and G8. Signals are shown as counts per 10 million reads</p></caption><graphic xlink:href="12859_2015_834_Fig2_HTML" id="MO2"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Sample list in the ER data set shown together with their <italic>a priori</italic> assumed tumor proportions and the number of aligned reads. Four of the samples were used in the heterogeneity modeling and rest of the samples were used to determine a set of high quality binding sites for validation purposes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Sample</th><th align="left">Tumor percentage</th><th align="left">Aligned Reads</th><th align="left">Used in model</th></tr></thead><tbody><tr><td align="left">G1</td><td align="left">&gt; 70 %</td><td align="left">12311074</td><td align="left">–</td></tr><tr><td align="left">G2</td><td align="left">&gt; 70 %</td><td align="left">17696624</td><td align="left">–</td></tr><tr><td align="left">G4</td><td align="left">N/A</td><td align="left">14568154</td><td align="left">–</td></tr><tr><td align="left">G5.1</td><td align="left">90 %</td><td align="left">7887177</td><td align="left">X</td></tr><tr><td align="left">G5.2</td><td align="left">90 %</td><td align="left">16055168</td><td align="left">X</td></tr><tr><td align="left">G6</td><td align="left">100 %</td><td align="left">13429725</td><td align="left">–</td></tr><tr><td align="left">G7</td><td align="left">70 %</td><td align="left">22747279</td><td align="left">X</td></tr><tr><td align="left">G8</td><td align="left">70 %</td><td align="left">20227148</td><td align="left">X</td></tr></tbody></table></table-wrap>
</p>
      </sec>
    </sec>
    <sec id="Sec6">
      <title>Model</title>
      <p>ChIP-seq data is commonly assumed to follow Poisson distribution [<xref ref-type="bibr" rid="CR18">18</xref>]. An advantage of the Poisson distribution is that it has a single parameter <italic>λ</italic> which is equal to the mean and the variance of the distribution. To capture local biases in data along the genome, one of the most popular ChIP-seq peak finding algorithms, MACS [<xref ref-type="bibr" rid="CR18">18</xref>], uses a dynamic Poisson distribution to model a local background. First, it uses a sliding window to find candidate binding regions that show enrichment of mapped sequencing reads relative to a local background model, and if enriched regions are overlapping, they are merged. The candidate sites are tested against a local background using a Poisson test, where the mean and the variance of the Poisson distribution are estimated from the global average of read counts or average read count in 1, 5 and 10 kb windows in the input control samples centred at the peak locations. We will build our cell type specific binding analysis tool on the aforementioned assumptions.</p>
      <p>We denote the binding affinity measurement, i.e. read count, of a protein in heterogeneous sample <italic>j</italic>=1,…,<italic>J</italic> and in genomic location <italic>i</italic>=1,…,<italic>I</italic> as <italic>y</italic>
<sub><italic>ij</italic></sub>. Candidate binding sites <italic>i</italic> which are used in our model are pre-selected; they can be for example any sites that show weak enrichment at least in one of the heterogeneous samples. The read count data across all sites and samples is denoted collectively as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {D}$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">D</mml:mi></mml:math><inline-graphic xlink:href="12859_2015_834_IEq1.gif"/></alternatives></inline-formula>. Cell type specific binding affinities in locus <italic>i</italic> for cell type <italic>t</italic>=1,…,<italic>T</italic> are denoted as <bold>x</bold>
<sub><italic>i</italic></sub>=(<italic>x</italic>
<sub><italic>i</italic>1</sub>,<italic>x</italic>
<sub><italic>i</italic>2</sub>,…,<italic>x</italic>
<sub><italic>iT</italic></sub>) and cell type proportions in a sample <italic>j</italic> as <bold>p</bold>
<sub><italic>j</italic></sub>=(<italic>p</italic>
<sub><italic>j</italic>1</sub>,<italic>p</italic>
<sub><italic>j</italic>2</sub>,…,<italic>p</italic>
<sub><italic>jT</italic></sub>). Binding affinity measurement from a heterogeneous sample, <italic>y</italic>
<sub><italic>ij</italic></sub>, is assumed to be Poisson distributed with a local parameter <italic>λ</italic>
<sub><italic>ij</italic></sub>. The mean parameter <italic>λ</italic>
<sub><italic>ij</italic></sub> is a weighted average of the cell type specific binding affinities, where the weights are the cell type proportions <bold>p</bold>
<sub><italic>j</italic></sub> and <italic>s</italic>
<sub><italic>j</italic></sub>, the scaling parameter for different sequencing depths of each sample
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ f(y_{ij}| \mathbf{p}_{j},\mathbf{x}_{i}, s_{j}) = \text{Poisson}\left(y_{ij}| \lambda_{ij}=s_{j} \sum\limits_{t} p_{jt} x_{it}\right).  $$ \end{document}</tex-math><mml:math id="M4"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jt</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2015_834_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>We assume the read counts in each candidate binding site <italic>i</italic> and sample <italic>j</italic> to be conditionally independent given the parameters; thus, the likelihood of the data can be written as
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ f(\mathcal{D}| \mathbf{p}, \mathbf{x})=\prod\limits_{i} \prod\limits_{j} f\left(y_{ij}| \mathbf{p}_{j},\mathbf{x}_{i}, s_{j}\right),  $$ \end{document}</tex-math><mml:math id="M6"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">D</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2015_834_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <bold>p</bold> and <bold>x</bold> denote all the unknowns
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {}\mathbf{p}= \left(\begin{array}{cccc} p_{11} &amp; p_{12} &amp; \cdots &amp; p_{1T} \\ p_{21} &amp; p_{22} &amp; \cdots &amp; p_{2T} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ p_{J1} &amp; p_{J2} &amp; \cdots &amp; p_{JT} \end{array} \right), \mathbf{x}= \left(\begin{array}{cccc} x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1T} \\ x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2T} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ x_{I1} &amp; x_{I2} &amp; \cdots &amp; x_{IT} \end{array} \right).  $$ \end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="bold">p</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">JT</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IT</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2015_834_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>We place a Dirichlet distribution as the prior for cell type proportions in sample <italic>j</italic>, <bold>p</bold>
<sub><italic>j</italic></sub>∼Dirichlet(<italic>α</italic>
<sub><italic>j</italic></sub>=<italic>w</italic>
<sub>0</sub>
<bold>p</bold>
<sub>0<italic>j</italic></sub>). Vector <bold>p</bold>
<sub>0<italic>j</italic></sub> denotes the location of the distribution which can be thought of as the user’s prior information of the true cell type proportions in sample <italic>j</italic>, and <italic>w</italic>
<sub>0</sub> quantifies the variance of the prior which can be set based on how much the prior information is trusted. Naturally, cell type proportions in sample <italic>j</italic>, <bold>p</bold>
<sub><italic>j</italic></sub>, as well as prior parameter <bold>p</bold>
<sub>0<italic>j</italic></sub> sum up to one, i.e. <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{t} p_{\textit {jt}}=1$\end{document}</tex-math><mml:math id="M10"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jt</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_834_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{t} p_{0jt}=1$\end{document}</tex-math><mml:math id="M12"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mtext mathvariant="italic">jt</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_834_IEq3.gif"/></alternatives></inline-formula>. This makes the Dirichlet distribution a natural choice but other priors can be used as well. We set uninformative uniform priors for the unknown cell type specific binding affinities, i.e., <italic>x</italic>
<sub><italic>it</italic></sub>∼Uniform(<italic>a</italic>,<italic>b</italic>), where <italic>a</italic> defines the lower and <italic>b</italic> the upper bound.</p>
      <p>Given the read count data <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {D}$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="script">D</mml:mi></mml:math><inline-graphic xlink:href="12859_2015_834_IEq4.gif"/></alternatives></inline-formula> and hyperparameters <italic>ϕ</italic>, our model defines a posterior distribution for the unknown parameters
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} f(\mathbf{x}, \mathbf{p} | \mathcal{D}, \phi) &amp; \propto &amp; \left(\prod\limits_{j} f(\mathbf{p}_{j} | \alpha_{j}) \right) \left(\prod\limits_{i} \prod\limits_{t} f\left(x_{it} | a,b\right) \right) \times  \\ &amp; &amp; \left(\prod\limits_{i} \prod\limits_{j} f\left(y_{ij}|s_{j} \sum\limits_{t} p_{jt} x_{it}\right) \right). \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">D</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∝</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>×</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jt</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd><mml:mtd><mml:mtext/><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_834_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>We use maximum a posteriori (MAP) estimation to find the cell type specific binding affinities <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathbf {x}}$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_834_IEq5.gif"/></alternatives></inline-formula> and cell type proportions <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathbf {p}}$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_834_IEq6.gif"/></alternatives></inline-formula>. Optimization of the posterior function is performed using the limited-memory modification of the Broyden-Fletcher-Goldfarb-Shanno quasi-Newton method with box constrains (L-BFGS-B) [<xref ref-type="bibr" rid="CR24">24</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for partial derivatives of the log posterior). The optimization is performed 10 times with different initial points to avoid local optima.</p>
      <p>Local biases can vary between cell types, samples and even replicates. Consequently, it is important to have a matching input control sample for each ChIP sample, such as genomic DNA sample or sample with non-specific antibody [<xref ref-type="bibr" rid="CR17">17</xref>]. Input controls can contain binding site signals because TF binding sites are usually located in regions of open chromatin where fragmentation is more efficient [<xref ref-type="bibr" rid="CR25">25</xref>]. However, our analysis suggests that input control samples contain only little or no information about the cell type proportions. Usually, the matching input control comes from the same biological source as the ChIP sample. Therefore, we assume that the matching input control sample has the same cell type proportions as the ChIP sample and decided to estimate cell type proportions, <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathbf {p}}$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_834_IEq7.gif"/></alternatives></inline-formula>, using only the ChIP samples. In other words, the cell type proportions <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathbf {p}}$\end{document}</tex-math><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_834_IEq8.gif"/></alternatives></inline-formula>, estimated from the ChIP samples, are used for each of the loci in the matching input control samples. The input control signal is modeled using three different windows, similar to MACS peak finding algorithm; 1000, 5000 and 10000 base pairs around the candidate binding site. Thus, given data from the input control samples, <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {D}^{c}$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq9.gif"/></alternatives></inline-formula>, the posterior of cell type specific reads counts, <bold>x</bold>
<sup><italic>c</italic></sup>, becomes
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  f(\mathbf{x^{c}} | \mathcal{D}^{c}, \tilde{\mathbf{p}}, \phi) &amp; \propto &amp;\left(\prod\limits_{i} \prod\limits_{t} \prod\limits_{r} f\left(x_{itr}^{c} | a, b\right) \right)  \\ &amp;&amp;\times\!\left(\!\prod\limits_{i} \!\prod\limits_{j}\! \prod\limits_{r} f\!\left(y^{c}_{ijr}|{s^{c}_{j}} \sum\limits_{t} \tilde{p}_{jt} x^{c}_{itr}\right)\! \right)\!, \end{array} $$ \end{document}</tex-math><mml:math id="M28"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mspace width="-15.0pt"/><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:mstyle><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∝</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">itr</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>×</mml:mo><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijr</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jt</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">itr</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced><mml:mspace width="0.3em"/><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_834_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <italic>r</italic>∈{1<italic>k</italic>,5<italic>k</italic>,10<italic>k</italic>} denotes different window sizes around each genomic loci <italic>i</italic>, <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$y^{c}_{\textit {ijr}}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijr</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq10.gif"/></alternatives></inline-formula> is the read count in heterogeneous input control sample <italic>j</italic>=1,…,<italic>J</italic> in genomic location <italic>i</italic>=1,…,<italic>I</italic> and window size <italic>r</italic> (<inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{\textit {itr}}^{c}$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">itr</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq11.gif"/></alternatives></inline-formula> is defined similarly), and superscript <italic>c</italic> denotes the input control samples. As above, we estimate the cell type specific input control signals in the three windows by maximizing the posterior in Eq. (<xref rid="Equ5" ref-type="">5</xref>) with respect to <bold>x</bold>
<sup><italic>c</italic></sup> using L-BFGS-B.</p>
      <p>Once the cell type specific binding affinities <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathbf {x}}$\end{document}</tex-math><mml:math id="M34"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_834_IEq12.gif"/></alternatives></inline-formula> and input control signals <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathbf {x}}^{c}$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq13.gif"/></alternatives></inline-formula> are estimated, we would like to test for significance of cell type specific binding. We decided to formulate a MACS-like significance test, which uses a dynamic Poisson distribution. In particular, under the null hypothesis of no binding site, the dynamic <italic>λ</italic> parameter in the Poisson distribution for cell type <italic>t</italic> in loci <italic>i</italic> is estimated from the cell type specific signals in the input control, <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {x}^{c}_{it[1k]}$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq14.gif"/></alternatives></inline-formula>, <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {x}^{c}_{it[5k]}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext><mml:mo>[</mml:mo><mml:mn>5</mml:mn><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {x}^{c}_{it[10k]}$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext><mml:mo>[</mml:mo><mml:mn>10</mml:mn><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq16.gif"/></alternatives></inline-formula> or from global average of read counts
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \tilde{\lambda}_{it}=l_{i} S \max \left(\frac{\tilde{x}^{c}_{it[1k]}}{1000}, \frac{\tilde{x}^{c}_{it[5k]}}{5000}, \frac{\tilde{x}^{c}_{it[10k]}}{10000}, \frac{R^{c}_{global}}{G} \right),  $$ \end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:mn>1000</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext><mml:mo>[</mml:mo><mml:mn>5</mml:mn><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:mn>5000</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext><mml:mo>[</mml:mo><mml:mn>10</mml:mn><mml:mi>k</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:mn>10000</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">global</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2015_834_Equ6.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <italic>l</italic>
<sub><italic>i</italic></sub> is the width of the candidate binding site <italic>i</italic> in base pairs in the ChIP sample, <italic>S</italic> is a scaling factor to normalize the sequencing depths between the ChIP and input control sample, <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$R^{c}_{\textit {global}}$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">global</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_834_IEq17.gif"/></alternatives></inline-formula> is the total number of reads in input control experiment and <italic>G</italic> is the size of the genome. As in MACS method, the <italic>p</italic>-value of each <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {x}_{\textit {it}}$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_834_IEq18.gif"/></alternatives></inline-formula> is computed relative to a dynamic Poisson distribution with parameter <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\lambda }_{\textit {it}}$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">it</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_834_IEq19.gif"/></alternatives></inline-formula>. The whole analysis workflow of the algorithm is illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Analysis workflow of the MixChIP method. First, the cell type proportions in each ChIP sample and cell type specific signal are estimated. Second, the estimated proportions are used to deconvolve the signal in the input control samples using three different regions around the candidate binding site regions</p></caption><graphic xlink:href="12859_2015_834_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>Computational time depends on the number of sites and samples. To perform optimization 10 times for the simulated data with 8 samples and 23, 160 candidate binding sites takes around 3 h on a standard desktop computer. For breast cancer data set with four samples and 971 candidate binding sites the running time is approximately 2 min.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="results">
    <title>Results</title>
    <sec id="Sec8">
      <title>In silico simulated data</title>
      <sec id="Sec9">
        <title>Cell type specific binding</title>
        <p>We estimated cell type specific binding affinity and input control signals in HepG2 and K252 cell lines from eight heterogeneous samples using our model and evaluated statistical significance of the cell type specific binding sites using the dynamic Poisson null model. Hyperparameters were set to values: <italic>w</italic>
<sub>0</sub>=4, <italic>a</italic>=0.01, <italic>b</italic>=10000, and <bold>p</bold>
<sub>0</sub>=(0.1,0.1,0.2,0.2,0.8,0.8,0.9,0.9) which corresponds to the true cell type proportions or <bold>p</bold>
<sub>0</sub>=(0.05,0.2,0.4,0.35,0.8,0.5,0.6,0.7) to show that the method works also when the prior information is not accurate. Accuracy of the cell type specific binding analysis is evaluated using the receiver operating characteristic (ROC) curve, where the binding sites obtained from the pure samples with a stringent <italic>p</italic>-value of &lt;10<sup>−7</sup> are considered as true binding sites. Because no other computational methods have yet been proposed for cell type specific binding analysis, performance of our probabilistic model is compared to the traditional way of identifying binding sites using multiple samples. First, Poisson test for the read counts (i.e., MACS type of analysis) was performed in each genomic locus in each heterogeneous sample. For each region <italic>i</italic>, the <italic>p</italic>-values were combined by taking the maximum of all individual <italic>p</italic>-values. This corresponds to a test with a null hypothesis that at least one separate null hypothesis is true and the alternative hypothesis that all the alternative hypotheses are true. Computing the maximum of individual <italic>p</italic>-values also corresponds to a commonly used approach where binding sites are defined to be those which are found in all the samples.</p>
        <p>The prediction performance in both of the cell lines is shown in Figs. <xref rid="Fig4" ref-type="fig">4</xref>(<xref rid="Fig4" ref-type="fig">a</xref>–<xref rid="Fig4" ref-type="fig">b</xref>). The detection of JUND binding sites in both of the cells lines is highly specific and sensitive. We also predicted the binding sites in a similar way using all 15 samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1(a–b)). Figs. <xref rid="Fig4" ref-type="fig">4</xref>(<xref rid="Fig4" ref-type="fig">a</xref>–<xref rid="Fig4" ref-type="fig">b</xref>) and S1(a–b) also show the prediction performance of the traditional maximum <italic>p</italic>-value method. Consistent with the fact that the traditional method is not able to handle sample heterogeneity, we observed that inclusion of samples which have 50 <italic>%</italic> purity decreased its performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 (c–d)), and accuracy decreased even further if we include all 15 samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 (e–f)). Consequently, in order to achieve best possible results for the maximum <italic>p</italic>-value method in Figs. <xref rid="Fig4" ref-type="fig">4</xref>(<xref rid="Fig4" ref-type="fig">a</xref>–<xref rid="Fig4" ref-type="fig">b</xref>) and S1(a–b), we considered only samples which had more than 50 <italic>%</italic> of the cell line of interest when applying the maximum <italic>p</italic>-value method. Overall, our results using simulated heterogeneous ChIP-seq data sets demonstrate that explicitly modeling sample heterogeneity can significantly improve accuracy of binding site detection.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Estimating cell type specific binding affinity and input control signal improves TF binding predictions in the cell types of the interest when compared to the traditional approach where sample heterogeneity is not corrected for. ROC curve of JUND binding predictions for MixChIP (black curve) and combining <italic>p</italic>-values of individual samples by taking the maximum of <italic>p</italic>-values (orange curve) in (<bold>a</bold>) HepG2 and (<bold>b</bold>) K562 cell lines. <bold>c</bold> Estimated proportions (grey dots) of HepG2 cells when true proportions are used as an informative prior (orange dots). <bold>d</bold>–<bold>f</bold> ROCs and the estimated proportions as in (a-c) when priors are intentionally set to differ from the true proportions</p></caption><graphic xlink:href="12859_2015_834_Fig4_HTML" id="MO4"/></fig>
</p>
      </sec>
      <sec id="Sec10">
        <title>Cell type proportions</title>
        <p>We tested how sensitive our method is to the choice of prior for cell type proportions <bold>p</bold>. Figs. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">c</xref>) and <xref rid="Fig4" ref-type="fig">4</xref>f) show the estimated cell type proportions with different hyperparameter values <bold>p</bold>
<sub>0<italic>j</italic></sub> but with the same sharpness parameter <italic>w</italic>
<sub>0</sub>=4. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">c</xref>) the prior means are set exactly to the same locations as the true proportions of the cell types, whereas in Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">f</xref>) prior means are set so that they contain inaccurate information about the proportions. The estimated proportions are close to the true proportions in Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">c</xref>) as expected. However, Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">f</xref>) shows that the probabilistic method is able to infer the cell type proportions from the data, despite the inaccurate information encoded in the prior. Furthermore, using either accurate or inaccurate prior proportions give at the end similar MAP estimates for the cell type proportions as well as for binding affinities, thus resulting in very similar accuracy in binding site detection (compare Figs. <xref rid="Fig4" ref-type="fig">4</xref> (<xref rid="Fig4" ref-type="fig">a</xref>–<xref rid="Fig4" ref-type="fig">b</xref>) with (<xref rid="Fig4" ref-type="fig">d</xref>–<xref rid="Fig4" ref-type="fig">e</xref>)). We also tested more systematically how different prior information affects the estimated cell type proportions. For a fixed prior sharpness parameter <italic>w</italic>
<sub>0</sub>=4, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 shows the mean squared error (MSE) between true cell type proportions and initial prior means against MSE between true and estimated proportions. It can be seen that MSE of the estimated values is only a fraction of MSE of initial values. Moreover, different values for the sharpness parameter <italic>w</italic>
<sub>0</sub> did not affect prediction performance either (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Taken together, MixChIP’s performance is not sensitive to small fluctuations in the prior cell type proportions.</p>
      </sec>
      <sec id="Sec11">
        <title>Effect of the sample size and number of candidate binding sites on binding site identification</title>
        <p>Next, we checked how the sample size affects the prediction performance. We identified binding sites using 3, 5, 8, 10 and 15 heterogeneous samples. The mixture proportions of the samples that were used with different sample sizes are shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Again, when applying the maximum <italic>p</italic>-value method, we only used samples which had more than 50 <italic>%</italic> of the cell line where the binding was evaluated. Area under the curve (AUC) values for different sample sizes are shown in Figs. <xref rid="Fig5" ref-type="fig">5</xref>(<xref rid="Fig5" ref-type="fig">a</xref>–<xref rid="Fig5" ref-type="fig">b</xref>). As sample size increases the prediction performance of the model also increases. However, with only three samples, AUC values in HepG2 and K562 cell lines are as high as 0.95 and 0.98, respectively. The accuracy of the maximum <italic>p</italic>-value method depends more strongly on the sample size and performance is considerably worse on small sample size. Finally, we applied MixChIP to different numbers of candidate binding sites to show that even with only 100 candidate sites, high accuracy can be achieved (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Collectively, our probabilistic model improves binding site detection for all samples sizes and, importantly, performs well also for small number of samples or candidate binding sites.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Sample size has only a minor effect for prediction performance. AUC values with different sample sizes using MixChIP (black line) and taking the the maximum of individual <italic>p</italic>-values (orange line) in (<bold>a</bold>) HepG2 and (<bold>b</bold>) K562 cell lines</p></caption><graphic xlink:href="12859_2015_834_Fig5_HTML" id="MO5"/></fig>
<fig id="Fig6"><label>Fig. 6</label><caption><p>The number of candidate binding sites has a small effect on binding site predictions. AUC values with different number of candidate binding sites for HepG2 (<bold>a</bold>) and K562 (<bold>b</bold>). A subset of candidate binding sites was randomly sampled from the original set of sites and this was repeated 20 times for each subset size. Black line shows the median AUC value among the 20 subsets and grey shaded area shows the 25 and 75 <italic>%</italic> quantiles</p></caption><graphic xlink:href="12859_2015_834_Fig6_HTML" id="MO6"/></fig>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Mixture ratios of HepG2 and K562 cells in samples which were used to test the effect of the sample size</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Sample size</th><th align="left">Samples</th></tr></thead><tbody><tr><td align="left">10</td><td align="left">10:90 %, 10:90 %, 20:80 %, 20:80 %, 50:50 %, 50:50 %, 80:20 %, 80:20 %, 90:10 %, 90:10 %</td></tr><tr><td align="left">8</td><td align="left">10:90 %, 10:90 %, 20:80 %, 20:80 %, 80:20 %, 80:20 %, 90:10 %, 90:10 %</td></tr><tr><td align="left">5</td><td align="left">10:90 %, 20:80 %, 50:50 %, 80:20 %, 90:10 %</td></tr><tr><td align="left">3</td><td align="left">20:80 %, 50:50 %, 80:20 %</td></tr></tbody></table></table-wrap>
</p>
      </sec>
      <sec id="Sec12">
        <title>Effect of the binding strength</title>
        <p>Sometimes the ChIP signal strength between different cell types varies, meaning that on average the binding sites are weaker in one cell type compared to another. This kind of variation can be caused e.g. by altered expression level of the protein of interest and that can affect the cell type specific binding site analysis, especially if the weaker expression and binding sites are in the cell type of interest. To demonstrate this we used ENCODE ChIP-seq data of IRF3 binding in HepG2 and HeLaS3 cell lines. We selected 1248 binding sites in HepG2 cell line and 1300 binding sites in HeLaS3 cell line as true binding sites for the two different cell types and an additional 110 random genomic loci which did not overlap with any of the detected IRF3 binding sites in the two cell lines. The data was preprocessed similarly as the JUND data set. The overall binding strength is stronger in HeLaS3 compared to HepG2 cell line (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Consequently, traditional methods which cannot account for sample heterogeneity primarily detect ChIP-seq signal which originates from the HeLaS3 cell line and, therefore, completely fail to predict IRF3 binding sites in HepG2 (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). On the other hand, our probabilistic method is able to account for the sample heterogeneity despite a major difference in the binding signal strength. A small artifact is also seen in the AUC results for the probabilistic model for HepG2 cell line (Fig. <xref rid="Fig7" ref-type="fig">7</xref>
<xref rid="Fig7" ref-type="fig">a</xref>)) as the modeling method incorrectly predicts binding sites in both HepG2 and HelaS3 even though IRF3 is bound to these sites only in HelaS3 cell line.
<fig id="Fig7"><label>Fig. 7</label><caption><p>A significant difference in the binding affinity between the cell types can affect the binding prediction accuracy. ROC curve of IRF3 binding predictions in cell lines (<bold>a</bold>) HepG2, (<bold>b</bold>) HeLaS3 and estimated cell type proportions (<bold>c</bold>)</p></caption><graphic xlink:href="12859_2015_834_Fig7_HTML" id="MO7"/></fig>
</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Oestrogen receptor- <italic>α</italic> binding data</title>
      <sec id="Sec14">
        <title>Cell type specific binding</title>
        <p>When detecting ER binding sites using the probabilistic model the hyperparameters were set to the same values as previously with ENCODE data sets. The prediction performance for breast cancer cell specific binding sites is shown as a ROC curve in Fig. <xref rid="Fig8" ref-type="fig">8</xref>
<xref rid="Fig8" ref-type="fig">a</xref>). Again, the performance of MixChIP is compared against the maximum <italic>p</italic>-value method. The probabilistic method outperforms the traditional method. The results in Fig. <xref rid="Fig8" ref-type="fig">8</xref> demonstrate that probabilistic modeling of sample heterogeneity can improve binding site identification also in the case of data from primary cancer biopsies.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Detecting cell type specific binding sites in primary breast cancer samples using the probabilistic model outperforms the traditional method. <bold>a</bold> ROC curve of ER binding predictions for MixChIP (<italic>b</italic>
<italic>l</italic>
<italic>a</italic>
<italic>c</italic>
<italic>k</italic>
<italic>c</italic>
<italic>u</italic>
<italic>r</italic>
<italic>v</italic>
<italic>e</italic>) and maximum <italic>p</italic>-value method (<italic>o</italic>
<italic>r</italic>
<italic>a</italic>
<italic>n</italic>
<italic>g</italic>
<italic>e</italic>
<italic>c</italic>
<italic>u</italic>
<italic>r</italic>
<italic>v</italic>
<italic>e</italic>). <bold>b</bold> The prior (<italic>o</italic>
<italic>r</italic>
<italic>a</italic>
<italic>n</italic>
<italic>g</italic>
<italic>e</italic>
<italic>d</italic>
<italic>o</italic>
<italic>t</italic>
<italic>s</italic>) and estimated proportions (<italic>g</italic>
<italic>r</italic>
<italic>e</italic>
<italic>y</italic>
<italic>d</italic>
<italic>o</italic>
<italic>t</italic>
<italic>s</italic>) of breast cancer cells</p></caption><graphic xlink:href="12859_2015_834_Fig8_HTML" id="MO8"/></fig>
</p>
      </sec>
      <sec id="Sec15">
        <title>Cell type proportions</title>
        <p>In the breast cancer data set we set the priors to the <italic>a priori</italic> assumed cell type proportions given in [<xref ref-type="bibr" rid="CR23">23</xref>] with sharpness parameter <italic>w</italic>
<sub>0</sub>=4 to have informative but not too strict prior. For two of the samples (G5.1 and G8) the MAP estimates of mixing proportions are close to the prior information, whereas for two of the samples (G5.2 and G7) the estimated mixing proportions are more far away from the priors (Fig. <xref rid="Fig8" ref-type="fig">8</xref>
<xref rid="Fig8" ref-type="fig">b</xref>)). Differences between the prior and posterior estimates may be due to inter individual variation in the ER binding strength which can influence the MAP estimates of the mixture proportions. As an example, sample G7 has on average only 13 reads per binding site, whereas other samples have around 34 reads per binding site. Due to the weaker binding strength, sample G7 has a low estimated breast cancer proportion.</p>
        <p>Because the binding strength between the samples varies, we wanted to see how the different scaling factors would affect the results. Instead of using sequencing depth for scaling, we used the binding strength, i.e. the average number of reads in binding sites in each sample. Figure S5 shows that the use of binding strength as a scaling factor helps in correctly estimating the proportions of breast cancer tissue. However, accuracy of cell type specific binding site predictions was decreased. This suggests that there are also other hidden factors, besides sequencing depth, binding strength and the breast cancer cell proportions, that explain the variation between the samples.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec16" sec-type="discussion">
    <title>Discussion</title>
    <p>In general, transcription factor binding varies between different tissue types. As sequencing costs continue to decrease we will in the future see more ChIP-seq experiments adapted into clinical practice where tissue heterogeneity is a major challenge. In this paper, we have demonstrated a probabilistic method for estimating mixture proportions of different tissue or cell types as well as cell type specific protein binding using heterogeneous ChIP-seq data. Even though the method is applied and benchmarked with samples that are mixtures of two cell types it is straightforward to extend the method to handle more complex mixtures. While computational deconvolution methods based on gene expression data are published regularly, there is a demand to develop <italic>in silico</italic> purification methods for other data types as well.</p>
    <p>Using artificially generated mixtures of ENCODE data as well as data from primary breast cancer samples we show that our method outperforms the traditional approach in detecting binding sites from heterogeneous samples. Moreover, accurate predictions can be achieved even with small sample sizes, thus enabling real applications involving heterogeneous samples. Only partial, but not exact, prior information about the true cell type proportions is needed for the deconvolution. Moreover, candidate binding sites can be any sites that show enrichment at least in one of the heterogeneous samples, thus no information about the binding sites in pure cell types is needed. Furthermore, we used rabbit IgG antibody or genomic DNA as input control in our analysis, but in principle any suitable control can be used.</p>
    <p>In practice, if the cell type of interest is the major component in heterogeneous samples and a pure ChIP-seq sample from the cell type of interest exists, cell type specific binding sites can be detected from the pure sample using a standard peak finding algorithm. Then, binding sites in each heterogeneous sample can be found in the same way and the sites which were not detected in the pure sample can be discarded as they probably come from the other cell types. However, this kind of approach would neither detect weaker binding sites nor work if the cell type of interest is not the major component in the heterogeneous samples.</p>
    <p>In reality, heterogeneous tissue samples can be contain high level of noise. Any standard quality control steps can be used to assess the quality of the ChIP-seq data before applying any deconvolution methods. For instance, manual browser inspection is a good way to evaluate how the experiment and antibody have worked in each sample. As a quantitative measure, one can calculate a fraction of reads that fall into the binding sites [<xref ref-type="bibr" rid="CR26">26</xref>]. In the ENCODE project samples with more than 1 <italic>%</italic> of reads mapping to the binding sites are labeled as good quality samples [<xref ref-type="bibr" rid="CR26">26</xref>]. However, when the sample consists of multiple cell types, the quality of the sample can be good even if the fraction of reads in binding sites is less than 1 <italic>%</italic>.</p>
    <p>Since binding sites can vary between samples, possible future extensions include e.g. developing a variant of our method which predicts cell type proportions for each sample given binding profiles of a TF in pure cell types, similar to what has been developed for cell type composition estimation in the context of microarray based gene expression data (see e.g. [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]).</p>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In this work, we propose a probabilistic method, MixChIP, for estimating mixture proportions of different tissue or cell types as well as cell type specific protein binding using heterogeneous ChIP-seq data. We have applied the proposed method to artificially generated mixtures of ENCODE data and data from primary breast cancer samples to show that MixChIP can estimate correct cell type proportions and detects cell type specific TF binding sites more accurately than commonly used approach. We also show that the method is applicable even with small sample sizes and thus can be used in real-life problems.</p>
    <p>To our knowledge MixChIP is the first computational deconvolution method designed for ChIP-sequencing data and it can be a valuable tool in analyzing heterogeneous ChIP-seq samples originating, for instance, from tumor biopsy samples.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec18">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2015_834_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>The following additional data are available.</bold> In the Additional file we provide partial derivatives of the log posterior. <bold>(Table S1):</bold> is a table listing ENCODE data samples used in this paper. <bold>(Table S2):</bold> is a table listing breast cancer samples used in the paper. <bold>(Figure S1):</bold> is a figure showing the performance of the method using all the samples and the max <italic>p</italic>-value method when including samples with different amount of purity. <bold>(Figure S2):</bold> is a figure showing MSE between initial cell type proportions and true cell type proportions against MSE between estimated proportions and true proportions. <bold>(Figure S3):</bold> is a figure showing the prediction performance with different values of hyperparameter <italic>w</italic>
<sub>0</sub>. <bold>(Figure S4):</bold> is a figure showing the binding strength of IRF3 in HelaS3 and HepG2 cell lines. <bold>(Figure S5):</bold> is a figure showing the prediction performance in the breast cancer data set when different scaling factors are used. (PDF 2541 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>HL designed and supervised the study. SR analyzed the data, performed experiments and implemented the code. HL and SR wrote the manuscript. Both authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the Academy of Finland Center of Excellence in Systems Immunology and Physiology and The Emil Aaltonen Foundation. We would like to acknowledge the computational resources provided by the Aalto Science-IT project.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gertz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Savic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Varley</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Partridge</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Safi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct properties of cell-type-specific and shared transcription factor binding sites</article-title>
        <source>Mol Cell</source>
        <year>2013</year>
        <volume>52</volume>
        <issue>1</issue>
        <fpage>25</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2013.08.037</pub-id>
        <pub-id pub-id-type="pmid">24076218</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Handstad</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rye</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mocnik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Drablos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Saetrom</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Cell-type specificity of chip-predicted transcription factor binding sites</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>372</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-372</pub-id>
        <pub-id pub-id-type="pmid">22863112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Seoighe</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Cellmix: A comprehensive toolbox for gene expression deconvolution</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>17</issue>
        <fpage>2211</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt351</pub-id>
        <pub-id pub-id-type="pmid">23825367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Statistical expression deconvolution from mixed tissue samples</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>8</issue>
        <fpage>1043</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq097</pub-id>
        <pub-id pub-id-type="pmid">20202973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Methylpurify: tumor purity deconvolution and differential methylation detection from single tumor dna methylomes</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>8</issue>
        <fpage>419</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0419-x</pub-id>
        <pub-id pub-id-type="pmid">25103624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peddi</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Molecular basis of triple negative breast cancer and implications for therapy</article-title>
        <source>Int J Breast Cancer</source>
        <year>2012</year>
        <volume>2012</volume>
        <fpage>217185</fpage>
        <pub-id pub-id-type="doi">10.1155/2012/217185</pub-id>
        <pub-id pub-id-type="pmid">22295242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liebner</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Parvin</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Mmad: microarray microdissection with analysis of differences is a computational tool for deconvoluting cell type-specific contributions from tissue samples</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>5</issue>
        <fpage>682</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt566</pub-id>
        <pub-id pub-id-type="pmid">24085566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bodian</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Staedtler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>NM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell type-specific gene expression differences in complex tissues</article-title>
        <source>Nat Meth</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>287</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pecasse</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Maenhaut</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bersini</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Separation of samples into their constituents using gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <issue>suppl 1</issue>
        <fpage>279</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.suppl_1.S279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shmulevich</surname>
            <given-names>l</given-names>
          </name>
          <name>
            <surname>Dunmire</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yli-Harja</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>In silico microdissection of microarray data from heterogeneous cell populations</article-title>
        <source>BMC Bioinforma</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-54</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>
        <source>PLOS Genet</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>9</issue>
        <fpage>161</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0030161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erkkilä</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lehmusvaara</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ruusuvuori</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Visakorpi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shmulevich</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic analysis of gene expression measurements from heterogeneous tissues</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>20</issue>
        <fpage>2571</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq406</pub-id>
        <pub-id pub-id-type="pmid">20631160</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>A mixture model for expression deconvolution from rna-seq in heterogeneous tissues</article-title>
        <source>BMC Bioinforma</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>Suppl 5</issue>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S16-S11</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Meth</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anghel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Quon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Haider</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Deshwar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isopurer: an r implementation of a computational purification algorithm of mixed tumour profiles</article-title>
        <source>BMC Bioinforma</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>156</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0597-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Krajewski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ladunga</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Practical guidelines for the comprehensive analysis of chip-seq data</article-title>
        <source>PLOS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>11</issue>
        <fpage>1003326</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Keles</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Normalization of chip-seq data with control</article-title>
        <source>BMC Bioinforma</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>199</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Eeckhoute</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based Analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of dna elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short dna sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Tolstorukov</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1351</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1508</pub-id>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pyl</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Htseq: a python framework to work with high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>166</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id>
        <pub-id pub-id-type="pmid">25260700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross-Innes</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Dunning</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential oestrogen receptor binding is associated with clinical outcome in breast cancer</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <issue>7381</issue>
        <fpage>389</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="pmid">22217937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Byrd</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nocedal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schnabel</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Representations of quasi-newton matrices and their use in limited memory methods</article-title>
        <source>Math Program</source>
        <year>1994</year>
        <volume>63</volume>
        <issue>1–3</issue>
        <fpage>129</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01582063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Identifying and mitigating bias in next-generation sequencing methods for chromatin biology</article-title>
        <source>Nat Rev Genet</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>11</issue>
        <fpage>709</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3788</pub-id>
        <pub-id pub-id-type="pmid">25223782</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landt</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Marinov</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kheradpour</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pauli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chip-seq guidelines and practices of the encode and modencode consortia</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>9</issue>
        <fpage>1813</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.136184.111</pub-id>
        <pub-id pub-id-type="pmid">22955991</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
