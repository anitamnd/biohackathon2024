<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3356845</article-id>
    <article-id pub-id-type="pmid">22513995</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts188</article-id>
    <article-id pub-id-type="publisher-id">bts188</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NanoStringNorm: an extensible R package for the pre-processing of NanoString mRNA and miRNA data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Waggott</surname>
          <given-names>Daryl</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chu</surname>
          <given-names>Kenneth</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Shaoming</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wouters</surname>
          <given-names>Bradly G.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Fei-Fei</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boutros</surname>
          <given-names>Paul C.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Informatics and Biocomputing Platform, Ontario Institute for Cancer Research, Toronto, Canada M5G 0A3, <sup>2</sup>Ontario Cancer Institute and Campbell Family Institute for Cancer Research, Princess Margaret Hospital, University Health Network and <sup>3</sup>Departments of Radiation Oncology and Medical Biophysics, University of Toronto, Toronto, Canada, M5G 2M9</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>6</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>28</volume>
    <issue>11</issue>
    <fpage>1546</fpage>
    <lpage>1548</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>3</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>4</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> The NanoString nCounter Platform is a new and promising technology for measuring nucleic acid abundances. It has several advantages over PCR-based techniques, including avoidance of amplification, direct sequence interrogation and digital detection for absolute quantification. These features minimize aspects of experimental error and hold promise for dealing with challenging experimental conditions such as archival formalin-fixed paraffin-embedded samples. However, systematic inter-sample technical artifacts caused by variability in sample preservation, bio-molecular extraction and platform fluctuations must be removed to ensure robust data.</p>
      <p><bold>Results:</bold> To facilitate this process and to address these issues for NanoString datasets, we have written a pre-processing package called NanoStringNorm in the R statistical language. Key features include an extensible environment for method comparison and new algorithm development, integrated gene and sample diagnostics, and facilitated downstream statistical analysis. The package is open-source, is available through the CRAN package repository, includes unit-tests to ensure numerical accuracy, and provides visual and numeric diagnostics.</p>
      <p>
        <bold>Availability:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/NanoStringNorm">http://cran.r-project.org/web/packages/NanoStringNorm</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>paul.boutros@oicr.on.ca</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts188/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>The NanoString<sup>®</sup> nCounter Platform is an emerging medium-throughput technology for measuring mRNA and miRNA abundances and for assessing copy number variants (<xref ref-type="bibr" rid="B3">Geiss <italic>et al.</italic>, 2008</xref>). NanoString technology has several potential benefits relative to microarray- and PCR-based technologies. First, its parallelized nature and small number of manual manipulations generate data faster than many PCR-based methods. Second, the hybridization method used directly interrogates target sequences, avoiding the need for bias-prone amplification steps, even for low-abundance transcripts. Third, measurement is achieved using digital detection of uniquely bar-coded probes, providing absolute quantification.</p>
    <p>This combination of advantages is thought to provide favorable conditions for testing formalin-fixed paraffin-embedded (FFPE) samples. FFPE preparation is a standard protocol for the long-term storage of human clinical specimens. Despite some positive reports (<xref ref-type="bibr" rid="B5">Hui <italic>et al.</italic>, 2009</xref>), the degradation of RNA in FFPE samples challenges existing mRNA quantitation assays. The ability to reliably process FFPE samples would greatly facilitate retrospective studies.</p>
    <p>Accordingly there has been a dramatic increase in the uptake of NanoString technology in our research facility. In some cases, it is used as a validation procedure; in others as a discovery tool using candidate genes. A common rationale is the desire to exploit large, clinically well-annotated FFPE collections. Since NanoString is a new technology, many details of its analysis remain unexplored: optimal methods of data pre-processing are unknown, although this is well-known to impact biological conclusions (<xref ref-type="bibr" rid="B7">Shippy <italic>et al.</italic>, 2006</xref>).</p>
    <p>NanoString currently recommends pre-processing using Microsoft Excel spreadsheet functions. This has significant limitations. First, manual analysis is both hard to reproduce and prone to errors (<xref ref-type="bibr" rid="B6">McCullough and Heiser, 2006</xref>): gene- and sample-name auto-formatting are well-known issues (<xref ref-type="bibr" rid="B8">Zeeberg <italic>et al.</italic>, 2004</xref>). Second, macros and worksheets cannot easily be adapted to changing experimental designs or pre-processing methods: spreadsheet software lacks the sophisticated statistical tools common in bioinformatics (e.g. survival or mixed models). Third, it is highly desirable to integrate workflows in a single environment, and downstream analyses are typically performed in statistical environments. Fourth, the quality of data pre-processing requires careful assessment with data visualizations that are difficult to automate using spreadsheets.</p>
    <p>For these reasons we have developed an open-source R package, called NanoStringNorm, to implement a reference set of pre-processing techniques. We chose the R statistical environment to allow integration with BioConductor libraries (<xref ref-type="bibr" rid="B4">Gentleman <italic>et al.</italic>, 2004</xref>), and to exploit its data-visualization (<xref ref-type="bibr" rid="B2">Chen and Boutros, 2011</xref>) and statistical tools. NanoStringNorm outlines a pipeline of pre-processing steps with multiple options at each stage and provides a framework for method development and comparison. By standardizing code and automating error capture, NanoStringNorm will enable more reproducible and robust analysis of NanoString datasets.</p>
  </sec>
  <sec id="SEC2">
    <title>2 IMPLEMENTATION</title>
    <sec id="SEC2.1">
      <title>2.1 Pre-processing pipeline</title>
      <p>NanoString provides analysis guidelines for miRNA and mRNA assays online, which provide detailed instructions on options available for pre-processing of the output of an nCounter. Pre-processing involves five independent, but ordered, steps. Complete equations for each algorithm are given in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts188/DC1">Supplementary Material</ext-link>.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Probe-level background correction</title>
      <p>The first step is not discussed in the NanoString guidelines, but it is mentioned in nCounter documentation: during some runs, probes are flagged for correction. Adjustment values are annotated in text files which can be acquired from core facilities. Correction factors are multiplied by the maximum positive control value, then subtracted from the raw counts, per sample.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Code-count normalization</title>
      <p>The second step accounts for lane-by-lane variation of the nCounter platform. A series of exogenous probes of known concentration are used, allowing observed variation to be attributed specifically to the assay. Normalization occurs by summarizing (i.e. mean, median, sum or geometric mean) the positive control counts and adjusting samples by a factor relative to other samples.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Background correction</title>
      <p>Even though data are presented as absolute counts, detectable levels of non-specific binding remain, as measured by negative controls. The background level is calculated as an aggregate summary of six to eight control probes with no target transcript. The calculated background level for each sample is then subtracted from the adjusted probe value. Negative values are scaled to zero as a baseline for no expression. The mean of negative controls is a non-stringent correction that maximizes sensitivity in exchange for increased false positives. Alternatively, the maximum or mean plus two SDs can be used to prevent spurious results.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Sample content normalization</title>
      <p>Sample RNA input variation is caused by laboratory and pipetting anomalies independent of NanoString assay variation. Using housekeeping genes is one common method of removing this bias. For miRNAs and FFPE samples, it is often unclear how such genes should be selected. Alternative approaches include summarizing all genes, or focusing on a set of highly expressed genes. Sample content normalization factors are calculated similar to code count ones: a group of normalization genes is selected, summarized (e.g. geometric mean, etc.) and a sample adjustment factor is calculated.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Concentration prediction</title>
      <p>A convenience function has been added to transform counts to concentrations using positive controls: fitting of positive control concentrations is used to predict endogenous probe concentrations.</p>
    </sec>
    <sec id="SEC2.7">
      <title>2.7 Best normalization</title>
      <p>To evaluate the best pre-processing method for specific code sets and study designs, a function was created to rank methods based on the coefficient of variation of control probes, the intra-class correlation of replicate groups and the fold change accuracy for primary traits of interest. This function is suited for studies with technical replication, such as titrations.</p>
    </sec>
    <sec id="SEC2.8">
      <title>2.8 Software engineering decisions</title>
      <p>The package is highly modular, to maximize extensibility. Gene and sample summary plots and diagnostics (<xref ref-type="fig" rid="F1">Fig. 1</xref>) are auto-generated and flag experimental artifacts. Unit-tests are continuously added to diagnose and prevent numerical errors.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>NanoStringNorm volcano plot showing differential expression caused by batch-effects between experiments on two days. Point-size reflects mean counts per probe. Naive co-normalization introduces bias</p></caption><graphic xlink:href="bts188f1"/></fig></p>
    </sec>
    <sec id="SEC2.9">
      <title>2.9 Visual and numeric diagnostics</title>
      <p>We developed extensive diagnostics to enhance interpretation, with a particular focus on experimental quality and reliability. NanoStringNorm flags potential systematic batch-effects, identifies background artifacts and assesses negative/positive-controls. Each flag is associated with plots (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts188/DC1">Supplementary Fig. S3</ext-link>) and all results, diagnostics and differential expression can be output in interactive Google motion charts (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts188/DC1">Supplementary Fig. S4</ext-link>).</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 RESULTS AND CONCLUSIONS</title>
    <p>For a variety of reasons, NanoString usage is rising; making standardized approaches to data analysis increasingly critical. We have therefore developed an extensible, open-source R package to automate pre-processing. Our package enables a wide range of pre-processing approaches to be evaluated, and will be updated as improved techniques are developed. For example, NanoString data can be processed and statistically analyzed based on the negative binomial distribution (<xref ref-type="bibr" rid="B1">Brumbaugh <italic>et al.</italic>, 2011</xref>). Similar modeling, integrated into the NanoStringNorm API, will make NanoString data broadly useful for clinical applications. Future work will account for correlation among experimental design features such as replicates, tissue subgroups and inter-experimental batch-effects.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_28_11_1546__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_bts188_NanoStringNorm_Application_Note_Supplementary.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank the Boutros lab for support and software testing.</p>
    <p><italic>Funding</italic>: <funding-source>Ontario Institute for Cancer Research</funding-source> (to P.C.B. and B.G.W.); <funding-source>Ontario Ministry of Health and Long Term Care</funding-source> (OMOHLTC; to B.G.W. and F.-F.L.); <funding-source>Dr Mariano Elia Chair in Head &amp; Neck Cancer Research</funding-source>; philanthropic support from the <funding-source>Wharton family, Joe's Team and Gordon Tozer</funding-source>. Views expressed do not necessarily reflect those of the <funding-source>OMOHLTC</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brumbaugh</surname>
            <given-names>C.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Normalization and differential expression analysis of NanoString nCounter data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>479</fpage>
        <pub-id pub-id-type="pmid">22177214</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>P.C.</given-names>
          </name>
        </person-group>
        <article-title>VennDiagram: a package for the generation of highly customizable Venn and Euler diagrams in R</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="pmid">21269502</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geiss</surname>
            <given-names>G.K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct multiplexed measurement of gene expression with color-coded probe pairs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>317</fpage>
        <lpage>325</lpage>
        <pub-id pub-id-type="pmid">18278033</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>R.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hui</surname>
            <given-names>A.B.Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust global micro-RNA profiling with formalin-fixed paraffin-embedded breast cancer tissues</article-title>
        <source>Lab. Invest.</source>
        <year>2009</year>
        <volume>89</volume>
        <fpage>597</fpage>
        <lpage>606</lpage>
        <pub-id pub-id-type="pmid">19290006</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCullough</surname>
            <given-names>B.D.</given-names>
          </name>
          <name>
            <surname>Heiser</surname>
            <given-names>D.A.</given-names>
          </name>
        </person-group>
        <article-title>On the accuracy of statistical procedures in Microsoft Excel 2007</article-title>
        <source>Comput. Stat. Data Anal.</source>
        <year>2006</year>
        <volume>52</volume>
        <fpage>4570</fpage>
        <lpage>4578</lpage>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shippy</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using RNA sample titrations to assess microarray platform performance and normalization techniques</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>1123</fpage>
        <lpage>1131</lpage>
        <pub-id pub-id-type="pmid">16964226</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeeberg</surname>
            <given-names>B.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mistaken identifiers: gene name errors can be introduced inadvertently when using Excel in bioinformatics</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>80</fpage>
        <pub-id pub-id-type="pmid">15214961</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
